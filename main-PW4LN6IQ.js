import {
  ANIMATION_MODULE_TYPE,
  AUTO_STYLE,
  ActivatedRoute,
  AnimationGroupPlayer,
  AnimationMetadataType,
  BrowserModule,
  ChangeDetectionStrategy,
  ChangeDetectorRef,
  CommonModule,
  Component,
  ContentChild,
  ContentChildren,
  CurrencyPipe,
  DOCUMENT,
  DatePipe,
  Directive,
  DomRendererFactory2,
  EMPTY,
  EventEmitter,
  FormsModule,
  HTTP_INTERCEPTORS,
  HostBinding,
  HttpClient,
  HttpHeaders,
  HttpParams,
  Inject,
  Injectable,
  InjectionToken,
  Input,
  IterableDiffers,
  LOCALE_ID,
  NgClass,
  NgControlStatus,
  NgControlStatusGroup,
  NgForm,
  NgIf,
  NgModel,
  NgModule,
  NgSwitch,
  NgSwitchCase,
  NgTemplateOutlet,
  NgZone,
  NoopAnimationPlayer,
  Observable,
  Output,
  PLATFORM_ID,
  PatternValidator,
  PoButtonComponent,
  PoButtonModule,
  PoCheckboxGroupComponent,
  PoComboComponent,
  PoComponentInjectorService,
  PoContainerComponent,
  PoContainerModule,
  PoDatepickerComponent,
  PoDatepickerIsoFormat,
  PoDatepickerRangeComponent,
  PoDialogModule,
  PoDialogService,
  PoDividerComponent,
  PoDividerModule,
  PoDynamicFieldType,
  PoDynamicFormComponent,
  PoDynamicModule,
  PoDynamicViewComponent,
  PoEmailComponent,
  PoFieldModule,
  PoGridComponent,
  PoGridModule,
  PoI18nPipe,
  PoIconComponent,
  PoIconModule,
  PoInfoComponent,
  PoInfoModule,
  PoInfoOrientation,
  PoInputComponent,
  PoLanguageModule,
  PoLanguageService,
  PoListViewComponent,
  PoListViewContentTemplateDirective,
  PoListViewDetailTemplateDirective,
  PoLoginComponent,
  PoLogoComponent,
  PoLogoModule,
  PoLookupComponent,
  PoMenuComponent,
  PoModalComponent,
  PoModalFooterComponent,
  PoModalModule,
  PoModule,
  PoMultiselectComponent,
  PoNotificationService,
  PoNumberComponent,
  PoPageDefaultComponent,
  PoPageEditComponent,
  PoPageListComponent,
  PoPageModule,
  PoPasswordComponent,
  PoRadioGroupComponent,
  PoSearchFilterMode,
  PoSelectComponent,
  PoStepperComponent,
  PoStepperModule,
  PoStepperOrientation,
  PoStepperStatus,
  PoSwitchComponent,
  PoTableColumnSortType,
  PoTableComponent,
  PoTableModule,
  PoTagComponent,
  PoTextareaComponent,
  PoThemeA11yEnum,
  PoThemeService,
  PoThemeTypeEnum,
  PoToolbarComponent,
  PoTooltipDirective,
  PoUploadComponent,
  PoWidgetComponent,
  PoWidgetModule,
  RendererFactory2,
  Router,
  RouterLink,
  RouterModule,
  RouterOutlet,
  RuntimeError,
  Subscription,
  TemplateRef,
  ViewChild,
  ViewContainerRef,
  ViewEncapsulation,
  __async,
  __commonJS,
  __objRest,
  __require,
  __spreadProps,
  __spreadValues,
  __toESM,
  catchError,
  concat,
  enableProdMode,
  firstValueFrom,
  from,
  inject,
  isPlatformBrowser,
  map,
  merge,
  of,
  platformBrowser,
  poLanguageDefault,
  poLocaleDefault,
  poLocales,
  poThemeDefault,
  provideHttpClient,
  registerLocaleData,
  sequence,
  setClassMetadata,
  style,
  switchMap,
  tap,
  throwError,
  withInterceptorsFromDi,
  ɵNgNoValidate,
  ɵPRE_STYLE,
  ɵsetClassDebugInfo,
  ɵɵInheritDefinitionFeature,
  ɵɵNgOnChangesFeature,
  ɵɵProvidersFeature,
  ɵɵadvance,
  ɵɵattribute,
  ɵɵclassMapInterpolate1,
  ɵɵclassProp,
  ɵɵconditional,
  ɵɵcontentQuery,
  ɵɵdefineComponent,
  ɵɵdefineDirective,
  ɵɵdefineInjectable,
  ɵɵdefineInjector,
  ɵɵdefineNgModule,
  ɵɵdirectiveInject,
  ɵɵelement,
  ɵɵelementContainer,
  ɵɵelementEnd,
  ɵɵelementStart,
  ɵɵgetCurrentView,
  ɵɵinject,
  ɵɵlistener,
  ɵɵloadQuery,
  ɵɵnextContext,
  ɵɵpipe,
  ɵɵpipeBind2,
  ɵɵprojection,
  ɵɵprojectionDef,
  ɵɵproperty,
  ɵɵpropertyInterpolate,
  ɵɵpropertyInterpolate1,
  ɵɵpropertyInterpolate2,
  ɵɵpureFunction0,
  ɵɵpureFunction1,
  ɵɵpureFunction2,
  ɵɵpureFunction3,
  ɵɵqueryRefresh,
  ɵɵreference,
  ɵɵrepeater,
  ɵɵrepeaterCreate,
  ɵɵrepeaterTrackByIdentity,
  ɵɵresetView,
  ɵɵrestoreView,
  ɵɵsanitizeUrl,
  ɵɵstyleProp,
  ɵɵtemplate,
  ɵɵtemplateRefExtractor,
  ɵɵtext,
  ɵɵtextInterpolate,
  ɵɵtextInterpolate1,
  ɵɵtextInterpolate2,
  ɵɵtwoWayBindingSet,
  ɵɵtwoWayListener,
  ɵɵtwoWayProperty,
  ɵɵviewQuery
} from "./chunk-DHIOACDS.js";

// node_modules/localforage/dist/localforage.js
var require_localforage = __commonJS({
  "node_modules/localforage/dist/localforage.js"(exports, module) {
    "use strict";
    (function(f) {
      if (typeof exports === "object" && typeof module !== "undefined") {
        module.exports = f();
      } else if (typeof define === "function" && define.amd) {
        define([], f);
      } else {
        var g;
        if (typeof window !== "undefined") {
          g = window;
        } else if (typeof global !== "undefined") {
          g = global;
        } else if (typeof self !== "undefined") {
          g = self;
        } else {
          g = this;
        }
        g.localforage = f();
      }
    })(function() {
      var define2, module2, exports2;
      return function e(t, n, r) {
        function s(o2, u2) {
          if (!n[o2]) {
            if (!t[o2]) {
              var a = typeof __require == "function" && __require;
              if (!u2 && a) return a(o2, true);
              if (i) return i(o2, true);
              var f = new Error("Cannot find module '" + o2 + "'");
              throw f.code = "MODULE_NOT_FOUND", f;
            }
            var l = n[o2] = {
              exports: {}
            };
            t[o2][0].call(l.exports, function(e2) {
              var n2 = t[o2][1][e2];
              return s(n2 ? n2 : e2);
            }, l, l.exports, e, t, n, r);
          }
          return n[o2].exports;
        }
        var i = typeof __require == "function" && __require;
        for (var o = 0; o < r.length; o++) s(r[o]);
        return s;
      }({
        1: [function(_dereq_, module3, exports3) {
          (function(global2) {
            "use strict";
            var Mutation = global2.MutationObserver || global2.WebKitMutationObserver;
            var scheduleDrain;
            {
              if (Mutation) {
                var called = 0;
                var observer = new Mutation(nextTick);
                var element = global2.document.createTextNode("");
                observer.observe(element, {
                  characterData: true
                });
                scheduleDrain = function() {
                  element.data = called = ++called % 2;
                };
              } else if (!global2.setImmediate && typeof global2.MessageChannel !== "undefined") {
                var channel = new global2.MessageChannel();
                channel.port1.onmessage = nextTick;
                scheduleDrain = function() {
                  channel.port2.postMessage(0);
                };
              } else if ("document" in global2 && "onreadystatechange" in global2.document.createElement("script")) {
                scheduleDrain = function() {
                  var scriptEl = global2.document.createElement("script");
                  scriptEl.onreadystatechange = function() {
                    nextTick();
                    scriptEl.onreadystatechange = null;
                    scriptEl.parentNode.removeChild(scriptEl);
                    scriptEl = null;
                  };
                  global2.document.documentElement.appendChild(scriptEl);
                };
              } else {
                scheduleDrain = function() {
                  setTimeout(nextTick, 0);
                };
              }
            }
            var draining;
            var queue = [];
            function nextTick() {
              draining = true;
              var i, oldQueue;
              var len = queue.length;
              while (len) {
                oldQueue = queue;
                queue = [];
                i = -1;
                while (++i < len) {
                  oldQueue[i]();
                }
                len = queue.length;
              }
              draining = false;
            }
            module3.exports = immediate;
            function immediate(task) {
              if (queue.push(task) === 1 && !draining) {
                scheduleDrain();
              }
            }
          }).call(this, typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {});
        }, {}],
        2: [function(_dereq_, module3, exports3) {
          "use strict";
          var immediate = _dereq_(1);
          function INTERNAL() {
          }
          var handlers = {};
          var REJECTED = ["REJECTED"];
          var FULFILLED = ["FULFILLED"];
          var PENDING = ["PENDING"];
          module3.exports = Promise2;
          function Promise2(resolver) {
            if (typeof resolver !== "function") {
              throw new TypeError("resolver must be a function");
            }
            this.state = PENDING;
            this.queue = [];
            this.outcome = void 0;
            if (resolver !== INTERNAL) {
              safelyResolveThenable(this, resolver);
            }
          }
          Promise2.prototype["catch"] = function(onRejected) {
            return this.then(null, onRejected);
          };
          Promise2.prototype.then = function(onFulfilled, onRejected) {
            if (typeof onFulfilled !== "function" && this.state === FULFILLED || typeof onRejected !== "function" && this.state === REJECTED) {
              return this;
            }
            var promise = new this.constructor(INTERNAL);
            if (this.state !== PENDING) {
              var resolver = this.state === FULFILLED ? onFulfilled : onRejected;
              unwrap(promise, resolver, this.outcome);
            } else {
              this.queue.push(new QueueItem(promise, onFulfilled, onRejected));
            }
            return promise;
          };
          function QueueItem(promise, onFulfilled, onRejected) {
            this.promise = promise;
            if (typeof onFulfilled === "function") {
              this.onFulfilled = onFulfilled;
              this.callFulfilled = this.otherCallFulfilled;
            }
            if (typeof onRejected === "function") {
              this.onRejected = onRejected;
              this.callRejected = this.otherCallRejected;
            }
          }
          QueueItem.prototype.callFulfilled = function(value) {
            handlers.resolve(this.promise, value);
          };
          QueueItem.prototype.otherCallFulfilled = function(value) {
            unwrap(this.promise, this.onFulfilled, value);
          };
          QueueItem.prototype.callRejected = function(value) {
            handlers.reject(this.promise, value);
          };
          QueueItem.prototype.otherCallRejected = function(value) {
            unwrap(this.promise, this.onRejected, value);
          };
          function unwrap(promise, func, value) {
            immediate(function() {
              var returnValue;
              try {
                returnValue = func(value);
              } catch (e) {
                return handlers.reject(promise, e);
              }
              if (returnValue === promise) {
                handlers.reject(promise, new TypeError("Cannot resolve promise with itself"));
              } else {
                handlers.resolve(promise, returnValue);
              }
            });
          }
          handlers.resolve = function(self2, value) {
            var result = tryCatch(getThen, value);
            if (result.status === "error") {
              return handlers.reject(self2, result.value);
            }
            var thenable = result.value;
            if (thenable) {
              safelyResolveThenable(self2, thenable);
            } else {
              self2.state = FULFILLED;
              self2.outcome = value;
              var i = -1;
              var len = self2.queue.length;
              while (++i < len) {
                self2.queue[i].callFulfilled(value);
              }
            }
            return self2;
          };
          handlers.reject = function(self2, error) {
            self2.state = REJECTED;
            self2.outcome = error;
            var i = -1;
            var len = self2.queue.length;
            while (++i < len) {
              self2.queue[i].callRejected(error);
            }
            return self2;
          };
          function getThen(obj) {
            var then = obj && obj.then;
            if (obj && (typeof obj === "object" || typeof obj === "function") && typeof then === "function") {
              return function appyThen() {
                then.apply(obj, arguments);
              };
            }
          }
          function safelyResolveThenable(self2, thenable) {
            var called = false;
            function onError(value) {
              if (called) {
                return;
              }
              called = true;
              handlers.reject(self2, value);
            }
            function onSuccess(value) {
              if (called) {
                return;
              }
              called = true;
              handlers.resolve(self2, value);
            }
            function tryToUnwrap() {
              thenable(onSuccess, onError);
            }
            var result = tryCatch(tryToUnwrap);
            if (result.status === "error") {
              onError(result.value);
            }
          }
          function tryCatch(func, value) {
            var out = {};
            try {
              out.value = func(value);
              out.status = "success";
            } catch (e) {
              out.status = "error";
              out.value = e;
            }
            return out;
          }
          Promise2.resolve = resolve;
          function resolve(value) {
            if (value instanceof this) {
              return value;
            }
            return handlers.resolve(new this(INTERNAL), value);
          }
          Promise2.reject = reject;
          function reject(reason) {
            var promise = new this(INTERNAL);
            return handlers.reject(promise, reason);
          }
          Promise2.all = all;
          function all(iterable) {
            var self2 = this;
            if (Object.prototype.toString.call(iterable) !== "[object Array]") {
              return this.reject(new TypeError("must be an array"));
            }
            var len = iterable.length;
            var called = false;
            if (!len) {
              return this.resolve([]);
            }
            var values = new Array(len);
            var resolved = 0;
            var i = -1;
            var promise = new this(INTERNAL);
            while (++i < len) {
              allResolver(iterable[i], i);
            }
            return promise;
            function allResolver(value, i2) {
              self2.resolve(value).then(resolveFromAll, function(error) {
                if (!called) {
                  called = true;
                  handlers.reject(promise, error);
                }
              });
              function resolveFromAll(outValue) {
                values[i2] = outValue;
                if (++resolved === len && !called) {
                  called = true;
                  handlers.resolve(promise, values);
                }
              }
            }
          }
          Promise2.race = race;
          function race(iterable) {
            var self2 = this;
            if (Object.prototype.toString.call(iterable) !== "[object Array]") {
              return this.reject(new TypeError("must be an array"));
            }
            var len = iterable.length;
            var called = false;
            if (!len) {
              return this.resolve([]);
            }
            var i = -1;
            var promise = new this(INTERNAL);
            while (++i < len) {
              resolver(iterable[i]);
            }
            return promise;
            function resolver(value) {
              self2.resolve(value).then(function(response) {
                if (!called) {
                  called = true;
                  handlers.resolve(promise, response);
                }
              }, function(error) {
                if (!called) {
                  called = true;
                  handlers.reject(promise, error);
                }
              });
            }
          }
        }, {
          "1": 1
        }],
        3: [function(_dereq_, module3, exports3) {
          (function(global2) {
            "use strict";
            if (typeof global2.Promise !== "function") {
              global2.Promise = _dereq_(2);
            }
          }).call(this, typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {});
        }, {
          "2": 2
        }],
        4: [function(_dereq_, module3, exports3) {
          "use strict";
          var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function(obj) {
            return typeof obj;
          } : function(obj) {
            return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
          };
          function _classCallCheck(instance, Constructor) {
            if (!(instance instanceof Constructor)) {
              throw new TypeError("Cannot call a class as a function");
            }
          }
          function getIDB() {
            try {
              if (typeof indexedDB !== "undefined") {
                return indexedDB;
              }
              if (typeof webkitIndexedDB !== "undefined") {
                return webkitIndexedDB;
              }
              if (typeof mozIndexedDB !== "undefined") {
                return mozIndexedDB;
              }
              if (typeof OIndexedDB !== "undefined") {
                return OIndexedDB;
              }
              if (typeof msIndexedDB !== "undefined") {
                return msIndexedDB;
              }
            } catch (e) {
              return;
            }
          }
          var idb = getIDB();
          function isIndexedDBValid() {
            try {
              if (!idb || !idb.open) {
                return false;
              }
              var isSafari = typeof openDatabase !== "undefined" && /(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent) && !/BlackBerry/.test(navigator.platform);
              var hasFetch = typeof fetch === "function" && fetch.toString().indexOf("[native code") !== -1;
              return (!isSafari || hasFetch) && typeof indexedDB !== "undefined" && // some outdated implementations of IDB that appear on Samsung
              // and HTC Android devices <4.4 are missing IDBKeyRange
              // See: https://github.com/mozilla/localForage/issues/128
              // See: https://github.com/mozilla/localForage/issues/272
              typeof IDBKeyRange !== "undefined";
            } catch (e) {
              return false;
            }
          }
          function createBlob(parts, properties) {
            parts = parts || [];
            properties = properties || {};
            try {
              return new Blob(parts, properties);
            } catch (e) {
              if (e.name !== "TypeError") {
                throw e;
              }
              var Builder = typeof BlobBuilder !== "undefined" ? BlobBuilder : typeof MSBlobBuilder !== "undefined" ? MSBlobBuilder : typeof MozBlobBuilder !== "undefined" ? MozBlobBuilder : WebKitBlobBuilder;
              var builder = new Builder();
              for (var i = 0; i < parts.length; i += 1) {
                builder.append(parts[i]);
              }
              return builder.getBlob(properties.type);
            }
          }
          if (typeof Promise === "undefined") {
            _dereq_(3);
          }
          var Promise$1 = Promise;
          function executeCallback(promise, callback) {
            if (callback) {
              promise.then(function(result) {
                callback(null, result);
              }, function(error) {
                callback(error);
              });
            }
          }
          function executeTwoCallbacks(promise, callback, errorCallback) {
            if (typeof callback === "function") {
              promise.then(callback);
            }
            if (typeof errorCallback === "function") {
              promise["catch"](errorCallback);
            }
          }
          function normalizeKey(key2) {
            if (typeof key2 !== "string") {
              console.warn(key2 + " used as a key, but it is not a string.");
              key2 = String(key2);
            }
            return key2;
          }
          function getCallback() {
            if (arguments.length && typeof arguments[arguments.length - 1] === "function") {
              return arguments[arguments.length - 1];
            }
          }
          var DETECT_BLOB_SUPPORT_STORE = "local-forage-detect-blob-support";
          var supportsBlobs = void 0;
          var dbContexts = {};
          var toString = Object.prototype.toString;
          var READ_ONLY = "readonly";
          var READ_WRITE = "readwrite";
          function _binStringToArrayBuffer(bin) {
            var length2 = bin.length;
            var buf = new ArrayBuffer(length2);
            var arr = new Uint8Array(buf);
            for (var i = 0; i < length2; i++) {
              arr[i] = bin.charCodeAt(i);
            }
            return buf;
          }
          function _checkBlobSupportWithoutCaching(idb2) {
            return new Promise$1(function(resolve) {
              var txn = idb2.transaction(DETECT_BLOB_SUPPORT_STORE, READ_WRITE);
              var blob = createBlob([""]);
              txn.objectStore(DETECT_BLOB_SUPPORT_STORE).put(blob, "key");
              txn.onabort = function(e) {
                e.preventDefault();
                e.stopPropagation();
                resolve(false);
              };
              txn.oncomplete = function() {
                var matchedChrome = navigator.userAgent.match(/Chrome\/(\d+)/);
                var matchedEdge = navigator.userAgent.match(/Edge\//);
                resolve(matchedEdge || !matchedChrome || parseInt(matchedChrome[1], 10) >= 43);
              };
            })["catch"](function() {
              return false;
            });
          }
          function _checkBlobSupport(idb2) {
            if (typeof supportsBlobs === "boolean") {
              return Promise$1.resolve(supportsBlobs);
            }
            return _checkBlobSupportWithoutCaching(idb2).then(function(value) {
              supportsBlobs = value;
              return supportsBlobs;
            });
          }
          function _deferReadiness(dbInfo) {
            var dbContext = dbContexts[dbInfo.name];
            var deferredOperation = {};
            deferredOperation.promise = new Promise$1(function(resolve, reject) {
              deferredOperation.resolve = resolve;
              deferredOperation.reject = reject;
            });
            dbContext.deferredOperations.push(deferredOperation);
            if (!dbContext.dbReady) {
              dbContext.dbReady = deferredOperation.promise;
            } else {
              dbContext.dbReady = dbContext.dbReady.then(function() {
                return deferredOperation.promise;
              });
            }
          }
          function _advanceReadiness(dbInfo) {
            var dbContext = dbContexts[dbInfo.name];
            var deferredOperation = dbContext.deferredOperations.pop();
            if (deferredOperation) {
              deferredOperation.resolve();
              return deferredOperation.promise;
            }
          }
          function _rejectReadiness(dbInfo, err) {
            var dbContext = dbContexts[dbInfo.name];
            var deferredOperation = dbContext.deferredOperations.pop();
            if (deferredOperation) {
              deferredOperation.reject(err);
              return deferredOperation.promise;
            }
          }
          function _getConnection(dbInfo, upgradeNeeded) {
            return new Promise$1(function(resolve, reject) {
              dbContexts[dbInfo.name] = dbContexts[dbInfo.name] || createDbContext();
              if (dbInfo.db) {
                if (upgradeNeeded) {
                  _deferReadiness(dbInfo);
                  dbInfo.db.close();
                } else {
                  return resolve(dbInfo.db);
                }
              }
              var dbArgs = [dbInfo.name];
              if (upgradeNeeded) {
                dbArgs.push(dbInfo.version);
              }
              var openreq = idb.open.apply(idb, dbArgs);
              if (upgradeNeeded) {
                openreq.onupgradeneeded = function(e) {
                  var db = openreq.result;
                  try {
                    db.createObjectStore(dbInfo.storeName);
                    if (e.oldVersion <= 1) {
                      db.createObjectStore(DETECT_BLOB_SUPPORT_STORE);
                    }
                  } catch (ex) {
                    if (ex.name === "ConstraintError") {
                      console.warn('The database "' + dbInfo.name + '" has been upgraded from version ' + e.oldVersion + " to version " + e.newVersion + ', but the storage "' + dbInfo.storeName + '" already exists.');
                    } else {
                      throw ex;
                    }
                  }
                };
              }
              openreq.onerror = function(e) {
                e.preventDefault();
                reject(openreq.error);
              };
              openreq.onsuccess = function() {
                var db = openreq.result;
                db.onversionchange = function(e) {
                  e.target.close();
                };
                resolve(db);
                _advanceReadiness(dbInfo);
              };
            });
          }
          function _getOriginalConnection(dbInfo) {
            return _getConnection(dbInfo, false);
          }
          function _getUpgradedConnection(dbInfo) {
            return _getConnection(dbInfo, true);
          }
          function _isUpgradeNeeded(dbInfo, defaultVersion) {
            if (!dbInfo.db) {
              return true;
            }
            var isNewStore = !dbInfo.db.objectStoreNames.contains(dbInfo.storeName);
            var isDowngrade = dbInfo.version < dbInfo.db.version;
            var isUpgrade = dbInfo.version > dbInfo.db.version;
            if (isDowngrade) {
              if (dbInfo.version !== defaultVersion) {
                console.warn('The database "' + dbInfo.name + `" can't be downgraded from version ` + dbInfo.db.version + " to version " + dbInfo.version + ".");
              }
              dbInfo.version = dbInfo.db.version;
            }
            if (isUpgrade || isNewStore) {
              if (isNewStore) {
                var incVersion = dbInfo.db.version + 1;
                if (incVersion > dbInfo.version) {
                  dbInfo.version = incVersion;
                }
              }
              return true;
            }
            return false;
          }
          function _encodeBlob(blob) {
            return new Promise$1(function(resolve, reject) {
              var reader = new FileReader();
              reader.onerror = reject;
              reader.onloadend = function(e) {
                var base64 = btoa(e.target.result || "");
                resolve({
                  __local_forage_encoded_blob: true,
                  data: base64,
                  type: blob.type
                });
              };
              reader.readAsBinaryString(blob);
            });
          }
          function _decodeBlob(encodedBlob) {
            var arrayBuff = _binStringToArrayBuffer(atob(encodedBlob.data));
            return createBlob([arrayBuff], {
              type: encodedBlob.type
            });
          }
          function _isEncodedBlob(value) {
            return value && value.__local_forage_encoded_blob;
          }
          function _fullyReady(callback) {
            var self2 = this;
            var promise = self2._initReady().then(function() {
              var dbContext = dbContexts[self2._dbInfo.name];
              if (dbContext && dbContext.dbReady) {
                return dbContext.dbReady;
              }
            });
            executeTwoCallbacks(promise, callback, callback);
            return promise;
          }
          function _tryReconnect(dbInfo) {
            _deferReadiness(dbInfo);
            var dbContext = dbContexts[dbInfo.name];
            var forages = dbContext.forages;
            for (var i = 0; i < forages.length; i++) {
              var forage = forages[i];
              if (forage._dbInfo.db) {
                forage._dbInfo.db.close();
                forage._dbInfo.db = null;
              }
            }
            dbInfo.db = null;
            return _getOriginalConnection(dbInfo).then(function(db) {
              dbInfo.db = db;
              if (_isUpgradeNeeded(dbInfo)) {
                return _getUpgradedConnection(dbInfo);
              }
              return db;
            }).then(function(db) {
              dbInfo.db = dbContext.db = db;
              for (var i2 = 0; i2 < forages.length; i2++) {
                forages[i2]._dbInfo.db = db;
              }
            })["catch"](function(err) {
              _rejectReadiness(dbInfo, err);
              throw err;
            });
          }
          function createTransaction(dbInfo, mode, callback, retries) {
            if (retries === void 0) {
              retries = 1;
            }
            try {
              var tx = dbInfo.db.transaction(dbInfo.storeName, mode);
              callback(null, tx);
            } catch (err) {
              if (retries > 0 && (!dbInfo.db || err.name === "InvalidStateError" || err.name === "NotFoundError")) {
                return Promise$1.resolve().then(function() {
                  if (!dbInfo.db || err.name === "NotFoundError" && !dbInfo.db.objectStoreNames.contains(dbInfo.storeName) && dbInfo.version <= dbInfo.db.version) {
                    if (dbInfo.db) {
                      dbInfo.version = dbInfo.db.version + 1;
                    }
                    return _getUpgradedConnection(dbInfo);
                  }
                }).then(function() {
                  return _tryReconnect(dbInfo).then(function() {
                    createTransaction(dbInfo, mode, callback, retries - 1);
                  });
                })["catch"](callback);
              }
              callback(err);
            }
          }
          function createDbContext() {
            return {
              // Running localForages sharing a database.
              forages: [],
              // Shared database.
              db: null,
              // Database readiness (promise).
              dbReady: null,
              // Deferred operations on the database.
              deferredOperations: []
            };
          }
          function _initStorage(options) {
            var self2 = this;
            var dbInfo = {
              db: null
            };
            if (options) {
              for (var i in options) {
                dbInfo[i] = options[i];
              }
            }
            var dbContext = dbContexts[dbInfo.name];
            if (!dbContext) {
              dbContext = createDbContext();
              dbContexts[dbInfo.name] = dbContext;
            }
            dbContext.forages.push(self2);
            if (!self2._initReady) {
              self2._initReady = self2.ready;
              self2.ready = _fullyReady;
            }
            var initPromises = [];
            function ignoreErrors() {
              return Promise$1.resolve();
            }
            for (var j = 0; j < dbContext.forages.length; j++) {
              var forage = dbContext.forages[j];
              if (forage !== self2) {
                initPromises.push(forage._initReady()["catch"](ignoreErrors));
              }
            }
            var forages = dbContext.forages.slice(0);
            return Promise$1.all(initPromises).then(function() {
              dbInfo.db = dbContext.db;
              return _getOriginalConnection(dbInfo);
            }).then(function(db) {
              dbInfo.db = db;
              if (_isUpgradeNeeded(dbInfo, self2._defaultConfig.version)) {
                return _getUpgradedConnection(dbInfo);
              }
              return db;
            }).then(function(db) {
              dbInfo.db = dbContext.db = db;
              self2._dbInfo = dbInfo;
              for (var k = 0; k < forages.length; k++) {
                var forage2 = forages[k];
                if (forage2 !== self2) {
                  forage2._dbInfo.db = dbInfo.db;
                  forage2._dbInfo.version = dbInfo.version;
                }
              }
            });
          }
          function getItem(key2, callback) {
            var self2 = this;
            key2 = normalizeKey(key2);
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                createTransaction(self2._dbInfo, READ_ONLY, function(err, transaction) {
                  if (err) {
                    return reject(err);
                  }
                  try {
                    var store = transaction.objectStore(self2._dbInfo.storeName);
                    var req = store.get(key2);
                    req.onsuccess = function() {
                      var value = req.result;
                      if (value === void 0) {
                        value = null;
                      }
                      if (_isEncodedBlob(value)) {
                        value = _decodeBlob(value);
                      }
                      resolve(value);
                    };
                    req.onerror = function() {
                      reject(req.error);
                    };
                  } catch (e) {
                    reject(e);
                  }
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function iterate(iterator, callback) {
            var self2 = this;
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                createTransaction(self2._dbInfo, READ_ONLY, function(err, transaction) {
                  if (err) {
                    return reject(err);
                  }
                  try {
                    var store = transaction.objectStore(self2._dbInfo.storeName);
                    var req = store.openCursor();
                    var iterationNumber = 1;
                    req.onsuccess = function() {
                      var cursor = req.result;
                      if (cursor) {
                        var value = cursor.value;
                        if (_isEncodedBlob(value)) {
                          value = _decodeBlob(value);
                        }
                        var result = iterator(value, cursor.key, iterationNumber++);
                        if (result !== void 0) {
                          resolve(result);
                        } else {
                          cursor["continue"]();
                        }
                      } else {
                        resolve();
                      }
                    };
                    req.onerror = function() {
                      reject(req.error);
                    };
                  } catch (e) {
                    reject(e);
                  }
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function setItem(key2, value, callback) {
            var self2 = this;
            key2 = normalizeKey(key2);
            var promise = new Promise$1(function(resolve, reject) {
              var dbInfo;
              self2.ready().then(function() {
                dbInfo = self2._dbInfo;
                if (toString.call(value) === "[object Blob]") {
                  return _checkBlobSupport(dbInfo.db).then(function(blobSupport) {
                    if (blobSupport) {
                      return value;
                    }
                    return _encodeBlob(value);
                  });
                }
                return value;
              }).then(function(value2) {
                createTransaction(self2._dbInfo, READ_WRITE, function(err, transaction) {
                  if (err) {
                    return reject(err);
                  }
                  try {
                    var store = transaction.objectStore(self2._dbInfo.storeName);
                    if (value2 === null) {
                      value2 = void 0;
                    }
                    var req = store.put(value2, key2);
                    transaction.oncomplete = function() {
                      if (value2 === void 0) {
                        value2 = null;
                      }
                      resolve(value2);
                    };
                    transaction.onabort = transaction.onerror = function() {
                      var err2 = req.error ? req.error : req.transaction.error;
                      reject(err2);
                    };
                  } catch (e) {
                    reject(e);
                  }
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function removeItem(key2, callback) {
            var self2 = this;
            key2 = normalizeKey(key2);
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                createTransaction(self2._dbInfo, READ_WRITE, function(err, transaction) {
                  if (err) {
                    return reject(err);
                  }
                  try {
                    var store = transaction.objectStore(self2._dbInfo.storeName);
                    var req = store["delete"](key2);
                    transaction.oncomplete = function() {
                      resolve();
                    };
                    transaction.onerror = function() {
                      reject(req.error);
                    };
                    transaction.onabort = function() {
                      var err2 = req.error ? req.error : req.transaction.error;
                      reject(err2);
                    };
                  } catch (e) {
                    reject(e);
                  }
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function clear2(callback) {
            var self2 = this;
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                createTransaction(self2._dbInfo, READ_WRITE, function(err, transaction) {
                  if (err) {
                    return reject(err);
                  }
                  try {
                    var store = transaction.objectStore(self2._dbInfo.storeName);
                    var req = store.clear();
                    transaction.oncomplete = function() {
                      resolve();
                    };
                    transaction.onabort = transaction.onerror = function() {
                      var err2 = req.error ? req.error : req.transaction.error;
                      reject(err2);
                    };
                  } catch (e) {
                    reject(e);
                  }
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function length(callback) {
            var self2 = this;
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                createTransaction(self2._dbInfo, READ_ONLY, function(err, transaction) {
                  if (err) {
                    return reject(err);
                  }
                  try {
                    var store = transaction.objectStore(self2._dbInfo.storeName);
                    var req = store.count();
                    req.onsuccess = function() {
                      resolve(req.result);
                    };
                    req.onerror = function() {
                      reject(req.error);
                    };
                  } catch (e) {
                    reject(e);
                  }
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function key(n, callback) {
            var self2 = this;
            var promise = new Promise$1(function(resolve, reject) {
              if (n < 0) {
                resolve(null);
                return;
              }
              self2.ready().then(function() {
                createTransaction(self2._dbInfo, READ_ONLY, function(err, transaction) {
                  if (err) {
                    return reject(err);
                  }
                  try {
                    var store = transaction.objectStore(self2._dbInfo.storeName);
                    var advanced = false;
                    var req = store.openKeyCursor();
                    req.onsuccess = function() {
                      var cursor = req.result;
                      if (!cursor) {
                        resolve(null);
                        return;
                      }
                      if (n === 0) {
                        resolve(cursor.key);
                      } else {
                        if (!advanced) {
                          advanced = true;
                          cursor.advance(n);
                        } else {
                          resolve(cursor.key);
                        }
                      }
                    };
                    req.onerror = function() {
                      reject(req.error);
                    };
                  } catch (e) {
                    reject(e);
                  }
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function keys2(callback) {
            var self2 = this;
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                createTransaction(self2._dbInfo, READ_ONLY, function(err, transaction) {
                  if (err) {
                    return reject(err);
                  }
                  try {
                    var store = transaction.objectStore(self2._dbInfo.storeName);
                    var req = store.openKeyCursor();
                    var keys3 = [];
                    req.onsuccess = function() {
                      var cursor = req.result;
                      if (!cursor) {
                        resolve(keys3);
                        return;
                      }
                      keys3.push(cursor.key);
                      cursor["continue"]();
                    };
                    req.onerror = function() {
                      reject(req.error);
                    };
                  } catch (e) {
                    reject(e);
                  }
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function dropInstance(options, callback) {
            callback = getCallback.apply(this, arguments);
            var currentConfig = this.config();
            options = typeof options !== "function" && options || {};
            if (!options.name) {
              options.name = options.name || currentConfig.name;
              options.storeName = options.storeName || currentConfig.storeName;
            }
            var self2 = this;
            var promise;
            if (!options.name) {
              promise = Promise$1.reject("Invalid arguments");
            } else {
              var isCurrentDb = options.name === currentConfig.name && self2._dbInfo.db;
              var dbPromise = isCurrentDb ? Promise$1.resolve(self2._dbInfo.db) : _getOriginalConnection(options).then(function(db) {
                var dbContext = dbContexts[options.name];
                var forages = dbContext.forages;
                dbContext.db = db;
                for (var i = 0; i < forages.length; i++) {
                  forages[i]._dbInfo.db = db;
                }
                return db;
              });
              if (!options.storeName) {
                promise = dbPromise.then(function(db) {
                  _deferReadiness(options);
                  var dbContext = dbContexts[options.name];
                  var forages = dbContext.forages;
                  db.close();
                  for (var i = 0; i < forages.length; i++) {
                    var forage = forages[i];
                    forage._dbInfo.db = null;
                  }
                  var dropDBPromise = new Promise$1(function(resolve, reject) {
                    var req = idb.deleteDatabase(options.name);
                    req.onerror = function() {
                      var db2 = req.result;
                      if (db2) {
                        db2.close();
                      }
                      reject(req.error);
                    };
                    req.onblocked = function() {
                      console.warn('dropInstance blocked for database "' + options.name + '" until all open connections are closed');
                    };
                    req.onsuccess = function() {
                      var db2 = req.result;
                      if (db2) {
                        db2.close();
                      }
                      resolve(db2);
                    };
                  });
                  return dropDBPromise.then(function(db2) {
                    dbContext.db = db2;
                    for (var i2 = 0; i2 < forages.length; i2++) {
                      var _forage = forages[i2];
                      _advanceReadiness(_forage._dbInfo);
                    }
                  })["catch"](function(err) {
                    (_rejectReadiness(options, err) || Promise$1.resolve())["catch"](function() {
                    });
                    throw err;
                  });
                });
              } else {
                promise = dbPromise.then(function(db) {
                  if (!db.objectStoreNames.contains(options.storeName)) {
                    return;
                  }
                  var newVersion = db.version + 1;
                  _deferReadiness(options);
                  var dbContext = dbContexts[options.name];
                  var forages = dbContext.forages;
                  db.close();
                  for (var i = 0; i < forages.length; i++) {
                    var forage = forages[i];
                    forage._dbInfo.db = null;
                    forage._dbInfo.version = newVersion;
                  }
                  var dropObjectPromise = new Promise$1(function(resolve, reject) {
                    var req = idb.open(options.name, newVersion);
                    req.onerror = function(err) {
                      var db2 = req.result;
                      db2.close();
                      reject(err);
                    };
                    req.onupgradeneeded = function() {
                      var db2 = req.result;
                      db2.deleteObjectStore(options.storeName);
                    };
                    req.onsuccess = function() {
                      var db2 = req.result;
                      db2.close();
                      resolve(db2);
                    };
                  });
                  return dropObjectPromise.then(function(db2) {
                    dbContext.db = db2;
                    for (var j = 0; j < forages.length; j++) {
                      var _forage2 = forages[j];
                      _forage2._dbInfo.db = db2;
                      _advanceReadiness(_forage2._dbInfo);
                    }
                  })["catch"](function(err) {
                    (_rejectReadiness(options, err) || Promise$1.resolve())["catch"](function() {
                    });
                    throw err;
                  });
                });
              }
            }
            executeCallback(promise, callback);
            return promise;
          }
          var asyncStorage = {
            _driver: "asyncStorage",
            _initStorage,
            _support: isIndexedDBValid(),
            iterate,
            getItem,
            setItem,
            removeItem,
            clear: clear2,
            length,
            key,
            keys: keys2,
            dropInstance
          };
          function isWebSQLValid() {
            return typeof openDatabase === "function";
          }
          var BASE_CHARS = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
          var BLOB_TYPE_PREFIX = "~~local_forage_type~";
          var BLOB_TYPE_PREFIX_REGEX = /^~~local_forage_type~([^~]+)~/;
          var SERIALIZED_MARKER = "__lfsc__:";
          var SERIALIZED_MARKER_LENGTH = SERIALIZED_MARKER.length;
          var TYPE_ARRAYBUFFER = "arbf";
          var TYPE_BLOB = "blob";
          var TYPE_INT8ARRAY = "si08";
          var TYPE_UINT8ARRAY = "ui08";
          var TYPE_UINT8CLAMPEDARRAY = "uic8";
          var TYPE_INT16ARRAY = "si16";
          var TYPE_INT32ARRAY = "si32";
          var TYPE_UINT16ARRAY = "ur16";
          var TYPE_UINT32ARRAY = "ui32";
          var TYPE_FLOAT32ARRAY = "fl32";
          var TYPE_FLOAT64ARRAY = "fl64";
          var TYPE_SERIALIZED_MARKER_LENGTH = SERIALIZED_MARKER_LENGTH + TYPE_ARRAYBUFFER.length;
          var toString$1 = Object.prototype.toString;
          function stringToBuffer(serializedString) {
            var bufferLength = serializedString.length * 0.75;
            var len = serializedString.length;
            var i;
            var p = 0;
            var encoded1, encoded2, encoded3, encoded4;
            if (serializedString[serializedString.length - 1] === "=") {
              bufferLength--;
              if (serializedString[serializedString.length - 2] === "=") {
                bufferLength--;
              }
            }
            var buffer = new ArrayBuffer(bufferLength);
            var bytes = new Uint8Array(buffer);
            for (i = 0; i < len; i += 4) {
              encoded1 = BASE_CHARS.indexOf(serializedString[i]);
              encoded2 = BASE_CHARS.indexOf(serializedString[i + 1]);
              encoded3 = BASE_CHARS.indexOf(serializedString[i + 2]);
              encoded4 = BASE_CHARS.indexOf(serializedString[i + 3]);
              bytes[p++] = encoded1 << 2 | encoded2 >> 4;
              bytes[p++] = (encoded2 & 15) << 4 | encoded3 >> 2;
              bytes[p++] = (encoded3 & 3) << 6 | encoded4 & 63;
            }
            return buffer;
          }
          function bufferToString(buffer) {
            var bytes = new Uint8Array(buffer);
            var base64String = "";
            var i;
            for (i = 0; i < bytes.length; i += 3) {
              base64String += BASE_CHARS[bytes[i] >> 2];
              base64String += BASE_CHARS[(bytes[i] & 3) << 4 | bytes[i + 1] >> 4];
              base64String += BASE_CHARS[(bytes[i + 1] & 15) << 2 | bytes[i + 2] >> 6];
              base64String += BASE_CHARS[bytes[i + 2] & 63];
            }
            if (bytes.length % 3 === 2) {
              base64String = base64String.substring(0, base64String.length - 1) + "=";
            } else if (bytes.length % 3 === 1) {
              base64String = base64String.substring(0, base64String.length - 2) + "==";
            }
            return base64String;
          }
          function serialize(value, callback) {
            var valueType = "";
            if (value) {
              valueType = toString$1.call(value);
            }
            if (value && (valueType === "[object ArrayBuffer]" || value.buffer && toString$1.call(value.buffer) === "[object ArrayBuffer]")) {
              var buffer;
              var marker = SERIALIZED_MARKER;
              if (value instanceof ArrayBuffer) {
                buffer = value;
                marker += TYPE_ARRAYBUFFER;
              } else {
                buffer = value.buffer;
                if (valueType === "[object Int8Array]") {
                  marker += TYPE_INT8ARRAY;
                } else if (valueType === "[object Uint8Array]") {
                  marker += TYPE_UINT8ARRAY;
                } else if (valueType === "[object Uint8ClampedArray]") {
                  marker += TYPE_UINT8CLAMPEDARRAY;
                } else if (valueType === "[object Int16Array]") {
                  marker += TYPE_INT16ARRAY;
                } else if (valueType === "[object Uint16Array]") {
                  marker += TYPE_UINT16ARRAY;
                } else if (valueType === "[object Int32Array]") {
                  marker += TYPE_INT32ARRAY;
                } else if (valueType === "[object Uint32Array]") {
                  marker += TYPE_UINT32ARRAY;
                } else if (valueType === "[object Float32Array]") {
                  marker += TYPE_FLOAT32ARRAY;
                } else if (valueType === "[object Float64Array]") {
                  marker += TYPE_FLOAT64ARRAY;
                } else {
                  callback(new Error("Failed to get type for BinaryArray"));
                }
              }
              callback(marker + bufferToString(buffer));
            } else if (valueType === "[object Blob]") {
              var fileReader = new FileReader();
              fileReader.onload = function() {
                var str = BLOB_TYPE_PREFIX + value.type + "~" + bufferToString(this.result);
                callback(SERIALIZED_MARKER + TYPE_BLOB + str);
              };
              fileReader.readAsArrayBuffer(value);
            } else {
              try {
                callback(JSON.stringify(value));
              } catch (e) {
                console.error("Couldn't convert value into a JSON string: ", value);
                callback(null, e);
              }
            }
          }
          function deserialize(value) {
            if (value.substring(0, SERIALIZED_MARKER_LENGTH) !== SERIALIZED_MARKER) {
              return JSON.parse(value);
            }
            var serializedString = value.substring(TYPE_SERIALIZED_MARKER_LENGTH);
            var type = value.substring(SERIALIZED_MARKER_LENGTH, TYPE_SERIALIZED_MARKER_LENGTH);
            var blobType;
            if (type === TYPE_BLOB && BLOB_TYPE_PREFIX_REGEX.test(serializedString)) {
              var matcher = serializedString.match(BLOB_TYPE_PREFIX_REGEX);
              blobType = matcher[1];
              serializedString = serializedString.substring(matcher[0].length);
            }
            var buffer = stringToBuffer(serializedString);
            switch (type) {
              case TYPE_ARRAYBUFFER:
                return buffer;
              case TYPE_BLOB:
                return createBlob([buffer], {
                  type: blobType
                });
              case TYPE_INT8ARRAY:
                return new Int8Array(buffer);
              case TYPE_UINT8ARRAY:
                return new Uint8Array(buffer);
              case TYPE_UINT8CLAMPEDARRAY:
                return new Uint8ClampedArray(buffer);
              case TYPE_INT16ARRAY:
                return new Int16Array(buffer);
              case TYPE_UINT16ARRAY:
                return new Uint16Array(buffer);
              case TYPE_INT32ARRAY:
                return new Int32Array(buffer);
              case TYPE_UINT32ARRAY:
                return new Uint32Array(buffer);
              case TYPE_FLOAT32ARRAY:
                return new Float32Array(buffer);
              case TYPE_FLOAT64ARRAY:
                return new Float64Array(buffer);
              default:
                throw new Error("Unkown type: " + type);
            }
          }
          var localforageSerializer = {
            serialize,
            deserialize,
            stringToBuffer,
            bufferToString
          };
          function createDbTable(t, dbInfo, callback, errorCallback) {
            t.executeSql("CREATE TABLE IF NOT EXISTS " + dbInfo.storeName + " (id INTEGER PRIMARY KEY, key unique, value)", [], callback, errorCallback);
          }
          function _initStorage$1(options) {
            var self2 = this;
            var dbInfo = {
              db: null
            };
            if (options) {
              for (var i in options) {
                dbInfo[i] = typeof options[i] !== "string" ? options[i].toString() : options[i];
              }
            }
            var dbInfoPromise = new Promise$1(function(resolve, reject) {
              try {
                dbInfo.db = openDatabase(dbInfo.name, String(dbInfo.version), dbInfo.description, dbInfo.size);
              } catch (e) {
                return reject(e);
              }
              dbInfo.db.transaction(function(t) {
                createDbTable(t, dbInfo, function() {
                  self2._dbInfo = dbInfo;
                  resolve();
                }, function(t2, error) {
                  reject(error);
                });
              }, reject);
            });
            dbInfo.serializer = localforageSerializer;
            return dbInfoPromise;
          }
          function tryExecuteSql(t, dbInfo, sqlStatement, args, callback, errorCallback) {
            t.executeSql(sqlStatement, args, callback, function(t2, error) {
              if (error.code === error.SYNTAX_ERR) {
                t2.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?", [dbInfo.storeName], function(t3, results) {
                  if (!results.rows.length) {
                    createDbTable(t3, dbInfo, function() {
                      t3.executeSql(sqlStatement, args, callback, errorCallback);
                    }, errorCallback);
                  } else {
                    errorCallback(t3, error);
                  }
                }, errorCallback);
              } else {
                errorCallback(t2, error);
              }
            }, errorCallback);
          }
          function getItem$1(key2, callback) {
            var self2 = this;
            key2 = normalizeKey(key2);
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                var dbInfo = self2._dbInfo;
                dbInfo.db.transaction(function(t) {
                  tryExecuteSql(t, dbInfo, "SELECT * FROM " + dbInfo.storeName + " WHERE key = ? LIMIT 1", [key2], function(t2, results) {
                    var result = results.rows.length ? results.rows.item(0).value : null;
                    if (result) {
                      result = dbInfo.serializer.deserialize(result);
                    }
                    resolve(result);
                  }, function(t2, error) {
                    reject(error);
                  });
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function iterate$1(iterator, callback) {
            var self2 = this;
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                var dbInfo = self2._dbInfo;
                dbInfo.db.transaction(function(t) {
                  tryExecuteSql(t, dbInfo, "SELECT * FROM " + dbInfo.storeName, [], function(t2, results) {
                    var rows = results.rows;
                    var length2 = rows.length;
                    for (var i = 0; i < length2; i++) {
                      var item = rows.item(i);
                      var result = item.value;
                      if (result) {
                        result = dbInfo.serializer.deserialize(result);
                      }
                      result = iterator(result, item.key, i + 1);
                      if (result !== void 0) {
                        resolve(result);
                        return;
                      }
                    }
                    resolve();
                  }, function(t2, error) {
                    reject(error);
                  });
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function _setItem(key2, value, callback, retriesLeft) {
            var self2 = this;
            key2 = normalizeKey(key2);
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                if (value === void 0) {
                  value = null;
                }
                var originalValue = value;
                var dbInfo = self2._dbInfo;
                dbInfo.serializer.serialize(value, function(value2, error) {
                  if (error) {
                    reject(error);
                  } else {
                    dbInfo.db.transaction(function(t) {
                      tryExecuteSql(t, dbInfo, "INSERT OR REPLACE INTO " + dbInfo.storeName + " (key, value) VALUES (?, ?)", [key2, value2], function() {
                        resolve(originalValue);
                      }, function(t2, error2) {
                        reject(error2);
                      });
                    }, function(sqlError) {
                      if (sqlError.code === sqlError.QUOTA_ERR) {
                        if (retriesLeft > 0) {
                          resolve(_setItem.apply(self2, [key2, originalValue, callback, retriesLeft - 1]));
                          return;
                        }
                        reject(sqlError);
                      }
                    });
                  }
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function setItem$1(key2, value, callback) {
            return _setItem.apply(this, [key2, value, callback, 1]);
          }
          function removeItem$1(key2, callback) {
            var self2 = this;
            key2 = normalizeKey(key2);
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                var dbInfo = self2._dbInfo;
                dbInfo.db.transaction(function(t) {
                  tryExecuteSql(t, dbInfo, "DELETE FROM " + dbInfo.storeName + " WHERE key = ?", [key2], function() {
                    resolve();
                  }, function(t2, error) {
                    reject(error);
                  });
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function clear$1(callback) {
            var self2 = this;
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                var dbInfo = self2._dbInfo;
                dbInfo.db.transaction(function(t) {
                  tryExecuteSql(t, dbInfo, "DELETE FROM " + dbInfo.storeName, [], function() {
                    resolve();
                  }, function(t2, error) {
                    reject(error);
                  });
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function length$1(callback) {
            var self2 = this;
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                var dbInfo = self2._dbInfo;
                dbInfo.db.transaction(function(t) {
                  tryExecuteSql(t, dbInfo, "SELECT COUNT(key) as c FROM " + dbInfo.storeName, [], function(t2, results) {
                    var result = results.rows.item(0).c;
                    resolve(result);
                  }, function(t2, error) {
                    reject(error);
                  });
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function key$1(n, callback) {
            var self2 = this;
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                var dbInfo = self2._dbInfo;
                dbInfo.db.transaction(function(t) {
                  tryExecuteSql(t, dbInfo, "SELECT key FROM " + dbInfo.storeName + " WHERE id = ? LIMIT 1", [n + 1], function(t2, results) {
                    var result = results.rows.length ? results.rows.item(0).key : null;
                    resolve(result);
                  }, function(t2, error) {
                    reject(error);
                  });
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function keys$1(callback) {
            var self2 = this;
            var promise = new Promise$1(function(resolve, reject) {
              self2.ready().then(function() {
                var dbInfo = self2._dbInfo;
                dbInfo.db.transaction(function(t) {
                  tryExecuteSql(t, dbInfo, "SELECT key FROM " + dbInfo.storeName, [], function(t2, results) {
                    var keys3 = [];
                    for (var i = 0; i < results.rows.length; i++) {
                      keys3.push(results.rows.item(i).key);
                    }
                    resolve(keys3);
                  }, function(t2, error) {
                    reject(error);
                  });
                });
              })["catch"](reject);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function getAllStoreNames(db) {
            return new Promise$1(function(resolve, reject) {
              db.transaction(function(t) {
                t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'", [], function(t2, results) {
                  var storeNames = [];
                  for (var i = 0; i < results.rows.length; i++) {
                    storeNames.push(results.rows.item(i).name);
                  }
                  resolve({
                    db,
                    storeNames
                  });
                }, function(t2, error) {
                  reject(error);
                });
              }, function(sqlError) {
                reject(sqlError);
              });
            });
          }
          function dropInstance$1(options, callback) {
            callback = getCallback.apply(this, arguments);
            var currentConfig = this.config();
            options = typeof options !== "function" && options || {};
            if (!options.name) {
              options.name = options.name || currentConfig.name;
              options.storeName = options.storeName || currentConfig.storeName;
            }
            var self2 = this;
            var promise;
            if (!options.name) {
              promise = Promise$1.reject("Invalid arguments");
            } else {
              promise = new Promise$1(function(resolve) {
                var db;
                if (options.name === currentConfig.name) {
                  db = self2._dbInfo.db;
                } else {
                  db = openDatabase(options.name, "", "", 0);
                }
                if (!options.storeName) {
                  resolve(getAllStoreNames(db));
                } else {
                  resolve({
                    db,
                    storeNames: [options.storeName]
                  });
                }
              }).then(function(operationInfo) {
                return new Promise$1(function(resolve, reject) {
                  operationInfo.db.transaction(function(t) {
                    function dropTable(storeName) {
                      return new Promise$1(function(resolve2, reject2) {
                        t.executeSql("DROP TABLE IF EXISTS " + storeName, [], function() {
                          resolve2();
                        }, function(t2, error) {
                          reject2(error);
                        });
                      });
                    }
                    var operations = [];
                    for (var i = 0, len = operationInfo.storeNames.length; i < len; i++) {
                      operations.push(dropTable(operationInfo.storeNames[i]));
                    }
                    Promise$1.all(operations).then(function() {
                      resolve();
                    })["catch"](function(e) {
                      reject(e);
                    });
                  }, function(sqlError) {
                    reject(sqlError);
                  });
                });
              });
            }
            executeCallback(promise, callback);
            return promise;
          }
          var webSQLStorage = {
            _driver: "webSQLStorage",
            _initStorage: _initStorage$1,
            _support: isWebSQLValid(),
            iterate: iterate$1,
            getItem: getItem$1,
            setItem: setItem$1,
            removeItem: removeItem$1,
            clear: clear$1,
            length: length$1,
            key: key$1,
            keys: keys$1,
            dropInstance: dropInstance$1
          };
          function isLocalStorageValid() {
            try {
              return typeof localStorage !== "undefined" && "setItem" in localStorage && // in IE8 typeof localStorage.setItem === 'object'
              !!localStorage.setItem;
            } catch (e) {
              return false;
            }
          }
          function _getKeyPrefix(options, defaultConfig) {
            var keyPrefix = options.name + "/";
            if (options.storeName !== defaultConfig.storeName) {
              keyPrefix += options.storeName + "/";
            }
            return keyPrefix;
          }
          function checkIfLocalStorageThrows() {
            var localStorageTestKey = "_localforage_support_test";
            try {
              localStorage.setItem(localStorageTestKey, true);
              localStorage.removeItem(localStorageTestKey);
              return false;
            } catch (e) {
              return true;
            }
          }
          function _isLocalStorageUsable() {
            return !checkIfLocalStorageThrows() || localStorage.length > 0;
          }
          function _initStorage$2(options) {
            var self2 = this;
            var dbInfo = {};
            if (options) {
              for (var i in options) {
                dbInfo[i] = options[i];
              }
            }
            dbInfo.keyPrefix = _getKeyPrefix(options, self2._defaultConfig);
            if (!_isLocalStorageUsable()) {
              return Promise$1.reject();
            }
            self2._dbInfo = dbInfo;
            dbInfo.serializer = localforageSerializer;
            return Promise$1.resolve();
          }
          function clear$2(callback) {
            var self2 = this;
            var promise = self2.ready().then(function() {
              var keyPrefix = self2._dbInfo.keyPrefix;
              for (var i = localStorage.length - 1; i >= 0; i--) {
                var key2 = localStorage.key(i);
                if (key2.indexOf(keyPrefix) === 0) {
                  localStorage.removeItem(key2);
                }
              }
            });
            executeCallback(promise, callback);
            return promise;
          }
          function getItem$2(key2, callback) {
            var self2 = this;
            key2 = normalizeKey(key2);
            var promise = self2.ready().then(function() {
              var dbInfo = self2._dbInfo;
              var result = localStorage.getItem(dbInfo.keyPrefix + key2);
              if (result) {
                result = dbInfo.serializer.deserialize(result);
              }
              return result;
            });
            executeCallback(promise, callback);
            return promise;
          }
          function iterate$2(iterator, callback) {
            var self2 = this;
            var promise = self2.ready().then(function() {
              var dbInfo = self2._dbInfo;
              var keyPrefix = dbInfo.keyPrefix;
              var keyPrefixLength = keyPrefix.length;
              var length2 = localStorage.length;
              var iterationNumber = 1;
              for (var i = 0; i < length2; i++) {
                var key2 = localStorage.key(i);
                if (key2.indexOf(keyPrefix) !== 0) {
                  continue;
                }
                var value = localStorage.getItem(key2);
                if (value) {
                  value = dbInfo.serializer.deserialize(value);
                }
                value = iterator(value, key2.substring(keyPrefixLength), iterationNumber++);
                if (value !== void 0) {
                  return value;
                }
              }
            });
            executeCallback(promise, callback);
            return promise;
          }
          function key$2(n, callback) {
            var self2 = this;
            var promise = self2.ready().then(function() {
              var dbInfo = self2._dbInfo;
              var result;
              try {
                result = localStorage.key(n);
              } catch (error) {
                result = null;
              }
              if (result) {
                result = result.substring(dbInfo.keyPrefix.length);
              }
              return result;
            });
            executeCallback(promise, callback);
            return promise;
          }
          function keys$2(callback) {
            var self2 = this;
            var promise = self2.ready().then(function() {
              var dbInfo = self2._dbInfo;
              var length2 = localStorage.length;
              var keys3 = [];
              for (var i = 0; i < length2; i++) {
                var itemKey = localStorage.key(i);
                if (itemKey.indexOf(dbInfo.keyPrefix) === 0) {
                  keys3.push(itemKey.substring(dbInfo.keyPrefix.length));
                }
              }
              return keys3;
            });
            executeCallback(promise, callback);
            return promise;
          }
          function length$2(callback) {
            var self2 = this;
            var promise = self2.keys().then(function(keys3) {
              return keys3.length;
            });
            executeCallback(promise, callback);
            return promise;
          }
          function removeItem$2(key2, callback) {
            var self2 = this;
            key2 = normalizeKey(key2);
            var promise = self2.ready().then(function() {
              var dbInfo = self2._dbInfo;
              localStorage.removeItem(dbInfo.keyPrefix + key2);
            });
            executeCallback(promise, callback);
            return promise;
          }
          function setItem$2(key2, value, callback) {
            var self2 = this;
            key2 = normalizeKey(key2);
            var promise = self2.ready().then(function() {
              if (value === void 0) {
                value = null;
              }
              var originalValue = value;
              return new Promise$1(function(resolve, reject) {
                var dbInfo = self2._dbInfo;
                dbInfo.serializer.serialize(value, function(value2, error) {
                  if (error) {
                    reject(error);
                  } else {
                    try {
                      localStorage.setItem(dbInfo.keyPrefix + key2, value2);
                      resolve(originalValue);
                    } catch (e) {
                      if (e.name === "QuotaExceededError" || e.name === "NS_ERROR_DOM_QUOTA_REACHED") {
                        reject(e);
                      }
                      reject(e);
                    }
                  }
                });
              });
            });
            executeCallback(promise, callback);
            return promise;
          }
          function dropInstance$2(options, callback) {
            callback = getCallback.apply(this, arguments);
            options = typeof options !== "function" && options || {};
            if (!options.name) {
              var currentConfig = this.config();
              options.name = options.name || currentConfig.name;
              options.storeName = options.storeName || currentConfig.storeName;
            }
            var self2 = this;
            var promise;
            if (!options.name) {
              promise = Promise$1.reject("Invalid arguments");
            } else {
              promise = new Promise$1(function(resolve) {
                if (!options.storeName) {
                  resolve(options.name + "/");
                } else {
                  resolve(_getKeyPrefix(options, self2._defaultConfig));
                }
              }).then(function(keyPrefix) {
                for (var i = localStorage.length - 1; i >= 0; i--) {
                  var key2 = localStorage.key(i);
                  if (key2.indexOf(keyPrefix) === 0) {
                    localStorage.removeItem(key2);
                  }
                }
              });
            }
            executeCallback(promise, callback);
            return promise;
          }
          var localStorageWrapper = {
            _driver: "localStorageWrapper",
            _initStorage: _initStorage$2,
            _support: isLocalStorageValid(),
            iterate: iterate$2,
            getItem: getItem$2,
            setItem: setItem$2,
            removeItem: removeItem$2,
            clear: clear$2,
            length: length$2,
            key: key$2,
            keys: keys$2,
            dropInstance: dropInstance$2
          };
          var sameValue = function sameValue2(x, y) {
            return x === y || typeof x === "number" && typeof y === "number" && isNaN(x) && isNaN(y);
          };
          var includes = function includes2(array, searchElement) {
            var len = array.length;
            var i = 0;
            while (i < len) {
              if (sameValue(array[i], searchElement)) {
                return true;
              }
              i++;
            }
            return false;
          };
          var isArray = Array.isArray || function(arg) {
            return Object.prototype.toString.call(arg) === "[object Array]";
          };
          var DefinedDrivers = {};
          var DriverSupport = {};
          var DefaultDrivers = {
            INDEXEDDB: asyncStorage,
            WEBSQL: webSQLStorage,
            LOCALSTORAGE: localStorageWrapper
          };
          var DefaultDriverOrder = [DefaultDrivers.INDEXEDDB._driver, DefaultDrivers.WEBSQL._driver, DefaultDrivers.LOCALSTORAGE._driver];
          var OptionalDriverMethods = ["dropInstance"];
          var LibraryMethods = ["clear", "getItem", "iterate", "key", "keys", "length", "removeItem", "setItem"].concat(OptionalDriverMethods);
          var DefaultConfig = {
            description: "",
            driver: DefaultDriverOrder.slice(),
            name: "localforage",
            // Default DB size is _JUST UNDER_ 5MB, as it's the highest size
            // we can use without a prompt.
            size: 4980736,
            storeName: "keyvaluepairs",
            version: 1
          };
          function callWhenReady(localForageInstance, libraryMethod) {
            localForageInstance[libraryMethod] = function() {
              var _args = arguments;
              return localForageInstance.ready().then(function() {
                return localForageInstance[libraryMethod].apply(localForageInstance, _args);
              });
            };
          }
          function extend() {
            for (var i = 1; i < arguments.length; i++) {
              var arg = arguments[i];
              if (arg) {
                for (var _key in arg) {
                  if (arg.hasOwnProperty(_key)) {
                    if (isArray(arg[_key])) {
                      arguments[0][_key] = arg[_key].slice();
                    } else {
                      arguments[0][_key] = arg[_key];
                    }
                  }
                }
              }
            }
            return arguments[0];
          }
          var LocalForage2 = function() {
            function LocalForage3(options) {
              _classCallCheck(this, LocalForage3);
              for (var driverTypeKey in DefaultDrivers) {
                if (DefaultDrivers.hasOwnProperty(driverTypeKey)) {
                  var driver = DefaultDrivers[driverTypeKey];
                  var driverName = driver._driver;
                  this[driverTypeKey] = driverName;
                  if (!DefinedDrivers[driverName]) {
                    this.defineDriver(driver);
                  }
                }
              }
              this._defaultConfig = extend({}, DefaultConfig);
              this._config = extend({}, this._defaultConfig, options);
              this._driverSet = null;
              this._initDriver = null;
              this._ready = false;
              this._dbInfo = null;
              this._wrapLibraryMethodsWithReady();
              this.setDriver(this._config.driver)["catch"](function() {
              });
            }
            LocalForage3.prototype.config = function config(options) {
              if ((typeof options === "undefined" ? "undefined" : _typeof(options)) === "object") {
                if (this._ready) {
                  return new Error("Can't call config() after localforage has been used.");
                }
                for (var i in options) {
                  if (i === "storeName") {
                    options[i] = options[i].replace(/\W/g, "_");
                  }
                  if (i === "version" && typeof options[i] !== "number") {
                    return new Error("Database version must be a number.");
                  }
                  this._config[i] = options[i];
                }
                if ("driver" in options && options.driver) {
                  return this.setDriver(this._config.driver);
                }
                return true;
              } else if (typeof options === "string") {
                return this._config[options];
              } else {
                return this._config;
              }
            };
            LocalForage3.prototype.defineDriver = function defineDriver(driverObject, callback, errorCallback) {
              var promise = new Promise$1(function(resolve, reject) {
                try {
                  var driverName = driverObject._driver;
                  var complianceError = new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");
                  if (!driverObject._driver) {
                    reject(complianceError);
                    return;
                  }
                  var driverMethods = LibraryMethods.concat("_initStorage");
                  for (var i = 0, len = driverMethods.length; i < len; i++) {
                    var driverMethodName = driverMethods[i];
                    var isRequired = !includes(OptionalDriverMethods, driverMethodName);
                    if ((isRequired || driverObject[driverMethodName]) && typeof driverObject[driverMethodName] !== "function") {
                      reject(complianceError);
                      return;
                    }
                  }
                  var configureMissingMethods = function configureMissingMethods2() {
                    var methodNotImplementedFactory = function methodNotImplementedFactory2(methodName) {
                      return function() {
                        var error = new Error("Method " + methodName + " is not implemented by the current driver");
                        var promise2 = Promise$1.reject(error);
                        executeCallback(promise2, arguments[arguments.length - 1]);
                        return promise2;
                      };
                    };
                    for (var _i = 0, _len = OptionalDriverMethods.length; _i < _len; _i++) {
                      var optionalDriverMethod = OptionalDriverMethods[_i];
                      if (!driverObject[optionalDriverMethod]) {
                        driverObject[optionalDriverMethod] = methodNotImplementedFactory(optionalDriverMethod);
                      }
                    }
                  };
                  configureMissingMethods();
                  var setDriverSupport = function setDriverSupport2(support) {
                    if (DefinedDrivers[driverName]) {
                      console.info("Redefining LocalForage driver: " + driverName);
                    }
                    DefinedDrivers[driverName] = driverObject;
                    DriverSupport[driverName] = support;
                    resolve();
                  };
                  if ("_support" in driverObject) {
                    if (driverObject._support && typeof driverObject._support === "function") {
                      driverObject._support().then(setDriverSupport, reject);
                    } else {
                      setDriverSupport(!!driverObject._support);
                    }
                  } else {
                    setDriverSupport(true);
                  }
                } catch (e) {
                  reject(e);
                }
              });
              executeTwoCallbacks(promise, callback, errorCallback);
              return promise;
            };
            LocalForage3.prototype.driver = function driver() {
              return this._driver || null;
            };
            LocalForage3.prototype.getDriver = function getDriver(driverName, callback, errorCallback) {
              var getDriverPromise = DefinedDrivers[driverName] ? Promise$1.resolve(DefinedDrivers[driverName]) : Promise$1.reject(new Error("Driver not found."));
              executeTwoCallbacks(getDriverPromise, callback, errorCallback);
              return getDriverPromise;
            };
            LocalForage3.prototype.getSerializer = function getSerializer(callback) {
              var serializerPromise = Promise$1.resolve(localforageSerializer);
              executeTwoCallbacks(serializerPromise, callback);
              return serializerPromise;
            };
            LocalForage3.prototype.ready = function ready(callback) {
              var self2 = this;
              var promise = self2._driverSet.then(function() {
                if (self2._ready === null) {
                  self2._ready = self2._initDriver();
                }
                return self2._ready;
              });
              executeTwoCallbacks(promise, callback, callback);
              return promise;
            };
            LocalForage3.prototype.setDriver = function setDriver(drivers, callback, errorCallback) {
              var self2 = this;
              if (!isArray(drivers)) {
                drivers = [drivers];
              }
              var supportedDrivers = this._getSupportedDrivers(drivers);
              function setDriverToConfig() {
                self2._config.driver = self2.driver();
              }
              function extendSelfWithDriver(driver) {
                self2._extend(driver);
                setDriverToConfig();
                self2._ready = self2._initStorage(self2._config);
                return self2._ready;
              }
              function initDriver(supportedDrivers2) {
                return function() {
                  var currentDriverIndex = 0;
                  function driverPromiseLoop() {
                    while (currentDriverIndex < supportedDrivers2.length) {
                      var driverName = supportedDrivers2[currentDriverIndex];
                      currentDriverIndex++;
                      self2._dbInfo = null;
                      self2._ready = null;
                      return self2.getDriver(driverName).then(extendSelfWithDriver)["catch"](driverPromiseLoop);
                    }
                    setDriverToConfig();
                    var error = new Error("No available storage method found.");
                    self2._driverSet = Promise$1.reject(error);
                    return self2._driverSet;
                  }
                  return driverPromiseLoop();
                };
              }
              var oldDriverSetDone = this._driverSet !== null ? this._driverSet["catch"](function() {
                return Promise$1.resolve();
              }) : Promise$1.resolve();
              this._driverSet = oldDriverSetDone.then(function() {
                var driverName = supportedDrivers[0];
                self2._dbInfo = null;
                self2._ready = null;
                return self2.getDriver(driverName).then(function(driver) {
                  self2._driver = driver._driver;
                  setDriverToConfig();
                  self2._wrapLibraryMethodsWithReady();
                  self2._initDriver = initDriver(supportedDrivers);
                });
              })["catch"](function() {
                setDriverToConfig();
                var error = new Error("No available storage method found.");
                self2._driverSet = Promise$1.reject(error);
                return self2._driverSet;
              });
              executeTwoCallbacks(this._driverSet, callback, errorCallback);
              return this._driverSet;
            };
            LocalForage3.prototype.supports = function supports(driverName) {
              return !!DriverSupport[driverName];
            };
            LocalForage3.prototype._extend = function _extend(libraryMethodsAndProperties) {
              extend(this, libraryMethodsAndProperties);
            };
            LocalForage3.prototype._getSupportedDrivers = function _getSupportedDrivers(drivers) {
              var supportedDrivers = [];
              for (var i = 0, len = drivers.length; i < len; i++) {
                var driverName = drivers[i];
                if (this.supports(driverName)) {
                  supportedDrivers.push(driverName);
                }
              }
              return supportedDrivers;
            };
            LocalForage3.prototype._wrapLibraryMethodsWithReady = function _wrapLibraryMethodsWithReady() {
              for (var i = 0, len = LibraryMethods.length; i < len; i++) {
                callWhenReady(this, LibraryMethods[i]);
              }
            };
            LocalForage3.prototype.createInstance = function createInstance2(options) {
              return new LocalForage3(options);
            };
            return LocalForage3;
          }();
          var localforage_js = new LocalForage2();
          module3.exports = localforage_js;
        }, {
          "3": 3
        }]
      }, {}, [4])(4);
    });
  }
});

// node_modules/lokijs/src/loki-indexed-adapter.js
var require_loki_indexed_adapter = __commonJS({
  "node_modules/lokijs/src/loki-indexed-adapter.js"(exports, module) {
    "use strict";
    (function(root, factory) {
      if (typeof define === "function" && define.amd) {
        define([], factory);
      } else if (typeof exports === "object") {
        module.exports = factory();
      } else {
        root.LokiIndexedAdapter = factory();
      }
    })(exports, function() {
      return function() {
        function LokiIndexedAdapter2(appname, options) {
          this.app = "loki";
          this.options = options || {};
          if (typeof appname !== "undefined") {
            this.app = appname;
          }
          this.catalog = null;
          if (!this.checkAvailability()) {
            throw new Error("indexedDB does not seem to be supported for your environment");
          }
        }
        LokiIndexedAdapter2.prototype.closeDatabase = function() {
          if (this.catalog && this.catalog.db) {
            this.catalog.db.close();
            this.catalog.db = null;
          }
        };
        LokiIndexedAdapter2.prototype.checkAvailability = function() {
          if (typeof indexedDB !== "undefined" && indexedDB) return true;
          return false;
        };
        LokiIndexedAdapter2.prototype.loadDatabase = function(dbname, callback) {
          var appName = this.app;
          var adapter = this;
          if (this.catalog === null || this.catalog.db === null) {
            this.catalog = new LokiCatalog(function(cat) {
              adapter.catalog = cat;
              adapter.loadDatabase(dbname, callback);
            });
            return;
          }
          this.catalog.getAppKey(appName, dbname, function(result) {
            if (typeof callback === "function") {
              if (result.id === 0) {
                callback(null);
                return;
              }
              callback(result.val);
            } else {
              console.log(result.val);
            }
          });
        };
        LokiIndexedAdapter2.prototype.loadKey = LokiIndexedAdapter2.prototype.loadDatabase;
        LokiIndexedAdapter2.prototype.saveDatabase = function(dbname, dbstring, callback) {
          var appName = this.app;
          var adapter = this;
          function saveCallback(result) {
            if (result && result.success === true) {
              callback(null);
            } else {
              callback(new Error("Error saving database"));
            }
            if (adapter.options.closeAfterSave) {
              adapter.closeDatabase();
            }
          }
          if (this.catalog === null || this.catalog.db === null) {
            this.catalog = new LokiCatalog(function(cat) {
              adapter.saveDatabase(dbname, dbstring, saveCallback);
            });
            return;
          }
          this.catalog.setAppKey(appName, dbname, dbstring, saveCallback);
        };
        LokiIndexedAdapter2.prototype.saveKey = LokiIndexedAdapter2.prototype.saveDatabase;
        LokiIndexedAdapter2.prototype.deleteDatabase = function(dbname, callback) {
          var appName = this.app;
          var adapter = this;
          if (this.catalog === null || this.catalog.db === null) {
            this.catalog = new LokiCatalog(function(cat) {
              adapter.catalog = cat;
              adapter.deleteDatabase(dbname, callback);
            });
            return;
          }
          this.catalog.getAppKey(appName, dbname, function(result) {
            var id = result.id;
            if (id !== 0) {
              adapter.catalog.deleteAppKey(id, callback);
            } else if (typeof callback === "function") {
              callback({
                success: true
              });
            }
          });
        };
        LokiIndexedAdapter2.prototype.deleteKey = LokiIndexedAdapter2.prototype.deleteDatabase;
        LokiIndexedAdapter2.prototype.deleteDatabasePartitions = function(dbname) {
          var self2 = this;
          this.getDatabaseList(function(result) {
            result.forEach(function(str) {
              if (str.startsWith(dbname)) {
                self2.deleteDatabase(str);
              }
            });
          });
        };
        LokiIndexedAdapter2.prototype.getDatabaseList = function(callback) {
          var appName = this.app;
          var adapter = this;
          if (this.catalog === null || this.catalog.db === null) {
            this.catalog = new LokiCatalog(function(cat) {
              adapter.catalog = cat;
              adapter.getDatabaseList(callback);
            });
            return;
          }
          this.catalog.getAppKeys(appName, function(results) {
            var names = [];
            for (var idx = 0; idx < results.length; idx++) {
              names.push(results[idx].key);
            }
            if (typeof callback === "function") {
              callback(names);
            } else {
              names.forEach(function(obj) {
                console.log(obj);
              });
            }
          });
        };
        LokiIndexedAdapter2.prototype.getKeyList = LokiIndexedAdapter2.prototype.getDatabaseList;
        LokiIndexedAdapter2.prototype.getCatalogSummary = function(callback) {
          var appName = this.app;
          var adapter = this;
          if (this.catalog === null || this.catalog.db === null) {
            this.catalog = new LokiCatalog(function(cat) {
              adapter.catalog = cat;
              adapter.getCatalogSummary(callback);
            });
            return;
          }
          this.catalog.getAllKeys(function(results) {
            var entries = [];
            var obj, size, oapp, okey, oval;
            for (var idx = 0; idx < results.length; idx++) {
              obj = results[idx];
              oapp = obj.app || "";
              okey = obj.key || "";
              oval = obj.val || "";
              size = oapp.length * 2 + okey.length * 2 + oval.length + 1;
              entries.push({
                "app": obj.app,
                "key": obj.key,
                "size": size
              });
            }
            if (typeof callback === "function") {
              callback(entries);
            } else {
              entries.forEach(function(obj2) {
                console.log(obj2);
              });
            }
          });
        };
        function LokiCatalog(callback) {
          this.db = null;
          this.initializeLokiCatalog(callback);
        }
        LokiCatalog.prototype.initializeLokiCatalog = function(callback) {
          var openRequest = indexedDB.open("LokiCatalog", 1);
          var cat = this;
          openRequest.onupgradeneeded = function(e) {
            var thisDB = e.target.result;
            if (thisDB.objectStoreNames.contains("LokiAKV")) {
              thisDB.deleteObjectStore("LokiAKV");
            }
            if (!thisDB.objectStoreNames.contains("LokiAKV")) {
              var objectStore = thisDB.createObjectStore("LokiAKV", {
                keyPath: "id",
                autoIncrement: true
              });
              objectStore.createIndex("app", "app", {
                unique: false
              });
              objectStore.createIndex("key", "key", {
                unique: false
              });
              objectStore.createIndex("appkey", "appkey", {
                unique: true
              });
            }
          };
          openRequest.onsuccess = function(e) {
            cat.db = e.target.result;
            if (typeof callback === "function") callback(cat);
          };
          openRequest.onerror = function(e) {
            throw e;
          };
        };
        LokiCatalog.prototype.getAppKey = function(app, key, callback) {
          var transaction = this.db.transaction(["LokiAKV"], "readonly");
          var store = transaction.objectStore("LokiAKV");
          var index = store.index("appkey");
          var appkey = app + "," + key;
          var request = index.get(appkey);
          request.onsuccess = /* @__PURE__ */ function(usercallback) {
            return function(e) {
              var lres = e.target.result;
              if (lres === null || typeof lres === "undefined") {
                lres = {
                  id: 0,
                  success: false
                };
              }
              if (typeof usercallback === "function") {
                usercallback(lres);
              } else {
                console.log(lres);
              }
            };
          }(callback);
          request.onerror = /* @__PURE__ */ function(usercallback) {
            return function(e) {
              if (typeof usercallback === "function") {
                usercallback({
                  id: 0,
                  success: false
                });
              } else {
                throw e;
              }
            };
          }(callback);
        };
        LokiCatalog.prototype.getAppKeyById = function(id, callback, data) {
          var transaction = this.db.transaction(["LokiAKV"], "readonly");
          var store = transaction.objectStore("LokiAKV");
          var request = store.get(id);
          request.onsuccess = /* @__PURE__ */ function(data2, usercallback) {
            return function(e) {
              if (typeof usercallback === "function") {
                usercallback(e.target.result, data2);
              } else {
                console.log(e.target.result);
              }
            };
          }(data, callback);
        };
        LokiCatalog.prototype.setAppKey = function(app, key, val, callback) {
          var transaction = this.db.transaction(["LokiAKV"], "readwrite");
          var store = transaction.objectStore("LokiAKV");
          var index = store.index("appkey");
          var appkey = app + "," + key;
          var request = index.get(appkey);
          request.onsuccess = function(e) {
            var res = e.target.result;
            if (res === null || res === void 0) {
              res = {
                app,
                key,
                appkey: app + "," + key,
                val
              };
            } else {
              res.val = val;
            }
            var requestPut = store.put(res);
            requestPut.onerror = /* @__PURE__ */ function(usercallback) {
              return function(e2) {
                if (typeof usercallback === "function") {
                  usercallback({
                    success: false
                  });
                } else {
                  console.error("LokiCatalog.setAppKey (set) onerror");
                  console.error(request.error);
                }
              };
            }(callback);
            requestPut.onsuccess = /* @__PURE__ */ function(usercallback) {
              return function(e2) {
                if (typeof usercallback === "function") {
                  usercallback({
                    success: true
                  });
                }
              };
            }(callback);
          };
          request.onerror = /* @__PURE__ */ function(usercallback) {
            return function(e) {
              if (typeof usercallback === "function") {
                usercallback({
                  success: false
                });
              } else {
                console.error("LokiCatalog.setAppKey (get) onerror");
                console.error(request.error);
              }
            };
          }(callback);
        };
        LokiCatalog.prototype.deleteAppKey = function(id, callback) {
          var transaction = this.db.transaction(["LokiAKV"], "readwrite");
          var store = transaction.objectStore("LokiAKV");
          var request = store.delete(id);
          request.onsuccess = /* @__PURE__ */ function(usercallback) {
            return function(evt) {
              if (typeof usercallback === "function") usercallback({
                success: true
              });
            };
          }(callback);
          request.onerror = /* @__PURE__ */ function(usercallback) {
            return function(evt) {
              if (typeof usercallback === "function") {
                usercallback({
                  success: false
                });
              } else {
                console.error("LokiCatalog.deleteAppKey raised onerror");
                console.error(request.error);
              }
            };
          }(callback);
        };
        LokiCatalog.prototype.getAppKeys = function(app, callback) {
          var transaction = this.db.transaction(["LokiAKV"], "readonly");
          var store = transaction.objectStore("LokiAKV");
          var index = store.index("app");
          var singleKeyRange = IDBKeyRange.only(app);
          var cursor = index.openCursor(singleKeyRange);
          var localdata = [];
          cursor.onsuccess = /* @__PURE__ */ function(data, callback2) {
            return function(e) {
              var cursor2 = e.target.result;
              if (cursor2) {
                var currObject = cursor2.value;
                data.push(currObject);
                cursor2.continue();
              } else {
                if (typeof callback2 === "function") {
                  callback2(data);
                } else {
                  console.log(data);
                }
              }
            };
          }(localdata, callback);
          cursor.onerror = /* @__PURE__ */ function(usercallback) {
            return function(e) {
              if (typeof usercallback === "function") {
                usercallback(null);
              } else {
                console.error("LokiCatalog.getAppKeys raised onerror");
                console.error(e);
              }
            };
          }(callback);
        };
        LokiCatalog.prototype.getAllKeys = function(callback) {
          var transaction = this.db.transaction(["LokiAKV"], "readonly");
          var store = transaction.objectStore("LokiAKV");
          var cursor = store.openCursor();
          var localdata = [];
          cursor.onsuccess = /* @__PURE__ */ function(data, callback2) {
            return function(e) {
              var cursor2 = e.target.result;
              if (cursor2) {
                var currObject = cursor2.value;
                data.push(currObject);
                cursor2.continue();
              } else {
                if (typeof callback2 === "function") {
                  callback2(data);
                } else {
                  console.log(data);
                }
              }
            };
          }(localdata, callback);
          cursor.onerror = /* @__PURE__ */ function(usercallback) {
            return function(e) {
              if (typeof usercallback === "function") usercallback(null);
            };
          }(callback);
        };
        return LokiIndexedAdapter2;
      }();
    });
  }
});

// node_modules/lokijs/src/lokijs.js
var require_lokijs = __commonJS({
  "node_modules/lokijs/src/lokijs.js"(exports, module) {
    "use strict";
    (function(root, factory) {
      if (typeof define === "function" && define.amd) {
        define([], factory);
      } else if (typeof exports === "object") {
        module.exports = factory();
      } else {
        root.loki = factory();
      }
    })(exports, function() {
      return function() {
        "use strict";
        var hasOwnProperty = Object.prototype.hasOwnProperty;
        function deepFreeze(obj) {
          var prop, i;
          if (Array.isArray(obj)) {
            for (i = 0; i < obj.length; i++) {
              deepFreeze(obj[i]);
            }
            freeze(obj);
          } else if (obj !== null && typeof obj === "object") {
            for (prop in obj) {
              if (obj.hasOwnProperty(prop)) {
                deepFreeze(obj[prop]);
              }
            }
            freeze(obj);
          }
        }
        function freeze(obj) {
          if (!Object.isFrozen(obj)) {
            Object.freeze(obj);
          }
        }
        function unFreeze(obj) {
          if (!Object.isFrozen(obj)) {
            return obj;
          }
          return clone(obj, "shallow");
        }
        var Utils = {
          copyProperties: function(src, dest) {
            var prop;
            for (prop in src) {
              dest[prop] = src[prop];
            }
          },
          // used to recursively scan hierarchical transform step object for param substitution
          resolveTransformObject: function(subObj, params, depth) {
            var prop, pname;
            if (typeof depth !== "number") {
              depth = 0;
            }
            if (++depth >= 10) return subObj;
            for (prop in subObj) {
              if (typeof subObj[prop] === "string" && subObj[prop].indexOf("[%lktxp]") === 0) {
                pname = subObj[prop].substring(8);
                if (params.hasOwnProperty(pname)) {
                  subObj[prop] = params[pname];
                }
              } else if (typeof subObj[prop] === "object") {
                subObj[prop] = Utils.resolveTransformObject(subObj[prop], params, depth);
              }
            }
            return subObj;
          },
          // top level utility to resolve an entire (single) transform (array of steps) for parameter substitution
          resolveTransformParams: function(transform, params) {
            var idx, clonedStep, resolvedTransform = [];
            if (typeof params === "undefined") return transform;
            for (idx = 0; idx < transform.length; idx++) {
              clonedStep = clone(transform[idx], "shallow-recurse-objects");
              resolvedTransform.push(Utils.resolveTransformObject(clonedStep, params));
            }
            return resolvedTransform;
          },
          // By default (if usingDotNotation is false), looks up path in
          // object via `object[path]`
          //
          // If `usingDotNotation` is true, then the path is assumed to
          // represent a nested path. It can be in the form of an array of
          // field names, or a period delimited string. The function will
          // look up the value of object[path[0]], and then call
          // result[path[1]] on the result, etc etc.
          //
          // If `usingDotNotation` is true, this function still supports
          // non nested fields.
          //
          // `usingDotNotation` is a performance optimization. The caller
          // may know that a path is *not* nested. In which case, this
          // function avoids a costly string.split('.')
          //
          // examples:
          // getIn({a: 1}, "a") => 1
          // getIn({a: 1}, "a", true) => 1
          // getIn({a: {b: 1}}, ["a", "b"], true) => 1
          // getIn({a: {b: 1}}, "a.b", true) => 1
          getIn: function(object, path, usingDotNotation) {
            if (object == null) {
              return void 0;
            }
            if (!usingDotNotation) {
              return object[path];
            }
            if (typeof path === "string") {
              path = path.split(".");
            }
            if (!Array.isArray(path)) {
              throw new Error("path must be a string or array. Found " + typeof path);
            }
            var index = 0, length = path.length;
            while (object != null && index < length) {
              object = object[path[index++]];
            }
            return index && index == length ? object : void 0;
          }
        };
        var Comparators = {
          aeq: aeqHelper,
          lt: ltHelper,
          gt: gtHelper
        };
        function aeqHelper(prop1, prop2) {
          var cv1, cv2, t1, t2;
          if (prop1 === prop2) return true;
          if (!prop1 || !prop2 || prop1 === true || prop2 === true || prop1 !== prop1 || prop2 !== prop2) {
            switch (prop1) {
              case void 0:
                t1 = 1;
                break;
              case null:
                t1 = 1;
                break;
              case false:
                t1 = 3;
                break;
              case true:
                t1 = 4;
                break;
              case "":
                t1 = 5;
                break;
              default:
                t1 = prop1 === prop1 ? 9 : 0;
                break;
            }
            switch (prop2) {
              case void 0:
                t2 = 1;
                break;
              case null:
                t2 = 1;
                break;
              case false:
                t2 = 3;
                break;
              case true:
                t2 = 4;
                break;
              case "":
                t2 = 5;
                break;
              default:
                t2 = prop2 === prop2 ? 9 : 0;
                break;
            }
            if (t1 !== 9 || t2 !== 9) {
              return t1 === t2;
            }
          }
          cv1 = Number(prop1);
          cv2 = Number(prop2);
          if (cv1 === cv1 || cv2 === cv2) {
            return cv1 === cv2;
          }
          cv1 = prop1.toString();
          cv2 = prop2.toString();
          return cv1 == cv2;
        }
        function ltHelper(prop1, prop2, equal) {
          var cv1, cv2, t1, t2;
          if (!prop1 || !prop2 || prop1 === true || prop2 === true || prop1 !== prop1 || prop2 !== prop2) {
            switch (prop1) {
              case void 0:
                t1 = 1;
                break;
              case null:
                t1 = 1;
                break;
              case false:
                t1 = 3;
                break;
              case true:
                t1 = 4;
                break;
              case "":
                t1 = 5;
                break;
              // if strict equal probably 0 so sort higher, otherwise probably NaN so sort lower than even null
              default:
                t1 = prop1 === prop1 ? 9 : 0;
                break;
            }
            switch (prop2) {
              case void 0:
                t2 = 1;
                break;
              case null:
                t2 = 1;
                break;
              case false:
                t2 = 3;
                break;
              case true:
                t2 = 4;
                break;
              case "":
                t2 = 5;
                break;
              default:
                t2 = prop2 === prop2 ? 9 : 0;
                break;
            }
            if (t1 !== 9 || t2 !== 9) {
              return t1 === t2 ? equal : t1 < t2;
            }
          }
          cv1 = Number(prop1);
          cv2 = Number(prop2);
          if (cv1 === cv1 && cv2 === cv2) {
            if (cv1 < cv2) return true;
            if (cv1 > cv2) return false;
            return equal;
          }
          if (cv1 === cv1 && cv2 !== cv2) {
            return true;
          }
          if (cv2 === cv2 && cv1 !== cv1) {
            return false;
          }
          if (prop1 < prop2) return true;
          if (prop1 > prop2) return false;
          if (prop1 == prop2) return equal;
          cv1 = prop1.toString();
          cv2 = prop2.toString();
          if (cv1 < cv2) {
            return true;
          }
          if (cv1 == cv2) {
            return equal;
          }
          return false;
        }
        function gtHelper(prop1, prop2, equal) {
          var cv1, cv2, t1, t2;
          if (!prop1 || !prop2 || prop1 === true || prop2 === true || prop1 !== prop1 || prop2 !== prop2) {
            switch (prop1) {
              case void 0:
                t1 = 1;
                break;
              case null:
                t1 = 1;
                break;
              case false:
                t1 = 3;
                break;
              case true:
                t1 = 4;
                break;
              case "":
                t1 = 5;
                break;
              // NaN 0
              default:
                t1 = prop1 === prop1 ? 9 : 0;
                break;
            }
            switch (prop2) {
              case void 0:
                t2 = 1;
                break;
              case null:
                t2 = 1;
                break;
              case false:
                t2 = 3;
                break;
              case true:
                t2 = 4;
                break;
              case "":
                t2 = 5;
                break;
              default:
                t2 = prop2 === prop2 ? 9 : 0;
                break;
            }
            if (t1 !== 9 || t2 !== 9) {
              return t1 === t2 ? equal : t1 > t2;
            }
          }
          cv1 = Number(prop1);
          cv2 = Number(prop2);
          if (cv1 === cv1 && cv2 === cv2) {
            if (cv1 > cv2) return true;
            if (cv1 < cv2) return false;
            return equal;
          }
          if (cv1 === cv1 && cv2 !== cv2) {
            return false;
          }
          if (cv2 === cv2 && cv1 !== cv1) {
            return true;
          }
          if (prop1 > prop2) return true;
          if (prop1 < prop2) return false;
          if (prop1 == prop2) return equal;
          cv1 = prop1.toString();
          cv2 = prop2.toString();
          if (cv1 > cv2) {
            return true;
          }
          if (cv1 == cv2) {
            return equal;
          }
          return false;
        }
        function sortHelper(prop1, prop2, desc) {
          if (Comparators.aeq(prop1, prop2)) return 0;
          if (Comparators.lt(prop1, prop2, false)) {
            return desc ? 1 : -1;
          }
          if (Comparators.gt(prop1, prop2, false)) {
            return desc ? -1 : 1;
          }
          return 0;
        }
        function compoundeval(properties, obj1, obj2) {
          var res = 0;
          var prop, field, val1, val2, arr, path;
          for (var i = 0, len = properties.length; i < len; i++) {
            prop = properties[i];
            field = prop[0];
            if (~field.indexOf(".")) {
              arr = field.split(".");
              val1 = Utils.getIn(obj1, arr, true);
              val2 = Utils.getIn(obj2, arr, true);
            } else {
              val1 = obj1[field];
              val2 = obj2[field];
            }
            res = sortHelper(val1, val2, prop[1]);
            if (res !== 0) {
              return res;
            }
          }
          return 0;
        }
        function dotSubScan(root, paths, fun, value, extra, poffset) {
          var pathOffset = poffset || 0;
          var path = paths[pathOffset];
          var valueFound = false;
          var element;
          if (typeof root === "object" && path in root) {
            element = root[path];
          }
          if (pathOffset + 1 >= paths.length) {
            valueFound = fun(element, value, extra);
          } else if (Array.isArray(element)) {
            for (var index = 0, len = element.length; index < len; index += 1) {
              valueFound = dotSubScan(element[index], paths, fun, value, extra, pathOffset + 1);
              if (valueFound === true) {
                break;
              }
            }
          } else {
            valueFound = dotSubScan(element, paths, fun, value, extra, pathOffset + 1);
          }
          return valueFound;
        }
        function containsCheckFn(a) {
          if (typeof a === "string" || Array.isArray(a)) {
            return function(b) {
              return a.indexOf(b) !== -1;
            };
          } else if (typeof a === "object" && a !== null) {
            return function(b) {
              return hasOwnProperty.call(a, b);
            };
          }
          return null;
        }
        function doQueryOp(val, op, record) {
          for (var p in op) {
            if (hasOwnProperty.call(op, p)) {
              return LokiOps[p](val, op[p], record);
            }
          }
          return false;
        }
        var LokiOps = {
          // comparison operators
          // a is the value in the collection
          // b is the query value
          $eq: function(a, b) {
            return a === b;
          },
          // abstract/loose equality
          $aeq: function(a, b) {
            return a == b;
          },
          $ne: function(a, b) {
            if (b !== b) {
              return a === a;
            }
            return a !== b;
          },
          // date equality / loki abstract equality test
          $dteq: function(a, b) {
            return Comparators.aeq(a, b);
          },
          // loki comparisons: return identical unindexed results as indexed comparisons
          $gt: function(a, b) {
            return Comparators.gt(a, b, false);
          },
          $gte: function(a, b) {
            return Comparators.gt(a, b, true);
          },
          $lt: function(a, b) {
            return Comparators.lt(a, b, false);
          },
          $lte: function(a, b) {
            return Comparators.lt(a, b, true);
          },
          // lightweight javascript comparisons
          $jgt: function(a, b) {
            return a > b;
          },
          $jgte: function(a, b) {
            return a >= b;
          },
          $jlt: function(a, b) {
            return a < b;
          },
          $jlte: function(a, b) {
            return a <= b;
          },
          // ex : coll.find({'orderCount': {$between: [10, 50]}});
          $between: function(a, vals) {
            if (a === void 0 || a === null) return false;
            return Comparators.gt(a, vals[0], true) && Comparators.lt(a, vals[1], true);
          },
          $jbetween: function(a, vals) {
            if (a === void 0 || a === null) return false;
            return a >= vals[0] && a <= vals[1];
          },
          $in: function(a, b) {
            return b.indexOf(a) !== -1;
          },
          $inSet: function(a, b) {
            return b.has(a);
          },
          $nin: function(a, b) {
            return b.indexOf(a) === -1;
          },
          $keyin: function(a, b) {
            return a in b;
          },
          $nkeyin: function(a, b) {
            return !(a in b);
          },
          $definedin: function(a, b) {
            return b[a] !== void 0;
          },
          $undefinedin: function(a, b) {
            return b[a] === void 0;
          },
          $regex: function(a, b) {
            return b.test(a);
          },
          $containsString: function(a, b) {
            return typeof a === "string" && a.indexOf(b) !== -1;
          },
          $containsNone: function(a, b) {
            return !LokiOps.$containsAny(a, b);
          },
          $containsAny: function(a, b) {
            var checkFn = containsCheckFn(a);
            if (checkFn !== null) {
              return Array.isArray(b) ? b.some(checkFn) : checkFn(b);
            }
            return false;
          },
          $contains: function(a, b) {
            var checkFn = containsCheckFn(a);
            if (checkFn !== null) {
              return Array.isArray(b) ? b.every(checkFn) : checkFn(b);
            }
            return false;
          },
          $elemMatch: function(a, b) {
            if (Array.isArray(a)) {
              return a.some(function(item) {
                return Object.keys(b).every(function(property) {
                  var filter = b[property];
                  if (!(typeof filter === "object" && filter)) {
                    filter = {
                      $eq: filter
                    };
                  }
                  if (property.indexOf(".") !== -1) {
                    return dotSubScan(item, property.split("."), doQueryOp, b[property], item);
                  }
                  return doQueryOp(item[property], filter, item);
                });
              });
            }
            return false;
          },
          $type: function(a, b, record) {
            var type = typeof a;
            if (type === "object") {
              if (Array.isArray(a)) {
                type = "array";
              } else if (a instanceof Date) {
                type = "date";
              }
            }
            return typeof b !== "object" ? type === b : doQueryOp(type, b, record);
          },
          $finite: function(a, b) {
            return b === isFinite(a);
          },
          $size: function(a, b, record) {
            if (Array.isArray(a)) {
              return typeof b !== "object" ? a.length === b : doQueryOp(a.length, b, record);
            }
            return false;
          },
          $len: function(a, b, record) {
            if (typeof a === "string") {
              return typeof b !== "object" ? a.length === b : doQueryOp(a.length, b, record);
            }
            return false;
          },
          $where: function(a, b) {
            return b(a) === true;
          },
          // field-level logical operators
          // a is the value in the collection
          // b is the nested query operation (for '$not')
          //   or an array of nested query operations (for '$and' and '$or')
          $not: function(a, b, record) {
            return !doQueryOp(a, b, record);
          },
          $and: function(a, b, record) {
            for (var idx = 0, len = b.length; idx < len; idx += 1) {
              if (!doQueryOp(a, b[idx], record)) {
                return false;
              }
            }
            return true;
          },
          $or: function(a, b, record) {
            for (var idx = 0, len = b.length; idx < len; idx += 1) {
              if (doQueryOp(a, b[idx], record)) {
                return true;
              }
            }
            return false;
          },
          $exists: function(a, b) {
            if (b) {
              return a !== void 0;
            } else {
              return a === void 0;
            }
          }
        };
        var valueLevelOps = ["$eq", "$aeq", "$ne", "$dteq", "$gt", "$gte", "$lt", "$lte", "$jgt", "$jgte", "$jlt", "$jlte", "$type"];
        valueLevelOps.forEach(function(op) {
          var fun = LokiOps[op];
          LokiOps["$" + op] = function(a, spec, record) {
            if (typeof spec === "string") {
              return fun(a, record[spec]);
            } else if (typeof spec === "function") {
              return fun(a, spec(record));
            } else {
              throw new Error("Invalid argument to $$ matcher");
            }
          };
        });
        var indexedOps = {
          $eq: LokiOps.$eq,
          $aeq: true,
          $dteq: true,
          $gt: true,
          $gte: true,
          $lt: true,
          $lte: true,
          $in: true,
          $between: true
        };
        function clone(data, method) {
          if (data === null || data === void 0) {
            return null;
          }
          var cloneMethod = method || "parse-stringify", cloned;
          switch (cloneMethod) {
            case "parse-stringify":
              cloned = JSON.parse(JSON.stringify(data));
              break;
            case "jquery-extend-deep":
              cloned = jQuery.extend(true, {}, data);
              break;
            case "shallow":
              cloned = Object.create(data.constructor.prototype);
              Object.keys(data).map(function(i) {
                cloned[i] = data[i];
              });
              break;
            case "shallow-assign":
              cloned = Object.create(data.constructor.prototype);
              Object.assign(cloned, data);
              break;
            case "shallow-recurse-objects":
              cloned = clone(data, "shallow");
              var keys2 = Object.keys(data);
              keys2.forEach(function(key) {
                if (typeof data[key] === "object" && data[key].constructor.name === "Object") {
                  cloned[key] = clone(data[key], "shallow-recurse-objects");
                } else if (Array.isArray(data[key])) {
                  cloned[key] = cloneObjectArray(data[key], "shallow-recurse-objects");
                }
              });
              break;
            default:
              break;
          }
          return cloned;
        }
        function cloneObjectArray(objarray, method) {
          if (method == "parse-stringify") {
            return clone(objarray, method);
          }
          var result = [];
          for (var i = 0, len = objarray.length; i < len; i++) {
            result[i] = clone(objarray[i], method);
          }
          return result;
        }
        function localStorageAvailable() {
          try {
            return window && window.localStorage !== void 0 && window.localStorage !== null;
          } catch (e) {
            return false;
          }
        }
        function LokiEventEmitter() {
        }
        LokiEventEmitter.prototype.events = {};
        LokiEventEmitter.prototype.asyncListeners = false;
        LokiEventEmitter.prototype.on = function(eventName, listener) {
          var event;
          var self2 = this;
          if (Array.isArray(eventName)) {
            eventName.forEach(function(currentEventName) {
              self2.on(currentEventName, listener);
            });
            return listener;
          }
          event = this.events[eventName];
          if (!event) {
            event = this.events[eventName] = [];
          }
          event.push(listener);
          return listener;
        };
        LokiEventEmitter.prototype.emit = function(eventName) {
          var self2 = this;
          var selfArgs;
          if (eventName && this.events[eventName]) {
            if (this.events[eventName].length) {
              selfArgs = Array.prototype.slice.call(arguments, 1);
              this.events[eventName].forEach(function(listener) {
                if (self2.asyncListeners) {
                  setTimeout(function() {
                    listener.apply(self2, selfArgs);
                  }, 1);
                } else {
                  listener.apply(self2, selfArgs);
                }
              });
            }
          } else {
            throw new Error("No event " + eventName + " defined");
          }
        };
        LokiEventEmitter.prototype.addListener = LokiEventEmitter.prototype.on;
        LokiEventEmitter.prototype.removeListener = function(eventName, listener) {
          var self2 = this;
          if (Array.isArray(eventName)) {
            eventName.forEach(function(currentEventName) {
              self2.removeListener(currentEventName, listener);
            });
            return;
          }
          if (this.events[eventName]) {
            var listeners = this.events[eventName];
            listeners.splice(listeners.indexOf(listener), 1);
          }
        };
        function Loki2(filename, options) {
          this.filename = filename || "loki.db";
          this.collections = [];
          this.databaseVersion = 1.5;
          this.engineVersion = 1.5;
          this.autosave = false;
          this.autosaveInterval = 5e3;
          this.autosaveHandle = null;
          this.throttledSaves = true;
          this.options = {};
          this.persistenceMethod = null;
          this.persistenceAdapter = null;
          this.throttledSavePending = false;
          this.throttledCallbacks = [];
          this.verbose = options && options.hasOwnProperty("verbose") ? options.verbose : false;
          this.events = {
            "init": [],
            "loaded": [],
            "flushChanges": [],
            "close": [],
            "changes": [],
            "warning": []
          };
          var getENV = function() {
            if (typeof global !== "undefined" && (global.android || global.NSObject)) {
              return "NATIVESCRIPT";
            }
            if (typeof window === "undefined") {
              return "NODEJS";
            }
            if (typeof global !== "undefined" && global.window && typeof process !== "undefined") {
              return "NODEJS";
            }
            if (typeof document !== "undefined") {
              if (document.URL.indexOf("http://") === -1 && document.URL.indexOf("https://") === -1) {
                return "CORDOVA";
              }
              return "BROWSER";
            }
            return "CORDOVA";
          };
          if (options && options.hasOwnProperty("env")) {
            this.ENV = options.env;
          } else {
            this.ENV = getENV();
          }
          if (this.ENV === "undefined") {
            this.ENV = "NODEJS";
          }
          this.configureOptions(options, true);
          this.on("init", this.clearChanges);
        }
        Loki2.prototype = new LokiEventEmitter();
        Loki2.prototype.constructor = Loki2;
        Loki2.prototype.getIndexedAdapter = function() {
          var adapter;
          if (typeof __require === "function") {
            adapter = require_loki_indexed_adapter();
          }
          return adapter;
        };
        Loki2.prototype.configureOptions = function(options, initialConfig) {
          var defaultPersistence = {
            "NODEJS": "fs",
            "BROWSER": "localStorage",
            "CORDOVA": "localStorage",
            "MEMORY": "memory"
          }, persistenceMethods = {
            "fs": LokiFsAdapter,
            "localStorage": LokiLocalStorageAdapter,
            "memory": LokiMemoryAdapter
          };
          this.options = {};
          this.persistenceMethod = null;
          this.persistenceAdapter = null;
          if (typeof options !== "undefined") {
            this.options = options;
            if (this.options.hasOwnProperty("persistenceMethod")) {
              if (typeof persistenceMethods[options.persistenceMethod] == "function") {
                this.persistenceMethod = options.persistenceMethod;
                this.persistenceAdapter = new persistenceMethods[options.persistenceMethod]();
              }
            }
            if (this.options.hasOwnProperty("adapter")) {
              this.persistenceMethod = "adapter";
              this.persistenceAdapter = options.adapter;
              this.options.adapter = null;
              this.isIncremental = this.persistenceAdapter.mode === "incremental";
            }
            if (options.autoload && initialConfig) {
              var self2 = this;
              setTimeout(function() {
                self2.loadDatabase(options, options.autoloadCallback);
              }, 1);
            }
            if (this.options.hasOwnProperty("autosaveInterval")) {
              this.autosaveDisable();
              this.autosaveInterval = parseInt(this.options.autosaveInterval, 10);
            }
            if (this.options.hasOwnProperty("autosave") && this.options.autosave) {
              this.autosaveDisable();
              this.autosave = true;
              if (this.options.hasOwnProperty("autosaveCallback")) {
                this.autosaveEnable(options, options.autosaveCallback);
              } else {
                this.autosaveEnable();
              }
            }
            if (this.options.hasOwnProperty("throttledSaves")) {
              this.throttledSaves = this.options.throttledSaves;
            }
          }
          if (!this.options.hasOwnProperty("serializationMethod")) {
            this.options.serializationMethod = "normal";
          }
          if (!this.options.hasOwnProperty("destructureDelimiter")) {
            this.options.destructureDelimiter = "$<\n";
          }
          if (this.persistenceAdapter === null) {
            this.persistenceMethod = defaultPersistence[this.ENV];
            if (this.persistenceMethod) {
              this.persistenceAdapter = new persistenceMethods[this.persistenceMethod]();
            }
          }
        };
        Loki2.prototype.copy = function(options) {
          var databaseCopy = new Loki2(this.filename, {
            env: "NA"
          });
          var clen, idx;
          options = options || {};
          databaseCopy.loadJSONObject(this, {
            retainDirtyFlags: true
          });
          if (options.hasOwnProperty("removeNonSerializable") && options.removeNonSerializable === true) {
            databaseCopy.autosaveHandle = null;
            databaseCopy.persistenceAdapter = null;
            clen = databaseCopy.collections.length;
            for (idx = 0; idx < clen; idx++) {
              databaseCopy.collections[idx].constraints = null;
              databaseCopy.collections[idx].ttl = null;
            }
          }
          return databaseCopy;
        };
        Loki2.prototype.addCollection = function(name, options) {
          var i, len = this.collections.length;
          if (options && options.disableMeta === true) {
            if (options.disableChangesApi === false) {
              throw new Error("disableMeta option cannot be passed as true when disableChangesApi is passed as false");
            }
            if (options.disableDeltaChangesApi === false) {
              throw new Error("disableMeta option cannot be passed as true when disableDeltaChangesApi is passed as false");
            }
            if (typeof options.ttl === "number" && options.ttl > 0) {
              throw new Error("disableMeta option cannot be passed as true when ttl is enabled");
            }
          }
          for (i = 0; i < len; i += 1) {
            if (this.collections[i].name === name) {
              return this.collections[i];
            }
          }
          var collection = new Collection(name, options);
          collection.isIncremental = this.isIncremental;
          this.collections.push(collection);
          if (this.verbose) collection.lokiConsoleWrapper = console;
          return collection;
        };
        Loki2.prototype.loadCollection = function(collection) {
          if (!collection.name) {
            throw new Error("Collection must have a name property to be loaded");
          }
          this.collections.push(collection);
        };
        Loki2.prototype.getCollection = function(collectionName) {
          var i, len = this.collections.length;
          for (i = 0; i < len; i += 1) {
            if (this.collections[i].name === collectionName) {
              return this.collections[i];
            }
          }
          this.emit("warning", "collection " + collectionName + " not found");
          return null;
        };
        Loki2.prototype.renameCollection = function(oldName, newName) {
          var c = this.getCollection(oldName);
          if (c) {
            c.name = newName;
          }
          return c;
        };
        Loki2.prototype.listCollections = function() {
          var i = this.collections.length, colls = [];
          while (i--) {
            colls.push({
              name: this.collections[i].name,
              type: this.collections[i].objType,
              count: this.collections[i].data.length
            });
          }
          return colls;
        };
        Loki2.prototype.removeCollection = function(collectionName) {
          var i, len = this.collections.length;
          for (i = 0; i < len; i += 1) {
            if (this.collections[i].name === collectionName) {
              var tmpcol = new Collection(collectionName, {});
              var curcol = this.collections[i];
              for (var prop in curcol) {
                if (curcol.hasOwnProperty(prop) && tmpcol.hasOwnProperty(prop)) {
                  curcol[prop] = tmpcol[prop];
                }
              }
              this.collections.splice(i, 1);
              return;
            }
          }
        };
        Loki2.prototype.getName = function() {
          return this.name;
        };
        Loki2.prototype.serializeReplacer = function(key, value) {
          switch (key) {
            case "autosaveHandle":
            case "persistenceAdapter":
            case "constraints":
            case "ttl":
              return null;
            case "throttledSavePending":
            case "throttledCallbacks":
              return void 0;
            case "lokiConsoleWrapper":
              return null;
            default:
              return value;
          }
        };
        Loki2.prototype.serialize = function(options) {
          options = options || {};
          if (!options.hasOwnProperty("serializationMethod")) {
            options.serializationMethod = this.options.serializationMethod;
          }
          switch (options.serializationMethod) {
            case "normal":
              return JSON.stringify(this, this.serializeReplacer);
            case "pretty":
              return JSON.stringify(this, this.serializeReplacer, 2);
            case "destructured":
              return this.serializeDestructured();
            // use default options
            default:
              return JSON.stringify(this, this.serializeReplacer);
          }
        };
        Loki2.prototype.toJson = Loki2.prototype.serialize;
        Loki2.prototype.serializeDestructured = function(options) {
          var idx, sidx, result, resultlen;
          var reconstruct = [];
          var dbcopy;
          options = options || {};
          if (!options.hasOwnProperty("partitioned")) {
            options.partitioned = false;
          }
          if (!options.hasOwnProperty("delimited")) {
            options.delimited = true;
          }
          if (!options.hasOwnProperty("delimiter")) {
            options.delimiter = this.options.destructureDelimiter;
          }
          if (options.partitioned === true && options.hasOwnProperty("partition") && options.partition >= 0) {
            return this.serializeCollection({
              delimited: options.delimited,
              delimiter: options.delimiter,
              collectionIndex: options.partition
            });
          }
          dbcopy = new Loki2(this.filename);
          dbcopy.loadJSONObject(this);
          for (idx = 0; idx < dbcopy.collections.length; idx++) {
            dbcopy.collections[idx].data = [];
          }
          if (options.partitioned === true && options.partition === -1) {
            return dbcopy.serialize({
              serializationMethod: "normal"
            });
          }
          reconstruct.push(dbcopy.serialize({
            serializationMethod: "normal"
          }));
          dbcopy = null;
          for (idx = 0; idx < this.collections.length; idx++) {
            result = this.serializeCollection({
              delimited: options.delimited,
              delimiter: options.delimiter,
              collectionIndex: idx
            });
            if (options.partitioned === false && options.delimited === false) {
              if (!Array.isArray(result)) {
                throw new Error("a nondelimited, non partitioned collection serialization did not return an expected array");
              }
              resultlen = result.length;
              for (sidx = 0; sidx < resultlen; sidx++) {
                reconstruct.push(result[sidx]);
                result[sidx] = null;
              }
              reconstruct.push("");
            } else {
              reconstruct.push(result);
            }
          }
          if (options.partitioned) {
            if (options.delimited) {
              return reconstruct;
            } else {
              return reconstruct;
            }
          } else {
            if (options.delimited) {
              reconstruct.push("");
              return reconstruct.join(options.delimiter);
            } else {
              reconstruct.push("");
              return reconstruct;
            }
          }
          reconstruct.push("");
          return reconstruct.join(delim);
        };
        Loki2.prototype.serializeCollection = function(options) {
          var doccount, docidx, resultlines = [];
          options = options || {};
          if (!options.hasOwnProperty("delimited")) {
            options.delimited = true;
          }
          if (!options.hasOwnProperty("collectionIndex")) {
            throw new Error("serializeCollection called without 'collectionIndex' option");
          }
          doccount = this.collections[options.collectionIndex].data.length;
          resultlines = [];
          for (docidx = 0; docidx < doccount; docidx++) {
            resultlines.push(JSON.stringify(this.collections[options.collectionIndex].data[docidx]));
          }
          if (options.delimited) {
            resultlines.push("");
            return resultlines.join(options.delimiter);
          } else {
            return resultlines;
          }
        };
        Loki2.prototype.deserializeDestructured = function(destructuredSource, options) {
          var workarray = [];
          var len, cdb;
          var idx, collIndex = 0, collCount, lineIndex = 1, done = false;
          var currLine, currObject;
          options = options || {};
          if (!options.hasOwnProperty("partitioned")) {
            options.partitioned = false;
          }
          if (!options.hasOwnProperty("delimited")) {
            options.delimited = true;
          }
          if (!options.hasOwnProperty("delimiter")) {
            options.delimiter = this.options.destructureDelimiter;
          }
          if (options.partitioned) {
            if (options.hasOwnProperty("partition")) {
              if (options.partition === -1) {
                cdb = JSON.parse(destructuredSource[0]);
                return cdb;
              }
              return this.deserializeCollection(destructuredSource[options.partition + 1], options);
            }
            cdb = JSON.parse(destructuredSource[0]);
            collCount = cdb.collections.length;
            for (collIndex = 0; collIndex < collCount; collIndex++) {
              cdb.collections[collIndex].data = this.deserializeCollection(destructuredSource[collIndex + 1], options);
            }
            return cdb;
          }
          if (options.delimited) {
            workarray = destructuredSource.split(options.delimiter);
            destructuredSource = null;
            len = workarray.length;
            if (len === 0) {
              return null;
            }
          } else {
            workarray = destructuredSource;
          }
          cdb = JSON.parse(workarray[0]);
          collCount = cdb.collections.length;
          workarray[0] = null;
          while (!done) {
            currLine = workarray[lineIndex];
            if (workarray[lineIndex] === "") {
              if (++collIndex > collCount) {
                done = true;
              }
            } else {
              currObject = JSON.parse(workarray[lineIndex]);
              cdb.collections[collIndex].data.push(currObject);
            }
            workarray[lineIndex++] = null;
          }
          return cdb;
        };
        Loki2.prototype.deserializeCollection = function(destructuredSource, options) {
          var workarray = [];
          var idx, len;
          options = options || {};
          if (!options.hasOwnProperty("partitioned")) {
            options.partitioned = false;
          }
          if (!options.hasOwnProperty("delimited")) {
            options.delimited = true;
          }
          if (!options.hasOwnProperty("delimiter")) {
            options.delimiter = this.options.destructureDelimiter;
          }
          if (options.delimited) {
            workarray = destructuredSource.split(options.delimiter);
            workarray.pop();
          } else {
            workarray = destructuredSource;
          }
          len = workarray.length;
          for (idx = 0; idx < len; idx++) {
            workarray[idx] = JSON.parse(workarray[idx]);
          }
          return workarray;
        };
        Loki2.prototype.loadJSON = function(serializedDb, options) {
          var dbObject;
          if (serializedDb.length === 0) {
            dbObject = {};
          } else {
            switch (this.options.serializationMethod) {
              case "normal":
              case "pretty":
                dbObject = JSON.parse(serializedDb);
                break;
              case "destructured":
                dbObject = this.deserializeDestructured(serializedDb);
                break;
              default:
                dbObject = JSON.parse(serializedDb);
                break;
            }
          }
          this.loadJSONObject(dbObject, options);
        };
        Loki2.prototype.loadJSONObject = function(dbObject, options) {
          var i = 0, len = dbObject.collections ? dbObject.collections.length : 0, coll, copyColl, clen, j, loader, collObj;
          this.name = dbObject.name;
          if (dbObject.hasOwnProperty("throttledSaves") && options && !options.hasOwnProperty("throttledSaves")) {
            this.throttledSaves = dbObject.throttledSaves;
          }
          this.collections = [];
          function makeLoader(coll2) {
            var collOptions = options[coll2.name];
            var inflater;
            if (collOptions.proto) {
              inflater = collOptions.inflate || Utils.copyProperties;
              return function(data) {
                var collObj2 = new collOptions.proto();
                inflater(data, collObj2);
                return collObj2;
              };
            }
            return collOptions.inflate;
          }
          for (i; i < len; i += 1) {
            coll = dbObject.collections[i];
            copyColl = this.addCollection(coll.name, {
              disableChangesApi: coll.disableChangesApi,
              disableDeltaChangesApi: coll.disableDeltaChangesApi,
              disableMeta: coll.disableMeta,
              disableFreeze: coll.hasOwnProperty("disableFreeze") ? coll.disableFreeze : true
            });
            copyColl.adaptiveBinaryIndices = coll.hasOwnProperty("adaptiveBinaryIndices") ? coll.adaptiveBinaryIndices === true : false;
            copyColl.transactional = coll.transactional;
            copyColl.asyncListeners = coll.asyncListeners;
            copyColl.cloneObjects = coll.cloneObjects;
            copyColl.cloneMethod = coll.cloneMethod || "parse-stringify";
            copyColl.autoupdate = coll.autoupdate;
            copyColl.changes = coll.changes;
            copyColl.dirtyIds = coll.dirtyIds || [];
            if (options && options.retainDirtyFlags === true) {
              copyColl.dirty = coll.dirty;
            } else {
              copyColl.dirty = false;
            }
            clen = coll.data.length;
            j = 0;
            if (options && options.hasOwnProperty(coll.name)) {
              loader = makeLoader(coll);
              for (j; j < clen; j++) {
                collObj = loader(coll.data[j]);
                copyColl.data[j] = collObj;
                copyColl.addAutoUpdateObserver(collObj);
                if (!copyColl.disableFreeze) {
                  deepFreeze(copyColl.data[j]);
                }
              }
            } else {
              for (j; j < clen; j++) {
                copyColl.data[j] = coll.data[j];
                copyColl.addAutoUpdateObserver(copyColl.data[j]);
                if (!copyColl.disableFreeze) {
                  deepFreeze(copyColl.data[j]);
                }
              }
            }
            copyColl.maxId = typeof coll.maxId === "undefined" ? 0 : coll.maxId;
            if (typeof coll.binaryIndices !== "undefined") {
              copyColl.binaryIndices = coll.binaryIndices;
            }
            if (typeof coll.transforms !== "undefined") {
              copyColl.transforms = coll.transforms;
            }
            copyColl.uniqueNames = [];
            if (coll.hasOwnProperty("uniqueNames")) {
              copyColl.uniqueNames = coll.uniqueNames;
            }
            if (typeof coll.DynamicViews === "undefined") continue;
            for (var idx = 0; idx < coll.DynamicViews.length; idx++) {
              var colldv = coll.DynamicViews[idx];
              var dv = copyColl.addDynamicView(colldv.name, colldv.options);
              dv.resultdata = colldv.resultdata;
              dv.resultsdirty = colldv.resultsdirty;
              dv.filterPipeline = colldv.filterPipeline;
              dv.sortCriteriaSimple = colldv.sortCriteriaSimple;
              dv.sortCriteria = colldv.sortCriteria;
              dv.sortFunction = null;
              dv.sortDirty = colldv.sortDirty;
              if (!copyColl.disableFreeze) {
                deepFreeze(dv.filterPipeline);
                if (dv.sortCriteriaSimple) {
                  deepFreeze(dv.sortCriteriaSimple);
                } else if (dv.sortCriteria) {
                  deepFreeze(dv.sortCriteria);
                }
              }
              dv.resultset.filteredrows = colldv.resultset.filteredrows;
              dv.resultset.filterInitialized = colldv.resultset.filterInitialized;
              dv.rematerialize({
                removeWhereFilters: true
              });
            }
            if (dbObject.databaseVersion < 1.5) {
              copyColl.ensureAllIndexes(true);
              copyColl.dirty = true;
            }
          }
        };
        Loki2.prototype.close = function(callback) {
          if (this.autosave) {
            this.autosaveDisable();
            if (this.autosaveDirty()) {
              this.saveDatabase(callback);
              callback = void 0;
            }
          }
          if (callback) {
            this.on("close", callback);
          }
          this.emit("close");
        };
        Loki2.prototype.generateChangesNotification = function(arrayOfCollectionNames) {
          function getCollName(coll) {
            return coll.name;
          }
          var changes = [], selectedCollections = arrayOfCollectionNames || this.collections.map(getCollName);
          this.collections.forEach(function(coll) {
            if (selectedCollections.indexOf(getCollName(coll)) !== -1) {
              changes = changes.concat(coll.getChanges());
            }
          });
          return changes;
        };
        Loki2.prototype.serializeChanges = function(collectionNamesArray) {
          return JSON.stringify(this.generateChangesNotification(collectionNamesArray));
        };
        Loki2.prototype.clearChanges = function() {
          this.collections.forEach(function(coll) {
            if (coll.flushChanges) {
              coll.flushChanges();
            }
          });
        };
        function LokiMemoryAdapter(options) {
          this.hashStore = {};
          this.options = options || {};
          if (!this.options.hasOwnProperty("asyncResponses")) {
            this.options.asyncResponses = false;
          }
          if (!this.options.hasOwnProperty("asyncTimeout")) {
            this.options.asyncTimeout = 50;
          }
        }
        LokiMemoryAdapter.prototype.loadDatabase = function(dbname, callback) {
          var self2 = this;
          if (this.options.asyncResponses) {
            setTimeout(function() {
              if (self2.hashStore.hasOwnProperty(dbname)) {
                callback(self2.hashStore[dbname].value);
              } else {
                callback(null);
              }
            }, this.options.asyncTimeout);
          } else {
            if (this.hashStore.hasOwnProperty(dbname)) {
              callback(this.hashStore[dbname].value);
            } else {
              callback(null);
            }
          }
        };
        LokiMemoryAdapter.prototype.saveDatabase = function(dbname, dbstring, callback) {
          var self2 = this;
          var saveCount;
          if (this.options.asyncResponses) {
            setTimeout(function() {
              saveCount = self2.hashStore.hasOwnProperty(dbname) ? self2.hashStore[dbname].savecount : 0;
              self2.hashStore[dbname] = {
                savecount: saveCount + 1,
                lastsave: /* @__PURE__ */ new Date(),
                value: dbstring
              };
              callback();
            }, this.options.asyncTimeout);
          } else {
            saveCount = this.hashStore.hasOwnProperty(dbname) ? this.hashStore[dbname].savecount : 0;
            this.hashStore[dbname] = {
              savecount: saveCount + 1,
              lastsave: /* @__PURE__ */ new Date(),
              value: dbstring
            };
            callback();
          }
        };
        LokiMemoryAdapter.prototype.deleteDatabase = function(dbname, callback) {
          if (this.hashStore.hasOwnProperty(dbname)) {
            delete this.hashStore[dbname];
          }
          if (typeof callback === "function") {
            callback();
          }
        };
        function LokiPartitioningAdapter(adapter, options) {
          this.mode = "reference";
          this.adapter = null;
          this.options = options || {};
          this.dbref = null;
          this.dbname = "";
          this.pageIterator = {};
          if (adapter) {
            if (adapter.mode === "reference") {
              throw new Error("LokiPartitioningAdapter cannot be instantiated with a reference mode adapter");
            } else {
              this.adapter = adapter;
            }
          } else {
            throw new Error("LokiPartitioningAdapter requires a (non-reference mode) adapter on construction");
          }
          if (!this.options.hasOwnProperty("paging")) {
            this.options.paging = false;
          }
          if (!this.options.hasOwnProperty("pageSize")) {
            this.options.pageSize = 25 * 1024 * 1024;
          }
          if (!this.options.hasOwnProperty("delimiter")) {
            this.options.delimiter = "$<\n";
          }
        }
        LokiPartitioningAdapter.prototype.loadDatabase = function(dbname, callback) {
          var self2 = this;
          this.dbname = dbname;
          this.dbref = new Loki2(dbname);
          this.adapter.loadDatabase(dbname, function(result) {
            if (!result) {
              callback(result);
              return;
            }
            if (typeof result !== "string") {
              callback(new Error("LokiPartitioningAdapter received an unexpected response from inner adapter loadDatabase()"));
            }
            var db = JSON.parse(result);
            self2.dbref.loadJSONObject(db);
            db = null;
            var clen = self2.dbref.collections.length;
            if (self2.dbref.collections.length === 0) {
              callback(self2.dbref);
              return;
            }
            self2.pageIterator = {
              collection: 0,
              pageIndex: 0
            };
            self2.loadNextPartition(0, function() {
              callback(self2.dbref);
            });
          });
        };
        LokiPartitioningAdapter.prototype.loadNextPartition = function(partition, callback) {
          var keyname = this.dbname + "." + partition;
          var self2 = this;
          if (this.options.paging === true) {
            this.pageIterator.pageIndex = 0;
            this.loadNextPage(callback);
            return;
          }
          this.adapter.loadDatabase(keyname, function(result) {
            var data = self2.dbref.deserializeCollection(result, {
              delimited: true,
              collectionIndex: partition
            });
            self2.dbref.collections[partition].data = data;
            if (++partition < self2.dbref.collections.length) {
              self2.loadNextPartition(partition, callback);
            } else {
              callback();
            }
          });
        };
        LokiPartitioningAdapter.prototype.loadNextPage = function(callback) {
          var keyname = this.dbname + "." + this.pageIterator.collection + "." + this.pageIterator.pageIndex;
          var self2 = this;
          this.adapter.loadDatabase(keyname, function(result) {
            var data = result.split(self2.options.delimiter);
            result = "";
            var dlen = data.length;
            var idx;
            var isLastPage = data[dlen - 1] === "";
            if (isLastPage) {
              data.pop();
              dlen = data.length;
              if (data[dlen - 1] === "" && dlen === 1) {
                data.pop();
                dlen = data.length;
              }
            }
            for (idx = 0; idx < dlen; idx++) {
              self2.dbref.collections[self2.pageIterator.collection].data.push(JSON.parse(data[idx]));
              data[idx] = null;
            }
            data = [];
            if (isLastPage) {
              if (++self2.pageIterator.collection < self2.dbref.collections.length) {
                self2.loadNextPartition(self2.pageIterator.collection, callback);
              } else {
                callback();
              }
            } else {
              self2.pageIterator.pageIndex++;
              self2.loadNextPage(callback);
            }
          });
        };
        LokiPartitioningAdapter.prototype.exportDatabase = function(dbname, dbref, callback) {
          var self2 = this;
          var idx, clen = dbref.collections.length;
          this.dbref = dbref;
          this.dbname = dbname;
          this.dirtyPartitions = [-1];
          for (idx = 0; idx < clen; idx++) {
            if (dbref.collections[idx].dirty) {
              this.dirtyPartitions.push(idx);
            }
          }
          this.saveNextPartition(function(err) {
            callback(err);
          });
        };
        LokiPartitioningAdapter.prototype.saveNextPartition = function(callback) {
          var self2 = this;
          var partition = this.dirtyPartitions.shift();
          var keyname = this.dbname + (partition === -1 ? "" : "." + partition);
          if (this.options.paging && partition !== -1) {
            this.pageIterator = {
              collection: partition,
              docIndex: 0,
              pageIndex: 0
            };
            this.saveNextPage(function(err) {
              if (self2.dirtyPartitions.length === 0) {
                callback(err);
              } else {
                self2.saveNextPartition(callback);
              }
            });
            return;
          }
          var result = this.dbref.serializeDestructured({
            partitioned: true,
            delimited: true,
            partition
          });
          this.adapter.saveDatabase(keyname, result, function(err) {
            if (err) {
              callback(err);
              return;
            }
            if (self2.dirtyPartitions.length === 0) {
              callback(null);
            } else {
              self2.saveNextPartition(callback);
            }
          });
        };
        LokiPartitioningAdapter.prototype.saveNextPage = function(callback) {
          var self2 = this;
          var coll = this.dbref.collections[this.pageIterator.collection];
          var keyname = this.dbname + "." + this.pageIterator.collection + "." + this.pageIterator.pageIndex;
          var pageLen = 0, cdlen = coll.data.length, delimlen = this.options.delimiter.length;
          var serializedObject = "", pageBuilder = "";
          var doneWithPartition = false, doneWithPage = false;
          var pageSaveCallback = function(err) {
            pageBuilder = "";
            if (err) {
              callback(err);
            }
            if (doneWithPartition) {
              callback(null);
            } else {
              self2.pageIterator.pageIndex++;
              self2.saveNextPage(callback);
            }
          };
          if (coll.data.length === 0) {
            doneWithPartition = true;
          }
          while (true) {
            if (!doneWithPartition) {
              serializedObject = JSON.stringify(coll.data[this.pageIterator.docIndex]);
              pageBuilder += serializedObject;
              pageLen += serializedObject.length;
              if (++this.pageIterator.docIndex >= cdlen) doneWithPartition = true;
            }
            if (pageLen >= this.options.pageSize) doneWithPage = true;
            if (!doneWithPage || doneWithPartition) {
              pageBuilder += this.options.delimiter;
              pageLen += delimlen;
            }
            if (doneWithPartition || doneWithPage) {
              this.adapter.saveDatabase(keyname, pageBuilder, pageSaveCallback);
              return;
            }
          }
        };
        function LokiFsAdapter() {
          try {
            this.fs = __require("fs");
          } catch (e) {
            this.fs = null;
          }
        }
        LokiFsAdapter.prototype.loadDatabase = function loadDatabase(dbname, callback) {
          var self2 = this;
          this.fs.stat(dbname, function(err, stats) {
            if (!err && stats.isFile()) {
              self2.fs.readFile(dbname, {
                encoding: "utf8"
              }, function readFileCallback(err2, data) {
                if (err2) {
                  callback(new Error(err2));
                } else {
                  callback(data);
                }
              });
            } else {
              callback(null);
            }
          });
        };
        LokiFsAdapter.prototype.saveDatabase = function saveDatabase(dbname, dbstring, callback) {
          var self2 = this;
          var tmpdbname = dbname + "~";
          this.fs.writeFile(tmpdbname, dbstring, function writeFileCallback(err) {
            if (err) {
              callback(new Error(err));
            } else {
              self2.fs.rename(tmpdbname, dbname, callback);
            }
          });
        };
        LokiFsAdapter.prototype.deleteDatabase = function deleteDatabase(dbname, callback) {
          this.fs.unlink(dbname, function deleteDatabaseCallback(err) {
            if (err) {
              callback(new Error(err));
            } else {
              callback();
            }
          });
        };
        function LokiLocalStorageAdapter() {
        }
        LokiLocalStorageAdapter.prototype.loadDatabase = function loadDatabase(dbname, callback) {
          if (localStorageAvailable()) {
            callback(localStorage.getItem(dbname));
          } else {
            callback(new Error("localStorage is not available"));
          }
        };
        LokiLocalStorageAdapter.prototype.saveDatabase = function saveDatabase(dbname, dbstring, callback) {
          if (localStorageAvailable()) {
            localStorage.setItem(dbname, dbstring);
            callback(null);
          } else {
            callback(new Error("localStorage is not available"));
          }
        };
        LokiLocalStorageAdapter.prototype.deleteDatabase = function deleteDatabase(dbname, callback) {
          if (localStorageAvailable()) {
            localStorage.removeItem(dbname);
            callback(null);
          } else {
            callback(new Error("localStorage is not available"));
          }
        };
        Loki2.prototype.throttledSaveDrain = function(callback, options) {
          var self2 = this;
          var now = (/* @__PURE__ */ new Date()).getTime();
          if (!this.throttledSaves) {
            callback(true);
          }
          options = options || {};
          if (!options.hasOwnProperty("recursiveWait")) {
            options.recursiveWait = true;
          }
          if (!options.hasOwnProperty("recursiveWaitLimit")) {
            options.recursiveWaitLimit = false;
          }
          if (!options.hasOwnProperty("recursiveWaitLimitDuration")) {
            options.recursiveWaitLimitDuration = 2e3;
          }
          if (!options.hasOwnProperty("started")) {
            options.started = (/* @__PURE__ */ new Date()).getTime();
          }
          if (this.throttledSaves && this.throttledSavePending) {
            if (options.recursiveWait) {
              this.throttledCallbacks.push(function() {
                if (self2.throttledSavePending) {
                  if (options.recursiveWaitLimit && now - options.started > options.recursiveWaitLimitDuration) {
                    callback(false);
                    return;
                  }
                  self2.throttledSaveDrain(callback, options);
                  return;
                } else {
                  callback(true);
                  return;
                }
              });
            } else {
              this.throttledCallbacks.push(callback);
              return;
            }
          } else {
            callback(true);
          }
        };
        Loki2.prototype.loadDatabaseInternal = function(options, callback) {
          var cFun = callback || function(err, data) {
            if (err) {
              throw err;
            }
          }, self2 = this;
          if (this.persistenceAdapter !== null) {
            this.persistenceAdapter.loadDatabase(this.filename, function loadDatabaseCallback(dbString) {
              if (typeof dbString === "string") {
                var parseSuccess = false;
                try {
                  self2.loadJSON(dbString, options || {});
                  parseSuccess = true;
                } catch (err) {
                  cFun(err);
                }
                if (parseSuccess) {
                  cFun(null);
                  self2.emit("loaded", "database " + self2.filename + " loaded");
                }
              } else {
                if (!dbString) {
                  cFun(null);
                  self2.emit("loaded", "empty database " + self2.filename + " loaded");
                  return;
                }
                if (dbString instanceof Error) {
                  cFun(dbString);
                  return;
                }
                if (typeof dbString === "object") {
                  self2.loadJSONObject(dbString, options || {});
                  cFun(null);
                  self2.emit("loaded", "database " + self2.filename + " loaded");
                  return;
                }
                cFun("unexpected adapter response : " + dbString);
              }
            });
          } else {
            cFun(new Error("persistenceAdapter not configured"));
          }
        };
        Loki2.prototype.loadDatabase = function(options, callback) {
          var self2 = this;
          if (!this.throttledSaves) {
            this.loadDatabaseInternal(options, callback);
            return;
          }
          this.throttledSaveDrain(function(success) {
            if (success) {
              self2.throttledSavePending = true;
              self2.loadDatabaseInternal(options, function(err) {
                if (self2.throttledCallbacks.length === 0) {
                  self2.throttledSavePending = false;
                } else {
                  self2.saveDatabase();
                }
                if (typeof callback === "function") {
                  callback(err);
                }
              });
              return;
            } else {
              if (typeof callback === "function") {
                callback(new Error("Unable to pause save throttling long enough to read database"));
              }
            }
          }, options);
        };
        Loki2.prototype.saveDatabaseInternal = function(callback) {
          var cFun = callback || function(err) {
            if (err) {
              throw err;
            }
            return;
          };
          var self2 = this;
          if (!this.persistenceAdapter) {
            cFun(new Error("persistenceAdapter not configured"));
            return;
          }
          if (this.persistenceAdapter.mode === "incremental") {
            var cachedDirty;
            this.ignoreAutosave = true;
            this.persistenceAdapter.saveDatabase(this.filename, function getLokiCopy() {
              self2.ignoreAutosave = false;
              if (cachedDirty) {
                cFun(new Error("adapter error - getLokiCopy called more than once"));
                return;
              }
              var lokiCopy = self2.copy({
                removeNonSerializable: true
              });
              cachedDirty = self2.collections.map(function(collection) {
                return [collection.dirty, collection.dirtyIds];
              });
              self2.collections.forEach(function(col) {
                col.dirty = false;
                col.dirtyIds = [];
              });
              return lokiCopy;
            }, function exportDatabaseCallback(err) {
              self2.ignoreAutosave = false;
              if (err && cachedDirty) {
                self2.collections.forEach(function(col, i) {
                  var cached = cachedDirty[i];
                  col.dirty = col.dirty || cached[0];
                  col.dirtyIds = col.dirtyIds.concat(cached[1]);
                });
              }
              cFun(err);
            });
          } else if (this.persistenceAdapter.mode === "reference" && typeof this.persistenceAdapter.exportDatabase === "function") {
            this.persistenceAdapter.exportDatabase(this.filename, this.copy({
              removeNonSerializable: true
            }), function exportDatabaseCallback(err) {
              self2.autosaveClearFlags();
              cFun(err);
            });
          } else {
            this.autosaveClearFlags();
            this.persistenceAdapter.saveDatabase(this.filename, this.serialize(), function saveDatabasecallback(err) {
              cFun(err);
            });
          }
        };
        Loki2.prototype.saveDatabase = function(callback) {
          if (!this.throttledSaves) {
            this.saveDatabaseInternal(callback);
            return;
          }
          if (this.throttledSavePending) {
            this.throttledCallbacks.push(callback);
            return;
          }
          var localCallbacks = this.throttledCallbacks;
          this.throttledCallbacks = [];
          localCallbacks.unshift(callback);
          this.throttledSavePending = true;
          var self2 = this;
          this.saveDatabaseInternal(function(err) {
            self2.throttledSavePending = false;
            localCallbacks.forEach(function(pcb) {
              if (typeof pcb === "function") {
                setTimeout(function() {
                  pcb(err);
                }, 1);
              }
            });
            if (self2.throttledCallbacks.length > 0) {
              self2.saveDatabase();
            }
          });
        };
        Loki2.prototype.save = Loki2.prototype.saveDatabase;
        Loki2.prototype.deleteDatabase = function(options, callback) {
          var cFun = callback || function(err, data) {
            if (err) {
              throw err;
            }
          };
          if (typeof options === "function" && !callback) {
            cFun = options;
          }
          if (this.persistenceAdapter !== null) {
            this.persistenceAdapter.deleteDatabase(this.filename, function deleteDatabaseCallback(err) {
              cFun(err);
            });
          } else {
            cFun(new Error("persistenceAdapter not configured"));
          }
        };
        Loki2.prototype.autosaveDirty = function() {
          for (var idx = 0; idx < this.collections.length; idx++) {
            if (this.collections[idx].dirty) {
              return true;
            }
          }
          return false;
        };
        Loki2.prototype.autosaveClearFlags = function() {
          for (var idx = 0; idx < this.collections.length; idx++) {
            this.collections[idx].dirty = false;
          }
        };
        Loki2.prototype.autosaveEnable = function(options, callback) {
          this.autosave = true;
          var delay = 5e3, self2 = this;
          if (typeof this.autosaveInterval !== "undefined" && this.autosaveInterval !== null) {
            delay = this.autosaveInterval;
          }
          this.autosaveHandle = setInterval(function autosaveHandleInterval() {
            if (self2.autosaveDirty() && !self2.ignoreAutosave) {
              self2.saveDatabase(callback);
            }
          }, delay);
        };
        Loki2.prototype.autosaveDisable = function() {
          if (typeof this.autosaveHandle !== "undefined" && this.autosaveHandle !== null) {
            clearInterval(this.autosaveHandle);
            this.autosaveHandle = null;
          }
        };
        function Resultset(collection, options) {
          options = options || {};
          this.collection = collection;
          this.filteredrows = [];
          this.filterInitialized = false;
          return this;
        }
        Resultset.prototype.reset = function() {
          if (this.filteredrows.length > 0) {
            this.filteredrows = [];
          }
          this.filterInitialized = false;
          return this;
        };
        Resultset.prototype.toJSON = function() {
          var copy = this.copy();
          copy.collection = null;
          return copy;
        };
        Resultset.prototype.limit = function(qty) {
          if (!this.filterInitialized && this.filteredrows.length === 0) {
            this.filteredrows = this.collection.prepareFullDocIndex();
          }
          var rscopy = new Resultset(this.collection);
          rscopy.filteredrows = this.filteredrows.slice(0, qty);
          rscopy.filterInitialized = true;
          return rscopy;
        };
        Resultset.prototype.offset = function(pos) {
          if (!this.filterInitialized && this.filteredrows.length === 0) {
            this.filteredrows = this.collection.prepareFullDocIndex();
          }
          var rscopy = new Resultset(this.collection);
          rscopy.filteredrows = this.filteredrows.slice(pos);
          rscopy.filterInitialized = true;
          return rscopy;
        };
        Resultset.prototype.copy = function() {
          var result = new Resultset(this.collection);
          if (this.filteredrows.length > 0) {
            result.filteredrows = this.filteredrows.slice();
          }
          result.filterInitialized = this.filterInitialized;
          return result;
        };
        Resultset.prototype.branch = Resultset.prototype.copy;
        Resultset.prototype.transform = function(transform, parameters) {
          var idx, step, rs = this;
          if (typeof transform === "string") {
            if (this.collection.transforms.hasOwnProperty(transform)) {
              transform = this.collection.transforms[transform];
            }
          }
          if (typeof transform !== "object" || !Array.isArray(transform)) {
            throw new Error("Invalid transform");
          }
          if (typeof parameters !== "undefined") {
            transform = Utils.resolveTransformParams(transform, parameters);
          }
          for (idx = 0; idx < transform.length; idx++) {
            step = transform[idx];
            switch (step.type) {
              case "find":
                rs.find(step.value);
                break;
              case "where":
                rs.where(step.value);
                break;
              case "simplesort":
                rs.simplesort(step.property, step.desc || step.options);
                break;
              case "compoundsort":
                rs.compoundsort(step.value);
                break;
              case "sort":
                rs.sort(step.value);
                break;
              case "limit":
                rs = rs.limit(step.value);
                break;
              // limit makes copy so update reference
              case "offset":
                rs = rs.offset(step.value);
                break;
              // offset makes copy so update reference
              case "map":
                rs = rs.map(step.value, step.dataOptions);
                break;
              case "eqJoin":
                rs = rs.eqJoin(step.joinData, step.leftJoinKey, step.rightJoinKey, step.mapFun, step.dataOptions);
                break;
              // following cases break chain by returning array data so make any of these last in transform steps
              case "mapReduce":
                rs = rs.mapReduce(step.mapFunction, step.reduceFunction);
                break;
              // following cases update documents in current filtered resultset (use carefully)
              case "update":
                rs.update(step.value);
                break;
              case "remove":
                rs.remove();
                break;
              default:
                break;
            }
          }
          return rs;
        };
        Resultset.prototype.sort = function(comparefun) {
          if (!this.filterInitialized && this.filteredrows.length === 0) {
            this.filteredrows = this.collection.prepareFullDocIndex();
          }
          var wrappedComparer = /* @__PURE__ */ function(userComparer, data) {
            return function(a, b) {
              return userComparer(data[a], data[b]);
            };
          }(comparefun, this.collection.data);
          this.filteredrows.sort(wrappedComparer);
          return this;
        };
        Resultset.prototype.simplesort = function(propname, options) {
          var eff, targetEff = 10, dc = this.collection.data.length, frl = this.filteredrows.length, hasBinaryIndex = this.collection.binaryIndices.hasOwnProperty(propname);
          if (typeof options === "undefined" || options === false) {
            options = {
              desc: false
            };
          }
          if (options === true) {
            options = {
              desc: true
            };
          }
          if (frl === 0) {
            if (this.filterInitialized) {
              return this;
            }
            if (this.collection.binaryIndices.hasOwnProperty(propname)) {
              this.collection.ensureIndex(propname);
              this.filteredrows = this.collection.binaryIndices[propname].values.slice(0);
              if (options.desc) {
                this.filteredrows.reverse();
              }
              return this;
            } else {
              this.filteredrows = this.collection.prepareFullDocIndex();
            }
          } else {
            if (!options.disableIndexIntersect && hasBinaryIndex) {
              eff = dc / frl;
              if (options.useJavascriptSorting) {
                targetEff = 6;
              }
              if (eff <= targetEff || options.forceIndexIntersect) {
                var idx, fr = this.filteredrows;
                var io = {};
                for (idx = 0; idx < frl; idx++) {
                  io[fr[idx]] = true;
                }
                var pv = this.collection.binaryIndices[propname].values;
                this.filteredrows = pv.filter(function(n) {
                  return io[n];
                });
                if (options.desc) {
                  this.filteredrows.reverse();
                }
                return this;
              }
            }
          }
          if (options.useJavascriptSorting) {
            return this.sort(function(obj1, obj2) {
              if (obj1[propname] === obj2[propname]) return 0;
              if (obj1[propname] > obj2[propname]) return 1;
              if (obj1[propname] < obj2[propname]) return -1;
            });
          }
          var wrappedComparer = /* @__PURE__ */ function(prop, desc, data) {
            var val1, val2, arr;
            return function(a, b) {
              if (~prop.indexOf(".")) {
                arr = prop.split(".");
                val1 = Utils.getIn(data[a], arr, true);
                val2 = Utils.getIn(data[b], arr, true);
              } else {
                val1 = data[a][prop];
                val2 = data[b][prop];
              }
              return sortHelper(val1, val2, desc);
            };
          }(propname, options.desc, this.collection.data);
          this.filteredrows.sort(wrappedComparer);
          return this;
        };
        Resultset.prototype.compoundsort = function(properties) {
          if (properties.length === 0) {
            throw new Error("Invalid call to compoundsort, need at least one property");
          }
          var prop;
          if (properties.length === 1) {
            prop = properties[0];
            if (Array.isArray(prop)) {
              return this.simplesort(prop[0], prop[1]);
            }
            return this.simplesort(prop, false);
          }
          for (var i = 0, len = properties.length; i < len; i += 1) {
            prop = properties[i];
            if (!Array.isArray(prop)) {
              properties[i] = [prop, false];
            }
          }
          if (!this.filterInitialized && this.filteredrows.length === 0) {
            this.filteredrows = this.collection.prepareFullDocIndex();
          }
          var wrappedComparer = /* @__PURE__ */ function(props, data) {
            return function(a, b) {
              return compoundeval(props, data[a], data[b]);
            };
          }(properties, this.collection.data);
          this.filteredrows.sort(wrappedComparer);
          return this;
        };
        Resultset.prototype.findOr = function(expressionArray) {
          var fr = null, fri = 0, frlen = 0, docset = [], idxset = [], idx = 0, origCount = this.count();
          for (var ei = 0, elen = expressionArray.length; ei < elen; ei++) {
            fr = this.branch().find(expressionArray[ei]).filteredrows;
            frlen = fr.length;
            for (fri = 0; fri < frlen; fri++) {
              idx = fr[fri];
              if (idxset[idx] === void 0) {
                idxset[idx] = true;
                docset.push(idx);
              }
            }
          }
          this.filteredrows = docset;
          this.filterInitialized = true;
          return this;
        };
        Resultset.prototype.$or = Resultset.prototype.findOr;
        function precompileQuery(operator, value) {
          if (operator === "$regex") {
            if (Array.isArray(value)) {
              value = new RegExp(value[0], value[1]);
            } else if (!(value instanceof RegExp)) {
              value = new RegExp(value);
            }
          } else if (typeof value === "object") {
            for (var key in value) {
              if (key === "$regex" || typeof value[key] === "object") {
                value[key] = precompileQuery(key, value[key]);
              }
            }
          }
          return value;
        }
        Resultset.prototype.findAnd = function(expressionArray) {
          for (var i = 0, len = expressionArray.length; i < len; i++) {
            if (this.count() === 0) {
              return this;
            }
            this.find(expressionArray[i]);
          }
          return this;
        };
        Resultset.prototype.$and = Resultset.prototype.findAnd;
        Resultset.prototype.find = function(query, firstOnly) {
          if (this.collection.data.length === 0) {
            this.filteredrows = [];
            this.filterInitialized = true;
            return this;
          }
          var queryObject = query || "getAll", p, property, queryObjectOp, obj, operator, value, key, searchByIndex = false, result = [], filters = [], index = null;
          firstOnly = firstOnly || false;
          if (typeof queryObject === "object") {
            for (p in queryObject) {
              obj = {};
              obj[p] = queryObject[p];
              filters.push(obj);
              if (hasOwnProperty.call(queryObject, p)) {
                property = p;
                queryObjectOp = queryObject[p];
              }
            }
            if (filters.length > 1) {
              return this.find({
                "$and": filters
              }, firstOnly);
            }
          }
          if (!property || queryObject === "getAll") {
            if (firstOnly) {
              if (this.filterInitialized) {
                this.filteredrows = this.filteredrows.slice(0, 1);
              } else {
                this.filteredrows = this.collection.data.length > 0 ? [0] : [];
                this.filterInitialized = true;
              }
            }
            return this;
          }
          if (property === "$and" || property === "$or") {
            this[property](queryObjectOp);
            if (firstOnly && this.filteredrows.length > 1) {
              this.filteredrows = this.filteredrows.slice(0, 1);
            }
            return this;
          }
          if (queryObjectOp === null || typeof queryObjectOp !== "object" || queryObjectOp instanceof Date) {
            operator = "$eq";
            value = queryObjectOp;
          } else if (typeof queryObjectOp === "object") {
            for (key in queryObjectOp) {
              if (hasOwnProperty.call(queryObjectOp, key)) {
                operator = key;
                value = queryObjectOp[key];
                break;
              }
            }
          } else {
            throw new Error("Do not know what you want to do.");
          }
          if (operator === "$regex" || typeof value === "object") {
            value = precompileQuery(operator, value);
          }
          var usingDotNotation = property.indexOf(".") !== -1;
          var doIndexCheck = !this.filterInitialized;
          if (doIndexCheck && this.collection.binaryIndices[property] && indexedOps[operator]) {
            if (this.collection.adaptiveBinaryIndices !== true) {
              this.collection.ensureIndex(property);
            }
            searchByIndex = true;
            index = this.collection.binaryIndices[property];
          }
          if (!searchByIndex && operator === "$in" && Array.isArray(value) && typeof Set !== "undefined") {
            value = new Set(value);
            operator = "$inSet";
          }
          var fun = LokiOps[operator];
          var t = this.collection.data;
          var i = 0, len = 0;
          var filter, rowIdx = 0, record;
          if (this.filterInitialized) {
            filter = this.filteredrows;
            len = filter.length;
            if (usingDotNotation) {
              property = property.split(".");
              for (i = 0; i < len; i++) {
                rowIdx = filter[i];
                record = t[rowIdx];
                if (dotSubScan(record, property, fun, value, record)) {
                  result.push(rowIdx);
                  if (firstOnly) {
                    this.filteredrows = result;
                    return this;
                  }
                }
              }
            } else {
              for (i = 0; i < len; i++) {
                rowIdx = filter[i];
                record = t[rowIdx];
                if (fun(record[property], value, record)) {
                  result.push(rowIdx);
                  if (firstOnly) {
                    this.filteredrows = result;
                    return this;
                  }
                }
              }
            }
          } else {
            if (!searchByIndex) {
              len = t.length;
              if (usingDotNotation) {
                property = property.split(".");
                for (i = 0; i < len; i++) {
                  record = t[i];
                  if (dotSubScan(record, property, fun, value, record)) {
                    result.push(i);
                    if (firstOnly) {
                      this.filteredrows = result;
                      this.filterInitialized = true;
                      return this;
                    }
                  }
                }
              } else {
                for (i = 0; i < len; i++) {
                  record = t[i];
                  if (fun(record[property], value, record)) {
                    result.push(i);
                    if (firstOnly) {
                      this.filteredrows = result;
                      this.filterInitialized = true;
                      return this;
                    }
                  }
                }
              }
            } else {
              var segm = this.collection.calculateRange(operator, property, value);
              if (operator !== "$in") {
                for (i = segm[0]; i <= segm[1]; i++) {
                  if (indexedOps[operator] !== true) {
                    if (indexedOps[operator](Utils.getIn(t[index.values[i]], property, usingDotNotation), value)) {
                      result.push(index.values[i]);
                      if (firstOnly) {
                        this.filteredrows = result;
                        this.filterInitialized = true;
                        return this;
                      }
                    }
                  } else {
                    result.push(index.values[i]);
                    if (firstOnly) {
                      this.filteredrows = result;
                      this.filterInitialized = true;
                      return this;
                    }
                  }
                }
              } else {
                for (i = 0, len = segm.length; i < len; i++) {
                  result.push(index.values[segm[i]]);
                  if (firstOnly) {
                    this.filteredrows = result;
                    this.filterInitialized = true;
                    return this;
                  }
                }
              }
            }
          }
          this.filteredrows = result;
          this.filterInitialized = true;
          return this;
        };
        Resultset.prototype.where = function(fun) {
          var viewFunction, result = [];
          if ("function" === typeof fun) {
            viewFunction = fun;
          } else {
            throw new TypeError("Argument is not a stored view or a function");
          }
          try {
            if (this.filterInitialized) {
              var j = this.filteredrows.length;
              while (j--) {
                if (viewFunction(this.collection.data[this.filteredrows[j]]) === true) {
                  result.push(this.filteredrows[j]);
                }
              }
              this.filteredrows = result;
              return this;
            } else {
              var k = this.collection.data.length;
              while (k--) {
                if (viewFunction(this.collection.data[k]) === true) {
                  result.push(k);
                }
              }
              this.filteredrows = result;
              this.filterInitialized = true;
              return this;
            }
          } catch (err) {
            throw err;
          }
        };
        Resultset.prototype.count = function() {
          if (this.filterInitialized) {
            return this.filteredrows.length;
          }
          return this.collection.count();
        };
        Resultset.prototype.data = function(options) {
          var result = [], data = this.collection.data, obj, len, i, method;
          options = options || {};
          if (options.removeMeta && !options.forceClones) {
            options.forceClones = true;
            options.forceCloneMethod = options.forceCloneMethod || "shallow";
          }
          if (!this.collection.disableDeltaChangesApi && this.collection.disableFreeze) {
            options.forceClones = true;
            options.forceCloneMethod = "parse-stringify";
          }
          if (!this.filterInitialized) {
            if (this.filteredrows.length === 0) {
              if (this.collection.cloneObjects || options.forceClones) {
                len = data.length;
                method = options.forceCloneMethod || this.collection.cloneMethod;
                for (i = 0; i < len; i++) {
                  obj = clone(data[i], method);
                  if (options.removeMeta) {
                    delete obj.$loki;
                    delete obj.meta;
                  }
                  result.push(obj);
                }
                return result;
              } else {
                return data.slice();
              }
            } else {
              this.filterInitialized = true;
            }
          }
          var fr = this.filteredrows;
          len = fr.length;
          if (this.collection.cloneObjects || options.forceClones) {
            method = options.forceCloneMethod || this.collection.cloneMethod;
            for (i = 0; i < len; i++) {
              obj = clone(data[fr[i]], method);
              if (options.removeMeta) {
                delete obj.$loki;
                delete obj.meta;
              }
              result.push(obj);
            }
          } else {
            for (i = 0; i < len; i++) {
              result.push(data[fr[i]]);
            }
          }
          return result;
        };
        Resultset.prototype.update = function(updateFunction) {
          if (typeof updateFunction !== "function") {
            throw new TypeError("Argument is not a function");
          }
          if (!this.filterInitialized && this.filteredrows.length === 0) {
            this.filteredrows = this.collection.prepareFullDocIndex();
          }
          var obj, len = this.filteredrows.length, rcd = this.collection.data;
          for (var idx = 0; idx < len; idx++) {
            if (!this.disableFreeze || this.collection.cloneObjects || !this.collection.disableDeltaChangesApi) {
              obj = clone(rcd[this.filteredrows[idx]], this.collection.cloneMethod);
              updateFunction(obj);
              this.collection.update(obj);
            } else {
              updateFunction(rcd[this.filteredrows[idx]]);
              this.collection.update(rcd[this.filteredrows[idx]]);
            }
          }
          return this;
        };
        Resultset.prototype.remove = function() {
          if (!this.filterInitialized && this.filteredrows.length === 0) {
            this.filteredrows = this.collection.prepareFullDocIndex();
          }
          this.collection.removeBatchByPositions(this.filteredrows);
          this.filteredrows = [];
          return this;
        };
        Resultset.prototype.mapReduce = function(mapFunction, reduceFunction) {
          try {
            return reduceFunction(this.data().map(mapFunction));
          } catch (err) {
            throw err;
          }
        };
        Resultset.prototype.eqJoin = function(joinData, leftJoinKey, rightJoinKey, mapFun, dataOptions) {
          var leftData = [], leftDataLength, rightData = [], rightDataLength, key, result = [], leftKeyisFunction = typeof leftJoinKey === "function", rightKeyisFunction = typeof rightJoinKey === "function", joinMap = {};
          leftData = this.data(dataOptions);
          leftDataLength = leftData.length;
          if (joinData instanceof Collection) {
            rightData = joinData.chain().data(dataOptions);
          } else if (joinData instanceof Resultset) {
            rightData = joinData.data(dataOptions);
          } else if (Array.isArray(joinData)) {
            rightData = joinData;
          } else {
            throw new TypeError("joinData needs to be an array or result set");
          }
          rightDataLength = rightData.length;
          for (var i = 0; i < rightDataLength; i++) {
            key = rightKeyisFunction ? rightJoinKey(rightData[i]) : rightData[i][rightJoinKey];
            joinMap[key] = rightData[i];
          }
          if (!mapFun) {
            mapFun = function(left, right) {
              return {
                left,
                right
              };
            };
          }
          for (var j = 0; j < leftDataLength; j++) {
            key = leftKeyisFunction ? leftJoinKey(leftData[j]) : leftData[j][leftJoinKey];
            result.push(mapFun(leftData[j], joinMap[key] || {}));
          }
          this.collection = new Collection("joinData");
          this.collection.insert(result);
          this.filteredrows = [];
          this.filterInitialized = false;
          return this;
        };
        Resultset.prototype.map = function(mapFun, dataOptions) {
          var data = this.data(dataOptions).map(mapFun);
          this.collection = new Collection("mappedData");
          this.collection.insert(data);
          this.filteredrows = [];
          this.filterInitialized = false;
          return this;
        };
        function DynamicView(collection, name, options) {
          this.collection = collection;
          this.name = name;
          this.rebuildPending = false;
          this.options = options || {};
          if (!this.options.hasOwnProperty("persistent")) {
            this.options.persistent = false;
          }
          if (!this.options.hasOwnProperty("sortPriority")) {
            this.options.sortPriority = "passive";
          }
          if (!this.options.hasOwnProperty("minRebuildInterval")) {
            this.options.minRebuildInterval = 1;
          }
          this.resultset = new Resultset(collection);
          this.resultdata = [];
          this.resultsdirty = false;
          this.cachedresultset = null;
          this.filterPipeline = [];
          if (!this.collection.disableFreeze) {
            Object.freeze(this.filterPipeline);
          }
          this.sortFunction = null;
          this.sortCriteria = null;
          this.sortCriteriaSimple = null;
          this.sortDirty = false;
          this.events = {
            "rebuild": [],
            "filter": [],
            "sort": []
          };
        }
        DynamicView.prototype = new LokiEventEmitter();
        DynamicView.prototype.constructor = DynamicView;
        DynamicView.prototype.getSort = function() {
          return this.sortFunction || this.sortCriteria || this.sortCriteriaSimple;
        };
        DynamicView.prototype.rematerialize = function(options) {
          var fpl, fpi, idx;
          options = options || {};
          this.resultdata = [];
          this.resultsdirty = true;
          this.resultset = new Resultset(this.collection);
          if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
            this.sortDirty = true;
          }
          var wasFrozen = Object.isFrozen(this.filterPipeline);
          if (options.hasOwnProperty("removeWhereFilters")) {
            if (wasFrozen) {
              this.filterPipeline = this.filterPipeline.slice();
            }
            fpl = this.filterPipeline.length;
            fpi = fpl;
            while (fpi--) {
              if (this.filterPipeline[fpi].type === "where") {
                if (fpi !== this.filterPipeline.length - 1) {
                  this.filterPipeline[fpi] = this.filterPipeline[this.filterPipeline.length - 1];
                }
                this.filterPipeline.length--;
              }
            }
          }
          var ofp = this.filterPipeline;
          this.filterPipeline = [];
          fpl = ofp.length;
          for (idx = 0; idx < fpl; idx++) {
            this.applyFind(ofp[idx].val, ofp[idx].uid);
          }
          if (wasFrozen) {
            Object.freeze(this.filterPipeline);
          }
          this.data();
          this.emit("rebuild", this);
          return this;
        };
        DynamicView.prototype.branchResultset = function(transform, parameters) {
          var rs = this.resultset.branch();
          if (typeof transform === "undefined") {
            return rs;
          }
          return rs.transform(transform, parameters);
        };
        DynamicView.prototype.toJSON = function() {
          var copy = new DynamicView(this.collection, this.name, this.options);
          copy.resultset = this.resultset;
          copy.resultdata = [];
          copy.resultsdirty = true;
          copy.filterPipeline = this.filterPipeline;
          copy.sortFunction = this.sortFunction;
          copy.sortCriteria = this.sortCriteria;
          copy.sortCriteriaSimple = this.sortCriteriaSimple || null;
          copy.sortDirty = this.sortDirty;
          copy.collection = null;
          return copy;
        };
        DynamicView.prototype.removeFilters = function(options) {
          options = options || {};
          this.rebuildPending = false;
          this.resultset.reset();
          this.resultdata = [];
          this.resultsdirty = true;
          this.cachedresultset = null;
          var wasFrozen = Object.isFrozen(this.filterPipeline);
          var filterChanged = this.filterPipeline.length > 0;
          this.filterPipeline = [];
          if (wasFrozen) {
            Object.freeze(this.filterPipeline);
          }
          this.sortFunction = null;
          this.sortCriteria = null;
          this.sortCriteriaSimple = null;
          this.sortDirty = false;
          if (options.queueSortPhase === true) {
            this.queueSortPhase();
          }
          if (filterChanged) {
            this.emit("filter");
          }
        };
        DynamicView.prototype.applySort = function(comparefun) {
          this.sortFunction = comparefun;
          this.sortCriteria = null;
          this.sortCriteriaSimple = null;
          this.queueSortPhase();
          this.emit("sort");
          return this;
        };
        DynamicView.prototype.applySimpleSort = function(propname, options) {
          this.sortCriteriaSimple = {
            propname,
            options: options || false
          };
          if (!this.collection.disableFreeze) {
            deepFreeze(this.sortCriteriaSimple);
          }
          this.sortCriteria = null;
          this.sortFunction = null;
          this.queueSortPhase();
          this.emit("sort");
          return this;
        };
        DynamicView.prototype.applySortCriteria = function(criteria) {
          this.sortCriteria = criteria;
          if (!this.collection.disableFreeze) {
            deepFreeze(this.sortCriteria);
          }
          this.sortCriteriaSimple = null;
          this.sortFunction = null;
          this.queueSortPhase();
          this.emit("sort");
          return this;
        };
        DynamicView.prototype.startTransaction = function() {
          this.cachedresultset = this.resultset.copy();
          return this;
        };
        DynamicView.prototype.commit = function() {
          this.cachedresultset = null;
          return this;
        };
        DynamicView.prototype.rollback = function() {
          this.resultset = this.cachedresultset;
          if (this.options.persistent) {
            this.resultdata = this.resultset.data();
            this.emit("rebuild", this);
          }
          return this;
        };
        DynamicView.prototype._indexOfFilterWithId = function(uid) {
          if (typeof uid === "string" || typeof uid === "number") {
            for (var idx = 0, len = this.filterPipeline.length; idx < len; idx += 1) {
              if (uid === this.filterPipeline[idx].uid) {
                return idx;
              }
            }
          }
          return -1;
        };
        DynamicView.prototype._addFilter = function(filter) {
          var wasFrozen = Object.isFrozen(this.filterPipeline);
          if (wasFrozen) {
            this.filterPipeline = this.filterPipeline.slice();
          }
          if (!this.collection.disableFreeze) {
            deepFreeze(filter);
          }
          this.filterPipeline.push(filter);
          if (wasFrozen) {
            Object.freeze(this.filterPipeline);
          }
          this.resultset[filter.type](filter.val);
        };
        DynamicView.prototype.reapplyFilters = function() {
          this.resultset.reset();
          this.cachedresultset = null;
          if (this.options.persistent) {
            this.resultdata = [];
            this.resultsdirty = true;
          }
          var filters = this.filterPipeline;
          var wasFrozen = Object.isFrozen(filters);
          this.filterPipeline = [];
          for (var idx = 0, len = filters.length; idx < len; idx += 1) {
            this._addFilter(filters[idx]);
          }
          if (wasFrozen) {
            Object.freeze(this.filterPipeline);
          }
          if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
            this.queueSortPhase();
          } else {
            this.queueRebuildEvent();
          }
          this.emit("filter");
          return this;
        };
        DynamicView.prototype.applyFilter = function(filter) {
          var idx = this._indexOfFilterWithId(filter.uid);
          if (idx >= 0) {
            var wasFrozen = Object.isFrozen(this.filterPipeline);
            if (wasFrozen) {
              this.filterPipeline = this.filterPipeline.slice();
            }
            this.filterPipeline[idx] = filter;
            if (wasFrozen) {
              freeze(filter);
              Object.freeze(this.filterPipeline);
            }
            return this.reapplyFilters();
          }
          this.cachedresultset = null;
          if (this.options.persistent) {
            this.resultdata = [];
            this.resultsdirty = true;
          }
          this._addFilter(filter);
          if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
            this.queueSortPhase();
          } else {
            this.queueRebuildEvent();
          }
          this.emit("filter");
          return this;
        };
        DynamicView.prototype.applyFind = function(query, uid) {
          this.applyFilter({
            type: "find",
            val: query,
            uid
          });
          return this;
        };
        DynamicView.prototype.applyWhere = function(fun, uid) {
          this.applyFilter({
            type: "where",
            val: fun,
            uid
          });
          return this;
        };
        DynamicView.prototype.removeFilter = function(uid) {
          var idx = this._indexOfFilterWithId(uid);
          if (idx < 0) {
            throw new Error("Dynamic view does not contain a filter with ID: " + uid);
          }
          var wasFrozen = Object.isFrozen(this.filterPipeline);
          if (wasFrozen) {
            this.filterPipeline = this.filterPipeline.slice();
          }
          this.filterPipeline.splice(idx, 1);
          if (wasFrozen) {
            Object.freeze(this.filterPipeline);
          }
          this.reapplyFilters();
          return this;
        };
        DynamicView.prototype.count = function() {
          if (this.resultsdirty) {
            this.resultdata = this.resultset.data();
          }
          return this.resultset.count();
        };
        DynamicView.prototype.data = function(options) {
          if (this.sortDirty || this.resultsdirty) {
            this.performSortPhase({
              suppressRebuildEvent: true
            });
          }
          return this.options.persistent ? this.resultdata : this.resultset.data(options);
        };
        DynamicView.prototype.queueRebuildEvent = function() {
          if (this.rebuildPending) {
            return;
          }
          this.rebuildPending = true;
          var self2 = this;
          setTimeout(function() {
            if (self2.rebuildPending) {
              self2.rebuildPending = false;
              self2.emit("rebuild", self2);
            }
          }, this.options.minRebuildInterval);
        };
        DynamicView.prototype.queueSortPhase = function() {
          if (this.sortDirty) {
            return;
          }
          this.sortDirty = true;
          var self2 = this;
          if (this.options.sortPriority === "active") {
            setTimeout(function() {
              self2.performSortPhase();
            }, this.options.minRebuildInterval);
          } else {
            this.queueRebuildEvent();
          }
        };
        DynamicView.prototype.performSortPhase = function(options) {
          if (!this.sortDirty && !this.resultsdirty) {
            return;
          }
          options = options || {};
          if (this.sortDirty) {
            if (this.sortFunction) {
              this.resultset.sort(this.sortFunction);
            } else if (this.sortCriteria) {
              this.resultset.compoundsort(this.sortCriteria);
            } else if (this.sortCriteriaSimple) {
              this.resultset.simplesort(this.sortCriteriaSimple.propname, this.sortCriteriaSimple.options);
            }
            this.sortDirty = false;
          }
          if (this.options.persistent) {
            this.resultdata = this.resultset.data();
            this.resultsdirty = false;
          }
          if (!options.suppressRebuildEvent) {
            this.emit("rebuild", this);
          }
        };
        DynamicView.prototype.evaluateDocument = function(objIndex, isNew) {
          if (!this.resultset.filterInitialized) {
            if (this.options.persistent) {
              this.resultdata = this.resultset.data();
            }
            if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
              this.queueSortPhase();
            } else {
              this.queueRebuildEvent();
            }
            return;
          }
          var ofr = this.resultset.filteredrows;
          var oldPos = isNew ? -1 : ofr.indexOf(+objIndex);
          var oldlen = ofr.length;
          var evalResultset = new Resultset(this.collection);
          evalResultset.filteredrows = [objIndex];
          evalResultset.filterInitialized = true;
          var filter;
          for (var idx = 0, len = this.filterPipeline.length; idx < len; idx++) {
            filter = this.filterPipeline[idx];
            evalResultset[filter.type](filter.val);
          }
          var newPos = evalResultset.filteredrows.length === 0 ? -1 : 0;
          if (oldPos === -1 && newPos === -1) return;
          if (oldPos === -1 && newPos !== -1) {
            ofr.push(objIndex);
            if (this.options.persistent) {
              this.resultdata.push(this.collection.data[objIndex]);
            }
            if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
              this.queueSortPhase();
            } else {
              this.queueRebuildEvent();
            }
            return;
          }
          if (oldPos !== -1 && newPos === -1) {
            if (oldPos < oldlen - 1) {
              ofr.splice(oldPos, 1);
              if (this.options.persistent) {
                this.resultdata.splice(oldPos, 1);
              }
            } else {
              ofr.length = oldlen - 1;
              if (this.options.persistent) {
                this.resultdata.length = oldlen - 1;
              }
            }
            if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
              this.queueSortPhase();
            } else {
              this.queueRebuildEvent();
            }
            return;
          }
          if (oldPos !== -1 && newPos !== -1) {
            if (this.options.persistent) {
              this.resultdata[oldPos] = this.collection.data[objIndex];
            }
            if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
              this.queueSortPhase();
            } else {
              this.queueRebuildEvent();
            }
            return;
          }
        };
        DynamicView.prototype.removeDocument = function(objIndex) {
          var idx, rmidx, rmlen, rxo = {}, fxo = {};
          var adjels = [];
          var drs = this.resultset;
          var fr = this.resultset.filteredrows;
          var frlen = fr.length;
          if (!this.resultset.filterInitialized) {
            if (this.options.persistent) {
              this.resultdata = this.resultset.data();
            }
            if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
              this.queueSortPhase();
            } else {
              this.queueRebuildEvent();
            }
            return;
          }
          if (!Array.isArray(objIndex)) {
            objIndex = [objIndex];
          }
          rmlen = objIndex.length;
          for (rmidx = 0; rmidx < rmlen; rmidx++) {
            rxo[objIndex[rmidx]] = true;
          }
          for (idx = 0; idx < frlen; idx++) {
            if (rxo[fr[idx]]) fxo[idx] = true;
          }
          if (Object.keys(fxo).length > 0) {
            this.resultset.filteredrows = this.resultset.filteredrows.filter(function(di, idx2) {
              return !fxo[idx2];
            });
            if (this.options.persistent) {
              this.resultdata = this.resultdata.filter(function(obj, idx2) {
                return !fxo[idx2];
              });
            }
            if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
              this.queueSortPhase();
            } else {
              this.queueRebuildEvent();
            }
          }
          var filt = function(idx2) {
            return function(di) {
              return di < drs.filteredrows[idx2];
            };
          };
          frlen = drs.filteredrows.length;
          for (idx = 0; idx < frlen; idx++) {
            adjels = objIndex.filter(filt(idx));
            drs.filteredrows[idx] -= adjels.length;
          }
        };
        DynamicView.prototype.mapReduce = function(mapFunction, reduceFunction) {
          try {
            return reduceFunction(this.data().map(mapFunction));
          } catch (err) {
            throw err;
          }
        };
        function Collection(name, options) {
          this.name = name;
          this.data = [];
          this.idIndex = null;
          this.binaryIndices = {};
          this.constraints = {
            unique: {},
            exact: {}
          };
          this.uniqueNames = [];
          this.transforms = {};
          this.objType = name;
          this.dirty = true;
          this.cachedIndex = null;
          this.cachedBinaryIndex = null;
          this.cachedData = null;
          var self2 = this;
          options = options || {};
          if (options.hasOwnProperty("unique")) {
            if (!Array.isArray(options.unique)) {
              options.unique = [options.unique];
            }
            options.unique.forEach(function(prop) {
              self2.uniqueNames.push(prop);
            });
          }
          if (options.hasOwnProperty("exact")) {
            options.exact.forEach(function(prop) {
              self2.constraints.exact[prop] = new ExactIndex(prop);
            });
          }
          this.adaptiveBinaryIndices = options.hasOwnProperty("adaptiveBinaryIndices") ? options.adaptiveBinaryIndices : true;
          this.transactional = options.hasOwnProperty("transactional") ? options.transactional : false;
          this.cloneObjects = options.hasOwnProperty("clone") ? options.clone : false;
          this.cloneMethod = options.hasOwnProperty("cloneMethod") ? options.cloneMethod : "parse-stringify";
          this.asyncListeners = options.hasOwnProperty("asyncListeners") ? options.asyncListeners : false;
          this.disableMeta = options.hasOwnProperty("disableMeta") ? options.disableMeta : false;
          this.disableChangesApi = options.hasOwnProperty("disableChangesApi") ? options.disableChangesApi : true;
          this.disableDeltaChangesApi = options.hasOwnProperty("disableDeltaChangesApi") ? options.disableDeltaChangesApi : true;
          if (this.disableChangesApi) {
            this.disableDeltaChangesApi = true;
          }
          this.autoupdate = options.hasOwnProperty("autoupdate") ? options.autoupdate : false;
          this.serializableIndices = options.hasOwnProperty("serializableIndices") ? options.serializableIndices : true;
          this.disableFreeze = options.hasOwnProperty("disableFreeze") ? options.disableFreeze : true;
          this.ttl = {
            age: null,
            ttlInterval: null,
            daemon: null
          };
          this.setTTL(options.ttl || -1, options.ttlInterval);
          this.maxId = 0;
          this.DynamicViews = [];
          this.events = {
            "insert": [],
            "update": [],
            "pre-insert": [],
            "pre-update": [],
            "close": [],
            "flushbuffer": [],
            "error": [],
            "delete": [],
            "warning": []
          };
          this.changes = [];
          this.dirtyIds = [];
          var indices = [];
          if (options && options.indices) {
            if (Object.prototype.toString.call(options.indices) === "[object Array]") {
              indices = options.indices;
            } else if (typeof options.indices === "string") {
              indices = [options.indices];
            } else {
              throw new TypeError("Indices needs to be a string or an array of strings");
            }
          }
          for (var idx = 0; idx < indices.length; idx++) {
            this.ensureIndex(indices[idx]);
          }
          function observerCallback(changes) {
            var changedObjects = typeof Set === "function" ? /* @__PURE__ */ new Set() : [];
            if (!changedObjects.add) changedObjects.add = function(object) {
              if (this.indexOf(object) === -1) this.push(object);
              return this;
            };
            changes.forEach(function(change) {
              changedObjects.add(change.object);
            });
            changedObjects.forEach(function(object) {
              if (!hasOwnProperty.call(object, "$loki")) return self2.removeAutoUpdateObserver(object);
              try {
                self2.update(object);
              } catch (err) {
              }
            });
          }
          this.observerCallback = observerCallback;
          function getChangeDelta(obj, old) {
            if (old) {
              return getObjectDelta(old, obj);
            } else {
              return JSON.parse(JSON.stringify(obj));
            }
          }
          this.getChangeDelta = getChangeDelta;
          function getObjectDelta(oldObject, newObject) {
            var propertyNames = newObject !== null && typeof newObject === "object" ? Object.keys(newObject) : null;
            if (propertyNames && propertyNames.length && ["string", "boolean", "number"].indexOf(typeof newObject) < 0) {
              var delta = {};
              for (var i = 0; i < propertyNames.length; i++) {
                var propertyName = propertyNames[i];
                if (newObject.hasOwnProperty(propertyName)) {
                  if (!oldObject.hasOwnProperty(propertyName) || self2.uniqueNames.indexOf(propertyName) >= 0 || propertyName == "$loki" || propertyName == "meta") {
                    delta[propertyName] = newObject[propertyName];
                  } else {
                    var propertyDelta = getObjectDelta(oldObject[propertyName], newObject[propertyName]);
                    if (typeof propertyDelta !== "undefined" && propertyDelta != {}) {
                      delta[propertyName] = propertyDelta;
                    }
                  }
                }
              }
              return Object.keys(delta).length === 0 ? void 0 : delta;
            } else {
              return oldObject === newObject ? void 0 : newObject;
            }
          }
          this.getObjectDelta = getObjectDelta;
          function flushChanges() {
            self2.changes = [];
          }
          this.getChanges = function() {
            return self2.changes;
          };
          this.flushChanges = flushChanges;
          this.setChangesApi = function(enabled) {
            self2.disableChangesApi = !enabled;
            if (!enabled) {
              self2.disableDeltaChangesApi = false;
            }
          };
          this.on("delete", function deleteCallback(obj) {
            if (!self2.disableChangesApi) {
              self2.createChange(self2.name, "R", obj);
            }
          });
          this.on("warning", function(warning) {
            self2.lokiConsoleWrapper.warn(warning);
          });
          flushChanges();
        }
        Collection.prototype = new LokiEventEmitter();
        Collection.prototype.contructor = Collection;
        Collection.prototype.createChange = function(name, op, obj, old) {
          this.changes.push({
            name,
            operation: op,
            obj: op == "U" && !this.disableDeltaChangesApi ? this.getChangeDelta(obj, old) : JSON.parse(JSON.stringify(obj))
          });
        };
        Collection.prototype.insertMeta = function(obj) {
          var len, idx;
          if (this.disableMeta || !obj) {
            return;
          }
          if (Array.isArray(obj)) {
            len = obj.length;
            for (idx = 0; idx < len; idx++) {
              if (!obj[idx].hasOwnProperty("meta")) {
                obj[idx].meta = {};
              }
              obj[idx].meta.created = (/* @__PURE__ */ new Date()).getTime();
              obj[idx].meta.revision = 0;
            }
            return;
          }
          if (!obj.meta) {
            obj.meta = {};
          }
          obj.meta.created = (/* @__PURE__ */ new Date()).getTime();
          obj.meta.revision = 0;
        };
        Collection.prototype.updateMeta = function(obj) {
          if (this.disableMeta || !obj) {
            return obj;
          }
          if (!this.disableFreeze) {
            obj = unFreeze(obj);
            obj.meta = unFreeze(obj.meta);
          }
          obj.meta.updated = (/* @__PURE__ */ new Date()).getTime();
          obj.meta.revision += 1;
          return obj;
        };
        Collection.prototype.createInsertChange = function(obj) {
          this.createChange(this.name, "I", obj);
        };
        Collection.prototype.createUpdateChange = function(obj, old) {
          this.createChange(this.name, "U", obj, old);
        };
        Collection.prototype.insertMetaWithChange = function(obj) {
          this.insertMeta(obj);
          this.createInsertChange(obj);
        };
        Collection.prototype.updateMetaWithChange = function(obj, old, objFrozen) {
          obj = this.updateMeta(obj, objFrozen);
          this.createUpdateChange(obj, old);
          return obj;
        };
        Collection.prototype.lokiConsoleWrapper = {
          log: function() {
          },
          warn: function() {
          },
          error: function() {
          }
        };
        Collection.prototype.addAutoUpdateObserver = function(object) {
          if (!this.autoupdate || typeof Object.observe !== "function") return;
          Object.observe(object, this.observerCallback, ["add", "update", "delete", "reconfigure", "setPrototype"]);
        };
        Collection.prototype.removeAutoUpdateObserver = function(object) {
          if (!this.autoupdate || typeof Object.observe !== "function") return;
          Object.unobserve(object, this.observerCallback);
        };
        Collection.prototype.addTransform = function(name, transform) {
          if (this.transforms.hasOwnProperty(name)) {
            throw new Error("a transform by that name already exists");
          }
          this.transforms[name] = transform;
        };
        Collection.prototype.getTransform = function(name) {
          return this.transforms[name];
        };
        Collection.prototype.setTransform = function(name, transform) {
          this.transforms[name] = transform;
        };
        Collection.prototype.removeTransform = function(name) {
          delete this.transforms[name];
        };
        Collection.prototype.byExample = function(template) {
          var k, obj, query;
          query = [];
          for (k in template) {
            if (!template.hasOwnProperty(k)) continue;
            query.push((obj = {}, obj[k] = template[k], obj));
          }
          return {
            "$and": query
          };
        };
        Collection.prototype.findObject = function(template) {
          return this.findOne(this.byExample(template));
        };
        Collection.prototype.findObjects = function(template) {
          return this.find(this.byExample(template));
        };
        Collection.prototype.ttlDaemonFuncGen = function() {
          var collection = this;
          var age = this.ttl.age;
          return function ttlDaemon() {
            var now = Date.now();
            var toRemove = collection.chain().where(function daemonFilter(member) {
              var timestamp = member.meta.updated || member.meta.created;
              var diff = now - timestamp;
              return age < diff;
            });
            toRemove.remove();
          };
        };
        Collection.prototype.setTTL = function(age, interval) {
          if (age < 0) {
            clearInterval(this.ttl.daemon);
          } else {
            this.ttl.age = age;
            this.ttl.ttlInterval = interval;
            this.ttl.daemon = setInterval(this.ttlDaemonFuncGen(), interval);
          }
        };
        Collection.prototype.prepareFullDocIndex = function() {
          var len = this.data.length;
          var indexes = new Array(len);
          for (var i = 0; i < len; i += 1) {
            indexes[i] = i;
          }
          return indexes;
        };
        Collection.prototype.configureOptions = function(options) {
          options = options || {};
          if (options.hasOwnProperty("adaptiveBinaryIndices")) {
            this.adaptiveBinaryIndices = options.adaptiveBinaryIndices;
            if (this.adaptiveBinaryIndices) {
              this.ensureAllIndexes();
            }
          }
        };
        Collection.prototype.ensureIndex = function(property, force) {
          if (typeof force === "undefined") {
            force = false;
          }
          if (property === null || property === void 0) {
            throw new Error("Attempting to set index without an associated property");
          }
          if (this.binaryIndices[property] && !force) {
            if (!this.binaryIndices[property].dirty) return;
          }
          if (this.adaptiveBinaryIndices === true && this.binaryIndices.hasOwnProperty(property) && !force) {
            return;
          }
          var index = {
            "name": property,
            "dirty": true,
            "values": this.prepareFullDocIndex()
          };
          this.binaryIndices[property] = index;
          var wrappedComparer = function(prop, data) {
            var val1, val2;
            var propPath = ~prop.indexOf(".") ? prop.split(".") : false;
            return function(a, b) {
              if (propPath) {
                val1 = Utils.getIn(data[a], propPath, true);
                val2 = Utils.getIn(data[b], propPath, true);
              } else {
                val1 = data[a][prop];
                val2 = data[b][prop];
              }
              if (val1 !== val2) {
                if (Comparators.lt(val1, val2, false)) return -1;
                if (Comparators.gt(val1, val2, false)) return 1;
              }
              return 0;
            };
          }(property, this.data);
          index.values.sort(wrappedComparer);
          index.dirty = false;
          this.dirty = true;
        };
        Collection.prototype.checkAllIndexes = function(options) {
          var key, bIndices = this.binaryIndices;
          var results = [], result;
          for (key in bIndices) {
            if (hasOwnProperty.call(bIndices, key)) {
              result = this.checkIndex(key, options);
              if (!result) {
                results.push(key);
              }
            }
          }
          return results;
        };
        Collection.prototype.checkIndex = function(property, options) {
          options = options || {};
          if (options.randomSamplingFactor && options.randomSampling !== false) {
            options.randomSampling = true;
          }
          options.randomSamplingFactor = options.randomSamplingFactor || 0.1;
          if (options.randomSamplingFactor < 0 || options.randomSamplingFactor > 1) {
            options.randomSamplingFactor = 0.1;
          }
          var valid = true, idx, iter, pos, len, biv;
          if (!this.binaryIndices.hasOwnProperty(property)) {
            throw new Error("called checkIndex on property without an index: " + property);
          }
          if (!this.adaptiveBinaryIndices) {
            this.ensureIndex(property);
          }
          biv = this.binaryIndices[property].values;
          len = biv.length;
          if (len !== this.data.length) {
            if (options.repair) {
              this.ensureIndex(property, true);
            }
            return false;
          }
          if (len === 0) {
            return true;
          }
          var usingDotNotation = property.indexOf(".") !== -1;
          if (len === 1) {
            valid = biv[0] === 0;
          } else {
            if (options.randomSampling) {
              if (!LokiOps.$lte(Utils.getIn(this.data[biv[0]], property, usingDotNotation), Utils.getIn(this.data[biv[1]], property, usingDotNotation))) {
                valid = false;
              }
              if (!LokiOps.$lte(Utils.getIn(this.data[biv[len - 2]], property, usingDotNotation), Utils.getIn(this.data[biv[len - 1]], property, usingDotNotation))) {
                valid = false;
              }
              if (valid) {
                iter = Math.floor((len - 1) * options.randomSamplingFactor);
                for (idx = 0; idx < iter - 1; idx++) {
                  pos = Math.floor(Math.random() * (len - 1));
                  if (!LokiOps.$lte(Utils.getIn(this.data[biv[pos]], property, usingDotNotation), Utils.getIn(this.data[biv[pos + 1]], property, usingDotNotation))) {
                    valid = false;
                    break;
                  }
                }
              }
            } else {
              for (idx = 0; idx < len - 1; idx++) {
                if (!LokiOps.$lte(Utils.getIn(this.data[biv[idx]], property, usingDotNotation), Utils.getIn(this.data[biv[idx + 1]], property, usingDotNotation))) {
                  valid = false;
                  break;
                }
              }
            }
          }
          if (!valid && options.repair) {
            this.ensureIndex(property, true);
          }
          return valid;
        };
        Collection.prototype.getBinaryIndexValues = function(property) {
          var idx, idxvals = this.binaryIndices[property].values;
          var result = [];
          for (idx = 0; idx < idxvals.length; idx++) {
            result.push(Utils.getIn(this.data[idxvals[idx]], property, true));
          }
          return result;
        };
        Collection.prototype.getUniqueIndex = function(field, force) {
          var index = this.constraints.unique[field];
          if (!index && force) {
            return this.ensureUniqueIndex(field);
          }
          return index;
        };
        Collection.prototype.ensureUniqueIndex = function(field) {
          var index = this.constraints.unique[field];
          if (!index) {
            if (this.uniqueNames.indexOf(field) == -1) {
              this.uniqueNames.push(field);
            }
          }
          this.constraints.unique[field] = index = new UniqueIndex(field);
          this.data.forEach(function(obj) {
            index.set(obj);
          });
          return index;
        };
        Collection.prototype.ensureAllIndexes = function(force) {
          var key, bIndices = this.binaryIndices;
          for (key in bIndices) {
            if (hasOwnProperty.call(bIndices, key)) {
              this.ensureIndex(key, force);
            }
          }
        };
        Collection.prototype.flagBinaryIndexesDirty = function() {
          var key, bIndices = this.binaryIndices;
          for (key in bIndices) {
            if (hasOwnProperty.call(bIndices, key)) {
              bIndices[key].dirty = true;
            }
          }
        };
        Collection.prototype.flagBinaryIndexDirty = function(index) {
          if (this.binaryIndices[index]) this.binaryIndices[index].dirty = true;
        };
        Collection.prototype.count = function(query) {
          if (!query) {
            return this.data.length;
          }
          return this.chain().find(query).filteredrows.length;
        };
        Collection.prototype.ensureId = function() {
          if (this.idIndex) {
            return;
          }
          var data = this.data, i = 0;
          var len = data.length;
          var index = new Array(len);
          for (i; i < len; i++) {
            index[i] = data[i].$loki;
          }
          this.idIndex = index;
        };
        Collection.prototype.ensureIdAsync = function(callback) {
          this.async(function() {
            this.ensureId();
          }, callback);
        };
        Collection.prototype.addDynamicView = function(name, options) {
          var dv = new DynamicView(this, name, options);
          this.DynamicViews.push(dv);
          return dv;
        };
        Collection.prototype.removeDynamicView = function(name) {
          this.DynamicViews = this.DynamicViews.filter(function(dv) {
            return dv.name !== name;
          });
        };
        Collection.prototype.getDynamicView = function(name) {
          for (var idx = 0; idx < this.DynamicViews.length; idx++) {
            if (this.DynamicViews[idx].name === name) {
              return this.DynamicViews[idx];
            }
          }
          return null;
        };
        Collection.prototype.findAndUpdate = function(filterObject, updateFunction) {
          if (typeof filterObject === "function") {
            this.updateWhere(filterObject, updateFunction);
          } else {
            this.chain().find(filterObject).update(updateFunction);
          }
        };
        Collection.prototype.findAndRemove = function(filterObject) {
          this.chain().find(filterObject).remove();
        };
        Collection.prototype.insert = function(doc, overrideAdaptiveIndices) {
          if (!Array.isArray(doc)) {
            return this.insertOne(doc);
          }
          var obj;
          var results = [];
          var adaptiveBatchOverride = overrideAdaptiveIndices && !this.cloneObjects && this.adaptiveBinaryIndices && Object.keys(this.binaryIndices).length > 0;
          if (adaptiveBatchOverride) {
            this.adaptiveBinaryIndices = false;
          }
          try {
            this.emit("pre-insert", doc);
            for (var i = 0, len = doc.length; i < len; i++) {
              obj = this.insertOne(doc[i], true);
              if (!obj) {
                return void 0;
              }
              results.push(obj);
            }
          } finally {
            if (adaptiveBatchOverride) {
              this.ensureAllIndexes();
              this.adaptiveBinaryIndices = true;
            }
          }
          this.emit("insert", results);
          results = this.cloneObjects ? clone(results, this.cloneMethod) : results;
          return results.length === 1 ? results[0] : results;
        };
        Collection.prototype.insertOne = function(doc, bulkInsert) {
          var err = null;
          var returnObj;
          if (typeof doc !== "object") {
            err = new TypeError("Document needs to be an object");
          } else if (doc === null) {
            err = new TypeError("Object cannot be null");
          }
          if (err !== null) {
            this.emit("error", err);
            throw err;
          }
          var obj = this.cloneObjects ? clone(doc, this.cloneMethod) : doc;
          if (!this.disableFreeze) {
            obj = unFreeze(obj);
          }
          if (!this.disableMeta) {
            if (typeof obj.meta === "undefined") {
              obj.meta = {
                revision: 0,
                created: 0
              };
            } else if (!this.disableFreeze) {
              obj.meta = unFreeze(obj.meta);
            }
          }
          if (!bulkInsert) {
            this.emit("pre-insert", obj);
          }
          if (!this.add(obj)) {
            return void 0;
          }
          if (this.disableChangesApi) {
            this.insertMeta(obj);
          } else {
            this.insertMetaWithChange(obj);
          }
          if (!this.disableFreeze) {
            deepFreeze(obj);
          }
          returnObj = this.cloneObjects ? clone(obj, this.cloneMethod) : obj;
          if (!bulkInsert) {
            this.emit("insert", returnObj);
          }
          this.addAutoUpdateObserver(returnObj);
          return returnObj;
        };
        Collection.prototype.clear = function(options) {
          var self2 = this;
          options = options || {};
          this.data = [];
          this.idIndex = null;
          this.cachedIndex = null;
          this.cachedBinaryIndex = null;
          this.cachedData = null;
          this.maxId = 0;
          this.DynamicViews = [];
          this.dirty = true;
          this.constraints = {
            unique: {},
            exact: {}
          };
          if (options.removeIndices === true) {
            this.binaryIndices = {};
            this.uniqueNames = [];
          } else {
            var keys2 = Object.keys(this.binaryIndices);
            keys2.forEach(function(biname) {
              self2.binaryIndices[biname].dirty = false;
              self2.binaryIndices[biname].values = [];
            });
          }
        };
        Collection.prototype.update = function(doc) {
          var adaptiveBatchOverride, k, len;
          if (Array.isArray(doc)) {
            len = doc.length;
            adaptiveBatchOverride = !this.cloneObjects && this.adaptiveBinaryIndices && Object.keys(this.binaryIndices).length > 0;
            if (adaptiveBatchOverride) {
              this.adaptiveBinaryIndices = false;
            }
            try {
              for (k = 0; k < len; k += 1) {
                this.update(doc[k]);
              }
            } finally {
              if (adaptiveBatchOverride) {
                this.ensureAllIndexes();
                this.adaptiveBinaryIndices = true;
              }
            }
            return;
          }
          if (!hasOwnProperty.call(doc, "$loki")) {
            throw new Error("Trying to update unsynced document. Please save the document first by using insert() or addMany()");
          }
          try {
            this.startTransaction();
            var arr = this.get(doc.$loki, true), oldInternal, newInternal, position, self2 = this;
            if (!arr) {
              throw new Error("Trying to update a document not in collection.");
            }
            oldInternal = arr[0];
            position = arr[1];
            newInternal = this.cloneObjects || !this.disableDeltaChangesApi && this.disableFreeze ? clone(doc, this.cloneMethod) : doc;
            this.emit("pre-update", doc);
            this.uniqueNames.forEach(function(key2) {
              self2.getUniqueIndex(key2, true).update(oldInternal, newInternal);
            });
            this.data[position] = newInternal;
            if (newInternal !== doc) {
              this.addAutoUpdateObserver(doc);
            }
            for (var idx = 0; idx < this.DynamicViews.length; idx++) {
              this.DynamicViews[idx].evaluateDocument(position, false);
            }
            var key;
            if (this.adaptiveBinaryIndices) {
              var bIndices = this.binaryIndices;
              for (key in bIndices) {
                this.adaptiveBinaryIndexUpdate(position, key);
              }
            } else {
              this.flagBinaryIndexesDirty();
            }
            this.idIndex[position] = newInternal.$loki;
            if (this.isIncremental) {
              this.dirtyIds.push(newInternal.$loki);
            }
            this.commit();
            this.dirty = true;
            if (this.disableChangesApi) {
              newInternal = this.updateMeta(newInternal);
            } else {
              newInternal = this.updateMetaWithChange(newInternal, oldInternal);
            }
            if (!this.disableFreeze) {
              deepFreeze(newInternal);
            }
            var returnObj;
            if (this.cloneObjects) {
              returnObj = clone(newInternal, this.cloneMethod);
            } else {
              returnObj = newInternal;
            }
            this.emit("update", returnObj, oldInternal);
            return returnObj;
          } catch (err) {
            this.rollback();
            this.lokiConsoleWrapper.error(err.message);
            this.emit("error", err);
            throw err;
          }
        };
        Collection.prototype.add = function(obj) {
          if ("object" !== typeof obj) {
            throw new TypeError("Object being added needs to be an object");
          }
          if (typeof obj.$loki !== "undefined") {
            throw new Error("Document is already in collection, please use update()");
          }
          try {
            this.startTransaction();
            this.maxId++;
            if (isNaN(this.maxId)) {
              this.maxId = this.data[this.data.length - 1].$loki + 1;
            }
            var newId = this.maxId;
            obj.$loki = newId;
            if (!this.disableMeta) {
              obj.meta.version = 0;
            }
            for (var i = 0, len = this.uniqueNames.length; i < len; i++) {
              this.getUniqueIndex(this.uniqueNames[i], true).set(obj);
            }
            if (this.idIndex) {
              this.idIndex.push(newId);
            }
            if (this.isIncremental) {
              this.dirtyIds.push(newId);
            }
            this.data.push(obj);
            var addedPos = this.data.length - 1;
            var dvlen = this.DynamicViews.length;
            for (i = 0; i < dvlen; i++) {
              this.DynamicViews[i].evaluateDocument(addedPos, true);
            }
            if (this.adaptiveBinaryIndices) {
              var bIndices = this.binaryIndices;
              for (var key in bIndices) {
                this.adaptiveBinaryIndexInsert(addedPos, key);
              }
            } else {
              this.flagBinaryIndexesDirty();
            }
            this.commit();
            this.dirty = true;
            return this.cloneObjects ? clone(obj, this.cloneMethod) : obj;
          } catch (err) {
            this.rollback();
            this.lokiConsoleWrapper.error(err.message);
            this.emit("error", err);
            throw err;
          }
        };
        Collection.prototype.updateWhere = function(filterFunction, updateFunction) {
          var results = this.where(filterFunction), i = 0, obj;
          try {
            for (i; i < results.length; i++) {
              obj = updateFunction(results[i]);
              this.update(obj);
            }
          } catch (err) {
            this.rollback();
            this.lokiConsoleWrapper.error(err.message);
          }
        };
        Collection.prototype.removeWhere = function(query) {
          var list;
          if (typeof query === "function") {
            list = this.data.filter(query);
            this.remove(list);
          } else {
            this.chain().find(query).remove();
          }
        };
        Collection.prototype.removeDataOnly = function() {
          this.remove(this.data.slice());
        };
        Collection.prototype.removeBatchByPositions = function(positions) {
          var len = positions.length;
          var xo = {};
          var dlen, didx, idx;
          var bic = Object.keys(this.binaryIndices).length;
          var uic = Object.keys(this.constraints.unique).length;
          var adaptiveOverride = this.adaptiveBinaryIndices && Object.keys(this.binaryIndices).length > 0;
          var doc, self2 = this;
          try {
            this.startTransaction();
            this.ensureId();
            for (idx = 0; idx < len; idx++) {
              xo[this.idIndex[positions[idx]]] = true;
            }
            dlen = this.DynamicViews.length;
            if (dlen > 0 || bic > 0 || uic > 0) {
              if (dlen > 0) {
                for (didx = 0; didx < dlen; didx++) {
                  this.DynamicViews[didx].removeDocument(positions);
                }
              }
              if (this.adaptiveBinaryIndices && !adaptiveOverride) {
                var key, bIndices = this.binaryIndices;
                for (key in bIndices) {
                  this.adaptiveBinaryIndexRemove(positions, key);
                }
              } else {
                this.flagBinaryIndexesDirty();
              }
              if (uic) {
                this.uniqueNames.forEach(function(key2) {
                  var index = self2.getUniqueIndex(key2);
                  if (index) {
                    for (idx = 0; idx < len; idx++) {
                      doc = self2.data[positions[idx]];
                      if (doc[key2] !== null && doc[key2] !== void 0) {
                        index.remove(doc[key2]);
                      }
                    }
                  }
                });
              }
            }
            if (!this.disableChangesApi || this.events.delete.length > 1) {
              for (idx = 0; idx < len; idx++) {
                this.emit("delete", this.data[positions[idx]]);
              }
            }
            this.data = this.data.filter(function(obj) {
              return !xo[obj.$loki];
            });
            if (this.isIncremental) {
              for (idx = 0; idx < len; idx++) {
                this.dirtyIds.push(this.idIndex[positions[idx]]);
              }
            }
            this.idIndex = this.idIndex.filter(function(id) {
              return !xo[id];
            });
            if (this.adaptiveBinaryIndices && adaptiveOverride) {
              this.adaptiveBinaryIndices = false;
              this.ensureAllIndexes(true);
              this.adaptiveBinaryIndices = true;
            }
            this.commit();
            this.dirty = true;
          } catch (err) {
            this.rollback();
            if (adaptiveOverride) {
              this.adaptiveBinaryIndices = true;
            }
            this.lokiConsoleWrapper.error(err.message);
            this.emit("error", err);
            return null;
          }
        };
        Collection.prototype.removeBatch = function(batch) {
          var len = batch.length, dlen = this.data.length, idx;
          var xlt = {};
          var posx = [];
          for (idx = 0; idx < dlen; idx++) {
            xlt[this.data[idx].$loki] = idx;
          }
          for (idx = 0; idx < len; idx++) {
            if (typeof batch[idx] === "object") {
              posx.push(xlt[batch[idx].$loki]);
            } else {
              posx.push(xlt[batch[idx]]);
            }
          }
          this.removeBatchByPositions(posx);
        };
        Collection.prototype.remove = function(doc) {
          var frozen;
          if (typeof doc === "number") {
            doc = this.get(doc);
          }
          if ("object" !== typeof doc) {
            throw new Error("Parameter is not an object");
          }
          if (Array.isArray(doc)) {
            this.removeBatch(doc);
            return;
          }
          if (!hasOwnProperty.call(doc, "$loki")) {
            throw new Error("Object is not a document stored in the collection");
          }
          try {
            this.startTransaction();
            var arr = this.get(doc.$loki, true), position = arr[1];
            var self2 = this;
            this.uniqueNames.forEach(function(key2) {
              if (doc[key2] !== null && typeof doc[key2] !== "undefined") {
                var index = self2.getUniqueIndex(key2);
                if (index) {
                  index.remove(doc[key2]);
                }
              }
            });
            for (var idx = 0; idx < this.DynamicViews.length; idx++) {
              this.DynamicViews[idx].removeDocument(position);
            }
            if (this.adaptiveBinaryIndices) {
              var key, bIndices = this.binaryIndices;
              for (key in bIndices) {
                this.adaptiveBinaryIndexRemove(position, key);
              }
            } else {
              this.flagBinaryIndexesDirty();
            }
            this.data.splice(position, 1);
            this.removeAutoUpdateObserver(doc);
            this.idIndex.splice(position, 1);
            if (this.isIncremental) {
              this.dirtyIds.push(doc.$loki);
            }
            this.commit();
            this.dirty = true;
            this.emit("delete", arr[0]);
            if (!this.disableFreeze) {
              doc = unFreeze(doc);
            }
            delete doc.$loki;
            delete doc.meta;
            if (!this.disableFreeze) {
              freeze(doc);
            }
            return doc;
          } catch (err) {
            this.rollback();
            this.lokiConsoleWrapper.error(err.message);
            this.emit("error", err);
            return null;
          }
        };
        Collection.prototype.get = function(id, returnPosition) {
          if (!this.idIndex) {
            this.ensureId();
          }
          var retpos = returnPosition || false, data = this.idIndex, max = data.length - 1, min = 0, mid = min + max >> 1;
          id = typeof id === "number" ? id : parseInt(id, 10);
          if (isNaN(id)) {
            throw new TypeError("Passed id is not an integer");
          }
          while (data[min] < data[max]) {
            mid = min + max >> 1;
            if (data[mid] < id) {
              min = mid + 1;
            } else {
              max = mid;
            }
          }
          if (max === min && data[min] === id) {
            if (retpos) {
              return [this.data[min], min];
            }
            return this.data[min];
          }
          return null;
        };
        Collection.prototype.getBinaryIndexPosition = function(dataPosition, binaryIndexName) {
          var val = Utils.getIn(this.data[dataPosition], binaryIndexName, true);
          var index = this.binaryIndices[binaryIndexName].values;
          var range = this.calculateRange("$eq", binaryIndexName, val);
          if (range[0] === 0 && range[1] === -1) {
            return null;
          }
          var min = range[0];
          var max = range[1];
          for (var idx = min; idx <= max; idx++) {
            if (index[idx] === dataPosition) return idx;
          }
          return null;
        };
        Collection.prototype.adaptiveBinaryIndexInsert = function(dataPosition, binaryIndexName) {
          var usingDotNotation = binaryIndexName.indexOf(".") !== -1;
          var index = this.binaryIndices[binaryIndexName].values;
          var val = Utils.getIn(this.data[dataPosition], binaryIndexName, usingDotNotation);
          if (this.serializableIndices === true && val instanceof Date) {
            this.data[dataPosition][binaryIndexName] = val.getTime();
            val = Utils.getIn(this.data[dataPosition], binaryIndexName);
          }
          var idxPos = index.length === 0 ? 0 : this.calculateRangeStart(binaryIndexName, val, true, usingDotNotation);
          this.binaryIndices[binaryIndexName].values.splice(idxPos, 0, dataPosition);
        };
        Collection.prototype.adaptiveBinaryIndexUpdate = function(dataPosition, binaryIndexName) {
          var idxPos, index = this.binaryIndices[binaryIndexName].values, len = index.length;
          for (idxPos = 0; idxPos < len; idxPos++) {
            if (index[idxPos] === dataPosition) break;
          }
          this.binaryIndices[binaryIndexName].values.splice(idxPos, 1);
          this.adaptiveBinaryIndexInsert(dataPosition, binaryIndexName);
        };
        Collection.prototype.adaptiveBinaryIndexRemove = function(dataPosition, binaryIndexName, removedFromIndexOnly) {
          var bi = this.binaryIndices[binaryIndexName];
          var len, idx, rmidx, rmlen, rxo = {};
          var curr, shift, idxPos;
          if (Array.isArray(dataPosition)) {
            rmlen = dataPosition.length;
            if (rmlen === 1) {
              dataPosition = dataPosition[0];
            } else {
              for (rmidx = 0; rmidx < rmlen; rmidx++) {
                rxo[dataPosition[rmidx]] = true;
              }
              bi.values = bi.values.filter(function(di) {
                return !rxo[di];
              });
              if (removedFromIndexOnly === true) {
                return;
              }
              var sortedPositions = dataPosition.slice();
              sortedPositions.sort(function(a, b) {
                return a - b;
              });
              len = bi.values.length;
              for (idx = 0; idx < len; idx++) {
                curr = bi.values[idx];
                shift = 0;
                for (rmidx = 0; rmidx < rmlen && curr > sortedPositions[rmidx]; rmidx++) {
                  shift++;
                }
                bi.values[idx] -= shift;
              }
              return;
            }
          }
          idxPos = this.getBinaryIndexPosition(dataPosition, binaryIndexName);
          if (idxPos === null) {
            return null;
          }
          bi.values.splice(idxPos, 1);
          if (removedFromIndexOnly === true) {
            return;
          }
          len = bi.values.length;
          for (idx = 0; idx < len; idx++) {
            if (bi.values[idx] > dataPosition) {
              bi.values[idx]--;
            }
          }
        };
        Collection.prototype.calculateRangeStart = function(prop, val, adaptive, usingDotNotation) {
          var rcd = this.data;
          var index = this.binaryIndices[prop].values;
          var min = 0;
          var max = index.length - 1;
          var mid = 0;
          if (index.length === 0) {
            return -1;
          }
          var minVal = Utils.getIn(rcd[index[min]], prop, usingDotNotation);
          var maxVal = Utils.getIn(rcd[index[max]], prop, usingDotNotation);
          while (min < max) {
            mid = min + max >> 1;
            if (Comparators.lt(Utils.getIn(rcd[index[mid]], prop, usingDotNotation), val, false)) {
              min = mid + 1;
            } else {
              max = mid;
            }
          }
          var lbound = min;
          if (Comparators.aeq(val, Utils.getIn(rcd[index[lbound]], prop, usingDotNotation))) {
            return lbound;
          }
          if (Comparators.lt(val, Utils.getIn(rcd[index[lbound]], prop, usingDotNotation), false)) {
            return adaptive ? lbound : lbound - 1;
          }
          return adaptive ? lbound + 1 : lbound;
        };
        Collection.prototype.calculateRangeEnd = function(prop, val, usingDotNotation) {
          var rcd = this.data;
          var index = this.binaryIndices[prop].values;
          var min = 0;
          var max = index.length - 1;
          var mid = 0;
          if (index.length === 0) {
            return -1;
          }
          var minVal = Utils.getIn(rcd[index[min]], prop, usingDotNotation);
          var maxVal = Utils.getIn(rcd[index[max]], prop, usingDotNotation);
          while (min < max) {
            mid = min + max >> 1;
            if (Comparators.lt(val, Utils.getIn(rcd[index[mid]], prop, usingDotNotation), false)) {
              max = mid;
            } else {
              min = mid + 1;
            }
          }
          var ubound = max;
          if (Comparators.aeq(val, Utils.getIn(rcd[index[ubound]], prop, usingDotNotation))) {
            return ubound;
          }
          if (Comparators.gt(val, Utils.getIn(rcd[index[ubound]], prop, usingDotNotation), false)) {
            return ubound + 1;
          }
          if (Comparators.aeq(val, Utils.getIn(rcd[index[ubound - 1]], prop, usingDotNotation))) {
            return ubound - 1;
          }
          return ubound;
        };
        Collection.prototype.calculateRange = function(op, prop, val) {
          var rcd = this.data;
          var index = this.binaryIndices[prop].values;
          var min = 0;
          var max = index.length - 1;
          var mid = 0;
          var lbound, lval;
          var ubound, uval;
          if (rcd.length === 0) {
            return [0, -1];
          }
          var usingDotNotation = prop.indexOf(".") !== -1;
          var minVal = Utils.getIn(rcd[index[min]], prop, usingDotNotation);
          var maxVal = Utils.getIn(rcd[index[max]], prop, usingDotNotation);
          switch (op) {
            case "$eq":
            case "$aeq":
              if (Comparators.lt(val, minVal, false) || Comparators.gt(val, maxVal, false)) {
                return [0, -1];
              }
              break;
            case "$dteq":
              if (Comparators.lt(val, minVal, false) || Comparators.gt(val, maxVal, false)) {
                return [0, -1];
              }
              break;
            case "$gt":
              if (Comparators.gt(val, maxVal, true)) {
                return [0, -1];
              }
              if (Comparators.gt(minVal, val, false)) {
                return [min, max];
              }
              break;
            case "$gte":
              if (Comparators.gt(val, maxVal, false)) {
                return [0, -1];
              }
              if (Comparators.gt(minVal, val, true)) {
                return [min, max];
              }
              break;
            case "$lt":
              if (Comparators.lt(val, minVal, true)) {
                return [0, -1];
              }
              if (Comparators.lt(maxVal, val, false)) {
                return [min, max];
              }
              break;
            case "$lte":
              if (Comparators.lt(val, minVal, false)) {
                return [0, -1];
              }
              if (Comparators.lt(maxVal, val, true)) {
                return [min, max];
              }
              break;
            case "$between":
              if (Comparators.gt(val[0], maxVal, false)) {
                return [0, -1];
              }
              if (Comparators.lt(val[1], minVal, false)) {
                return [0, -1];
              }
              lbound = this.calculateRangeStart(prop, val[0], false, usingDotNotation);
              ubound = this.calculateRangeEnd(prop, val[1], usingDotNotation);
              if (lbound < 0) lbound++;
              if (ubound > max) ubound--;
              if (!Comparators.gt(Utils.getIn(rcd[index[lbound]], prop, usingDotNotation), val[0], true)) lbound++;
              if (!Comparators.lt(Utils.getIn(rcd[index[ubound]], prop, usingDotNotation), val[1], true)) ubound--;
              if (ubound < lbound) return [0, -1];
              return [lbound, ubound];
            case "$in":
              var idxset = [], segResult = [];
              for (var j = 0, len = val.length; j < len; j++) {
                var seg = this.calculateRange("$eq", prop, val[j]);
                for (var i = seg[0]; i <= seg[1]; i++) {
                  if (idxset[i] === void 0) {
                    idxset[i] = true;
                    segResult.push(i);
                  }
                }
              }
              return segResult;
          }
          switch (op) {
            case "$eq":
            case "$aeq":
            case "$dteq":
            case "$gte":
            case "$lt":
              lbound = this.calculateRangeStart(prop, val, false, usingDotNotation);
              lval = Utils.getIn(rcd[index[lbound]], prop, usingDotNotation);
              break;
            default:
              break;
          }
          switch (op) {
            case "$eq":
            case "$aeq":
            case "$dteq":
            case "$lte":
            case "$gt":
              ubound = this.calculateRangeEnd(prop, val, usingDotNotation);
              uval = Utils.getIn(rcd[index[ubound]], prop, usingDotNotation);
              break;
            default:
              break;
          }
          switch (op) {
            case "$eq":
            case "$aeq":
            case "$dteq":
              if (!Comparators.aeq(lval, val)) {
                return [0, -1];
              }
              return [lbound, ubound];
            case "$gt":
              if (!Comparators.aeq(Utils.getIn(rcd[index[ubound]], prop, usingDotNotation), val)) {
                return [ubound, max];
              }
              return [ubound + 1, max];
            case "$gte":
              if (!Comparators.aeq(Utils.getIn(rcd[index[lbound]], prop, usingDotNotation), val)) {
                return [lbound + 1, max];
              }
              return [lbound, max];
            case "$lt":
              if (!Comparators.aeq(Utils.getIn(rcd[index[lbound]], prop, usingDotNotation), val)) {
                return [min, lbound];
              }
              return [min, lbound - 1];
            case "$lte":
              if (!Comparators.aeq(Utils.getIn(rcd[index[ubound]], prop, usingDotNotation), val)) {
                return [min, ubound - 1];
              }
              return [min, ubound];
            default:
              return [0, rcd.length - 1];
          }
        };
        Collection.prototype.by = function(field, value) {
          var self2;
          if (value === void 0) {
            self2 = this;
            return function(value2) {
              return self2.by(field, value2);
            };
          }
          var result = this.getUniqueIndex(field, true).get(value);
          if (!this.cloneObjects) {
            return result;
          } else {
            return clone(result, this.cloneMethod);
          }
        };
        Collection.prototype.findOne = function(query) {
          query = query || {};
          var result = this.chain().find(query, true).data();
          if (Array.isArray(result) && result.length === 0) {
            return null;
          } else {
            if (!this.cloneObjects) {
              return result[0];
            } else {
              return clone(result[0], this.cloneMethod);
            }
          }
        };
        Collection.prototype.chain = function(transform, parameters) {
          var rs = new Resultset(this);
          if (typeof transform === "undefined") {
            return rs;
          }
          return rs.transform(transform, parameters);
        };
        Collection.prototype.find = function(query) {
          return this.chain().find(query).data();
        };
        Collection.prototype.findOneUnindexed = function(prop, value) {
          var i = this.data.length, doc;
          while (i--) {
            if (Utils.getIn(this.data[i], prop, true) === value) {
              doc = this.data[i];
              return doc;
            }
          }
          return null;
        };
        Collection.prototype.startTransaction = function() {
          if (this.transactional) {
            this.cachedData = clone(this.data, this.cloneMethod);
            this.cachedIndex = this.idIndex;
            this.cachedBinaryIndex = this.binaryIndices;
            this.cachedDirtyIds = this.dirtyIds;
            for (var idx = 0; idx < this.DynamicViews.length; idx++) {
              this.DynamicViews[idx].startTransaction();
            }
          }
        };
        Collection.prototype.commit = function() {
          if (this.transactional) {
            this.cachedData = null;
            this.cachedIndex = null;
            this.cachedBinaryIndex = null;
            this.cachedDirtyIds = null;
            for (var idx = 0; idx < this.DynamicViews.length; idx++) {
              this.DynamicViews[idx].commit();
            }
          }
        };
        Collection.prototype.rollback = function() {
          if (this.transactional) {
            if (this.cachedData !== null && this.cachedIndex !== null) {
              this.data = this.cachedData;
              this.idIndex = this.cachedIndex;
              this.binaryIndices = this.cachedBinaryIndex;
              this.dirtyIds = this.cachedDirtyIds;
            }
            for (var idx = 0; idx < this.DynamicViews.length; idx++) {
              this.DynamicViews[idx].rollback();
            }
          }
        };
        Collection.prototype.async = function(fun, callback) {
          setTimeout(function() {
            if (typeof fun === "function") {
              fun();
              callback();
            } else {
              throw new TypeError("Argument passed for async execution is not a function");
            }
          }, 0);
        };
        Collection.prototype.where = function(fun) {
          return this.chain().where(fun).data();
        };
        Collection.prototype.mapReduce = function(mapFunction, reduceFunction) {
          try {
            return reduceFunction(this.data.map(mapFunction));
          } catch (err) {
            throw err;
          }
        };
        Collection.prototype.eqJoin = function(joinData, leftJoinProp, rightJoinProp, mapFun, dataOptions) {
          return new Resultset(this).eqJoin(joinData, leftJoinProp, rightJoinProp, mapFun, dataOptions);
        };
        Collection.prototype.stages = {};
        Collection.prototype.getStage = function(name) {
          if (!this.stages[name]) {
            this.stages[name] = {};
          }
          return this.stages[name];
        };
        Collection.prototype.commitLog = [];
        Collection.prototype.stage = function(stageName, obj) {
          var copy = JSON.parse(JSON.stringify(obj));
          this.getStage(stageName)[obj.$loki] = copy;
          return copy;
        };
        Collection.prototype.commitStage = function(stageName, message) {
          var stage = this.getStage(stageName), prop, timestamp = (/* @__PURE__ */ new Date()).getTime();
          for (prop in stage) {
            this.update(stage[prop]);
            this.commitLog.push({
              timestamp,
              message,
              data: JSON.parse(JSON.stringify(stage[prop]))
            });
          }
          this.stages[stageName] = {};
        };
        Collection.prototype.no_op = function() {
          return;
        };
        Collection.prototype.extract = function(field) {
          var i = 0, len = this.data.length, isDotNotation = isDeepProperty(field), result = [];
          for (i; i < len; i += 1) {
            result.push(deepProperty(this.data[i], field, isDotNotation));
          }
          return result;
        };
        Collection.prototype.max = function(field) {
          return Math.max.apply(null, this.extract(field));
        };
        Collection.prototype.min = function(field) {
          return Math.min.apply(null, this.extract(field));
        };
        Collection.prototype.maxRecord = function(field) {
          var i = 0, len = this.data.length, deep = isDeepProperty(field), result = {
            index: 0,
            value: void 0
          }, max;
          for (i; i < len; i += 1) {
            if (max !== void 0) {
              if (max < deepProperty(this.data[i], field, deep)) {
                max = deepProperty(this.data[i], field, deep);
                result.index = this.data[i].$loki;
              }
            } else {
              max = deepProperty(this.data[i], field, deep);
              result.index = this.data[i].$loki;
            }
          }
          result.value = max;
          return result;
        };
        Collection.prototype.minRecord = function(field) {
          var i = 0, len = this.data.length, deep = isDeepProperty(field), result = {
            index: 0,
            value: void 0
          }, min;
          for (i; i < len; i += 1) {
            if (min !== void 0) {
              if (min > deepProperty(this.data[i], field, deep)) {
                min = deepProperty(this.data[i], field, deep);
                result.index = this.data[i].$loki;
              }
            } else {
              min = deepProperty(this.data[i], field, deep);
              result.index = this.data[i].$loki;
            }
          }
          result.value = min;
          return result;
        };
        Collection.prototype.extractNumerical = function(field) {
          return this.extract(field).map(parseBase10).filter(Number).filter(function(n) {
            return !isNaN(n);
          });
        };
        Collection.prototype.avg = function(field) {
          return average(this.extractNumerical(field));
        };
        Collection.prototype.stdDev = function(field) {
          return standardDeviation(this.extractNumerical(field));
        };
        Collection.prototype.mode = function(field) {
          var dict = {}, data = this.extract(field);
          data.forEach(function(obj) {
            if (dict[obj]) {
              dict[obj] += 1;
            } else {
              dict[obj] = 1;
            }
          });
          var max, prop, mode;
          for (prop in dict) {
            if (max) {
              if (max < dict[prop]) {
                mode = prop;
              }
            } else {
              mode = prop;
              max = dict[prop];
            }
          }
          return mode;
        };
        Collection.prototype.median = function(field) {
          var values = this.extractNumerical(field);
          values.sort(sub);
          var half = Math.floor(values.length / 2);
          if (values.length % 2) {
            return values[half];
          } else {
            return (values[half - 1] + values[half]) / 2;
          }
        };
        function isDeepProperty(field) {
          return field.indexOf(".") !== -1;
        }
        function parseBase10(num) {
          return parseFloat(num, 10);
        }
        function isNotUndefined(obj) {
          return obj !== void 0;
        }
        function add(a, b) {
          return a + b;
        }
        function sub(a, b) {
          return a - b;
        }
        function median(values) {
          values.sort(sub);
          var half = Math.floor(values.length / 2);
          return values.length % 2 ? values[half] : (values[half - 1] + values[half]) / 2;
        }
        function average(array) {
          return array.reduce(add, 0) / array.length;
        }
        function standardDeviation(values) {
          var avg = average(values);
          var squareDiffs = values.map(function(value) {
            var diff = value - avg;
            var sqrDiff = diff * diff;
            return sqrDiff;
          });
          var avgSquareDiff = average(squareDiffs);
          var stdDev = Math.sqrt(avgSquareDiff);
          return stdDev;
        }
        function deepProperty(obj, property, isDeep) {
          if (isDeep === false) {
            return obj[property];
          }
          var pieces = property.split("."), root = obj;
          while (pieces.length > 0) {
            root = root[pieces.shift()];
          }
          return root;
        }
        function binarySearch(array, item, fun) {
          var lo = 0, hi = array.length, compared, mid;
          while (lo < hi) {
            mid = lo + hi >> 1;
            compared = fun.apply(null, [item, array[mid]]);
            if (compared === 0) {
              return {
                found: true,
                index: mid
              };
            } else if (compared < 0) {
              hi = mid;
            } else {
              lo = mid + 1;
            }
          }
          return {
            found: false,
            index: hi
          };
        }
        function BSonSort(fun) {
          return function(array, item) {
            return binarySearch(array, item, fun);
          };
        }
        function KeyValueStore() {
        }
        KeyValueStore.prototype = {
          keys: [],
          values: [],
          sort: function(a, b) {
            return a < b ? -1 : a > b ? 1 : 0;
          },
          setSort: function(fun) {
            this.bs = new BSonSort(fun);
          },
          bs: function() {
            return new BSonSort(this.sort);
          },
          set: function(key, value) {
            var pos = this.bs(this.keys, key);
            if (pos.found) {
              this.values[pos.index] = value;
            } else {
              this.keys.splice(pos.index, 0, key);
              this.values.splice(pos.index, 0, value);
            }
          },
          get: function(key) {
            return this.values[binarySearch(this.keys, key, this.sort).index];
          }
        };
        function UniqueIndex(uniqueField) {
          this.field = uniqueField;
          this.keyMap = /* @__PURE__ */ Object.create(null);
          this.lokiMap = /* @__PURE__ */ Object.create(null);
        }
        UniqueIndex.prototype.keyMap = {};
        UniqueIndex.prototype.lokiMap = {};
        UniqueIndex.prototype.set = function(obj) {
          var fieldValue = obj[this.field];
          if (fieldValue !== null && typeof fieldValue !== "undefined") {
            if (this.keyMap[fieldValue]) {
              throw new Error("Duplicate key for property " + this.field + ": " + fieldValue);
            } else {
              this.keyMap[fieldValue] = obj;
              this.lokiMap[obj.$loki] = fieldValue;
            }
          }
        };
        UniqueIndex.prototype.get = function(key) {
          return this.keyMap[key];
        };
        UniqueIndex.prototype.byId = function(id) {
          return this.keyMap[this.lokiMap[id]];
        };
        UniqueIndex.prototype.update = function(obj, doc) {
          if (this.lokiMap[obj.$loki] !== doc[this.field]) {
            var old = this.lokiMap[obj.$loki];
            this.set(doc);
            this.keyMap[old] = void 0;
          } else {
            this.keyMap[obj[this.field]] = doc;
          }
        };
        UniqueIndex.prototype.remove = function(key) {
          var obj = this.keyMap[key];
          if (obj !== null && typeof obj !== "undefined") {
            this.keyMap[key] = void 0;
            this.lokiMap[obj.$loki] = void 0;
          } else {
            throw new Error("Key is not in unique index: " + this.field);
          }
        };
        UniqueIndex.prototype.clear = function() {
          this.keyMap = /* @__PURE__ */ Object.create(null);
          this.lokiMap = /* @__PURE__ */ Object.create(null);
        };
        function ExactIndex(exactField) {
          this.index = /* @__PURE__ */ Object.create(null);
          this.field = exactField;
        }
        ExactIndex.prototype = {
          set: function add2(key, val) {
            if (this.index[key]) {
              this.index[key].push(val);
            } else {
              this.index[key] = [val];
            }
          },
          // remove the value from the index, if the value was the last one, remove the key
          remove: function remove(key, val) {
            var idxSet = this.index[key];
            for (var i in idxSet) {
              if (idxSet[i] == val) {
                idxSet.splice(i, 1);
              }
            }
            if (idxSet.length < 1) {
              this.index[key] = void 0;
            }
          },
          // get the values related to the key, could be more than one
          get: function get(key) {
            return this.index[key];
          },
          // clear will zap the index
          clear: function clear2(key) {
            this.index = {};
          }
        };
        function SortedIndex(sortedField) {
          this.field = sortedField;
        }
        SortedIndex.prototype = {
          keys: [],
          values: [],
          // set the default sort
          sort: function(a, b) {
            return a < b ? -1 : a > b ? 1 : 0;
          },
          bs: function() {
            return new BSonSort(this.sort);
          },
          // and allow override of the default sort
          setSort: function(fun) {
            this.bs = new BSonSort(fun);
          },
          // add the value you want returned  to the key in the index
          set: function(key, value) {
            var pos = binarySearch(this.keys, key, this.sort);
            if (pos.found) {
              this.values[pos.index].push(value);
            } else {
              this.keys.splice(pos.index, 0, key);
              this.values.splice(pos.index, 0, [value]);
            }
          },
          // get all values which have a key == the given key
          get: function(key) {
            var bsr = binarySearch(this.keys, key, this.sort);
            if (bsr.found) {
              return this.values[bsr.index];
            } else {
              return [];
            }
          },
          // get all values which have a key < the given key
          getLt: function(key) {
            var bsr = binarySearch(this.keys, key, this.sort);
            var pos = bsr.index;
            if (bsr.found) pos--;
            return this.getAll(key, 0, pos);
          },
          // get all values which have a key > the given key
          getGt: function(key) {
            var bsr = binarySearch(this.keys, key, this.sort);
            var pos = bsr.index;
            if (bsr.found) pos++;
            return this.getAll(key, pos, this.keys.length);
          },
          // get all vals from start to end
          getAll: function(key, start, end) {
            var results = [];
            for (var i = start; i < end; i++) {
              results = results.concat(this.values[i]);
            }
            return results;
          },
          // just in case someone wants to do something smart with ranges
          getPos: function(key) {
            return binarySearch(this.keys, key, this.sort);
          },
          // remove the value from the index, if the value was the last one, remove the key
          remove: function(key, value) {
            var pos = binarySearch(this.keys, key, this.sort).index;
            var idxSet = this.values[pos];
            for (var i in idxSet) {
              if (idxSet[i] == value) idxSet.splice(i, 1);
            }
            if (idxSet.length < 1) {
              this.keys.splice(pos, 1);
              this.values.splice(pos, 1);
            }
          },
          // clear will zap the index
          clear: function() {
            this.keys = [];
            this.values = [];
          }
        };
        Loki2.deepFreeze = deepFreeze;
        Loki2.freeze = freeze;
        Loki2.unFreeze = unFreeze;
        Loki2.LokiOps = LokiOps;
        Loki2.Collection = Collection;
        Loki2.DynamicView = DynamicView;
        Loki2.Resultset = Resultset;
        Loki2.KeyValueStore = KeyValueStore;
        Loki2.LokiMemoryAdapter = LokiMemoryAdapter;
        Loki2.LokiPartitioningAdapter = LokiPartitioningAdapter;
        Loki2.LokiLocalStorageAdapter = LokiLocalStorageAdapter;
        Loki2.LokiFsAdapter = LokiFsAdapter;
        Loki2.persistenceAdapters = {
          fs: LokiFsAdapter,
          localStorage: LokiLocalStorageAdapter
        };
        Loki2.aeq = aeqHelper;
        Loki2.lt = ltHelper;
        Loki2.gt = gtHelper;
        Loki2.Comparators = Comparators;
        return Loki2;
      }();
    });
  }
});

// node_modules/moment/moment.js
var require_moment = __commonJS({
  "node_modules/moment/moment.js"(exports, module) {
    "use strict";
    (function(global2, factory) {
      typeof exports === "object" && typeof module !== "undefined" ? module.exports = factory() : typeof define === "function" && define.amd ? define(factory) : global2.moment = factory();
    })(exports, function() {
      "use strict";
      var hookCallback;
      function hooks() {
        return hookCallback.apply(null, arguments);
      }
      function setHookCallback(callback) {
        hookCallback = callback;
      }
      function isArray(input) {
        return input instanceof Array || Object.prototype.toString.call(input) === "[object Array]";
      }
      function isObject(input) {
        return input != null && Object.prototype.toString.call(input) === "[object Object]";
      }
      function hasOwnProp(a, b) {
        return Object.prototype.hasOwnProperty.call(a, b);
      }
      function isObjectEmpty(obj) {
        if (Object.getOwnPropertyNames) {
          return Object.getOwnPropertyNames(obj).length === 0;
        } else {
          var k;
          for (k in obj) {
            if (hasOwnProp(obj, k)) {
              return false;
            }
          }
          return true;
        }
      }
      function isUndefined(input) {
        return input === void 0;
      }
      function isNumber(input) {
        return typeof input === "number" || Object.prototype.toString.call(input) === "[object Number]";
      }
      function isDate(input) {
        return input instanceof Date || Object.prototype.toString.call(input) === "[object Date]";
      }
      function map2(arr, fn) {
        var res = [], i, arrLen = arr.length;
        for (i = 0; i < arrLen; ++i) {
          res.push(fn(arr[i], i));
        }
        return res;
      }
      function extend(a, b) {
        for (var i in b) {
          if (hasOwnProp(b, i)) {
            a[i] = b[i];
          }
        }
        if (hasOwnProp(b, "toString")) {
          a.toString = b.toString;
        }
        if (hasOwnProp(b, "valueOf")) {
          a.valueOf = b.valueOf;
        }
        return a;
      }
      function createUTC(input, format2, locale2, strict) {
        return createLocalOrUTC(input, format2, locale2, strict, true).utc();
      }
      function defaultParsingFlags() {
        return {
          empty: false,
          unusedTokens: [],
          unusedInput: [],
          overflow: -2,
          charsLeftOver: 0,
          nullInput: false,
          invalidEra: null,
          invalidMonth: null,
          invalidFormat: false,
          userInvalidated: false,
          iso: false,
          parsedDateParts: [],
          era: null,
          meridiem: null,
          rfc2822: false,
          weekdayMismatch: false
        };
      }
      function getParsingFlags(m) {
        if (m._pf == null) {
          m._pf = defaultParsingFlags();
        }
        return m._pf;
      }
      var some;
      if (Array.prototype.some) {
        some = Array.prototype.some;
      } else {
        some = function(fun) {
          var t = Object(this), len = t.length >>> 0, i;
          for (i = 0; i < len; i++) {
            if (i in t && fun.call(this, t[i], i, t)) {
              return true;
            }
          }
          return false;
        };
      }
      function isValid(m) {
        var flags = null, parsedParts = false, isNowValid = m._d && !isNaN(m._d.getTime());
        if (isNowValid) {
          flags = getParsingFlags(m);
          parsedParts = some.call(flags.parsedDateParts, function(i) {
            return i != null;
          });
          isNowValid = flags.overflow < 0 && !flags.empty && !flags.invalidEra && !flags.invalidMonth && !flags.invalidWeekday && !flags.weekdayMismatch && !flags.nullInput && !flags.invalidFormat && !flags.userInvalidated && (!flags.meridiem || flags.meridiem && parsedParts);
          if (m._strict) {
            isNowValid = isNowValid && flags.charsLeftOver === 0 && flags.unusedTokens.length === 0 && flags.bigHour === void 0;
          }
        }
        if (Object.isFrozen == null || !Object.isFrozen(m)) {
          m._isValid = isNowValid;
        } else {
          return isNowValid;
        }
        return m._isValid;
      }
      function createInvalid(flags) {
        var m = createUTC(NaN);
        if (flags != null) {
          extend(getParsingFlags(m), flags);
        } else {
          getParsingFlags(m).userInvalidated = true;
        }
        return m;
      }
      var momentProperties = hooks.momentProperties = [], updateInProgress = false;
      function copyConfig(to2, from3) {
        var i, prop, val, momentPropertiesLen = momentProperties.length;
        if (!isUndefined(from3._isAMomentObject)) {
          to2._isAMomentObject = from3._isAMomentObject;
        }
        if (!isUndefined(from3._i)) {
          to2._i = from3._i;
        }
        if (!isUndefined(from3._f)) {
          to2._f = from3._f;
        }
        if (!isUndefined(from3._l)) {
          to2._l = from3._l;
        }
        if (!isUndefined(from3._strict)) {
          to2._strict = from3._strict;
        }
        if (!isUndefined(from3._tzm)) {
          to2._tzm = from3._tzm;
        }
        if (!isUndefined(from3._isUTC)) {
          to2._isUTC = from3._isUTC;
        }
        if (!isUndefined(from3._offset)) {
          to2._offset = from3._offset;
        }
        if (!isUndefined(from3._pf)) {
          to2._pf = getParsingFlags(from3);
        }
        if (!isUndefined(from3._locale)) {
          to2._locale = from3._locale;
        }
        if (momentPropertiesLen > 0) {
          for (i = 0; i < momentPropertiesLen; i++) {
            prop = momentProperties[i];
            val = from3[prop];
            if (!isUndefined(val)) {
              to2[prop] = val;
            }
          }
        }
        return to2;
      }
      function Moment(config) {
        copyConfig(this, config);
        this._d = new Date(config._d != null ? config._d.getTime() : NaN);
        if (!this.isValid()) {
          this._d = /* @__PURE__ */ new Date(NaN);
        }
        if (updateInProgress === false) {
          updateInProgress = true;
          hooks.updateOffset(this);
          updateInProgress = false;
        }
      }
      function isMoment(obj) {
        return obj instanceof Moment || obj != null && obj._isAMomentObject != null;
      }
      function warn(msg) {
        if (hooks.suppressDeprecationWarnings === false && typeof console !== "undefined" && console.warn) {
          console.warn("Deprecation warning: " + msg);
        }
      }
      function deprecate(msg, fn) {
        var firstTime = true;
        return extend(function() {
          if (hooks.deprecationHandler != null) {
            hooks.deprecationHandler(null, msg);
          }
          if (firstTime) {
            var args = [], arg, i, key, argLen = arguments.length;
            for (i = 0; i < argLen; i++) {
              arg = "";
              if (typeof arguments[i] === "object") {
                arg += "\n[" + i + "] ";
                for (key in arguments[0]) {
                  if (hasOwnProp(arguments[0], key)) {
                    arg += key + ": " + arguments[0][key] + ", ";
                  }
                }
                arg = arg.slice(0, -2);
              } else {
                arg = arguments[i];
              }
              args.push(arg);
            }
            warn(msg + "\nArguments: " + Array.prototype.slice.call(args).join("") + "\n" + new Error().stack);
            firstTime = false;
          }
          return fn.apply(this, arguments);
        }, fn);
      }
      var deprecations = {};
      function deprecateSimple(name, msg) {
        if (hooks.deprecationHandler != null) {
          hooks.deprecationHandler(name, msg);
        }
        if (!deprecations[name]) {
          warn(msg);
          deprecations[name] = true;
        }
      }
      hooks.suppressDeprecationWarnings = false;
      hooks.deprecationHandler = null;
      function isFunction(input) {
        return typeof Function !== "undefined" && input instanceof Function || Object.prototype.toString.call(input) === "[object Function]";
      }
      function set(config) {
        var prop, i;
        for (i in config) {
          if (hasOwnProp(config, i)) {
            prop = config[i];
            if (isFunction(prop)) {
              this[i] = prop;
            } else {
              this["_" + i] = prop;
            }
          }
        }
        this._config = config;
        this._dayOfMonthOrdinalParseLenient = new RegExp((this._dayOfMonthOrdinalParse.source || this._ordinalParse.source) + "|" + /\d{1,2}/.source);
      }
      function mergeConfigs(parentConfig, childConfig) {
        var res = extend({}, parentConfig), prop;
        for (prop in childConfig) {
          if (hasOwnProp(childConfig, prop)) {
            if (isObject(parentConfig[prop]) && isObject(childConfig[prop])) {
              res[prop] = {};
              extend(res[prop], parentConfig[prop]);
              extend(res[prop], childConfig[prop]);
            } else if (childConfig[prop] != null) {
              res[prop] = childConfig[prop];
            } else {
              delete res[prop];
            }
          }
        }
        for (prop in parentConfig) {
          if (hasOwnProp(parentConfig, prop) && !hasOwnProp(childConfig, prop) && isObject(parentConfig[prop])) {
            res[prop] = extend({}, res[prop]);
          }
        }
        return res;
      }
      function Locale(config) {
        if (config != null) {
          this.set(config);
        }
      }
      var keys2;
      if (Object.keys) {
        keys2 = Object.keys;
      } else {
        keys2 = function(obj) {
          var i, res = [];
          for (i in obj) {
            if (hasOwnProp(obj, i)) {
              res.push(i);
            }
          }
          return res;
        };
      }
      var defaultCalendar = {
        sameDay: "[Today at] LT",
        nextDay: "[Tomorrow at] LT",
        nextWeek: "dddd [at] LT",
        lastDay: "[Yesterday at] LT",
        lastWeek: "[Last] dddd [at] LT",
        sameElse: "L"
      };
      function calendar(key, mom, now2) {
        var output = this._calendar[key] || this._calendar["sameElse"];
        return isFunction(output) ? output.call(mom, now2) : output;
      }
      function zeroFill(number, targetLength, forceSign) {
        var absNumber = "" + Math.abs(number), zerosToFill = targetLength - absNumber.length, sign2 = number >= 0;
        return (sign2 ? forceSign ? "+" : "" : "-") + Math.pow(10, Math.max(0, zerosToFill)).toString().substr(1) + absNumber;
      }
      var formattingTokens = /(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g, localFormattingTokens = /(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g, formatFunctions = {}, formatTokenFunctions = {};
      function addFormatToken(token2, padded, ordinal2, callback) {
        var func = callback;
        if (typeof callback === "string") {
          func = function() {
            return this[callback]();
          };
        }
        if (token2) {
          formatTokenFunctions[token2] = func;
        }
        if (padded) {
          formatTokenFunctions[padded[0]] = function() {
            return zeroFill(func.apply(this, arguments), padded[1], padded[2]);
          };
        }
        if (ordinal2) {
          formatTokenFunctions[ordinal2] = function() {
            return this.localeData().ordinal(func.apply(this, arguments), token2);
          };
        }
      }
      function removeFormattingTokens(input) {
        if (input.match(/\[[\s\S]/)) {
          return input.replace(/^\[|\]$/g, "");
        }
        return input.replace(/\\/g, "");
      }
      function makeFormatFunction(format2) {
        var array = format2.match(formattingTokens), i, length;
        for (i = 0, length = array.length; i < length; i++) {
          if (formatTokenFunctions[array[i]]) {
            array[i] = formatTokenFunctions[array[i]];
          } else {
            array[i] = removeFormattingTokens(array[i]);
          }
        }
        return function(mom) {
          var output = "", i2;
          for (i2 = 0; i2 < length; i2++) {
            output += isFunction(array[i2]) ? array[i2].call(mom, format2) : array[i2];
          }
          return output;
        };
      }
      function formatMoment(m, format2) {
        if (!m.isValid()) {
          return m.localeData().invalidDate();
        }
        format2 = expandFormat(format2, m.localeData());
        formatFunctions[format2] = formatFunctions[format2] || makeFormatFunction(format2);
        return formatFunctions[format2](m);
      }
      function expandFormat(format2, locale2) {
        var i = 5;
        function replaceLongDateFormatTokens(input) {
          return locale2.longDateFormat(input) || input;
        }
        localFormattingTokens.lastIndex = 0;
        while (i >= 0 && localFormattingTokens.test(format2)) {
          format2 = format2.replace(localFormattingTokens, replaceLongDateFormatTokens);
          localFormattingTokens.lastIndex = 0;
          i -= 1;
        }
        return format2;
      }
      var defaultLongDateFormat = {
        LTS: "h:mm:ss A",
        LT: "h:mm A",
        L: "MM/DD/YYYY",
        LL: "MMMM D, YYYY",
        LLL: "MMMM D, YYYY h:mm A",
        LLLL: "dddd, MMMM D, YYYY h:mm A"
      };
      function longDateFormat(key) {
        var format2 = this._longDateFormat[key], formatUpper = this._longDateFormat[key.toUpperCase()];
        if (format2 || !formatUpper) {
          return format2;
        }
        this._longDateFormat[key] = formatUpper.match(formattingTokens).map(function(tok) {
          if (tok === "MMMM" || tok === "MM" || tok === "DD" || tok === "dddd") {
            return tok.slice(1);
          }
          return tok;
        }).join("");
        return this._longDateFormat[key];
      }
      var defaultInvalidDate = "Invalid date";
      function invalidDate() {
        return this._invalidDate;
      }
      var defaultOrdinal = "%d", defaultDayOfMonthOrdinalParse = /\d{1,2}/;
      function ordinal(number) {
        return this._ordinal.replace("%d", number);
      }
      var defaultRelativeTime = {
        future: "in %s",
        past: "%s ago",
        s: "a few seconds",
        ss: "%d seconds",
        m: "a minute",
        mm: "%d minutes",
        h: "an hour",
        hh: "%d hours",
        d: "a day",
        dd: "%d days",
        w: "a week",
        ww: "%d weeks",
        M: "a month",
        MM: "%d months",
        y: "a year",
        yy: "%d years"
      };
      function relativeTime(number, withoutSuffix, string, isFuture) {
        var output = this._relativeTime[string];
        return isFunction(output) ? output(number, withoutSuffix, string, isFuture) : output.replace(/%d/i, number);
      }
      function pastFuture(diff2, output) {
        var format2 = this._relativeTime[diff2 > 0 ? "future" : "past"];
        return isFunction(format2) ? format2(output) : format2.replace(/%s/i, output);
      }
      var aliases = {
        D: "date",
        dates: "date",
        date: "date",
        d: "day",
        days: "day",
        day: "day",
        e: "weekday",
        weekdays: "weekday",
        weekday: "weekday",
        E: "isoWeekday",
        isoweekdays: "isoWeekday",
        isoweekday: "isoWeekday",
        DDD: "dayOfYear",
        dayofyears: "dayOfYear",
        dayofyear: "dayOfYear",
        h: "hour",
        hours: "hour",
        hour: "hour",
        ms: "millisecond",
        milliseconds: "millisecond",
        millisecond: "millisecond",
        m: "minute",
        minutes: "minute",
        minute: "minute",
        M: "month",
        months: "month",
        month: "month",
        Q: "quarter",
        quarters: "quarter",
        quarter: "quarter",
        s: "second",
        seconds: "second",
        second: "second",
        gg: "weekYear",
        weekyears: "weekYear",
        weekyear: "weekYear",
        GG: "isoWeekYear",
        isoweekyears: "isoWeekYear",
        isoweekyear: "isoWeekYear",
        w: "week",
        weeks: "week",
        week: "week",
        W: "isoWeek",
        isoweeks: "isoWeek",
        isoweek: "isoWeek",
        y: "year",
        years: "year",
        year: "year"
      };
      function normalizeUnits(units) {
        return typeof units === "string" ? aliases[units] || aliases[units.toLowerCase()] : void 0;
      }
      function normalizeObjectUnits(inputObject) {
        var normalizedInput = {}, normalizedProp, prop;
        for (prop in inputObject) {
          if (hasOwnProp(inputObject, prop)) {
            normalizedProp = normalizeUnits(prop);
            if (normalizedProp) {
              normalizedInput[normalizedProp] = inputObject[prop];
            }
          }
        }
        return normalizedInput;
      }
      var priorities = {
        date: 9,
        day: 11,
        weekday: 11,
        isoWeekday: 11,
        dayOfYear: 4,
        hour: 13,
        millisecond: 16,
        minute: 14,
        month: 8,
        quarter: 7,
        second: 15,
        weekYear: 1,
        isoWeekYear: 1,
        week: 5,
        isoWeek: 5,
        year: 1
      };
      function getPrioritizedUnits(unitsObj) {
        var units = [], u2;
        for (u2 in unitsObj) {
          if (hasOwnProp(unitsObj, u2)) {
            units.push({
              unit: u2,
              priority: priorities[u2]
            });
          }
        }
        units.sort(function(a, b) {
          return a.priority - b.priority;
        });
        return units;
      }
      var match1 = /\d/, match2 = /\d\d/, match3 = /\d{3}/, match4 = /\d{4}/, match6 = /[+-]?\d{6}/, match1to2 = /\d\d?/, match3to4 = /\d\d\d\d?/, match5to6 = /\d\d\d\d\d\d?/, match1to3 = /\d{1,3}/, match1to4 = /\d{1,4}/, match1to6 = /[+-]?\d{1,6}/, matchUnsigned = /\d+/, matchSigned = /[+-]?\d+/, matchOffset = /Z|[+-]\d\d:?\d\d/gi, matchShortOffset = /Z|[+-]\d\d(?::?\d\d)?/gi, matchTimestamp = /[+-]?\d+(\.\d{1,3})?/, matchWord = /[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i, match1to2NoLeadingZero = /^[1-9]\d?/, match1to2HasZero = /^([1-9]\d|\d)/, regexes;
      regexes = {};
      function addRegexToken(token2, regex, strictRegex) {
        regexes[token2] = isFunction(regex) ? regex : function(isStrict, localeData2) {
          return isStrict && strictRegex ? strictRegex : regex;
        };
      }
      function getParseRegexForToken(token2, config) {
        if (!hasOwnProp(regexes, token2)) {
          return new RegExp(unescapeFormat(token2));
        }
        return regexes[token2](config._strict, config._locale);
      }
      function unescapeFormat(s) {
        return regexEscape(s.replace("\\", "").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function(matched, p1, p2, p3, p4) {
          return p1 || p2 || p3 || p4;
        }));
      }
      function regexEscape(s) {
        return s.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&");
      }
      function absFloor(number) {
        if (number < 0) {
          return Math.ceil(number) || 0;
        } else {
          return Math.floor(number);
        }
      }
      function toInt(argumentForCoercion) {
        var coercedNumber = +argumentForCoercion, value = 0;
        if (coercedNumber !== 0 && isFinite(coercedNumber)) {
          value = absFloor(coercedNumber);
        }
        return value;
      }
      var tokens = {};
      function addParseToken(token2, callback) {
        var i, func = callback, tokenLen;
        if (typeof token2 === "string") {
          token2 = [token2];
        }
        if (isNumber(callback)) {
          func = function(input, array) {
            array[callback] = toInt(input);
          };
        }
        tokenLen = token2.length;
        for (i = 0; i < tokenLen; i++) {
          tokens[token2[i]] = func;
        }
      }
      function addWeekParseToken(token2, callback) {
        addParseToken(token2, function(input, array, config, token3) {
          config._w = config._w || {};
          callback(input, config._w, config, token3);
        });
      }
      function addTimeToArrayFromToken(token2, input, config) {
        if (input != null && hasOwnProp(tokens, token2)) {
          tokens[token2](input, config._a, config, token2);
        }
      }
      function isLeapYear(year) {
        return year % 4 === 0 && year % 100 !== 0 || year % 400 === 0;
      }
      var YEAR = 0, MONTH = 1, DATE = 2, HOUR = 3, MINUTE = 4, SECOND = 5, MILLISECOND = 6, WEEK = 7, WEEKDAY = 8;
      addFormatToken("Y", 0, 0, function() {
        var y = this.year();
        return y <= 9999 ? zeroFill(y, 4) : "+" + y;
      });
      addFormatToken(0, ["YY", 2], 0, function() {
        return this.year() % 100;
      });
      addFormatToken(0, ["YYYY", 4], 0, "year");
      addFormatToken(0, ["YYYYY", 5], 0, "year");
      addFormatToken(0, ["YYYYYY", 6, true], 0, "year");
      addRegexToken("Y", matchSigned);
      addRegexToken("YY", match1to2, match2);
      addRegexToken("YYYY", match1to4, match4);
      addRegexToken("YYYYY", match1to6, match6);
      addRegexToken("YYYYYY", match1to6, match6);
      addParseToken(["YYYYY", "YYYYYY"], YEAR);
      addParseToken("YYYY", function(input, array) {
        array[YEAR] = input.length === 2 ? hooks.parseTwoDigitYear(input) : toInt(input);
      });
      addParseToken("YY", function(input, array) {
        array[YEAR] = hooks.parseTwoDigitYear(input);
      });
      addParseToken("Y", function(input, array) {
        array[YEAR] = parseInt(input, 10);
      });
      function daysInYear(year) {
        return isLeapYear(year) ? 366 : 365;
      }
      hooks.parseTwoDigitYear = function(input) {
        return toInt(input) + (toInt(input) > 68 ? 1900 : 2e3);
      };
      var getSetYear = makeGetSet("FullYear", true);
      function getIsLeapYear() {
        return isLeapYear(this.year());
      }
      function makeGetSet(unit, keepTime) {
        return function(value) {
          if (value != null) {
            set$1(this, unit, value);
            hooks.updateOffset(this, keepTime);
            return this;
          } else {
            return get(this, unit);
          }
        };
      }
      function get(mom, unit) {
        if (!mom.isValid()) {
          return NaN;
        }
        var d = mom._d, isUTC = mom._isUTC;
        switch (unit) {
          case "Milliseconds":
            return isUTC ? d.getUTCMilliseconds() : d.getMilliseconds();
          case "Seconds":
            return isUTC ? d.getUTCSeconds() : d.getSeconds();
          case "Minutes":
            return isUTC ? d.getUTCMinutes() : d.getMinutes();
          case "Hours":
            return isUTC ? d.getUTCHours() : d.getHours();
          case "Date":
            return isUTC ? d.getUTCDate() : d.getDate();
          case "Day":
            return isUTC ? d.getUTCDay() : d.getDay();
          case "Month":
            return isUTC ? d.getUTCMonth() : d.getMonth();
          case "FullYear":
            return isUTC ? d.getUTCFullYear() : d.getFullYear();
          default:
            return NaN;
        }
      }
      function set$1(mom, unit, value) {
        var d, isUTC, year, month, date;
        if (!mom.isValid() || isNaN(value)) {
          return;
        }
        d = mom._d;
        isUTC = mom._isUTC;
        switch (unit) {
          case "Milliseconds":
            return void (isUTC ? d.setUTCMilliseconds(value) : d.setMilliseconds(value));
          case "Seconds":
            return void (isUTC ? d.setUTCSeconds(value) : d.setSeconds(value));
          case "Minutes":
            return void (isUTC ? d.setUTCMinutes(value) : d.setMinutes(value));
          case "Hours":
            return void (isUTC ? d.setUTCHours(value) : d.setHours(value));
          case "Date":
            return void (isUTC ? d.setUTCDate(value) : d.setDate(value));
          // case 'Day': // Not real
          //    return void (isUTC ? d.setUTCDay(value) : d.setDay(value));
          // case 'Month': // Not used because we need to pass two variables
          //     return void (isUTC ? d.setUTCMonth(value) : d.setMonth(value));
          case "FullYear":
            break;
          // See below ...
          default:
            return;
        }
        year = value;
        month = mom.month();
        date = mom.date();
        date = date === 29 && month === 1 && !isLeapYear(year) ? 28 : date;
        void (isUTC ? d.setUTCFullYear(year, month, date) : d.setFullYear(year, month, date));
      }
      function stringGet(units) {
        units = normalizeUnits(units);
        if (isFunction(this[units])) {
          return this[units]();
        }
        return this;
      }
      function stringSet(units, value) {
        if (typeof units === "object") {
          units = normalizeObjectUnits(units);
          var prioritized = getPrioritizedUnits(units), i, prioritizedLen = prioritized.length;
          for (i = 0; i < prioritizedLen; i++) {
            this[prioritized[i].unit](units[prioritized[i].unit]);
          }
        } else {
          units = normalizeUnits(units);
          if (isFunction(this[units])) {
            return this[units](value);
          }
        }
        return this;
      }
      function mod(n, x) {
        return (n % x + x) % x;
      }
      var indexOf;
      if (Array.prototype.indexOf) {
        indexOf = Array.prototype.indexOf;
      } else {
        indexOf = function(o) {
          var i;
          for (i = 0; i < this.length; ++i) {
            if (this[i] === o) {
              return i;
            }
          }
          return -1;
        };
      }
      function daysInMonth(year, month) {
        if (isNaN(year) || isNaN(month)) {
          return NaN;
        }
        var modMonth = mod(month, 12);
        year += (month - modMonth) / 12;
        return modMonth === 1 ? isLeapYear(year) ? 29 : 28 : 31 - modMonth % 7 % 2;
      }
      addFormatToken("M", ["MM", 2], "Mo", function() {
        return this.month() + 1;
      });
      addFormatToken("MMM", 0, 0, function(format2) {
        return this.localeData().monthsShort(this, format2);
      });
      addFormatToken("MMMM", 0, 0, function(format2) {
        return this.localeData().months(this, format2);
      });
      addRegexToken("M", match1to2, match1to2NoLeadingZero);
      addRegexToken("MM", match1to2, match2);
      addRegexToken("MMM", function(isStrict, locale2) {
        return locale2.monthsShortRegex(isStrict);
      });
      addRegexToken("MMMM", function(isStrict, locale2) {
        return locale2.monthsRegex(isStrict);
      });
      addParseToken(["M", "MM"], function(input, array) {
        array[MONTH] = toInt(input) - 1;
      });
      addParseToken(["MMM", "MMMM"], function(input, array, config, token2) {
        var month = config._locale.monthsParse(input, token2, config._strict);
        if (month != null) {
          array[MONTH] = month;
        } else {
          getParsingFlags(config).invalidMonth = input;
        }
      });
      var defaultLocaleMonths = "January_February_March_April_May_June_July_August_September_October_November_December".split("_"), defaultLocaleMonthsShort = "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"), MONTHS_IN_FORMAT = /D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/, defaultMonthsShortRegex = matchWord, defaultMonthsRegex = matchWord;
      function localeMonths(m, format2) {
        if (!m) {
          return isArray(this._months) ? this._months : this._months["standalone"];
        }
        return isArray(this._months) ? this._months[m.month()] : this._months[(this._months.isFormat || MONTHS_IN_FORMAT).test(format2) ? "format" : "standalone"][m.month()];
      }
      function localeMonthsShort(m, format2) {
        if (!m) {
          return isArray(this._monthsShort) ? this._monthsShort : this._monthsShort["standalone"];
        }
        return isArray(this._monthsShort) ? this._monthsShort[m.month()] : this._monthsShort[MONTHS_IN_FORMAT.test(format2) ? "format" : "standalone"][m.month()];
      }
      function handleStrictParse(monthName, format2, strict) {
        var i, ii, mom, llc = monthName.toLocaleLowerCase();
        if (!this._monthsParse) {
          this._monthsParse = [];
          this._longMonthsParse = [];
          this._shortMonthsParse = [];
          for (i = 0; i < 12; ++i) {
            mom = createUTC([2e3, i]);
            this._shortMonthsParse[i] = this.monthsShort(mom, "").toLocaleLowerCase();
            this._longMonthsParse[i] = this.months(mom, "").toLocaleLowerCase();
          }
        }
        if (strict) {
          if (format2 === "MMM") {
            ii = indexOf.call(this._shortMonthsParse, llc);
            return ii !== -1 ? ii : null;
          } else {
            ii = indexOf.call(this._longMonthsParse, llc);
            return ii !== -1 ? ii : null;
          }
        } else {
          if (format2 === "MMM") {
            ii = indexOf.call(this._shortMonthsParse, llc);
            if (ii !== -1) {
              return ii;
            }
            ii = indexOf.call(this._longMonthsParse, llc);
            return ii !== -1 ? ii : null;
          } else {
            ii = indexOf.call(this._longMonthsParse, llc);
            if (ii !== -1) {
              return ii;
            }
            ii = indexOf.call(this._shortMonthsParse, llc);
            return ii !== -1 ? ii : null;
          }
        }
      }
      function localeMonthsParse(monthName, format2, strict) {
        var i, mom, regex;
        if (this._monthsParseExact) {
          return handleStrictParse.call(this, monthName, format2, strict);
        }
        if (!this._monthsParse) {
          this._monthsParse = [];
          this._longMonthsParse = [];
          this._shortMonthsParse = [];
        }
        for (i = 0; i < 12; i++) {
          mom = createUTC([2e3, i]);
          if (strict && !this._longMonthsParse[i]) {
            this._longMonthsParse[i] = new RegExp("^" + this.months(mom, "").replace(".", "") + "$", "i");
            this._shortMonthsParse[i] = new RegExp("^" + this.monthsShort(mom, "").replace(".", "") + "$", "i");
          }
          if (!strict && !this._monthsParse[i]) {
            regex = "^" + this.months(mom, "") + "|^" + this.monthsShort(mom, "");
            this._monthsParse[i] = new RegExp(regex.replace(".", ""), "i");
          }
          if (strict && format2 === "MMMM" && this._longMonthsParse[i].test(monthName)) {
            return i;
          } else if (strict && format2 === "MMM" && this._shortMonthsParse[i].test(monthName)) {
            return i;
          } else if (!strict && this._monthsParse[i].test(monthName)) {
            return i;
          }
        }
      }
      function setMonth(mom, value) {
        if (!mom.isValid()) {
          return mom;
        }
        if (typeof value === "string") {
          if (/^\d+$/.test(value)) {
            value = toInt(value);
          } else {
            value = mom.localeData().monthsParse(value);
            if (!isNumber(value)) {
              return mom;
            }
          }
        }
        var month = value, date = mom.date();
        date = date < 29 ? date : Math.min(date, daysInMonth(mom.year(), month));
        void (mom._isUTC ? mom._d.setUTCMonth(month, date) : mom._d.setMonth(month, date));
        return mom;
      }
      function getSetMonth(value) {
        if (value != null) {
          setMonth(this, value);
          hooks.updateOffset(this, true);
          return this;
        } else {
          return get(this, "Month");
        }
      }
      function getDaysInMonth() {
        return daysInMonth(this.year(), this.month());
      }
      function monthsShortRegex(isStrict) {
        if (this._monthsParseExact) {
          if (!hasOwnProp(this, "_monthsRegex")) {
            computeMonthsParse.call(this);
          }
          if (isStrict) {
            return this._monthsShortStrictRegex;
          } else {
            return this._monthsShortRegex;
          }
        } else {
          if (!hasOwnProp(this, "_monthsShortRegex")) {
            this._monthsShortRegex = defaultMonthsShortRegex;
          }
          return this._monthsShortStrictRegex && isStrict ? this._monthsShortStrictRegex : this._monthsShortRegex;
        }
      }
      function monthsRegex(isStrict) {
        if (this._monthsParseExact) {
          if (!hasOwnProp(this, "_monthsRegex")) {
            computeMonthsParse.call(this);
          }
          if (isStrict) {
            return this._monthsStrictRegex;
          } else {
            return this._monthsRegex;
          }
        } else {
          if (!hasOwnProp(this, "_monthsRegex")) {
            this._monthsRegex = defaultMonthsRegex;
          }
          return this._monthsStrictRegex && isStrict ? this._monthsStrictRegex : this._monthsRegex;
        }
      }
      function computeMonthsParse() {
        function cmpLenRev(a, b) {
          return b.length - a.length;
        }
        var shortPieces = [], longPieces = [], mixedPieces = [], i, mom, shortP, longP;
        for (i = 0; i < 12; i++) {
          mom = createUTC([2e3, i]);
          shortP = regexEscape(this.monthsShort(mom, ""));
          longP = regexEscape(this.months(mom, ""));
          shortPieces.push(shortP);
          longPieces.push(longP);
          mixedPieces.push(longP);
          mixedPieces.push(shortP);
        }
        shortPieces.sort(cmpLenRev);
        longPieces.sort(cmpLenRev);
        mixedPieces.sort(cmpLenRev);
        this._monthsRegex = new RegExp("^(" + mixedPieces.join("|") + ")", "i");
        this._monthsShortRegex = this._monthsRegex;
        this._monthsStrictRegex = new RegExp("^(" + longPieces.join("|") + ")", "i");
        this._monthsShortStrictRegex = new RegExp("^(" + shortPieces.join("|") + ")", "i");
      }
      function createDate(y, m, d, h, M, s, ms) {
        var date;
        if (y < 100 && y >= 0) {
          date = new Date(y + 400, m, d, h, M, s, ms);
          if (isFinite(date.getFullYear())) {
            date.setFullYear(y);
          }
        } else {
          date = new Date(y, m, d, h, M, s, ms);
        }
        return date;
      }
      function createUTCDate(y) {
        var date, args;
        if (y < 100 && y >= 0) {
          args = Array.prototype.slice.call(arguments);
          args[0] = y + 400;
          date = new Date(Date.UTC.apply(null, args));
          if (isFinite(date.getUTCFullYear())) {
            date.setUTCFullYear(y);
          }
        } else {
          date = new Date(Date.UTC.apply(null, arguments));
        }
        return date;
      }
      function firstWeekOffset(year, dow, doy) {
        var fwd = 7 + dow - doy, fwdlw = (7 + createUTCDate(year, 0, fwd).getUTCDay() - dow) % 7;
        return -fwdlw + fwd - 1;
      }
      function dayOfYearFromWeeks(year, week, weekday, dow, doy) {
        var localWeekday = (7 + weekday - dow) % 7, weekOffset = firstWeekOffset(year, dow, doy), dayOfYear = 1 + 7 * (week - 1) + localWeekday + weekOffset, resYear, resDayOfYear;
        if (dayOfYear <= 0) {
          resYear = year - 1;
          resDayOfYear = daysInYear(resYear) + dayOfYear;
        } else if (dayOfYear > daysInYear(year)) {
          resYear = year + 1;
          resDayOfYear = dayOfYear - daysInYear(year);
        } else {
          resYear = year;
          resDayOfYear = dayOfYear;
        }
        return {
          year: resYear,
          dayOfYear: resDayOfYear
        };
      }
      function weekOfYear(mom, dow, doy) {
        var weekOffset = firstWeekOffset(mom.year(), dow, doy), week = Math.floor((mom.dayOfYear() - weekOffset - 1) / 7) + 1, resWeek, resYear;
        if (week < 1) {
          resYear = mom.year() - 1;
          resWeek = week + weeksInYear(resYear, dow, doy);
        } else if (week > weeksInYear(mom.year(), dow, doy)) {
          resWeek = week - weeksInYear(mom.year(), dow, doy);
          resYear = mom.year() + 1;
        } else {
          resYear = mom.year();
          resWeek = week;
        }
        return {
          week: resWeek,
          year: resYear
        };
      }
      function weeksInYear(year, dow, doy) {
        var weekOffset = firstWeekOffset(year, dow, doy), weekOffsetNext = firstWeekOffset(year + 1, dow, doy);
        return (daysInYear(year) - weekOffset + weekOffsetNext) / 7;
      }
      addFormatToken("w", ["ww", 2], "wo", "week");
      addFormatToken("W", ["WW", 2], "Wo", "isoWeek");
      addRegexToken("w", match1to2, match1to2NoLeadingZero);
      addRegexToken("ww", match1to2, match2);
      addRegexToken("W", match1to2, match1to2NoLeadingZero);
      addRegexToken("WW", match1to2, match2);
      addWeekParseToken(["w", "ww", "W", "WW"], function(input, week, config, token2) {
        week[token2.substr(0, 1)] = toInt(input);
      });
      function localeWeek(mom) {
        return weekOfYear(mom, this._week.dow, this._week.doy).week;
      }
      var defaultLocaleWeek = {
        dow: 0,
        // Sunday is the first day of the week.
        doy: 6
        // The week that contains Jan 6th is the first week of the year.
      };
      function localeFirstDayOfWeek() {
        return this._week.dow;
      }
      function localeFirstDayOfYear() {
        return this._week.doy;
      }
      function getSetWeek(input) {
        var week = this.localeData().week(this);
        return input == null ? week : this.add((input - week) * 7, "d");
      }
      function getSetISOWeek(input) {
        var week = weekOfYear(this, 1, 4).week;
        return input == null ? week : this.add((input - week) * 7, "d");
      }
      addFormatToken("d", 0, "do", "day");
      addFormatToken("dd", 0, 0, function(format2) {
        return this.localeData().weekdaysMin(this, format2);
      });
      addFormatToken("ddd", 0, 0, function(format2) {
        return this.localeData().weekdaysShort(this, format2);
      });
      addFormatToken("dddd", 0, 0, function(format2) {
        return this.localeData().weekdays(this, format2);
      });
      addFormatToken("e", 0, 0, "weekday");
      addFormatToken("E", 0, 0, "isoWeekday");
      addRegexToken("d", match1to2);
      addRegexToken("e", match1to2);
      addRegexToken("E", match1to2);
      addRegexToken("dd", function(isStrict, locale2) {
        return locale2.weekdaysMinRegex(isStrict);
      });
      addRegexToken("ddd", function(isStrict, locale2) {
        return locale2.weekdaysShortRegex(isStrict);
      });
      addRegexToken("dddd", function(isStrict, locale2) {
        return locale2.weekdaysRegex(isStrict);
      });
      addWeekParseToken(["dd", "ddd", "dddd"], function(input, week, config, token2) {
        var weekday = config._locale.weekdaysParse(input, token2, config._strict);
        if (weekday != null) {
          week.d = weekday;
        } else {
          getParsingFlags(config).invalidWeekday = input;
        }
      });
      addWeekParseToken(["d", "e", "E"], function(input, week, config, token2) {
        week[token2] = toInt(input);
      });
      function parseWeekday(input, locale2) {
        if (typeof input !== "string") {
          return input;
        }
        if (!isNaN(input)) {
          return parseInt(input, 10);
        }
        input = locale2.weekdaysParse(input);
        if (typeof input === "number") {
          return input;
        }
        return null;
      }
      function parseIsoWeekday(input, locale2) {
        if (typeof input === "string") {
          return locale2.weekdaysParse(input) % 7 || 7;
        }
        return isNaN(input) ? null : input;
      }
      function shiftWeekdays(ws, n) {
        return ws.slice(n, 7).concat(ws.slice(0, n));
      }
      var defaultLocaleWeekdays = "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"), defaultLocaleWeekdaysShort = "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"), defaultLocaleWeekdaysMin = "Su_Mo_Tu_We_Th_Fr_Sa".split("_"), defaultWeekdaysRegex = matchWord, defaultWeekdaysShortRegex = matchWord, defaultWeekdaysMinRegex = matchWord;
      function localeWeekdays(m, format2) {
        var weekdays = isArray(this._weekdays) ? this._weekdays : this._weekdays[m && m !== true && this._weekdays.isFormat.test(format2) ? "format" : "standalone"];
        return m === true ? shiftWeekdays(weekdays, this._week.dow) : m ? weekdays[m.day()] : weekdays;
      }
      function localeWeekdaysShort(m) {
        return m === true ? shiftWeekdays(this._weekdaysShort, this._week.dow) : m ? this._weekdaysShort[m.day()] : this._weekdaysShort;
      }
      function localeWeekdaysMin(m) {
        return m === true ? shiftWeekdays(this._weekdaysMin, this._week.dow) : m ? this._weekdaysMin[m.day()] : this._weekdaysMin;
      }
      function handleStrictParse$1(weekdayName, format2, strict) {
        var i, ii, mom, llc = weekdayName.toLocaleLowerCase();
        if (!this._weekdaysParse) {
          this._weekdaysParse = [];
          this._shortWeekdaysParse = [];
          this._minWeekdaysParse = [];
          for (i = 0; i < 7; ++i) {
            mom = createUTC([2e3, 1]).day(i);
            this._minWeekdaysParse[i] = this.weekdaysMin(mom, "").toLocaleLowerCase();
            this._shortWeekdaysParse[i] = this.weekdaysShort(mom, "").toLocaleLowerCase();
            this._weekdaysParse[i] = this.weekdays(mom, "").toLocaleLowerCase();
          }
        }
        if (strict) {
          if (format2 === "dddd") {
            ii = indexOf.call(this._weekdaysParse, llc);
            return ii !== -1 ? ii : null;
          } else if (format2 === "ddd") {
            ii = indexOf.call(this._shortWeekdaysParse, llc);
            return ii !== -1 ? ii : null;
          } else {
            ii = indexOf.call(this._minWeekdaysParse, llc);
            return ii !== -1 ? ii : null;
          }
        } else {
          if (format2 === "dddd") {
            ii = indexOf.call(this._weekdaysParse, llc);
            if (ii !== -1) {
              return ii;
            }
            ii = indexOf.call(this._shortWeekdaysParse, llc);
            if (ii !== -1) {
              return ii;
            }
            ii = indexOf.call(this._minWeekdaysParse, llc);
            return ii !== -1 ? ii : null;
          } else if (format2 === "ddd") {
            ii = indexOf.call(this._shortWeekdaysParse, llc);
            if (ii !== -1) {
              return ii;
            }
            ii = indexOf.call(this._weekdaysParse, llc);
            if (ii !== -1) {
              return ii;
            }
            ii = indexOf.call(this._minWeekdaysParse, llc);
            return ii !== -1 ? ii : null;
          } else {
            ii = indexOf.call(this._minWeekdaysParse, llc);
            if (ii !== -1) {
              return ii;
            }
            ii = indexOf.call(this._weekdaysParse, llc);
            if (ii !== -1) {
              return ii;
            }
            ii = indexOf.call(this._shortWeekdaysParse, llc);
            return ii !== -1 ? ii : null;
          }
        }
      }
      function localeWeekdaysParse(weekdayName, format2, strict) {
        var i, mom, regex;
        if (this._weekdaysParseExact) {
          return handleStrictParse$1.call(this, weekdayName, format2, strict);
        }
        if (!this._weekdaysParse) {
          this._weekdaysParse = [];
          this._minWeekdaysParse = [];
          this._shortWeekdaysParse = [];
          this._fullWeekdaysParse = [];
        }
        for (i = 0; i < 7; i++) {
          mom = createUTC([2e3, 1]).day(i);
          if (strict && !this._fullWeekdaysParse[i]) {
            this._fullWeekdaysParse[i] = new RegExp("^" + this.weekdays(mom, "").replace(".", "\\.?") + "$", "i");
            this._shortWeekdaysParse[i] = new RegExp("^" + this.weekdaysShort(mom, "").replace(".", "\\.?") + "$", "i");
            this._minWeekdaysParse[i] = new RegExp("^" + this.weekdaysMin(mom, "").replace(".", "\\.?") + "$", "i");
          }
          if (!this._weekdaysParse[i]) {
            regex = "^" + this.weekdays(mom, "") + "|^" + this.weekdaysShort(mom, "") + "|^" + this.weekdaysMin(mom, "");
            this._weekdaysParse[i] = new RegExp(regex.replace(".", ""), "i");
          }
          if (strict && format2 === "dddd" && this._fullWeekdaysParse[i].test(weekdayName)) {
            return i;
          } else if (strict && format2 === "ddd" && this._shortWeekdaysParse[i].test(weekdayName)) {
            return i;
          } else if (strict && format2 === "dd" && this._minWeekdaysParse[i].test(weekdayName)) {
            return i;
          } else if (!strict && this._weekdaysParse[i].test(weekdayName)) {
            return i;
          }
        }
      }
      function getSetDayOfWeek(input) {
        if (!this.isValid()) {
          return input != null ? this : NaN;
        }
        var day = get(this, "Day");
        if (input != null) {
          input = parseWeekday(input, this.localeData());
          return this.add(input - day, "d");
        } else {
          return day;
        }
      }
      function getSetLocaleDayOfWeek(input) {
        if (!this.isValid()) {
          return input != null ? this : NaN;
        }
        var weekday = (this.day() + 7 - this.localeData()._week.dow) % 7;
        return input == null ? weekday : this.add(input - weekday, "d");
      }
      function getSetISODayOfWeek(input) {
        if (!this.isValid()) {
          return input != null ? this : NaN;
        }
        if (input != null) {
          var weekday = parseIsoWeekday(input, this.localeData());
          return this.day(this.day() % 7 ? weekday : weekday - 7);
        } else {
          return this.day() || 7;
        }
      }
      function weekdaysRegex(isStrict) {
        if (this._weekdaysParseExact) {
          if (!hasOwnProp(this, "_weekdaysRegex")) {
            computeWeekdaysParse.call(this);
          }
          if (isStrict) {
            return this._weekdaysStrictRegex;
          } else {
            return this._weekdaysRegex;
          }
        } else {
          if (!hasOwnProp(this, "_weekdaysRegex")) {
            this._weekdaysRegex = defaultWeekdaysRegex;
          }
          return this._weekdaysStrictRegex && isStrict ? this._weekdaysStrictRegex : this._weekdaysRegex;
        }
      }
      function weekdaysShortRegex(isStrict) {
        if (this._weekdaysParseExact) {
          if (!hasOwnProp(this, "_weekdaysRegex")) {
            computeWeekdaysParse.call(this);
          }
          if (isStrict) {
            return this._weekdaysShortStrictRegex;
          } else {
            return this._weekdaysShortRegex;
          }
        } else {
          if (!hasOwnProp(this, "_weekdaysShortRegex")) {
            this._weekdaysShortRegex = defaultWeekdaysShortRegex;
          }
          return this._weekdaysShortStrictRegex && isStrict ? this._weekdaysShortStrictRegex : this._weekdaysShortRegex;
        }
      }
      function weekdaysMinRegex(isStrict) {
        if (this._weekdaysParseExact) {
          if (!hasOwnProp(this, "_weekdaysRegex")) {
            computeWeekdaysParse.call(this);
          }
          if (isStrict) {
            return this._weekdaysMinStrictRegex;
          } else {
            return this._weekdaysMinRegex;
          }
        } else {
          if (!hasOwnProp(this, "_weekdaysMinRegex")) {
            this._weekdaysMinRegex = defaultWeekdaysMinRegex;
          }
          return this._weekdaysMinStrictRegex && isStrict ? this._weekdaysMinStrictRegex : this._weekdaysMinRegex;
        }
      }
      function computeWeekdaysParse() {
        function cmpLenRev(a, b) {
          return b.length - a.length;
        }
        var minPieces = [], shortPieces = [], longPieces = [], mixedPieces = [], i, mom, minp, shortp, longp;
        for (i = 0; i < 7; i++) {
          mom = createUTC([2e3, 1]).day(i);
          minp = regexEscape(this.weekdaysMin(mom, ""));
          shortp = regexEscape(this.weekdaysShort(mom, ""));
          longp = regexEscape(this.weekdays(mom, ""));
          minPieces.push(minp);
          shortPieces.push(shortp);
          longPieces.push(longp);
          mixedPieces.push(minp);
          mixedPieces.push(shortp);
          mixedPieces.push(longp);
        }
        minPieces.sort(cmpLenRev);
        shortPieces.sort(cmpLenRev);
        longPieces.sort(cmpLenRev);
        mixedPieces.sort(cmpLenRev);
        this._weekdaysRegex = new RegExp("^(" + mixedPieces.join("|") + ")", "i");
        this._weekdaysShortRegex = this._weekdaysRegex;
        this._weekdaysMinRegex = this._weekdaysRegex;
        this._weekdaysStrictRegex = new RegExp("^(" + longPieces.join("|") + ")", "i");
        this._weekdaysShortStrictRegex = new RegExp("^(" + shortPieces.join("|") + ")", "i");
        this._weekdaysMinStrictRegex = new RegExp("^(" + minPieces.join("|") + ")", "i");
      }
      function hFormat() {
        return this.hours() % 12 || 12;
      }
      function kFormat() {
        return this.hours() || 24;
      }
      addFormatToken("H", ["HH", 2], 0, "hour");
      addFormatToken("h", ["hh", 2], 0, hFormat);
      addFormatToken("k", ["kk", 2], 0, kFormat);
      addFormatToken("hmm", 0, 0, function() {
        return "" + hFormat.apply(this) + zeroFill(this.minutes(), 2);
      });
      addFormatToken("hmmss", 0, 0, function() {
        return "" + hFormat.apply(this) + zeroFill(this.minutes(), 2) + zeroFill(this.seconds(), 2);
      });
      addFormatToken("Hmm", 0, 0, function() {
        return "" + this.hours() + zeroFill(this.minutes(), 2);
      });
      addFormatToken("Hmmss", 0, 0, function() {
        return "" + this.hours() + zeroFill(this.minutes(), 2) + zeroFill(this.seconds(), 2);
      });
      function meridiem(token2, lowercase) {
        addFormatToken(token2, 0, 0, function() {
          return this.localeData().meridiem(this.hours(), this.minutes(), lowercase);
        });
      }
      meridiem("a", true);
      meridiem("A", false);
      function matchMeridiem(isStrict, locale2) {
        return locale2._meridiemParse;
      }
      addRegexToken("a", matchMeridiem);
      addRegexToken("A", matchMeridiem);
      addRegexToken("H", match1to2, match1to2HasZero);
      addRegexToken("h", match1to2, match1to2NoLeadingZero);
      addRegexToken("k", match1to2, match1to2NoLeadingZero);
      addRegexToken("HH", match1to2, match2);
      addRegexToken("hh", match1to2, match2);
      addRegexToken("kk", match1to2, match2);
      addRegexToken("hmm", match3to4);
      addRegexToken("hmmss", match5to6);
      addRegexToken("Hmm", match3to4);
      addRegexToken("Hmmss", match5to6);
      addParseToken(["H", "HH"], HOUR);
      addParseToken(["k", "kk"], function(input, array, config) {
        var kInput = toInt(input);
        array[HOUR] = kInput === 24 ? 0 : kInput;
      });
      addParseToken(["a", "A"], function(input, array, config) {
        config._isPm = config._locale.isPM(input);
        config._meridiem = input;
      });
      addParseToken(["h", "hh"], function(input, array, config) {
        array[HOUR] = toInt(input);
        getParsingFlags(config).bigHour = true;
      });
      addParseToken("hmm", function(input, array, config) {
        var pos = input.length - 2;
        array[HOUR] = toInt(input.substr(0, pos));
        array[MINUTE] = toInt(input.substr(pos));
        getParsingFlags(config).bigHour = true;
      });
      addParseToken("hmmss", function(input, array, config) {
        var pos1 = input.length - 4, pos2 = input.length - 2;
        array[HOUR] = toInt(input.substr(0, pos1));
        array[MINUTE] = toInt(input.substr(pos1, 2));
        array[SECOND] = toInt(input.substr(pos2));
        getParsingFlags(config).bigHour = true;
      });
      addParseToken("Hmm", function(input, array, config) {
        var pos = input.length - 2;
        array[HOUR] = toInt(input.substr(0, pos));
        array[MINUTE] = toInt(input.substr(pos));
      });
      addParseToken("Hmmss", function(input, array, config) {
        var pos1 = input.length - 4, pos2 = input.length - 2;
        array[HOUR] = toInt(input.substr(0, pos1));
        array[MINUTE] = toInt(input.substr(pos1, 2));
        array[SECOND] = toInt(input.substr(pos2));
      });
      function localeIsPM(input) {
        return (input + "").toLowerCase().charAt(0) === "p";
      }
      var defaultLocaleMeridiemParse = /[ap]\.?m?\.?/i, getSetHour = makeGetSet("Hours", true);
      function localeMeridiem(hours2, minutes2, isLower) {
        if (hours2 > 11) {
          return isLower ? "pm" : "PM";
        } else {
          return isLower ? "am" : "AM";
        }
      }
      var baseConfig = {
        calendar: defaultCalendar,
        longDateFormat: defaultLongDateFormat,
        invalidDate: defaultInvalidDate,
        ordinal: defaultOrdinal,
        dayOfMonthOrdinalParse: defaultDayOfMonthOrdinalParse,
        relativeTime: defaultRelativeTime,
        months: defaultLocaleMonths,
        monthsShort: defaultLocaleMonthsShort,
        week: defaultLocaleWeek,
        weekdays: defaultLocaleWeekdays,
        weekdaysMin: defaultLocaleWeekdaysMin,
        weekdaysShort: defaultLocaleWeekdaysShort,
        meridiemParse: defaultLocaleMeridiemParse
      };
      var locales = {}, localeFamilies = {}, globalLocale;
      function commonPrefix(arr1, arr2) {
        var i, minl = Math.min(arr1.length, arr2.length);
        for (i = 0; i < minl; i += 1) {
          if (arr1[i] !== arr2[i]) {
            return i;
          }
        }
        return minl;
      }
      function normalizeLocale(key) {
        return key ? key.toLowerCase().replace("_", "-") : key;
      }
      function chooseLocale(names) {
        var i = 0, j, next, locale2, split;
        while (i < names.length) {
          split = normalizeLocale(names[i]).split("-");
          j = split.length;
          next = normalizeLocale(names[i + 1]);
          next = next ? next.split("-") : null;
          while (j > 0) {
            locale2 = loadLocale(split.slice(0, j).join("-"));
            if (locale2) {
              return locale2;
            }
            if (next && next.length >= j && commonPrefix(split, next) >= j - 1) {
              break;
            }
            j--;
          }
          i++;
        }
        return globalLocale;
      }
      function isLocaleNameSane(name) {
        return !!(name && name.match("^[^/\\\\]*$"));
      }
      function loadLocale(name) {
        var oldLocale = null, aliasedRequire;
        if (locales[name] === void 0 && typeof module !== "undefined" && module && module.exports && isLocaleNameSane(name)) {
          try {
            oldLocale = globalLocale._abbr;
            aliasedRequire = __require;
            aliasedRequire("./locale/" + name);
            getSetGlobalLocale(oldLocale);
          } catch (e) {
            locales[name] = null;
          }
        }
        return locales[name];
      }
      function getSetGlobalLocale(key, values) {
        var data;
        if (key) {
          if (isUndefined(values)) {
            data = getLocale(key);
          } else {
            data = defineLocale(key, values);
          }
          if (data) {
            globalLocale = data;
          } else {
            if (typeof console !== "undefined" && console.warn) {
              console.warn("Locale " + key + " not found. Did you forget to load it?");
            }
          }
        }
        return globalLocale._abbr;
      }
      function defineLocale(name, config) {
        if (config !== null) {
          var locale2, parentConfig = baseConfig;
          config.abbr = name;
          if (locales[name] != null) {
            deprecateSimple("defineLocaleOverride", "use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");
            parentConfig = locales[name]._config;
          } else if (config.parentLocale != null) {
            if (locales[config.parentLocale] != null) {
              parentConfig = locales[config.parentLocale]._config;
            } else {
              locale2 = loadLocale(config.parentLocale);
              if (locale2 != null) {
                parentConfig = locale2._config;
              } else {
                if (!localeFamilies[config.parentLocale]) {
                  localeFamilies[config.parentLocale] = [];
                }
                localeFamilies[config.parentLocale].push({
                  name,
                  config
                });
                return null;
              }
            }
          }
          locales[name] = new Locale(mergeConfigs(parentConfig, config));
          if (localeFamilies[name]) {
            localeFamilies[name].forEach(function(x) {
              defineLocale(x.name, x.config);
            });
          }
          getSetGlobalLocale(name);
          return locales[name];
        } else {
          delete locales[name];
          return null;
        }
      }
      function updateLocale(name, config) {
        if (config != null) {
          var locale2, tmpLocale, parentConfig = baseConfig;
          if (locales[name] != null && locales[name].parentLocale != null) {
            locales[name].set(mergeConfigs(locales[name]._config, config));
          } else {
            tmpLocale = loadLocale(name);
            if (tmpLocale != null) {
              parentConfig = tmpLocale._config;
            }
            config = mergeConfigs(parentConfig, config);
            if (tmpLocale == null) {
              config.abbr = name;
            }
            locale2 = new Locale(config);
            locale2.parentLocale = locales[name];
            locales[name] = locale2;
          }
          getSetGlobalLocale(name);
        } else {
          if (locales[name] != null) {
            if (locales[name].parentLocale != null) {
              locales[name] = locales[name].parentLocale;
              if (name === getSetGlobalLocale()) {
                getSetGlobalLocale(name);
              }
            } else if (locales[name] != null) {
              delete locales[name];
            }
          }
        }
        return locales[name];
      }
      function getLocale(key) {
        var locale2;
        if (key && key._locale && key._locale._abbr) {
          key = key._locale._abbr;
        }
        if (!key) {
          return globalLocale;
        }
        if (!isArray(key)) {
          locale2 = loadLocale(key);
          if (locale2) {
            return locale2;
          }
          key = [key];
        }
        return chooseLocale(key);
      }
      function listLocales() {
        return keys2(locales);
      }
      function checkOverflow(m) {
        var overflow, a = m._a;
        if (a && getParsingFlags(m).overflow === -2) {
          overflow = a[MONTH] < 0 || a[MONTH] > 11 ? MONTH : a[DATE] < 1 || a[DATE] > daysInMonth(a[YEAR], a[MONTH]) ? DATE : a[HOUR] < 0 || a[HOUR] > 24 || a[HOUR] === 24 && (a[MINUTE] !== 0 || a[SECOND] !== 0 || a[MILLISECOND] !== 0) ? HOUR : a[MINUTE] < 0 || a[MINUTE] > 59 ? MINUTE : a[SECOND] < 0 || a[SECOND] > 59 ? SECOND : a[MILLISECOND] < 0 || a[MILLISECOND] > 999 ? MILLISECOND : -1;
          if (getParsingFlags(m)._overflowDayOfYear && (overflow < YEAR || overflow > DATE)) {
            overflow = DATE;
          }
          if (getParsingFlags(m)._overflowWeeks && overflow === -1) {
            overflow = WEEK;
          }
          if (getParsingFlags(m)._overflowWeekday && overflow === -1) {
            overflow = WEEKDAY;
          }
          getParsingFlags(m).overflow = overflow;
        }
        return m;
      }
      var extendedIsoRegex = /^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/, basicIsoRegex = /^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/, tzRegex = /Z|[+-]\d\d(?::?\d\d)?/, isoDates = [["YYYYYY-MM-DD", /[+-]\d{6}-\d\d-\d\d/], ["YYYY-MM-DD", /\d{4}-\d\d-\d\d/], ["GGGG-[W]WW-E", /\d{4}-W\d\d-\d/], ["GGGG-[W]WW", /\d{4}-W\d\d/, false], ["YYYY-DDD", /\d{4}-\d{3}/], ["YYYY-MM", /\d{4}-\d\d/, false], ["YYYYYYMMDD", /[+-]\d{10}/], ["YYYYMMDD", /\d{8}/], ["GGGG[W]WWE", /\d{4}W\d{3}/], ["GGGG[W]WW", /\d{4}W\d{2}/, false], ["YYYYDDD", /\d{7}/], ["YYYYMM", /\d{6}/, false], ["YYYY", /\d{4}/, false]], isoTimes = [["HH:mm:ss.SSSS", /\d\d:\d\d:\d\d\.\d+/], ["HH:mm:ss,SSSS", /\d\d:\d\d:\d\d,\d+/], ["HH:mm:ss", /\d\d:\d\d:\d\d/], ["HH:mm", /\d\d:\d\d/], ["HHmmss.SSSS", /\d\d\d\d\d\d\.\d+/], ["HHmmss,SSSS", /\d\d\d\d\d\d,\d+/], ["HHmmss", /\d\d\d\d\d\d/], ["HHmm", /\d\d\d\d/], ["HH", /\d\d/]], aspNetJsonRegex = /^\/?Date\((-?\d+)/i, rfc2822 = /^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/, obsOffsets = {
        UT: 0,
        GMT: 0,
        EDT: -4 * 60,
        EST: -5 * 60,
        CDT: -5 * 60,
        CST: -6 * 60,
        MDT: -6 * 60,
        MST: -7 * 60,
        PDT: -7 * 60,
        PST: -8 * 60
      };
      function configFromISO(config) {
        var i, l, string = config._i, match = extendedIsoRegex.exec(string) || basicIsoRegex.exec(string), allowTime, dateFormat, timeFormat, tzFormat, isoDatesLen = isoDates.length, isoTimesLen = isoTimes.length;
        if (match) {
          getParsingFlags(config).iso = true;
          for (i = 0, l = isoDatesLen; i < l; i++) {
            if (isoDates[i][1].exec(match[1])) {
              dateFormat = isoDates[i][0];
              allowTime = isoDates[i][2] !== false;
              break;
            }
          }
          if (dateFormat == null) {
            config._isValid = false;
            return;
          }
          if (match[3]) {
            for (i = 0, l = isoTimesLen; i < l; i++) {
              if (isoTimes[i][1].exec(match[3])) {
                timeFormat = (match[2] || " ") + isoTimes[i][0];
                break;
              }
            }
            if (timeFormat == null) {
              config._isValid = false;
              return;
            }
          }
          if (!allowTime && timeFormat != null) {
            config._isValid = false;
            return;
          }
          if (match[4]) {
            if (tzRegex.exec(match[4])) {
              tzFormat = "Z";
            } else {
              config._isValid = false;
              return;
            }
          }
          config._f = dateFormat + (timeFormat || "") + (tzFormat || "");
          configFromStringAndFormat(config);
        } else {
          config._isValid = false;
        }
      }
      function extractFromRFC2822Strings(yearStr, monthStr, dayStr, hourStr, minuteStr, secondStr) {
        var result = [untruncateYear(yearStr), defaultLocaleMonthsShort.indexOf(monthStr), parseInt(dayStr, 10), parseInt(hourStr, 10), parseInt(minuteStr, 10)];
        if (secondStr) {
          result.push(parseInt(secondStr, 10));
        }
        return result;
      }
      function untruncateYear(yearStr) {
        var year = parseInt(yearStr, 10);
        if (year <= 49) {
          return 2e3 + year;
        } else if (year <= 999) {
          return 1900 + year;
        }
        return year;
      }
      function preprocessRFC2822(s) {
        return s.replace(/\([^()]*\)|[\n\t]/g, " ").replace(/(\s\s+)/g, " ").replace(/^\s\s*/, "").replace(/\s\s*$/, "");
      }
      function checkWeekday(weekdayStr, parsedInput, config) {
        if (weekdayStr) {
          var weekdayProvided = defaultLocaleWeekdaysShort.indexOf(weekdayStr), weekdayActual = new Date(parsedInput[0], parsedInput[1], parsedInput[2]).getDay();
          if (weekdayProvided !== weekdayActual) {
            getParsingFlags(config).weekdayMismatch = true;
            config._isValid = false;
            return false;
          }
        }
        return true;
      }
      function calculateOffset(obsOffset, militaryOffset, numOffset) {
        if (obsOffset) {
          return obsOffsets[obsOffset];
        } else if (militaryOffset) {
          return 0;
        } else {
          var hm = parseInt(numOffset, 10), m = hm % 100, h = (hm - m) / 100;
          return h * 60 + m;
        }
      }
      function configFromRFC2822(config) {
        var match = rfc2822.exec(preprocessRFC2822(config._i)), parsedArray;
        if (match) {
          parsedArray = extractFromRFC2822Strings(match[4], match[3], match[2], match[5], match[6], match[7]);
          if (!checkWeekday(match[1], parsedArray, config)) {
            return;
          }
          config._a = parsedArray;
          config._tzm = calculateOffset(match[8], match[9], match[10]);
          config._d = createUTCDate.apply(null, config._a);
          config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);
          getParsingFlags(config).rfc2822 = true;
        } else {
          config._isValid = false;
        }
      }
      function configFromString(config) {
        var matched = aspNetJsonRegex.exec(config._i);
        if (matched !== null) {
          config._d = /* @__PURE__ */ new Date(+matched[1]);
          return;
        }
        configFromISO(config);
        if (config._isValid === false) {
          delete config._isValid;
        } else {
          return;
        }
        configFromRFC2822(config);
        if (config._isValid === false) {
          delete config._isValid;
        } else {
          return;
        }
        if (config._strict) {
          config._isValid = false;
        } else {
          hooks.createFromInputFallback(config);
        }
      }
      hooks.createFromInputFallback = deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.", function(config) {
        config._d = /* @__PURE__ */ new Date(config._i + (config._useUTC ? " UTC" : ""));
      });
      function defaults(a, b, c) {
        if (a != null) {
          return a;
        }
        if (b != null) {
          return b;
        }
        return c;
      }
      function currentDateArray(config) {
        var nowValue = new Date(hooks.now());
        if (config._useUTC) {
          return [nowValue.getUTCFullYear(), nowValue.getUTCMonth(), nowValue.getUTCDate()];
        }
        return [nowValue.getFullYear(), nowValue.getMonth(), nowValue.getDate()];
      }
      function configFromArray(config) {
        var i, date, input = [], currentDate, expectedWeekday, yearToUse;
        if (config._d) {
          return;
        }
        currentDate = currentDateArray(config);
        if (config._w && config._a[DATE] == null && config._a[MONTH] == null) {
          dayOfYearFromWeekInfo(config);
        }
        if (config._dayOfYear != null) {
          yearToUse = defaults(config._a[YEAR], currentDate[YEAR]);
          if (config._dayOfYear > daysInYear(yearToUse) || config._dayOfYear === 0) {
            getParsingFlags(config)._overflowDayOfYear = true;
          }
          date = createUTCDate(yearToUse, 0, config._dayOfYear);
          config._a[MONTH] = date.getUTCMonth();
          config._a[DATE] = date.getUTCDate();
        }
        for (i = 0; i < 3 && config._a[i] == null; ++i) {
          config._a[i] = input[i] = currentDate[i];
        }
        for (; i < 7; i++) {
          config._a[i] = input[i] = config._a[i] == null ? i === 2 ? 1 : 0 : config._a[i];
        }
        if (config._a[HOUR] === 24 && config._a[MINUTE] === 0 && config._a[SECOND] === 0 && config._a[MILLISECOND] === 0) {
          config._nextDay = true;
          config._a[HOUR] = 0;
        }
        config._d = (config._useUTC ? createUTCDate : createDate).apply(null, input);
        expectedWeekday = config._useUTC ? config._d.getUTCDay() : config._d.getDay();
        if (config._tzm != null) {
          config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);
        }
        if (config._nextDay) {
          config._a[HOUR] = 24;
        }
        if (config._w && typeof config._w.d !== "undefined" && config._w.d !== expectedWeekday) {
          getParsingFlags(config).weekdayMismatch = true;
        }
      }
      function dayOfYearFromWeekInfo(config) {
        var w, weekYear, week, weekday, dow, doy, temp, weekdayOverflow, curWeek;
        w = config._w;
        if (w.GG != null || w.W != null || w.E != null) {
          dow = 1;
          doy = 4;
          weekYear = defaults(w.GG, config._a[YEAR], weekOfYear(createLocal(), 1, 4).year);
          week = defaults(w.W, 1);
          weekday = defaults(w.E, 1);
          if (weekday < 1 || weekday > 7) {
            weekdayOverflow = true;
          }
        } else {
          dow = config._locale._week.dow;
          doy = config._locale._week.doy;
          curWeek = weekOfYear(createLocal(), dow, doy);
          weekYear = defaults(w.gg, config._a[YEAR], curWeek.year);
          week = defaults(w.w, curWeek.week);
          if (w.d != null) {
            weekday = w.d;
            if (weekday < 0 || weekday > 6) {
              weekdayOverflow = true;
            }
          } else if (w.e != null) {
            weekday = w.e + dow;
            if (w.e < 0 || w.e > 6) {
              weekdayOverflow = true;
            }
          } else {
            weekday = dow;
          }
        }
        if (week < 1 || week > weeksInYear(weekYear, dow, doy)) {
          getParsingFlags(config)._overflowWeeks = true;
        } else if (weekdayOverflow != null) {
          getParsingFlags(config)._overflowWeekday = true;
        } else {
          temp = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy);
          config._a[YEAR] = temp.year;
          config._dayOfYear = temp.dayOfYear;
        }
      }
      hooks.ISO_8601 = function() {
      };
      hooks.RFC_2822 = function() {
      };
      function configFromStringAndFormat(config) {
        if (config._f === hooks.ISO_8601) {
          configFromISO(config);
          return;
        }
        if (config._f === hooks.RFC_2822) {
          configFromRFC2822(config);
          return;
        }
        config._a = [];
        getParsingFlags(config).empty = true;
        var string = "" + config._i, i, parsedInput, tokens2, token2, skipped, stringLength = string.length, totalParsedInputLength = 0, era, tokenLen;
        tokens2 = expandFormat(config._f, config._locale).match(formattingTokens) || [];
        tokenLen = tokens2.length;
        for (i = 0; i < tokenLen; i++) {
          token2 = tokens2[i];
          parsedInput = (string.match(getParseRegexForToken(token2, config)) || [])[0];
          if (parsedInput) {
            skipped = string.substr(0, string.indexOf(parsedInput));
            if (skipped.length > 0) {
              getParsingFlags(config).unusedInput.push(skipped);
            }
            string = string.slice(string.indexOf(parsedInput) + parsedInput.length);
            totalParsedInputLength += parsedInput.length;
          }
          if (formatTokenFunctions[token2]) {
            if (parsedInput) {
              getParsingFlags(config).empty = false;
            } else {
              getParsingFlags(config).unusedTokens.push(token2);
            }
            addTimeToArrayFromToken(token2, parsedInput, config);
          } else if (config._strict && !parsedInput) {
            getParsingFlags(config).unusedTokens.push(token2);
          }
        }
        getParsingFlags(config).charsLeftOver = stringLength - totalParsedInputLength;
        if (string.length > 0) {
          getParsingFlags(config).unusedInput.push(string);
        }
        if (config._a[HOUR] <= 12 && getParsingFlags(config).bigHour === true && config._a[HOUR] > 0) {
          getParsingFlags(config).bigHour = void 0;
        }
        getParsingFlags(config).parsedDateParts = config._a.slice(0);
        getParsingFlags(config).meridiem = config._meridiem;
        config._a[HOUR] = meridiemFixWrap(config._locale, config._a[HOUR], config._meridiem);
        era = getParsingFlags(config).era;
        if (era !== null) {
          config._a[YEAR] = config._locale.erasConvertYear(era, config._a[YEAR]);
        }
        configFromArray(config);
        checkOverflow(config);
      }
      function meridiemFixWrap(locale2, hour, meridiem2) {
        var isPm;
        if (meridiem2 == null) {
          return hour;
        }
        if (locale2.meridiemHour != null) {
          return locale2.meridiemHour(hour, meridiem2);
        } else if (locale2.isPM != null) {
          isPm = locale2.isPM(meridiem2);
          if (isPm && hour < 12) {
            hour += 12;
          }
          if (!isPm && hour === 12) {
            hour = 0;
          }
          return hour;
        } else {
          return hour;
        }
      }
      function configFromStringAndArray(config) {
        var tempConfig, bestMoment, scoreToBeat, i, currentScore, validFormatFound, bestFormatIsValid = false, configfLen = config._f.length;
        if (configfLen === 0) {
          getParsingFlags(config).invalidFormat = true;
          config._d = /* @__PURE__ */ new Date(NaN);
          return;
        }
        for (i = 0; i < configfLen; i++) {
          currentScore = 0;
          validFormatFound = false;
          tempConfig = copyConfig({}, config);
          if (config._useUTC != null) {
            tempConfig._useUTC = config._useUTC;
          }
          tempConfig._f = config._f[i];
          configFromStringAndFormat(tempConfig);
          if (isValid(tempConfig)) {
            validFormatFound = true;
          }
          currentScore += getParsingFlags(tempConfig).charsLeftOver;
          currentScore += getParsingFlags(tempConfig).unusedTokens.length * 10;
          getParsingFlags(tempConfig).score = currentScore;
          if (!bestFormatIsValid) {
            if (scoreToBeat == null || currentScore < scoreToBeat || validFormatFound) {
              scoreToBeat = currentScore;
              bestMoment = tempConfig;
              if (validFormatFound) {
                bestFormatIsValid = true;
              }
            }
          } else {
            if (currentScore < scoreToBeat) {
              scoreToBeat = currentScore;
              bestMoment = tempConfig;
            }
          }
        }
        extend(config, bestMoment || tempConfig);
      }
      function configFromObject(config) {
        if (config._d) {
          return;
        }
        var i = normalizeObjectUnits(config._i), dayOrDate = i.day === void 0 ? i.date : i.day;
        config._a = map2([i.year, i.month, dayOrDate, i.hour, i.minute, i.second, i.millisecond], function(obj) {
          return obj && parseInt(obj, 10);
        });
        configFromArray(config);
      }
      function createFromConfig(config) {
        var res = new Moment(checkOverflow(prepareConfig(config)));
        if (res._nextDay) {
          res.add(1, "d");
          res._nextDay = void 0;
        }
        return res;
      }
      function prepareConfig(config) {
        var input = config._i, format2 = config._f;
        config._locale = config._locale || getLocale(config._l);
        if (input === null || format2 === void 0 && input === "") {
          return createInvalid({
            nullInput: true
          });
        }
        if (typeof input === "string") {
          config._i = input = config._locale.preparse(input);
        }
        if (isMoment(input)) {
          return new Moment(checkOverflow(input));
        } else if (isDate(input)) {
          config._d = input;
        } else if (isArray(format2)) {
          configFromStringAndArray(config);
        } else if (format2) {
          configFromStringAndFormat(config);
        } else {
          configFromInput(config);
        }
        if (!isValid(config)) {
          config._d = null;
        }
        return config;
      }
      function configFromInput(config) {
        var input = config._i;
        if (isUndefined(input)) {
          config._d = new Date(hooks.now());
        } else if (isDate(input)) {
          config._d = new Date(input.valueOf());
        } else if (typeof input === "string") {
          configFromString(config);
        } else if (isArray(input)) {
          config._a = map2(input.slice(0), function(obj) {
            return parseInt(obj, 10);
          });
          configFromArray(config);
        } else if (isObject(input)) {
          configFromObject(config);
        } else if (isNumber(input)) {
          config._d = new Date(input);
        } else {
          hooks.createFromInputFallback(config);
        }
      }
      function createLocalOrUTC(input, format2, locale2, strict, isUTC) {
        var c = {};
        if (format2 === true || format2 === false) {
          strict = format2;
          format2 = void 0;
        }
        if (locale2 === true || locale2 === false) {
          strict = locale2;
          locale2 = void 0;
        }
        if (isObject(input) && isObjectEmpty(input) || isArray(input) && input.length === 0) {
          input = void 0;
        }
        c._isAMomentObject = true;
        c._useUTC = c._isUTC = isUTC;
        c._l = locale2;
        c._i = input;
        c._f = format2;
        c._strict = strict;
        return createFromConfig(c);
      }
      function createLocal(input, format2, locale2, strict) {
        return createLocalOrUTC(input, format2, locale2, strict, false);
      }
      var prototypeMin = deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/", function() {
        var other = createLocal.apply(null, arguments);
        if (this.isValid() && other.isValid()) {
          return other < this ? this : other;
        } else {
          return createInvalid();
        }
      }), prototypeMax = deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/", function() {
        var other = createLocal.apply(null, arguments);
        if (this.isValid() && other.isValid()) {
          return other > this ? this : other;
        } else {
          return createInvalid();
        }
      });
      function pickBy(fn, moments) {
        var res, i;
        if (moments.length === 1 && isArray(moments[0])) {
          moments = moments[0];
        }
        if (!moments.length) {
          return createLocal();
        }
        res = moments[0];
        for (i = 1; i < moments.length; ++i) {
          if (!moments[i].isValid() || moments[i][fn](res)) {
            res = moments[i];
          }
        }
        return res;
      }
      function min() {
        var args = [].slice.call(arguments, 0);
        return pickBy("isBefore", args);
      }
      function max() {
        var args = [].slice.call(arguments, 0);
        return pickBy("isAfter", args);
      }
      var now = function() {
        return Date.now ? Date.now() : +/* @__PURE__ */ new Date();
      };
      var ordering = ["year", "quarter", "month", "week", "day", "hour", "minute", "second", "millisecond"];
      function isDurationValid(m) {
        var key, unitHasDecimal = false, i, orderLen = ordering.length;
        for (key in m) {
          if (hasOwnProp(m, key) && !(indexOf.call(ordering, key) !== -1 && (m[key] == null || !isNaN(m[key])))) {
            return false;
          }
        }
        for (i = 0; i < orderLen; ++i) {
          if (m[ordering[i]]) {
            if (unitHasDecimal) {
              return false;
            }
            if (parseFloat(m[ordering[i]]) !== toInt(m[ordering[i]])) {
              unitHasDecimal = true;
            }
          }
        }
        return true;
      }
      function isValid$1() {
        return this._isValid;
      }
      function createInvalid$1() {
        return createDuration(NaN);
      }
      function Duration(duration) {
        var normalizedInput = normalizeObjectUnits(duration), years2 = normalizedInput.year || 0, quarters = normalizedInput.quarter || 0, months3 = normalizedInput.month || 0, weeks2 = normalizedInput.week || normalizedInput.isoWeek || 0, days3 = normalizedInput.day || 0, hours2 = normalizedInput.hour || 0, minutes2 = normalizedInput.minute || 0, seconds2 = normalizedInput.second || 0, milliseconds2 = normalizedInput.millisecond || 0;
        this._isValid = isDurationValid(normalizedInput);
        this._milliseconds = +milliseconds2 + seconds2 * 1e3 + // 1000
        minutes2 * 6e4 + // 1000 * 60
        hours2 * 1e3 * 60 * 60;
        this._days = +days3 + weeks2 * 7;
        this._months = +months3 + quarters * 3 + years2 * 12;
        this._data = {};
        this._locale = getLocale();
        this._bubble();
      }
      function isDuration(obj) {
        return obj instanceof Duration;
      }
      function absRound(number) {
        if (number < 0) {
          return Math.round(-1 * number) * -1;
        } else {
          return Math.round(number);
        }
      }
      function compareArrays(array1, array2, dontConvert) {
        var len = Math.min(array1.length, array2.length), lengthDiff = Math.abs(array1.length - array2.length), diffs = 0, i;
        for (i = 0; i < len; i++) {
          if (dontConvert && array1[i] !== array2[i] || !dontConvert && toInt(array1[i]) !== toInt(array2[i])) {
            diffs++;
          }
        }
        return diffs + lengthDiff;
      }
      function offset(token2, separator) {
        addFormatToken(token2, 0, 0, function() {
          var offset2 = this.utcOffset(), sign2 = "+";
          if (offset2 < 0) {
            offset2 = -offset2;
            sign2 = "-";
          }
          return sign2 + zeroFill(~~(offset2 / 60), 2) + separator + zeroFill(~~offset2 % 60, 2);
        });
      }
      offset("Z", ":");
      offset("ZZ", "");
      addRegexToken("Z", matchShortOffset);
      addRegexToken("ZZ", matchShortOffset);
      addParseToken(["Z", "ZZ"], function(input, array, config) {
        config._useUTC = true;
        config._tzm = offsetFromString(matchShortOffset, input);
      });
      var chunkOffset = /([\+\-]|\d\d)/gi;
      function offsetFromString(matcher, string) {
        var matches = (string || "").match(matcher), chunk, parts, minutes2;
        if (matches === null) {
          return null;
        }
        chunk = matches[matches.length - 1] || [];
        parts = (chunk + "").match(chunkOffset) || ["-", 0, 0];
        minutes2 = +(parts[1] * 60) + toInt(parts[2]);
        return minutes2 === 0 ? 0 : parts[0] === "+" ? minutes2 : -minutes2;
      }
      function cloneWithOffset(input, model) {
        var res, diff2;
        if (model._isUTC) {
          res = model.clone();
          diff2 = (isMoment(input) || isDate(input) ? input.valueOf() : createLocal(input).valueOf()) - res.valueOf();
          res._d.setTime(res._d.valueOf() + diff2);
          hooks.updateOffset(res, false);
          return res;
        } else {
          return createLocal(input).local();
        }
      }
      function getDateOffset(m) {
        return -Math.round(m._d.getTimezoneOffset());
      }
      hooks.updateOffset = function() {
      };
      function getSetOffset(input, keepLocalTime, keepMinutes) {
        var offset2 = this._offset || 0, localAdjust;
        if (!this.isValid()) {
          return input != null ? this : NaN;
        }
        if (input != null) {
          if (typeof input === "string") {
            input = offsetFromString(matchShortOffset, input);
            if (input === null) {
              return this;
            }
          } else if (Math.abs(input) < 16 && !keepMinutes) {
            input = input * 60;
          }
          if (!this._isUTC && keepLocalTime) {
            localAdjust = getDateOffset(this);
          }
          this._offset = input;
          this._isUTC = true;
          if (localAdjust != null) {
            this.add(localAdjust, "m");
          }
          if (offset2 !== input) {
            if (!keepLocalTime || this._changeInProgress) {
              addSubtract(this, createDuration(input - offset2, "m"), 1, false);
            } else if (!this._changeInProgress) {
              this._changeInProgress = true;
              hooks.updateOffset(this, true);
              this._changeInProgress = null;
            }
          }
          return this;
        } else {
          return this._isUTC ? offset2 : getDateOffset(this);
        }
      }
      function getSetZone(input, keepLocalTime) {
        if (input != null) {
          if (typeof input !== "string") {
            input = -input;
          }
          this.utcOffset(input, keepLocalTime);
          return this;
        } else {
          return -this.utcOffset();
        }
      }
      function setOffsetToUTC(keepLocalTime) {
        return this.utcOffset(0, keepLocalTime);
      }
      function setOffsetToLocal(keepLocalTime) {
        if (this._isUTC) {
          this.utcOffset(0, keepLocalTime);
          this._isUTC = false;
          if (keepLocalTime) {
            this.subtract(getDateOffset(this), "m");
          }
        }
        return this;
      }
      function setOffsetToParsedOffset() {
        if (this._tzm != null) {
          this.utcOffset(this._tzm, false, true);
        } else if (typeof this._i === "string") {
          var tZone = offsetFromString(matchOffset, this._i);
          if (tZone != null) {
            this.utcOffset(tZone);
          } else {
            this.utcOffset(0, true);
          }
        }
        return this;
      }
      function hasAlignedHourOffset(input) {
        if (!this.isValid()) {
          return false;
        }
        input = input ? createLocal(input).utcOffset() : 0;
        return (this.utcOffset() - input) % 60 === 0;
      }
      function isDaylightSavingTime() {
        return this.utcOffset() > this.clone().month(0).utcOffset() || this.utcOffset() > this.clone().month(5).utcOffset();
      }
      function isDaylightSavingTimeShifted() {
        if (!isUndefined(this._isDSTShifted)) {
          return this._isDSTShifted;
        }
        var c = {}, other;
        copyConfig(c, this);
        c = prepareConfig(c);
        if (c._a) {
          other = c._isUTC ? createUTC(c._a) : createLocal(c._a);
          this._isDSTShifted = this.isValid() && compareArrays(c._a, other.toArray()) > 0;
        } else {
          this._isDSTShifted = false;
        }
        return this._isDSTShifted;
      }
      function isLocal() {
        return this.isValid() ? !this._isUTC : false;
      }
      function isUtcOffset() {
        return this.isValid() ? this._isUTC : false;
      }
      function isUtc() {
        return this.isValid() ? this._isUTC && this._offset === 0 : false;
      }
      var aspNetRegex = /^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/, isoRegex = /^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;
      function createDuration(input, key) {
        var duration = input, match = null, sign2, ret, diffRes;
        if (isDuration(input)) {
          duration = {
            ms: input._milliseconds,
            d: input._days,
            M: input._months
          };
        } else if (isNumber(input) || !isNaN(+input)) {
          duration = {};
          if (key) {
            duration[key] = +input;
          } else {
            duration.milliseconds = +input;
          }
        } else if (match = aspNetRegex.exec(input)) {
          sign2 = match[1] === "-" ? -1 : 1;
          duration = {
            y: 0,
            d: toInt(match[DATE]) * sign2,
            h: toInt(match[HOUR]) * sign2,
            m: toInt(match[MINUTE]) * sign2,
            s: toInt(match[SECOND]) * sign2,
            ms: toInt(absRound(match[MILLISECOND] * 1e3)) * sign2
            // the millisecond decimal point is included in the match
          };
        } else if (match = isoRegex.exec(input)) {
          sign2 = match[1] === "-" ? -1 : 1;
          duration = {
            y: parseIso(match[2], sign2),
            M: parseIso(match[3], sign2),
            w: parseIso(match[4], sign2),
            d: parseIso(match[5], sign2),
            h: parseIso(match[6], sign2),
            m: parseIso(match[7], sign2),
            s: parseIso(match[8], sign2)
          };
        } else if (duration == null) {
          duration = {};
        } else if (typeof duration === "object" && ("from" in duration || "to" in duration)) {
          diffRes = momentsDifference(createLocal(duration.from), createLocal(duration.to));
          duration = {};
          duration.ms = diffRes.milliseconds;
          duration.M = diffRes.months;
        }
        ret = new Duration(duration);
        if (isDuration(input) && hasOwnProp(input, "_locale")) {
          ret._locale = input._locale;
        }
        if (isDuration(input) && hasOwnProp(input, "_isValid")) {
          ret._isValid = input._isValid;
        }
        return ret;
      }
      createDuration.fn = Duration.prototype;
      createDuration.invalid = createInvalid$1;
      function parseIso(inp, sign2) {
        var res = inp && parseFloat(inp.replace(",", "."));
        return (isNaN(res) ? 0 : res) * sign2;
      }
      function positiveMomentsDifference(base, other) {
        var res = {};
        res.months = other.month() - base.month() + (other.year() - base.year()) * 12;
        if (base.clone().add(res.months, "M").isAfter(other)) {
          --res.months;
        }
        res.milliseconds = +other - +base.clone().add(res.months, "M");
        return res;
      }
      function momentsDifference(base, other) {
        var res;
        if (!(base.isValid() && other.isValid())) {
          return {
            milliseconds: 0,
            months: 0
          };
        }
        other = cloneWithOffset(other, base);
        if (base.isBefore(other)) {
          res = positiveMomentsDifference(base, other);
        } else {
          res = positiveMomentsDifference(other, base);
          res.milliseconds = -res.milliseconds;
          res.months = -res.months;
        }
        return res;
      }
      function createAdder(direction, name) {
        return function(val, period) {
          var dur, tmp;
          if (period !== null && !isNaN(+period)) {
            deprecateSimple(name, "moment()." + name + "(period, number) is deprecated. Please use moment()." + name + "(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");
            tmp = val;
            val = period;
            period = tmp;
          }
          dur = createDuration(val, period);
          addSubtract(this, dur, direction);
          return this;
        };
      }
      function addSubtract(mom, duration, isAdding, updateOffset) {
        var milliseconds2 = duration._milliseconds, days3 = absRound(duration._days), months3 = absRound(duration._months);
        if (!mom.isValid()) {
          return;
        }
        updateOffset = updateOffset == null ? true : updateOffset;
        if (months3) {
          setMonth(mom, get(mom, "Month") + months3 * isAdding);
        }
        if (days3) {
          set$1(mom, "Date", get(mom, "Date") + days3 * isAdding);
        }
        if (milliseconds2) {
          mom._d.setTime(mom._d.valueOf() + milliseconds2 * isAdding);
        }
        if (updateOffset) {
          hooks.updateOffset(mom, days3 || months3);
        }
      }
      var add = createAdder(1, "add"), subtract = createAdder(-1, "subtract");
      function isString(input) {
        return typeof input === "string" || input instanceof String;
      }
      function isMomentInput(input) {
        return isMoment(input) || isDate(input) || isString(input) || isNumber(input) || isNumberOrStringArray(input) || isMomentInputObject(input) || input === null || input === void 0;
      }
      function isMomentInputObject(input) {
        var objectTest = isObject(input) && !isObjectEmpty(input), propertyTest = false, properties = ["years", "year", "y", "months", "month", "M", "days", "day", "d", "dates", "date", "D", "hours", "hour", "h", "minutes", "minute", "m", "seconds", "second", "s", "milliseconds", "millisecond", "ms"], i, property, propertyLen = properties.length;
        for (i = 0; i < propertyLen; i += 1) {
          property = properties[i];
          propertyTest = propertyTest || hasOwnProp(input, property);
        }
        return objectTest && propertyTest;
      }
      function isNumberOrStringArray(input) {
        var arrayTest = isArray(input), dataTypeTest = false;
        if (arrayTest) {
          dataTypeTest = input.filter(function(item) {
            return !isNumber(item) && isString(input);
          }).length === 0;
        }
        return arrayTest && dataTypeTest;
      }
      function isCalendarSpec(input) {
        var objectTest = isObject(input) && !isObjectEmpty(input), propertyTest = false, properties = ["sameDay", "nextDay", "lastDay", "nextWeek", "lastWeek", "sameElse"], i, property;
        for (i = 0; i < properties.length; i += 1) {
          property = properties[i];
          propertyTest = propertyTest || hasOwnProp(input, property);
        }
        return objectTest && propertyTest;
      }
      function getCalendarFormat(myMoment, now2) {
        var diff2 = myMoment.diff(now2, "days", true);
        return diff2 < -6 ? "sameElse" : diff2 < -1 ? "lastWeek" : diff2 < 0 ? "lastDay" : diff2 < 1 ? "sameDay" : diff2 < 2 ? "nextDay" : diff2 < 7 ? "nextWeek" : "sameElse";
      }
      function calendar$1(time, formats) {
        if (arguments.length === 1) {
          if (!arguments[0]) {
            time = void 0;
            formats = void 0;
          } else if (isMomentInput(arguments[0])) {
            time = arguments[0];
            formats = void 0;
          } else if (isCalendarSpec(arguments[0])) {
            formats = arguments[0];
            time = void 0;
          }
        }
        var now2 = time || createLocal(), sod = cloneWithOffset(now2, this).startOf("day"), format2 = hooks.calendarFormat(this, sod) || "sameElse", output = formats && (isFunction(formats[format2]) ? formats[format2].call(this, now2) : formats[format2]);
        return this.format(output || this.localeData().calendar(format2, this, createLocal(now2)));
      }
      function clone() {
        return new Moment(this);
      }
      function isAfter(input, units) {
        var localInput = isMoment(input) ? input : createLocal(input);
        if (!(this.isValid() && localInput.isValid())) {
          return false;
        }
        units = normalizeUnits(units) || "millisecond";
        if (units === "millisecond") {
          return this.valueOf() > localInput.valueOf();
        } else {
          return localInput.valueOf() < this.clone().startOf(units).valueOf();
        }
      }
      function isBefore(input, units) {
        var localInput = isMoment(input) ? input : createLocal(input);
        if (!(this.isValid() && localInput.isValid())) {
          return false;
        }
        units = normalizeUnits(units) || "millisecond";
        if (units === "millisecond") {
          return this.valueOf() < localInput.valueOf();
        } else {
          return this.clone().endOf(units).valueOf() < localInput.valueOf();
        }
      }
      function isBetween(from3, to2, units, inclusivity) {
        var localFrom = isMoment(from3) ? from3 : createLocal(from3), localTo = isMoment(to2) ? to2 : createLocal(to2);
        if (!(this.isValid() && localFrom.isValid() && localTo.isValid())) {
          return false;
        }
        inclusivity = inclusivity || "()";
        return (inclusivity[0] === "(" ? this.isAfter(localFrom, units) : !this.isBefore(localFrom, units)) && (inclusivity[1] === ")" ? this.isBefore(localTo, units) : !this.isAfter(localTo, units));
      }
      function isSame(input, units) {
        var localInput = isMoment(input) ? input : createLocal(input), inputMs;
        if (!(this.isValid() && localInput.isValid())) {
          return false;
        }
        units = normalizeUnits(units) || "millisecond";
        if (units === "millisecond") {
          return this.valueOf() === localInput.valueOf();
        } else {
          inputMs = localInput.valueOf();
          return this.clone().startOf(units).valueOf() <= inputMs && inputMs <= this.clone().endOf(units).valueOf();
        }
      }
      function isSameOrAfter(input, units) {
        return this.isSame(input, units) || this.isAfter(input, units);
      }
      function isSameOrBefore(input, units) {
        return this.isSame(input, units) || this.isBefore(input, units);
      }
      function diff(input, units, asFloat) {
        var that, zoneDelta, output;
        if (!this.isValid()) {
          return NaN;
        }
        that = cloneWithOffset(input, this);
        if (!that.isValid()) {
          return NaN;
        }
        zoneDelta = (that.utcOffset() - this.utcOffset()) * 6e4;
        units = normalizeUnits(units);
        switch (units) {
          case "year":
            output = monthDiff(this, that) / 12;
            break;
          case "month":
            output = monthDiff(this, that);
            break;
          case "quarter":
            output = monthDiff(this, that) / 3;
            break;
          case "second":
            output = (this - that) / 1e3;
            break;
          // 1000
          case "minute":
            output = (this - that) / 6e4;
            break;
          // 1000 * 60
          case "hour":
            output = (this - that) / 36e5;
            break;
          // 1000 * 60 * 60
          case "day":
            output = (this - that - zoneDelta) / 864e5;
            break;
          // 1000 * 60 * 60 * 24, negate dst
          case "week":
            output = (this - that - zoneDelta) / 6048e5;
            break;
          // 1000 * 60 * 60 * 24 * 7, negate dst
          default:
            output = this - that;
        }
        return asFloat ? output : absFloor(output);
      }
      function monthDiff(a, b) {
        if (a.date() < b.date()) {
          return -monthDiff(b, a);
        }
        var wholeMonthDiff = (b.year() - a.year()) * 12 + (b.month() - a.month()), anchor = a.clone().add(wholeMonthDiff, "months"), anchor2, adjust;
        if (b - anchor < 0) {
          anchor2 = a.clone().add(wholeMonthDiff - 1, "months");
          adjust = (b - anchor) / (anchor - anchor2);
        } else {
          anchor2 = a.clone().add(wholeMonthDiff + 1, "months");
          adjust = (b - anchor) / (anchor2 - anchor);
        }
        return -(wholeMonthDiff + adjust) || 0;
      }
      hooks.defaultFormat = "YYYY-MM-DDTHH:mm:ssZ";
      hooks.defaultFormatUtc = "YYYY-MM-DDTHH:mm:ss[Z]";
      function toString() {
        return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ");
      }
      function toISOString(keepOffset) {
        if (!this.isValid()) {
          return null;
        }
        var utc = keepOffset !== true, m = utc ? this.clone().utc() : this;
        if (m.year() < 0 || m.year() > 9999) {
          return formatMoment(m, utc ? "YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]" : "YYYYYY-MM-DD[T]HH:mm:ss.SSSZ");
        }
        if (isFunction(Date.prototype.toISOString)) {
          if (utc) {
            return this.toDate().toISOString();
          } else {
            return new Date(this.valueOf() + this.utcOffset() * 60 * 1e3).toISOString().replace("Z", formatMoment(m, "Z"));
          }
        }
        return formatMoment(m, utc ? "YYYY-MM-DD[T]HH:mm:ss.SSS[Z]" : "YYYY-MM-DD[T]HH:mm:ss.SSSZ");
      }
      function inspect() {
        if (!this.isValid()) {
          return "moment.invalid(/* " + this._i + " */)";
        }
        var func = "moment", zone = "", prefix, year, datetime, suffix;
        if (!this.isLocal()) {
          func = this.utcOffset() === 0 ? "moment.utc" : "moment.parseZone";
          zone = "Z";
        }
        prefix = "[" + func + '("]';
        year = 0 <= this.year() && this.year() <= 9999 ? "YYYY" : "YYYYYY";
        datetime = "-MM-DD[T]HH:mm:ss.SSS";
        suffix = zone + '[")]';
        return this.format(prefix + year + datetime + suffix);
      }
      function format(inputString) {
        if (!inputString) {
          inputString = this.isUtc() ? hooks.defaultFormatUtc : hooks.defaultFormat;
        }
        var output = formatMoment(this, inputString);
        return this.localeData().postformat(output);
      }
      function from2(time, withoutSuffix) {
        if (this.isValid() && (isMoment(time) && time.isValid() || createLocal(time).isValid())) {
          return createDuration({
            to: this,
            from: time
          }).locale(this.locale()).humanize(!withoutSuffix);
        } else {
          return this.localeData().invalidDate();
        }
      }
      function fromNow(withoutSuffix) {
        return this.from(createLocal(), withoutSuffix);
      }
      function to(time, withoutSuffix) {
        if (this.isValid() && (isMoment(time) && time.isValid() || createLocal(time).isValid())) {
          return createDuration({
            from: this,
            to: time
          }).locale(this.locale()).humanize(!withoutSuffix);
        } else {
          return this.localeData().invalidDate();
        }
      }
      function toNow(withoutSuffix) {
        return this.to(createLocal(), withoutSuffix);
      }
      function locale(key) {
        var newLocaleData;
        if (key === void 0) {
          return this._locale._abbr;
        } else {
          newLocaleData = getLocale(key);
          if (newLocaleData != null) {
            this._locale = newLocaleData;
          }
          return this;
        }
      }
      var lang = deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.", function(key) {
        if (key === void 0) {
          return this.localeData();
        } else {
          return this.locale(key);
        }
      });
      function localeData() {
        return this._locale;
      }
      var MS_PER_SECOND = 1e3, MS_PER_MINUTE = 60 * MS_PER_SECOND, MS_PER_HOUR = 60 * MS_PER_MINUTE, MS_PER_400_YEARS = (365 * 400 + 97) * 24 * MS_PER_HOUR;
      function mod$1(dividend, divisor) {
        return (dividend % divisor + divisor) % divisor;
      }
      function localStartOfDate(y, m, d) {
        if (y < 100 && y >= 0) {
          return new Date(y + 400, m, d) - MS_PER_400_YEARS;
        } else {
          return new Date(y, m, d).valueOf();
        }
      }
      function utcStartOfDate(y, m, d) {
        if (y < 100 && y >= 0) {
          return Date.UTC(y + 400, m, d) - MS_PER_400_YEARS;
        } else {
          return Date.UTC(y, m, d);
        }
      }
      function startOf(units) {
        var time, startOfDate;
        units = normalizeUnits(units);
        if (units === void 0 || units === "millisecond" || !this.isValid()) {
          return this;
        }
        startOfDate = this._isUTC ? utcStartOfDate : localStartOfDate;
        switch (units) {
          case "year":
            time = startOfDate(this.year(), 0, 1);
            break;
          case "quarter":
            time = startOfDate(this.year(), this.month() - this.month() % 3, 1);
            break;
          case "month":
            time = startOfDate(this.year(), this.month(), 1);
            break;
          case "week":
            time = startOfDate(this.year(), this.month(), this.date() - this.weekday());
            break;
          case "isoWeek":
            time = startOfDate(this.year(), this.month(), this.date() - (this.isoWeekday() - 1));
            break;
          case "day":
          case "date":
            time = startOfDate(this.year(), this.month(), this.date());
            break;
          case "hour":
            time = this._d.valueOf();
            time -= mod$1(time + (this._isUTC ? 0 : this.utcOffset() * MS_PER_MINUTE), MS_PER_HOUR);
            break;
          case "minute":
            time = this._d.valueOf();
            time -= mod$1(time, MS_PER_MINUTE);
            break;
          case "second":
            time = this._d.valueOf();
            time -= mod$1(time, MS_PER_SECOND);
            break;
        }
        this._d.setTime(time);
        hooks.updateOffset(this, true);
        return this;
      }
      function endOf(units) {
        var time, startOfDate;
        units = normalizeUnits(units);
        if (units === void 0 || units === "millisecond" || !this.isValid()) {
          return this;
        }
        startOfDate = this._isUTC ? utcStartOfDate : localStartOfDate;
        switch (units) {
          case "year":
            time = startOfDate(this.year() + 1, 0, 1) - 1;
            break;
          case "quarter":
            time = startOfDate(this.year(), this.month() - this.month() % 3 + 3, 1) - 1;
            break;
          case "month":
            time = startOfDate(this.year(), this.month() + 1, 1) - 1;
            break;
          case "week":
            time = startOfDate(this.year(), this.month(), this.date() - this.weekday() + 7) - 1;
            break;
          case "isoWeek":
            time = startOfDate(this.year(), this.month(), this.date() - (this.isoWeekday() - 1) + 7) - 1;
            break;
          case "day":
          case "date":
            time = startOfDate(this.year(), this.month(), this.date() + 1) - 1;
            break;
          case "hour":
            time = this._d.valueOf();
            time += MS_PER_HOUR - mod$1(time + (this._isUTC ? 0 : this.utcOffset() * MS_PER_MINUTE), MS_PER_HOUR) - 1;
            break;
          case "minute":
            time = this._d.valueOf();
            time += MS_PER_MINUTE - mod$1(time, MS_PER_MINUTE) - 1;
            break;
          case "second":
            time = this._d.valueOf();
            time += MS_PER_SECOND - mod$1(time, MS_PER_SECOND) - 1;
            break;
        }
        this._d.setTime(time);
        hooks.updateOffset(this, true);
        return this;
      }
      function valueOf() {
        return this._d.valueOf() - (this._offset || 0) * 6e4;
      }
      function unix() {
        return Math.floor(this.valueOf() / 1e3);
      }
      function toDate() {
        return new Date(this.valueOf());
      }
      function toArray() {
        var m = this;
        return [m.year(), m.month(), m.date(), m.hour(), m.minute(), m.second(), m.millisecond()];
      }
      function toObject() {
        var m = this;
        return {
          years: m.year(),
          months: m.month(),
          date: m.date(),
          hours: m.hours(),
          minutes: m.minutes(),
          seconds: m.seconds(),
          milliseconds: m.milliseconds()
        };
      }
      function toJSON() {
        return this.isValid() ? this.toISOString() : null;
      }
      function isValid$2() {
        return isValid(this);
      }
      function parsingFlags() {
        return extend({}, getParsingFlags(this));
      }
      function invalidAt() {
        return getParsingFlags(this).overflow;
      }
      function creationData() {
        return {
          input: this._i,
          format: this._f,
          locale: this._locale,
          isUTC: this._isUTC,
          strict: this._strict
        };
      }
      addFormatToken("N", 0, 0, "eraAbbr");
      addFormatToken("NN", 0, 0, "eraAbbr");
      addFormatToken("NNN", 0, 0, "eraAbbr");
      addFormatToken("NNNN", 0, 0, "eraName");
      addFormatToken("NNNNN", 0, 0, "eraNarrow");
      addFormatToken("y", ["y", 1], "yo", "eraYear");
      addFormatToken("y", ["yy", 2], 0, "eraYear");
      addFormatToken("y", ["yyy", 3], 0, "eraYear");
      addFormatToken("y", ["yyyy", 4], 0, "eraYear");
      addRegexToken("N", matchEraAbbr);
      addRegexToken("NN", matchEraAbbr);
      addRegexToken("NNN", matchEraAbbr);
      addRegexToken("NNNN", matchEraName);
      addRegexToken("NNNNN", matchEraNarrow);
      addParseToken(["N", "NN", "NNN", "NNNN", "NNNNN"], function(input, array, config, token2) {
        var era = config._locale.erasParse(input, token2, config._strict);
        if (era) {
          getParsingFlags(config).era = era;
        } else {
          getParsingFlags(config).invalidEra = input;
        }
      });
      addRegexToken("y", matchUnsigned);
      addRegexToken("yy", matchUnsigned);
      addRegexToken("yyy", matchUnsigned);
      addRegexToken("yyyy", matchUnsigned);
      addRegexToken("yo", matchEraYearOrdinal);
      addParseToken(["y", "yy", "yyy", "yyyy"], YEAR);
      addParseToken(["yo"], function(input, array, config, token2) {
        var match;
        if (config._locale._eraYearOrdinalRegex) {
          match = input.match(config._locale._eraYearOrdinalRegex);
        }
        if (config._locale.eraYearOrdinalParse) {
          array[YEAR] = config._locale.eraYearOrdinalParse(input, match);
        } else {
          array[YEAR] = parseInt(input, 10);
        }
      });
      function localeEras(m, format2) {
        var i, l, date, eras = this._eras || getLocale("en")._eras;
        for (i = 0, l = eras.length; i < l; ++i) {
          switch (typeof eras[i].since) {
            case "string":
              date = hooks(eras[i].since).startOf("day");
              eras[i].since = date.valueOf();
              break;
          }
          switch (typeof eras[i].until) {
            case "undefined":
              eras[i].until = Infinity;
              break;
            case "string":
              date = hooks(eras[i].until).startOf("day").valueOf();
              eras[i].until = date.valueOf();
              break;
          }
        }
        return eras;
      }
      function localeErasParse(eraName, format2, strict) {
        var i, l, eras = this.eras(), name, abbr, narrow;
        eraName = eraName.toUpperCase();
        for (i = 0, l = eras.length; i < l; ++i) {
          name = eras[i].name.toUpperCase();
          abbr = eras[i].abbr.toUpperCase();
          narrow = eras[i].narrow.toUpperCase();
          if (strict) {
            switch (format2) {
              case "N":
              case "NN":
              case "NNN":
                if (abbr === eraName) {
                  return eras[i];
                }
                break;
              case "NNNN":
                if (name === eraName) {
                  return eras[i];
                }
                break;
              case "NNNNN":
                if (narrow === eraName) {
                  return eras[i];
                }
                break;
            }
          } else if ([name, abbr, narrow].indexOf(eraName) >= 0) {
            return eras[i];
          }
        }
      }
      function localeErasConvertYear(era, year) {
        var dir = era.since <= era.until ? 1 : -1;
        if (year === void 0) {
          return hooks(era.since).year();
        } else {
          return hooks(era.since).year() + (year - era.offset) * dir;
        }
      }
      function getEraName() {
        var i, l, val, eras = this.localeData().eras();
        for (i = 0, l = eras.length; i < l; ++i) {
          val = this.clone().startOf("day").valueOf();
          if (eras[i].since <= val && val <= eras[i].until) {
            return eras[i].name;
          }
          if (eras[i].until <= val && val <= eras[i].since) {
            return eras[i].name;
          }
        }
        return "";
      }
      function getEraNarrow() {
        var i, l, val, eras = this.localeData().eras();
        for (i = 0, l = eras.length; i < l; ++i) {
          val = this.clone().startOf("day").valueOf();
          if (eras[i].since <= val && val <= eras[i].until) {
            return eras[i].narrow;
          }
          if (eras[i].until <= val && val <= eras[i].since) {
            return eras[i].narrow;
          }
        }
        return "";
      }
      function getEraAbbr() {
        var i, l, val, eras = this.localeData().eras();
        for (i = 0, l = eras.length; i < l; ++i) {
          val = this.clone().startOf("day").valueOf();
          if (eras[i].since <= val && val <= eras[i].until) {
            return eras[i].abbr;
          }
          if (eras[i].until <= val && val <= eras[i].since) {
            return eras[i].abbr;
          }
        }
        return "";
      }
      function getEraYear() {
        var i, l, dir, val, eras = this.localeData().eras();
        for (i = 0, l = eras.length; i < l; ++i) {
          dir = eras[i].since <= eras[i].until ? 1 : -1;
          val = this.clone().startOf("day").valueOf();
          if (eras[i].since <= val && val <= eras[i].until || eras[i].until <= val && val <= eras[i].since) {
            return (this.year() - hooks(eras[i].since).year()) * dir + eras[i].offset;
          }
        }
        return this.year();
      }
      function erasNameRegex(isStrict) {
        if (!hasOwnProp(this, "_erasNameRegex")) {
          computeErasParse.call(this);
        }
        return isStrict ? this._erasNameRegex : this._erasRegex;
      }
      function erasAbbrRegex(isStrict) {
        if (!hasOwnProp(this, "_erasAbbrRegex")) {
          computeErasParse.call(this);
        }
        return isStrict ? this._erasAbbrRegex : this._erasRegex;
      }
      function erasNarrowRegex(isStrict) {
        if (!hasOwnProp(this, "_erasNarrowRegex")) {
          computeErasParse.call(this);
        }
        return isStrict ? this._erasNarrowRegex : this._erasRegex;
      }
      function matchEraAbbr(isStrict, locale2) {
        return locale2.erasAbbrRegex(isStrict);
      }
      function matchEraName(isStrict, locale2) {
        return locale2.erasNameRegex(isStrict);
      }
      function matchEraNarrow(isStrict, locale2) {
        return locale2.erasNarrowRegex(isStrict);
      }
      function matchEraYearOrdinal(isStrict, locale2) {
        return locale2._eraYearOrdinalRegex || matchUnsigned;
      }
      function computeErasParse() {
        var abbrPieces = [], namePieces = [], narrowPieces = [], mixedPieces = [], i, l, erasName, erasAbbr, erasNarrow, eras = this.eras();
        for (i = 0, l = eras.length; i < l; ++i) {
          erasName = regexEscape(eras[i].name);
          erasAbbr = regexEscape(eras[i].abbr);
          erasNarrow = regexEscape(eras[i].narrow);
          namePieces.push(erasName);
          abbrPieces.push(erasAbbr);
          narrowPieces.push(erasNarrow);
          mixedPieces.push(erasName);
          mixedPieces.push(erasAbbr);
          mixedPieces.push(erasNarrow);
        }
        this._erasRegex = new RegExp("^(" + mixedPieces.join("|") + ")", "i");
        this._erasNameRegex = new RegExp("^(" + namePieces.join("|") + ")", "i");
        this._erasAbbrRegex = new RegExp("^(" + abbrPieces.join("|") + ")", "i");
        this._erasNarrowRegex = new RegExp("^(" + narrowPieces.join("|") + ")", "i");
      }
      addFormatToken(0, ["gg", 2], 0, function() {
        return this.weekYear() % 100;
      });
      addFormatToken(0, ["GG", 2], 0, function() {
        return this.isoWeekYear() % 100;
      });
      function addWeekYearFormatToken(token2, getter) {
        addFormatToken(0, [token2, token2.length], 0, getter);
      }
      addWeekYearFormatToken("gggg", "weekYear");
      addWeekYearFormatToken("ggggg", "weekYear");
      addWeekYearFormatToken("GGGG", "isoWeekYear");
      addWeekYearFormatToken("GGGGG", "isoWeekYear");
      addRegexToken("G", matchSigned);
      addRegexToken("g", matchSigned);
      addRegexToken("GG", match1to2, match2);
      addRegexToken("gg", match1to2, match2);
      addRegexToken("GGGG", match1to4, match4);
      addRegexToken("gggg", match1to4, match4);
      addRegexToken("GGGGG", match1to6, match6);
      addRegexToken("ggggg", match1to6, match6);
      addWeekParseToken(["gggg", "ggggg", "GGGG", "GGGGG"], function(input, week, config, token2) {
        week[token2.substr(0, 2)] = toInt(input);
      });
      addWeekParseToken(["gg", "GG"], function(input, week, config, token2) {
        week[token2] = hooks.parseTwoDigitYear(input);
      });
      function getSetWeekYear(input) {
        return getSetWeekYearHelper.call(this, input, this.week(), this.weekday() + this.localeData()._week.dow, this.localeData()._week.dow, this.localeData()._week.doy);
      }
      function getSetISOWeekYear(input) {
        return getSetWeekYearHelper.call(this, input, this.isoWeek(), this.isoWeekday(), 1, 4);
      }
      function getISOWeeksInYear() {
        return weeksInYear(this.year(), 1, 4);
      }
      function getISOWeeksInISOWeekYear() {
        return weeksInYear(this.isoWeekYear(), 1, 4);
      }
      function getWeeksInYear() {
        var weekInfo = this.localeData()._week;
        return weeksInYear(this.year(), weekInfo.dow, weekInfo.doy);
      }
      function getWeeksInWeekYear() {
        var weekInfo = this.localeData()._week;
        return weeksInYear(this.weekYear(), weekInfo.dow, weekInfo.doy);
      }
      function getSetWeekYearHelper(input, week, weekday, dow, doy) {
        var weeksTarget;
        if (input == null) {
          return weekOfYear(this, dow, doy).year;
        } else {
          weeksTarget = weeksInYear(input, dow, doy);
          if (week > weeksTarget) {
            week = weeksTarget;
          }
          return setWeekAll.call(this, input, week, weekday, dow, doy);
        }
      }
      function setWeekAll(weekYear, week, weekday, dow, doy) {
        var dayOfYearData = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy), date = createUTCDate(dayOfYearData.year, 0, dayOfYearData.dayOfYear);
        this.year(date.getUTCFullYear());
        this.month(date.getUTCMonth());
        this.date(date.getUTCDate());
        return this;
      }
      addFormatToken("Q", 0, "Qo", "quarter");
      addRegexToken("Q", match1);
      addParseToken("Q", function(input, array) {
        array[MONTH] = (toInt(input) - 1) * 3;
      });
      function getSetQuarter(input) {
        return input == null ? Math.ceil((this.month() + 1) / 3) : this.month((input - 1) * 3 + this.month() % 3);
      }
      addFormatToken("D", ["DD", 2], "Do", "date");
      addRegexToken("D", match1to2, match1to2NoLeadingZero);
      addRegexToken("DD", match1to2, match2);
      addRegexToken("Do", function(isStrict, locale2) {
        return isStrict ? locale2._dayOfMonthOrdinalParse || locale2._ordinalParse : locale2._dayOfMonthOrdinalParseLenient;
      });
      addParseToken(["D", "DD"], DATE);
      addParseToken("Do", function(input, array) {
        array[DATE] = toInt(input.match(match1to2)[0]);
      });
      var getSetDayOfMonth = makeGetSet("Date", true);
      addFormatToken("DDD", ["DDDD", 3], "DDDo", "dayOfYear");
      addRegexToken("DDD", match1to3);
      addRegexToken("DDDD", match3);
      addParseToken(["DDD", "DDDD"], function(input, array, config) {
        config._dayOfYear = toInt(input);
      });
      function getSetDayOfYear(input) {
        var dayOfYear = Math.round((this.clone().startOf("day") - this.clone().startOf("year")) / 864e5) + 1;
        return input == null ? dayOfYear : this.add(input - dayOfYear, "d");
      }
      addFormatToken("m", ["mm", 2], 0, "minute");
      addRegexToken("m", match1to2, match1to2HasZero);
      addRegexToken("mm", match1to2, match2);
      addParseToken(["m", "mm"], MINUTE);
      var getSetMinute = makeGetSet("Minutes", false);
      addFormatToken("s", ["ss", 2], 0, "second");
      addRegexToken("s", match1to2, match1to2HasZero);
      addRegexToken("ss", match1to2, match2);
      addParseToken(["s", "ss"], SECOND);
      var getSetSecond = makeGetSet("Seconds", false);
      addFormatToken("S", 0, 0, function() {
        return ~~(this.millisecond() / 100);
      });
      addFormatToken(0, ["SS", 2], 0, function() {
        return ~~(this.millisecond() / 10);
      });
      addFormatToken(0, ["SSS", 3], 0, "millisecond");
      addFormatToken(0, ["SSSS", 4], 0, function() {
        return this.millisecond() * 10;
      });
      addFormatToken(0, ["SSSSS", 5], 0, function() {
        return this.millisecond() * 100;
      });
      addFormatToken(0, ["SSSSSS", 6], 0, function() {
        return this.millisecond() * 1e3;
      });
      addFormatToken(0, ["SSSSSSS", 7], 0, function() {
        return this.millisecond() * 1e4;
      });
      addFormatToken(0, ["SSSSSSSS", 8], 0, function() {
        return this.millisecond() * 1e5;
      });
      addFormatToken(0, ["SSSSSSSSS", 9], 0, function() {
        return this.millisecond() * 1e6;
      });
      addRegexToken("S", match1to3, match1);
      addRegexToken("SS", match1to3, match2);
      addRegexToken("SSS", match1to3, match3);
      var token, getSetMillisecond;
      for (token = "SSSS"; token.length <= 9; token += "S") {
        addRegexToken(token, matchUnsigned);
      }
      function parseMs(input, array) {
        array[MILLISECOND] = toInt(("0." + input) * 1e3);
      }
      for (token = "S"; token.length <= 9; token += "S") {
        addParseToken(token, parseMs);
      }
      getSetMillisecond = makeGetSet("Milliseconds", false);
      addFormatToken("z", 0, 0, "zoneAbbr");
      addFormatToken("zz", 0, 0, "zoneName");
      function getZoneAbbr() {
        return this._isUTC ? "UTC" : "";
      }
      function getZoneName() {
        return this._isUTC ? "Coordinated Universal Time" : "";
      }
      var proto = Moment.prototype;
      proto.add = add;
      proto.calendar = calendar$1;
      proto.clone = clone;
      proto.diff = diff;
      proto.endOf = endOf;
      proto.format = format;
      proto.from = from2;
      proto.fromNow = fromNow;
      proto.to = to;
      proto.toNow = toNow;
      proto.get = stringGet;
      proto.invalidAt = invalidAt;
      proto.isAfter = isAfter;
      proto.isBefore = isBefore;
      proto.isBetween = isBetween;
      proto.isSame = isSame;
      proto.isSameOrAfter = isSameOrAfter;
      proto.isSameOrBefore = isSameOrBefore;
      proto.isValid = isValid$2;
      proto.lang = lang;
      proto.locale = locale;
      proto.localeData = localeData;
      proto.max = prototypeMax;
      proto.min = prototypeMin;
      proto.parsingFlags = parsingFlags;
      proto.set = stringSet;
      proto.startOf = startOf;
      proto.subtract = subtract;
      proto.toArray = toArray;
      proto.toObject = toObject;
      proto.toDate = toDate;
      proto.toISOString = toISOString;
      proto.inspect = inspect;
      if (typeof Symbol !== "undefined" && Symbol.for != null) {
        proto[Symbol.for("nodejs.util.inspect.custom")] = function() {
          return "Moment<" + this.format() + ">";
        };
      }
      proto.toJSON = toJSON;
      proto.toString = toString;
      proto.unix = unix;
      proto.valueOf = valueOf;
      proto.creationData = creationData;
      proto.eraName = getEraName;
      proto.eraNarrow = getEraNarrow;
      proto.eraAbbr = getEraAbbr;
      proto.eraYear = getEraYear;
      proto.year = getSetYear;
      proto.isLeapYear = getIsLeapYear;
      proto.weekYear = getSetWeekYear;
      proto.isoWeekYear = getSetISOWeekYear;
      proto.quarter = proto.quarters = getSetQuarter;
      proto.month = getSetMonth;
      proto.daysInMonth = getDaysInMonth;
      proto.week = proto.weeks = getSetWeek;
      proto.isoWeek = proto.isoWeeks = getSetISOWeek;
      proto.weeksInYear = getWeeksInYear;
      proto.weeksInWeekYear = getWeeksInWeekYear;
      proto.isoWeeksInYear = getISOWeeksInYear;
      proto.isoWeeksInISOWeekYear = getISOWeeksInISOWeekYear;
      proto.date = getSetDayOfMonth;
      proto.day = proto.days = getSetDayOfWeek;
      proto.weekday = getSetLocaleDayOfWeek;
      proto.isoWeekday = getSetISODayOfWeek;
      proto.dayOfYear = getSetDayOfYear;
      proto.hour = proto.hours = getSetHour;
      proto.minute = proto.minutes = getSetMinute;
      proto.second = proto.seconds = getSetSecond;
      proto.millisecond = proto.milliseconds = getSetMillisecond;
      proto.utcOffset = getSetOffset;
      proto.utc = setOffsetToUTC;
      proto.local = setOffsetToLocal;
      proto.parseZone = setOffsetToParsedOffset;
      proto.hasAlignedHourOffset = hasAlignedHourOffset;
      proto.isDST = isDaylightSavingTime;
      proto.isLocal = isLocal;
      proto.isUtcOffset = isUtcOffset;
      proto.isUtc = isUtc;
      proto.isUTC = isUtc;
      proto.zoneAbbr = getZoneAbbr;
      proto.zoneName = getZoneName;
      proto.dates = deprecate("dates accessor is deprecated. Use date instead.", getSetDayOfMonth);
      proto.months = deprecate("months accessor is deprecated. Use month instead", getSetMonth);
      proto.years = deprecate("years accessor is deprecated. Use year instead", getSetYear);
      proto.zone = deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/", getSetZone);
      proto.isDSTShifted = deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information", isDaylightSavingTimeShifted);
      function createUnix(input) {
        return createLocal(input * 1e3);
      }
      function createInZone() {
        return createLocal.apply(null, arguments).parseZone();
      }
      function preParsePostFormat(string) {
        return string;
      }
      var proto$1 = Locale.prototype;
      proto$1.calendar = calendar;
      proto$1.longDateFormat = longDateFormat;
      proto$1.invalidDate = invalidDate;
      proto$1.ordinal = ordinal;
      proto$1.preparse = preParsePostFormat;
      proto$1.postformat = preParsePostFormat;
      proto$1.relativeTime = relativeTime;
      proto$1.pastFuture = pastFuture;
      proto$1.set = set;
      proto$1.eras = localeEras;
      proto$1.erasParse = localeErasParse;
      proto$1.erasConvertYear = localeErasConvertYear;
      proto$1.erasAbbrRegex = erasAbbrRegex;
      proto$1.erasNameRegex = erasNameRegex;
      proto$1.erasNarrowRegex = erasNarrowRegex;
      proto$1.months = localeMonths;
      proto$1.monthsShort = localeMonthsShort;
      proto$1.monthsParse = localeMonthsParse;
      proto$1.monthsRegex = monthsRegex;
      proto$1.monthsShortRegex = monthsShortRegex;
      proto$1.week = localeWeek;
      proto$1.firstDayOfYear = localeFirstDayOfYear;
      proto$1.firstDayOfWeek = localeFirstDayOfWeek;
      proto$1.weekdays = localeWeekdays;
      proto$1.weekdaysMin = localeWeekdaysMin;
      proto$1.weekdaysShort = localeWeekdaysShort;
      proto$1.weekdaysParse = localeWeekdaysParse;
      proto$1.weekdaysRegex = weekdaysRegex;
      proto$1.weekdaysShortRegex = weekdaysShortRegex;
      proto$1.weekdaysMinRegex = weekdaysMinRegex;
      proto$1.isPM = localeIsPM;
      proto$1.meridiem = localeMeridiem;
      function get$1(format2, index, field, setter) {
        var locale2 = getLocale(), utc = createUTC().set(setter, index);
        return locale2[field](utc, format2);
      }
      function listMonthsImpl(format2, index, field) {
        if (isNumber(format2)) {
          index = format2;
          format2 = void 0;
        }
        format2 = format2 || "";
        if (index != null) {
          return get$1(format2, index, field, "month");
        }
        var i, out = [];
        for (i = 0; i < 12; i++) {
          out[i] = get$1(format2, i, field, "month");
        }
        return out;
      }
      function listWeekdaysImpl(localeSorted, format2, index, field) {
        if (typeof localeSorted === "boolean") {
          if (isNumber(format2)) {
            index = format2;
            format2 = void 0;
          }
          format2 = format2 || "";
        } else {
          format2 = localeSorted;
          index = format2;
          localeSorted = false;
          if (isNumber(format2)) {
            index = format2;
            format2 = void 0;
          }
          format2 = format2 || "";
        }
        var locale2 = getLocale(), shift = localeSorted ? locale2._week.dow : 0, i, out = [];
        if (index != null) {
          return get$1(format2, (index + shift) % 7, field, "day");
        }
        for (i = 0; i < 7; i++) {
          out[i] = get$1(format2, (i + shift) % 7, field, "day");
        }
        return out;
      }
      function listMonths(format2, index) {
        return listMonthsImpl(format2, index, "months");
      }
      function listMonthsShort(format2, index) {
        return listMonthsImpl(format2, index, "monthsShort");
      }
      function listWeekdays(localeSorted, format2, index) {
        return listWeekdaysImpl(localeSorted, format2, index, "weekdays");
      }
      function listWeekdaysShort(localeSorted, format2, index) {
        return listWeekdaysImpl(localeSorted, format2, index, "weekdaysShort");
      }
      function listWeekdaysMin(localeSorted, format2, index) {
        return listWeekdaysImpl(localeSorted, format2, index, "weekdaysMin");
      }
      getSetGlobalLocale("en", {
        eras: [{
          since: "0001-01-01",
          until: Infinity,
          offset: 1,
          name: "Anno Domini",
          narrow: "AD",
          abbr: "AD"
        }, {
          since: "0000-12-31",
          until: -Infinity,
          offset: 1,
          name: "Before Christ",
          narrow: "BC",
          abbr: "BC"
        }],
        dayOfMonthOrdinalParse: /\d{1,2}(th|st|nd|rd)/,
        ordinal: function(number) {
          var b = number % 10, output = toInt(number % 100 / 10) === 1 ? "th" : b === 1 ? "st" : b === 2 ? "nd" : b === 3 ? "rd" : "th";
          return number + output;
        }
      });
      hooks.lang = deprecate("moment.lang is deprecated. Use moment.locale instead.", getSetGlobalLocale);
      hooks.langData = deprecate("moment.langData is deprecated. Use moment.localeData instead.", getLocale);
      var mathAbs = Math.abs;
      function abs() {
        var data = this._data;
        this._milliseconds = mathAbs(this._milliseconds);
        this._days = mathAbs(this._days);
        this._months = mathAbs(this._months);
        data.milliseconds = mathAbs(data.milliseconds);
        data.seconds = mathAbs(data.seconds);
        data.minutes = mathAbs(data.minutes);
        data.hours = mathAbs(data.hours);
        data.months = mathAbs(data.months);
        data.years = mathAbs(data.years);
        return this;
      }
      function addSubtract$1(duration, input, value, direction) {
        var other = createDuration(input, value);
        duration._milliseconds += direction * other._milliseconds;
        duration._days += direction * other._days;
        duration._months += direction * other._months;
        return duration._bubble();
      }
      function add$1(input, value) {
        return addSubtract$1(this, input, value, 1);
      }
      function subtract$1(input, value) {
        return addSubtract$1(this, input, value, -1);
      }
      function absCeil(number) {
        if (number < 0) {
          return Math.floor(number);
        } else {
          return Math.ceil(number);
        }
      }
      function bubble() {
        var milliseconds2 = this._milliseconds, days3 = this._days, months3 = this._months, data = this._data, seconds2, minutes2, hours2, years2, monthsFromDays;
        if (!(milliseconds2 >= 0 && days3 >= 0 && months3 >= 0 || milliseconds2 <= 0 && days3 <= 0 && months3 <= 0)) {
          milliseconds2 += absCeil(monthsToDays(months3) + days3) * 864e5;
          days3 = 0;
          months3 = 0;
        }
        data.milliseconds = milliseconds2 % 1e3;
        seconds2 = absFloor(milliseconds2 / 1e3);
        data.seconds = seconds2 % 60;
        minutes2 = absFloor(seconds2 / 60);
        data.minutes = minutes2 % 60;
        hours2 = absFloor(minutes2 / 60);
        data.hours = hours2 % 24;
        days3 += absFloor(hours2 / 24);
        monthsFromDays = absFloor(daysToMonths(days3));
        months3 += monthsFromDays;
        days3 -= absCeil(monthsToDays(monthsFromDays));
        years2 = absFloor(months3 / 12);
        months3 %= 12;
        data.days = days3;
        data.months = months3;
        data.years = years2;
        return this;
      }
      function daysToMonths(days3) {
        return days3 * 4800 / 146097;
      }
      function monthsToDays(months3) {
        return months3 * 146097 / 4800;
      }
      function as(units) {
        if (!this.isValid()) {
          return NaN;
        }
        var days3, months3, milliseconds2 = this._milliseconds;
        units = normalizeUnits(units);
        if (units === "month" || units === "quarter" || units === "year") {
          days3 = this._days + milliseconds2 / 864e5;
          months3 = this._months + daysToMonths(days3);
          switch (units) {
            case "month":
              return months3;
            case "quarter":
              return months3 / 3;
            case "year":
              return months3 / 12;
          }
        } else {
          days3 = this._days + Math.round(monthsToDays(this._months));
          switch (units) {
            case "week":
              return days3 / 7 + milliseconds2 / 6048e5;
            case "day":
              return days3 + milliseconds2 / 864e5;
            case "hour":
              return days3 * 24 + milliseconds2 / 36e5;
            case "minute":
              return days3 * 1440 + milliseconds2 / 6e4;
            case "second":
              return days3 * 86400 + milliseconds2 / 1e3;
            // Math.floor prevents floating point math errors here
            case "millisecond":
              return Math.floor(days3 * 864e5) + milliseconds2;
            default:
              throw new Error("Unknown unit " + units);
          }
        }
      }
      function makeAs(alias) {
        return function() {
          return this.as(alias);
        };
      }
      var asMilliseconds = makeAs("ms"), asSeconds = makeAs("s"), asMinutes = makeAs("m"), asHours = makeAs("h"), asDays = makeAs("d"), asWeeks = makeAs("w"), asMonths = makeAs("M"), asQuarters = makeAs("Q"), asYears = makeAs("y"), valueOf$1 = asMilliseconds;
      function clone$1() {
        return createDuration(this);
      }
      function get$2(units) {
        units = normalizeUnits(units);
        return this.isValid() ? this[units + "s"]() : NaN;
      }
      function makeGetter(name) {
        return function() {
          return this.isValid() ? this._data[name] : NaN;
        };
      }
      var milliseconds = makeGetter("milliseconds"), seconds = makeGetter("seconds"), minutes = makeGetter("minutes"), hours = makeGetter("hours"), days2 = makeGetter("days"), months2 = makeGetter("months"), years = makeGetter("years");
      function weeks() {
        return absFloor(this.days() / 7);
      }
      var round = Math.round, thresholds = {
        ss: 44,
        // a few seconds to seconds
        s: 45,
        // seconds to minute
        m: 45,
        // minutes to hour
        h: 22,
        // hours to day
        d: 26,
        // days to month/week
        w: null,
        // weeks to month
        M: 11
        // months to year
      };
      function substituteTimeAgo(string, number, withoutSuffix, isFuture, locale2) {
        return locale2.relativeTime(number || 1, !!withoutSuffix, string, isFuture);
      }
      function relativeTime$1(posNegDuration, withoutSuffix, thresholds2, locale2) {
        var duration = createDuration(posNegDuration).abs(), seconds2 = round(duration.as("s")), minutes2 = round(duration.as("m")), hours2 = round(duration.as("h")), days3 = round(duration.as("d")), months3 = round(duration.as("M")), weeks2 = round(duration.as("w")), years2 = round(duration.as("y")), a = seconds2 <= thresholds2.ss && ["s", seconds2] || seconds2 < thresholds2.s && ["ss", seconds2] || minutes2 <= 1 && ["m"] || minutes2 < thresholds2.m && ["mm", minutes2] || hours2 <= 1 && ["h"] || hours2 < thresholds2.h && ["hh", hours2] || days3 <= 1 && ["d"] || days3 < thresholds2.d && ["dd", days3];
        if (thresholds2.w != null) {
          a = a || weeks2 <= 1 && ["w"] || weeks2 < thresholds2.w && ["ww", weeks2];
        }
        a = a || months3 <= 1 && ["M"] || months3 < thresholds2.M && ["MM", months3] || years2 <= 1 && ["y"] || ["yy", years2];
        a[2] = withoutSuffix;
        a[3] = +posNegDuration > 0;
        a[4] = locale2;
        return substituteTimeAgo.apply(null, a);
      }
      function getSetRelativeTimeRounding(roundingFunction) {
        if (roundingFunction === void 0) {
          return round;
        }
        if (typeof roundingFunction === "function") {
          round = roundingFunction;
          return true;
        }
        return false;
      }
      function getSetRelativeTimeThreshold(threshold, limit) {
        if (thresholds[threshold] === void 0) {
          return false;
        }
        if (limit === void 0) {
          return thresholds[threshold];
        }
        thresholds[threshold] = limit;
        if (threshold === "s") {
          thresholds.ss = limit - 1;
        }
        return true;
      }
      function humanize(argWithSuffix, argThresholds) {
        if (!this.isValid()) {
          return this.localeData().invalidDate();
        }
        var withSuffix = false, th = thresholds, locale2, output;
        if (typeof argWithSuffix === "object") {
          argThresholds = argWithSuffix;
          argWithSuffix = false;
        }
        if (typeof argWithSuffix === "boolean") {
          withSuffix = argWithSuffix;
        }
        if (typeof argThresholds === "object") {
          th = Object.assign({}, thresholds, argThresholds);
          if (argThresholds.s != null && argThresholds.ss == null) {
            th.ss = argThresholds.s - 1;
          }
        }
        locale2 = this.localeData();
        output = relativeTime$1(this, !withSuffix, th, locale2);
        if (withSuffix) {
          output = locale2.pastFuture(+this, output);
        }
        return locale2.postformat(output);
      }
      var abs$1 = Math.abs;
      function sign(x) {
        return (x > 0) - (x < 0) || +x;
      }
      function toISOString$1() {
        if (!this.isValid()) {
          return this.localeData().invalidDate();
        }
        var seconds2 = abs$1(this._milliseconds) / 1e3, days3 = abs$1(this._days), months3 = abs$1(this._months), minutes2, hours2, years2, s, total = this.asSeconds(), totalSign, ymSign, daysSign, hmsSign;
        if (!total) {
          return "P0D";
        }
        minutes2 = absFloor(seconds2 / 60);
        hours2 = absFloor(minutes2 / 60);
        seconds2 %= 60;
        minutes2 %= 60;
        years2 = absFloor(months3 / 12);
        months3 %= 12;
        s = seconds2 ? seconds2.toFixed(3).replace(/\.?0+$/, "") : "";
        totalSign = total < 0 ? "-" : "";
        ymSign = sign(this._months) !== sign(total) ? "-" : "";
        daysSign = sign(this._days) !== sign(total) ? "-" : "";
        hmsSign = sign(this._milliseconds) !== sign(total) ? "-" : "";
        return totalSign + "P" + (years2 ? ymSign + years2 + "Y" : "") + (months3 ? ymSign + months3 + "M" : "") + (days3 ? daysSign + days3 + "D" : "") + (hours2 || minutes2 || seconds2 ? "T" : "") + (hours2 ? hmsSign + hours2 + "H" : "") + (minutes2 ? hmsSign + minutes2 + "M" : "") + (seconds2 ? hmsSign + s + "S" : "");
      }
      var proto$2 = Duration.prototype;
      proto$2.isValid = isValid$1;
      proto$2.abs = abs;
      proto$2.add = add$1;
      proto$2.subtract = subtract$1;
      proto$2.as = as;
      proto$2.asMilliseconds = asMilliseconds;
      proto$2.asSeconds = asSeconds;
      proto$2.asMinutes = asMinutes;
      proto$2.asHours = asHours;
      proto$2.asDays = asDays;
      proto$2.asWeeks = asWeeks;
      proto$2.asMonths = asMonths;
      proto$2.asQuarters = asQuarters;
      proto$2.asYears = asYears;
      proto$2.valueOf = valueOf$1;
      proto$2._bubble = bubble;
      proto$2.clone = clone$1;
      proto$2.get = get$2;
      proto$2.milliseconds = milliseconds;
      proto$2.seconds = seconds;
      proto$2.minutes = minutes;
      proto$2.hours = hours;
      proto$2.days = days2;
      proto$2.weeks = weeks;
      proto$2.months = months2;
      proto$2.years = years;
      proto$2.humanize = humanize;
      proto$2.toISOString = toISOString$1;
      proto$2.toString = toISOString$1;
      proto$2.toJSON = toISOString$1;
      proto$2.locale = locale;
      proto$2.localeData = localeData;
      proto$2.toIsoString = deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)", toISOString$1);
      proto$2.lang = lang;
      addFormatToken("X", 0, 0, "unix");
      addFormatToken("x", 0, 0, "valueOf");
      addRegexToken("x", matchSigned);
      addRegexToken("X", matchTimestamp);
      addParseToken("X", function(input, array, config) {
        config._d = new Date(parseFloat(input) * 1e3);
      });
      addParseToken("x", function(input, array, config) {
        config._d = new Date(toInt(input));
      });
      hooks.version = "2.30.1";
      setHookCallback(createLocal);
      hooks.fn = proto;
      hooks.min = min;
      hooks.max = max;
      hooks.now = now;
      hooks.utc = createUTC;
      hooks.unix = createUnix;
      hooks.months = listMonths;
      hooks.isDate = isDate;
      hooks.locale = getSetGlobalLocale;
      hooks.invalid = createInvalid;
      hooks.duration = createDuration;
      hooks.isMoment = isMoment;
      hooks.weekdays = listWeekdays;
      hooks.parseZone = createInZone;
      hooks.localeData = getLocale;
      hooks.isDuration = isDuration;
      hooks.monthsShort = listMonthsShort;
      hooks.weekdaysMin = listWeekdaysMin;
      hooks.defineLocale = defineLocale;
      hooks.updateLocale = updateLocale;
      hooks.locales = listLocales;
      hooks.weekdaysShort = listWeekdaysShort;
      hooks.normalizeUnits = normalizeUnits;
      hooks.relativeTimeRounding = getSetRelativeTimeRounding;
      hooks.relativeTimeThreshold = getSetRelativeTimeThreshold;
      hooks.calendarFormat = getCalendarFormat;
      hooks.prototype = proto;
      hooks.HTML5_FMT = {
        DATETIME_LOCAL: "YYYY-MM-DDTHH:mm",
        // <input type="datetime-local" />
        DATETIME_LOCAL_SECONDS: "YYYY-MM-DDTHH:mm:ss",
        // <input type="datetime-local" step="1" />
        DATETIME_LOCAL_MS: "YYYY-MM-DDTHH:mm:ss.SSS",
        // <input type="datetime-local" step="0.001" />
        DATE: "YYYY-MM-DD",
        // <input type="date" />
        TIME: "HH:mm",
        // <input type="time" />
        TIME_SECONDS: "HH:mm:ss",
        // <input type="time" step="1" />
        TIME_MS: "HH:mm:ss.SSS",
        // <input type="time" step="0.001" />
        WEEK: "GGGG-[W]WW",
        // <input type="week" />
        MONTH: "YYYY-MM"
        // <input type="month" />
      };
      return hooks;
    });
  }
});

// node_modules/file-saver/dist/FileSaver.min.js
var require_FileSaver_min = __commonJS({
  "node_modules/file-saver/dist/FileSaver.min.js"(exports, module) {
    "use strict";
    (function(a, b) {
      if ("function" == typeof define && define.amd) define([], b);
      else if ("undefined" != typeof exports) b();
      else {
        b(), a.FileSaver = {
          exports: {}
        }.exports;
      }
    })(exports, function() {
      "use strict";
      function b(a2, b2) {
        return "undefined" == typeof b2 ? b2 = {
          autoBom: false
        } : "object" != typeof b2 && (console.warn("Deprecated: Expected third argument to be a object"), b2 = {
          autoBom: !b2
        }), b2.autoBom && /^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a2.type) ? new Blob(["\uFEFF", a2], {
          type: a2.type
        }) : a2;
      }
      function c(a2, b2, c2) {
        var d2 = new XMLHttpRequest();
        d2.open("GET", a2), d2.responseType = "blob", d2.onload = function() {
          g(d2.response, b2, c2);
        }, d2.onerror = function() {
          console.error("could not download file");
        }, d2.send();
      }
      function d(a2) {
        var b2 = new XMLHttpRequest();
        b2.open("HEAD", a2, false);
        try {
          b2.send();
        } catch (a3) {
        }
        return 200 <= b2.status && 299 >= b2.status;
      }
      function e(a2) {
        try {
          a2.dispatchEvent(new MouseEvent("click"));
        } catch (c2) {
          var b2 = document.createEvent("MouseEvents");
          b2.initMouseEvent("click", true, true, window, 0, 0, 0, 80, 20, false, false, false, false, 0, null), a2.dispatchEvent(b2);
        }
      }
      var f = "object" == typeof window && window.window === window ? window : "object" == typeof self && self.self === self ? self : "object" == typeof global && global.global === global ? global : void 0, a = f.navigator && /Macintosh/.test(navigator.userAgent) && /AppleWebKit/.test(navigator.userAgent) && !/Safari/.test(navigator.userAgent), g = f.saveAs || ("object" != typeof window || window !== f ? function() {
      } : "download" in HTMLAnchorElement.prototype && !a ? function(b2, g2, h) {
        var i = f.URL || f.webkitURL, j = document.createElement("a");
        g2 = g2 || b2.name || "download", j.download = g2, j.rel = "noopener", "string" == typeof b2 ? (j.href = b2, j.origin === location.origin ? e(j) : d(j.href) ? c(b2, g2, h) : e(j, j.target = "_blank")) : (j.href = i.createObjectURL(b2), setTimeout(function() {
          i.revokeObjectURL(j.href);
        }, 4e4), setTimeout(function() {
          e(j);
        }, 0));
      } : "msSaveOrOpenBlob" in navigator ? function(f2, g2, h) {
        if (g2 = g2 || f2.name || "download", "string" != typeof f2) navigator.msSaveOrOpenBlob(b(f2, h), g2);
        else if (d(f2)) c(f2, g2, h);
        else {
          var i = document.createElement("a");
          i.href = f2, i.target = "_blank", setTimeout(function() {
            e(i);
          });
        }
      } : function(b2, d2, e2, g2) {
        if (g2 = g2 || open("", "_blank"), g2 && (g2.document.title = g2.document.body.innerText = "downloading..."), "string" == typeof b2) return c(b2, d2, e2);
        var h = "application/octet-stream" === b2.type, i = /constructor/i.test(f.HTMLElement) || f.safari, j = /CriOS\/[\d]+/.test(navigator.userAgent);
        if ((j || h && i || a) && "undefined" != typeof FileReader) {
          var k = new FileReader();
          k.onloadend = function() {
            var a2 = k.result;
            a2 = j ? a2 : a2.replace(/^data:[^;]*;/, "data:attachment/file;"), g2 ? g2.location.href = a2 : location = a2, g2 = null;
          }, k.readAsDataURL(b2);
        } else {
          var l = f.URL || f.webkitURL, m = l.createObjectURL(b2);
          g2 ? g2.location = m : location.href = m, g2 = null, setTimeout(function() {
            l.revokeObjectURL(m);
          }, 4e4);
        }
      });
      f.saveAs = g.saveAs = g, "undefined" != typeof module && (module.exports = g);
    });
  }
});

// node_modules/base64-js/index.js
var require_base64_js = __commonJS({
  "node_modules/base64-js/index.js"(exports) {
    "use strict";
    exports.byteLength = byteLength;
    exports.toByteArray = toByteArray;
    exports.fromByteArray = fromByteArray;
    var lookup = [];
    var revLookup = [];
    var Arr = typeof Uint8Array !== "undefined" ? Uint8Array : Array;
    var code = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
    for (i = 0, len = code.length; i < len; ++i) {
      lookup[i] = code[i];
      revLookup[code.charCodeAt(i)] = i;
    }
    var i;
    var len;
    revLookup["-".charCodeAt(0)] = 62;
    revLookup["_".charCodeAt(0)] = 63;
    function getLens(b64) {
      var len2 = b64.length;
      if (len2 % 4 > 0) {
        throw new Error("Invalid string. Length must be a multiple of 4");
      }
      var validLen = b64.indexOf("=");
      if (validLen === -1) validLen = len2;
      var placeHoldersLen = validLen === len2 ? 0 : 4 - validLen % 4;
      return [validLen, placeHoldersLen];
    }
    function byteLength(b64) {
      var lens = getLens(b64);
      var validLen = lens[0];
      var placeHoldersLen = lens[1];
      return (validLen + placeHoldersLen) * 3 / 4 - placeHoldersLen;
    }
    function _byteLength(b64, validLen, placeHoldersLen) {
      return (validLen + placeHoldersLen) * 3 / 4 - placeHoldersLen;
    }
    function toByteArray(b64) {
      var tmp;
      var lens = getLens(b64);
      var validLen = lens[0];
      var placeHoldersLen = lens[1];
      var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen));
      var curByte = 0;
      var len2 = placeHoldersLen > 0 ? validLen - 4 : validLen;
      var i2;
      for (i2 = 0; i2 < len2; i2 += 4) {
        tmp = revLookup[b64.charCodeAt(i2)] << 18 | revLookup[b64.charCodeAt(i2 + 1)] << 12 | revLookup[b64.charCodeAt(i2 + 2)] << 6 | revLookup[b64.charCodeAt(i2 + 3)];
        arr[curByte++] = tmp >> 16 & 255;
        arr[curByte++] = tmp >> 8 & 255;
        arr[curByte++] = tmp & 255;
      }
      if (placeHoldersLen === 2) {
        tmp = revLookup[b64.charCodeAt(i2)] << 2 | revLookup[b64.charCodeAt(i2 + 1)] >> 4;
        arr[curByte++] = tmp & 255;
      }
      if (placeHoldersLen === 1) {
        tmp = revLookup[b64.charCodeAt(i2)] << 10 | revLookup[b64.charCodeAt(i2 + 1)] << 4 | revLookup[b64.charCodeAt(i2 + 2)] >> 2;
        arr[curByte++] = tmp >> 8 & 255;
        arr[curByte++] = tmp & 255;
      }
      return arr;
    }
    function tripletToBase64(num) {
      return lookup[num >> 18 & 63] + lookup[num >> 12 & 63] + lookup[num >> 6 & 63] + lookup[num & 63];
    }
    function encodeChunk(uint8, start, end) {
      var tmp;
      var output = [];
      for (var i2 = start; i2 < end; i2 += 3) {
        tmp = (uint8[i2] << 16 & 16711680) + (uint8[i2 + 1] << 8 & 65280) + (uint8[i2 + 2] & 255);
        output.push(tripletToBase64(tmp));
      }
      return output.join("");
    }
    function fromByteArray(uint8) {
      var tmp;
      var len2 = uint8.length;
      var extraBytes = len2 % 3;
      var parts = [];
      var maxChunkLength = 16383;
      for (var i2 = 0, len22 = len2 - extraBytes; i2 < len22; i2 += maxChunkLength) {
        parts.push(encodeChunk(uint8, i2, i2 + maxChunkLength > len22 ? len22 : i2 + maxChunkLength));
      }
      if (extraBytes === 1) {
        tmp = uint8[len2 - 1];
        parts.push(lookup[tmp >> 2] + lookup[tmp << 4 & 63] + "==");
      } else if (extraBytes === 2) {
        tmp = (uint8[len2 - 2] << 8) + uint8[len2 - 1];
        parts.push(lookup[tmp >> 10] + lookup[tmp >> 4 & 63] + lookup[tmp << 2 & 63] + "=");
      }
      return parts.join("");
    }
  }
});

// node_modules/ieee754/index.js
var require_ieee754 = __commonJS({
  "node_modules/ieee754/index.js"(exports) {
    "use strict";
    exports.read = function(buffer, offset, isLE, mLen, nBytes) {
      var e, m;
      var eLen = nBytes * 8 - mLen - 1;
      var eMax = (1 << eLen) - 1;
      var eBias = eMax >> 1;
      var nBits = -7;
      var i = isLE ? nBytes - 1 : 0;
      var d = isLE ? -1 : 1;
      var s = buffer[offset + i];
      i += d;
      e = s & (1 << -nBits) - 1;
      s >>= -nBits;
      nBits += eLen;
      for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {
      }
      m = e & (1 << -nBits) - 1;
      e >>= -nBits;
      nBits += mLen;
      for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {
      }
      if (e === 0) {
        e = 1 - eBias;
      } else if (e === eMax) {
        return m ? NaN : (s ? -1 : 1) * Infinity;
      } else {
        m = m + Math.pow(2, mLen);
        e = e - eBias;
      }
      return (s ? -1 : 1) * m * Math.pow(2, e - mLen);
    };
    exports.write = function(buffer, value, offset, isLE, mLen, nBytes) {
      var e, m, c;
      var eLen = nBytes * 8 - mLen - 1;
      var eMax = (1 << eLen) - 1;
      var eBias = eMax >> 1;
      var rt = mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0;
      var i = isLE ? 0 : nBytes - 1;
      var d = isLE ? 1 : -1;
      var s = value < 0 || value === 0 && 1 / value < 0 ? 1 : 0;
      value = Math.abs(value);
      if (isNaN(value) || value === Infinity) {
        m = isNaN(value) ? 1 : 0;
        e = eMax;
      } else {
        e = Math.floor(Math.log(value) / Math.LN2);
        if (value * (c = Math.pow(2, -e)) < 1) {
          e--;
          c *= 2;
        }
        if (e + eBias >= 1) {
          value += rt / c;
        } else {
          value += rt * Math.pow(2, 1 - eBias);
        }
        if (value * c >= 2) {
          e++;
          c /= 2;
        }
        if (e + eBias >= eMax) {
          m = 0;
          e = eMax;
        } else if (e + eBias >= 1) {
          m = (value * c - 1) * Math.pow(2, mLen);
          e = e + eBias;
        } else {
          m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen);
          e = 0;
        }
      }
      for (; mLen >= 8; buffer[offset + i] = m & 255, i += d, m /= 256, mLen -= 8) {
      }
      e = e << mLen | m;
      eLen += mLen;
      for (; eLen > 0; buffer[offset + i] = e & 255, i += d, e /= 256, eLen -= 8) {
      }
      buffer[offset + i - d] |= s * 128;
    };
  }
});

// node_modules/buffer/index.js
var require_buffer = __commonJS({
  "node_modules/buffer/index.js"(exports) {
    "use strict";
    var base64 = require_base64_js();
    var ieee754 = require_ieee754();
    var customInspectSymbol = typeof Symbol === "function" && typeof Symbol["for"] === "function" ? Symbol["for"]("nodejs.util.inspect.custom") : null;
    exports.Buffer = Buffer4;
    exports.SlowBuffer = SlowBuffer;
    exports.INSPECT_MAX_BYTES = 50;
    var K_MAX_LENGTH = 2147483647;
    exports.kMaxLength = K_MAX_LENGTH;
    Buffer4.TYPED_ARRAY_SUPPORT = typedArraySupport();
    if (!Buffer4.TYPED_ARRAY_SUPPORT && typeof console !== "undefined" && typeof console.error === "function") {
      console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");
    }
    function typedArraySupport() {
      try {
        var arr = new Uint8Array(1);
        var proto = {
          foo: function() {
            return 42;
          }
        };
        Object.setPrototypeOf(proto, Uint8Array.prototype);
        Object.setPrototypeOf(arr, proto);
        return arr.foo() === 42;
      } catch (e) {
        return false;
      }
    }
    Object.defineProperty(Buffer4.prototype, "parent", {
      enumerable: true,
      get: function() {
        if (!Buffer4.isBuffer(this)) return void 0;
        return this.buffer;
      }
    });
    Object.defineProperty(Buffer4.prototype, "offset", {
      enumerable: true,
      get: function() {
        if (!Buffer4.isBuffer(this)) return void 0;
        return this.byteOffset;
      }
    });
    function createBuffer(length) {
      if (length > K_MAX_LENGTH) {
        throw new RangeError('The value "' + length + '" is invalid for option "size"');
      }
      var buf = new Uint8Array(length);
      Object.setPrototypeOf(buf, Buffer4.prototype);
      return buf;
    }
    function Buffer4(arg, encodingOrOffset, length) {
      if (typeof arg === "number") {
        if (typeof encodingOrOffset === "string") {
          throw new TypeError('The "string" argument must be of type string. Received type number');
        }
        return allocUnsafe(arg);
      }
      return from2(arg, encodingOrOffset, length);
    }
    Buffer4.poolSize = 8192;
    function from2(value, encodingOrOffset, length) {
      if (typeof value === "string") {
        return fromString(value, encodingOrOffset);
      }
      if (ArrayBuffer.isView(value)) {
        return fromArrayView(value);
      }
      if (value == null) {
        throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type " + typeof value);
      }
      if (isInstance(value, ArrayBuffer) || value && isInstance(value.buffer, ArrayBuffer)) {
        return fromArrayBuffer(value, encodingOrOffset, length);
      }
      if (typeof SharedArrayBuffer !== "undefined" && (isInstance(value, SharedArrayBuffer) || value && isInstance(value.buffer, SharedArrayBuffer))) {
        return fromArrayBuffer(value, encodingOrOffset, length);
      }
      if (typeof value === "number") {
        throw new TypeError('The "value" argument must not be of type number. Received type number');
      }
      var valueOf = value.valueOf && value.valueOf();
      if (valueOf != null && valueOf !== value) {
        return Buffer4.from(valueOf, encodingOrOffset, length);
      }
      var b = fromObject(value);
      if (b) return b;
      if (typeof Symbol !== "undefined" && Symbol.toPrimitive != null && typeof value[Symbol.toPrimitive] === "function") {
        return Buffer4.from(value[Symbol.toPrimitive]("string"), encodingOrOffset, length);
      }
      throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type " + typeof value);
    }
    Buffer4.from = function(value, encodingOrOffset, length) {
      return from2(value, encodingOrOffset, length);
    };
    Object.setPrototypeOf(Buffer4.prototype, Uint8Array.prototype);
    Object.setPrototypeOf(Buffer4, Uint8Array);
    function assertSize(size) {
      if (typeof size !== "number") {
        throw new TypeError('"size" argument must be of type number');
      } else if (size < 0) {
        throw new RangeError('The value "' + size + '" is invalid for option "size"');
      }
    }
    function alloc(size, fill2, encoding) {
      assertSize(size);
      if (size <= 0) {
        return createBuffer(size);
      }
      if (fill2 !== void 0) {
        return typeof encoding === "string" ? createBuffer(size).fill(fill2, encoding) : createBuffer(size).fill(fill2);
      }
      return createBuffer(size);
    }
    Buffer4.alloc = function(size, fill2, encoding) {
      return alloc(size, fill2, encoding);
    };
    function allocUnsafe(size) {
      assertSize(size);
      return createBuffer(size < 0 ? 0 : checked(size) | 0);
    }
    Buffer4.allocUnsafe = function(size) {
      return allocUnsafe(size);
    };
    Buffer4.allocUnsafeSlow = function(size) {
      return allocUnsafe(size);
    };
    function fromString(string, encoding) {
      if (typeof encoding !== "string" || encoding === "") {
        encoding = "utf8";
      }
      if (!Buffer4.isEncoding(encoding)) {
        throw new TypeError("Unknown encoding: " + encoding);
      }
      var length = byteLength(string, encoding) | 0;
      var buf = createBuffer(length);
      var actual = buf.write(string, encoding);
      if (actual !== length) {
        buf = buf.slice(0, actual);
      }
      return buf;
    }
    function fromArrayLike(array) {
      var length = array.length < 0 ? 0 : checked(array.length) | 0;
      var buf = createBuffer(length);
      for (var i = 0; i < length; i += 1) {
        buf[i] = array[i] & 255;
      }
      return buf;
    }
    function fromArrayView(arrayView) {
      if (isInstance(arrayView, Uint8Array)) {
        var copy = new Uint8Array(arrayView);
        return fromArrayBuffer(copy.buffer, copy.byteOffset, copy.byteLength);
      }
      return fromArrayLike(arrayView);
    }
    function fromArrayBuffer(array, byteOffset, length) {
      if (byteOffset < 0 || array.byteLength < byteOffset) {
        throw new RangeError('"offset" is outside of buffer bounds');
      }
      if (array.byteLength < byteOffset + (length || 0)) {
        throw new RangeError('"length" is outside of buffer bounds');
      }
      var buf;
      if (byteOffset === void 0 && length === void 0) {
        buf = new Uint8Array(array);
      } else if (length === void 0) {
        buf = new Uint8Array(array, byteOffset);
      } else {
        buf = new Uint8Array(array, byteOffset, length);
      }
      Object.setPrototypeOf(buf, Buffer4.prototype);
      return buf;
    }
    function fromObject(obj) {
      if (Buffer4.isBuffer(obj)) {
        var len = checked(obj.length) | 0;
        var buf = createBuffer(len);
        if (buf.length === 0) {
          return buf;
        }
        obj.copy(buf, 0, 0, len);
        return buf;
      }
      if (obj.length !== void 0) {
        if (typeof obj.length !== "number" || numberIsNaN(obj.length)) {
          return createBuffer(0);
        }
        return fromArrayLike(obj);
      }
      if (obj.type === "Buffer" && Array.isArray(obj.data)) {
        return fromArrayLike(obj.data);
      }
    }
    function checked(length) {
      if (length >= K_MAX_LENGTH) {
        throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x" + K_MAX_LENGTH.toString(16) + " bytes");
      }
      return length | 0;
    }
    function SlowBuffer(length) {
      if (+length != length) {
        length = 0;
      }
      return Buffer4.alloc(+length);
    }
    Buffer4.isBuffer = function isBuffer(b) {
      return b != null && b._isBuffer === true && b !== Buffer4.prototype;
    };
    Buffer4.compare = function compare(a, b) {
      if (isInstance(a, Uint8Array)) a = Buffer4.from(a, a.offset, a.byteLength);
      if (isInstance(b, Uint8Array)) b = Buffer4.from(b, b.offset, b.byteLength);
      if (!Buffer4.isBuffer(a) || !Buffer4.isBuffer(b)) {
        throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');
      }
      if (a === b) return 0;
      var x = a.length;
      var y = b.length;
      for (var i = 0, len = Math.min(x, y); i < len; ++i) {
        if (a[i] !== b[i]) {
          x = a[i];
          y = b[i];
          break;
        }
      }
      if (x < y) return -1;
      if (y < x) return 1;
      return 0;
    };
    Buffer4.isEncoding = function isEncoding(encoding) {
      switch (String(encoding).toLowerCase()) {
        case "hex":
        case "utf8":
        case "utf-8":
        case "ascii":
        case "latin1":
        case "binary":
        case "base64":
        case "ucs2":
        case "ucs-2":
        case "utf16le":
        case "utf-16le":
          return true;
        default:
          return false;
      }
    };
    Buffer4.concat = function concat2(list, length) {
      if (!Array.isArray(list)) {
        throw new TypeError('"list" argument must be an Array of Buffers');
      }
      if (list.length === 0) {
        return Buffer4.alloc(0);
      }
      var i;
      if (length === void 0) {
        length = 0;
        for (i = 0; i < list.length; ++i) {
          length += list[i].length;
        }
      }
      var buffer = Buffer4.allocUnsafe(length);
      var pos = 0;
      for (i = 0; i < list.length; ++i) {
        var buf = list[i];
        if (isInstance(buf, Uint8Array)) {
          if (pos + buf.length > buffer.length) {
            Buffer4.from(buf).copy(buffer, pos);
          } else {
            Uint8Array.prototype.set.call(buffer, buf, pos);
          }
        } else if (!Buffer4.isBuffer(buf)) {
          throw new TypeError('"list" argument must be an Array of Buffers');
        } else {
          buf.copy(buffer, pos);
        }
        pos += buf.length;
      }
      return buffer;
    };
    function byteLength(string, encoding) {
      if (Buffer4.isBuffer(string)) {
        return string.length;
      }
      if (ArrayBuffer.isView(string) || isInstance(string, ArrayBuffer)) {
        return string.byteLength;
      }
      if (typeof string !== "string") {
        throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type ' + typeof string);
      }
      var len = string.length;
      var mustMatch = arguments.length > 2 && arguments[2] === true;
      if (!mustMatch && len === 0) return 0;
      var loweredCase = false;
      for (; ; ) {
        switch (encoding) {
          case "ascii":
          case "latin1":
          case "binary":
            return len;
          case "utf8":
          case "utf-8":
            return utf8ToBytes(string).length;
          case "ucs2":
          case "ucs-2":
          case "utf16le":
          case "utf-16le":
            return len * 2;
          case "hex":
            return len >>> 1;
          case "base64":
            return base64ToBytes(string).length;
          default:
            if (loweredCase) {
              return mustMatch ? -1 : utf8ToBytes(string).length;
            }
            encoding = ("" + encoding).toLowerCase();
            loweredCase = true;
        }
      }
    }
    Buffer4.byteLength = byteLength;
    function slowToString(encoding, start, end) {
      var loweredCase = false;
      if (start === void 0 || start < 0) {
        start = 0;
      }
      if (start > this.length) {
        return "";
      }
      if (end === void 0 || end > this.length) {
        end = this.length;
      }
      if (end <= 0) {
        return "";
      }
      end >>>= 0;
      start >>>= 0;
      if (end <= start) {
        return "";
      }
      if (!encoding) encoding = "utf8";
      while (true) {
        switch (encoding) {
          case "hex":
            return hexSlice(this, start, end);
          case "utf8":
          case "utf-8":
            return utf8Slice(this, start, end);
          case "ascii":
            return asciiSlice(this, start, end);
          case "latin1":
          case "binary":
            return latin1Slice(this, start, end);
          case "base64":
            return base64Slice(this, start, end);
          case "ucs2":
          case "ucs-2":
          case "utf16le":
          case "utf-16le":
            return utf16leSlice(this, start, end);
          default:
            if (loweredCase) throw new TypeError("Unknown encoding: " + encoding);
            encoding = (encoding + "").toLowerCase();
            loweredCase = true;
        }
      }
    }
    Buffer4.prototype._isBuffer = true;
    function swap(b, n, m) {
      var i = b[n];
      b[n] = b[m];
      b[m] = i;
    }
    Buffer4.prototype.swap16 = function swap16() {
      var len = this.length;
      if (len % 2 !== 0) {
        throw new RangeError("Buffer size must be a multiple of 16-bits");
      }
      for (var i = 0; i < len; i += 2) {
        swap(this, i, i + 1);
      }
      return this;
    };
    Buffer4.prototype.swap32 = function swap32() {
      var len = this.length;
      if (len % 4 !== 0) {
        throw new RangeError("Buffer size must be a multiple of 32-bits");
      }
      for (var i = 0; i < len; i += 4) {
        swap(this, i, i + 3);
        swap(this, i + 1, i + 2);
      }
      return this;
    };
    Buffer4.prototype.swap64 = function swap64() {
      var len = this.length;
      if (len % 8 !== 0) {
        throw new RangeError("Buffer size must be a multiple of 64-bits");
      }
      for (var i = 0; i < len; i += 8) {
        swap(this, i, i + 7);
        swap(this, i + 1, i + 6);
        swap(this, i + 2, i + 5);
        swap(this, i + 3, i + 4);
      }
      return this;
    };
    Buffer4.prototype.toString = function toString() {
      var length = this.length;
      if (length === 0) return "";
      if (arguments.length === 0) return utf8Slice(this, 0, length);
      return slowToString.apply(this, arguments);
    };
    Buffer4.prototype.toLocaleString = Buffer4.prototype.toString;
    Buffer4.prototype.equals = function equals(b) {
      if (!Buffer4.isBuffer(b)) throw new TypeError("Argument must be a Buffer");
      if (this === b) return true;
      return Buffer4.compare(this, b) === 0;
    };
    Buffer4.prototype.inspect = function inspect() {
      var str = "";
      var max = exports.INSPECT_MAX_BYTES;
      str = this.toString("hex", 0, max).replace(/(.{2})/g, "$1 ").trim();
      if (this.length > max) str += " ... ";
      return "<Buffer " + str + ">";
    };
    if (customInspectSymbol) {
      Buffer4.prototype[customInspectSymbol] = Buffer4.prototype.inspect;
    }
    Buffer4.prototype.compare = function compare(target, start, end, thisStart, thisEnd) {
      if (isInstance(target, Uint8Array)) {
        target = Buffer4.from(target, target.offset, target.byteLength);
      }
      if (!Buffer4.isBuffer(target)) {
        throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type ' + typeof target);
      }
      if (start === void 0) {
        start = 0;
      }
      if (end === void 0) {
        end = target ? target.length : 0;
      }
      if (thisStart === void 0) {
        thisStart = 0;
      }
      if (thisEnd === void 0) {
        thisEnd = this.length;
      }
      if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
        throw new RangeError("out of range index");
      }
      if (thisStart >= thisEnd && start >= end) {
        return 0;
      }
      if (thisStart >= thisEnd) {
        return -1;
      }
      if (start >= end) {
        return 1;
      }
      start >>>= 0;
      end >>>= 0;
      thisStart >>>= 0;
      thisEnd >>>= 0;
      if (this === target) return 0;
      var x = thisEnd - thisStart;
      var y = end - start;
      var len = Math.min(x, y);
      var thisCopy = this.slice(thisStart, thisEnd);
      var targetCopy = target.slice(start, end);
      for (var i = 0; i < len; ++i) {
        if (thisCopy[i] !== targetCopy[i]) {
          x = thisCopy[i];
          y = targetCopy[i];
          break;
        }
      }
      if (x < y) return -1;
      if (y < x) return 1;
      return 0;
    };
    function bidirectionalIndexOf(buffer, val, byteOffset, encoding, dir) {
      if (buffer.length === 0) return -1;
      if (typeof byteOffset === "string") {
        encoding = byteOffset;
        byteOffset = 0;
      } else if (byteOffset > 2147483647) {
        byteOffset = 2147483647;
      } else if (byteOffset < -2147483648) {
        byteOffset = -2147483648;
      }
      byteOffset = +byteOffset;
      if (numberIsNaN(byteOffset)) {
        byteOffset = dir ? 0 : buffer.length - 1;
      }
      if (byteOffset < 0) byteOffset = buffer.length + byteOffset;
      if (byteOffset >= buffer.length) {
        if (dir) return -1;
        else byteOffset = buffer.length - 1;
      } else if (byteOffset < 0) {
        if (dir) byteOffset = 0;
        else return -1;
      }
      if (typeof val === "string") {
        val = Buffer4.from(val, encoding);
      }
      if (Buffer4.isBuffer(val)) {
        if (val.length === 0) {
          return -1;
        }
        return arrayIndexOf(buffer, val, byteOffset, encoding, dir);
      } else if (typeof val === "number") {
        val = val & 255;
        if (typeof Uint8Array.prototype.indexOf === "function") {
          if (dir) {
            return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset);
          } else {
            return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset);
          }
        }
        return arrayIndexOf(buffer, [val], byteOffset, encoding, dir);
      }
      throw new TypeError("val must be string, number or Buffer");
    }
    function arrayIndexOf(arr, val, byteOffset, encoding, dir) {
      var indexSize = 1;
      var arrLength = arr.length;
      var valLength = val.length;
      if (encoding !== void 0) {
        encoding = String(encoding).toLowerCase();
        if (encoding === "ucs2" || encoding === "ucs-2" || encoding === "utf16le" || encoding === "utf-16le") {
          if (arr.length < 2 || val.length < 2) {
            return -1;
          }
          indexSize = 2;
          arrLength /= 2;
          valLength /= 2;
          byteOffset /= 2;
        }
      }
      function read(buf, i2) {
        if (indexSize === 1) {
          return buf[i2];
        } else {
          return buf.readUInt16BE(i2 * indexSize);
        }
      }
      var i;
      if (dir) {
        var foundIndex = -1;
        for (i = byteOffset; i < arrLength; i++) {
          if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
            if (foundIndex === -1) foundIndex = i;
            if (i - foundIndex + 1 === valLength) return foundIndex * indexSize;
          } else {
            if (foundIndex !== -1) i -= i - foundIndex;
            foundIndex = -1;
          }
        }
      } else {
        if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength;
        for (i = byteOffset; i >= 0; i--) {
          var found = true;
          for (var j = 0; j < valLength; j++) {
            if (read(arr, i + j) !== read(val, j)) {
              found = false;
              break;
            }
          }
          if (found) return i;
        }
      }
      return -1;
    }
    Buffer4.prototype.includes = function includes(val, byteOffset, encoding) {
      return this.indexOf(val, byteOffset, encoding) !== -1;
    };
    Buffer4.prototype.indexOf = function indexOf(val, byteOffset, encoding) {
      return bidirectionalIndexOf(this, val, byteOffset, encoding, true);
    };
    Buffer4.prototype.lastIndexOf = function lastIndexOf(val, byteOffset, encoding) {
      return bidirectionalIndexOf(this, val, byteOffset, encoding, false);
    };
    function hexWrite(buf, string, offset, length) {
      offset = Number(offset) || 0;
      var remaining = buf.length - offset;
      if (!length) {
        length = remaining;
      } else {
        length = Number(length);
        if (length > remaining) {
          length = remaining;
        }
      }
      var strLen = string.length;
      if (length > strLen / 2) {
        length = strLen / 2;
      }
      for (var i = 0; i < length; ++i) {
        var parsed = parseInt(string.substr(i * 2, 2), 16);
        if (numberIsNaN(parsed)) return i;
        buf[offset + i] = parsed;
      }
      return i;
    }
    function utf8Write(buf, string, offset, length) {
      return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length);
    }
    function asciiWrite(buf, string, offset, length) {
      return blitBuffer(asciiToBytes(string), buf, offset, length);
    }
    function base64Write(buf, string, offset, length) {
      return blitBuffer(base64ToBytes(string), buf, offset, length);
    }
    function ucs2Write(buf, string, offset, length) {
      return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length);
    }
    Buffer4.prototype.write = function write(string, offset, length, encoding) {
      if (offset === void 0) {
        encoding = "utf8";
        length = this.length;
        offset = 0;
      } else if (length === void 0 && typeof offset === "string") {
        encoding = offset;
        length = this.length;
        offset = 0;
      } else if (isFinite(offset)) {
        offset = offset >>> 0;
        if (isFinite(length)) {
          length = length >>> 0;
          if (encoding === void 0) encoding = "utf8";
        } else {
          encoding = length;
          length = void 0;
        }
      } else {
        throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
      }
      var remaining = this.length - offset;
      if (length === void 0 || length > remaining) length = remaining;
      if (string.length > 0 && (length < 0 || offset < 0) || offset > this.length) {
        throw new RangeError("Attempt to write outside buffer bounds");
      }
      if (!encoding) encoding = "utf8";
      var loweredCase = false;
      for (; ; ) {
        switch (encoding) {
          case "hex":
            return hexWrite(this, string, offset, length);
          case "utf8":
          case "utf-8":
            return utf8Write(this, string, offset, length);
          case "ascii":
          case "latin1":
          case "binary":
            return asciiWrite(this, string, offset, length);
          case "base64":
            return base64Write(this, string, offset, length);
          case "ucs2":
          case "ucs-2":
          case "utf16le":
          case "utf-16le":
            return ucs2Write(this, string, offset, length);
          default:
            if (loweredCase) throw new TypeError("Unknown encoding: " + encoding);
            encoding = ("" + encoding).toLowerCase();
            loweredCase = true;
        }
      }
    };
    Buffer4.prototype.toJSON = function toJSON() {
      return {
        type: "Buffer",
        data: Array.prototype.slice.call(this._arr || this, 0)
      };
    };
    function base64Slice(buf, start, end) {
      if (start === 0 && end === buf.length) {
        return base64.fromByteArray(buf);
      } else {
        return base64.fromByteArray(buf.slice(start, end));
      }
    }
    function utf8Slice(buf, start, end) {
      end = Math.min(buf.length, end);
      var res = [];
      var i = start;
      while (i < end) {
        var firstByte = buf[i];
        var codePoint = null;
        var bytesPerSequence = firstByte > 239 ? 4 : firstByte > 223 ? 3 : firstByte > 191 ? 2 : 1;
        if (i + bytesPerSequence <= end) {
          var secondByte, thirdByte, fourthByte, tempCodePoint;
          switch (bytesPerSequence) {
            case 1:
              if (firstByte < 128) {
                codePoint = firstByte;
              }
              break;
            case 2:
              secondByte = buf[i + 1];
              if ((secondByte & 192) === 128) {
                tempCodePoint = (firstByte & 31) << 6 | secondByte & 63;
                if (tempCodePoint > 127) {
                  codePoint = tempCodePoint;
                }
              }
              break;
            case 3:
              secondByte = buf[i + 1];
              thirdByte = buf[i + 2];
              if ((secondByte & 192) === 128 && (thirdByte & 192) === 128) {
                tempCodePoint = (firstByte & 15) << 12 | (secondByte & 63) << 6 | thirdByte & 63;
                if (tempCodePoint > 2047 && (tempCodePoint < 55296 || tempCodePoint > 57343)) {
                  codePoint = tempCodePoint;
                }
              }
              break;
            case 4:
              secondByte = buf[i + 1];
              thirdByte = buf[i + 2];
              fourthByte = buf[i + 3];
              if ((secondByte & 192) === 128 && (thirdByte & 192) === 128 && (fourthByte & 192) === 128) {
                tempCodePoint = (firstByte & 15) << 18 | (secondByte & 63) << 12 | (thirdByte & 63) << 6 | fourthByte & 63;
                if (tempCodePoint > 65535 && tempCodePoint < 1114112) {
                  codePoint = tempCodePoint;
                }
              }
          }
        }
        if (codePoint === null) {
          codePoint = 65533;
          bytesPerSequence = 1;
        } else if (codePoint > 65535) {
          codePoint -= 65536;
          res.push(codePoint >>> 10 & 1023 | 55296);
          codePoint = 56320 | codePoint & 1023;
        }
        res.push(codePoint);
        i += bytesPerSequence;
      }
      return decodeCodePointsArray(res);
    }
    var MAX_ARGUMENTS_LENGTH = 4096;
    function decodeCodePointsArray(codePoints) {
      var len = codePoints.length;
      if (len <= MAX_ARGUMENTS_LENGTH) {
        return String.fromCharCode.apply(String, codePoints);
      }
      var res = "";
      var i = 0;
      while (i < len) {
        res += String.fromCharCode.apply(String, codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH));
      }
      return res;
    }
    function asciiSlice(buf, start, end) {
      var ret = "";
      end = Math.min(buf.length, end);
      for (var i = start; i < end; ++i) {
        ret += String.fromCharCode(buf[i] & 127);
      }
      return ret;
    }
    function latin1Slice(buf, start, end) {
      var ret = "";
      end = Math.min(buf.length, end);
      for (var i = start; i < end; ++i) {
        ret += String.fromCharCode(buf[i]);
      }
      return ret;
    }
    function hexSlice(buf, start, end) {
      var len = buf.length;
      if (!start || start < 0) start = 0;
      if (!end || end < 0 || end > len) end = len;
      var out = "";
      for (var i = start; i < end; ++i) {
        out += hexSliceLookupTable[buf[i]];
      }
      return out;
    }
    function utf16leSlice(buf, start, end) {
      var bytes = buf.slice(start, end);
      var res = "";
      for (var i = 0; i < bytes.length - 1; i += 2) {
        res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256);
      }
      return res;
    }
    Buffer4.prototype.slice = function slice(start, end) {
      var len = this.length;
      start = ~~start;
      end = end === void 0 ? len : ~~end;
      if (start < 0) {
        start += len;
        if (start < 0) start = 0;
      } else if (start > len) {
        start = len;
      }
      if (end < 0) {
        end += len;
        if (end < 0) end = 0;
      } else if (end > len) {
        end = len;
      }
      if (end < start) end = start;
      var newBuf = this.subarray(start, end);
      Object.setPrototypeOf(newBuf, Buffer4.prototype);
      return newBuf;
    };
    function checkOffset(offset, ext, length) {
      if (offset % 1 !== 0 || offset < 0) throw new RangeError("offset is not uint");
      if (offset + ext > length) throw new RangeError("Trying to access beyond buffer length");
    }
    Buffer4.prototype.readUintLE = Buffer4.prototype.readUIntLE = function readUIntLE(offset, byteLength2, noAssert) {
      offset = offset >>> 0;
      byteLength2 = byteLength2 >>> 0;
      if (!noAssert) checkOffset(offset, byteLength2, this.length);
      var val = this[offset];
      var mul = 1;
      var i = 0;
      while (++i < byteLength2 && (mul *= 256)) {
        val += this[offset + i] * mul;
      }
      return val;
    };
    Buffer4.prototype.readUintBE = Buffer4.prototype.readUIntBE = function readUIntBE(offset, byteLength2, noAssert) {
      offset = offset >>> 0;
      byteLength2 = byteLength2 >>> 0;
      if (!noAssert) {
        checkOffset(offset, byteLength2, this.length);
      }
      var val = this[offset + --byteLength2];
      var mul = 1;
      while (byteLength2 > 0 && (mul *= 256)) {
        val += this[offset + --byteLength2] * mul;
      }
      return val;
    };
    Buffer4.prototype.readUint8 = Buffer4.prototype.readUInt8 = function readUInt8(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 1, this.length);
      return this[offset];
    };
    Buffer4.prototype.readUint16LE = Buffer4.prototype.readUInt16LE = function readUInt16LE(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 2, this.length);
      return this[offset] | this[offset + 1] << 8;
    };
    Buffer4.prototype.readUint16BE = Buffer4.prototype.readUInt16BE = function readUInt16BE(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 2, this.length);
      return this[offset] << 8 | this[offset + 1];
    };
    Buffer4.prototype.readUint32LE = Buffer4.prototype.readUInt32LE = function readUInt32LE(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 4, this.length);
      return (this[offset] | this[offset + 1] << 8 | this[offset + 2] << 16) + this[offset + 3] * 16777216;
    };
    Buffer4.prototype.readUint32BE = Buffer4.prototype.readUInt32BE = function readUInt32BE(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 4, this.length);
      return this[offset] * 16777216 + (this[offset + 1] << 16 | this[offset + 2] << 8 | this[offset + 3]);
    };
    Buffer4.prototype.readIntLE = function readIntLE(offset, byteLength2, noAssert) {
      offset = offset >>> 0;
      byteLength2 = byteLength2 >>> 0;
      if (!noAssert) checkOffset(offset, byteLength2, this.length);
      var val = this[offset];
      var mul = 1;
      var i = 0;
      while (++i < byteLength2 && (mul *= 256)) {
        val += this[offset + i] * mul;
      }
      mul *= 128;
      if (val >= mul) val -= Math.pow(2, 8 * byteLength2);
      return val;
    };
    Buffer4.prototype.readIntBE = function readIntBE(offset, byteLength2, noAssert) {
      offset = offset >>> 0;
      byteLength2 = byteLength2 >>> 0;
      if (!noAssert) checkOffset(offset, byteLength2, this.length);
      var i = byteLength2;
      var mul = 1;
      var val = this[offset + --i];
      while (i > 0 && (mul *= 256)) {
        val += this[offset + --i] * mul;
      }
      mul *= 128;
      if (val >= mul) val -= Math.pow(2, 8 * byteLength2);
      return val;
    };
    Buffer4.prototype.readInt8 = function readInt8(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 1, this.length);
      if (!(this[offset] & 128)) return this[offset];
      return (255 - this[offset] + 1) * -1;
    };
    Buffer4.prototype.readInt16LE = function readInt16LE(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 2, this.length);
      var val = this[offset] | this[offset + 1] << 8;
      return val & 32768 ? val | 4294901760 : val;
    };
    Buffer4.prototype.readInt16BE = function readInt16BE(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 2, this.length);
      var val = this[offset + 1] | this[offset] << 8;
      return val & 32768 ? val | 4294901760 : val;
    };
    Buffer4.prototype.readInt32LE = function readInt32LE(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 4, this.length);
      return this[offset] | this[offset + 1] << 8 | this[offset + 2] << 16 | this[offset + 3] << 24;
    };
    Buffer4.prototype.readInt32BE = function readInt32BE(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 4, this.length);
      return this[offset] << 24 | this[offset + 1] << 16 | this[offset + 2] << 8 | this[offset + 3];
    };
    Buffer4.prototype.readFloatLE = function readFloatLE(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 4, this.length);
      return ieee754.read(this, offset, true, 23, 4);
    };
    Buffer4.prototype.readFloatBE = function readFloatBE(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 4, this.length);
      return ieee754.read(this, offset, false, 23, 4);
    };
    Buffer4.prototype.readDoubleLE = function readDoubleLE(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 8, this.length);
      return ieee754.read(this, offset, true, 52, 8);
    };
    Buffer4.prototype.readDoubleBE = function readDoubleBE(offset, noAssert) {
      offset = offset >>> 0;
      if (!noAssert) checkOffset(offset, 8, this.length);
      return ieee754.read(this, offset, false, 52, 8);
    };
    function checkInt(buf, value, offset, ext, max, min) {
      if (!Buffer4.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance');
      if (value > max || value < min) throw new RangeError('"value" argument is out of bounds');
      if (offset + ext > buf.length) throw new RangeError("Index out of range");
    }
    Buffer4.prototype.writeUintLE = Buffer4.prototype.writeUIntLE = function writeUIntLE(value, offset, byteLength2, noAssert) {
      value = +value;
      offset = offset >>> 0;
      byteLength2 = byteLength2 >>> 0;
      if (!noAssert) {
        var maxBytes = Math.pow(2, 8 * byteLength2) - 1;
        checkInt(this, value, offset, byteLength2, maxBytes, 0);
      }
      var mul = 1;
      var i = 0;
      this[offset] = value & 255;
      while (++i < byteLength2 && (mul *= 256)) {
        this[offset + i] = value / mul & 255;
      }
      return offset + byteLength2;
    };
    Buffer4.prototype.writeUintBE = Buffer4.prototype.writeUIntBE = function writeUIntBE(value, offset, byteLength2, noAssert) {
      value = +value;
      offset = offset >>> 0;
      byteLength2 = byteLength2 >>> 0;
      if (!noAssert) {
        var maxBytes = Math.pow(2, 8 * byteLength2) - 1;
        checkInt(this, value, offset, byteLength2, maxBytes, 0);
      }
      var i = byteLength2 - 1;
      var mul = 1;
      this[offset + i] = value & 255;
      while (--i >= 0 && (mul *= 256)) {
        this[offset + i] = value / mul & 255;
      }
      return offset + byteLength2;
    };
    Buffer4.prototype.writeUint8 = Buffer4.prototype.writeUInt8 = function writeUInt8(value, offset, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) checkInt(this, value, offset, 1, 255, 0);
      this[offset] = value & 255;
      return offset + 1;
    };
    Buffer4.prototype.writeUint16LE = Buffer4.prototype.writeUInt16LE = function writeUInt16LE(value, offset, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) checkInt(this, value, offset, 2, 65535, 0);
      this[offset] = value & 255;
      this[offset + 1] = value >>> 8;
      return offset + 2;
    };
    Buffer4.prototype.writeUint16BE = Buffer4.prototype.writeUInt16BE = function writeUInt16BE(value, offset, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) checkInt(this, value, offset, 2, 65535, 0);
      this[offset] = value >>> 8;
      this[offset + 1] = value & 255;
      return offset + 2;
    };
    Buffer4.prototype.writeUint32LE = Buffer4.prototype.writeUInt32LE = function writeUInt32LE(value, offset, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) checkInt(this, value, offset, 4, 4294967295, 0);
      this[offset + 3] = value >>> 24;
      this[offset + 2] = value >>> 16;
      this[offset + 1] = value >>> 8;
      this[offset] = value & 255;
      return offset + 4;
    };
    Buffer4.prototype.writeUint32BE = Buffer4.prototype.writeUInt32BE = function writeUInt32BE(value, offset, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) checkInt(this, value, offset, 4, 4294967295, 0);
      this[offset] = value >>> 24;
      this[offset + 1] = value >>> 16;
      this[offset + 2] = value >>> 8;
      this[offset + 3] = value & 255;
      return offset + 4;
    };
    Buffer4.prototype.writeIntLE = function writeIntLE(value, offset, byteLength2, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) {
        var limit = Math.pow(2, 8 * byteLength2 - 1);
        checkInt(this, value, offset, byteLength2, limit - 1, -limit);
      }
      var i = 0;
      var mul = 1;
      var sub = 0;
      this[offset] = value & 255;
      while (++i < byteLength2 && (mul *= 256)) {
        if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
          sub = 1;
        }
        this[offset + i] = (value / mul >> 0) - sub & 255;
      }
      return offset + byteLength2;
    };
    Buffer4.prototype.writeIntBE = function writeIntBE(value, offset, byteLength2, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) {
        var limit = Math.pow(2, 8 * byteLength2 - 1);
        checkInt(this, value, offset, byteLength2, limit - 1, -limit);
      }
      var i = byteLength2 - 1;
      var mul = 1;
      var sub = 0;
      this[offset + i] = value & 255;
      while (--i >= 0 && (mul *= 256)) {
        if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
          sub = 1;
        }
        this[offset + i] = (value / mul >> 0) - sub & 255;
      }
      return offset + byteLength2;
    };
    Buffer4.prototype.writeInt8 = function writeInt8(value, offset, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) checkInt(this, value, offset, 1, 127, -128);
      if (value < 0) value = 255 + value + 1;
      this[offset] = value & 255;
      return offset + 1;
    };
    Buffer4.prototype.writeInt16LE = function writeInt16LE(value, offset, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) checkInt(this, value, offset, 2, 32767, -32768);
      this[offset] = value & 255;
      this[offset + 1] = value >>> 8;
      return offset + 2;
    };
    Buffer4.prototype.writeInt16BE = function writeInt16BE(value, offset, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) checkInt(this, value, offset, 2, 32767, -32768);
      this[offset] = value >>> 8;
      this[offset + 1] = value & 255;
      return offset + 2;
    };
    Buffer4.prototype.writeInt32LE = function writeInt32LE(value, offset, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) checkInt(this, value, offset, 4, 2147483647, -2147483648);
      this[offset] = value & 255;
      this[offset + 1] = value >>> 8;
      this[offset + 2] = value >>> 16;
      this[offset + 3] = value >>> 24;
      return offset + 4;
    };
    Buffer4.prototype.writeInt32BE = function writeInt32BE(value, offset, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) checkInt(this, value, offset, 4, 2147483647, -2147483648);
      if (value < 0) value = 4294967295 + value + 1;
      this[offset] = value >>> 24;
      this[offset + 1] = value >>> 16;
      this[offset + 2] = value >>> 8;
      this[offset + 3] = value & 255;
      return offset + 4;
    };
    function checkIEEE754(buf, value, offset, ext, max, min) {
      if (offset + ext > buf.length) throw new RangeError("Index out of range");
      if (offset < 0) throw new RangeError("Index out of range");
    }
    function writeFloat(buf, value, offset, littleEndian, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) {
        checkIEEE754(buf, value, offset, 4, 34028234663852886e22, -34028234663852886e22);
      }
      ieee754.write(buf, value, offset, littleEndian, 23, 4);
      return offset + 4;
    }
    Buffer4.prototype.writeFloatLE = function writeFloatLE(value, offset, noAssert) {
      return writeFloat(this, value, offset, true, noAssert);
    };
    Buffer4.prototype.writeFloatBE = function writeFloatBE(value, offset, noAssert) {
      return writeFloat(this, value, offset, false, noAssert);
    };
    function writeDouble(buf, value, offset, littleEndian, noAssert) {
      value = +value;
      offset = offset >>> 0;
      if (!noAssert) {
        checkIEEE754(buf, value, offset, 8, 17976931348623157e292, -17976931348623157e292);
      }
      ieee754.write(buf, value, offset, littleEndian, 52, 8);
      return offset + 8;
    }
    Buffer4.prototype.writeDoubleLE = function writeDoubleLE(value, offset, noAssert) {
      return writeDouble(this, value, offset, true, noAssert);
    };
    Buffer4.prototype.writeDoubleBE = function writeDoubleBE(value, offset, noAssert) {
      return writeDouble(this, value, offset, false, noAssert);
    };
    Buffer4.prototype.copy = function copy(target, targetStart, start, end) {
      if (!Buffer4.isBuffer(target)) throw new TypeError("argument should be a Buffer");
      if (!start) start = 0;
      if (!end && end !== 0) end = this.length;
      if (targetStart >= target.length) targetStart = target.length;
      if (!targetStart) targetStart = 0;
      if (end > 0 && end < start) end = start;
      if (end === start) return 0;
      if (target.length === 0 || this.length === 0) return 0;
      if (targetStart < 0) {
        throw new RangeError("targetStart out of bounds");
      }
      if (start < 0 || start >= this.length) throw new RangeError("Index out of range");
      if (end < 0) throw new RangeError("sourceEnd out of bounds");
      if (end > this.length) end = this.length;
      if (target.length - targetStart < end - start) {
        end = target.length - targetStart + start;
      }
      var len = end - start;
      if (this === target && typeof Uint8Array.prototype.copyWithin === "function") {
        this.copyWithin(targetStart, start, end);
      } else {
        Uint8Array.prototype.set.call(target, this.subarray(start, end), targetStart);
      }
      return len;
    };
    Buffer4.prototype.fill = function fill2(val, start, end, encoding) {
      if (typeof val === "string") {
        if (typeof start === "string") {
          encoding = start;
          start = 0;
          end = this.length;
        } else if (typeof end === "string") {
          encoding = end;
          end = this.length;
        }
        if (encoding !== void 0 && typeof encoding !== "string") {
          throw new TypeError("encoding must be a string");
        }
        if (typeof encoding === "string" && !Buffer4.isEncoding(encoding)) {
          throw new TypeError("Unknown encoding: " + encoding);
        }
        if (val.length === 1) {
          var code = val.charCodeAt(0);
          if (encoding === "utf8" && code < 128 || encoding === "latin1") {
            val = code;
          }
        }
      } else if (typeof val === "number") {
        val = val & 255;
      } else if (typeof val === "boolean") {
        val = Number(val);
      }
      if (start < 0 || this.length < start || this.length < end) {
        throw new RangeError("Out of range index");
      }
      if (end <= start) {
        return this;
      }
      start = start >>> 0;
      end = end === void 0 ? this.length : end >>> 0;
      if (!val) val = 0;
      var i;
      if (typeof val === "number") {
        for (i = start; i < end; ++i) {
          this[i] = val;
        }
      } else {
        var bytes = Buffer4.isBuffer(val) ? val : Buffer4.from(val, encoding);
        var len = bytes.length;
        if (len === 0) {
          throw new TypeError('The value "' + val + '" is invalid for argument "value"');
        }
        for (i = 0; i < end - start; ++i) {
          this[i + start] = bytes[i % len];
        }
      }
      return this;
    };
    var INVALID_BASE64_RE = /[^+/0-9A-Za-z-_]/g;
    function base64clean(str) {
      str = str.split("=")[0];
      str = str.trim().replace(INVALID_BASE64_RE, "");
      if (str.length < 2) return "";
      while (str.length % 4 !== 0) {
        str = str + "=";
      }
      return str;
    }
    function utf8ToBytes(string, units) {
      units = units || Infinity;
      var codePoint;
      var length = string.length;
      var leadSurrogate = null;
      var bytes = [];
      for (var i = 0; i < length; ++i) {
        codePoint = string.charCodeAt(i);
        if (codePoint > 55295 && codePoint < 57344) {
          if (!leadSurrogate) {
            if (codePoint > 56319) {
              if ((units -= 3) > -1) bytes.push(239, 191, 189);
              continue;
            } else if (i + 1 === length) {
              if ((units -= 3) > -1) bytes.push(239, 191, 189);
              continue;
            }
            leadSurrogate = codePoint;
            continue;
          }
          if (codePoint < 56320) {
            if ((units -= 3) > -1) bytes.push(239, 191, 189);
            leadSurrogate = codePoint;
            continue;
          }
          codePoint = (leadSurrogate - 55296 << 10 | codePoint - 56320) + 65536;
        } else if (leadSurrogate) {
          if ((units -= 3) > -1) bytes.push(239, 191, 189);
        }
        leadSurrogate = null;
        if (codePoint < 128) {
          if ((units -= 1) < 0) break;
          bytes.push(codePoint);
        } else if (codePoint < 2048) {
          if ((units -= 2) < 0) break;
          bytes.push(codePoint >> 6 | 192, codePoint & 63 | 128);
        } else if (codePoint < 65536) {
          if ((units -= 3) < 0) break;
          bytes.push(codePoint >> 12 | 224, codePoint >> 6 & 63 | 128, codePoint & 63 | 128);
        } else if (codePoint < 1114112) {
          if ((units -= 4) < 0) break;
          bytes.push(codePoint >> 18 | 240, codePoint >> 12 & 63 | 128, codePoint >> 6 & 63 | 128, codePoint & 63 | 128);
        } else {
          throw new Error("Invalid code point");
        }
      }
      return bytes;
    }
    function asciiToBytes(str) {
      var byteArray = [];
      for (var i = 0; i < str.length; ++i) {
        byteArray.push(str.charCodeAt(i) & 255);
      }
      return byteArray;
    }
    function utf16leToBytes(str, units) {
      var c, hi, lo;
      var byteArray = [];
      for (var i = 0; i < str.length; ++i) {
        if ((units -= 2) < 0) break;
        c = str.charCodeAt(i);
        hi = c >> 8;
        lo = c % 256;
        byteArray.push(lo);
        byteArray.push(hi);
      }
      return byteArray;
    }
    function base64ToBytes(str) {
      return base64.toByteArray(base64clean(str));
    }
    function blitBuffer(src, dst, offset, length) {
      for (var i = 0; i < length; ++i) {
        if (i + offset >= dst.length || i >= src.length) break;
        dst[i + offset] = src[i];
      }
      return i;
    }
    function isInstance(obj, type) {
      return obj instanceof type || obj != null && obj.constructor != null && obj.constructor.name != null && obj.constructor.name === type.name;
    }
    function numberIsNaN(obj) {
      return obj !== obj;
    }
    var hexSliceLookupTable = function() {
      var alphabet = "0123456789abcdef";
      var table = new Array(256);
      for (var i = 0; i < 16; ++i) {
        var i16 = i * 16;
        for (var j = 0; j < 16; ++j) {
          table[i16 + j] = alphabet[i] + alphabet[j];
        }
      }
      return table;
    }();
  }
});

// src/app/app-routing.module.ts
var routes = [];
var AppRoutingModule = class _AppRoutingModule {
  static {
    this.\u0275fac = function AppRoutingModule_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _AppRoutingModule)();
    };
  }
  static {
    this.\u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({ type: _AppRoutingModule });
  }
  static {
    this.\u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({ imports: [RouterModule.forRoot(routes, {}), RouterModule] });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(AppRoutingModule, [{
    type: NgModule,
    args: [{
      imports: [RouterModule.forRoot(routes, {})],
      exports: [RouterModule]
    }]
  }], null, null);
})();

// src/app/app.component.ts
var AppComponent = class _AppComponent {
  constructor(themeService) {
    this.themeService = themeService;
    this.themeService.setTheme(poThemeDefault, PoThemeTypeEnum.light, PoThemeA11yEnum.AA);
    this.themeService.setA11yDefaultSizeSmall(true);
  }
  ngOnInit() {
  }
  static {
    this.\u0275fac = function AppComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _AppComponent)(\u0275\u0275directiveInject(PoThemeService));
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _AppComponent, selectors: [["app-root"]], standalone: false, decls: 1, vars: 0, template: function AppComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275element(0, "router-outlet");
      }
    }, dependencies: [RouterOutlet], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(AppComponent, [{
    type: Component,
    args: [{ selector: "app-root", standalone: false, template: "\r\n<router-outlet></router-outlet>\r\n" }]
  }], () => [{ type: PoThemeService }], null);
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(AppComponent, { className: "AppComponent", filePath: "src/app/app.component.ts", lineNumber: 10 });
})();

// node_modules/@angular/common/locales/pt.js
var u = void 0;
function plural(val) {
  const n = val, i = Math.floor(Math.abs(val)), v = val.toString().replace(/^[^.]*\.?/, "").length, e = parseInt(val.toString().replace(/^[^e]*(e([-+]?\d+))?/, "$2")) || 0;
  if (i === Math.floor(i) && i >= 0 && i <= 1) return 1;
  if (e === 0 && !(i === 0) && i % 1e6 === 0 && v === 0 || !(e >= 0 && e <= 5)) return 4;
  return 5;
}
var pt_default = ["pt", [["AM", "PM"], u, u], u, [["D", "S", "T", "Q", "Q", "S", "S"], ["dom.", "seg.", "ter.", "qua.", "qui.", "sex.", "s\xE1b."], ["domingo", "segunda-feira", "ter\xE7a-feira", "quarta-feira", "quinta-feira", "sexta-feira", "s\xE1bado"], ["dom.", "seg.", "ter.", "qua.", "qui.", "sex.", "s\xE1b."]], u, [["J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D"], ["jan.", "fev.", "mar.", "abr.", "mai.", "jun.", "jul.", "ago.", "set.", "out.", "nov.", "dez."], ["janeiro", "fevereiro", "mar\xE7o", "abril", "maio", "junho", "julho", "agosto", "setembro", "outubro", "novembro", "dezembro"]], u, [["a.C.", "d.C."], u, ["antes de Cristo", "depois de Cristo"]], 0, [6, 0], ["dd/MM/y", "d 'de' MMM 'de' y", "d 'de' MMMM 'de' y", "EEEE, d 'de' MMMM 'de' y"], ["HH:mm", "HH:mm:ss", "HH:mm:ss z", "HH:mm:ss zzzz"], ["{1} {0}", u, u, u], [",", ".", ";", "%", "+", "-", "E", "\xD7", "\u2030", "\u221E", "NaN", ":"], ["#,##0.###", "#,##0%", "\xA4\xA0#,##0.00", "#E0"], "BRL", "R$", "Real brasileiro", {
  "AUD": ["AU$", "$"],
  "BYN": [u, "\u0440."],
  "JPY": ["JP\xA5", "\xA5"],
  "PHP": [u, "\u20B1"],
  "PTE": ["Esc."],
  "RON": [u, "L"],
  "SYP": [u, "S\xA3"],
  "THB": ["\u0E3F"],
  "TWD": ["NT$"],
  "USD": ["US$", "$"]
}, "ltr", plural];

// src/environments/environment.ts
var environment = {
  production: true,
  nomePortal: "INPLAC RH",
  portalFornecedorCodigo: "000007",
  urlApiProtheus: "https://servicos.inplac.com.br:10380/rest01",
  urlGestaoArquivo: "https://gestaoarquivo.inplac.com.br",
  urlPortalMeuRH: "https://meurh.inplac.com.br:10580/01",
  urlApiInplac: "https://api.inplac.com.br",
  patternPadraoTotvs: "^[A-Za-z0-9\\\\/()\\{\\}\\[\\]\\*\\.\\,;?!@#$%&-_=+ ]+$"
};

// node_modules/@po-ui/ng-storage/fesm2022/po-ui-ng-storage.mjs
var LocalForage = __toESM(require_localforage(), 1);

// node_modules/custom-idle-queue/dist/es/index.js
var IdleQueue = function IdleQueue2() {
  var parallels = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 1;
  this._parallels = parallels || 1;
  this._qC = 0;
  this._iC = /* @__PURE__ */ new Set();
  this._lHN = 0;
  this._hPM = /* @__PURE__ */ new Map();
  this._pHM = /* @__PURE__ */ new Map();
};
IdleQueue.prototype = {
  isIdle: function isIdle() {
    return this._qC < this._parallels;
  },
  /**
   * creates a lock in the queue
   * and returns an unlock-function to remove the lock from the queue
   * @return {function} unlock function than must be called afterwards
   */
  lock: function lock() {
    this._qC++;
  },
  unlock: function unlock() {
    this._qC--;
    _tryIdleCall(this);
  },
  /**
   * wraps a function with lock/unlock and runs it
   * @param  {function}  fun
   * @return {Promise<any>}
   */
  wrapCall: function wrapCall(fun) {
    var _this = this;
    this.lock();
    var maybePromise;
    try {
      maybePromise = fun();
    } catch (err) {
      this.unlock();
      throw err;
    }
    if (!maybePromise.then || typeof maybePromise.then !== "function") {
      this.unlock();
      return maybePromise;
    } else {
      return maybePromise.then(function(ret) {
        _this.unlock();
        return ret;
      })["catch"](function(err) {
        _this.unlock();
        throw err;
      });
    }
  },
  /**
   * does the same as requestIdleCallback() but uses promises instead of the callback
   * @param {{timeout?: number}} options like timeout
   * @return {Promise<void>} promise that resolves when the database is in idle-mode
   */
  requestIdlePromise: function requestIdlePromise(options) {
    var _this2 = this;
    options = options || {};
    var resolve;
    var prom = new Promise(function(res) {
      return resolve = res;
    });
    var resolveFromOutside = function resolveFromOutside2() {
      _removeIdlePromise(_this2, prom);
      resolve();
    };
    prom._manRes = resolveFromOutside;
    if (options.timeout) {
      var timeoutObj = setTimeout(function() {
        prom._manRes();
      }, options.timeout);
      prom._timeoutObj = timeoutObj;
    }
    this._iC.add(prom);
    _tryIdleCall(this);
    return prom;
  },
  /**
   * remove the promise so it will never be resolved
   * @param  {Promise} promise from requestIdlePromise()
   * @return {void}
   */
  cancelIdlePromise: function cancelIdlePromise(promise) {
    _removeIdlePromise(this, promise);
  },
  /**
   * api equal to
   * @link https://developer.mozilla.org/en-US/docs/Web/API/Window/requestIdleCallback
   * @param  {Function} callback
   * @param  {options}   options  [description]
   * @return {number} handle which can be used with cancelIdleCallback()
   */
  requestIdleCallback: function requestIdleCallback(callback, options) {
    var handle = this._lHN++;
    var promise = this.requestIdlePromise(options);
    this._hPM.set(handle, promise);
    this._pHM.set(promise, handle);
    promise.then(function() {
      return callback();
    });
    return handle;
  },
  /**
   * API equal to
   * @link https://developer.mozilla.org/en-US/docs/Web/API/Window/cancelIdleCallback
   * @param  {number} handle returned from requestIdleCallback()
   * @return {void}
   */
  cancelIdleCallback: function cancelIdleCallback(handle) {
    var promise = this._hPM.get(handle);
    this.cancelIdlePromise(promise);
  },
  /**
   * clears and resets everything
   * @return {void}
   */
  clear: function clear() {
    var _this3 = this;
    this._iC.forEach(function(promise) {
      return _removeIdlePromise(_this3, promise);
    });
    this._qC = 0;
    this._iC.clear();
    this._hPM = /* @__PURE__ */ new Map();
    this._pHM = /* @__PURE__ */ new Map();
  }
};
function _resolveOneIdleCall(idleQueue) {
  if (idleQueue._iC.size === 0) return;
  var iterator = idleQueue._iC.values();
  var oldestPromise = iterator.next().value;
  oldestPromise._manRes();
  setTimeout(function() {
    return _tryIdleCall(idleQueue);
  }, 0);
}
function _removeIdlePromise(idleQueue, promise) {
  if (!promise) return;
  if (promise._timeoutObj) clearTimeout(promise._timeoutObj);
  if (idleQueue._pHM.has(promise)) {
    var handle = idleQueue._pHM.get(promise);
    idleQueue._hPM["delete"](handle);
    idleQueue._pHM["delete"](promise);
  }
  idleQueue._iC["delete"](promise);
}
function _tryIdleCall(idleQueue) {
  if (idleQueue._tryIR || idleQueue._iC.size === 0) return;
  idleQueue._tryIR = true;
  setTimeout(function() {
    if (!idleQueue.isIdle()) {
      idleQueue._tryIR = false;
      return;
    }
    setTimeout(function() {
      if (!idleQueue.isIdle()) {
        idleQueue._tryIR = false;
        return;
      }
      _resolveOneIdleCall(idleQueue);
      idleQueue._tryIR = false;
    }, 0);
  }, 0);
}

// node_modules/@po-ui/ng-storage/fesm2022/po-ui-ng-storage.mjs
var import_lokijs = __toESM(require_lokijs(), 1);
var import_loki_indexed_adapter = __toESM(require_loki_indexed_adapter(), 1);
var keyField = "key";
var PoLokiDriver = class {
  collection;
  db;
  driver;
  constructor() {
    const self2 = this;
    this.driver = {
      _driver: "lokijs",
      _initStorage: function(options) {
        return self2.initStorage(options);
      },
      clear: function() {
        return self2.clear(this);
      },
      getItem: function(key) {
        return self2.getItem(this, key);
      },
      iterate: function(iteratorCallback) {
        return self2.iterate(this, iteratorCallback);
      },
      key: function(n) {
        return self2.key(this, n);
      },
      keys: function() {
        return self2.keys(this);
      },
      length: function() {
        return self2.length(this);
      },
      removeItem: function(key) {
        return self2.removeItem(this, key);
      },
      setItem: function(key, value) {
        return self2.setItem(this, key, value);
      }
    };
  }
  // Funções de iteração
  clear(localforage) {
    return new Promise((resolve) => {
      localforage.ready().then(() => {
        if (this.hasCollectionAndDataInCollection()) {
          this.clearCollection();
        }
        resolve(null);
      });
    });
  }
  getItem(localforage, key) {
    return new Promise((resolve) => {
      localforage.ready().then(() => {
        if (this.hasCollectionAndDataInCollection()) {
          const item = this.getItemInCollectionBy(keyField, key);
          if (item) {
            resolve(item.value);
          }
        }
        resolve(null);
      });
    });
  }
  initStorage(options) {
    return new Promise((resolve) => {
      try {
        this.configureLokiStorage(options, this.databaseInitialize.bind(this, options, resolve));
      } catch {
        throw new Error(`Cannot configure Loki Storage`);
      }
    });
  }
  iterate(localforage, iteratorCallback) {
    return new Promise((resolve) => {
      localforage.ready().then(() => {
        if (this.hasCollectionAndDataInCollection()) {
          this.iterateWithDataItem(iteratorCallback);
        }
        resolve(null);
      });
    });
  }
  key(localforage, n) {
    return new Promise((resolve) => {
      localforage.ready().then(() => {
        if (this.hasCollection()) {
          const map2 = this.getLokiMap();
          resolve(map2[n]);
        }
        resolve(null);
      });
    });
  }
  keys(localforage) {
    return new Promise((resolve) => {
      localforage.ready().then(() => {
        if (this.hasCollection()) {
          const keys2 = [];
          const map2 = this.getLokiMap();
          for (const key of Object.keys(map2)) {
            keys2.push(map2[key]);
          }
          resolve(keys2);
        }
        resolve(null);
      });
    });
  }
  length(localforage) {
    return new Promise((resolve) => {
      localforage.ready().then(() => {
        if (this.hasCollection()) {
          resolve(this.getNumberItensInCollection());
        }
        resolve(0);
      });
    });
  }
  removeItem(localforage, key) {
    return new Promise((resolve) => {
      localforage.ready().then(() => {
        if (this.hasCollection()) {
          this.findAndRemoveItem(key);
        }
        resolve(null);
      });
    });
  }
  setItem(localforage, key, value) {
    return new Promise((resolve) => {
      localforage.ready().then(() => {
        if (this.hasCollection()) {
          let item;
          if (this.hasDataInCollection()) {
            item = this.getItemInCollectionBy(keyField, key);
          }
          this.insertOrUpdate(item, value, key);
        }
        resolve(value);
      });
    });
  }
  // Funções de acesso ao storage
  // eslint-disable-next-line @typescript-eslint/member-ordering
  getDriver() {
    return this.driver;
  }
  addCollection(options) {
    return this.db.addCollection(options.storeName, {
      unique: [keyField]
    });
  }
  clearCollection() {
    this.collection.clear({
      removeIndices: false
    });
  }
  configureLokiStorage(options, databaseInitialize) {
    const idbAdapter = new import_loki_indexed_adapter.default();
    this.db = new import_lokijs.default(options.name, {
      adapter: idbAdapter,
      autoload: true,
      autoloadCallback: databaseInitialize,
      autosave: true,
      autosaveInterval: 4e3
    });
  }
  findAndRemoveItem(key) {
    this.collection.findAndRemove({
      [keyField]: key
    });
  }
  getCollection(options) {
    return this.db.getCollection(options.storeName);
  }
  databaseInitialize(options, resolve) {
    this.collection = this.getCollection(options);
    if (!this.hasCollection()) {
      this.collection = this.addCollection(options);
    }
    resolve();
  }
  getItemInCollectionBy(fieldKey, key) {
    return this.collection.by(fieldKey, key);
  }
  getLokiMap() {
    return this.collection.constraints.unique[keyField].lokiMap;
  }
  hasCollection() {
    return this.collection;
  }
  hasDataInCollection() {
    return this.collection.data && this.collection.data.length;
  }
  hasCollectionAndDataInCollection() {
    return this.hasCollection() && this.hasDataInCollection();
  }
  insertOrUpdate(item, value, key) {
    if (item) {
      item.value = value;
      this.collection.update(item);
    } else {
      this.collection.insert({
        [keyField]: key,
        value
      });
    }
  }
  iterateWithDataItem(iteratorcallback) {
    this.collection.data.forEach((element) => {
      iteratorcallback(element.value, element[keyField], element.$loki);
    });
  }
  getNumberItensInCollection() {
    return this.collection.count();
  }
};
var PO_STORAGE_CONFIG_TOKEN = new InjectionToken("PO_STORAGE_CONFIG_TOKEN");
var PoStorageService = class _PoStorageService {
  driver = null;
  idleQueue = new IdleQueue();
  storagePromise;
  lokijsDriver;
  constructor(config) {
    this.lokijsDriver = new PoLokiDriver();
    this.setStoragePromise(config);
  }
  /**
   * Retorna a configuração padrão para o armazenamento. Caso nenhuma configuração seja inserida,
   * essa configuração será utilizada.
   *
   * @returns {PoStorageConfig} Objeto com a configuração padrão do armazenamento.
   */
  static getDefaultConfig() {
    return {
      name: "_postorage",
      storeName: "_pokv",
      driverOrder: ["websql", "indexeddb", "localstorage", "lokijs"]
    };
  }
  /**
   * Cria uma instância do `PoStorageService` com a configuração de armazenamento passada como parâmetro.
   *
   * @param {PoStorageConfig} storageConfig Configuração para o armazenamento.
   * @returns {PoStorageService} Instância do `PoStorageService`.
   */
  static providePoStorage(storageConfig) {
    return new _PoStorageService(_PoStorageService.getConfig(storageConfig));
  }
  static getConfig(storageConfig) {
    return storageConfig || _PoStorageService.getDefaultConfig();
  }
  /**
   * Busca uma lista armazenada pela chave e concatena com a lista passada por parâmetro.
   *
   * Por exemplo:
   *
   * ``` typescript
   * const clients = [ { name: 'Marie', age: 23 }, { name: 'Pether', age: 39 }];
   *
   * this.poStorageService.set('clientKey', clients).then(() => {});
   *
   * ...
   *
   * const newClients = [ { name: 'Lisa', age: 36 }, { name: 'Bruce', age: 18 } ];
   *
   * this.poStorageService.appendArrayToArray('clientKey', newClients).then(() => {
   *   // A lista agora será:
   *   // [ { name: 'Marie', age: 23 }, { name: 'Pether', age: 39 }, { name: 'Lisa', age: 36 }, { name: 'Bruce', age: 18 }];
   * });
   * ```
   *
   * @param {string} key Chave da lista armazenada.
   * @param {Array} value Lista que será concatenada.
   *
   * @returns {Promise<any>} Promessa que é resolvida após as duas listas serem concatenadas e armazenadas localmente.
   */
  appendArrayToArray(key, value) {
    return __async(this, null, function* () {
      const data = yield this.getArrayOfStorage(key);
      const newData = [...data, ...value];
      return this.set(key, newData);
    });
  }
  /**
   * Acrescenta um item em uma lista armazenada pela chave.
   *
   * @param {string} key Chave da lista armazenada.
   * @param {Array} value Item que será acrescentado na lista.
   *
   * @returns {Promise<any>} Promessa que é resolvida após o item ser acrescentado na lista armazenada.
   */
  appendItemToArray(key, value) {
    return __async(this, null, function* () {
      const data = yield this.getArrayOfStorage(key);
      data.push(value);
      return this.set(key, data);
    });
  }
  /**
   * Remove todos os itens da base de dados local configurada na declaração do módulo `PoStorageModule`.
   *
   * > Utilize este método com cautela, para evitar a perda indesejada de dados.
   *
   * @returns {Promise<void>} Promessa que é resolvida após todos os itens da base de dados local serem removidos.
   */
  clear() {
    return this.storagePromise.then((store) => store.clear());
  }
  /**
   * Verifica se existe um valor dentro de uma determinada chave.
   *
   * @param {string} key Chave que será verificada.
   *
   * @returns {Promise<boolean>} Promessa que é resolvida quando a verificação da existência do valor na chave é concluída.
   */
  exists(key) {
    return this.get(key).then((data) => Promise.resolve(data !== null));
  }
  /**
   * Itera sobre todas as chaves armazenadas.
   *
   * @param {any} iteratorCallback Função de `callback` que é chamada a cada iteração, com os seguintes parâmetros:
   * valor, chave e número da iteração.
   *
   * Exemplo de utilização:
   *
   * ``` typescript
   * this.poStorageService.forEach((value: any, key: string, iterationNumber: number) => {
   *   // Iteração sobre cada chave armazenada.
   * });
   * ```
   *
   * @returns {Promise<void>} Promessa que é resolvida após a iteração sobre todas as chaves armazenadas.
   */
  forEach(iteratorCallback) {
    return this.storagePromise.then((store) => store.iterate(iteratorCallback));
  }
  /**
   * Retorna o valor armazenado em uma determinada chave.
   *
   * @param {string} key Chave que identifica o item.
   * @param {boolean} lock Define se irá travar a leitura e a escrita da base de dados para não ser acessada de forma paralela.
   * Caso outra leitura/escrita já tenha sido iniciada, este método irá esperar o outro terminar para então começar.
   *
   * Padrão: `false`.
   *
   * > Esta definição só será válida se o outro acesso paralelo a este método também estiver com o parâmetro *lock* ativado.
   * @returns {Promise<any>} Promessa que é resolvida após o item ser buscado.
   */
  get(key, lock2 = false) {
    return __async(this, null, function* () {
      if (lock2) {
        yield this.requestIdlePromise();
        return yield this.idleQueue.wrapCall(() => __async(this, null, function* () {
          yield this.getImmutableItem(key);
        }));
      }
      return yield this.getImmutableItem(key);
    });
  }
  /**
   * Retorna o nome do *driver* que está sendo usado para armazenar os dados, por exemplo: localStorage.
   *
   * @returns {string | null} Nome do *driver*.
   */
  getDriver() {
    return this.driver;
  }
  /**
   * Retorna o primeiro item de uma lista para uma determinada chave.
   *
   * @param {string} key Chave da lista.
   * @returns {Promise<any>} Promessa que é resolvida após o primeiro item ser encontrado.
   */
  getFirstItem(key) {
    return this.get(key).then((data) => Promise.resolve(data ? data[0] : null));
  }
  /**
   * Remove o primeiro item de uma lista a partir da chave.
   *
   * @param {string} key Chave da lista que será removido o primeiro item.
   * @returns {Promise<any>} Promessa que é resolvida após o primeiro item da lista ser removido.
   */
  getItemAndRemove(key) {
    return this.get(key).then((data) => {
      if (data === null) {
        return null;
      }
      const item = data.shift();
      return this.set(key, data).then(() => Promise.resolve(item));
    });
  }
  /**
   * Busca o primeiro objeto encontrado dentro de uma lista pelo do valor de um campo.
   *
   * Por exemplo:
   *
   * ``` typescript
   * const clients = [ { name: 'Marie', age: 23 }, { name: 'Pether', age: 39 }];
   *
   * this.poStorageService.set('clientKey', clients).then(() => {});
   *
   * ...
   *
   * this.poStorageService.getItemByField('clientKey', 'name', 'Marie').then(client => {
   *   // Resultado do console.log: { name: 'Marie', age: 23 }
   *   console.log(client);
   * });
   * ```
   *
   * @param {string} key Chave da lista.
   * @param {string} fieldName O campo a ser filtrado.
   * @param {any} fieldValue O valor do campo.
   * @returns {Promise<any>} Promessa que é resolvida com o item que foi encontrado.
   */
  getItemByField(key, fieldName, fieldValue) {
    return this.get(key).then((storageRecords) => {
      let storageRecordsFiltered = storageRecords.find((storageRecord) => storageRecord[fieldName] === fieldValue);
      storageRecordsFiltered = storageRecordsFiltered || null;
      return Promise.resolve(storageRecordsFiltered);
    });
  }
  /**
   * Lista com todas as chaves armazenadas.
   *
   * @returns {Promise<Array<string>>} Promessa que é resolvida com todas as chaves armazenadas.
   */
  keys() {
    return this.storagePromise.then((store) => store.keys());
  }
  /**
   * Quantidade de chaves armazenadas.
   *
   * @returns {Promise<number>} Promessa que é resolvida com o número de chaves armazenadas.
   */
  length() {
    return this.storagePromise.then((store) => store.length());
  }
  /**
   * Utilizado para gerenciar o bloqueio e desbloqueio de recursos no `PoStorageService`.
   * Aguardando a liberação da utilização dos recursos que participam deste comportamento e posteriormente envolve o recurso
   * passado como parâmetro em um comportamento de bloqueio e desbloqueio.
   *
   * Este método se comporta igual a utilização em conjunta dos métodos: `PoStorageService.requestIdlePromise()`,
   * `PoStorageService.lock()` e `PoStorageService.unlook()`.
   *
   * Veja mais no método: [`PoStorage.requestIdlePromise()`](documentation/po-storage#request-idle-promise).
   *
   * @param {Function} limitedResource Função que será envolvida no comportamento de bloqueio e desbloqueio.
   */
  limitedCallWrap(limitedResource) {
    return __async(this, null, function* () {
      yield this.requestIdlePromise();
      return this.idleQueue.wrapCall(limitedResource);
    });
  }
  /**
   * Incrementa um valor na fila de bloqueio do `PoStorageService`. Utilizado juntamente com o método `unlock` para poder
   * controlar a execução de uma determinada tarefa com o `PoStorage.requestIdlePromise()`.
   *
   * Veja mais no método: [`PoStorage.requestIdlePromise()`](documentation/po-storage#request-idle-promise).
   */
  lock() {
    this.idleQueue.lock();
  }
  /**
   * Determina se o processo de inicialização do *driver* assíncrono foi concluído.
   *
   * @returns {Promise<LocalForage>} Promessa que é resolvida quando o processo de inicialização do *driver* assíncrono
   * for concluído.
   */
  ready() {
    return this.storagePromise;
  }
  /**
   * Remove um valor associado a uma chave.
   *
   * @param {key} key Chave do valor que será removido.
   * @returns {Promise<any>} Promessa que é resolvida após o valor ser removido.
   */
  remove(key) {
    return this.storagePromise.then((store) => store.removeItem(key));
  }
  /**
   * Remove uma propriedade de um objeto armazenado.
   *
   * @param {string} key Chave do objeto armazenado.
   * @param {string} property Propriedade que será removida.
   *
   * @returns {Promise<any>} Promessa que é resolvida após a propriedade ser removida.
   */
  removeIndexFromObject(key, property) {
    return __async(this, null, function* () {
      const data = yield this.getObjectOfStorage(key);
      delete data[property];
      return this.set(key, data);
    });
  }
  /**
   * Remove um objeto de uma lista armazenada pelo valor de uma propriedade.
   *
   * Por exemplo:
   *
   * ``` typescript
   * const clients = [ { name: 'Marie', age: 23 }, { name: 'Pether', age: 39 }];
   *
   * this.poStorageService.set('clientKey', clients).then(() => {});
   *
   * ...
   *
   * this.poStorageService.removeItemFromArray('clientKey', 'name', 'Marie').then(() => {
   *   // O objeto { name: 'Marie', age: 23 } foi removido da lista que está na chave 'clientKey'
   * });
   * ```
   *
   * @param {string} key Chave da lista que contém o item que será removido.
   * @param {string} field O campo a ser filtrado no item.
   * @param {string} value O valor do filtro.
   * @returns {Promise<any>} Promessa que é resolvida quando o objeto for removido da lista.
   */
  removeItemFromArray(key, field, value) {
    return __async(this, null, function* () {
      let data = yield this.getArrayOfStorage(key);
      data = data.filter((item) => item[field] !== value);
      return this.set(key, data);
    });
  }
  /**
   * <a id="request-idle-promise"></a>
   * Método que verifica se o acesso a base de dados configurada está liberado.
   *
   * Utilizado em conjunto com os métodos `lock()` e `unlock()` entre tarefas que não podem ser executadas de forma
   * paralela, para não causar inconsistências nos dados.
   *
   * Exemplo de utilização:
   *
   * ```
   * // Aguarda a liberação para continuar
   * await this.poStorage.requestIdlePromise();
   *
   * this.poStorage.lock();
   *
   * // Executa uma tarefa que irá ler e/ou escrever na base de dados configurada.
   *
   * this.poStorage.unlock();
   * ```
   *
   * > É importante sempre utilizá-lo antes de executar os métodos `lock()` e `unlock()` para garantir que a tarefa só
   * será executada caso o acesso esteja livre.
   *
   * @returns {Promise<any>} Promessa que é resolvida quando o acesso a base de dados configurada estiver liberado.
   */
  requestIdlePromise() {
    return this.idleQueue.requestIdlePromise();
  }
  /**
   * Grava um valor em uma determinada chave.
   *
   * @param {string} key Chave para o valor que será gravado.
   * @param {any} value Valor que será gravado.
   * @param {boolean} lock Define se irá travar a leitura e a escrita da base de dados para não ser acessada de forma paralela.
   * Caso outra leitura/escrita já tenha sido iniciada, este método irá esperar o outro terminar para então começar.
   *
   * Padrão: `false`.
   *
   * > Esta definição só será válida se o outro acesso paralelo a este método também estiver com o parâmetro *lock* ativado.
   * @returns {Promise<any>} Promessa que é resolvida após o valor ter sido gravado.
   */
  set(key, value, lock2 = false) {
    return __async(this, null, function* () {
      const store = yield this.storagePromise;
      const newValue = typeof value === "object" ? JSON.parse(JSON.stringify(value)) : value;
      if (lock2) {
        yield this.requestIdlePromise();
        return this.idleQueue.wrapCall(() => store.setItem(key, newValue));
      }
      return store.setItem(key, newValue);
    });
  }
  /**
   * Atribui um valor a uma propriedade de um objeto armazenado pela chave.
   *
   * Por exemplo:
   *
   * ``` typescript
   * const clients = [ { name: 'Marie', age: 23 }, { name: 'Pether', age: 39 }];
   *
   * this.poStorageService.set('clientKey', clients).then(() => {});
   *
   * ...
   *
   * this.poStorageService.setIndexToObject('clientKey', 'name', 'Clare').then(() => {
   *   // O objeto { name: 'Marie', age: 23 } passa a ser { name: 'Clare', age: 23 }
   * });
   * ```
   *
   * @param {string} key Chave do objeto.
   * @param {string} property Nome da propriedade do objeto.
   * @param {any} value Valor que será gravado na propriedade do objeto.
   */
  setIndexToObject(key, property, value) {
    return __async(this, null, function* () {
      const data = yield this.getObjectOfStorage(key);
      data[property] = value;
      return this.set(key, data);
    });
  }
  /**
   * Decrementa um valor na fila de bloqueio. Utilizado juntamente com o método `lock` para poder
   * controlar a execução de uma determinada tarefa com o `PoStorage.requestIdlePromise()`.
   *
   * Veja mais no método: [`PoStorage.requestIdlePromise()`](documentation/po-storage#request-idle-promise).
   */
  unlock() {
    this.idleQueue.unlock();
  }
  getArrayOfStorage(key) {
    return __async(this, null, function* () {
      const data = yield this.get(key);
      return data || [];
    });
  }
  getImmutableItem(key) {
    return __async(this, null, function* () {
      const store = yield this.storagePromise;
      const items = yield store.getItem(key);
      return items ? JSON.parse(JSON.stringify(items)) : null;
    });
  }
  defineLocalForageDriver(localForageInstance, driverOrder) {
    return __async(this, null, function* () {
      yield localForageInstance.defineDriver(this.lokijsDriver.getDriver());
      yield this.setDriver(localForageInstance, driverOrder);
      return localForageInstance;
    });
  }
  getDriverOrder(driverOrder) {
    return driverOrder.map((driver) => {
      switch (driver) {
        case "indexeddb":
          return LocalForage.INDEXEDDB;
        case "websql":
          return LocalForage.WEBSQL;
        case "localstorage":
          return LocalForage.LOCALSTORAGE;
        default:
          return driver;
      }
    });
  }
  getObjectOfStorage(key) {
    return __async(this, null, function* () {
      const data = yield this.get(key);
      return data || {};
    });
  }
  setDriver(localForageInstance, driverOrder) {
    return __async(this, null, function* () {
      yield localForageInstance.setDriver(this.getDriverOrder(driverOrder));
      this.driver = localForageInstance.driver();
    });
  }
  setStoragePromise(config) {
    this.storagePromise = this.getStorageInstance(config);
  }
  getStorageInstance(config) {
    return __async(this, null, function* () {
      const defaultConfig = _PoStorageService.getDefaultConfig();
      const actualConfig = Object.assign(defaultConfig, config || {});
      const localForageInstance = LocalForage.createInstance(actualConfig);
      try {
        return yield this.defineLocalForageDriver(localForageInstance, actualConfig.driverOrder);
      } catch {
        throw new Error(`Cannot use this drivers: ${actualConfig.driverOrder.join(", ")}.`);
      }
    });
  }
  static \u0275fac = function PoStorageService_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoStorageService)(\u0275\u0275inject(PO_STORAGE_CONFIG_TOKEN));
  };
  static \u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
    token: _PoStorageService,
    factory: _PoStorageService.\u0275fac,
    providedIn: "root"
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoStorageService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [{
    type: void 0,
    decorators: [{
      type: Inject,
      args: [PO_STORAGE_CONFIG_TOKEN]
    }]
  }], null);
})();
var PoStorageModule = class _PoStorageModule {
  static forRoot(storageConfig) {
    return {
      ngModule: _PoStorageModule,
      providers: [{
        provide: PO_STORAGE_CONFIG_TOKEN,
        useValue: storageConfig || PoStorageService.getDefaultConfig()
      }, {
        provide: PoStorageService,
        useFactory: PoStorageService.providePoStorage,
        deps: [PO_STORAGE_CONFIG_TOKEN]
      }]
    };
  }
  static \u0275fac = function PoStorageModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoStorageModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoStorageModule
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({});
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoStorageModule, [{
    type: NgModule
  }], null, null);
})();

// src/app/service/util.service.ts
var import_moment = __toESM(require_moment());
var UtilService = class _UtilService {
  constructor(poNotificationService, poDialogService) {
    this.poNotificationService = poNotificationService;
    this.poDialogService = poDialogService;
  }
  getListaEstados() {
    return [
      { value: "AC", label: "ACRE" },
      { value: "AL", label: "ALAGOAS" },
      { value: "AM", label: "AMAZONAS" },
      { value: "AP", label: "AMAPA" },
      { value: "BA", label: "BAHIA" },
      { value: "CE", label: "CEARA" },
      { value: "DF", label: "DISTRITO FEDERAL" },
      { value: "ES", label: "ESPIRITO SANTO" },
      { value: "EX", label: "ESTRANGEIRO" },
      { value: "GO", label: "GOIAS" },
      { value: "MA", label: "MARANHAO" },
      { value: "MG", label: "MINAS GERAIS" },
      { value: "MS", label: "MATO GROSSO DO SUL" },
      { value: "MT", label: "MATO GROSSO" },
      { value: "PA", label: "PARA" },
      { value: "PB", label: "PARAIBA" },
      { value: "PE", label: "PERNAMBUCO" },
      { value: "PI", label: "PIAUI" },
      { value: "PR", label: "PARANA" },
      { value: "RJ", label: "RIO DE JANEIRO" },
      { value: "RN", label: "RIO GRANDE DO NORTE" },
      { value: "RO", label: "RONDONIA" },
      { value: "RR", label: "RORAIMA" },
      { value: "RS", label: "RIO GRANDE DO SUL" },
      { value: "SC", label: "SANTA CATARINA" },
      { value: "SE", label: "SERGIPE" },
      { value: "SP", label: "SAO PAULO" },
      { value: "TO", label: "TOCANTINS" }
    ];
  }
  formatarCGC(cgc) {
    let cgcRetornar = new String(cgc);
    cgcRetornar = cgcRetornar.replace(/(\.|\/|\-)/g, "");
    if (cgcRetornar.length === 11) {
      return cgcRetornar.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/g, "$1.$2.$3-$4");
    } else {
      return cgcRetornar.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/g, "$1.$2.$3/$4-$5");
    }
  }
  formatarCEP(cep) {
    return cep.replace(/(\d{2})(\d{3})(\d{3})/g, "$1.$2-$3");
  }
  getUniqueId(parts) {
    const stringArr = [];
    for (let i = 0; i < parts; i++) {
      const S4 = ((1 + Math.random()) * 65536 | 0).toString(16).substring(1);
      stringArr.push(S4);
    }
    return stringArr.join("-");
  }
  round(num, places) {
    const factorOfTen = Math.pow(10, places);
    return Math.round(num * factorOfTen) / factorOfTen;
  }
  /*{
    headers?: HttpHeaders | {
      [header: string]: string | string[];
    };
    context?: HttpContext;
    observe?: 'body';
    params?: HttpParams | {
      [param: string]: string | number | boolean | ReadonlyArray<string | number | boolean>;
    }
   },*/
  filtrosHttpOptions(filtro = {}, showMensagemRetorno = true, showQuery = false) {
    const httpOptions2 = {
      headers: new HttpHeaders({
        "X-PO-Screen-Lock": "true",
        "X-PO-No-Message": showMensagemRetorno ? "false" : "true"
      }),
      params: new HttpParams()
    };
    if (filtro) {
      Object.keys(filtro).some((key) => {
        if ((filtro[key] || filtro[key] === 0) && key.toUpperCase() !== "LASTSETDEFAULT") {
          if (filtro[key] instanceof Object) {
            if (key.substring(0, 6) === "deate_") {
              if (key) {
                if (filtro[key].start) {
                  httpOptions2.params = httpOptions2.params.append(`${key.substring(6, 100)}_de`, filtro[key].start);
                }
                if (filtro[key].end) {
                  httpOptions2.params = httpOptions2.params.append(`${key.substring(6, 100)}_ate`, filtro[key].end);
                }
              }
            } else if (Array.isArray(filtro[key])) {
              httpOptions2.params = httpOptions2.params.append(key, filtro[key].join());
            } else {
              try {
                httpOptions2.params = httpOptions2.params.append(key, new Date(filtro[key]).toISOString().substring(0, 10));
              } catch {
                httpOptions2.params = httpOptions2.params.append(key, filtro[key].toString());
              }
            }
          } else {
            httpOptions2.params = httpOptions2.params.append(key, filtro[key].toString());
          }
        }
      });
    }
    if (showQuery) {
      httpOptions2.params = httpOptions2.params.append("SHOWQUERY", "S");
    }
    return httpOptions2;
  }
  comboMonthYear(dateDe, numberMonths, fomartoValue = "YYYYMM", formatoLabel = "YYYYMM") {
    const momentDe = (0, import_moment.default)(dateDe);
    momentDe.locale("pt-br");
    const combo = [{ value: momentDe.format(fomartoValue), label: momentDe.format(formatoLabel) }];
    for (let count = 1; count < numberMonths; count++) {
      combo.push({ value: momentDe.add(1, "month").format(fomartoValue), label: momentDe.format(formatoLabel) });
    }
    ;
    return combo;
  }
  comboMonthYearRegresivo(numberMonths, fomartoValue = "YYYYMM", formatoLabel = "YYYYMM") {
    const momentDe = (0, import_moment.default)(/* @__PURE__ */ new Date());
    momentDe.locale("pt-br");
    const combo = [{ value: momentDe.format(fomartoValue), label: momentDe.format(formatoLabel) }];
    for (let count = 1; count < numberMonths; count++) {
      combo.push({ value: momentDe.add(-1, "month").format(fomartoValue), label: momentDe.format(formatoLabel) });
    }
    ;
    return combo;
  }
  comboMonthYearBetweenDates(dateDe, dateAte) {
    const momentDe = (0, import_moment.default)(dateDe);
    momentDe.locale("pt-br");
    const momentAte = (0, import_moment.default)(dateAte);
    momentAte.locale("pt-br");
    const combo = [{ value: momentDe.format("YYYYMM"), label: momentDe.format("MMMM/YYYY") }];
    for (let count = 1; count < momentAte.diff(momentDe, "month", false); count++) {
      combo.push({ value: momentDe.add(1, "month").format("YYYYMM"), label: momentDe.format("MMMM/YYYY") });
    }
    ;
    return combo;
  }
  showErrosFomulario(formField, document2) {
    let campos = formField.controls;
    let mensagem;
    Object.keys(campos).some((key) => {
      let erros = campos[key].errors;
      if (erros) {
        Object.keys(erros).some((erro) => {
          let campo = "";
          if (document2.getElementsByName(key)[0].attributes["p-label"]) {
            campo = document2.getElementsByName(key)[0].attributes["p-label"].nodeValue;
          } else {
            campo = key;
          }
          if (erro === "required") {
            mensagem = `O campo ${campo} \xE9 obrigat\xF3rio e n\xE3o est\xE1 preenchido.`;
          } else if (erro === "min") {
            mensagem = `O valor do campo ${campo} n\xE3o atende ao M\xEDnimo.`;
          } else if (erro === "max") {
            mensagem = `O valor do campo ${campo} n\xE3o atende ao M\xE1ximo.`;
          } else if (erro === "minlength") {
            mensagem = `O valor do campo ${campo} n\xE3o atende ao Tamanho M\xEDnimo de Caracteres.`;
          } else if (erro === "maxlength") {
            mensagem = `O valor do campo ${campo} n\xE3o atende ao Tamanho M\xE1ximo de Caracteres.`;
          } else {
            mensagem = `O valor do campo ${campo} n\xE3o atende aos requisitos.`;
          }
          this.poNotificationService.warning({
            message: mensagem,
            duration: 5e3
          });
        });
      }
    });
  }
  addBusinessDays(date, diasUteis) {
    date = new Date(date.getTime());
    var day = date.getDay();
    date.setDate(date.getDate() + diasUteis + (day === 6 ? 2 : +!day) + Math.floor((diasUteis - 1 + (day % 6 || 1)) / 5) * 2);
    return date;
  }
  formataHora(hora, comSegundos = false) {
    let msDuration = hora * 36e5;
    const h = Math.floor(msDuration / 1e3 / 60 / 60);
    const m = Math.floor((msDuration / 1e3 / 60 / 60 - h) * 60);
    const s = Math.floor(((msDuration / 1e3 / 60 / 60 - h) * 60 - m) * 60);
    const seconds = s < 10 ? `0${s}` : `${s}`;
    const minutes = m < 10 ? `0${m}` : `${m}`;
    const hours = h < 10 ? `0${h}` : `${h}`;
    if (comSegundos) {
      return `${hours}:${minutes}:${seconds}`;
    } else {
      return `${hours}:${minutes}`;
    }
  }
  showErrorResponse(message, e) {
    this.poNotificationService.warning({
      message,
      actionLabel: "Detalhe",
      action: () => {
        this.poDialogService.alert({
          title: `Code Error ${e.status}`,
          message: e.message
        });
      },
      duration: 5e3
    });
  }
  static {
    this.\u0275fac = function UtilService_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _UtilService)(\u0275\u0275inject(PoNotificationService), \u0275\u0275inject(PoDialogService));
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({ token: _UtilService, factory: _UtilService.\u0275fac, providedIn: "root" });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(UtilService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [{ type: PoNotificationService }, { type: PoDialogService }], null);
})();

// src/app/service/auth.service.ts
var AuthService = class _AuthService {
  constructor(http, poStorageService, utilServive) {
    this.http = http;
    this.poStorageService = poStorageService;
    this.utilServive = utilServive;
    this.url = `${environment.urlApiProtheus}`;
  }
  login(login, password) {
    const httpOptions2 = {
      headers: new HttpHeaders({
        "X-PO-Screen-Lock": "true",
        "content-type": "application/json",
        "grant_type": "password",
        "password": password,
        "username": login
      }),
      params: new HttpParams()
    };
    return this.http.post(`${this.url}/api/oauth2/v1/token`, {}, httpOptions2);
  }
  loginFuncionario(user, password, empresa) {
    const httpOptions2 = {
      headers: new HttpHeaders({
        "X-PO-Screen-Lock": "true"
      }),
      params: new HttpParams(),
      responseType: "text"
    };
    const redirectUrl = `${environment.urlPortalMeuRH}`;
    const restUrl = this.url;
    return this.http.post(`${this.url}/auth/login`, { user, password, redirectUrl, restUrl }, httpOptions2);
  }
  loginFornecedor(login, password) {
    const httpOptions2 = {
      headers: new HttpHeaders({
        "X-PO-Screen-Lock": "true",
        "content-type": "application/json",
        "grant_type": "password",
        "password": password,
        "username": login,
        "portal": environment.portalFornecedorCodigo,
        "urlrest": this.url
      }),
      params: new HttpParams()
    };
    return this.http.get(`${this.url}/wsrauth/login`, httpOptions2);
  }
  refreshToken(refreshToken) {
    return this.http.post(`${this.url}/api/oauth2/v1/token?grant_type=refresh_token&refresh_token=${refreshToken}`, {});
  }
  getUser() {
    return this.http.get(`${this.url}/wsruser`);
  }
  validaPrivilegio(permissao) {
    return __async(this, null, function* () {
      return new Promise((resolve, reject) => {
        this.poStorageService.get("usuario").then((usuario) => {
          if (permissao && permissao.length) {
            const aPermissao = usuario.APRIVILEGIO.filter((item) => permissao.includes(item.CCODIGO));
            if (aPermissao && aPermissao.length) {
              resolve(true);
            } else {
              resolve(false);
            }
          } else {
            resolve(true);
          }
        });
      });
    });
  }
  postUserAlterarSenha(dados) {
    const httpOptions2 = this.utilServive.filtrosHttpOptions();
    return this.http.post(`${this.url}/wsrauth/alterar-senha`, dados, httpOptions2);
  }
  getPrivilegio() {
    return __async(this, null, function* () {
      return new Promise((resolve, reject) => {
        this.poStorageService.get("usuario").then((usuario) => {
          if (usuario.APRIVILEGIO && usuario.APRIVILEGIO.length) {
            resolve(usuario.APRIVILEGIO);
          } else {
            resolve([]);
          }
        });
      });
    });
  }
  temPrivilegio(privilegioUsuario, privilegioNecessario) {
    if (privilegioUsuario.filter((item) => privilegioNecessario.includes(item.CCODIGO)).length) {
      return true;
    } else {
      return false;
    }
  }
  static {
    this.\u0275fac = function AuthService_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _AuthService)(\u0275\u0275inject(HttpClient), \u0275\u0275inject(PoStorageService), \u0275\u0275inject(UtilService));
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({ token: _AuthService, factory: _AuthService.\u0275fac, providedIn: "root" });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(AuthService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [{ type: HttpClient }, { type: PoStorageService }, { type: UtilService }], null);
})();

// node_modules/@po-ui/ng-templates/fesm2022/po-ui-ng-templates.mjs
var _c0 = ["emailForm"];
var _c1 = ["recoveryModal"];
var _c2 = ["smsCodeForm"];
function PoModalPasswordRecoveryComponent_div_3_div_6_Template(rf, ctx) {
  if (rf & 1) {
    const _r1 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div")(1, "po-radio-group", 18);
    \u0275\u0275twoWayListener("ngModelChange", function PoModalPasswordRecoveryComponent_div_3_div_6_Template_po_radio_group_ngModelChange_1_listener($event) {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext(2);
      \u0275\u0275twoWayBindingSet(ctx_r1.chosenTypeFormOption, $event) || (ctx_r1.chosenTypeFormOption = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275listener("p-change", function PoModalPasswordRecoveryComponent_div_3_div_6_Template_po_radio_group_p_change_1_listener($event) {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.getInputType($event));
    });
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275advance();
    \u0275\u0275twoWayProperty("ngModel", ctx_r1.chosenTypeFormOption);
    \u0275\u0275property("p-options", ctx_r1.typeFormOptions)("p-size", ctx_r1.componentsSize);
  }
}
function PoModalPasswordRecoveryComponent_div_3_po_email_8_Template(rf, ctx) {
  if (rf & 1) {
    const _r3 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-email", 19);
    \u0275\u0275twoWayListener("ngModelChange", function PoModalPasswordRecoveryComponent_div_3_po_email_8_Template_po_email_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r3);
      const ctx_r1 = \u0275\u0275nextContext(2);
      \u0275\u0275twoWayBindingSet(ctx_r1.email, $event) || (ctx_r1.email = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275listener("p-change-model", function PoModalPasswordRecoveryComponent_div_3_po_email_8_Template_po_email_p_change_model_0_listener() {
      \u0275\u0275restoreView(_r3);
      \u0275\u0275nextContext();
      const emailForm_r4 = \u0275\u0275reference(5);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.formModelChangesCheck(emailForm_r4));
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275twoWayProperty("ngModel", ctx_r1.email);
    \u0275\u0275property("p-label", ctx_r1.literals.insertEmail)("p-size", ctx_r1.componentsSize);
  }
}
function PoModalPasswordRecoveryComponent_div_3_po_input_9_Template(rf, ctx) {
  if (rf & 1) {
    const _r5 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-input", 20);
    \u0275\u0275twoWayListener("ngModelChange", function PoModalPasswordRecoveryComponent_div_3_po_input_9_Template_po_input_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r5);
      const ctx_r1 = \u0275\u0275nextContext(2);
      \u0275\u0275twoWayBindingSet(ctx_r1.phone, $event) || (ctx_r1.phone = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275listener("p-change-model", function PoModalPasswordRecoveryComponent_div_3_po_input_9_Template_po_input_p_change_model_0_listener() {
      \u0275\u0275restoreView(_r5);
      \u0275\u0275nextContext();
      const emailForm_r4 = \u0275\u0275reference(5);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.formModelChangesCheck(emailForm_r4));
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275twoWayProperty("ngModel", ctx_r1.phone);
    \u0275\u0275property("p-label", ctx_r1.literals.insertPhone)("p-mask", ctx_r1.phoneMask)("p-maxlength", ctx_r1.maxLength)("p-minlength", ctx_r1.minLength)("p-size", ctx_r1.componentsSize);
  }
}
function PoModalPasswordRecoveryComponent_div_3_po_modal_password_recovery_error_message_11_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-modal-password-recovery-error-message", 21);
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275property("p-text", ctx_r1.type === "sms" ? ctx_r1.literals.phoneErrorMessagePhrase : ctx_r1.literals.emailErrorMessagePhrase);
  }
}
function PoModalPasswordRecoveryComponent_div_3_span_14_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "span");
    \u0275\u0275text(1);
    \u0275\u0275elementStart(2, "a", 22);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r1.literals.prepositionIn, " ");
    \u0275\u0275advance();
    \u0275\u0275propertyInterpolate1("href", "mailto:", ctx_r1.contactEmail, "", \u0275\u0275sanitizeUrl);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r1.contactEmail, " ");
  }
}
function PoModalPasswordRecoveryComponent_div_3_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 8)(1, "div", 9);
    \u0275\u0275text(2);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 10)(4, "form", null, 1);
    \u0275\u0275template(6, PoModalPasswordRecoveryComponent_div_3_div_6_Template, 2, 3, "div", 11);
    \u0275\u0275elementStart(7, "div", 12);
    \u0275\u0275template(8, PoModalPasswordRecoveryComponent_div_3_po_email_8_Template, 1, 3, "po-email", 13)(9, PoModalPasswordRecoveryComponent_div_3_po_input_9_Template, 1, 6, "po-input", 14);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(10, "div", 15);
    \u0275\u0275template(11, PoModalPasswordRecoveryComponent_div_3_po_modal_password_recovery_error_message_11_Template, 1, 1, "po-modal-password-recovery-error-message", 16);
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(12, "div", 17);
    \u0275\u0275text(13);
    \u0275\u0275template(14, PoModalPasswordRecoveryComponent_div_3_span_14_Template, 4, 4, "span", 11);
    \u0275\u0275text(15);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", ctx_r1.emailModalPhrases.firstPhrase, " ");
    \u0275\u0275advance(4);
    \u0275\u0275property("ngIf", ctx_r1.modalPasswordRecoveryTypeAll);
    \u0275\u0275advance(2);
    \u0275\u0275property("ngIf", ctx_r1.type === "email" || ctx_r1.type === "all");
    \u0275\u0275advance();
    \u0275\u0275property("ngIf", ctx_r1.type === "sms");
    \u0275\u0275advance(2);
    \u0275\u0275property("ngIf", ctx_r1.invalidEmail && ctx_r1.control.dirty);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", ctx_r1.emailModalPhrases.secondPhrase, " ");
    \u0275\u0275advance();
    \u0275\u0275property("ngIf", ctx_r1.contactEmail);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r1.endpoint, " ");
  }
}
function PoModalPasswordRecoveryComponent_div_4_po_modal_password_recovery_error_message_9_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-modal-password-recovery-error-message", 21);
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275property("p-text", ctx_r1.smsCodeErrorMessage || ctx_r1.literals.smsCodeErrorMessagePhrase);
  }
}
function PoModalPasswordRecoveryComponent_div_4_po_modal_password_recovery_error_message_10_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-modal-password-recovery-error-message", 21);
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275property("p-text", ctx_r1.codeError);
  }
}
function PoModalPasswordRecoveryComponent_div_4_Template(rf, ctx) {
  if (rf & 1) {
    const _r6 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 8, 2)(2, "div", 9);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(4, "div", 10)(5, "form", null, 3)(7, "po-input", 23);
    \u0275\u0275twoWayListener("ngModelChange", function PoModalPasswordRecoveryComponent_div_4_Template_po_input_ngModelChange_7_listener($event) {
      \u0275\u0275restoreView(_r6);
      const ctx_r1 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r1.smsCode, $event) || (ctx_r1.smsCode = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275listener("p-change-model", function PoModalPasswordRecoveryComponent_div_4_Template_po_input_p_change_model_7_listener() {
      \u0275\u0275restoreView(_r6);
      const smsCodeForm_r7 = \u0275\u0275reference(6);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.formModelChangesCheck(smsCodeForm_r7));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(8, "div", 15);
    \u0275\u0275template(9, PoModalPasswordRecoveryComponent_div_4_po_modal_password_recovery_error_message_9_Template, 1, 1, "po-modal-password-recovery-error-message", 16)(10, PoModalPasswordRecoveryComponent_div_4_po_modal_password_recovery_error_message_10_Template, 1, 1, "po-modal-password-recovery-error-message", 16);
    \u0275\u0275elementEnd()()();
    \u0275\u0275elementStart(11, "div", 17);
    \u0275\u0275text(12);
    \u0275\u0275elementStart(13, "span", 24);
    \u0275\u0275listener("click", function PoModalPasswordRecoveryComponent_div_4_Template_span_click_13_listener() {
      \u0275\u0275restoreView(_r6);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.resendSmsCode());
    });
    \u0275\u0275text(14);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(ctx_r1.literals.sentSmsCodePhrase);
    \u0275\u0275advance(4);
    \u0275\u0275twoWayProperty("ngModel", ctx_r1.smsCode);
    \u0275\u0275property("p-label", ctx_r1.literals.insertCode)("p-mask", ctx_r1.codeMask)("p-size", ctx_r1.componentsSize);
    \u0275\u0275advance(2);
    \u0275\u0275property("ngIf", ctx_r1.invalidEmail);
    \u0275\u0275advance();
    \u0275\u0275property("ngIf", ctx_r1.showCustomCodeError);
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", ctx_r1.literals.sendAgainPhrase, " ");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(ctx_r1.literals.sendAgain);
  }
}
function PoModalPasswordRecoveryComponent_div_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 8, 4);
    \u0275\u0275element(2, "img", 25);
    \u0275\u0275elementStart(3, "div", 26);
    \u0275\u0275text(4);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(4);
    \u0275\u0275textInterpolate1(" ", ctx_r1.literals.emailSentConfirmationPhrase, " ");
  }
}
var _c3 = ["*"];
function PoPageBackgroundComponent_Conditional_3_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-logo", 3);
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275property("p-link", false)("p-logo", ctx_r0.logo)("p-logo-alt", ctx_r0.logoAlt);
  }
}
function PoPageBackgroundComponent_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    const _r2 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 9)(1, "po-select", 13);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageBackgroundComponent_Conditional_10_Template_po_select_ngModelChange_1_listener($event) {
      \u0275\u0275restoreView(_r2);
      const ctx_r0 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r0.selectedLanguageOption, $event) || (ctx_r0.selectedLanguageOption = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275listener("p-change", function PoPageBackgroundComponent_Conditional_10_Template_po_select_p_change_1_listener() {
      \u0275\u0275restoreView(_r2);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.onChangeLanguage());
    });
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance();
    \u0275\u0275twoWayProperty("ngModel", ctx_r0.selectedLanguageOption);
    \u0275\u0275property("p-options", ctx_r0.selectLanguageOptions)("p-size", ctx_r0.componentsSize);
  }
}
function PoPageBackgroundComponent_Conditional_12_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-logo", 11);
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275property("p-link", false)("p-logo", ctx_r0.secondaryLogo);
  }
}
function PoPageBackgroundComponent_Conditional_13_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 14)(1, "div", 15)(2, "div", 16);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275styleProp("background-image", "url(" + ctx_r0.background + ")");
    \u0275\u0275property("ngClass", ctx_r0.background ? "po-page-login-highlight-image" : "po-page-login-highlight-image-off");
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(ctx_r0.highlightInfo);
  }
}
var _c4 = ["contactGroup"];
var _c5 = ["mailItem"];
var _c6 = ["phoneItem"];
function PoPageBlockedUserReasonComponent_Conditional_11_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 6);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance();
    \u0275\u0275textInterpolate(ctx_r0.literals == null ? null : ctx_r0.literals.thirdPhrase);
  }
}
var _c7 = ["pageChangePassword"];
var _c8 = ["passwordForm"];
var _c9 = (a0) => ({
  "po-offset-md-3 po-offset-lg-3 po-offset-xl-3": a0
});
function PoPageChangePasswordComponent_Conditional_13_Template(rf, ctx) {
  if (rf & 1) {
    const _r2 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div")(1, "po-password", 29);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageChangePasswordComponent_Conditional_13_Template_po_password_ngModelChange_1_listener($event) {
      \u0275\u0275restoreView(_r2);
      const ctx_r2 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r2.currentPassword, $event) || (ctx_r2.currentPassword = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275advance();
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.currentPassword);
    \u0275\u0275property("p-label", ctx_r2.literals.currentPassword)("p-no-autocomplete", ctx_r2.noAutocompletePassword)("p-size", ctx_r2.componentsSize);
  }
}
function PoPageChangePasswordComponent_Conditional_14_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "a", 30);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275property("routerLink", ctx_r2.recovery);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r2.literals.forgotPassword, " ");
  }
}
function PoPageChangePasswordComponent_Conditional_14_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "a", 31);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275property("href", ctx_r2.recovery, \u0275\u0275sanitizeUrl);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r2.literals.forgotPassword, " ");
  }
}
function PoPageChangePasswordComponent_Conditional_14_Conditional_3_Template(rf, ctx) {
  if (rf & 1) {
    const _r4 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "a", 33);
    \u0275\u0275listener("click", function PoPageChangePasswordComponent_Conditional_14_Conditional_3_Template_a_click_0_listener() {
      \u0275\u0275restoreView(_r4);
      const ctx_r2 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r2.onForgotPasswordClick(ctx_r2.recovery));
    });
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r2.literals.forgotPassword, " ");
  }
}
function PoPageChangePasswordComponent_Conditional_14_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 10);
    \u0275\u0275template(1, PoPageChangePasswordComponent_Conditional_14_Conditional_1_Template, 2, 2, "a", 30)(2, PoPageChangePasswordComponent_Conditional_14_Conditional_2_Template, 2, 2, "a", 31)(3, PoPageChangePasswordComponent_Conditional_14_Conditional_3_Template, 2, 1, "a", 32);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r2.recoveryUrlType === "internalLink" ? 1 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r2.recoveryUrlType === "externalLink" ? 2 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(!ctx_r2.recoveryUrlType ? 3 : -1);
  }
}
function PoPageChangePasswordComponent_Conditional_19_For_7_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "li", 35);
    \u0275\u0275element(1, "po-icon", 37);
    \u0275\u0275elementStart(2, "p", 38);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const requirement_r5 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275advance();
    \u0275\u0275property("p-icon", ctx_r2.validateRequirement(requirement_r5) ? "ICON_OK po-page-change-password-required-ok" : "ICON_MINUS po-page-change-password-required-minus");
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate1(" ", requirement_r5.requirement, " ");
  }
}
function PoPageChangePasswordComponent_Conditional_19_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 13)(1, "po-container")(2, "ul", 34)(3, "li", 35)(4, "p", 36);
    \u0275\u0275text(5);
    \u0275\u0275elementEnd()();
    \u0275\u0275repeaterCreate(6, PoPageChangePasswordComponent_Conditional_19_For_7_Template, 4, 2, "li", 35, \u0275\u0275repeaterTrackByIdentity);
    \u0275\u0275elementEnd()()();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275advance(5);
    \u0275\u0275textInterpolate1(" ", ctx_r2.literals == null ? null : ctx_r2.literals.requirements, " ");
    \u0275\u0275advance();
    \u0275\u0275repeater(ctx_r2.requirements);
  }
}
function PoPageChangePasswordComponent_Conditional_38_Template(rf, ctx) {
  if (rf & 1) {
    const _r6 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-button", 39);
    \u0275\u0275listener("p-click", function PoPageChangePasswordComponent_Conditional_38_Template_po_button_p_click_0_listener() {
      \u0275\u0275restoreView(_r6);
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.navigateTo(ctx_r2.urlBack));
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275property("p-label", ctx_r2.literals.backButton)("p-size", ctx_r2.componentsSize);
  }
}
function PoPageDynamicDetailComponent_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-dynamic-view", 1);
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275property("p-components-size", ctx_r0.componentsSize)("p-fields", ctx_r0.fields)("p-value", ctx_r0.model);
  }
}
function PoPageDynamicDetailComponent_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "po-widget", 2);
    \u0275\u0275element(1, "po-icon", 3);
    \u0275\u0275elementStart(2, "span", 4);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275property("p-size", ctx_r0.componentsSize);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" ", ctx_r0.literals.registerNotFound, " ");
  }
}
var _c10 = ["dynamicForm"];
var _c11 = ["gridDetail"];
function PoPageDynamicEditComponent_Conditional_1_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    const _r1 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 5);
    \u0275\u0275element(1, "po-divider", 6);
    \u0275\u0275elementStart(2, "div", 7)(3, "po-button", 8);
    \u0275\u0275listener("p-click", function PoPageDynamicEditComponent_Conditional_1_Conditional_2_Template_po_button_p_click_3_listener() {
      \u0275\u0275restoreView(_r1);
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.detailActionNew());
    });
    \u0275\u0275elementEnd()();
    \u0275\u0275element(4, "po-grid", 9, 1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275advance();
    \u0275\u0275property("p-label", ctx_r1.detailFields[0].divider);
    \u0275\u0275advance(2);
    \u0275\u0275property("p-size", ctx_r1.componentsSize)("p-label", ctx_r1.literals.detailActionNew);
    \u0275\u0275advance();
    \u0275\u0275property("p-row-actions", ctx_r1.detailActions)("p-columns", ctx_r1.detailFields[0].detail.columns)("p-data", ctx_r1.model[ctx_r1.detailFields[0].property]);
  }
}
function PoPageDynamicEditComponent_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-dynamic-form", 4, 0);
    \u0275\u0275template(2, PoPageDynamicEditComponent_Conditional_1_Conditional_2_Template, 6, 6, "div", 5);
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275property("p-components-size", ctx_r1.componentsSize)("p-fields", ctx_r1.controlFields)("p-value", ctx_r1.model);
    \u0275\u0275advance(2);
    \u0275\u0275conditional(ctx_r1.detailFields.length > 0 ? 2 : -1);
  }
}
function PoPageDynamicEditComponent_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "po-widget", 3);
    \u0275\u0275element(1, "po-icon", 10);
    \u0275\u0275elementStart(2, "span", 11);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275property("p-size", ctx_r1.componentsSize);
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" ", ctx_r1.literals.registerNotFound, " ");
  }
}
var _c12 = ["formExecution"];
var _c13 = ["dailyTemplate"];
var _c14 = ["monthlyTemplate"];
var _c15 = ["weeklyTemplate"];
function PoPageJobSchedulerExecutionComponent_Conditional_3_Conditional_0_Template(rf, ctx) {
  if (rf & 1) {
    const _r2 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-lookup", 12);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_Conditional_3_Conditional_0_Template_po_lookup_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r2);
      const ctx_r2 = \u0275\u0275nextContext(2);
      \u0275\u0275twoWayBindingSet(ctx_r2.value.processID, $event) || (ctx_r2.value.processID = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.value.processID);
    \u0275\u0275property("p-disabled", ctx_r2.isEdit)("p-filter-service", ctx_r2.poPageJobSchedulerLookup)("p-label", ctx_r2.literals.process)("p-placeholder", ctx_r2.literals.enterProcess)("p-size", ctx_r2.componentsSize);
  }
}
function PoPageJobSchedulerExecutionComponent_Conditional_3_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275template(0, PoPageJobSchedulerExecutionComponent_Conditional_3_Conditional_0_Template, 1, 6, "po-lookup", 11);
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275conditional(ctx_r2.noParameters && ctx_r2.noCustomParamsComponent ? 0 : -1);
  }
}
function PoPageJobSchedulerExecutionComponent_Conditional_4_Template(rf, ctx) {
  if (rf & 1) {
    const _r4 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-input", 13);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_Conditional_4_Template_po_input_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r4);
      const ctx_r2 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r2.value.processID, $event) || (ctx_r2.value.processID = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.value.processID);
    \u0275\u0275property("p-disabled", ctx_r2.isEdit)("p-label", ctx_r2.literals.process)("p-placeholder", ctx_r2.literals.enterProcess)("p-size", ctx_r2.componentsSize);
  }
}
function PoPageJobSchedulerExecutionComponent_Conditional_12_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    const _r6 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-radio-group", 17);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_Conditional_12_Conditional_2_Template_po_radio_group_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r6);
      const ctx_r2 = \u0275\u0275nextContext(2);
      \u0275\u0275twoWayBindingSet(ctx_r2.value.frequency.type, $event) || (ctx_r2.value.frequency.type = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275listener("p-change", function PoPageJobSchedulerExecutionComponent_Conditional_12_Conditional_2_Template_po_radio_group_p_change_0_listener() {
      \u0275\u0275restoreView(_r6);
      const ctx_r2 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r2.onChangeFrequencyOptions());
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(1, "po-number", 18);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_Conditional_12_Conditional_2_Template_po_number_ngModelChange_1_listener($event) {
      \u0275\u0275restoreView(_r6);
      const ctx_r2 = \u0275\u0275nextContext(2);
      \u0275\u0275twoWayBindingSet(ctx_r2.value.frequency.value, $event) || (ctx_r2.value.frequency.value = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.value.frequency.type);
    \u0275\u0275property("p-columns", 3)("p-options", ctx_r2.frequencyOptions)("p-size", ctx_r2.componentsSize);
    \u0275\u0275advance();
    \u0275\u0275property("p-size", ctx_r2.componentsSize);
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.value.frequency.value);
  }
}
function PoPageJobSchedulerExecutionComponent_Conditional_12_ng_container_5_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementContainer(0);
  }
}
function PoPageJobSchedulerExecutionComponent_Conditional_12_Template(rf, ctx) {
  if (rf & 1) {
    const _r5 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 5)(1, "po-switch", 14);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_Conditional_12_Template_po_switch_ngModelChange_1_listener($event) {
      \u0275\u0275restoreView(_r5);
      const ctx_r2 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r2.containsFrequency, $event) || (ctx_r2.containsFrequency = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275listener("p-change", function PoPageJobSchedulerExecutionComponent_Conditional_12_Template_po_switch_p_change_1_listener($event) {
      \u0275\u0275restoreView(_r5);
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.onChangeContainsFrequency($event));
    });
    \u0275\u0275elementEnd();
    \u0275\u0275template(2, PoPageJobSchedulerExecutionComponent_Conditional_12_Conditional_2_Template, 2, 6);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(3, "div", 5);
    \u0275\u0275element(4, "po-divider", 7);
    \u0275\u0275template(5, PoPageJobSchedulerExecutionComponent_Conditional_12_ng_container_5_Template, 1, 0, "ng-container", 15);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(6, "div", 5)(7, "po-switch", 16);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_Conditional_12_Template_po_switch_ngModelChange_7_listener($event) {
      \u0275\u0275restoreView(_r5);
      const ctx_r2 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r2.value.recurrent, $event) || (ctx_r2.value.recurrent = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275advance();
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.containsFrequency);
    \u0275\u0275property("p-label", ctx_r2.literals.frequency)("p-label-off", ctx_r2.literals.no)("p-label-on", ctx_r2.literals.yes)("p-size", ctx_r2.componentsSize);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r2.containsFrequency ? 2 : -1);
    \u0275\u0275advance(2);
    \u0275\u0275property("p-label", ctx_r2.literals.periodicityData);
    \u0275\u0275advance();
    \u0275\u0275property("ngTemplateOutlet", ctx_r2.periodicityTemplates[ctx_r2.value.periodicity]);
    \u0275\u0275advance(2);
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.value.recurrent);
    \u0275\u0275property("p-label", ctx_r2.literals.recurrent)("p-label-off", ctx_r2.literals.no)("p-label-on", ctx_r2.literals.yes)("p-size", ctx_r2.componentsSize);
  }
}
function PoPageJobSchedulerExecutionComponent_ng_template_13_ng_container_0_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementContainer(0);
  }
}
function PoPageJobSchedulerExecutionComponent_ng_template_13_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275template(0, PoPageJobSchedulerExecutionComponent_ng_template_13_ng_container_0_Template, 1, 0, "ng-container", 15);
  }
  if (rf & 2) {
    \u0275\u0275nextContext();
    const inputHourTemplate_r7 = \u0275\u0275reference(20);
    \u0275\u0275property("ngTemplateOutlet", inputHourTemplate_r7);
  }
}
function PoPageJobSchedulerExecutionComponent_ng_template_15_ng_container_1_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementContainer(0);
  }
}
function PoPageJobSchedulerExecutionComponent_ng_template_15_Template(rf, ctx) {
  if (rf & 1) {
    const _r8 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 5);
    \u0275\u0275template(1, PoPageJobSchedulerExecutionComponent_ng_template_15_ng_container_1_Template, 1, 0, "ng-container", 15);
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(2, "po-checkbox-group", 19);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_ng_template_15_Template_po_checkbox_group_ngModelChange_2_listener($event) {
      \u0275\u0275restoreView(_r8);
      const ctx_r2 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r2.value.daysOfWeek, $event) || (ctx_r2.value.daysOfWeek = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    const inputHourTemplate_r7 = \u0275\u0275reference(20);
    \u0275\u0275advance();
    \u0275\u0275property("ngTemplateOutlet", inputHourTemplate_r7);
    \u0275\u0275advance();
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.value.daysOfWeek);
    \u0275\u0275property("p-label", ctx_r2.literals.weekDays)("p-options", ctx_r2.weekDays)("p-size", ctx_r2.componentsSize);
  }
}
function PoPageJobSchedulerExecutionComponent_ng_template_17_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    const _r10 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-number", 22);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_ng_template_17_Conditional_1_Template_po_number_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r10);
      const ctx_r2 = \u0275\u0275nextContext(2);
      \u0275\u0275twoWayBindingSet(ctx_r2.value.rangeLimitDay, $event) || (ctx_r2.value.rangeLimitDay = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.value.rangeLimitDay);
    \u0275\u0275property("p-error-pattern", "Dia inv\xE1lido")("p-label", ctx_r2.literals.endDay)("p-max", 31)("p-pattern", ctx_r2.dayPattern)("p-size", ctx_r2.componentsSize);
  }
}
function PoPageJobSchedulerExecutionComponent_ng_template_17_ng_container_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementContainer(0);
  }
}
function PoPageJobSchedulerExecutionComponent_ng_template_17_Template(rf, ctx) {
  if (rf & 1) {
    const _r9 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-number", 20);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_ng_template_17_Template_po_number_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r9);
      const ctx_r2 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r2.value.dayOfMonth, $event) || (ctx_r2.value.dayOfMonth = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
    \u0275\u0275template(1, PoPageJobSchedulerExecutionComponent_ng_template_17_Conditional_1_Template, 1, 6, "po-number", 21)(2, PoPageJobSchedulerExecutionComponent_ng_template_17_ng_container_2_Template, 1, 0, "ng-container", 15);
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    const inputHourTemplate_r7 = \u0275\u0275reference(20);
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.value.dayOfMonth);
    \u0275\u0275property("p-error-pattern", "Dia inv\xE1lido")("p-label", ctx_r2.dayLabel)("p-max", 31)("p-pattern", ctx_r2.dayPattern)("p-size", ctx_r2.componentsSize);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r2.containsFrequency ? 1 : -1);
    \u0275\u0275advance();
    \u0275\u0275property("ngTemplateOutlet", inputHourTemplate_r7);
  }
}
function PoPageJobSchedulerExecutionComponent_ng_template_19_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    const _r12 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-input", 25);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_ng_template_19_Conditional_1_Template_po_input_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r12);
      const ctx_r2 = \u0275\u0275nextContext(2);
      \u0275\u0275twoWayBindingSet(ctx_r2.value.rangeLimitHour, $event) || (ctx_r2.value.rangeLimitHour = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.value.rangeLimitHour);
    \u0275\u0275property("p-label", ctx_r2.literals.endTime)("p-pattern", ctx_r2.timePattern)("p-size", ctx_r2.componentsSize);
  }
}
function PoPageJobSchedulerExecutionComponent_ng_template_19_Template(rf, ctx) {
  if (rf & 1) {
    const _r11 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-input", 23);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_ng_template_19_Template_po_input_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r11);
      const ctx_r2 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r2.value.hour, $event) || (ctx_r2.value.hour = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
    \u0275\u0275template(1, PoPageJobSchedulerExecutionComponent_ng_template_19_Conditional_1_Template, 1, 4, "po-input", 24);
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.value.hour);
    \u0275\u0275property("p-label", ctx_r2.hourLabel)("p-pattern", ctx_r2.timePattern)("p-size", ctx_r2.componentsSize);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r2.containsFrequency && ctx_r2.value.frequency.type !== "day" ? 1 : -1);
  }
}
var _c16 = ["parametersForm"];
function PoPageJobSchedulerParametersComponent_Conditional_0_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "form", null, 0);
    \u0275\u0275element(2, "po-dynamic-form", 2);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance(2);
    \u0275\u0275property("p-components-size", ctx_r0.componentsSize)("p-fields", ctx_r0.parameters)("p-value", ctx_r0.value);
  }
}
function PoPageJobSchedulerParametersComponent_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 1);
    \u0275\u0275element(1, "po-icon", 3);
    \u0275\u0275elementStart(2, "span", 4);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate1(" ", ctx_r0.literals.parametersNotFound, " ");
  }
}
function PoPageJobSchedulerSummaryComponent_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-info", 1);
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275property("p-label", ctx_r0.literals.process)("p-orientation", ctx_r0.infoOrientation)("p-size", ctx_r0.componentsSize)("p-value", ctx_r0.value.processID);
  }
}
function PoPageJobSchedulerSummaryComponent_Conditional_3_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-info", 1);
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275property("p-label", ctx_r0.literals.frequency)("p-orientation", ctx_r0.infoOrientation)("p-size", ctx_r0.componentsSize)("p-value", ctx_r0.frequencyValue);
  }
}
function PoPageJobSchedulerSummaryComponent_Conditional_4_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-info", 1);
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275property("p-label", ctx_r0.literals.execution)("p-orientation", ctx_r0.infoOrientation)("p-size", ctx_r0.componentsSize)("p-value", ctx_r0.executionValue);
  }
}
function PoPageJobSchedulerSummaryComponent_Conditional_7_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "po-widget", 2);
    \u0275\u0275element(1, "po-dynamic-view", 4);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275property("p-size", ctx_r0.componentsSize)("p-title", ctx_r0.literals.parameters);
    \u0275\u0275advance();
    \u0275\u0275property("p-components-size", ctx_r0.componentsSize)("p-fields", ctx_r0.parameters)("p-value", ctx_r0.value.executionParameter);
  }
}
function PoPageJobSchedulerSummaryComponent_Conditional_8_ng_template_1_Template(rf, ctx) {
}
function PoPageJobSchedulerSummaryComponent_Conditional_8_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 3);
    \u0275\u0275template(1, PoPageJobSchedulerSummaryComponent_Conditional_8_ng_template_1_Template, 0, 0, "ng-template", 5);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance();
    \u0275\u0275property("ngTemplateOutlet", ctx_r0.jobSchedulerSummaryTemplate == null ? null : ctx_r0.jobSchedulerSummaryTemplate.templateRef);
  }
}
var _c17 = ["schedulerExecution"];
var _c18 = ["schedulerParameters"];
var _c19 = () => [];
function PoPageJobSchedulerComponent_Conditional_9_Template(rf, ctx) {
  if (rf & 1) {
    const _r2 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-page-job-scheduler-parameters", 11, 2);
    \u0275\u0275twoWayListener("p-valueChange", function PoPageJobSchedulerComponent_Conditional_9_Template_po_page_job_scheduler_parameters_p_valueChange_0_listener($event) {
      \u0275\u0275restoreView(_r2);
      const ctx_r2 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r2.model.executionParameter, $event) || (ctx_r2.model.executionParameter = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275property("hidden", ctx_r2.step !== ctx_r2.stepParameters)("p-components-size", ctx_r2.componentsSize)("p-literals", ctx_r2.literals)("p-parameters", ctx_r2.parameters || \u0275\u0275pureFunction0(5, _c19));
    \u0275\u0275twoWayProperty("p-value", ctx_r2.model.executionParameter);
  }
}
function PoPageJobSchedulerComponent_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-page-job-scheduler-summary", 9);
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275property("p-no-parameters", !ctx_r2.parameters.length)("p-summary-template", ctx_r2.jobSchedulerSummaryTemplate)("p-components-size", ctx_r2.componentsSize)("p-literals", ctx_r2.literals)("p-parameters", ctx_r2.parameters)("p-value", ctx_r2.publicValues);
  }
}
function PoPageJobSchedulerComponent_For_12_ng_template_1_Template(rf, ctx) {
}
function PoPageJobSchedulerComponent_For_12_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 10);
    \u0275\u0275template(1, PoPageJobSchedulerComponent_For_12_ng_template_1_Template, 0, 0, "ng-template", 12);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const template_r4 = ctx.$implicit;
    const \u0275$index_21_r5 = ctx.$index;
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275property("hidden", ctx_r2.step !== \u0275$index_21_r5 + (ctx_r2._stepExecutionLast ? 1 : 2));
    \u0275\u0275advance();
    \u0275\u0275property("ngTemplateOutlet", template_r4 == null ? null : template_r4.templateRef);
  }
}
function PoPageLoginPopoverComponent_Conditional_17_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "a", 8);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(2);
    \u0275\u0275property("routerLink", ctx_r0.recovery);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r0.literals == null ? null : ctx_r0.literals.iForgotMyPassword, " ");
  }
}
function PoPageLoginPopoverComponent_Conditional_17_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "a", 9);
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(2);
    \u0275\u0275property("href", ctx_r0.recovery, \u0275\u0275sanitizeUrl);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r0.literals == null ? null : ctx_r0.literals.iForgotMyPassword, " ");
  }
}
function PoPageLoginPopoverComponent_Conditional_17_Conditional_3_Template(rf, ctx) {
  if (rf & 1) {
    const _r2 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "a", 11);
    \u0275\u0275listener("click", function PoPageLoginPopoverComponent_Conditional_17_Conditional_3_Template_a_click_0_listener() {
      \u0275\u0275restoreView(_r2);
      const ctx_r0 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r0.onForgotPasswordClick(ctx_r0.recovery));
    });
    \u0275\u0275text(1);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext(2);
    \u0275\u0275advance();
    \u0275\u0275textInterpolate1(" ", ctx_r0.literals == null ? null : ctx_r0.literals.iForgotMyPassword, " ");
  }
}
function PoPageLoginPopoverComponent_Conditional_17_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 7);
    \u0275\u0275template(1, PoPageLoginPopoverComponent_Conditional_17_Conditional_1_Template, 2, 2, "a", 8)(2, PoPageLoginPopoverComponent_Conditional_17_Conditional_2_Template, 2, 2, "a", 9)(3, PoPageLoginPopoverComponent_Conditional_17_Conditional_3_Template, 2, 1, "a", 10);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.recoveryType === "internalLink" ? 1 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r0.recoveryType === "externalLink" ? 2 : -1);
    \u0275\u0275advance();
    \u0275\u0275conditional(!ctx_r0.recoveryType ? 3 : -1);
  }
}
var _c20 = ["loginForm"];
var _c21 = ["pageLogin"];
function PoPageLoginComponent_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-tag", 8);
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275property("p-value", ctx_r1.environment);
  }
}
function PoPageLoginComponent_Conditional_19_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-icon", 28);
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275property("p-tooltip", ctx_r1.pageLoginLiterals.loginHint);
  }
}
function PoPageLoginComponent_Conditional_19_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 27);
    \u0275\u0275template(1, PoPageLoginComponent_Conditional_19_Conditional_1_Template, 1, 1, "po-icon", 28);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275classProp("po-page-login-info-icon-container-dynamic", !ctx_r1.pageLoginLiterals.loginHint && !ctx_r1.pageLoginLiterals.rememberUserHint);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r1.pageLoginLiterals.loginHint ? 1 : -1);
  }
}
function PoPageLoginComponent_For_22_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 17);
    \u0275\u0275element(1, "po-icon", 29);
    \u0275\u0275elementStart(2, "span", 30);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const error_r4 = ctx.$implicit;
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(error_r4);
  }
}
function PoPageLoginComponent_Conditional_26_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    const _r5 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-page-login-popover", 32);
    \u0275\u0275listener("p-forgot-password", function PoPageLoginComponent_Conditional_26_Conditional_1_Template_po_page_login_popover_p_forgot_password_0_listener($event) {
      \u0275\u0275restoreView(_r5);
      const ctx_r1 = \u0275\u0275nextContext(2);
      return \u0275\u0275resetView(ctx_r1.openUrl($event));
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275property("p-literals", ctx_r1.pageLoginLiterals)("p-recovery", ctx_r1.recovery)("p-remaining-attempts", ctx_r1.exceededAttemptsWarning);
  }
}
function PoPageLoginComponent_Conditional_26_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 20);
    \u0275\u0275template(1, PoPageLoginComponent_Conditional_26_Conditional_1_Template, 1, 3, "po-page-login-popover", 31);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r1.showExceededAttemptsWarning && ctx_r1.exceededAttemptsWarning ? 1 : -1);
  }
}
function PoPageLoginComponent_For_29_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 17);
    \u0275\u0275element(1, "po-icon", 29);
    \u0275\u0275elementStart(2, "span", 30);
    \u0275\u0275text(3);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const error_r6 = ctx.$implicit;
    \u0275\u0275advance(3);
    \u0275\u0275textInterpolate(error_r6);
  }
}
function PoPageLoginComponent_Conditional_30_Template(rf, ctx) {
  if (rf & 1) {
    const _r7 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-input", 33);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageLoginComponent_Conditional_30_Template_po_input_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r7);
      const ctx_r1 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r1.customFieldObject.value, $event) || (ctx_r1.customFieldObject.value = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275listener("keyup.enter", function PoPageLoginComponent_Conditional_30_Template_po_input_keyup_enter_0_listener() {
      \u0275\u0275restoreView(_r7);
      const ctx_r1 = \u0275\u0275nextContext();
      const loginForm_r3 = \u0275\u0275reference(14);
      return \u0275\u0275resetView(loginForm_r3.valid && ctx_r1.onLoginSubmit());
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275classProp("po-page-login-field-size-dynamic", !ctx_r1.pageLoginLiterals.loginHint && !ctx_r1.pageLoginLiterals.rememberUserHint);
    \u0275\u0275twoWayProperty("ngModel", ctx_r1.customFieldObject.value);
    \u0275\u0275property("p-error-pattern", ctx_r1.customFieldObject.errorPattern || ctx_r1.pageLoginLiterals.customFieldErrorPattern)("p-pattern", ctx_r1.customFieldObject.pattern)("p-placeholder", ctx_r1.customFieldObject.placeholder || ctx_r1.pageLoginLiterals.customFieldPlaceholder)("p-size", ctx_r1.componentsSize);
  }
}
function PoPageLoginComponent_Conditional_31_Template(rf, ctx) {
  if (rf & 1) {
    const _r8 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-combo", 34);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageLoginComponent_Conditional_31_Template_po_combo_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r8);
      const ctx_r1 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r1.customFieldObject.value, $event) || (ctx_r1.customFieldObject.value = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275classProp("po-page-login-field-size-dynamic", !ctx_r1.pageLoginLiterals.loginHint && !ctx_r1.pageLoginLiterals.rememberUserHint);
    \u0275\u0275twoWayProperty("ngModel", ctx_r1.customFieldObject.value);
    \u0275\u0275property("p-field-value", ctx_r1.customFieldObject.fieldValue)("p-filter-service", ctx_r1.customFieldObject.url)("p-placeholder", ctx_r1.customFieldObject.placeholder || ctx_r1.pageLoginLiterals.customFieldPlaceholder)("p-size", ctx_r1.componentsSize);
  }
}
function PoPageLoginComponent_Conditional_32_Template(rf, ctx) {
  if (rf & 1) {
    const _r9 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-select", 35);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageLoginComponent_Conditional_32_Template_po_select_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r9);
      const ctx_r1 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r1.customFieldObject.value, $event) || (ctx_r1.customFieldObject.value = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275classProp("po-page-login-field-size-dynamic", !ctx_r1.pageLoginLiterals.loginHint && !ctx_r1.pageLoginLiterals.rememberUserHint);
    \u0275\u0275twoWayProperty("ngModel", ctx_r1.customFieldObject.value);
    \u0275\u0275property("p-placeholder", ctx_r1.customFieldObject.placeholder || ctx_r1.pageLoginLiterals.customFieldPlaceholder)("p-options", ctx_r1.customFieldObject.options)("p-size", ctx_r1.componentsSize);
  }
}
function PoPageLoginComponent_Conditional_34_Conditional_2_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-icon", 28);
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(3);
    \u0275\u0275property("p-tooltip", ctx_r1.pageLoginLiterals.rememberUserHint);
  }
}
function PoPageLoginComponent_Conditional_34_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 38);
    \u0275\u0275template(1, PoPageLoginComponent_Conditional_34_Conditional_2_Conditional_1_Template, 1, 1, "po-icon", 28);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext(2);
    \u0275\u0275classProp("po-page-login-info-icon-container-dynamic", !ctx_r1.pageLoginLiterals.rememberUserHint);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r1.pageLoginLiterals.rememberUserHint ? 1 : -1);
  }
}
function PoPageLoginComponent_Conditional_34_Template(rf, ctx) {
  if (rf & 1) {
    const _r10 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 13)(1, "po-switch", 36);
    \u0275\u0275twoWayListener("ngModelChange", function PoPageLoginComponent_Conditional_34_Template_po_switch_ngModelChange_1_listener($event) {
      \u0275\u0275restoreView(_r10);
      const ctx_r1 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r1.rememberUser, $event) || (ctx_r1.rememberUser = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275listener("keyup.enter", function PoPageLoginComponent_Conditional_34_Template_po_switch_keyup_enter_1_listener() {
      \u0275\u0275restoreView(_r10);
      const ctx_r1 = \u0275\u0275nextContext();
      const loginForm_r3 = \u0275\u0275reference(14);
      return \u0275\u0275resetView(loginForm_r3.valid && ctx_r1.onLoginSubmit());
    });
    \u0275\u0275elementEnd();
    \u0275\u0275template(2, PoPageLoginComponent_Conditional_34_Conditional_2_Template, 2, 3, "div", 37);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance();
    \u0275\u0275twoWayProperty("ngModel", ctx_r1.rememberUser);
    \u0275\u0275property("p-label-off", ctx_r1.pageLoginLiterals.rememberUser)("p-label-on", ctx_r1.pageLoginLiterals.rememberUser)("p-size", ctx_r1.componentsSize)("p-hide-label-status", ctx_r1.hideLabelStatus);
    \u0275\u0275advance();
    \u0275\u0275conditional(ctx_r1.pageLoginLiterals.loginHint || ctx_r1.pageLoginLiterals.rememberUserHint ? 2 : -1);
  }
}
function PoPageLoginComponent_Conditional_36_Template(rf, ctx) {
  if (rf & 1) {
    const _r11 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 25)(1, "a", 39);
    \u0275\u0275listener("click", function PoPageLoginComponent_Conditional_36_Template_a_click_1_listener() {
      \u0275\u0275restoreView(_r11);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.openUrl(ctx_r1.recovery));
    });
    \u0275\u0275text(2);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(ctx_r1.pageLoginLiterals.forgotPassword);
  }
}
function PoPageLoginComponent_Conditional_37_Template(rf, ctx) {
  if (rf & 1) {
    const _r12 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "div", 26)(1, "a", 39);
    \u0275\u0275listener("click", function PoPageLoginComponent_Conditional_37_Template_a_click_1_listener() {
      \u0275\u0275restoreView(_r12);
      const ctx_r1 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r1.openUrl(ctx_r1.registerUrl));
    });
    \u0275\u0275text(2);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r1 = \u0275\u0275nextContext();
    \u0275\u0275advance(2);
    \u0275\u0275textInterpolate(ctx_r1.pageLoginLiterals.registerUrl);
  }
}
var PoPageComponentsSize;
(function(PoPageComponentsSize2) {
  PoPageComponentsSize2["Small"] = "small";
  PoPageComponentsSize2["Medium"] = "medium";
})(PoPageComponentsSize || (PoPageComponentsSize = {}));
function getBrowserLanguage() {
  return navigator.language || navigator["userLanguage"];
}
function getShortBrowserLanguage() {
  const language = (getBrowserLanguage() || poLocaleDefault).toLowerCase().substring(0, 2);
  if (!poLocales.includes(language)) {
    return poLocaleDefault;
  }
  return language;
}
function convertToBoolean(val) {
  if (typeof val === "string") {
    val = val.toLowerCase().trim();
    return val === "true" || val === "on" || val === "";
  }
  if (typeof val === "number") {
    return val === 1;
  }
  return !!val;
}
function convertToInt(value, valueDefault) {
  const validNumber = parseInt(value, 10);
  const validDefaultValue = parseInt(valueDefault, 10);
  const defaultValue = validDefaultValue || validDefaultValue === 0 ? validDefaultValue : void 0;
  return validNumber || validNumber === 0 ? validNumber : defaultValue;
}
function isTypeof(object, type) {
  return typeof object === type;
}
function convertDateToISOExtended(date, time) {
  if (date) {
    const getMonth = date.getMonth() + 1;
    const day = date.getDate() < 10 ? "0" + date.getDate() : date.getDate();
    const month = getMonth < 10 ? "0" + getMonth : getMonth;
    const year = formatYear(date.getFullYear());
    const dateString = date.toString();
    if (time) {
      return year + "-" + month + "-" + day + time;
    } else {
      return year + "-" + month + "-" + day + "T" + dateString.substring(16, 24) + dateString.substring(28, 31) + ":" + dateString.substring(31, 33);
    }
  } else {
    return null;
  }
}
function formatYear(year) {
  if (year >= 1e3) {
    return year.toString();
  }
  if (year > 99 && year < 1e3) {
    return `0${year}`;
  }
  if (year > 9 && year < 100) {
    return `00${year}`;
  }
  if (year >= 0 && year < 10) {
    return `000${year}`;
  }
}
function getDefaultSizeFn() {
  return getA11yDefaultSize() === "small" ? PoPageComponentsSize.Small : PoPageComponentsSize.Medium;
}
function isExternalLink(url) {
  return url ? url.startsWith("http") : false;
}
function openExternalLink(url) {
  window.open(url, "_blank");
}
function capitalizeFirstLetter(text) {
  return `${text.charAt(0).toUpperCase()}${text.slice(1)}`;
}
function mapArrayByProperties(items = [], properties = []) {
  return items.map((item) => mapObjectByProperties(item, properties));
}
function mapObjectByProperties(object = {}, properties = []) {
  const getSelectedProperties = (selectedProperties, property) => __spreadProps(__spreadValues({}, selectedProperties), {
    [property]: object[property]
  });
  return properties.reduce(getSelectedProperties, {});
}
function valuesFromObject(object = {}) {
  return Object.keys(object).map((property) => object[property]);
}
function addZero(time) {
  if (!time) {
    return "00";
  }
  if (time < 10) {
    return `0${time}`;
  }
  return time;
}
function removeKeysProperties(keys2, newItemValue) {
  keys2.forEach((key) => delete newItemValue[key]);
  return newItemValue;
}
function removeDuplicateItemsWithArrayKey(item, item2, keys2) {
  const newKey = keys2.length ? keys2 : ["id"];
  const combinedArray = item.concat(item2);
  return combinedArray.filter((obj, index) => index === combinedArray.findIndex((innerObj) => newKey.every((key) => innerObj[key] === obj[key])));
}
function sortArrayOfObjects(items, key, isAscendingOrder) {
  return items.sort((a, b) => {
    const valueA = a[key];
    const valueB = b[key];
    if (typeof valueA === "number" && typeof valueB === "number") {
      return isAscendingOrder ? valueA - valueB : valueB - valueA;
    } else {
      const compareResult = valueA.toString().localeCompare(valueB.toString());
      return isAscendingOrder ? compareResult : -compareResult;
    }
  });
}
function validateSizeFn(value) {
  if (value && Object.values(PoPageComponentsSize).includes(value)) {
    if (value === PoPageComponentsSize.Small && getA11yLevel() !== "AA") {
      return PoPageComponentsSize.Medium;
    }
    return value;
  }
  return getDefaultSizeFn();
}
function getA11yDefaultSize() {
  const defaultSize = localStorage.getItem("po-default-size");
  const a11yLevel = document.documentElement.getAttribute("data-a11y");
  return defaultSize === "small" && a11yLevel === "AA" ? "small" : "medium";
}
function getA11yLevel() {
  const a11yLevel = document.documentElement.getAttribute("data-a11y");
  return a11yLevel === "AA" ? PoThemeA11yEnum.AA : PoThemeA11yEnum.AAA;
}
var PoModalPasswordRecoveryModalContent;
(function(PoModalPasswordRecoveryModalContent2) {
  PoModalPasswordRecoveryModalContent2["Email"] = "email";
  PoModalPasswordRecoveryModalContent2["SMSCode"] = "smsCode";
  PoModalPasswordRecoveryModalContent2["Confirmation"] = "confirmation";
})(PoModalPasswordRecoveryModalContent || (PoModalPasswordRecoveryModalContent = {}));
var PoModalPasswordRecoveryType;
(function(PoModalPasswordRecoveryType2) {
  PoModalPasswordRecoveryType2["All"] = "all";
  PoModalPasswordRecoveryType2["Email"] = "email";
  PoModalPasswordRecoveryType2["SMS"] = "sms";
})(PoModalPasswordRecoveryType || (PoModalPasswordRecoveryType = {}));
var poModalPasswordRecoveryLiterals = {
  en: {
    cancelButton: "Cancel",
    closeButton: "Close",
    continueButton: "Continue",
    email: "e-mail",
    emailErrorMessagePhrase: "Invalid e-mail format",
    emailSentConfirmationPhrase: `We have sent the instructions and new password creation link to your e-mail.
    If you did not receive it after a few minutes, check your spam box or click Resend.`,
    emailSentTitle: "E-mail sent",
    forgotPasswordTitle: "Forgot your password?",
    insertCode: "Type the code",
    insertEmail: "Enter your e-mail",
    insertPhone: "Enter your mobile number",
    phoneErrorMessagePhrase: "Invalid phone number",
    prepositionIn: "in",
    prepositionOr: "or",
    recoveryPasswordPhrase: "To recover your password we will send you a {0} with instructions.",
    resendEmailButton: "Resend",
    resendSmsCodePhrase: "If the code does not arrive within a few minutes, please send it again.",
    sendAgainPhrase: "If the code does not arrive within a few minutes",
    sendAgain: "send again.",
    sendButton: "Submit",
    sentSmsCodePhrase: "We sent a code for your mobile phone.",
    sms: "SMS",
    smsCodeErrorMessagePhrase: "Invalid code. Please re-enter or contact support",
    supportContact: "If you do not have access to {0} contact support",
    telephone: "telephone",
    typeCodeTitle: "Enter sent code"
  },
  es: {
    cancelButton: "Cancelar",
    closeButton: "Cerrar",
    continueButton: "Continuar",
    email: "e-mail",
    emailErrorMessagePhrase: "Formato de correo electr\xF3nico no v\xE1lido",
    emailSentConfirmationPhrase: `Enviamos las instrucciones y enlace de creaci\xF3n de nueva contrase\xF1a para su correo electr\xF3nico.
    Si no ha recibido despu\xE9s de unos minutos, compruebe su caja de spam o haga clic en Reenviar`,
    emailSentTitle: "E-mail enviado",
    forgotPasswordTitle: "Olvidaste tu contrase\xF1a?",
    insertCode: "Introduzca el c\xF3digo",
    insertEmail: "Introduce tu e-mail",
    insertPhone: "Introduce tu n\xFAmero de celular",
    phoneErrorMessagePhrase: "N\xFAmero de tel\xE9fono no v\xE1lido",
    prepositionIn: "en",
    prepositionOr: "u",
    recoveryPasswordPhrase: "Para recuperar su contrase\xF1a vamos a enviar un {0} con instrucciones.",
    resendEmailButton: "Reenviar",
    resendSmsCodePhrase: "Si el c\xF3digo no llega dentro de unos minutos, vuelva a enviar.",
    sendAgain: "env\xEDe de nuevo.",
    sendAgainPhrase: "Si el c\xF3digo no llega dentro de unos minutos",
    sendButton: "Enviar",
    sentSmsCodePhrase: "Enviamos un c\xF3digo para su celular.",
    sms: "SMS",
    smsCodeErrorMessagePhrase: "C\xF3digo no v\xE1lido. Escriba de nuevo o p\xF3ngase en contacto con el soporte",
    supportContact: "Si no tiene acceso a {0} p\xF3ngase en contacto con el soporte",
    telephone: "tel\xE9fono",
    typeCodeTitle: "Escribir c\xF3digo enviado"
  },
  pt: {
    cancelButton: "Cancelar",
    closeButton: "Fechar",
    continueButton: "Continuar",
    email: "e-mail",
    emailErrorMessagePhrase: "Formato de e-mail inv\xE1lido",
    emailSentConfirmationPhrase: `Enviamos as instru\xE7\xF5es e link de cria\xE7\xE3o de nova senha para o seu e-mail.
    Caso n\xE3o tenha recebido ap\xF3s alguns minutos, verifique sua caixa de spam ou clique em Reenviar.`,
    emailSentTitle: "E-mail enviado",
    forgotPasswordTitle: "Esqueceu sua senha?",
    insertCode: "Digite o c\xF3digo",
    insertEmail: "Insira seu e-mail",
    insertPhone: "Insira seu n\xFAmero de celular",
    phoneErrorMessagePhrase: "N\xFAmero de telefone inv\xE1lido",
    prepositionIn: "em",
    prepositionOr: "ou",
    recoveryPasswordPhrase: "Para recuperar sua senha vamos enviar um {0} com instru\xE7\xF5es.",
    resendEmailButton: "Reenviar",
    resendSmsCodePhrase: "Se o c\xF3digo n\xE3o chegar dentro de alguns minutos envie novamente",
    sendAgain: "envie novamente.",
    sendAgainPhrase: "Se o c\xF3digo n\xE3o chegar dentro de alguns minutos",
    sendButton: "Enviar",
    sentSmsCodePhrase: "Enviamos um c\xF3digo para seu celular cadastrado.",
    sms: "SMS",
    smsCodeErrorMessagePhrase: "C\xF3digo inv\xE1lido. Digite novamente ou contacte o suporte",
    supportContact: "Se n\xE3o tiver acesso ao {0} contacte o suporte",
    telephone: "telefone",
    typeCodeTitle: "Digitar c\xF3digo enviado"
  },
  ru: {
    cancelButton: "\u043E\u0442\u043C\u0435\u043D\u0438\u0442\u044C",
    closeButton: "\u0431\u043B\u0438\u0437\u043A\u043E",
    continueButton: "\u0431\u043B\u0438\u0437\u043A\u043E",
    email: "\u043F\u043E \u044D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u043E\u0439 \u043F\u043E\u0447\u0442\u0435",
    emailErrorMessagePhrase: "\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u044D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u043E\u0439 \u043F\u043E\u0447\u0442\u044B",
    emailSentConfirmationPhrase: `\u041C\u044B \u043E\u0442\u043F\u0440\u0430\u0432\u0438\u043B\u0438 \u0438\u043D\u0441\u0442\u0440\u0443\u043A\u0446\u0438\u0438 \u0438 \u043D\u043E\u0432\u0443\u044E \u0441\u0441\u044B\u043B\u043A\u0443 \u0434\u043B\u044F \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F \u043F\u0430\u0440\u043E\u043B\u044F \u0434\u043B\u044F \u0432\u0430\u0448\u0435\u0439 \u044D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u043E\u0439 \u043F\u043E\u0447\u0442\u044B.
\u0415\u0441\u043B\u0438 \u0432\u044B \u043D\u0435 \u043F\u043E\u043B\u0443\u0447\u0438\u043B\u0438 \u0435\u0433\u043E \u0432 \u0442\u0435\u0447\u0435\u043D\u0438\u0435 \u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u0438\u0445 \u043C\u0438\u043D\u0443\u0442, \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u0435 \u0444\u043B\u0430\u0436\u043E\u043A \u0421\u043F\u0430\u043C \u0438\u043B\u0438 \u043D\u0430\u0436\u043C\u0438\u0442\u0435 \u0414\u0430\u043B\u0435\u0435.`,
    emailSentTitle: "\u041F\u0438\u0441\u044C\u043C\u043E \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u043E",
    forgotPasswordTitle: "\u0417\u0430\u0431\u044B\u043B\u0438 \u043F\u0430\u0440\u043E\u043B\u044C?",
    insertCode: "\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043A\u043E\u0434",
    insertEmail: "\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441 \u044D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u043E\u0439 \u043F\u043E\u0447\u0442\u044B",
    insertPhone: "\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u043E\u043C\u0435\u0440 \u0432\u0430\u0448\u0435\u0433\u043E \u043C\u043E\u0431\u0438\u043B\u044C\u043D\u043E\u0433\u043E \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430",
    phoneErrorMessagePhrase: "\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0439 \u043D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430",
    prepositionIn: "\u0432",
    prepositionOr: "\u0438\u043B\u0438",
    recoveryPasswordPhrase: "\u0414\u043B\u044F \u0432\u043E\u0441\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u0432\u0430\u0448\u0435\u0433\u043E \u043F\u0430\u0440\u043E\u043B\u044F \u043C\u044B \u0432\u044B\u0448\u043B\u0435\u043C {0} \u0441 \u0438\u043D\u0441\u0442\u0440\u0443\u043A\u0446\u0438\u044F\u043C\u0438.",
    resendEmailButton: "\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u0435\u0449\u0435 \u0440\u0430\u0437",
    resendSmsCodePhrase: "\u0415\u0441\u043B\u0438 \u043A\u043E\u0434 \u043D\u0435 \u043F\u0440\u0438\u0445\u043E\u0434\u0438\u0442 \u0447\u0435\u0440\u0435\u0437 \u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E \u043C\u0438\u043D\u0443\u0442, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437.",
    sendAgain: "\u043E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u0441\u043D\u043E\u0432\u0430.",
    sendAgainPhrase: "\u0415\u0441\u043B\u0438 \u043A\u043E\u0434 \u043D\u0435 \u043F\u0440\u0438\u0445\u043E\u0434\u0438\u0442 \u0447\u0435\u0440\u0435\u0437 \u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E \u043C\u0438\u043D\u0443\u0442",
    sendButton: "\u043F\u043E\u0441\u043B\u0430\u0442\u044C",
    sentSmsCodePhrase: "\u041C\u044B \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u044F\u0435\u043C \u043A\u043E\u0434 \u043D\u0430 \u0432\u0430\u0448 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0439 \u043C\u043E\u0431\u0438\u043B\u044C\u043D\u044B\u0439 \u0442\u0435\u043B\u0435\u0444\u043E\u043D.",
    sms: "SMS",
    smsCodeErrorMessagePhrase: "\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0439 \u043A\u043E\u0434. \u041F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u0435 \u0438\u043B\u0438 \u043E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u0432 \u0441\u043B\u0443\u0436\u0431\u0443 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u0438",
    supportContact: "\u0415\u0441\u043B\u0438 \u0443 \u0432\u0430\u0441 \u043D\u0435\u0442 \u0434\u043E\u0441\u0442\u0443\u043F\u0430 \u043A {0}, \u043E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u0432 \u0441\u043B\u0443\u0436\u0431\u0443 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u0438",
    telephone: "\u0442\u0435\u043B\u0435\u0444\u043E\u043D",
    typeCodeTitle: "\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u043D\u044B\u0439 \u043A\u043E\u0434"
  }
};
var PoModalPasswordRecoveryDefaultMaxLength = 15;
var PoModalPasswordRecoveryDefaultMinLength = 15;
var PoModalPasswordRecoveryDefaultPhone = "(99) 99999-9999";
var PoModalPasswordRecoveryTypeDefault = PoModalPasswordRecoveryType.Email;
var PoModalPasswordRecoveryBaseComponent = class _PoModalPasswordRecoveryBaseComponent {
  /**
   * @optional
   *
   * @description
   *
   * Definição de mensagem de erro customizada para quando o usuário passar um código SMS inválido ou errado.
   */
  codeError;
  /**
   * @optional
   *
   * @description
   *
   * Endpoint usado pelo template para requisição do recurso. Quando preenchido,
   * o métodos `p-submit` e `p-submit-code` serão ignorados e o componente adquirirá automatização
   * para o processo de solicitação de troca de senha.
   *
   * ### Processos
   * Ao digitar um valor válido no campo de email/telefone e pressionar **enviar**,
   * o componente fará uma requisição `POST` na url especificada nesta propriedade passando o objeto contendo o valor definido pelo usuário.
   *
   * ```
   * body {
   *  email: email,
   *  retry?: retry
   * }
   * ```
   *
   *
   * #### Recuperação por email
   * Para a recuperação de senha por **email**, o código de resposta HTTP de status esperado é `204`.
   *
   * Em caso de **sucesso**, será exibida a modal de confirmação de e-mail para o usuário.
   *
   *
   * > A ação **Reenviar** na tela de confirmação efetua uma nova requisição
   * passando-se o objeto com incremento para o valor da propriedade **retry**.
   *
   * *Processo finalizado.*
   *
   *
   * #### Recuperação por SMS
   * Se a opção de recuperação for por **SMS**, o código de status de sucesso deve ser `200`.
   * Em caso de **sucesso**, abre-se a modal de digitação de código SMS e a resposta
   * desta requisição deve retornar uma definição de dados abaixo:
   *
   * ```
   * 200:
   *  {
   *    hash: hash,
   *    urlValidationCode?: url
   *  }
   * ```
   *
   *
   * - O **hash** será o código de validação da solicitação do SMS para ser enviado juntamente com o código de verificação do SMS;
   * - **urlValidationCode** é a url usada para validação do código enviado por SMS.
   *
   *
   * > Caso não seja passado urlValidationCode, o endpoint usado para validação do código será `<p-url-recovery>/validation`.
   *
   *
   * #### Validação do código SMS
   * Ao digitar um valor válido no campo de código SMS e pressionar **continuar**, o componente fará uma requisição `POST` contendo:
   *
   * ```
   * POST /<p-url-recovery>/validation OU /<urlValidationCode>
   * Body {
   *  hash: hash,
   *  code: code
   * }
   * ```
   *
   *
   * O código de resposta HTTP de status esperado é `200`.
   *
   * Em caso de **erro** na validação do código SMS, a modal se mantém com o campo para digitação
   * de código SMS
   *
   *
   * > Pode-se atribuir a mensagem de erro (message) para o atributo `p-code-error` conforme retorno abaixo:
   *
   * ```
   * 400
   *  {
   *    error {
   *      message: 'Error Message'
   *    }
   *  }
   * ```
   *
   *
   * Em caso de **sucesso**, espera-se a resposta desta requisição retornando a seguinte definição:
   *
   * ```
   * 200:
   *  {
   *    token: token,
   *    urlChangePassword?: url
   *  }
   * ```
   *
   *
   * - **token**: Token de alteração de senha;
   * - **urlChangePassword**: url para o formulário de alteração de senha.
   *
   *
   * O componente está configurado para redirecionar para a url estabelecida em `urlChangePassword`.
   *
   * > Caso não seja passado valor para urlChangePassword,
   * a url usada para validação será a `<p-url-recovery>/changePassword?token=<token>`.
   *
   * *Processo finalizado.*
   */
  urlRecovery;
  /**
   * @optional
   *
   * @description
   *
   * Ação contendo como parâmetro o código enviado por SMS e digitado pelo usuário.
   *
   * > Esta propriedade será ignorada se for definido valor para a propriedade `p-url-recovery`.
   */
  codeSubmit = new EventEmitter();
  /**
   * @optional
   *
   * @description
   *
   * Ação contendo o email como parâmetro e que é executada quando o usuário clica sobres os botões de 'enviar' e 'reenviar' e-mail.
   *
   * > Esta propriedade será ignorada se for definido valor para a propriedade `p-url-recovery`.
   */
  submit = new EventEmitter();
  email;
  maxLength = PoModalPasswordRecoveryDefaultMaxLength;
  minLength = PoModalPasswordRecoveryDefaultMinLength;
  modalPasswordRecoveryTypeAll;
  phone;
  smsCode;
  smsCodeErrorMessage;
  literals = poModalPasswordRecoveryLiterals[poLocaleDefault];
  _componentsSize;
  _contactEmail;
  _phoneMask = PoModalPasswordRecoveryDefaultPhone;
  _type = PoModalPasswordRecoveryTypeDefault;
  /**
   * @optional
   *
   * @description
   *
   * Define o tamanho dos componentes de formulário no modal:
   * - `small`: aplica a medida small de cada componente (disponível apenas para acessibilidade AA).
   * - `medium`: aplica a medida medium de cada componente.
   *
   * > Caso a acessibilidade AA não esteja configurada, o tamanho `medium` será mantido.
   * Para mais detalhes, consulte a documentação do [po-theme](https://po-ui.io/documentation/po-theme).
   *
   * @default `medium`
   */
  set componentsSize(value) {
    this._componentsSize = validateSizeFn(value);
  }
  get componentsSize() {
    return this._componentsSize ?? getDefaultSizeFn();
  }
  /**
   * @optional
   *
   * @description
   *
   * Definição do e-mail que é exibido na mensagem para contato de suporte.
   */
  set contactEmail(value) {
    this._contactEmail = value;
    this.smsCodeErrorMessage = this.concatenateSMSErrorMessage(value);
  }
  get contactEmail() {
    return this._contactEmail;
  }
  /**
   * @optional
   *
   * @description
   *
   * Definição da mascara do campo de telefone.
   *
   * @default `(99) 99999-9999`
   */
  set phoneMask(value) {
    this._phoneMask = value || PoModalPasswordRecoveryDefaultPhone;
    this.minLength = this.maxLength = this._phoneMask.length;
  }
  get phoneMask() {
    return this._phoneMask;
  }
  /**
   * @optional
   *
   * @description
   *
   * Define o tipo de recuperação de senha que será exibido.
   *
   * @default `PoModalPasswordRecoveryType.Email`
   *
   */
  set type(value) {
    this._type = Object.values(PoModalPasswordRecoveryType).includes(value) ? value : PoModalPasswordRecoveryTypeDefault;
  }
  get type() {
    return this._type;
  }
  constructor(languageService) {
    this.literals = __spreadValues(__spreadValues({}, this.literals), poModalPasswordRecoveryLiterals[languageService.getShortLanguage()]);
  }
  concatenateSMSErrorMessage(value) {
    const literalCodeErrorMessage = this.literals.smsCodeErrorMessagePhrase;
    return value && value !== "" ? `${literalCodeErrorMessage} ${this.literals.prepositionIn} ${value}.` : literalCodeErrorMessage;
  }
  static \u0275fac = function PoModalPasswordRecoveryBaseComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoModalPasswordRecoveryBaseComponent)(\u0275\u0275directiveInject(PoLanguageService));
  };
  static \u0275dir = /* @__PURE__ */ \u0275\u0275defineDirective({
    type: _PoModalPasswordRecoveryBaseComponent,
    inputs: {
      codeError: [0, "p-code-error", "codeError"],
      urlRecovery: [0, "p-url-recovery", "urlRecovery"],
      componentsSize: [0, "p-components-size", "componentsSize"],
      contactEmail: [0, "p-contact-email", "contactEmail"],
      phoneMask: [0, "p-phone-mask", "phoneMask"],
      type: [0, "p-type", "type"]
    },
    outputs: {
      codeSubmit: "p-code-submit",
      submit: "p-submit"
    }
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoModalPasswordRecoveryBaseComponent, [{
    type: Directive
  }], () => [{
    type: PoLanguageService
  }], {
    codeError: [{
      type: Input,
      args: ["p-code-error"]
    }],
    urlRecovery: [{
      type: Input,
      args: ["p-url-recovery"]
    }],
    codeSubmit: [{
      type: Output,
      args: ["p-code-submit"]
    }],
    submit: [{
      type: Output,
      args: ["p-submit"]
    }],
    componentsSize: [{
      type: Input,
      args: ["p-components-size"]
    }],
    contactEmail: [{
      type: Input,
      args: ["p-contact-email"]
    }],
    phoneMask: [{
      type: Input,
      args: ["p-phone-mask"]
    }],
    type: [{
      type: Input,
      args: ["p-type"]
    }]
  });
})();
var PoModalPasswordRecoveryService = class _PoModalPasswordRecoveryService {
  http = inject(HttpClient);
  post(urlRecovery, item, params) {
    return this.http.post(urlRecovery, item, {
      observe: "response",
      params
    });
  }
  static \u0275fac = function PoModalPasswordRecoveryService_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoModalPasswordRecoveryService)();
  };
  static \u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
    token: _PoModalPasswordRecoveryService,
    factory: _PoModalPasswordRecoveryService.\u0275fac,
    providedIn: "root"
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoModalPasswordRecoveryService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], null, null);
})();
var PoModalPasswordRecoveryErrorMessageComponent = class _PoModalPasswordRecoveryErrorMessageComponent {
  /** Texto exibido na mensagem de erro. */
  text;
  static \u0275fac = function PoModalPasswordRecoveryErrorMessageComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoModalPasswordRecoveryErrorMessageComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoModalPasswordRecoveryErrorMessageComponent,
    selectors: [["po-modal-password-recovery-error-message"]],
    inputs: {
      text: [0, "p-text", "text"]
    },
    standalone: false,
    decls: 4,
    vars: 1,
    consts: [[1, "po-field-container-bottom-text-error", "po-field-container-error-item"], ["p-icon", "ICON_EXCLAMATION"], [1, "po-field-error-message"]],
    template: function PoModalPasswordRecoveryErrorMessageComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 0);
        \u0275\u0275element(1, "po-icon", 1);
        \u0275\u0275elementStart(2, "span", 2);
        \u0275\u0275text(3);
        \u0275\u0275elementEnd()();
      }
      if (rf & 2) {
        \u0275\u0275advance(3);
        \u0275\u0275textInterpolate(ctx.text);
      }
    },
    dependencies: [PoIconComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoModalPasswordRecoveryErrorMessageComponent, [{
    type: Component,
    args: [{
      selector: "po-modal-password-recovery-error-message",
      standalone: false,
      template: '<div class="po-field-container-bottom-text-error po-field-container-error-item">\n  <po-icon p-icon="ICON_EXCLAMATION"></po-icon>\n  <span class="po-field-error-message">{{ text }}</span>\n</div>\n'
    }]
  }], null, {
    text: [{
      type: Input,
      args: ["p-text"]
    }]
  });
})();
var PoModalPasswordRecoveryComponent = class _PoModalPasswordRecoveryComponent extends PoModalPasswordRecoveryBaseComponent {
  router = inject(Router);
  poI18nPipe = inject(PoI18nPipe);
  poModalPasswordRecoveryService = inject(PoModalPasswordRecoveryService);
  emailForm;
  recoveryModalElement;
  smsCodeForm;
  chosenTypeFormOption = PoModalPasswordRecoveryType.Email;
  codeMask = "9 9 9 9 9 9";
  control;
  emailModal = true;
  emailModalPhrases = {
    firstPhrase: null,
    secondPhrase: null
  };
  endpoint = ".";
  invalidCode = false;
  invalidEmail = false;
  modalTitle;
  modalType = PoModalPasswordRecoveryModalContent.Email;
  showCustomCodeError;
  smsCodeErrorMessagePhrase;
  submittedCodeValue = {};
  submittedContactValue = {};
  primaryAction = {
    label: void 0,
    action: () => {
    }
  };
  secondaryAction = {
    label: void 0,
    action: () => {
    }
  };
  typeFormOptions = [{
    label: "e-mail",
    value: PoModalPasswordRecoveryType.Email
  }, {
    label: "SMS",
    value: PoModalPasswordRecoveryType.SMS
  }];
  passwordRecoverySubscription;
  smsBodyResponse;
  smsCodeSubscription;
  constructor() {
    const poLanguageService = inject(PoLanguageService);
    super(poLanguageService);
  }
  ngOnDestroy() {
    if (this.passwordRecoverySubscription) {
      this.passwordRecoverySubscription.unsubscribe();
    }
    if (this.smsCodeSubscription) {
      this.smsCodeSubscription.unsubscribe();
    }
  }
  completed() {
    this.cancelAction();
  }
  formModelChangesCheck(form) {
    const invalidForm = form.invalid;
    this.invalidEmail = invalidForm && form.dirty;
    this.primaryAction.disabled = invalidForm;
    if (this.modalType === PoModalPasswordRecoveryModalContent.SMSCode) {
      const codeError = this.codeError !== void 0 && this.codeError !== "";
      this.showCustomCodeError = codeError && form.pristine;
    }
  }
  getInputType(type) {
    this.type = type;
    this.pipeModalPhrases();
    setTimeout(() => {
      this.control = this.emailForm.controls[type];
      this.formModelChangesCheck(this.emailForm);
      this.resetFormFields(this.control);
    });
  }
  open() {
    const control = this.checkFormType(this.type);
    this.control = this.emailForm.controls[control];
    this.setEmailModalPhrasesAndActions();
    this.formModelChangesCheck(this.emailForm);
    this.recoveryModalElement.open();
  }
  openConfirmation() {
    this.modalTitle = this.literals.emailSentTitle;
    this.modalType = PoModalPasswordRecoveryModalContent.Confirmation;
    this.setActions(this.cancelAction, this.literals.closeButton, this.submitAction, this.literals.resendEmailButton, this.componentsSize, false);
  }
  openSmsCode() {
    this.modalTitle = this.literals.typeCodeTitle;
    this.modalType = PoModalPasswordRecoveryModalContent.SMSCode;
    this.setActions(this.submitSmsCodeAction, this.literals.continueButton, this.cancelAction, this.literals.cancelButton, this.componentsSize, true);
    setTimeout(() => {
      this.control = this.smsCodeForm.controls["sms"];
      this.formModelChangesCheck(this.smsCodeForm);
    });
  }
  resendSmsCode() {
    this.incrementRetryAttempts();
    if (this.urlRecovery) {
      this.submitActionRequest(this.submittedContactValue, this.type);
    } else {
      this.submit.emit(this.submittedContactValue);
    }
  }
  assignSmsResponse(responseObj) {
    this.smsBodyResponse = Object.assign({}, {
      hash: responseObj.hash
    });
    if (responseObj.urlValidationCode) {
      this.smsBodyResponse = Object.assign(this.smsBodyResponse, {
        urlValidationCode: responseObj.urlValidationCode
      });
    }
  }
  cancelAction() {
    this.resetFormFields(this.control);
    this.submittedContactValue = {};
    this.chosenTypeFormOption = PoModalPasswordRecoveryType.Email;
    this.modalType = PoModalPasswordRecoveryModalContent.Email;
    this.type = this.modalPasswordRecoveryTypeAll ? PoModalPasswordRecoveryType.All : this.type;
    this.recoveryModalElement.close();
  }
  checkFormType(type) {
    return type !== PoModalPasswordRecoveryType.All ? type : PoModalPasswordRecoveryType.Email;
  }
  formReset(control) {
    control.markAsPristine();
    control.markAsUntouched();
    control.updateValueAndValidity();
  }
  getEmitValue(type) {
    return type === PoModalPasswordRecoveryType.SMS ? this.phone : this.email;
  }
  incrementRetryAttempts() {
    this.submittedContactValue.retry = this.submittedContactValue.retry + 1 || 1;
  }
  openExternalLink(url, queryParam) {
    window.open(`${url}?token=${queryParam}`, "_self");
  }
  openInternalLink(url, endpoint, queryParam) {
    this.router.navigate([`${url}/${endpoint}`], {
      queryParams: {
        token: queryParam
      }
    });
  }
  pipeModalPhrases() {
    if (this.type === PoModalPasswordRecoveryType.SMS) {
      this.emailModalPhrases.firstPhrase = this.setPipeArguments(this.literals.recoveryPasswordPhrase, this.literals.sms);
      this.emailModalPhrases.secondPhrase = this.setPipeArguments(this.literals.supportContact, this.literals.telephone);
    } else {
      this.emailModalPhrases.firstPhrase = this.setPipeArguments(this.literals.recoveryPasswordPhrase, this.literals.email);
      this.emailModalPhrases.secondPhrase = this.setPipeArguments(this.literals.supportContact, this.literals.email);
    }
  }
  redirectToChangePassword(recoveryToken) {
    const urlChangePassword = recoveryToken.urlChangePassword;
    if (urlChangePassword) {
      isExternalLink(urlChangePassword) ? this.openExternalLink(urlChangePassword, recoveryToken.token) : this.openInternalLink(this.urlRecovery, urlChangePassword, recoveryToken.token);
    } else {
      const changePasswordEndpoint = "changePassword";
      this.openInternalLink(this.urlRecovery, changePasswordEndpoint, recoveryToken.token);
    }
  }
  resetFormFields(control) {
    this.formReset(control);
    this.email = void 0;
    this.phone = void 0;
    this.smsCode = void 0;
  }
  setActions(primaryAction, primarylabel, secondaryAction, secondaryLabel, componentsSize, disabled) {
    this.primaryAction.action = () => primaryAction.call(this);
    this.primaryAction.label = primarylabel;
    this.secondaryAction.action = () => secondaryAction.call(this);
    this.secondaryAction.label = secondaryLabel;
    this.componentsSize = componentsSize;
    this.primaryAction.disabled = disabled;
  }
  setEmailModalPhrasesAndActions() {
    this.modalTitle = this.literals.forgotPasswordTitle;
    this.pipeModalPhrases();
    this.modalPasswordRecoveryTypeAll = this.type === PoModalPasswordRecoveryType.All;
    this.setActions(this.submitAction, this.literals.sendButton, this.cancelAction, this.literals.cancelButton, this.componentsSize, true);
  }
  setRequestEndpoint(urlValidationCode) {
    const endpoint = urlValidationCode || "validation";
    return `${this.urlRecovery}/${endpoint}`;
  }
  setPipeArguments(literalAttr, arg) {
    return this.poI18nPipe.transform(literalAttr, arg);
  }
  submitAction() {
    this.modalType === PoModalPasswordRecoveryModalContent.Confirmation ? this.incrementRetryAttempts() : this.formReset(this.control);
    this.submittedContactValue[this.checkFormType(this.type)] = this.getEmitValue(this.type);
    if (this.urlRecovery) {
      this.submitActionRequest(this.submittedContactValue, this.type);
    } else {
      this.submit.emit(this.submittedContactValue);
    }
  }
  submitActionRequest(data, modalType) {
    const params = modalType === PoModalPasswordRecoveryType.SMS ? {
      type: "sms"
    } : void 0;
    this.passwordRecoverySubscription = this.poModalPasswordRecoveryService.post(this.urlRecovery, data, params).subscribe((response) => {
      if ((modalType === PoModalPasswordRecoveryType.Email || modalType === PoModalPasswordRecoveryType.All) && response.status === 204) {
        this.openConfirmation();
      } else if (modalType === PoModalPasswordRecoveryType.SMS && response.status === 200) {
        this.assignSmsResponse(response.body);
        this.openSmsCode();
      }
    });
  }
  submitSmsCodeAction() {
    this.submittedCodeValue.code = this.smsCode;
    if (this.urlRecovery) {
      this.submittedCodeValue = Object.assign(this.submittedCodeValue, {
        hash: this.smsBodyResponse.hash
      });
      this.submitSmsCodeRequest(this.submittedCodeValue);
    } else {
      this.codeSubmit.emit(this.submittedCodeValue);
    }
    this.resetFormFields(this.control);
  }
  submitSmsCodeRequest(data) {
    this.smsCodeSubscription = this.poModalPasswordRecoveryService.post(this.setRequestEndpoint(this.smsBodyResponse.urlValidationCode), data).subscribe((response) => {
      const successStatus = response.status === 200;
      if (successStatus) {
        this.completed();
        this.redirectToChangePassword(response.body);
      }
    }, (error) => {
      this.codeError = error.error.message;
      this.openSmsCode();
    });
  }
  static \u0275fac = function PoModalPasswordRecoveryComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoModalPasswordRecoveryComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoModalPasswordRecoveryComponent,
    selectors: [["po-modal-password-recovery"]],
    viewQuery: function PoModalPasswordRecoveryComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c0, 5);
        \u0275\u0275viewQuery(_c1, 7);
        \u0275\u0275viewQuery(_c2, 5);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.emailForm = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.recoveryModalElement = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.smsCodeForm = _t.first);
      }
    },
    standalone: false,
    features: [\u0275\u0275InheritDefinitionFeature],
    decls: 6,
    vars: 8,
    consts: [["recoveryModal", ""], ["emailForm", "ngForm"], ["smsCodeModal", ""], ["smsCodeForm", "ngForm"], ["confirmationModal", ""], ["p-hide-close", "", "p-size", "auto", 3, "ngSwitch", "p-components-size", "p-primary-action", "p-secondary-action", "p-title"], [1, "po-modal-password-recovery-wrapper"], ["class", "po-modal-password-recovery-content po-row", 4, "ngSwitchCase"], [1, "po-modal-password-recovery-content", "po-row"], [1, "po-modal-password-recovery-text", "po-md-12", "po-mb-1"], [1, "po-mb-2", "po-md-12"], [4, "ngIf"], [1, "po-mt-1"], ["name", "email", "p-required", "", 3, "ngModel", "p-label", "p-size", "ngModelChange", "p-change-model", 4, "ngIf"], ["name", "sms", "p-icon", "ICON_TELEPHONE", "p-required", "", 3, "ngModel", "p-label", "p-mask", "p-maxlength", "p-minlength", "p-size", "ngModelChange", "p-change-model", 4, "ngIf"], [1, "po-field-container-bottom", "po-field-container-error-container"], [3, "p-text", 4, "ngIf"], [1, "po-modal-password-recovery-text", "po-md-12"], ["name", "type", 3, "ngModelChange", "p-change", "ngModel", "p-options", "p-size"], ["name", "email", "p-required", "", 3, "ngModelChange", "p-change-model", "ngModel", "p-label", "p-size"], ["name", "sms", "p-icon", "ICON_TELEPHONE", "p-required", "", 3, "ngModelChange", "p-change-model", "ngModel", "p-label", "p-mask", "p-maxlength", "p-minlength", "p-size"], [3, "p-text"], ["target", "_self", 1, "po-modal-password-recovery-link", 3, "href"], ["name", "sms", "p-maxlength", "11", "p-minlength", "11", "p-required", "", 3, "ngModelChange", "p-change-model", "ngModel", "p-label", "p-mask", "p-size"], [1, "po-modal-password-recovery-link", 3, "click"], ["src", "./assets/images/email-sent.svg", 1, "po-modal-password-recovery-user-image", "po-mb-2"], [1, "po-modal-password-recovery-text"]],
    template: function PoModalPasswordRecoveryComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "po-modal", 5, 0)(2, "div", 6);
        \u0275\u0275template(3, PoModalPasswordRecoveryComponent_div_3_Template, 16, 8, "div", 7)(4, PoModalPasswordRecoveryComponent_div_4_Template, 15, 9, "div", 7)(5, PoModalPasswordRecoveryComponent_div_5_Template, 5, 1, "div", 7);
        \u0275\u0275elementEnd()();
      }
      if (rf & 2) {
        \u0275\u0275property("ngSwitch", ctx.modalType)("p-components-size", ctx.componentsSize)("p-primary-action", ctx.primaryAction)("p-secondary-action", ctx.secondaryAction)("p-title", ctx.modalTitle);
        \u0275\u0275advance(3);
        \u0275\u0275property("ngSwitchCase", "email");
        \u0275\u0275advance();
        \u0275\u0275property("ngSwitchCase", "smsCode");
        \u0275\u0275advance();
        \u0275\u0275property("ngSwitchCase", "confirmation");
      }
    },
    dependencies: [NgIf, NgSwitch, NgSwitchCase, \u0275NgNoValidate, NgControlStatus, NgControlStatusGroup, NgModel, NgForm, PoRadioGroupComponent, PoEmailComponent, PoInputComponent, PoModalComponent, PoModalPasswordRecoveryErrorMessageComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoModalPasswordRecoveryComponent, [{
    type: Component,
    args: [{
      selector: "po-modal-password-recovery",
      standalone: false,
      template: `<po-modal
  #recoveryModal
  p-hide-close
  p-size="auto"
  [ngSwitch]="modalType"
  [p-components-size]="componentsSize"
  [p-primary-action]="primaryAction"
  [p-secondary-action]="secondaryAction"
  [p-title]="modalTitle"
>
  <div class="po-modal-password-recovery-wrapper">
    <div *ngSwitchCase="'email'" class="po-modal-password-recovery-content po-row">
      <div class="po-modal-password-recovery-text po-md-12 po-mb-1">
        {{ emailModalPhrases.firstPhrase }}
      </div>
      <div class="po-mb-2 po-md-12">
        <form #emailForm="ngForm">
          <div *ngIf="modalPasswordRecoveryTypeAll">
            <po-radio-group
              name="type"
              [(ngModel)]="chosenTypeFormOption"
              [p-options]="typeFormOptions"
              [p-size]="componentsSize"
              (p-change)="getInputType($event)"
            >
            </po-radio-group>
          </div>

          <div class="po-mt-1">
            <po-email
              *ngIf="type === 'email' || type === 'all'"
              name="email"
              [(ngModel)]="email"
              p-required
              [p-label]="literals.insertEmail"
              [p-size]="componentsSize"
              (p-change-model)="formModelChangesCheck(emailForm)"
            >
            </po-email>

            <po-input
              *ngIf="type === 'sms'"
              name="sms"
              [(ngModel)]="phone"
              p-icon="ICON_TELEPHONE"
              p-required
              [p-label]="literals.insertPhone"
              [p-mask]="phoneMask"
              [p-maxlength]="maxLength"
              [p-minlength]="minLength"
              [p-size]="componentsSize"
              (p-change-model)="formModelChangesCheck(emailForm)"
            >
            </po-input>
          </div>

          <div class="po-field-container-bottom po-field-container-error-container">
            <po-modal-password-recovery-error-message
              *ngIf="invalidEmail && control.dirty"
              [p-text]="type === 'sms' ? literals.phoneErrorMessagePhrase : literals.emailErrorMessagePhrase"
            >
            </po-modal-password-recovery-error-message>
          </div>
        </form>
      </div>
      <div class="po-modal-password-recovery-text po-md-12">
        {{ emailModalPhrases.secondPhrase }}
        <span *ngIf="contactEmail">
          {{ literals.prepositionIn }}
          <a class="po-modal-password-recovery-link" href="mailto:{{ contactEmail }}" target="_self">
            {{ contactEmail }}
          </a>
        </span>
        {{ endpoint }}
      </div>
    </div>

    <div #smsCodeModal *ngSwitchCase="'smsCode'" class="po-modal-password-recovery-content po-row">
      <div class="po-modal-password-recovery-text po-md-12 po-mb-1">{{ literals.sentSmsCodePhrase }}</div>
      <div class="po-mb-2 po-md-12">
        <form #smsCodeForm="ngForm">
          <po-input
            name="sms"
            [(ngModel)]="smsCode"
            p-maxlength="11"
            p-minlength="11"
            p-required
            [p-label]="literals.insertCode"
            [p-mask]="codeMask"
            [p-size]="componentsSize"
            (p-change-model)="formModelChangesCheck(smsCodeForm)"
          >
          </po-input>
          <div class="po-field-container-bottom po-field-container-error-container">
            <po-modal-password-recovery-error-message
              *ngIf="invalidEmail"
              [p-text]="smsCodeErrorMessage || this.literals.smsCodeErrorMessagePhrase"
            >
            </po-modal-password-recovery-error-message>
            <po-modal-password-recovery-error-message *ngIf="showCustomCodeError" [p-text]="codeError">
            </po-modal-password-recovery-error-message>
          </div>
        </form>
      </div>
      <div class="po-modal-password-recovery-text po-md-12">
        {{ literals.sendAgainPhrase }}
        <span class="po-modal-password-recovery-link" (click)="resendSmsCode()">{{ literals.sendAgain }}</span>
      </div>
    </div>

    <div #confirmationModal *ngSwitchCase="'confirmation'" class="po-modal-password-recovery-content po-row">
      <img class="po-modal-password-recovery-user-image po-mb-2" src="./assets/images/email-sent.svg" />
      <div class="po-modal-password-recovery-text">
        {{ literals.emailSentConfirmationPhrase }}
      </div>
    </div>
  </div>
</po-modal>
`
    }]
  }], () => [], {
    emailForm: [{
      type: ViewChild,
      args: ["emailForm"]
    }],
    recoveryModalElement: [{
      type: ViewChild,
      args: ["recoveryModal", {
        static: true
      }]
    }],
    smsCodeForm: [{
      type: ViewChild,
      args: ["smsCodeForm"]
    }]
  });
})();
var PoModalPasswordRecoveryModule = class _PoModalPasswordRecoveryModule {
  static \u0275fac = function PoModalPasswordRecoveryModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoModalPasswordRecoveryModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoModalPasswordRecoveryModule,
    declarations: [PoModalPasswordRecoveryComponent, PoModalPasswordRecoveryErrorMessageComponent],
    imports: [CommonModule, FormsModule, PoFieldModule, PoModalModule, PoIconModule],
    exports: [PoModalPasswordRecoveryComponent, PoModalPasswordRecoveryErrorMessageComponent]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    providers: [PoI18nPipe, PoModalPasswordRecoveryService],
    imports: [CommonModule, FormsModule, PoFieldModule, PoModalModule, PoIconModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoModalPasswordRecoveryModule, [{
    type: NgModule,
    args: [{
      imports: [CommonModule, FormsModule, PoFieldModule, PoModalModule, PoIconModule],
      declarations: [PoModalPasswordRecoveryComponent, PoModalPasswordRecoveryErrorMessageComponent],
      exports: [PoModalPasswordRecoveryComponent, PoModalPasswordRecoveryErrorMessageComponent],
      providers: [PoI18nPipe, PoModalPasswordRecoveryService]
    }]
  }], null, null);
})();
var PoPageBackgroundComponent = class _PoPageBackgroundComponent {
  poLanguageService = inject(PoLanguageService);
  /** Insere uma imagem de destaque ao lado direito do container. */
  background;
  /** Idioma inicial selecionado no combo */
  initialSelectLanguage;
  /** Designa se o logotipo deve desaparecer em resoluções menores. */
  hideLogo;
  /** Texto de destaque sobreposto à imagem de destaque. Essa opção é utilizada em conjunto com o atributo `p-background`. */
  highlightInfo;
  /**
   * @optional
   *
   * @description
   *
   * Evento disparado ao selecionar alguma opção no seletor de idiomas.
   * Para este evento será passado como parâmetro o valor de idioma selecionado.
   */
  selectedLanguage = new EventEmitter();
  selectedLanguageOption;
  _componentsSize = void 0;
  _showSelectLanguage = false;
  _languagesList;
  _selectLanguageOptions;
  /**
   * @optional
   *
   * @description
   *
   * Define o tamanho dos componentes de formulário no template:
   * - `small`: aplica a medida small de cada componente (disponível apenas para acessibilidade AA).
   * - `medium`: aplica a medida medium de cada componente.
   *
   * > Caso a acessibilidade AA não esteja configurada, o tamanho `medium` será mantido.
   * Para mais detalhes, consulte a documentação do [po-theme](https://po-ui.io/documentation/po-theme).
   *
   * @default `medium`
   */
  set componentsSize(value) {
    this._componentsSize = validateSizeFn(value);
  }
  get componentsSize() {
    return this._componentsSize ?? getDefaultSizeFn();
  }
  /** Lista de idiomas para o combo box */
  set languagesList(value) {
    this._languagesList = value;
    this.setLanguageOptions();
  }
  get languagesList() {
    if (this._languagesList?.length) {
      return this._languagesList;
    }
    return poLanguageDefault;
  }
  /** Caminho para a logomarca localizada na parte superior. */
  logo;
  /** Texto alternativo para a logomarca. */
  logoAlt;
  /**
   * @optional
   *
   * @description
   *
   * Caminho para a logomarca localizada no rodapé.
   */
  secondaryLogo;
  /** Define se o seletor de idiomas deve ser exibido. */
  set showSelectLanguage(showSelectLanguage) {
    this._showSelectLanguage = convertToBoolean(showSelectLanguage);
  }
  get showSelectLanguage() {
    return this._showSelectLanguage;
  }
  ngOnInit() {
    this.selectedLanguageOption = this.initialSelectLanguage || this.poLanguageService.getShortLanguage();
  }
  onChangeLanguage() {
    this.selectedLanguage.emit(this.selectedLanguageOption);
  }
  get selectLanguageOptions() {
    return this._selectLanguageOptions;
  }
  setLanguageOptions() {
    this._selectLanguageOptions = this.languagesList.map((language) => ({
      label: language.description,
      value: language.language
    }));
  }
  static \u0275fac = function PoPageBackgroundComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageBackgroundComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageBackgroundComponent,
    selectors: [["po-page-background"]],
    inputs: {
      background: [0, "p-background", "background"],
      initialSelectLanguage: [0, "p-initial-language", "initialSelectLanguage"],
      hideLogo: [0, "p-hide-logo", "hideLogo"],
      highlightInfo: [0, "p-highlight-info", "highlightInfo"],
      componentsSize: [0, "p-components-size", "componentsSize"],
      languagesList: [0, "p-languages", "languagesList"],
      logo: [0, "p-logo", "logo"],
      logoAlt: [0, "p-logo-alt", "logoAlt"],
      secondaryLogo: [0, "p-secondary-logo", "secondaryLogo"],
      showSelectLanguage: [0, "p-show-select-language", "showSelectLanguage"]
    },
    outputs: {
      selectedLanguage: "p-selected-language"
    },
    standalone: false,
    ngContentSelectors: _c3,
    decls: 14,
    vars: 7,
    consts: [[1, "po-page-login-container"], [1, "po-page-login-panel"], [1, "po-page-background-main-logo"], ["p-class", "po-page-background-main-logo-image", 3, "p-link", "p-logo", "p-logo-alt"], [1, "po-page-login-body"], [1, "po-page-login-panel-content"], [1, "po-page-background-footer", "po-sm-12"], [1, "po-page-background-footer-mobile-only"], [1, "po-page-background-footer-content"], [1, "po-page-background-footer-select"], [1, "po-page-background-secondary-logo", 3, "ngClass"], ["p-class", "po-page-background-secondary-logo-image", "p-logo-alt", "secondary-logomarca", 3, "p-link", "p-logo"], [3, "ngClass", "background-image"], ["name", "selectedLanguageOption", 3, "ngModelChange", "p-change", "ngModel", "p-options", "p-size"], [3, "ngClass"], [1, "po-page-login-highlight-text"], [1, "po-font-display"]],
    template: function PoPageBackgroundComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275projectionDef();
        \u0275\u0275elementStart(0, "div", 0)(1, "div", 1)(2, "div", 2);
        \u0275\u0275template(3, PoPageBackgroundComponent_Conditional_3_Template, 1, 3, "po-logo", 3);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(4, "div", 4)(5, "div", 5);
        \u0275\u0275projection(6);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(7, "div", 6);
        \u0275\u0275element(8, "po-divider", 7);
        \u0275\u0275elementStart(9, "div", 8);
        \u0275\u0275template(10, PoPageBackgroundComponent_Conditional_10_Template, 2, 3, "div", 9);
        \u0275\u0275elementStart(11, "div", 10);
        \u0275\u0275template(12, PoPageBackgroundComponent_Conditional_12_Template, 1, 2, "po-logo", 11);
        \u0275\u0275elementEnd()()()();
        \u0275\u0275template(13, PoPageBackgroundComponent_Conditional_13_Template, 4, 4, "div", 12);
        \u0275\u0275elementEnd();
      }
      if (rf & 2) {
        \u0275\u0275advance(2);
        \u0275\u0275classProp("po-page-background-hide-logo", ctx.hideLogo);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.logo ? 3 : -1);
        \u0275\u0275advance(7);
        \u0275\u0275conditional(ctx.showSelectLanguage ? 10 : -1);
        \u0275\u0275advance();
        \u0275\u0275property("ngClass", ctx.showSelectLanguage ? "po-page-background-secondary-logo-right" : "po-page-background-secondary-logo-centered");
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.secondaryLogo ? 12 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.background ? 13 : -1);
      }
    },
    dependencies: [NgClass, NgControlStatus, NgModel, PoDividerComponent, PoSelectComponent, PoLogoComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageBackgroundComponent, [{
    type: Component,
    args: [{
      selector: "po-page-background",
      standalone: false,
      template: `<div class="po-page-login-container">
  <div class="po-page-login-panel">
    <div class="po-page-background-main-logo" [class.po-page-background-hide-logo]="hideLogo">
      @if (logo) {
        <po-logo
          p-class="po-page-background-main-logo-image"
          [p-link]="false"
          [p-logo]="logo"
          [p-logo-alt]="logoAlt"
        ></po-logo>
      }
    </div>

    <div class="po-page-login-body">
      <div class="po-page-login-panel-content">
        <ng-content></ng-content>
      </div>
    </div>
    <div class="po-page-background-footer po-sm-12">
      <po-divider class="po-page-background-footer-mobile-only"></po-divider>

      <div class="po-page-background-footer-content">
        @if (showSelectLanguage) {
          <div class="po-page-background-footer-select">
            <po-select
              name="selectedLanguageOption"
              [(ngModel)]="selectedLanguageOption"
              [p-options]="selectLanguageOptions"
              [p-size]="componentsSize"
              (p-change)="onChangeLanguage()"
            ></po-select>
          </div>
        }

        <div
          class="po-page-background-secondary-logo"
          [ngClass]="
            showSelectLanguage
              ? 'po-page-background-secondary-logo-right'
              : 'po-page-background-secondary-logo-centered'
          "
        >
          @if (secondaryLogo) {
            <po-logo
              p-class="po-page-background-secondary-logo-image"
              [p-link]="false"
              [p-logo]="secondaryLogo"
              p-logo-alt="secondary-logomarca"
            ></po-logo>
          }
        </div>
      </div>
    </div>
  </div>

  @if (background) {
    <div
      [ngClass]="background ? 'po-page-login-highlight-image' : 'po-page-login-highlight-image-off'"
      [style.background-image]="'url(' + background + ')'"
    >
      <div class="po-page-login-highlight-text">
        <div class="po-font-display">{{ highlightInfo }}</div>
      </div>
    </div>
  }
</div>
`
    }]
  }], null, {
    background: [{
      type: Input,
      args: ["p-background"]
    }],
    initialSelectLanguage: [{
      type: Input,
      args: ["p-initial-language"]
    }],
    hideLogo: [{
      type: Input,
      args: ["p-hide-logo"]
    }],
    highlightInfo: [{
      type: Input,
      args: ["p-highlight-info"]
    }],
    selectedLanguage: [{
      type: Output,
      args: ["p-selected-language"]
    }],
    componentsSize: [{
      type: Input,
      args: ["p-components-size"]
    }],
    languagesList: [{
      type: Input,
      args: ["p-languages"]
    }],
    logo: [{
      type: Input,
      args: ["p-logo"]
    }],
    logoAlt: [{
      type: Input,
      args: ["p-logo-alt"]
    }],
    secondaryLogo: [{
      type: Input,
      args: ["p-secondary-logo"]
    }],
    showSelectLanguage: [{
      type: Input,
      args: ["p-show-select-language"]
    }]
  });
})();
var PoPageBackgroundModule = class _PoPageBackgroundModule {
  static \u0275fac = function PoPageBackgroundModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageBackgroundModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoPageBackgroundModule,
    declarations: [PoPageBackgroundComponent],
    imports: [CommonModule, FormsModule, RouterModule, PoDividerModule, PoFieldModule, PoLogoModule],
    exports: [PoPageBackgroundComponent]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    imports: [CommonModule, FormsModule, RouterModule, PoDividerModule, PoFieldModule, PoLogoModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageBackgroundModule, [{
    type: NgModule,
    args: [{
      imports: [CommonModule, FormsModule, RouterModule, PoDividerModule, PoFieldModule, PoLogoModule],
      declarations: [PoPageBackgroundComponent],
      exports: [PoPageBackgroundComponent]
    }]
  }], null, null);
})();
var PoPageBlockedUserReason;
(function(PoPageBlockedUserReason2) {
  PoPageBlockedUserReason2["None"] = "none";
  PoPageBlockedUserReason2["ExceededAttempts"] = "exceededAttempts";
  PoPageBlockedUserReason2["ExpiredPassword"] = "expiredPassword";
})(PoPageBlockedUserReason || (PoPageBlockedUserReason = {}));
var PoPageBlockedUserReasonDefault = PoPageBlockedUserReason.None;
var PoPageBlockedUserParamsDefault = {
  attempts: 5,
  days: 90,
  hours: 24
};
var PoPageBlockedUserBaseComponent = class _PoPageBlockedUserBaseComponent {
  /**
   * @optional
   *
   * @description
   *
   * Valor para o email de contato que deve ser exibido. A ação está de acordo com o protocolo MAILTO e é possível definir
   * tanto rotas internas quanto externas.
   */
  contactEmail;
  /**
   * @optional
   *
   * @description
   *
   * Valor para o telefone de contato que deve ser exibido. A ação está de acordo com o protocolo TEL.
   *
   * > A propriedade não contem tratamento de máscara, fica a critério do desenvolvedor defini-la.
   */
  contactPhone;
  /** Caminho para a logomarca localizada na parte superior, caso não seja definida ou seja inválida assume a logo padrão do PO UI. */
  logo;
  /**
   * @optional
   *
   * @description
   *
   * Caminho para a logomarca localizada no rodapé.
   */
  secondaryLogo;
  _componentsSize = void 0;
  _params = __spreadValues({}, PoPageBlockedUserParamsDefault);
  _reason = PoPageBlockedUserReason.None;
  _urlBack = "/";
  /**
   * @optional
   *
   * @description
   *
   * Define o tamanho dos componentes de formulário no template:
   * - `small`: aplica a medida small de cada componente (disponível apenas para acessibilidade AA).
   * - `medium`: aplica a medida medium de cada componente.
   *
   * > Caso a acessibilidade AA não esteja configurada, o tamanho `medium` será mantido.
   * Para mais detalhes, consulte a documentação do [po-theme](https://po-ui.io/documentation/po-theme).
   *
   * @default `medium`
   */
  set componentsSize(value) {
    this._componentsSize = validateSizeFn(value);
  }
  get componentsSize() {
    return this._componentsSize ?? getDefaultSizeFn();
  }
  /**
   * @optional
   *
   * @description
   *
   * Designação de valores usados para a customização da mensagem de bloqueio.
   * Confira abaixo os valores pré-definidos.
   *
   * ```
   *  const customLiterals: PoPageBlockedUserReasonParams = {
   *    attempts: 5,
   *    days: 90,
   *    hours: 24
   *  };
   * ```
   *
   * > Salientamos a importância e atenção para configuração desses valores conforme definidos no projeto.
   *
   * > Veja os parâmetros customizáveis na interface `PoPageBlockedUserReasonParams`.
   *
   */
  set params(value) {
    if (value instanceof Object) {
      const keys2 = Object.keys(value);
      const newParams = __spreadValues({}, PoPageBlockedUserParamsDefault);
      keys2.forEach((key) => {
        newParams[key] = value[key];
      });
      this._params = newParams;
    } else {
      this._params = __spreadValues({}, PoPageBlockedUserParamsDefault);
    }
  }
  get params() {
    return this._params;
  }
  /**
   * @optional
   *
   * @description
   *
   * Definição de motivo de bloqueio de usuário. As informações modificam conforme o motivo selecionado.
   *
   * > Veja os valores válidos no *enum* `PoPageBlockedUserReason`.
   *
   * @default `PoPageBlockedUserReason.None`
   */
  set reason(value) {
    this._reason = Object.values(PoPageBlockedUserReason).includes(value) ? value : PoPageBlockedUserReasonDefault;
  }
  get reason() {
    return this._reason;
  }
  /**
   * @optional
   *
   * @description
   *
   * URL para a ação de retorno da página.
   *
   * @default `/`
   */
  set urlBack(url) {
    this._urlBack = url;
  }
  get urlBack() {
    return this._urlBack;
  }
  static \u0275fac = function PoPageBlockedUserBaseComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageBlockedUserBaseComponent)();
  };
  static \u0275dir = /* @__PURE__ */ \u0275\u0275defineDirective({
    type: _PoPageBlockedUserBaseComponent,
    inputs: {
      contactEmail: [0, "p-contact-email", "contactEmail"],
      contactPhone: [0, "p-contact-phone", "contactPhone"],
      logo: [0, "p-logo", "logo"],
      secondaryLogo: [0, "p-secondary-logo", "secondaryLogo"],
      componentsSize: [0, "p-components-size", "componentsSize"],
      params: [0, "p-params", "params"],
      reason: [0, "p-reason", "reason"],
      urlBack: [0, "p-url-back", "urlBack"]
    }
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageBlockedUserBaseComponent, [{
    type: Directive
  }], null, {
    contactEmail: [{
      type: Input,
      args: ["p-contact-email"]
    }],
    contactPhone: [{
      type: Input,
      args: ["p-contact-phone"]
    }],
    logo: [{
      type: Input,
      args: ["p-logo"]
    }],
    secondaryLogo: [{
      type: Input,
      args: ["p-secondary-logo"]
    }],
    componentsSize: [{
      type: Input,
      args: ["p-components-size"]
    }],
    params: [{
      type: Input,
      args: ["p-params"]
    }],
    reason: [{
      type: Input,
      args: ["p-reason"]
    }],
    urlBack: [{
      type: Input,
      args: ["p-url-back"]
    }]
  });
})();
var poPageBlockedUserContactItemMargin = 16;
var PoPageBlockedUserContactsComponent = class _PoPageBlockedUserContactsComponent {
  changeDetector = inject(ChangeDetectorRef);
  contactGroup;
  mailItem;
  phoneItem;
  overflowItem = true;
  _email;
  _phone;
  set email(value) {
    this._email = value;
    this.checkContactItemWidth();
  }
  get email() {
    return this._email;
  }
  set phone(value) {
    this._phone = value;
    this.checkContactItemWidth();
  }
  get phone() {
    return this._phone;
  }
  checkContactItemWidth() {
    this.overflowItem = true;
    if (this.phone && this.email) {
      this.changeDetector.detectChanges();
      const phoneWidth = this.phoneItem.nativeElement.offsetWidth;
      const mailWidth = this.mailItem.nativeElement.offsetWidth;
      const contactGroupHalfWidth = this.contactGroup.nativeElement.offsetWidth / 2 - poPageBlockedUserContactItemMargin;
      this.overflowItem = phoneWidth > contactGroupHalfWidth || mailWidth > contactGroupHalfWidth - poPageBlockedUserContactItemMargin;
    }
  }
  static \u0275fac = function PoPageBlockedUserContactsComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageBlockedUserContactsComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageBlockedUserContactsComponent,
    selectors: [["po-page-blocked-user-contacts"]],
    viewQuery: function PoPageBlockedUserContactsComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c4, 7);
        \u0275\u0275viewQuery(_c5, 7);
        \u0275\u0275viewQuery(_c6, 7);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.contactGroup = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.mailItem = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.phoneItem = _t.first);
      }
    },
    inputs: {
      email: [0, "p-email", "email"],
      phone: [0, "p-phone", "phone"]
    },
    standalone: false,
    decls: 16,
    vars: 16,
    consts: [["contactGroup", ""], ["phoneItem", ""], ["mailItem", ""], [1, "po-page-blocked-user-contact-group", "po-row", "po-mb-3"], [1, "po-page-blocked-user-contact-item", 3, "ngClass"], ["target", "_self", 1, "po-page-blocked-user-link", "po-clickable", 3, "href"], [1, "po-page-blocked-user-contact-group-item"], ["p-icon", "ICON_TELEPHONE", 1, "po-page-blocked-user-contact-icon", "po-pr-1"], [1, "po-page-blocked-user-contact-text", "po-font-text"], [1, "po-page-blocked-user-contact-item", "po-page-blocked-user-contact-mail", 3, "ngClass"], ["p-icon", "ICON_MAIL", 1, "po-page-blocked-user-contact-icon", "po-pr-1"]],
    template: function PoPageBlockedUserContactsComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 3, 0)(2, "div", 4)(3, "a", 5)(4, "div", 6);
        \u0275\u0275element(5, "po-icon", 7);
        \u0275\u0275elementStart(6, "div", 8, 1);
        \u0275\u0275text(8);
        \u0275\u0275elementEnd()()()();
        \u0275\u0275elementStart(9, "div", 9)(10, "a", 5)(11, "div", 6);
        \u0275\u0275element(12, "po-icon", 10);
        \u0275\u0275elementStart(13, "div", 8, 2);
        \u0275\u0275text(15);
        \u0275\u0275elementEnd()()()()();
      }
      if (rf & 2) {
        \u0275\u0275advance(2);
        \u0275\u0275classProp("po-invisible", !ctx.phone);
        \u0275\u0275property("ngClass", ctx.overflowItem ? "po-md-12" : "po-md-6");
        \u0275\u0275advance();
        \u0275\u0275classProp("po-page-blocked-user-contact-content-inline", ctx.overflowItem);
        \u0275\u0275propertyInterpolate1("href", "tel:", ctx.phone, "", \u0275\u0275sanitizeUrl);
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate(ctx.phone);
        \u0275\u0275advance();
        \u0275\u0275classProp("po-invisible", !ctx.email);
        \u0275\u0275property("ngClass", ctx.overflowItem ? "po-md-12" : "po-md-6");
        \u0275\u0275advance();
        \u0275\u0275classProp("po-page-blocked-user-contact-content-inline", ctx.overflowItem);
        \u0275\u0275propertyInterpolate1("href", "mailto:", ctx.email, "", \u0275\u0275sanitizeUrl);
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate(ctx.email);
      }
    },
    dependencies: [NgClass, PoIconComponent],
    encapsulation: 2,
    changeDetection: 0
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageBlockedUserContactsComponent, [{
    type: Component,
    args: [{
      selector: "po-page-blocked-user-contacts",
      changeDetection: ChangeDetectionStrategy.OnPush,
      standalone: false,
      template: `<div #contactGroup class="po-page-blocked-user-contact-group po-row po-mb-3">
  <div
    class="po-page-blocked-user-contact-item"
    [class.po-invisible]="!phone"
    [ngClass]="overflowItem ? 'po-md-12' : 'po-md-6'"
  >
    <a
      class="po-page-blocked-user-link po-clickable"
      [class.po-page-blocked-user-contact-content-inline]="overflowItem"
      href="tel:{{ phone }}"
      target="_self"
    >
      <div class="po-page-blocked-user-contact-group-item">
        <po-icon class="po-page-blocked-user-contact-icon po-pr-1" p-icon="ICON_TELEPHONE"></po-icon>
        <div #phoneItem class="po-page-blocked-user-contact-text po-font-text">{{ phone }}</div>
      </div>
    </a>
  </div>
  <div
    class="po-page-blocked-user-contact-item po-page-blocked-user-contact-mail"
    [class.po-invisible]="!email"
    [ngClass]="overflowItem ? 'po-md-12' : 'po-md-6'"
  >
    <a
      class="po-page-blocked-user-link po-clickable"
      [class.po-page-blocked-user-contact-content-inline]="overflowItem"
      href="mailto:{{ email }}"
      target="_self"
    >
      <div class="po-page-blocked-user-contact-group-item">
        <po-icon class="po-page-blocked-user-contact-icon po-pr-1" p-icon="ICON_MAIL"></po-icon>
        <div #mailItem class="po-page-blocked-user-contact-text po-font-text">{{ email }}</div>
      </div>
    </a>
  </div>
</div>
`
    }]
  }], null, {
    contactGroup: [{
      type: ViewChild,
      args: ["contactGroup", {
        static: true
      }]
    }],
    mailItem: [{
      type: ViewChild,
      args: ["mailItem", {
        static: true
      }]
    }],
    phoneItem: [{
      type: ViewChild,
      args: ["phoneItem", {
        static: true
      }]
    }],
    email: [{
      type: Input,
      args: ["p-email"]
    }],
    phone: [{
      type: Input,
      args: ["p-phone"]
    }]
  });
})();
var poPageBlockedUserLiterals = {
  none: {
    pt: {
      title: "Opa!",
      firstPhrase: "Tivemos que bloquear essa tela temporariamente.",
      secondPhrase: "Mas n\xE3o se preocupe! Basta fazer seu login novamente."
    },
    en: {
      title: "Oops!",
      firstPhrase: "We had to temporarily block this screen.",
      secondPhrase: "But do not worry! Just sign in again."
    },
    es: {
      title: "Opa!",
      firstPhrase: "Tuvimos que bloquear esta pantalla temporalmente.",
      secondPhrase: "\xA1Pero no se preocupe! S\xF3lo tienes que iniciar sesi\xF3n de nuevo."
    },
    ru: {
      title: "\u041E\u0439!",
      firstPhrase: "\u041D\u0430\u043C \u043F\u0440\u0438\u0448\u043B\u043E\u0441\u044C \u0432\u0440\u0435\u043C\u0435\u043D\u043D\u043E \u0437\u0430\u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u044D\u0442\u043E\u0442 \u0440\u0430\u0437\u0434\u0435\u043B.",
      secondPhrase: "\u041D\u043E \u043D\u0435 \u0432\u043E\u043B\u043D\u0443\u0439\u0442\u0435\u0441\u044C! \u041F\u0440\u043E\u0441\u0442\u043E \u0432\u043E\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0438\u0441\u0442\u0435\u043C\u0443 \u0435\u0449\u0435 \u0440\u0430\u0437."
    }
  },
  exceededAttempts: {
    pt: {
      title: "Opa!",
      firstPhrase: `Para sua seguran\xE7a, ap\xF3s {0} tentativa(s) de senha seu usu\xE1rio fica bloqueado e n\xE3o pode ser acessado em {1} hora(s) :( `,
      secondPhrase: "Isso \xE9 para evitar que hackers invadam sua conta.",
      thirdPhrase: "Mas n\xE3o se preocupe! Se voc\xEA for o dono da conta e apenas esqueceu sua senha, basta entrar em contato com o suporte."
    },
    en: {
      title: "Oops!",
      firstPhrase: `For your security, after {0} attempt(s) of password
        your user gets blocked and can not be accessed in {1} hour(s) :(`,
      secondPhrase: "This is to prevent hackers from hacking into your account.",
      thirdPhrase: "But do not worry! If you are the owner of the account and just forgot your password, just contact support."
    },
    es: {
      title: "Opa!",
      firstPhrase: `Para su seguridad, despu\xE9s de {0} intento(s) de contrase\xF1a
        su usuario queda bloqueado y no puede ser accedido en {1} hora(s) :(`,
      secondPhrase: "Esto es para evitar que los hackers invadan su cuenta.",
      thirdPhrase: `\xA1Pero no se preocupe! Si usted es el due\xF1o de la cuenta
        y acaba de olvidar su contrase\xF1a, simplemente p\xF3ngase en contacto con el soporte.`
    },
    ru: {
      title: "\u041E\u0439!",
      firstPhrase: "\u0414\u043B\u044F \u0432\u0430\u0448\u0435\u0439 \u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u043E\u0441\u0442\u0438, \u043F\u043E\u0441\u043B\u0435 {0} \u043F\u043E\u043F\u044B\u0442\u043E\u043A \u0432\u0432\u043E\u0434\u0430 \u043F\u0430\u0440\u043E\u043B\u044F\r\n\u0432\u0430\u0448 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u0431\u043B\u043E\u043A\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u0438 \u043D\u0435 \u0441\u043C\u043E\u0436\u0435\u0442 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u0442\u044C\u0441\u044F \u0432 \u0442\u0435\u0447\u0435\u043D\u0438\u0435 {1} \u0447\u0430\u0441\u0430(\u043E\u0432) :(",
      secondPhrase: "\u042D\u0442\u043E \u0434\u0435\u043B\u0430\u0435\u0442\u0441\u044F \u0434\u043B\u044F \u0442\u043E\u0433\u043E, \u0447\u0442\u043E\u0431\u044B \u0445\u0430\u043A\u0435\u0440\u044B \u043D\u0435 \u043C\u043E\u0433\u043B\u0438 \u0432\u0437\u043B\u043E\u043C\u0430\u0442\u044C \u0432\u0430\u0448 \u0430\u043A\u043A\u0430\u0443\u043D\u0442.",
      thirdPhrase: "\u041D\u043E \u043D\u0435 \u0432\u043E\u043B\u043D\u0443\u0439\u0442\u0435\u0441\u044C! \u0415\u0441\u043B\u0438 \u0432\u044B \u044F\u0432\u043B\u044F\u0435\u0442\u0435\u0441\u044C \u0432\u043B\u0430\u0434\u0435\u043B\u044C\u0446\u0435\u043C \u0443\u0447\u0435\u0442\u043D\u043E\u0439 \u0437\u0430\u043F\u0438\u0441\u0438 \u0438 \u043F\u0440\u043E\u0441\u0442\u043E \u0437\u0430\u0431\u044B\u043B\u0438 \u0441\u0432\u043E\u0439 \u043F\u0430\u0440\u043E\u043B\u044C, \u043E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u0432 \u0441\u043B\u0443\u0436\u0431\u0443 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u0438."
    }
  },
  expiredPassword: {
    pt: {
      title: "Opa! Sua senha expirou",
      firstPhrase: `A cada {0} dia(s) \xE9 preciso criar uma nova senha por quest\xE3o de seguran\xE7a. Ap\xF3s esses {0} dia(s) seu acesso \xE9 bloqueado :(`,
      secondPhrase: "Mas n\xE3o se preocupe! Basta entrar em contato com o administrador do sistema."
    },
    en: {
      title: "Oops! Your Password has expired",
      firstPhrase: `Every {0} day(s) you need to create a new password for security reasons.
        After these {0} day(s) your access is blocked :(`,
      secondPhrase: "But do not worry! Just contact your system administrator."
    },
    es: {
      title: "Opa! Su contrase\xF1a ha caducado",
      firstPhrase: `Cada {0} d\xEDa(s) es necesario crear una nueva contrase\xF1a por razones de seguridad.
        Despu\xE9s de estos {0} d\xEDa(s) su acceso est\xE1 bloqueado :(`,
      secondPhrase: "\xA1Pero no se preocupe! S\xF3lo tienes que ponerse en contacto con el administrador del sistema."
    },
    ru: {
      title: "\u041E\u0439! \u0421\u0440\u043E\u043A \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F \u0432\u0430\u0448\u0435\u0433\u043E \u043F\u0430\u0440\u043E\u043B\u044F \u0438\u0441\u0442\u0435\u043A",
      firstPhrase: "\u041A\u0430\u0436\u0434\u044B\u0435 {0} \u0434\u043D\u0435\u0439 \u0432\u0430\u043C \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u0441\u043E\u0437\u0434\u0430\u0432\u0430\u0442\u044C \u043D\u043E\u0432\u044B\u0439 \u043F\u0430\u0440\u043E\u043B\u044C \u0432 \u0446\u0435\u043B\u044F\u0445 \u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u043E\u0441\u0442\u0438.\r\n\u041F\u043E\u0441\u043B\u0435 {0} \u0434\u043D\u0435\u0439 \u0432\u0430\u0448 \u0434\u043E\u0441\u0442\u0443\u043F \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u0430\u043D :(",
      secondPhrase: "\u041D\u043E \u043D\u0435 \u0432\u043E\u043B\u043D\u0443\u0439\u0442\u0435\u0441\u044C! \u041F\u0440\u043E\u0441\u0442\u043E \u043E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u043A \u0441\u0432\u043E\u0435\u043C\u0443 \u0441\u0438\u0441\u0442\u0435\u043C\u043D\u043E\u043C\u0443 \u0430\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\u0443."
    }
  }
};
var PoPageBlockedUserReasonComponent = class _PoPageBlockedUserReasonComponent {
  changeDetector = inject(ChangeDetectorRef);
  params;
  reason;
  literalParams;
  literals;
  language;
  constructor() {
    const languageService = inject(PoLanguageService);
    this.language = languageService.getShortLanguage();
  }
  ngOnChanges(changes) {
    if (changes.reason || changes.params) {
      this.getLiterals();
    }
  }
  ngOnInit() {
    this.getLiterals();
  }
  getImageByReasonType() {
    let reasonImage;
    switch (this.reason) {
      case "none": {
        reasonImage = "big-lock";
        break;
      }
      case "exceededAttempts": {
        reasonImage = "blocked-user";
        break;
      }
      case "expiredPassword": {
        reasonImage = "expired";
        break;
      }
    }
    return `./assets/images/${reasonImage}.svg`;
  }
  getParams() {
    this.literalParams = this.reason === "expiredPassword" ? [this.params.days, this.params.days] : [this.params.attempts, this.params.hours];
  }
  getLiterals() {
    this.getParams();
    this.literals = __spreadValues(__spreadValues({}, poPageBlockedUserLiterals[this.reason][poLocaleDefault]), poPageBlockedUserLiterals[this.reason][this.language]);
    this.changeDetector.detectChanges();
  }
  static \u0275fac = function PoPageBlockedUserReasonComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageBlockedUserReasonComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageBlockedUserReasonComponent,
    selectors: [["po-page-blocked-user-reason"]],
    inputs: {
      params: [0, "p-params", "params"],
      reason: [0, "p-reason", "reason"]
    },
    standalone: false,
    features: [\u0275\u0275NgOnChangesFeature],
    decls: 12,
    vars: 8,
    consts: [[1, "po-page-blocked-user-reason-content"], [1, "po-page-blocked-user-image", "po-mb-3", 3, "src"], [1, "po-page-blocked-user-header", "po-mb-md-3", "po-row"], [1, "po-md-12"], [1, "po-page-blocked-user-text", "po-font-text", "po-row"], [1, "po-mb-sm-2", "po-mb-md-3", "po-md-12", "po-page-blocked-user-text-bold"], [1, "po-mb-sm-2", "po-mb-md-3", "po-md-12"]],
    template: function PoPageBlockedUserReasonComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 0);
        \u0275\u0275element(1, "img", 1);
        \u0275\u0275elementStart(2, "div", 2)(3, "div", 3);
        \u0275\u0275text(4);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(5, "div", 4)(6, "div", 5);
        \u0275\u0275text(7);
        \u0275\u0275pipe(8, "poI18n");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(9, "div", 6);
        \u0275\u0275text(10);
        \u0275\u0275elementEnd();
        \u0275\u0275template(11, PoPageBlockedUserReasonComponent_Conditional_11_Template, 2, 1, "div", 6);
        \u0275\u0275elementEnd()();
      }
      if (rf & 2) {
        \u0275\u0275advance();
        \u0275\u0275property("src", ctx.getImageByReasonType(), \u0275\u0275sanitizeUrl);
        \u0275\u0275advance(3);
        \u0275\u0275textInterpolate(ctx.literals == null ? null : ctx.literals.title);
        \u0275\u0275advance(3);
        \u0275\u0275textInterpolate1(" ", \u0275\u0275pipeBind2(8, 5, ctx.literals == null ? null : ctx.literals.firstPhrase, ctx.literalParams), " ");
        \u0275\u0275advance(3);
        \u0275\u0275textInterpolate(ctx.literals == null ? null : ctx.literals.secondPhrase);
        \u0275\u0275advance();
        \u0275\u0275conditional((ctx.literals == null ? null : ctx.literals.thirdPhrase) ? 11 : -1);
      }
    },
    dependencies: [PoI18nPipe],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageBlockedUserReasonComponent, [{
    type: Component,
    args: [{
      selector: "po-page-blocked-user-reason",
      standalone: false,
      template: '<div class="po-page-blocked-user-reason-content">\n  <img class="po-page-blocked-user-image po-mb-3" [src]="getImageByReasonType()" />\n  <div class="po-page-blocked-user-header po-mb-md-3 po-row">\n    <div class="po-md-12">{{ literals?.title }}</div>\n  </div>\n  <div class="po-page-blocked-user-text po-font-text po-row">\n    <div class="po-mb-sm-2 po-mb-md-3 po-md-12 po-page-blocked-user-text-bold">\n      {{ literals?.firstPhrase | poI18n: literalParams }}\n    </div>\n    <div class="po-mb-sm-2 po-mb-md-3 po-md-12">{{ literals?.secondPhrase }}</div>\n    @if (literals?.thirdPhrase) {\n      <div class="po-mb-sm-2 po-mb-md-3 po-md-12">{{ literals?.thirdPhrase }}</div>\n    }\n  </div>\n</div>\n'
    }]
  }], () => [], {
    params: [{
      type: Input,
      args: ["p-params"]
    }],
    reason: [{
      type: Input,
      args: ["p-reason"]
    }]
  });
})();
var poPageBlockedUserButtonLiterals = {
  en: {
    primaryButton: "Back to home screen"
  },
  es: {
    primaryButton: "Volver al inicio"
  },
  pt: {
    primaryButton: "Voltar para o in\xEDcio"
  },
  ru: {
    primaryButton: "\u041F\u0435\u0440\u0435\u0439\u0442\u0438 \u043A \u043D\u0430\u0447\u0430\u043B\u0443 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u044B"
  }
};
var PoPageBlockedUserComponent = class _PoPageBlockedUserComponent extends PoPageBlockedUserBaseComponent {
  activatedRoute = inject(ActivatedRoute);
  router = inject(Router);
  literals;
  constructor() {
    const languageService = inject(PoLanguageService);
    super();
    const language = languageService.getShortLanguage();
    this.literals = __spreadValues(__spreadValues({}, poPageBlockedUserButtonLiterals[poLocaleDefault]), poPageBlockedUserButtonLiterals[language]);
  }
  ngOnInit() {
    this.checkingForRouteMetadata(this.activatedRoute.snapshot.data);
  }
  navigateTo(url) {
    isExternalLink(url) ? window.open(url) : this.router.navigate([url || "/"]);
  }
  checkingForMetadataProperty(object, property) {
    if (Object.prototype.hasOwnProperty.call(object, property)) {
      return object[property];
    }
  }
  checkingForRouteMetadata(data) {
    if (Object.keys(data).length !== 0) {
      this.contactEmail = this.checkingForMetadataProperty(data, "contactEmail") || this.contactEmail;
      this.contactPhone = this.checkingForMetadataProperty(data, "contactPhone") || this.contactPhone;
      this.reason = this.checkingForMetadataProperty(data, "reason") || this.reason;
      this.urlBack = this.checkingForMetadataProperty(data, "urlBack") || this.urlBack;
    }
  }
  static \u0275fac = function PoPageBlockedUserComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageBlockedUserComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageBlockedUserComponent,
    selectors: [["po-page-blocked-user"]],
    standalone: false,
    features: [\u0275\u0275InheritDefinitionFeature],
    decls: 8,
    vars: 10,
    consts: [[1, "po-page-blocked-user-wrapper"], [1, "po-page-background-wrap"], [3, "p-hide-logo", "p-logo", "p-secondary-logo", "p-components-size"], [3, "p-params", "p-reason"], [1, "po-page-blocked-user-mobile-bottom-alignment"], [3, "p-email", "p-phone"], [1, "po-row"], ["p-kind", "primary", 1, "po-lg-12", "po-sm-12", "po-page-blocked-user-button", 3, "p-click", "p-label", "p-size"]],
    template: function PoPageBlockedUserComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 0)(1, "div", 1)(2, "po-page-background", 2);
        \u0275\u0275element(3, "po-page-blocked-user-reason", 3);
        \u0275\u0275elementStart(4, "div", 4);
        \u0275\u0275element(5, "po-page-blocked-user-contacts", 5);
        \u0275\u0275elementStart(6, "div", 6)(7, "po-button", 7);
        \u0275\u0275listener("p-click", function PoPageBlockedUserComponent_Template_po_button_p_click_7_listener() {
          return ctx.navigateTo(ctx.urlBack);
        });
        \u0275\u0275elementEnd()()()()()();
      }
      if (rf & 2) {
        \u0275\u0275advance(2);
        \u0275\u0275property("p-hide-logo", true)("p-logo", ctx.logo)("p-secondary-logo", ctx.secondaryLogo)("p-components-size", ctx.componentsSize);
        \u0275\u0275advance();
        \u0275\u0275property("p-params", ctx.params)("p-reason", ctx.reason);
        \u0275\u0275advance(2);
        \u0275\u0275property("p-email", ctx.contactEmail)("p-phone", ctx.contactPhone);
        \u0275\u0275advance(2);
        \u0275\u0275property("p-label", ctx.literals == null ? null : ctx.literals.primaryButton)("p-size", ctx.componentsSize);
      }
    },
    dependencies: [PoButtonComponent, PoPageBackgroundComponent, PoPageBlockedUserContactsComponent, PoPageBlockedUserReasonComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageBlockedUserComponent, [{
    type: Component,
    args: [{
      selector: "po-page-blocked-user",
      standalone: false,
      template: '<div class="po-page-blocked-user-wrapper">\n  <div class="po-page-background-wrap">\n    <po-page-background\n      [p-hide-logo]="true"\n      [p-logo]="logo"\n      [p-secondary-logo]="secondaryLogo"\n      [p-components-size]="componentsSize"\n    >\n      <po-page-blocked-user-reason [p-params]="params" [p-reason]="reason"> </po-page-blocked-user-reason>\n\n      <div class="po-page-blocked-user-mobile-bottom-alignment">\n        <po-page-blocked-user-contacts [p-email]="contactEmail" [p-phone]="contactPhone">\n        </po-page-blocked-user-contacts>\n\n        <div class="po-row">\n          <po-button\n            class="po-lg-12 po-sm-12 po-page-blocked-user-button"\n            p-kind="primary"\n            [p-label]="literals?.primaryButton"\n            [p-size]="componentsSize"\n            (p-click)="navigateTo(urlBack)"\n          >\n          </po-button>\n        </div>\n      </div>\n    </po-page-background>\n  </div>\n</div>\n'
    }]
  }], () => [], null);
})();
var PoPageBlockedUserModule = class _PoPageBlockedUserModule {
  static \u0275fac = function PoPageBlockedUserModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageBlockedUserModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoPageBlockedUserModule,
    declarations: [PoPageBlockedUserComponent, PoPageBlockedUserContactsComponent, PoPageBlockedUserReasonComponent],
    imports: [CommonModule, RouterModule, PoModule, PoPageBackgroundModule],
    exports: [PoPageBlockedUserComponent, PoPageBlockedUserContactsComponent, PoPageBlockedUserReasonComponent]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    imports: [CommonModule, RouterModule, PoModule, PoPageBackgroundModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageBlockedUserModule, [{
    type: NgModule,
    args: [{
      imports: [CommonModule, RouterModule, PoModule, PoPageBackgroundModule],
      declarations: [PoPageBlockedUserComponent, PoPageBlockedUserContactsComponent, PoPageBlockedUserReasonComponent],
      exports: [PoPageBlockedUserComponent, PoPageBlockedUserContactsComponent, PoPageBlockedUserReasonComponent]
    }]
  }], null, null);
})();
var poPageChangePasswordLiterals = {
  en: {
    backButton: "Back",
    confirmPassword: "Confirm password",
    createNewPassword: "Create new password",
    createNewPasswordPhrase: "Protect your account with a personal password created by you",
    currentPassword: "Current password",
    enterSystemButton: "Enter the system",
    forgotPassword: "Forgot your password?",
    newPassword: "New password",
    passwordSuccessfullyCreated: "Password successfully created!",
    passwordSuccessfullyUpdated: "Password successfully updated!",
    requirements: "Password requirements",
    safetyTips: "Safety tips!",
    safetyTipsFirst: "is used in other accounts;",
    safetyTipsPhrase: "Avoid a password that:",
    safetyTipsSecond: "has personal information like your name, nickname or family names;",
    safetyTipsThird: 'that uses obvious sequences like "123" or obvious words like "password";',
    saveButton: "Save"
  },
  es: {
    backButton: "Volver",
    confirmPassword: "Confirmar se\xF1a",
    createNewPassword: "Crear nueva contrase\xF1a",
    createNewPasswordPhrase: "Proteger su cuenta con una contrase\xF1a personal creada por usted",
    currentPassword: "Contrase\xF1a actual",
    enterSystemButton: "Entrar en el sistema",
    forgotPassword: "\xBFOlvidaste tu contrase\xF1a?",
    newPassword: "Nueva contrase\xF1a",
    passwordSuccessfullyCreated: "Contrase\xF1a creada correctamente!",
    passwordSuccessfullyUpdated: "Contrase\xF1a correctamente actualizada!",
    requirements: "Requisitos de contrase\xF1a",
    safetyTips: "Consejos de seguridad!",
    safetyTipsFirst: "se utilice en otras cuentas;",
    safetyTipsPhrase: "Evite una contrase\xF1a que:",
    safetyTipsSecond: "utiliza informaci\xF3n personal como su nombre, apellido o nombre de familia;",
    safetyTipsThird: 'utilice secuencias muy obvias como "1234" o "abcd" o palabras obvias como "contrase\xF1a";',
    saveButton: "Guardar"
  },
  pt: {
    backButton: "Voltar",
    confirmPassword: "Confirmar senha",
    createNewPassword: "Criar nova senha",
    createNewPasswordPhrase: "Proteja sua conta com uma senha pessoal criada por voc\xEA",
    currentPassword: "Senha atual",
    enterSystemButton: "Entrar no sistema",
    forgotPassword: "Esqueceu sua senha?",
    newPassword: "Nova senha",
    passwordSuccessfullyCreated: "Senha criada com sucesso!",
    passwordSuccessfullyUpdated: "Senha alterada com sucesso!",
    requirements: "Requisitos de senha",
    safetyTips: "Dicas de seguran\xE7a!",
    safetyTipsFirst: "seja usada em outras contas;",
    safetyTipsPhrase: "Evite uma senha que:",
    safetyTipsSecond: "usa informa\xE7\xF5es pessoais como seu nome, apelido ou nome de familiares;",
    safetyTipsThird: 'use sequ\xEAncias muito \xF3bvias como "1234" ou "abcd" ou palavras \xF3bvias como \u201Csenha\u201D;',
    saveButton: "Salvar"
  },
  ru: {
    backButton: "\u0432\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0438\u0435",
    confirmPassword: "\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u043F\u0430\u0440\u043E\u043B\u044C",
    createNewPassword: "\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043D\u043E\u0432\u044B\u0439 \u043F\u0430\u0440\u043E\u043B\u044C",
    createNewPasswordPhrase: "\u0417\u0430\u0449\u0438\u0442\u0438\u0442\u0435 \u0441\u0432\u043E\u0439 \u0430\u043A\u043A\u0430\u0443\u043D\u0442 \u0441 \u043F\u043E\u043C\u043E\u0449\u044C\u044E \u043B\u0438\u0447\u043D\u043E\u0433\u043E \u043F\u0430\u0440\u043E\u043B\u044F.",
    currentPassword: "\u0422\u0435\u043A\u0443\u0449\u0438\u0439 \u043F\u0430\u0440\u043E\u043B\u044C",
    enterSystemButton: "\u0412\u0445\u043E\u0434 \u0432 \u0441\u0438\u0441\u0442\u0435\u043C\u0443",
    forgotPassword: "\u0417\u0430\u0431\u044B\u043B\u0438 \u043F\u0430\u0440\u043E\u043B\u044C?",
    newPassword: "\u041D\u043E\u0432\u044B\u0439 \u043F\u0430\u0440\u043E\u043B\u044C",
    passwordSuccessfullyCreated: "\u041F\u0430\u0440\u043E\u043B\u044C \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u043D!",
    passwordSuccessfullyUpdated: "\u041F\u0430\u0440\u043E\u043B\u044C \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0438\u0437\u043C\u0435\u043D\u0435\u043D!",
    requirements: "\u0422\u0440\u0435\u0431\u043E\u0432\u0430\u043D\u0438\u044F \u043A \u043F\u0430\u0440\u043E\u043B\u044E",
    safetyTips: "\u0421\u043E\u0432\u0435\u0442\u044B \u043F\u043E \u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u043E\u0441\u0442\u0438!",
    safetyTipsFirst: "\u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u044C\u0441\u044F \u043D\u0430 \u0434\u0440\u0443\u0433\u0438\u0445 \u0441\u0447\u0435\u0442\u0430\u0445;",
    safetyTipsPhrase: "\u0418\u0437\u0431\u0435\u0433\u0430\u0439\u0442\u0435 \u043F\u0430\u0440\u043E\u043B\u044F, \u043A\u043E\u0442\u043E\u0440\u044B\u0439:",
    safetyTipsSecond: "\u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u0442 \u043B\u0438\u0447\u043D\u0443\u044E \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044E, \u0442\u0430\u043A\u0443\u044E \u200B\u200B\u043A\u0430\u043A \u0432\u0430\u0448\u0435 \u0438\u043C\u044F, \u0444\u0430\u043C\u0438\u043B\u0438\u044E \u0438\u043B\u0438 \u0444\u0430\u043C\u0438\u043B\u0438\u044E;",
    safetyTipsThird: '\u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435 \u043E\u0447\u0435\u043D\u044C \u043E\u0447\u0435\u0432\u0438\u0434\u043D\u044B\u0435 \u0441\u0442\u0440\u043E\u043A\u0438, \u0442\u0430\u043A\u0438\u0435 \u043A\u0430\u043A "1234" \u0438\u043B\u0438 "abcd", \u0438\u043B\u0438 \u0442\u0430\u043A\u0438\u0435 \u043E\u0447\u0435\u0432\u0438\u0434\u043D\u044B\u0435 \u0441\u043B\u043E\u0432\u0430, \u043A\u0430\u043A "\u043F\u0430\u0440\u043E\u043B\u044C";',
    saveButton: "\u044D\u043A\u043E\u043D\u043E\u043C\u0438\u0442\u044C"
  }
};
var PoPageChangePasswordBaseComponent = class _PoPageChangePasswordBaseComponent {
  /**
   * @optional
   *
   * @description
   *
   * Caminho para a logomarca localizada na parte superior.
   *
   * > Caso seja indefinida o espaço se mantém preservado porém vazio.
   */
  logo;
  /**
   * @optional
   *
   * @description
   *
   * Caminho para a logomarca localizada no rodapé.
   */
  secondaryLogo;
  /**
   * Token para solicitação de troca/recuperação de senha.
   *
   * > Esta propriedade será ignorada caso exista um token como parâmetro na URL inicial do template.
   */
  token;
  /**
   * @optional
   *
   * @description
   *
   * URL para a ação de retorno da página.
   *
   * > O botão `Voltar` aparece apenas para telas de alteração de senha, ou seja, só aparece se a propriedade `p-hide-current-password` for
   * falsa.
   *
   * @default `/`
   */
  urlBack = "/";
  /**
   * Endpoint usado pelo template para realizar um POST. Quando preenchido, o método `p-submit` será ignorado e o componente adquirirá
   * automatização para o processo de cadastro/troca de senha.
   *
   * ### Processo
   * Ao digitar um valor válido nos campos de senha e pressionar **salvar**,
   * o componente fará uma requisição `POST` na url especificada nesta propriedade passando o objeto contendo os valores definidos pelo
   * usuário.
   *
   * ```
   * body {
   *  token?: token,
   *  oldPassword?: oldPassword,
   *  newPassword: newPassword
   * }
   * ```
   *
   * O código de resposta HTTP de status esperado é `204`.
   *
   * Em caso de **sucesso**, será exibida a modal de confirmação de senha alterada.
   *
   * > O token será informado pela propriedade `p-token`do componente ou por um *query parameter* na URL do template.
   *
   * *Processo finalizado.*
   *
   * _______________
   *
   * #### Praticidade
   * As informações do serviço de autenticação também podem ser transmitidas diretamente pelas configuraçãos de rota e, desta maneira,
   * dispensa-se qualquer menção e/ou importação do componente `po-page-change-password` no restante da aplicação. O exemplo abaixo
   * exemplifica a forma dinâmica com a qual o template de tela de troca de senha pode ser gerado ao navegar para rota `/change-password`, e
   * também como ele se comunica com o serviço para efetuação do processo de troca de senha do usuário e solicitação de nova senha.
   * Basta definir nas configurações de rota:
   *
   *
   * ```
   *   import { PoModalPasswordRecoveryType, PoPageChangePasswordComponent } from '@po-ui/ng-templates';
   *
   *   ...
   *   const routes: Routes = [
   *     {
   *       path: 'change-password', component: PoPageChangePasswordComponent, data: {
   *         serviceApi: 'https://po-ui.io/sample/api/new-password',
   *         recovery: {
   *           url: 'https://po-ui.io/sample/api/users',
   *           type: PoModalPasswordRecoveryType.All,
   *           contactMail: 'dev.po@po-ui.com',
   *           phoneMask: '9-999-999-9999'
   *         }
   *       }
   *     }
   *     ...
   *   ];
   *
   *   @NgModule({
   *     imports: [RouterModule.forRoot(routes)],
   *     exports: [RouterModule]
   *   })
   *   export class AppRoutingModule { }
   * ```
   *
   *
   * O metadado `serviceApi` deve ser a **url** para requisição dos recursos de troca de senha. E `recovery` é a interface
   * `PoPageChangePasswordRecovery` responsável pelas especificações contidas na modal de recuperação de senha.
   *
   * > É essencial que siga a nomenclatura dos atributos exemplificados acima para sua efetiva funcionalidade.
   *
   */
  urlNewPassword;
  /**
   * @optional
   *
   * @description
   *
   * Função executada ao submeter o form pelo botão salvar.
   *
   * Caso definida essa função, a modal de confirmação não aparece, mas pode ser chamada pelo
   * método `openConfirmation`. Exemplo:
   *
   * ```
   * @ViewChild(PoPageChangePasswordComponent) changePassword: PoPageChangePasswordComponent;
   *
   * onSubmit() {
   *  this.changePassword.openConfirmation();
   * }
   *
   * ```
   * > Esta propriedade será ignorada se for definido valor para a propriedade `p-url-new-password`.
   */
  submit = new EventEmitter();
  confirmPassword;
  currentPassword;
  modalAction;
  newPassword;
  recoveryUrlType;
  showRequirements;
  validatorChange;
  _componentsSize = void 0;
  _hideCurrentPassword = false;
  _recovery;
  _requirements = [];
  _urlHome = "/";
  /**
   * @optional
   *
   * @description
   *
   * Define o tamanho dos componentes de formulário no template:
   * - `small`: aplica a medida small de cada componente (disponível apenas para acessibilidade AA).
   * - `medium`: aplica a medida medium de cada componente.
   *
   * > Caso a acessibilidade AA não esteja configurada, o tamanho `medium` será mantido.
   * Para mais detalhes, consulte a documentação do [po-theme](https://po-ui.io/documentation/po-theme).
   *
   * @default `medium`
   */
  set componentsSize(value) {
    this._componentsSize = validateSizeFn(value);
  }
  get componentsSize() {
    return this._componentsSize ?? getDefaultSizeFn();
  }
  /**
   * @optional
   *
   * @description
   *
   * Esconde o campo `Senha atual` para que o template seja para criação de senha.
   *
   * @default `false`
   */
  set hideCurrentPassword(value) {
    this._hideCurrentPassword = convertToBoolean(value);
  }
  get hideCurrentPassword() {
    return this._hideCurrentPassword;
  }
  /**
   * @optional
   *
   * @description
   *
   * URL para a ação do link `Esqueceu a senha`.
   *
   * A propriedade aceita os seguintes tipos:
   *
   * - **String**: informe uma url externa ou uma rota válida;
   * - **Function**: pode-se customizar a ação. Para esta possilidade basta atribuir:
   *   ```
   *   <po-page-change-password>
   *     [recovery]="this.myFunc.bind(this)";
   *   </po-page-change-password>
   *   ```
   *
   * - **PoPageChangePasswordRecovery**: cria-se vínculo automático com o template **po-modal-password-recovery**.
   *   O objeto deve conter a **url** para requisição dos recursos e pode-se definir o **tipo** de modal para recuperação de senha,
   *   **email** para contato e **máscara** do campo de telefone.
   *
   * > Caso não tenha valor o link `Esqueceu a senha` desaparece.
   */
  set recovery(value) {
    this._recovery = value;
    if (isTypeof(value, "string")) {
      this.recoveryUrlType = isExternalLink(value) ? "externalLink" : "internalLink";
    }
  }
  get recovery() {
    return this._recovery;
  }
  /**
   * @optional
   *
   * @description
   *
   * Lista de regras para criação e alteração de senha.
   */
  set requirements(value) {
    this._requirements = value || [];
    this.showRequirements = this._requirements.length > 0;
  }
  get requirements() {
    return this._requirements;
  }
  /**
   * @optional
   *
   * @description
   *
   * URL para a ação do botão `Entrar no sistema` da modal de confirmação que aparece após salvar a senha ou se chamada pelo método
   * `openConfirmation`.
   *
   * @default `/`
   */
  set urlHome(value) {
    this._urlHome = value;
    this.modalAction.action = this.navigateTo.bind(this, this.urlHome);
  }
  get urlHome() {
    return this._urlHome;
  }
  /**
   * @optional
   *
   * @description
   *
   * Define a propriedade nativa `autocomplete` do campo como `off`.
   *
   * > No input de senha(`po-password`) será definido como `new-password`.
   *
   * @default `true`
   */
  noAutocompletePassword = true;
  static \u0275fac = function PoPageChangePasswordBaseComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageChangePasswordBaseComponent)();
  };
  static \u0275dir = /* @__PURE__ */ \u0275\u0275defineDirective({
    type: _PoPageChangePasswordBaseComponent,
    inputs: {
      logo: [0, "p-logo", "logo"],
      secondaryLogo: [0, "p-secondary-logo", "secondaryLogo"],
      token: [0, "p-token", "token"],
      urlBack: [0, "p-url-back", "urlBack"],
      urlNewPassword: [0, "p-url-new-password", "urlNewPassword"],
      componentsSize: [0, "p-components-size", "componentsSize"],
      hideCurrentPassword: [0, "p-hide-current-password", "hideCurrentPassword"],
      recovery: [0, "p-recovery", "recovery"],
      requirements: [0, "p-requirements", "requirements"],
      urlHome: [0, "p-url-home", "urlHome"],
      noAutocompletePassword: [0, "p-no-autocomplete-password", "noAutocompletePassword"]
    },
    outputs: {
      submit: "p-submit"
    }
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageChangePasswordBaseComponent, [{
    type: Directive
  }], null, {
    logo: [{
      type: Input,
      args: ["p-logo"]
    }],
    secondaryLogo: [{
      type: Input,
      args: ["p-secondary-logo"]
    }],
    token: [{
      type: Input,
      args: ["p-token"]
    }],
    urlBack: [{
      type: Input,
      args: ["p-url-back"]
    }],
    urlNewPassword: [{
      type: Input,
      args: ["p-url-new-password"]
    }],
    submit: [{
      type: Output,
      args: ["p-submit"]
    }],
    componentsSize: [{
      type: Input,
      args: ["p-components-size"]
    }],
    hideCurrentPassword: [{
      type: Input,
      args: ["p-hide-current-password"]
    }],
    recovery: [{
      type: Input,
      args: ["p-recovery"]
    }],
    requirements: [{
      type: Input,
      args: ["p-requirements"]
    }],
    urlHome: [{
      type: Input,
      args: ["p-url-home"]
    }],
    noAutocompletePassword: [{
      type: Input,
      args: ["p-no-autocomplete-password"]
    }]
  });
})();
var PoPageChangePasswordService = class _PoPageChangePasswordService {
  http = inject(HttpClient);
  post(url, item) {
    return this.http.post(url, item, {
      observe: "response"
    });
  }
  static \u0275fac = function PoPageChangePasswordService_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageChangePasswordService)();
  };
  static \u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
    token: _PoPageChangePasswordService,
    factory: _PoPageChangePasswordService.\u0275fac,
    providedIn: "root"
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageChangePasswordService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], null, null);
})();
var PoPageChangePasswordComponent = class _PoPageChangePasswordComponent extends PoPageChangePasswordBaseComponent {
  activatedRoute = inject(ActivatedRoute);
  route = inject(ActivatedRoute);
  router = inject(Router);
  service = inject(PoPageChangePasswordService);
  poComponentInjector = inject(PoComponentInjectorService);
  modal;
  pageChangePassword;
  passwordForm;
  literals = poPageChangePasswordLiterals[poLocaleDefault];
  modalAction = {
    action: this.navigateTo.bind(this, this.urlHome),
    label: this.literals.enterSystemButton
  };
  newPasswordSubscription;
  componentRef = null;
  constructor() {
    const languageService = inject(PoLanguageService);
    super();
    const language = languageService.getShortLanguage();
    this.literals = __spreadValues(__spreadValues({}, poPageChangePasswordLiterals[poLocaleDefault]), poPageChangePasswordLiterals[language]);
  }
  ngAfterViewInit() {
    if (this.urlNewPassword) {
      this.subscribeToTokenParameter();
    }
  }
  ngOnDestroy() {
    if (this.newPasswordSubscription) {
      this.newPasswordSubscription.unsubscribe();
    }
  }
  ngOnInit() {
    this.checkingForRouteMetadata(this.activatedRoute.snapshot.data);
  }
  navigateTo(url) {
    isExternalLink(url) ? window.open(url) : this.router.navigate([url || "/"]);
  }
  onForgotPasswordClick(recovery) {
    if (isTypeof(recovery, "function")) {
      recovery();
    } else {
      this.createModalPasswordRecoveryComponent(recovery);
    }
  }
  onLoginSubmit() {
    const form = this.getLoginForm();
    if (this.urlNewPassword) {
      this.postUrlNewPassword(form);
    } else if (this.submit && this.submit.observers.length) {
      this.emitSubmit(form);
    }
  }
  /**
   * Abre uma modal de confirmação com texto, imagem e botão que redireciona para o link definido na propriedade `p-url-home`
   */
  openConfirmation() {
    this.modal.open();
  }
  validatePassword() {
    const controls = this.passwordForm.form.controls;
    const controlConfirmPassword = controls["confirmPassword"];
    const controlNewPassword = controls["newPassword"];
    if (!this.newPassword) {
      this.setFormErrors({
        "required": true
      }, [controlNewPassword]);
    } else if (!this.confirmPassword) {
      this.setFormErrors({
        "required": true
      }, [controlConfirmPassword]);
    } else if (this.newPassword && this.confirmPassword && this.newPassword !== this.confirmPassword) {
      this.setFormErrors({
        "equalPassword": true
      }, [controlNewPassword, controlConfirmPassword]);
    } else {
      this.setFormErrors(null, [controlConfirmPassword, controlNewPassword]);
    }
    if (this.requirements.length && this.requirements.find((requirement) => this.validateRequirement(requirement) === false)) {
      this.setFormErrors({
        "requirement": true
      }, [controlNewPassword]);
    }
  }
  validateRequirement(requirement) {
    return typeof requirement.status === "function" ? requirement.status(this.newPassword) : requirement.status;
  }
  checkingForMetadataProperty(object, property) {
    if (Object.prototype.hasOwnProperty.call(object, property)) {
      return object[property];
    }
  }
  checkingForRouteMetadata(data) {
    if (Object.keys(data).length !== 0) {
      this.urlNewPassword = this.checkingForMetadataProperty(data, "serviceApi") || this.urlNewPassword;
      this.recovery = this.checkingForMetadataProperty(data, "recovery") || this.recovery;
      this.hideCurrentPassword = this.checkingForMetadataProperty(data, "hideCurrentPassword") || this.hideCurrentPassword;
    }
  }
  createModalPasswordRecoveryComponent(recovery) {
    if (this.componentRef) {
      this.poComponentInjector.destroyComponentInApplication(this.componentRef);
    }
    this.componentRef = this.poComponentInjector.createComponentInApplication(PoModalPasswordRecoveryComponent);
    this.componentRef.instance.recovery = recovery.url;
    this.componentRef.instance.contactEmail = recovery.contactMail;
    this.componentRef.instance.phoneMask = recovery.phoneMask;
    this.componentRef.instance.type = recovery.type || PoModalPasswordRecoveryType.Email;
    this.componentRef.changeDetectorRef.detectChanges();
    setTimeout(() => {
      this.componentRef.instance.open();
    });
  }
  emitSubmit(form) {
    this.submit.emit(form);
  }
  getLoginForm() {
    return {
      currentPassword: this.currentPassword,
      newPassword: this.newPassword
    };
  }
  postUrlNewPassword(form) {
    form["token"] = this.token;
    this.service.post(this.urlNewPassword, form).subscribe((response) => {
      if (response.status === 204) {
        this.openConfirmation();
      }
    });
  }
  setFormErrors(error, controls) {
    controls.forEach((control) => {
      control.setErrors(error);
    });
  }
  subscribeToTokenParameter() {
    this.route.queryParams.subscribe((params) => {
      const token = params["token"];
      if (token) {
        this.token = token;
      }
    });
  }
  static \u0275fac = function PoPageChangePasswordComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageChangePasswordComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageChangePasswordComponent,
    selectors: [["po-page-change-password"]],
    viewQuery: function PoPageChangePasswordComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(PoModalComponent, 7);
        \u0275\u0275viewQuery(_c7, 7, ViewContainerRef);
        \u0275\u0275viewQuery(_c8, 7, NgForm);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.modal = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.pageChangePassword = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.passwordForm = _t.first);
      }
    },
    standalone: false,
    features: [\u0275\u0275InheritDefinitionFeature],
    decls: 43,
    vars: 32,
    consts: [["pageChangePassword", ""], ["passwordForm", "ngForm"], [1, "po-page-change-password-wrapper"], [1, "po-page-change-password-container"], [1, "po-page-change-password", 3, "p-components-size", "p-logo", "p-secondary-logo"], [1, "po-page-blocked-user-header", "po-row"], [1, "po-md-12"], [1, "po-md-12", "po-text-center", "po-font-text"], [1, "po-row", "po-mt-3", "po-mt-sm-1"], [1, "po-md-6", 3, "ngClass"], [1, "po-text-center", "po-mb-sm-1", "po-mb-2"], ["name", "newPassword", "p-required", "", 3, "ngModelChange", "p-change-model", "ngModel", "p-label", "p-no-autocomplete", "p-size"], ["name", "confirmPassword", "p-required", "", 3, "ngModelChange", "p-change-model", "ngModel", "p-label", "p-no-autocomplete", "p-size"], [1, "po-md-6", "po-page-change-password-required-container"], [1, "po-sm-12"], [1, "po-page-change-password-tips", "po-row"], [1, "po-md-2", "po-mr-3"], ["alt", "Blocked user image", "src", "./assets/images/big-lock.svg", 1, "po-page-change-password-lock-image", "po-mb-3"], [1, "po-md-9", "po-page-change-password-tips-text"], [1, "po-font-text-bold", "po-pb-1"], [1, "po-font-text-small"], [1, "po-row", "po-pb-1"], [1, "po-page-change-password-buttons", "po-row"], [1, "po-sm-12", "po-mobile-only"], [1, "po-sm-6", "po-mb-sm-1", 3, "p-label", "p-size"], ["p-kind", "primary", 3, "p-click", "ngClass", "p-disabled", "p-label", "p-size"], ["p-hide-close", "", "p-size", "auto", 3, "p-primary-action", "p-components-size", "p-title"], [1, "po-text-center"], ["alt", "Blocked user image", "src", "./assets/images/success.svg", 1, "po-page-change-password-lock-image", "po-mb-3"], ["name", "currentPassword", "p-required", "", 3, "ngModelChange", "ngModel", "p-label", "p-no-autocomplete", "p-size"], [1, "po-font-text-bold", "po-page-change-password-forgot-password", 3, "routerLink"], [1, "po-font-text-bold", "po-page-change-password-forgot-password", 3, "href"], [1, "po-font-text-bold", "po-page-change-password-forgot-password", "po-clickable"], [1, "po-font-text-bold", "po-page-change-password-forgot-password", "po-clickable", 3, "click"], [1, "po-page-change-password-required-list"], [1, "po-page-change-password-required-item"], [1, "po-mb-1", "po-font-text-bold", "po-page-change-password-required-title"], [1, "po-icon", "po-page-change-password-required-icon", 3, "p-icon"], [1, "po-page-change-password-required-text", "po-font-text"], [1, "po-sm-6", "po-mb-sm-1", 3, "p-click", "p-label", "p-size"]],
    template: function PoPageChangePasswordComponent_Template(rf, ctx) {
      if (rf & 1) {
        const _r1 = \u0275\u0275getCurrentView();
        \u0275\u0275elementStart(0, "div", 2, 0)(2, "div", 3)(3, "po-page-background", 4)(4, "div", 5)(5, "div", 6);
        \u0275\u0275text(6);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(7, "div", 7);
        \u0275\u0275text(8);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(9, "form", null, 1)(11, "div", 8)(12, "div", 9);
        \u0275\u0275template(13, PoPageChangePasswordComponent_Conditional_13_Template, 2, 4, "div")(14, PoPageChangePasswordComponent_Conditional_14_Template, 4, 3, "div", 10);
        \u0275\u0275elementStart(15, "div")(16, "po-password", 11);
        \u0275\u0275twoWayListener("ngModelChange", function PoPageChangePasswordComponent_Template_po_password_ngModelChange_16_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.newPassword, $event) || (ctx.newPassword = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275listener("p-change-model", function PoPageChangePasswordComponent_Template_po_password_p_change_model_16_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.validatePassword());
        });
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(17, "div")(18, "po-password", 12);
        \u0275\u0275twoWayListener("ngModelChange", function PoPageChangePasswordComponent_Template_po_password_ngModelChange_18_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.confirmPassword, $event) || (ctx.confirmPassword = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275listener("p-change-model", function PoPageChangePasswordComponent_Template_po_password_p_change_model_18_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.validatePassword());
        });
        \u0275\u0275elementEnd()()();
        \u0275\u0275template(19, PoPageChangePasswordComponent_Conditional_19_Template, 8, 1, "div", 13);
        \u0275\u0275elementEnd()();
        \u0275\u0275element(20, "po-divider", 14);
        \u0275\u0275elementStart(21, "div", 15)(22, "div", 16);
        \u0275\u0275element(23, "img", 17);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(24, "div", 18)(25, "div", 19);
        \u0275\u0275text(26);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(27, "div", 20)(28, "div", 21);
        \u0275\u0275text(29);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(30, "div", 21);
        \u0275\u0275text(31);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(32, "div", 21);
        \u0275\u0275text(33);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(34, "div", 21);
        \u0275\u0275text(35);
        \u0275\u0275elementEnd()()()();
        \u0275\u0275elementStart(36, "div", 22);
        \u0275\u0275element(37, "po-divider", 23);
        \u0275\u0275template(38, PoPageChangePasswordComponent_Conditional_38_Template, 1, 2, "po-button", 24);
        \u0275\u0275elementStart(39, "po-button", 25);
        \u0275\u0275listener("p-click", function PoPageChangePasswordComponent_Template_po_button_p_click_39_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.onLoginSubmit());
        });
        \u0275\u0275elementEnd()()()()();
        \u0275\u0275elementStart(40, "po-modal", 26)(41, "div", 27);
        \u0275\u0275element(42, "img", 28);
        \u0275\u0275elementEnd()();
      }
      if (rf & 2) {
        const passwordForm_r7 = \u0275\u0275reference(10);
        \u0275\u0275advance(3);
        \u0275\u0275property("p-components-size", ctx.componentsSize)("p-logo", ctx.logo)("p-secondary-logo", ctx.secondaryLogo);
        \u0275\u0275advance(3);
        \u0275\u0275textInterpolate(ctx.literals.createNewPassword);
        \u0275\u0275advance(2);
        \u0275\u0275textInterpolate1(" ", ctx.literals.createNewPasswordPhrase, " ");
        \u0275\u0275advance(4);
        \u0275\u0275property("ngClass", \u0275\u0275pureFunction1(30, _c9, !ctx.showRequirements));
        \u0275\u0275advance();
        \u0275\u0275conditional(!ctx.hideCurrentPassword ? 13 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(!ctx.hideCurrentPassword && ctx.recovery ? 14 : -1);
        \u0275\u0275advance(2);
        \u0275\u0275twoWayProperty("ngModel", ctx.newPassword);
        \u0275\u0275property("p-label", ctx.literals.newPassword)("p-no-autocomplete", ctx.noAutocompletePassword)("p-size", ctx.componentsSize);
        \u0275\u0275advance(2);
        \u0275\u0275twoWayProperty("ngModel", ctx.confirmPassword);
        \u0275\u0275property("p-label", ctx.literals.confirmPassword)("p-no-autocomplete", ctx.noAutocompletePassword)("p-size", ctx.componentsSize);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.showRequirements ? 19 : -1);
        \u0275\u0275advance(7);
        \u0275\u0275textInterpolate(ctx.literals.safetyTips);
        \u0275\u0275advance(3);
        \u0275\u0275textInterpolate(ctx.literals.safetyTipsPhrase);
        \u0275\u0275advance(2);
        \u0275\u0275textInterpolate1("\u2022 ", ctx.literals.safetyTipsFirst, "");
        \u0275\u0275advance(2);
        \u0275\u0275textInterpolate1("\u2022 ", ctx.literals.safetyTipsSecond, "");
        \u0275\u0275advance(2);
        \u0275\u0275textInterpolate1("\u2022 ", ctx.literals.safetyTipsThird, "");
        \u0275\u0275advance(3);
        \u0275\u0275conditional(!ctx.hideCurrentPassword ? 38 : -1);
        \u0275\u0275advance();
        \u0275\u0275property("ngClass", ctx.hideCurrentPassword ? "po-md-12" : "po-sm-6")("p-disabled", passwordForm_r7.invalid)("p-label", ctx.literals.saveButton)("p-size", ctx.componentsSize);
        \u0275\u0275advance();
        \u0275\u0275property("p-primary-action", ctx.modalAction)("p-components-size", ctx.componentsSize)("p-title", ctx.hideCurrentPassword ? ctx.literals.passwordSuccessfullyCreated : ctx.literals.passwordSuccessfullyUpdated);
      }
    },
    dependencies: [NgClass, \u0275NgNoValidate, NgControlStatus, NgControlStatusGroup, NgModel, NgForm, RouterLink, PoButtonComponent, PoContainerComponent, PoDividerComponent, PoPasswordComponent, PoIconComponent, PoModalComponent, PoPageBackgroundComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageChangePasswordComponent, [{
    type: Component,
    args: [{
      selector: "po-page-change-password",
      standalone: false,
      template: `<div class="po-page-change-password-wrapper" #pageChangePassword>
  <div class="po-page-change-password-container">
    <po-page-background
      class="po-page-change-password"
      [p-components-size]="componentsSize"
      [p-logo]="logo"
      [p-secondary-logo]="secondaryLogo"
    >
      <div class="po-page-blocked-user-header po-row">
        <div class="po-md-12">{{ literals.createNewPassword }}</div>
        <div class="po-md-12 po-text-center po-font-text">
          {{ literals.createNewPasswordPhrase }}
        </div>
      </div>

      <form #passwordForm="ngForm">
        <div class="po-row po-mt-3 po-mt-sm-1">
          <div class="po-md-6" [ngClass]="{ 'po-offset-md-3 po-offset-lg-3 po-offset-xl-3': !showRequirements }">
            @if (!hideCurrentPassword) {
              <div>
                <po-password
                  name="currentPassword"
                  [(ngModel)]="currentPassword"
                  p-required
                  [p-label]="literals.currentPassword"
                  [p-no-autocomplete]="noAutocompletePassword"
                  [p-size]="componentsSize"
                >
                </po-password>
              </div>
            }
            @if (!hideCurrentPassword && recovery) {
              <div class="po-text-center po-mb-sm-1 po-mb-2">
                @if (recoveryUrlType === 'internalLink') {
                  <a class="po-font-text-bold po-page-change-password-forgot-password" [routerLink]="recovery">
                    {{ literals.forgotPassword }}
                  </a>
                }
                @if (recoveryUrlType === 'externalLink') {
                  <a class="po-font-text-bold po-page-change-password-forgot-password" [href]="recovery">
                    {{ literals.forgotPassword }}
                  </a>
                }
                @if (!recoveryUrlType) {
                  <a
                    class="po-font-text-bold po-page-change-password-forgot-password po-clickable"
                    (click)="onForgotPasswordClick(recovery)"
                  >
                    {{ literals.forgotPassword }}
                  </a>
                }
              </div>
            }
            <div>
              <po-password
                name="newPassword"
                [(ngModel)]="newPassword"
                p-required
                [p-label]="literals.newPassword"
                (p-change-model)="validatePassword()"
                [p-no-autocomplete]="noAutocompletePassword"
                [p-size]="componentsSize"
              >
              </po-password>
            </div>
            <div>
              <po-password
                name="confirmPassword"
                [(ngModel)]="confirmPassword"
                p-required
                [p-label]="literals.confirmPassword"
                (p-change-model)="validatePassword()"
                [p-no-autocomplete]="noAutocompletePassword"
                [p-size]="componentsSize"
              >
              </po-password>
            </div>
          </div>
          @if (showRequirements) {
            <div class="po-md-6 po-page-change-password-required-container">
              <po-container>
                <ul class="po-page-change-password-required-list">
                  <li class="po-page-change-password-required-item">
                    <p class="po-mb-1 po-font-text-bold po-page-change-password-required-title">
                      {{ literals?.requirements }}
                    </p>
                  </li>
                  @for (requirement of requirements; track requirement) {
                    <li class="po-page-change-password-required-item">
                      <po-icon
                        class="po-icon po-page-change-password-required-icon"
                        [p-icon]="
                          validateRequirement(requirement)
                            ? 'ICON_OK po-page-change-password-required-ok'
                            : 'ICON_MINUS po-page-change-password-required-minus'
                        "
                      >
                      </po-icon>
                      <p class="po-page-change-password-required-text po-font-text">
                        {{ requirement.requirement }}
                      </p>
                    </li>
                  }
                </ul>
              </po-container>
            </div>
          }
        </div>
      </form>

      <po-divider class="po-sm-12"></po-divider>

      <div class="po-page-change-password-tips po-row">
        <div class="po-md-2 po-mr-3">
          <img
            class="po-page-change-password-lock-image po-mb-3"
            alt="Blocked user image"
            src="./assets/images/big-lock.svg"
          />
        </div>
        <div class="po-md-9 po-page-change-password-tips-text">
          <div class="po-font-text-bold po-pb-1">{{ literals.safetyTips }}</div>
          <div class="po-font-text-small">
            <div class="po-row po-pb-1">{{ literals.safetyTipsPhrase }}</div>
            <div class="po-row po-pb-1">\u2022 {{ literals.safetyTipsFirst }}</div>
            <div class="po-row po-pb-1">\u2022 {{ literals.safetyTipsSecond }}</div>
            <div class="po-row po-pb-1">\u2022 {{ literals.safetyTipsThird }}</div>
          </div>
        </div>
      </div>

      <div class="po-page-change-password-buttons po-row">
        <po-divider class="po-sm-12 po-mobile-only"></po-divider>

        @if (!hideCurrentPassword) {
          <po-button
            class="po-sm-6 po-mb-sm-1"
            [p-label]="literals.backButton"
            [p-size]="componentsSize"
            (p-click)="navigateTo(urlBack)"
          >
          </po-button>
        }

        <po-button
          [ngClass]="hideCurrentPassword ? 'po-md-12' : 'po-sm-6'"
          p-kind="primary"
          [p-disabled]="passwordForm.invalid"
          [p-label]="literals.saveButton"
          [p-size]="componentsSize"
          (p-click)="onLoginSubmit()"
        >
        </po-button>
      </div>
    </po-page-background>
  </div>
</div>

<po-modal
  [p-primary-action]="modalAction"
  p-hide-close
  p-size="auto"
  [p-components-size]="componentsSize"
  [p-title]="hideCurrentPassword ? literals.passwordSuccessfullyCreated : literals.passwordSuccessfullyUpdated"
>
  <div class="po-text-center">
    <img
      alt="Blocked user image"
      class="po-page-change-password-lock-image po-mb-3"
      src="./assets/images/success.svg"
    />
  </div>
</po-modal>
`
    }]
  }], () => [], {
    modal: [{
      type: ViewChild,
      args: [PoModalComponent, {
        static: true
      }]
    }],
    pageChangePassword: [{
      type: ViewChild,
      args: ["pageChangePassword", {
        read: ViewContainerRef,
        static: true
      }]
    }],
    passwordForm: [{
      type: ViewChild,
      args: ["passwordForm", {
        read: NgForm,
        static: true
      }]
    }]
  });
})();
var PoPageChangePasswordModule = class _PoPageChangePasswordModule {
  static \u0275fac = function PoPageChangePasswordModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageChangePasswordModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoPageChangePasswordModule,
    declarations: [PoPageChangePasswordComponent],
    imports: [CommonModule, FormsModule, RouterModule, PoModule, PoPageBackgroundModule],
    exports: [PoPageChangePasswordComponent]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    providers: [PoPageChangePasswordService],
    imports: [CommonModule, FormsModule, RouterModule, PoModule, PoPageBackgroundModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageChangePasswordModule, [{
    type: NgModule,
    args: [{
      imports: [CommonModule, FormsModule, RouterModule, PoModule, PoPageBackgroundModule],
      declarations: [PoPageChangePasswordComponent],
      providers: [PoPageChangePasswordService],
      exports: [PoPageChangePasswordComponent]
    }]
  }], null, null);
})();
var poPageDynamicLiterals = {
  en: {
    errorRenderPage: "Error loading page",
    notPossibleLoadMetadataPage: "The page metadata could not be loaded"
  },
  es: {
    errorRenderPage: "Error al cargar la p\xE1gina",
    notPossibleLoadMetadataPage: "No se pudieron cargar los metadatos de la p\xE1gina."
  },
  pt: {
    errorRenderPage: "Erro ao carregar a p\xE1gina",
    notPossibleLoadMetadataPage: "N\xE3o foi poss\xEDvel carregar os metadados da p\xE1gina"
  },
  ru: {
    errorRenderPage: "\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u044B",
    notPossibleLoadMetadataPage: "\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u043C\u0435\u0442\u0430\u0434\u0430\u043D\u043D\u044B\u0435 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u044B"
  }
};
var PoPageDynamicService = class _PoPageDynamicService {
  http = inject(HttpClient);
  notification = inject(PoNotificationService);
  headers = new HttpHeaders({
    "X-PO-SCREEN-LOCK": "true"
  });
  endpoint = "/";
  language;
  metadata;
  constructor() {
    const languageService = inject(PoLanguageService);
    this.language = languageService.getShortLanguage();
  }
  configServiceApi(config = {}) {
    this.endpoint = config.endpoint;
    this.metadata = config.metadata || this.metadata;
  }
  getMetadata(type = "list") {
    const key = `${this.endpoint}-${type}-metadata`;
    const cache = JSON.parse(localStorage.getItem(key)) || {};
    const metadataUrlBase = this.metadata || `${this.endpoint}/metadata`;
    const url = `${metadataUrlBase}?type=${type}&version=${cache.version || ""}`;
    return this.http.get(url).pipe(map((response) => {
      if (response.version !== void 0 && response.version === cache.version) {
        return cache;
      }
      localStorage.setItem(key, JSON.stringify(response));
      return __spreadValues(__spreadValues({}, cache), response);
    }), catchError((error) => {
      if (Object.keys(cache).length) {
        return of(cache);
      }
      const {
        errorRenderPage,
        notPossibleLoadMetadataPage
      } = poPageDynamicLiterals[this.language];
      this.notification.warning(notPossibleLoadMetadataPage);
      return merge(of({
        title: errorRenderPage
      }), throwError(error));
    }));
  }
  // Deleta um único recurso
  deleteResource(id, endpoint) {
    const localEndPoint = this.getLocalEndPoint(endpoint, true);
    const url = id ? `${localEndPoint}/${id}` : localEndPoint;
    return this.http.delete(url, {
      headers: this.headers
    });
  }
  // Deleta recursos em lote
  deleteResources(ids, endpoint) {
    return this.http.request("delete", `${this.getLocalEndPoint(endpoint)}`, {
      headers: this.headers,
      body: ids
    });
  }
  // Busca uma lista de recursos
  getResources(params, endpoint) {
    return this.http.get(this.getLocalEndPoint(endpoint), {
      headers: this.headers,
      params
    });
  }
  // Busca um único recurso
  getResource(id, endpoint) {
    return this.http.get(`${this.getLocalEndPoint(endpoint, true)}/${id}`, {
      headers: this.headers
    });
  }
  // Cria um recurso
  createResource(resource, endpoint) {
    return this.http.post(`${this.getLocalEndPoint(endpoint)}`, resource, {
      headers: this.headers
    });
  }
  // Atualiza um recurso
  updateResource(id, resource, endpoint) {
    return this.http.put(`${this.getLocalEndPoint(endpoint, true)}/${id}`, resource, {
      headers: this.headers
    });
  }
  getLocalEndPoint(endpoint, checkSingleBar = false) {
    endpoint = endpoint ?? this.endpoint;
    if (checkSingleBar) {
      endpoint = endpoint === "/" ? "" : endpoint;
    }
    return endpoint;
  }
  static \u0275fac = function PoPageDynamicService_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicService)();
  };
  static \u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
    token: _PoPageDynamicService,
    factory: _PoPageDynamicService.\u0275fac,
    providedIn: "root"
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [], null);
})();
var PoPageCustomizationService = class _PoPageCustomizationService {
  http = inject(HttpClient);
  getCustomOptions(origin, originalOption, optionSchema) {
    return this.createObservable(origin).pipe(map((newPageOptions) => this.mergePageOptions(originalOption, newPageOptions, optionSchema)));
  }
  changeOriginalOptionsToNewOptions(objectToChange, newOptions) {
    Object.keys(newOptions).forEach((key) => {
      const value = newOptions[key];
      if (key in objectToChange) {
        if (Array.isArray(value)) {
          objectToChange[key] = [...value];
          return;
        }
        if (typeof value === "number" || typeof value === "string" || typeof value === "boolean") {
          objectToChange[key] = value;
          return;
        }
        if (value !== null && typeof value === "object") {
          objectToChange[key] = __spreadValues({}, value);
        }
      }
    });
  }
  createObservable(origin) {
    if (typeof origin === "string") {
      return this.http.post(origin, {});
    }
    return from(Promise.resolve(origin()));
  }
  mergePageOptions(originalOption, newPageOptions, optionSchema) {
    const mergePageOptions = optionSchema.schema.reduce((objWithNewProp, prop) => __spreadProps(__spreadValues({}, objWithNewProp), {
      [prop.nameProp]: this.createNewProp(prop, originalOption, newPageOptions)
    }), {});
    Object.keys(mergePageOptions).forEach((key) => mergePageOptions[key] === void 0 && delete mergePageOptions[key]);
    return mergePageOptions;
  }
  createNewProp(prop, originalOption, newPageOptions) {
    if (prop.merge) {
      return this.mergeOptions(originalOption[prop.nameProp], newPageOptions[prop.nameProp], prop.keyForMerge);
    } else {
      return newPageOptions[prop.nameProp] ?? originalOption[prop.nameProp];
    }
  }
  mergeOptions(originalOptions, newOptions, filterProp) {
    if (!originalOptions && !newOptions) {
      return;
    }
    if (!newOptions) {
      return originalOptions;
    }
    if (!originalOptions) {
      return newOptions;
    }
    if (originalOptions instanceof Array && newOptions instanceof Array) {
      return this.mergeOptionsArray(originalOptions, newOptions, filterProp);
    }
    return __spreadValues(__spreadValues({}, originalOptions), newOptions);
  }
  mergeOptionsArray(originalOptions, newOptions, filterProp) {
    const deduplicateNewOptions = newOptions.filter((newItem) => !originalOptions.find((originalItem) => originalItem[filterProp] === newItem[filterProp]));
    const mergedOriginalOptions = originalOptions.map((originalItem) => {
      const newItem = newOptions.find((newOptionsItem) => originalItem[filterProp] === newOptionsItem[filterProp]) || originalItem;
      return __spreadValues(__spreadValues({}, originalItem), newItem);
    });
    return [...mergedOriginalOptions, ...deduplicateNewOptions];
  }
  static \u0275fac = function PoPageCustomizationService_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageCustomizationService)();
  };
  static \u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
    token: _PoPageCustomizationService,
    factory: _PoPageCustomizationService.\u0275fac,
    providedIn: "root"
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageCustomizationService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], null, null);
})();
var PoPageDynamicDetailActionsService = class _PoPageDynamicDetailActionsService {
  http = inject(HttpClient);
  headers = new HttpHeaders({
    "X-PO-SCREEN-LOCK": "true"
  });
  beforeBack(action) {
    return this.executeAction({
      action
    });
  }
  beforeEdit(action, id, body) {
    const resource = body ?? {};
    return this.executeAction({
      action,
      resource,
      id
    });
  }
  beforeRemove(action, id, body) {
    const resource = body ?? {};
    return this.executeAction({
      action,
      resource,
      id
    });
  }
  executeAction({
    action,
    resource = {},
    id
  }) {
    if (!action) {
      return of({});
    }
    if (typeof action === "string") {
      const url = id ? `${action}/${id}` : action;
      return this.http.post(url, resource, {
        headers: this.headers
      });
    }
    return of(action(id, resource));
  }
  static \u0275fac = function PoPageDynamicDetailActionsService_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicDetailActionsService)();
  };
  static \u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
    token: _PoPageDynamicDetailActionsService,
    factory: _PoPageDynamicDetailActionsService.\u0275fac,
    providedIn: "root"
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicDetailActionsService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], null, null);
})();
var poPageDynamicDetailLiteralsDefault = {
  en: {
    pageActionEdit: "Edit",
    pageActionRemove: "Delete",
    pageActionBack: "Back",
    confirmRemoveTitle: "Confirm delete",
    confirmRemoveMessage: "Are you sure you want to delete this record? You can not undo this action.",
    removeNotificationSuccess: "Item deleted successfully.",
    registerNotFound: "Register not found."
  },
  es: {
    pageActionEdit: "Editar",
    pageActionRemove: "Borrar",
    pageActionBack: "Regreso",
    confirmRemoveTitle: "Confirmar la exclusi\xF3n",
    confirmRemoveMessage: "\xBFEst\xE1 seguro de que desea eliminar este registro? No puede deshacer esta acci\xF3n.",
    removeNotificationSuccess: "Elemento eliminado con \xE9xito.",
    registerNotFound: "Registro no encontrado."
  },
  pt: {
    pageActionEdit: "Editar",
    pageActionRemove: "Excluir",
    pageActionBack: "Voltar",
    confirmRemoveTitle: "Confirmar exclus\xE3o",
    confirmRemoveMessage: "Tem certeza de que deseja excluir esse registro? Voc\xEA n\xE3o poder\xE1 desfazer essa a\xE7\xE3o.",
    removeNotificationSuccess: "Item exclu\xEDdo com sucesso.",
    registerNotFound: "Registro n\xE3o encontrado."
  },
  ru: {
    pageActionEdit: "\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",
    pageActionRemove: "\u0423\u0434\u0430\u043B\u0438\u0442\u044C",
    pageActionBack: "\u041D\u0430\u0437\u0430\u0434",
    confirmRemoveTitle: "\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F",
    confirmRemoveMessage: "\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u0442\u0443 \u0437\u0430\u043F\u0438\u0441\u044C?  \u0412\u044B \u043D\u0435 \u043C\u043E\u0436\u0435\u0442\u0435 \u043E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u044D\u0442\u043E \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435.",
    removeNotificationSuccess: "\u042D\u043B\u0435\u043C\u0435\u043D\u0442 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D.",
    registerNotFound: "\u0417\u0430\u043F\u0438\u0441\u044C \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430."
  }
};
var PoPageDynamicDetailComponent = class _PoPageDynamicDetailComponent {
  router = inject(Router);
  activatedRoute = inject(ActivatedRoute);
  poNotification = inject(PoNotificationService);
  poDialogService = inject(PoDialogService);
  poPageDynamicService = inject(PoPageDynamicService);
  poPageDynamicDetailActionsService = inject(PoPageDynamicDetailActionsService);
  poPageCustomizationService = inject(PoPageCustomizationService);
  /** Objeto com propriedades do breadcrumb. */
  breadcrumb = {
    items: []
  };
  /**
   * Função ou serviço que será executado na inicialização do componente.
   *
   * A propriedade aceita os seguintes tipos:
   * - `string`: *Endpoint* usado pelo componente para requisição via `POST`.
   * - `function`: Método que será executado.
   *
   * O retorno desta função deve ser do tipo `PoPageDynamicDetailOptions`,
   * onde o usuário poderá customizar novos campos, breadcrumb, title e actions
   *
   * Por exemplo:
   *
   * ```
   * getPageOptions(): PoPageDynamicDetailOptions {
   * return {
   *   actions:
   *     { new: 'new', edit: 'edit/:id', remove: true },
   *   fields: [
   *     { property: 'idCard', gridColumns: 6 }
   *   ]
   * };
   * }
   *
   * ```
   * Para referenciar a sua função utilize a propriedade `bind`, por exemplo:
   * ```
   *  [p-load]="onLoadOptions.bind(this)"
   * ```
   */
  onLoad;
  /** Título da página. */
  title;
  /**
   * @description
   *
   * Endpoint usado pelo template para requisição do recurso que serão exibido.
   *
   * Caso a ação `remove` estiver configurada, será feito uma requisição de exclusão nesse mesmo endpoint passando os campos
   * setados como `key: true`.
   *
   * > `DELETE {end-point}/{keys}`
   *
   * ```
   *  <po-page-dynamic-detail
   *    [p-actions]="{ remove: '/' }"
   *    [p-fields]="[ { property: 'id', key: true } ]"
   *    p-service="/api/po-samples/v1/people"
   *    ...>
   *  </po-page-dynamic-detail>
   * ```
   *
   * Resquisição disparada, onde a propriedade `id` é igual a 2:
   *
   * ```
   *  DELETE /api/po-samples/v1/people/2 HTTP/1.1
   *  Host: localhost:4000
   *  Connection: keep-alive
   *  Accept: application/json, text/plain
   *  ...
   * ```
   *
   * > Caso esteja usando metadados com o template, será disparado uma requisição na inicialização do template para buscar
   * > os metadados da página passando o tipo do metadado esperado e a versão cacheada pelo browser.
   * >
   * > `GET {end-point}/metadata?type=detail&version={version}`
   */
  serviceApi;
  literals;
  model = {};
  subscriptions = [];
  _actions = {};
  _autoRouter = false;
  _componentsSize = void 0;
  _duplicates = [];
  _fields = [];
  _keys = [];
  _pageActions = [];
  /**
   * @optional
   *
   * @description
   *
   * Define as ações da página de acordo com a interface `PoPageDynamicDetailActions`.
   */
  set actions(value) {
    this._actions = this.isObject(value) ? value : {};
    this._pageActions = this.getPageActions(this._actions);
  }
  get actions() {
    return __spreadValues({}, this._actions);
  }
  /**
   * @todo Validar rotas na mão pois se existir uma rota '**' o catch do navigation não funciona.
   *
   * @optional
   *
   * @description
   *
   * Cria automaticamente as rotas de edição (novo/duplicate) e detalhes caso as ações
   * estejam definidas nas ações.
   *
   * > Para o correto funcionamento não pode haver nenhum rota coringa (`**`) especificada.
   *
   * @default false
   */
  set autoRouter(value) {
    this._autoRouter = convertToBoolean(value);
  }
  get autoRouter() {
    return this._autoRouter;
  }
  /**
   * @optional
   *
   * @description
   *
   * Define o tamanho dos componentes de formulário no template:
   * - `small`: aplica a medida small de cada componente (disponível apenas para acessibilidade AA).
   * - `medium`: aplica a medida medium de cada componente.
   *
   * > Caso a acessibilidade AA não esteja configurada, o tamanho `medium` será mantido.
   * Para mais detalhes, consulte a documentação do [po-theme](https://po-ui.io/documentation/po-theme).
   *
   * @default `medium`
   */
  set componentsSize(value) {
    this._componentsSize = validateSizeFn(value);
  }
  get componentsSize() {
    return this._componentsSize ?? getDefaultSizeFn();
  }
  /** Lista dos campos exibidos na página. */
  set fields(value) {
    this._fields = Array.isArray(value) ? [...value] : [];
    this._keys = this.getKeysByFields(this.fields);
    this._duplicates = this.getDuplicatesByFields(this.fields);
  }
  get fields() {
    return this._fields;
  }
  /* eslint-disable max-params */
  constructor() {
    const languageService = inject(PoLanguageService);
    const language = languageService.getShortLanguage();
    this.literals = __spreadValues(__spreadValues({}, poPageDynamicDetailLiteralsDefault[poLocaleDefault]), poPageDynamicDetailLiteralsDefault[language]);
  }
  /* eslint-enable max-params */
  ngOnInit() {
    this.loadDataFromAPI();
  }
  ngOnDestroy() {
    if (this.subscriptions) {
      this.subscriptions.forEach((subscription) => {
        subscription.unsubscribe();
      });
    }
  }
  get duplicates() {
    return [...this._duplicates];
  }
  get keys() {
    return [...this._keys];
  }
  get pageActions() {
    return [...this._pageActions];
  }
  remove(actionRemove, actionBeforeRemove) {
    const uniqueKey = this.formatUniqueKey(this.model);
    this.subscriptions.push(this.poPageDynamicDetailActionsService.beforeRemove(actionBeforeRemove, uniqueKey, __spreadValues({}, this.model)).pipe(switchMap((beforeRemoveResult) => {
      const newRemoveAction = beforeRemoveResult?.newUrl ?? actionRemove;
      const allowAction = beforeRemoveResult?.allowAction ?? true;
      if (!allowAction) {
        return of({});
      }
      if (typeof newRemoveAction === "string") {
        return this.executeRemove(newRemoveAction, uniqueKey);
      } else {
        newRemoveAction(uniqueKey, __spreadValues({}, this.model));
        return EMPTY;
      }
    })).subscribe());
  }
  confirmRemove(actionRemove, actionBeforeRemove) {
    const confirmOptions = {
      title: this.literals.confirmRemoveTitle,
      message: this.literals.confirmRemoveMessage,
      confirm: this.remove.bind(this, actionRemove, actionBeforeRemove)
    };
    this.poDialogService.confirm(confirmOptions);
  }
  executeRemove(path, uniqueKey) {
    return this.poPageDynamicService.deleteResource(uniqueKey).pipe(map(() => {
      this.poNotification.success(this.literals.removeNotificationSuccess);
      this.navigateTo({
        path
      });
    }));
  }
  formatUniqueKey(item) {
    const keys2 = mapObjectByProperties(item, this.keys);
    return valuesFromObject(keys2).join("|");
  }
  goBack(actionBack) {
    this.subscriptions.push(this.poPageDynamicDetailActionsService.beforeBack(this.actions.beforeBack).subscribe((beforeBackResult) => this.executeBackAction(actionBack, beforeBackResult?.allowAction, beforeBackResult?.newUrl)));
  }
  executeBackAction(actionBack, allowAction, newUrl) {
    const isAllowedAction = typeof allowAction === "boolean" ? allowAction : true;
    if (isAllowedAction) {
      if (actionBack === void 0 || typeof actionBack === "boolean") {
        return window.history.back();
      }
      if (typeof actionBack === "string" || newUrl) {
        return this.router.navigate([newUrl || actionBack]);
      }
      return actionBack();
    }
  }
  loadData(id) {
    return this.poPageDynamicService.getResource(id).pipe(tap((response) => {
      if (!response) {
        this.setUndefinedToModelAndActions();
      } else {
        this.model = response;
      }
    }), catchError((error) => {
      this.setUndefinedToModelAndActions();
      return throwError(error);
    }));
  }
  setUndefinedToModelAndActions() {
    this.model = void 0;
    this.actions = void 0;
  }
  getMetadata(serviceApiFromRoute, onLoad) {
    if (serviceApiFromRoute) {
      return this.poPageDynamicService.getMetadata("detail").pipe(tap((response) => {
        this.autoRouter = response.autoRouter || this.autoRouter;
        this.actions = response.actions || this.actions;
        this.breadcrumb = response.breadcrumb || this.breadcrumb;
        this.fields = response.fields || this.fields;
        this.title = response.title || this.title;
      }), switchMap(() => this.loadOptionsOnInitialize(onLoad)));
    }
    return this.loadOptionsOnInitialize(onLoad);
  }
  // @todo Validar rotas na mão pois se existir uma rota '**' o catch do navigation não funciona.
  navigateTo(route, forceStopAutoRouter = false) {
    this.router.navigate([route.url || route.path], {
      queryParams: route.params
    }).catch(() => {
      if (forceStopAutoRouter || !this.autoRouter) {
        return;
      }
      this.router.config.unshift({
        path: route.path,
        component: route.component,
        data: {
          serviceApi: this.serviceApi,
          autoRouter: true
        }
      });
      this.navigateTo(route, true);
    });
  }
  openEdit(action) {
    const id = this.formatUniqueKey(this.model);
    this.subscriptions.push(this.poPageDynamicDetailActionsService.beforeEdit(this.actions.beforeEdit, id, this.model).pipe(switchMap((beforeEditResult) => this.executeEditAction(action, beforeEditResult, id))).subscribe());
  }
  executeEditAction(action, beforeEditResult, id) {
    const newEditAction = beforeEditResult?.newUrl ?? action;
    const allowAction = beforeEditResult?.allowAction ?? true;
    if (!allowAction) {
      return of({});
    }
    if (typeof newEditAction === "string") {
      this.openEditUrl(newEditAction);
    } else {
      newEditAction(id, __spreadValues({}, this.model));
    }
    return EMPTY;
  }
  openEditUrl(path) {
    const url = this.resolveUrl(this.model, path);
    this.navigateTo({
      path,
      url
    });
  }
  resolveUrl(item, path) {
    const uniqueKey = this.formatUniqueKey(item);
    return path.replace(/:id/g, uniqueKey);
  }
  getPageActions(actions = {}) {
    const pageActions = [];
    if (actions.edit) {
      pageActions.push({
        label: this.literals.pageActionEdit,
        action: this.openEdit.bind(this, actions.edit)
      });
    }
    if (actions.remove) {
      pageActions.push({
        label: this.literals.pageActionRemove,
        action: this.confirmRemove.bind(this, actions.remove, this.actions.beforeRemove),
        type: "danger"
      });
    }
    if (actions.back === void 0 || actions.back) {
      pageActions.push({
        label: this.literals.pageActionBack,
        action: this.goBack.bind(this, actions.back)
      });
    }
    return pageActions;
  }
  getKeysByFields(fields = []) {
    return fields.filter((field) => field.key === true).map((field) => field.property);
  }
  getDuplicatesByFields(fields = []) {
    return fields.filter((field) => field.duplicate === true).map((field) => field.property);
  }
  isObject(value) {
    return !!value && typeof value === "object" && !Array.isArray(value);
  }
  loadDataFromAPI() {
    const {
      serviceApi: serviceApiFromRoute,
      serviceMetadataApi,
      serviceLoadApi
    } = this.activatedRoute.snapshot.data;
    const {
      id
    } = this.activatedRoute.snapshot.params;
    const onLoad = serviceLoadApi || this.onLoad;
    this.serviceApi = serviceApiFromRoute || this.serviceApi;
    this.poPageDynamicService.configServiceApi({
      endpoint: this.serviceApi,
      metadata: serviceMetadataApi
    });
    const metadata$ = this.getMetadata(serviceApiFromRoute, onLoad);
    const data$ = this.loadData(id);
    this.subscriptions.push(concat(metadata$, data$).subscribe());
  }
  loadOptionsOnInitialize(onLoad) {
    if (onLoad) {
      return this.getPoDynamicPageOptions(onLoad).pipe(tap((responsePoOption) => this.poPageCustomizationService.changeOriginalOptionsToNewOptions(this, responsePoOption)));
    }
    return EMPTY;
  }
  getPoDynamicPageOptions(onLoad) {
    const originalOption = {
      fields: this.fields,
      actions: this.actions,
      breadcrumb: this.breadcrumb,
      title: this.title
    };
    const pageOptionSchema = {
      schema: [{
        nameProp: "fields",
        merge: true,
        keyForMerge: "property"
      }, {
        nameProp: "actions",
        merge: true
      }, {
        nameProp: "breadcrumb"
      }, {
        nameProp: "title"
      }]
    };
    return this.poPageCustomizationService.getCustomOptions(onLoad, originalOption, pageOptionSchema);
  }
  static \u0275fac = function PoPageDynamicDetailComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicDetailComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageDynamicDetailComponent,
    selectors: [["po-page-dynamic-detail"]],
    inputs: {
      breadcrumb: [0, "p-breadcrumb", "breadcrumb"],
      onLoad: [0, "p-load", "onLoad"],
      title: [0, "p-title", "title"],
      serviceApi: [0, "p-service-api", "serviceApi"],
      actions: [0, "p-actions", "actions"],
      autoRouter: [0, "p-auto-router", "autoRouter"],
      componentsSize: [0, "p-components-size", "componentsSize"],
      fields: [0, "p-fields", "fields"]
    },
    standalone: false,
    features: [\u0275\u0275ProvidersFeature([PoPageDynamicService, PoPageDynamicDetailActionsService])],
    decls: 3,
    vars: 5,
    consts: [[3, "p-actions", "p-breadcrumb", "p-components-size", "p-title"], [3, "p-components-size", "p-fields", "p-value"], [3, "p-size"], ["p-icon", "ICON_INFO"], [1, "po-font-text-large"]],
    template: function PoPageDynamicDetailComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "po-page-default", 0);
        \u0275\u0275template(1, PoPageDynamicDetailComponent_Conditional_1_Template, 1, 3, "po-dynamic-view", 1)(2, PoPageDynamicDetailComponent_Conditional_2_Template, 4, 2, "po-widget", 2);
        \u0275\u0275elementEnd();
      }
      if (rf & 2) {
        \u0275\u0275property("p-actions", ctx.pageActions)("p-breadcrumb", ctx.breadcrumb)("p-components-size", ctx.componentsSize)("p-title", ctx.title);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.model ? 1 : 2);
      }
    },
    dependencies: [PoDynamicViewComponent, PoIconComponent, PoPageDefaultComponent, PoWidgetComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicDetailComponent, [{
    type: Component,
    args: [{
      selector: "po-page-dynamic-detail",
      providers: [PoPageDynamicService, PoPageDynamicDetailActionsService],
      standalone: false,
      template: '<po-page-default\n  [p-actions]="pageActions"\n  [p-breadcrumb]="breadcrumb"\n  [p-components-size]="componentsSize"\n  [p-title]="title"\n>\n  @if (model) {\n    <po-dynamic-view [p-components-size]="componentsSize" [p-fields]="fields" [p-value]="model"> </po-dynamic-view>\n  } @else {\n    <po-widget [p-size]="componentsSize">\n      <po-icon p-icon="ICON_INFO"></po-icon>\n      <span class="po-font-text-large">\n        {{ literals.registerNotFound }}\n      </span>\n    </po-widget>\n  }\n</po-page-default>\n'
    }]
  }], () => [], {
    breadcrumb: [{
      type: Input,
      args: ["p-breadcrumb"]
    }],
    onLoad: [{
      type: Input,
      args: ["p-load"]
    }],
    title: [{
      type: Input,
      args: ["p-title"]
    }],
    serviceApi: [{
      type: Input,
      args: ["p-service-api"]
    }],
    actions: [{
      type: Input,
      args: ["p-actions"]
    }],
    autoRouter: [{
      type: Input,
      args: ["p-auto-router"]
    }],
    componentsSize: [{
      type: Input,
      args: ["p-components-size"]
    }],
    fields: [{
      type: Input,
      args: ["p-fields"]
    }]
  });
})();
var PoPageDynamicModule = class _PoPageDynamicModule {
  static \u0275fac = function PoPageDynamicModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoPageDynamicModule,
    imports: [CommonModule]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    providers: [PoPageDynamicService],
    imports: [CommonModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicModule, [{
    type: NgModule,
    args: [{
      imports: [CommonModule],
      providers: [PoPageDynamicService]
    }]
  }], null, null);
})();
var PoPageDynamicDetailModule = class _PoPageDynamicDetailModule {
  static \u0275fac = function PoPageDynamicDetailModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicDetailModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoPageDynamicDetailModule,
    declarations: [PoPageDynamicDetailComponent],
    imports: [CommonModule, FormsModule, RouterModule, PoDynamicModule, PoIconModule, PoModalModule, PoPageModule, PoWidgetModule, PoPageDynamicModule],
    exports: [PoPageDynamicDetailComponent]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    imports: [CommonModule, FormsModule, RouterModule, PoDynamicModule, PoIconModule, PoModalModule, PoPageModule, PoWidgetModule, PoPageDynamicModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicDetailModule, [{
    type: NgModule,
    args: [{
      imports: [CommonModule, FormsModule, RouterModule, PoDynamicModule, PoIconModule, PoModalModule, PoPageModule, PoWidgetModule, PoPageDynamicModule],
      declarations: [PoPageDynamicDetailComponent],
      exports: [PoPageDynamicDetailComponent]
    }]
  }], null, null);
})();
var PoPageDynamicEditActionsService = class _PoPageDynamicEditActionsService {
  http = inject(HttpClient);
  headers = new HttpHeaders({
    "X-PO-SCREEN-LOCK": "true"
  });
  beforeCancel(action) {
    return this.executeAction({
      action
    });
  }
  beforeSave(action, id, body) {
    const resource = body ?? {};
    return this.executeAction({
      action,
      resource,
      id
    });
  }
  beforeSaveNew(action, id, body) {
    const resource = body ?? {};
    return this.executeAction({
      action,
      resource,
      id
    });
  }
  executeAction({
    action,
    resource = {},
    id
  }) {
    if (!action) {
      return of({});
    }
    if (typeof action === "string") {
      const url = id ? `${action}/${id}` : action;
      return this.http.post(url, resource, {
        headers: this.headers
      });
    }
    return of(action(resource, id));
  }
  static \u0275fac = function PoPageDynamicEditActionsService_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicEditActionsService)();
  };
  static \u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
    token: _PoPageDynamicEditActionsService,
    factory: _PoPageDynamicEditActionsService.\u0275fac,
    providedIn: "root"
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicEditActionsService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], null, null);
})();
var poNotificationType = ["error", "warning"];
var poNotificationTypeDefault = "warning";
var poPageDynamicEditLiteralsDefault = {
  en: {
    cancelConfirmMessage: "Are you sure you want to cancel this operation?",
    detailActionNew: "New",
    pageActionCancel: "Cancel",
    pageActionSave: "Save",
    pageActionSaveNew: "Save and new",
    registerNotFound: "Register not found.",
    saveNotificationError: "Mandatory field(s) not filled.",
    saveNotificationSuccessSave: "Resource successfully saved.",
    saveNotificationSuccessUpdate: "Resource successfully updated.",
    saveNotificationWarning: "Form must be filled out correctly."
  },
  es: {
    cancelConfirmMessage: "Est\xE1 seguro de que desea cancelar esta operaci\xF3n?",
    detailActionNew: "Nuevo",
    pageActionCancel: "Cancelar",
    pageActionSave: "Guardar",
    pageActionSaveNew: "Guardar y nuevo",
    registerNotFound: "Registro no encontrado.",
    saveNotificationError: "Campo(s) obligatorio(s) no completado(s).",
    saveNotificationSuccessSave: "Recurso salvo con \xE9xito.",
    saveNotificationSuccessUpdate: "Recurso actualizado con \xE9xito.",
    saveNotificationWarning: "El formulario debe llenarse correctamente."
  },
  pt: {
    cancelConfirmMessage: "Tem certeza que deseja cancelar esta opera\xE7\xE3o?",
    detailActionNew: "Novo",
    pageActionCancel: "Cancelar",
    pageActionSave: "Salvar",
    pageActionSaveNew: "Salvar e novo",
    registerNotFound: "Registro n\xE3o encontrado.",
    saveNotificationError: "Campo(s) obrigat\xF3rio(s) sem preenchimento.",
    saveNotificationSuccessSave: "Recurso salvo com sucesso.",
    saveNotificationSuccessUpdate: "Recurso atualizado com sucesso.",
    saveNotificationWarning: "Formul\xE1rio precisa ser preenchido corretamente."
  },
  ru: {
    cancelConfirmMessage: "\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u043E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u044D\u0442\u0443 \u043E\u043F\u0435\u0440\u0430\u0446\u0438\u044E?",
    detailActionNew: "\u041D\u043E\u0432\u044B\u0439",
    pageActionCancel: "\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C",
    pageActionSave: "\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",
    pageActionSaveNew: "\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0438 \u0441\u043E\u0437\u0434\u0430\u0442\u044C",
    registerNotFound: "\u0417\u0430\u043F\u0438\u0441\u044C \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430.",
    saveNotificationError: "\u041E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043F\u043E\u043B\u0435(\u044F) \u043D\u0435 \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u043E.",
    saveNotificationSuccessSave: "\u0420\u0435\u0441\u0443\u0440\u0441 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D.",
    saveNotificationSuccessUpdate: "\u0420\u0435\u0441\u0443\u0440\u0441 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D.",
    saveNotificationWarning: "\u0424\u043E\u0440\u043C\u0430 \u0434\u043E\u043B\u0436\u043D\u0430 \u0431\u044B\u0442\u044C \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0430 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E."
  }
};
var PoPageDynamicEditComponent = class _PoPageDynamicEditComponent {
  router = inject(Router);
  activatedRoute = inject(ActivatedRoute);
  poNotification = inject(PoNotificationService);
  poDialogService = inject(PoDialogService);
  poPageDynamicService = inject(PoPageDynamicService);
  poPageCustomizationService = inject(PoPageCustomizationService);
  poPageDynamicEditActionsService = inject(PoPageDynamicEditActionsService);
  dynamicForm;
  gridDetail;
  /** Objeto com propriedades do breadcrumb. */
  breadcrumb = {
    items: []
  };
  /**
   * @description
   *
   * Endpoint usado pelo template para requisição do recurso que será exibido para edição.
   *
   * Para as ações de `save` e `saveNew`, será feito uma requisição de criação nesse mesmo endpoint passando os valores
   * preenchidos pelo usuário via payload.
   *
   * > `POST {end-point}`
   *
   * ```
   *  <po-page-dynamic-edit
   *    [p-actions]="{ save: '/', saveNew: 'new' }"
   *    [p-fields]="[ { property: 'name' }, { property: 'city' } ]"
   *    p-service="/api/po-samples/v1/people"
   *    ...>
   *  </po-page-dynamic-edit>
   * ```
   *
   * Resquisição disparada, onde a propriedade `name` e `city` foram preenchidas:
   *
   * ```
   *  POST /api/po-samples/v1/people HTTP/1.1
   *  Host: localhost:4000
   *  Connection: keep-alive
   *  Accept: application/json, text/plain
   *  ...
   * ```
   *
   * Request payload:
   *
   * ```
   * { "name": "Fulano", "city": "Smallville" }
   * ```
   *
   * Caso queira que o template carregue um recurso já existente, deve-se ser incluído um parametro na rota chamado `id`.
   *
   * Exemplo de configuração de rota:
   *
   * ```
   *  RouterModule.forRoot([
   *    ...
   *    { path: 'edit/:id', component: PersonEditComponent },
   *    ...
   *  ],
   * ```
   *
   * Baseado nisso, na inicialização do template, será disparado uma requisição para buscar o recurso que será editado.
   *
   * > `GET {end-point}/{id}`
   *
   * Nos métodos de `save` e `saveNew`, ao invés de um `POST`, será disparado um `PUT`.
   *
   * Resquisição disparada, onde a propriedade `name` e `city` foram preenchidas / atualizadas, e o `id` da url é 2:
   *
   * ```
   *  PUT /api/po-samples/v1/people/2 HTTP/1.1
   *  Host: localhost:4000
   *  Connection: keep-alive
   *  Accept: application/json, text/plain
   *  ...
   * ```
   *
   * Request payload:
   *
   * ```
   * { "name": "Fulano", "city": "Metropolis" }
   * ```
   */
  serviceApi;
  /** Título da página. */
  title;
  /**
   * Função ou serviço que será executado na inicialização do componente.
   *
   * A propriedade aceita os seguintes tipos:
   * - `string`: *Endpoint* usado pelo componente para requisição via `POST`.
   * - `function`: Método que será executado.
   *
   * O retorno desta função deve ser do tipo `PoPageDynamicEditOptions`,
   * onde o usuário poderá customizar novos campos, breadcrumb, title e actions
   *
   * Por exemplo:
   *
   * ```
   * getPageOptions(): PoPageDynamicEditOptions {
   * return {
   *   actions:
   *     { cancel: false, save: 'save/:id', saveNew: 'saveNew' },
   *   fields: [
   *     { property: 'idCard', gridColumns: 6 }
   *   ]
   * };
   * }
   *
   * ```
   * Para referenciar a sua função utilize a propriedade `bind`, por exemplo:
   * ```
   *  [p-load]="onLoadOptions.bind(this)"
   * ```
   */
  onLoad;
  /**
   * @optional
   *
   * @description
   *
   * Função que será executada após ser realizada a busca dos dados.
   *
   * A propriedade aceita os seguintes tipos:
   * - `function`: Método que será executado.
   *
   * Esta função passa por parâmetro o model e deve recebê-lo de volta com as alterações.
   * Também aceita o retorno de um Observable com o novo model.
   *
   * Por exemplo:
   *
   * ```
   * onLoadCustom(model) {
   *  return { ...model, customField: 'newValue' };
   * }
   *
   * ```
   * Para referenciar a sua função utilize a propriedade `bind`, por exemplo:
   * ```
   *  [p-load-data]="onLoadCustom.bind(this)"
   * ```
   */
  onLoadData;
  model = {};
  // beforeSave: return boolean
  // afterSave
  // beforeRemove: return boolean
  // afterRemove
  // beforeInsert: : return boolean
  detailActions = {};
  indexFocus = 0;
  language;
  subscriptions = [];
  _actions = {};
  _componentsSize = void 0;
  _literals;
  _autoRouter = false;
  _controlFields = [];
  _detailFields = [];
  _duplicates = [];
  _fields = [];
  _keys = [];
  _pageActions = [];
  _notificationType = poNotificationTypeDefault;
  /**
   * @optional
   *
   * @description
   *
   * Ações da página.
   */
  set actions(value) {
    this._actions = this.isObject(value) ? value : {};
    this._pageActions = this.getPageActions(this._actions);
  }
  get actions() {
    return __spreadValues({}, this._actions);
  }
  /**
   * @optional
   *
   * @description
   *
   * Objeto com as literais usadas no `po-page-dynamic-edit`.
   *
   * É possivel customizar passando um objeto com todas as literais disponíveis
   * ou passando apenas as literais que deseja customizar
   *
   * ```
   *  const customLiterals: PoPageDynamicEditLiterals = {
   *    detailActionNew: 'Incluir',
   *    pageActionCancel: 'Descartar',
   *    pageActionSave: 'Gravar',
   *    pageActionSaveNew: 'Gravar e incluir',
   *    registerNotFound: 'Nenhum registro encontrado.',
   *    saveNotificationError: 'Campo(s) obrigatório(s) sem preenchimento.',
   *    saveNotificationSuccessSave: 'Item salvo com sucesso.',
   *    saveNotificationSuccessUpdate: 'Item atualizado com sucesso.',
   *    saveNotificationWarning: 'Necessário preencher o formulário corretamente.'
   *  };
   * ```
   *
   * E para carregar as literais customizadas, basta apenas passar o objeto para o componente.
   *
   * ```
   * <po-page-dynamic-edit
   *   [p-literals]="customLiterals">
   * </po-page-dynamic-edit>
   * ```
   *
   * > O valor padrão será traduzido de acordo com o idioma configurado no [`PoI18nService`](/documentation/po-i18n) ou *browser*.
   */
  set literals(value) {
    if (value instanceof Object && !(value instanceof Array)) {
      this._literals = __spreadValues(__spreadValues(__spreadValues({}, poPageDynamicEditLiteralsDefault[poLocaleDefault]), poPageDynamicEditLiteralsDefault[this.language]), value);
    } else {
      this._literals = poPageDynamicEditLiteralsDefault[this.language];
    }
    this._pageActions = this.getPageActions(this._actions);
  }
  get literals() {
    return this._literals || poPageDynamicEditLiteralsDefault[this.language];
  }
  /**
   * @optional
   *
   * @description
   *
   * Tipo da notificação.
   *
   * É possivel definir o tipo de notificação que será exibido quando houver algum campo inválido no formulário.
   *
   * ```
   * <po-page-dynamic-edit
   *   p-notification-type="warning">
   * </po-page-dynamic-edit>
   * ```
   *
   * > Os valores aceitos são 'warning' e 'error'.
   * @default warning
   */
  set notificationType(value) {
    this._notificationType = poNotificationType.includes(value) ? value : poNotificationTypeDefault;
  }
  get notificationType() {
    return this._notificationType;
  }
  /**
   * @todo Validar rotas na mão pois se existir uma rota '**' o catch do navigation não funciona.
   *
   * @optional
   *
   * @description
   *
   * Cria automaticamente as rotas de edição (novo/duplicate) e detalhes caso as ações
   * estejam definidas nas ações.
   *
   * > Para o correto funcionamento não pode haver nenhum rota coringa (`**`) especificada.
   *
   * @default false
   */
  set autoRouter(value) {
    this._autoRouter = convertToBoolean(value);
  }
  get autoRouter() {
    return this._autoRouter;
  }
  /** Lista dos campos usados na tabela e busca avançada. */
  set fields(value) {
    this._fields = Array.isArray(value) ? [...value] : [];
    this._keys = this.getKeysByFields(this._fields);
    this._duplicates = this.getDuplicatesByFields(this._fields);
    this._controlFields = this.getControlFields(this._fields);
    this._detailFields = this.getDetailFields(this._fields);
  }
  get fields() {
    return this._fields;
  }
  /**
   * @optional
   *
   * @description
   *
   * Define o tamanho dos componentes de formulário no template:
   * - `small`: aplica a medida small de cada componente (disponível apenas para acessibilidade AA).
   * - `medium`: aplica a medida medium de cada componente.
   *
   * > Caso a acessibilidade AA não esteja configurada, o tamanho `medium` será mantido.
   * Para mais detalhes, consulte a documentação do [po-theme](https://po-ui.io/documentation/po-theme).
   *
   * @default `medium`
   */
  set componentsSize(value) {
    this._componentsSize = validateSizeFn(value);
  }
  get componentsSize() {
    return this._componentsSize ?? getDefaultSizeFn();
  }
  /* eslint-disable max-params */
  constructor() {
    const languageService = inject(PoLanguageService);
    this.language = languageService.getShortLanguage();
  }
  /* eslint-enable max-params */
  ngOnInit() {
    this.loadDataFromAPI();
  }
  ngOnDestroy() {
    if (this.subscriptions) {
      this.subscriptions.forEach((subscription) => {
        subscription.unsubscribe();
      });
    }
  }
  detailActionNew() {
    this.gridDetail.insertRow();
  }
  /**
   * Método que exibe `p-helper` ou executa a ação definida em `p-helper{eventOnClick}` ou em `p-additionalHelp`.
   * Para isso, será necessário configurar uma tecla de atalho utilizando o evento `keydown`.
   *
   * ```
   * import { PoPageDynamicEditModule } from '@po-ui/ng-templates';
   * ...
   * @ViewChild('dynamicEdit', { static: true }) dynamicEdit: PoPageDynamicEditComponent;
   *
   * fields: Array<PoPageDynamicEditField> = [
   *  {
   *    property: 'name',
   *    ...
   *    help: 'Mensagem de ajuda.',
   *    helper: 'Mensagem de ajuda complementar com o componente po-helper implementado.',
   *    keydown: this.onKeyDown.bind(this, 'name')
   *  },
   * ]
   *
   * onKeyDown(property: string, event: KeyboardEvent): void {
   *  if (event.code === 'F9') {
   *    this.dynamicEdit.showAdditionalHelp(property);
   *  }
   * }
   * ```
   *
   * @param { string } property Identificador da coluna.
   */
  showAdditionalHelp(property) {
    this.dynamicForm.showAdditionalHelp(property);
  }
  get duplicates() {
    return [...this._duplicates];
  }
  get keys() {
    return [...this._keys];
  }
  get pageActions() {
    return [...this._pageActions];
  }
  get controlFields() {
    return this._controlFields;
  }
  get detailFields() {
    return this._detailFields;
  }
  loadDataFromAPI() {
    const {
      serviceApi: serviceApiFromRoute,
      serviceMetadataApi,
      serviceLoadApi
    } = this.activatedRoute.snapshot.data;
    const {
      id
    } = this.activatedRoute.snapshot.params;
    const {
      duplicate
    } = this.activatedRoute.snapshot.queryParams;
    const onLoad = serviceLoadApi || this.onLoad;
    this.serviceApi = serviceApiFromRoute || this.serviceApi;
    this.poPageDynamicService.configServiceApi({
      endpoint: this.serviceApi,
      metadata: serviceMetadataApi
    });
    const metadata$ = this.getMetadata(serviceApiFromRoute, id, onLoad);
    const data$ = this.loadData(id, duplicate);
    this.subscriptions.push(concat(metadata$, data$).subscribe());
  }
  cancel(actionCancel, actionBeforeCancel) {
    if (this.dynamicForm && this.dynamicForm.form.dirty) {
      this.poDialogService.confirm({
        message: this.literals.cancelConfirmMessage,
        title: this.literals.pageActionCancel,
        confirm: this.goBack.bind(this, actionCancel, actionBeforeCancel)
      });
    } else {
      this.goBack(actionCancel, actionBeforeCancel);
    }
  }
  formatUniqueKey(item) {
    const keys2 = mapObjectByProperties(item, this.keys);
    return valuesFromObject(keys2).join("|");
  }
  goBack(actionCancel, actionBeforeCancel) {
    this.subscriptions.push(this.poPageDynamicEditActionsService.beforeCancel(actionBeforeCancel).subscribe((beforeCancelResult) => {
      this.executeBackAction(actionCancel, beforeCancelResult?.allowAction, beforeCancelResult?.newUrl);
    }));
  }
  executeBackAction(actionCancel, allowAction, newUrl) {
    const isAllowedAction = typeof allowAction === "boolean" ? allowAction : true;
    if (isAllowedAction) {
      if (actionCancel === void 0 || typeof actionCancel === "boolean") {
        return window.history.back();
      }
      if (typeof actionCancel === "string" || newUrl) {
        return this.router.navigate([newUrl || actionCancel]);
      }
      return actionCancel();
    }
  }
  loadData(id, duplicate) {
    if (!id) {
      try {
        this.model = duplicate ? JSON.parse(duplicate) : {};
      } catch {
        this.model = {};
      }
      return EMPTY;
    }
    return this.poPageDynamicService.getResource(id).pipe(tap((response) => {
      this.beforeSetModel(response);
    }), catchError((error) => {
      this.model = void 0;
      this.actions = void 0;
      this._pageActions = [];
      return throwError(error);
    }));
  }
  beforeSetModel(response) {
    if (!this.onLoadData) {
      this.model = response;
      return;
    }
    const onLoadDataExecution = this.onLoadData(response);
    const onLoadData$ = onLoadDataExecution instanceof Observable ? onLoadDataExecution : of(onLoadDataExecution);
    onLoadData$.subscribe({
      next: (customModel) => {
        this.model = customModel;
      },
      error: () => {
        this.model = response;
      }
    });
  }
  loadOptionsOnInitialize(onLoad) {
    if (onLoad) {
      return this.getPoDynamicPageOptions(onLoad).pipe(tap((responsePoOption) => this.poPageCustomizationService.changeOriginalOptionsToNewOptions(this, responsePoOption)));
    }
    return EMPTY;
  }
  focusCheckboxInput(control) {
    const checkboxGroup = document.querySelector(`po-checkbox-group[ng-reflect-name=${control}]`);
    if (checkboxGroup) {
      const checkBoxComponent = checkboxGroup.querySelector("po-checkbox[ng-reflect-disabled=false]");
      const labelInput = checkBoxComponent?.querySelector(".po-checkbox-outline");
      if (labelInput) {
        labelInput.focus();
      } else {
        this.indexFocus--;
      }
    }
  }
  focusControl(control) {
    const inputElement = document.querySelector(`[name=${control}]`);
    if (inputElement) {
      if (inputElement.tagName === "INPUT") {
        inputElement.focus();
      } else {
        this.focusRadioInput(inputElement, control);
      }
    } else {
      this.focusCheckboxInput(control);
    }
  }
  focusRadioInput(inputElement, control) {
    const radioComponent = inputElement.querySelector(`po-radio[ng-reflect-name=${control}][ng-reflect-disabled=false]`);
    if (radioComponent) {
      const radioInput = radioComponent.querySelector("input");
      radioInput.focus();
      radioInput.parentElement.parentElement.classList.add("po-radio-focus");
    } else {
      this.indexFocus--;
    }
  }
  getPoDynamicPageOptions(onLoad) {
    const originalOption = {
      fields: this.fields,
      actions: this.actions,
      breadcrumb: this.breadcrumb,
      title: this.title
    };
    const pageOptionSchema = {
      schema: [{
        nameProp: "fields",
        merge: true,
        keyForMerge: "property"
      }, {
        nameProp: "actions",
        merge: true
      }, {
        nameProp: "breadcrumb"
      }, {
        nameProp: "title"
      }]
    };
    return this.poPageCustomizationService.getCustomOptions(onLoad, originalOption, pageOptionSchema);
  }
  getMetadata(serviceApiFromRoute, paramId, onLoad) {
    const typeMetadata = paramId ? "edit" : "create";
    if (serviceApiFromRoute) {
      return this.poPageDynamicService.getMetadata(typeMetadata).pipe(tap((response) => {
        this.autoRouter = response.autoRouter || this.autoRouter;
        this.actions = response.actions || this.actions;
        this.breadcrumb = response.breadcrumb || this.breadcrumb;
        this.fields = response.fields || this.fields;
        this.title = response.title || this.title;
      }), switchMap(() => this.loadOptionsOnInitialize(onLoad)));
    }
    return this.loadOptionsOnInitialize(onLoad);
  }
  markControlsAsDirtyAndFocusFirstInvalid() {
    this.indexFocus = 0;
    const controls = Object.keys(this.dynamicForm.form.controls);
    controls.forEach((control) => {
      this.dynamicForm.form.controls[control].markAsDirty();
      if (this.dynamicForm.form.controls[control].hasError("required") && this.indexFocus === 0) {
        this.focusControl(control);
        this.indexFocus++;
      }
    });
  }
  navigateTo(path) {
    if (path) {
      const url = this.resolveUrl(this.model, path);
      this.router.navigate([url]);
    } else {
      window.history.back();
    }
  }
  resolveUniqueKey(item) {
    return this.activatedRoute.snapshot.params["id"] ? this.formatUniqueKey(item) : void 0;
  }
  resolveUrl(item, path) {
    const uniqueKey = this.formatUniqueKey(item);
    return path.replace(/:id/g, uniqueKey);
  }
  executeSave(saveRedirectPath) {
    const saveOperation$ = this.saveOperation();
    return saveOperation$.pipe(tap((message) => {
      this.poNotification.success(message);
      this.navigateTo(saveRedirectPath);
    }));
  }
  updateModel(newResource = {}) {
    if (typeof newResource !== "undefined" && Object.keys(newResource).length !== 0) {
      const dynamicNgForm = this.dynamicForm.form;
      removeKeysProperties(this.keys, newResource);
      this.model = __spreadValues(__spreadValues({}, this.model), newResource);
      dynamicNgForm.form.patchValue(this.model);
    }
  }
  showNotification(type) {
    switch (type) {
      case "warning":
        this.poNotification.warning(this.literals.saveNotificationWarning);
        break;
      case "error":
        this.poNotification.error(this.literals.saveNotificationError);
        break;
    }
  }
  saveOperation() {
    if (this.dynamicForm.form.invalid) {
      this.markControlsAsDirtyAndFocusFirstInvalid();
      this.showNotification(this._notificationType);
      return EMPTY;
    }
    const paramId = this.activatedRoute.snapshot.params["id"];
    const successMsg = paramId ? this.literals.saveNotificationSuccessUpdate : this.literals.saveNotificationSuccessSave;
    const saveOperation$ = paramId ? this.poPageDynamicService.updateResource(paramId, this.model) : this.poPageDynamicService.createResource(this.model);
    return saveOperation$.pipe(map(() => successMsg));
  }
  save(action, before = "beforeSave") {
    const executeOperation = {
      beforeSave: this.executeSave.bind(this),
      beforeSaveNew: this.executeSaveNew.bind(this)
    };
    const uniqueKey = this.resolveUniqueKey(this.model);
    this.subscriptions.push(this.poPageDynamicEditActionsService[before](this.actions[before], uniqueKey, __spreadValues({}, this.model)).pipe(switchMap((returnBefore) => {
      const newAction = returnBefore?.newUrl ?? action;
      const allowAction = returnBefore?.allowAction ?? true;
      this.updateModel(returnBefore?.resource);
      if (!allowAction) {
        return of({});
      }
      if (typeof newAction === "string") {
        return executeOperation[before](newAction);
      } else {
        newAction(__spreadValues({}, this.model), uniqueKey);
        return EMPTY;
      }
    })).subscribe());
  }
  executeSaveNew(path) {
    const paramId = this.activatedRoute.snapshot.params["id"];
    const saveOperation$ = this.saveOperation();
    return saveOperation$.pipe(tap((message) => {
      if (paramId) {
        this.poNotification.success(message);
        this.navigateTo(path);
      } else {
        this.poNotification.success(message);
        this.model = {};
        this.dynamicForm.form.reset();
      }
    }));
  }
  getKeysByFields(fields = []) {
    return fields.filter((field) => field.key === true).map((field) => field.property);
  }
  getControlFields(fields = []) {
    return fields.filter((field) => field.type !== "detail");
  }
  getDetailFields(fields = []) {
    return fields.filter((field) => field.type === "detail");
  }
  getDuplicatesByFields(fields = []) {
    return fields.filter((field) => field.duplicate === true).map((field) => field.property);
  }
  getPageActions(actions = {}) {
    const pageActions = [{
      label: this.literals.pageActionSave,
      action: this.save.bind(this, actions.save)
    }];
    if (actions.saveNew) {
      pageActions.push({
        label: this.literals.pageActionSaveNew,
        action: this.save.bind(this, actions.saveNew, "beforeSaveNew")
      });
    }
    if (actions.cancel === void 0 || actions.cancel) {
      pageActions.push({
        label: this.literals.pageActionCancel,
        action: this.cancel.bind(this, actions.cancel, this.actions.beforeCancel)
      });
    }
    return pageActions;
  }
  isObject(value) {
    return !!value && typeof value === "object" && !Array.isArray(value);
  }
  static \u0275fac = function PoPageDynamicEditComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicEditComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageDynamicEditComponent,
    selectors: [["po-page-dynamic-edit"]],
    viewQuery: function PoPageDynamicEditComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c10, 5);
        \u0275\u0275viewQuery(_c11, 5);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.dynamicForm = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.gridDetail = _t.first);
      }
    },
    inputs: {
      breadcrumb: [0, "p-breadcrumb", "breadcrumb"],
      serviceApi: [0, "p-service-api", "serviceApi"],
      title: [0, "p-title", "title"],
      onLoad: [0, "p-load", "onLoad"],
      onLoadData: [0, "p-load-data", "onLoadData"],
      actions: [0, "p-actions", "actions"],
      literals: [0, "p-literals", "literals"],
      notificationType: [0, "p-notification-type", "notificationType"],
      autoRouter: [0, "p-auto-router", "autoRouter"],
      fields: [0, "p-fields", "fields"],
      componentsSize: [0, "p-components-size", "componentsSize"]
    },
    standalone: false,
    features: [\u0275\u0275ProvidersFeature([PoPageDynamicService])],
    decls: 3,
    vars: 5,
    consts: [["dynamicForm", ""], ["gridDetail", ""], [3, "p-actions", "p-breadcrumb", "p-components-size", "p-title"], [3, "p-size"], [3, "p-components-size", "p-fields", "p-value"], [1, "po-sm-12"], [3, "p-label"], [1, "po-row", "po-mb-2"], [3, "p-click", "p-size", "p-label"], [3, "p-row-actions", "p-columns", "p-data"], ["p-icon", "ICON_INFO"], [1, "po-font-text-large"]],
    template: function PoPageDynamicEditComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "po-page-default", 2);
        \u0275\u0275template(1, PoPageDynamicEditComponent_Conditional_1_Template, 3, 4)(2, PoPageDynamicEditComponent_Conditional_2_Template, 4, 2, "po-widget", 3);
        \u0275\u0275elementEnd();
      }
      if (rf & 2) {
        \u0275\u0275property("p-actions", ctx.pageActions)("p-breadcrumb", ctx.breadcrumb)("p-components-size", ctx.componentsSize)("p-title", ctx.title);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.model ? 1 : 2);
      }
    },
    dependencies: [PoButtonComponent, PoDividerComponent, PoDynamicFormComponent, PoGridComponent, PoIconComponent, PoPageDefaultComponent, PoWidgetComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicEditComponent, [{
    type: Component,
    args: [{
      selector: "po-page-dynamic-edit",
      providers: [PoPageDynamicService],
      standalone: false,
      template: '<po-page-default\n  [p-actions]="pageActions"\n  [p-breadcrumb]="breadcrumb"\n  [p-components-size]="componentsSize"\n  [p-title]="title"\n>\n  @if (model) {\n    <po-dynamic-form #dynamicForm [p-components-size]="componentsSize" [p-fields]="controlFields" [p-value]="model">\n    </po-dynamic-form>\n    @if (detailFields.length > 0) {\n      <div class="po-sm-12">\n        <po-divider [p-label]="detailFields[0].divider"></po-divider>\n        <div class="po-row po-mb-2">\n          <po-button\n            [p-size]="componentsSize"\n            [p-label]="literals.detailActionNew"\n            (p-click)="detailActionNew()"\n          ></po-button>\n        </div>\n        <po-grid\n          #gridDetail\n          [p-row-actions]="detailActions"\n          [p-columns]="detailFields[0].detail.columns"\n          [p-data]="model[detailFields[0].property]"\n        >\n        </po-grid>\n      </div>\n    }\n  } @else {\n    <po-widget [p-size]="componentsSize">\n      <po-icon p-icon="ICON_INFO"></po-icon>\n      <span class="po-font-text-large">\n        {{ literals.registerNotFound }}\n      </span>\n    </po-widget>\n  }\n</po-page-default>\n'
    }]
  }], () => [], {
    dynamicForm: [{
      type: ViewChild,
      args: ["dynamicForm"]
    }],
    gridDetail: [{
      type: ViewChild,
      args: ["gridDetail"]
    }],
    breadcrumb: [{
      type: Input,
      args: ["p-breadcrumb"]
    }],
    serviceApi: [{
      type: Input,
      args: ["p-service-api"]
    }],
    title: [{
      type: Input,
      args: ["p-title"]
    }],
    onLoad: [{
      type: Input,
      args: ["p-load"]
    }],
    onLoadData: [{
      type: Input,
      args: ["p-load-data"]
    }],
    actions: [{
      type: Input,
      args: ["p-actions"]
    }],
    literals: [{
      type: Input,
      args: ["p-literals"]
    }],
    notificationType: [{
      type: Input,
      args: ["p-notification-type"]
    }],
    autoRouter: [{
      type: Input,
      args: ["p-auto-router"]
    }],
    fields: [{
      type: Input,
      args: ["p-fields"]
    }],
    componentsSize: [{
      type: Input,
      args: ["p-components-size"]
    }]
  });
})();
var PoPageDynamicEditModule = class _PoPageDynamicEditModule {
  static \u0275fac = function PoPageDynamicEditModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicEditModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoPageDynamicEditModule,
    declarations: [PoPageDynamicEditComponent],
    imports: [CommonModule, FormsModule, RouterModule, PoButtonModule, PoDividerModule, PoDynamicModule, PoGridModule, PoIconModule, PoPageModule, PoWidgetModule, PoPageDynamicModule],
    exports: [PoPageDynamicEditComponent]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    imports: [CommonModule, FormsModule, RouterModule, PoButtonModule, PoDividerModule, PoDynamicModule, PoGridModule, PoIconModule, PoPageModule, PoWidgetModule, PoPageDynamicModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicEditModule, [{
    type: NgModule,
    args: [{
      imports: [CommonModule, FormsModule, RouterModule, PoButtonModule, PoDividerModule, PoDynamicModule, PoGridModule, PoIconModule, PoPageModule, PoWidgetModule, PoPageDynamicModule],
      declarations: [PoPageDynamicEditComponent],
      exports: [PoPageDynamicEditComponent]
    }]
  }], null, null);
})();
var PoPageCustomizationModule = class _PoPageCustomizationModule {
  static \u0275fac = function PoPageCustomizationModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageCustomizationModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoPageCustomizationModule,
    imports: [CommonModule]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    providers: [PoPageCustomizationService],
    imports: [CommonModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageCustomizationModule, [{
    type: NgModule,
    args: [{
      imports: [CommonModule],
      providers: [PoPageCustomizationService]
    }]
  }], null, null);
})();
var poAdvancedFiltersLiteralsDefault = {
  en: {
    title: "Advanced search",
    cancelLabel: "Cancel",
    confirmLabel: "Apply filters"
  },
  es: {
    title: "B\xFAsqueda avanzada",
    cancelLabel: "Cancelar",
    confirmLabel: "Aplicar filtros"
  },
  pt: {
    title: "Busca avan\xE7ada",
    cancelLabel: "Cancelar",
    confirmLabel: "Aplicar filtros"
  },
  ru: {
    title: "\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043D\u043D\u044B\u0439 \u043F\u043E\u0438\u0441\u043A",
    cancelLabel: "\u043E\u0442\u043C\u0435\u043D\u0438\u0442\u044C",
    confirmLabel: "\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C \u0444\u0438\u043B\u044C\u0442\u0440\u044B"
  }
};
var PoAdvancedFilterBaseComponent = class _PoAdvancedFilterBaseComponent {
  poModal;
  /**
   * Mantém na modal de busca avançada os valores preenchidos do último filtro realizado pelo usuário.
   */
  keepFilters = false;
  /** Função que será disparada e receberá os valores do formulário ao ser clicado no botão buscar. */
  searchEvent = new EventEmitter();
  filter = {};
  language = poLocaleDefault;
  primaryAction = {
    action: () => {
      const models = this.getValuesFromForm();
      this.searchEvent.emit(models);
      this.poModal.close();
    },
    label: this.literals.confirmLabel
  };
  secondaryAction = {
    action: () => {
      this.poModal.close();
    },
    label: this.literals.cancelLabel
  };
  optionsServiceChosenOptions = [];
  _componentsSize = void 0;
  _filters = [];
  _literals;
  /**
   * @optional
   *
   * @description
   *
   * Define o tamanho dos componentes de formulário no template:
   * - `small`: aplica a medida small de cada componente (disponível apenas para acessibilidade AA).
   * - `medium`: aplica a medida medium de cada componente.
   *
   * > Caso a acessibilidade AA não esteja configurada, o tamanho `medium` será mantido.
   * Para mais detalhes, consulte a documentação do [po-theme](https://po-ui.io/documentation/po-theme).
   *
   * @default `medium`
   */
  set componentsSize(value) {
    this._componentsSize = validateSizeFn(value);
  }
  get componentsSize() {
    return this._componentsSize ?? getDefaultSizeFn();
  }
  /**
   * Coleção de objetos que implementam a interface PoPageDynamicSearchFilters, para definição dos campos que serão criados
   * dinamicamente.
   */
  set filters(filters) {
    this._filters = Array.isArray(filters) ? [...filters] : [];
  }
  get filters() {
    return this._filters;
  }
  /** Objeto com as literais usadas no `po-advanced-filter`. */
  set literals(value) {
    if (value instanceof Object && !(value instanceof Array)) {
      this._literals = __spreadValues(__spreadValues(__spreadValues({}, poAdvancedFiltersLiteralsDefault[poLocaleDefault]), poAdvancedFiltersLiteralsDefault[this.language]), value);
    } else {
      this._literals = poAdvancedFiltersLiteralsDefault[this.language];
    }
    this.primaryAction.label = this.literals.confirmLabel;
    this.secondaryAction.label = this.literals.cancelLabel;
  }
  get literals() {
    return this._literals || poAdvancedFiltersLiteralsDefault[this.language];
  }
  constructor(languageService) {
    this.language = languageService.getShortLanguage();
  }
  // Retorna os models dos campos preenchidos
  getValuesFromForm() {
    let optionServiceOptions;
    Object.keys(this.filter).forEach((property) => {
      if (this.filter[property] === void 0 || this.filter[property] === "") {
        delete this.filter[property];
      }
    });
    if (this.optionsServiceChosenOptions.length) {
      optionServiceOptions = this.optionsServiceChosenOptions.filter((optionItem) => Object.values(this.filter).includes(optionItem.value));
    }
    return {
      filter: this.filter,
      optionsService: optionServiceOptions
    };
  }
  static \u0275fac = function PoAdvancedFilterBaseComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoAdvancedFilterBaseComponent)(\u0275\u0275directiveInject(PoLanguageService));
  };
  static \u0275dir = /* @__PURE__ */ \u0275\u0275defineDirective({
    type: _PoAdvancedFilterBaseComponent,
    viewQuery: function PoAdvancedFilterBaseComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(PoModalComponent, 7);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.poModal = _t.first);
      }
    },
    inputs: {
      keepFilters: [2, "p-keep-filters", "keepFilters", convertToBoolean],
      componentsSize: [0, "p-components-size", "componentsSize"],
      filters: [0, "p-filters", "filters"],
      literals: [0, "p-literals", "literals"]
    },
    outputs: {
      searchEvent: "p-search-event"
    }
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoAdvancedFilterBaseComponent, [{
    type: Directive
  }], () => [{
    type: PoLanguageService
  }], {
    poModal: [{
      type: ViewChild,
      args: [PoModalComponent, {
        static: true
      }]
    }],
    keepFilters: [{
      type: Input,
      args: [{
        alias: "p-keep-filters",
        transform: convertToBoolean
      }]
    }],
    searchEvent: [{
      type: Output,
      args: ["p-search-event"]
    }],
    componentsSize: [{
      type: Input,
      args: ["p-components-size"]
    }],
    filters: [{
      type: Input,
      args: ["p-filters"]
    }],
    literals: [{
      type: Input,
      args: ["p-literals"]
    }]
  });
})();
var PoAdvancedFilterComponent = class _PoAdvancedFilterComponent extends PoAdvancedFilterBaseComponent {
  poDynamicForm;
  subscription = new Subscription();
  constructor() {
    const languageService = inject(PoLanguageService);
    super(languageService);
  }
  ngOnInit() {
    this.optionsServiceSubscribe();
  }
  ngOnDestroy() {
    this.subscription.unsubscribe();
  }
  open() {
    this.filter = this.keepFilters ? this.getInitialValuesFromFilter(this.filters) : {};
    this.poModal.open();
  }
  getOptionsServiceItem(optionServiceObject) {
    const objectItem = this.optionsServiceChosenOptions.map((option) => option.value).indexOf(optionServiceObject.value);
    if (objectItem === -1) {
      this.optionsServiceChosenOptions = [...this.optionsServiceChosenOptions, optionServiceObject];
    }
  }
  getInitialValuesFromFilter(filters) {
    return filters.reduce((result, item) => Object.assign(result, {
      [item.property]: item.initValue
    }), {});
  }
  // Se inscreve para receber valores referentes a campos do tipo combo.
  optionsServiceSubscribe() {
    this.subscription.add(this.poDynamicForm.getObjectValue().subscribe((optionServiceObject) => {
      if (optionServiceObject) {
        this.getOptionsServiceItem(optionServiceObject);
      }
    }));
  }
  static \u0275fac = function PoAdvancedFilterComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoAdvancedFilterComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoAdvancedFilterComponent,
    selectors: [["po-advanced-filter"]],
    viewQuery: function PoAdvancedFilterComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(PoDynamicFormComponent, 7);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.poDynamicForm = _t.first);
      }
    },
    standalone: false,
    features: [\u0275\u0275InheritDefinitionFeature],
    decls: 2,
    vars: 7,
    consts: [["p-hide-close", "", 3, "p-primary-action", "p-secondary-action", "p-components-size", "p-title"], [3, "p-components-size", "p-fields", "p-value"]],
    template: function PoAdvancedFilterComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "po-modal", 0);
        \u0275\u0275element(1, "po-dynamic-form", 1);
        \u0275\u0275elementEnd();
      }
      if (rf & 2) {
        \u0275\u0275property("p-primary-action", ctx.primaryAction)("p-secondary-action", ctx.secondaryAction)("p-components-size", ctx.componentsSize)("p-title", ctx.literals.title);
        \u0275\u0275advance();
        \u0275\u0275property("p-components-size", ctx.componentsSize)("p-fields", ctx.filters)("p-value", ctx.filter);
      }
    },
    dependencies: [PoDynamicFormComponent, PoModalComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoAdvancedFilterComponent, [{
    type: Component,
    args: [{
      selector: "po-advanced-filter",
      standalone: false,
      template: '<po-modal\n  p-hide-close\n  [p-primary-action]="primaryAction"\n  [p-secondary-action]="secondaryAction"\n  [p-components-size]="componentsSize"\n  [p-title]="literals.title"\n>\n  <po-dynamic-form [p-components-size]="componentsSize" [p-fields]="filters" [p-value]="filter"> </po-dynamic-form>\n</po-modal>\n'
    }]
  }], () => [], {
    poDynamicForm: [{
      type: ViewChild,
      args: [PoDynamicFormComponent, {
        static: true
      }]
    }]
  });
})();
var poPageDynamicSearchLiteralsDefault = {
  en: {
    disclaimerGroupTitle: "Displaying results filtered by:",
    filterTitle: poAdvancedFiltersLiteralsDefault.en.title,
    filterCancelLabel: poAdvancedFiltersLiteralsDefault.en.cancelLabel,
    filterConfirmLabel: poAdvancedFiltersLiteralsDefault.en.confirmLabel,
    quickSearchLabel: "Quick search:",
    searchPlaceholder: "Search"
  },
  es: {
    disclaimerGroupTitle: "Presentando resultados filtrados por:",
    filterTitle: poAdvancedFiltersLiteralsDefault.es.title,
    filterCancelLabel: poAdvancedFiltersLiteralsDefault.es.cancelLabel,
    filterConfirmLabel: poAdvancedFiltersLiteralsDefault.es.confirmLabel,
    quickSearchLabel: "B\xFAsqueda r\xE1pida:",
    searchPlaceholder: "Buscar"
  },
  pt: {
    disclaimerGroupTitle: "Apresentando resultados filtrados por:",
    filterTitle: poAdvancedFiltersLiteralsDefault.pt.title,
    filterCancelLabel: poAdvancedFiltersLiteralsDefault.pt.cancelLabel,
    filterConfirmLabel: poAdvancedFiltersLiteralsDefault.pt.confirmLabel,
    quickSearchLabel: "Pesquisa r\xE1pida:",
    searchPlaceholder: "Pesquisar"
  },
  ru: {
    disclaimerGroupTitle: "\u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u043E\u0432, \u043E\u0442\u0444\u0438\u043B\u044C\u0442\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0445 \u043F\u043E:",
    filterTitle: poAdvancedFiltersLiteralsDefault.ru.title,
    filterCancelLabel: poAdvancedFiltersLiteralsDefault.ru.cancelLabel,
    filterConfirmLabel: poAdvancedFiltersLiteralsDefault.ru.confirmLabel,
    quickSearchLabel: "\u0411\u044B\u0441\u0442\u0440\u044B\u0439 \u043F\u043E\u0438\u0441\u043A:",
    searchPlaceholder: "\u0438\u0441\u0441\u043B\u0435\u0434\u043E\u0432\u0430\u043D\u0438\u0435"
  }
};
var PoPageDynamicSearchBaseComponent = class _PoPageDynamicSearchBaseComponent {
  /** Nesta propriedade deve ser definido um array de objetos que implementam a interface `PoPageAction`. */
  actions = [];
  /** Objeto com propriedades do breadcrumb. */
  breadcrumb = {
    items: []
  };
  /**
   * @optional
   *
   * @description
   *
   * Mantém na busca avançada os valores preenchidos do último filtro realizado pelo usuário.
   *
   * @default `false`
   */
  keepFilters = false;
  /**
   * @optional
   *
   * @description
   *
   * Permite a utilização da pesquisa rápida junto com a pesquisa avançada.
   *
   * Desta forma, ao ter uma pesquisa avançada estabelecida e ser
   * preenchido a pesquisa rápida, o filtro será concatenado adicionando a pesquisa
   * rápida também na lista de `disclaimers`.
   *
   * > Os valores que são emitidos no `p-quick-search` e no `p-advanced-search`
   * permanecem separados durante a emissão dos valores alterados. A concatenação
   * é apenas nos `disclaimers`.
   *
   * @default `false`
   */
  concatFilters = false;
  /**
   * @optional
   *
   * @description
   *
   * Oculta o botão para remover todos os *disclaimers* do grupo.
   *
   * > Por padrão, o mesmo é exibido à partir de dois ou mais *disclaimers* com a opção `hideClose` habilitada.
   *
   * @default `false`
   */
  hideRemoveAllDisclaimer = false;
  /**
   * Função ou serviço que será executado na inicialização do componente.
   *
   * A propriedade aceita os seguintes tipos:
   * - `string`: *Endpoint* usado pelo componente para requisição via `POST`.
   * - `function`: Método que será executado.
   *
   * O retorno desta função deve ser do tipo `PoPageDynamicSearchOptions`,
   * onde o usuário poderá customizar novos filtros, breadcrumb, title e actions
   *
   * Por exemplo:
   *
   * ```
   * getPageOptions(): PoPageDynamicSearchOptions {
   * return {
   *   actions: [
   *     { label: 'Find on Google' },
   *   ],
   *   filters: [
   *     { property: 'idCard', gridColumns: 6 }
   *   ]
   * };
   * }
   *
   * ```
   * Para referenciar a sua função utilize a propriedade `bind`, por exemplo:
   * ```
   *  [p-load]="onLoadOptions.bind(this)"
   * ```
   */
  onLoad;
  /** Título da página. */
  title;
  /**
   * @optional
   *
   * @description
   *
   * Valor padrão na busca rápida ao inicializar o componente
   *
   */
  quickSearchValue;
  _visibleFixedFilters = true;
  /**
   * @optional
   *
   * @description
   *
   * Controla a visibilidade dos filtros fixos na página.
   *
   * - Quando `true` (default), todos os filtros, incluindo os fixos, são exibidos, permitindo que o usuário visualize os filtros aplicados.
   * - Quando `false`, os filtros fixos são ocultados, não sendo exibidos na interface, mas ainda sendo aplicados como filtros nas requisições.
   *
   * Esta propriedade trabalha em conjunto com a propriedade `fixed` dos filtros individuais. Filtros marcados como `fixed: true` não serão exibidos na interface do filtro avançado quando `visibleFixedFilters` for `false`, mas continuarão a ser aplicados de forma transparente ao usuário. Dessa forma, permite-se maior flexibilidade no controle de quais filtros devem ser visíveis ao usuário ou devem ser aplicados permanentemente sem interferência.
   *
   * **Exemplo de uso:**
   * ```html
   * <!-- Para ocultar os filtros fixos -->
   * <po-page-dynamic-table [p-visible-fixed-filters]="false"></po-page-dynamic-table>
   * ```
   */
  set visibleFixedFilters(visible) {
    this._visibleFixedFilters = visible;
  }
  get visibleFixedFilters() {
    return this._visibleFixedFilters;
  }
  /**
   * @optional
   *
   * @description
   *
   * Evento disparado ao executar a pesquisa avançada, o mesmo irá repassar um objeto com os valores preenchidos no modal de pesquisa.
   *
   * > Campos não preenchidos não irão aparecer no objeto passado por parâmetro.
   */
  advancedSearch = new EventEmitter();
  /**
   * @optional
   *
   * @description
   *
   * Evento disparado ao remover um ou todos os disclaimers pelo usuário.
   */
  changeDisclaimers = new EventEmitter();
  /**
   * @optional
   *
   * @description
   *
   * Evento disparado ao realizar uma busca pelo campo de pesquisa rápida, o mesmo será chamado repassando o valor digitado.
   */
  quickSearch = new EventEmitter();
  advancedFilterLiterals;
  _componentsSize = void 0;
  _filters = [];
  _hideCloseDisclaimers = [];
  _literals;
  _quickSearchWidth;
  language;
  previousFilters;
  /**
   * @optional
   *
   * @description
   *
   * Define o tamanho dos componentes de formulário no template:
   * - `small`: aplica a medida small de cada componente (disponível apenas para acessibilidade AA).
   * - `medium`: aplica a medida medium de cada componente.
   *
   * > Caso a acessibilidade AA não esteja configurada, o tamanho `medium` será mantido.
   * Para mais detalhes, consulte a documentação do [po-theme](https://po-ui.io/documentation/po-theme).
   *
   * @default `medium`
   */
  set componentsSize(value) {
    this._componentsSize = validateSizeFn(value);
  }
  get componentsSize() {
    return this._componentsSize ?? getDefaultSizeFn();
  }
  /**
   * @optional
   *
   * @description
   *
   * Objeto com as literais usadas no `po-page-dynamic-search`.
   *
   * Existem duas maneiras de customizar o componente, passando um objeto com todas as literais disponíveis:
   *
   * ```
   *  const customLiterals: PoPageDynamicSearchLiterals = {
   *    disclaimerGroupTitle: 'Filtros aplicados:',
   *    filterTitle: 'Filtro avançado',
   *    filterCancelLabel: 'Fechar',
   *    filterConfirmLabel: 'Aplicar',
   *    quickSearchLabel: 'Valor pesquisado:',
   *    searchPlaceholder: 'Pesquise aqui'
   *  };
   * ```
   *
   * Ou passando apenas as literais que deseja customizar:
   *
   * ```
   *  const customLiterals: PoPageDynamicSearchLiterals = {
   *    filterTitle: 'Filtro avançado'
   *  };
   * ```
   *
   * E para carregar as literais customizadas, basta apenas passar o objeto para o componente.
   *
   * ```
   * <po-page-dynamic-search
   *   [p-literals]="customLiterals">
   * </po-page-dynamic-search>
   * ```
   *
   * > O valor padrão será traduzido de acordo com o idioma configurado no [`PoI18nService`](/documentation/po-i18n) ou *browser*.
   */
  set literals(value) {
    if (value instanceof Object && !(value instanceof Array)) {
      this._literals = __spreadValues(__spreadValues(__spreadValues({}, poPageDynamicSearchLiteralsDefault[poLocaleDefault]), poPageDynamicSearchLiteralsDefault[this.language]), value);
    } else {
      this._literals = poPageDynamicSearchLiteralsDefault[this.language];
    }
    this.setAdvancedFilterLiterals(this.literals);
  }
  get literals() {
    return this._literals || poPageDynamicSearchLiteralsDefault[this.language];
  }
  /**
   * @optional
   *
   * @description
   *
   * Lista dos campos usados na busca avançada. Caso o mesmo não seja passado a busca avançada não será exibida.
   */
  set filters(filters) {
    this._filters = Array.isArray(filters) ? [...filters] : [];
  }
  get filters() {
    return this._filters;
  }
  /**
   * @optional
   *
   * @description
   *
   * Largura do campo de busca, utilizando o *Grid System*,
   * e limitado ao máximo de 6 colunas. O tamanho mínimo é controlado
   * conforme resolução de tela para manter a consistência do layout.
   */
  set quickSearchWidth(value) {
    this._quickSearchWidth = convertToInt(value);
  }
  get quickSearchWidth() {
    return this._quickSearchWidth;
  }
  /**
   * @optional
   *
   * @description
   *
   * Lista de filtros que terão a opção de fechar ocultada
   * em seu respectivo disclaimer. Utilizar o atributo `property` do filtro.
   *
   * Exemplo de utilização:
   * ```
   * ['city','name'];
   * ```
   */
  set hideCloseDisclaimers(value) {
    this._hideCloseDisclaimers = Array.isArray(value) ? value : [];
  }
  get hideCloseDisclaimers() {
    return this._hideCloseDisclaimers;
  }
  constructor(languageService) {
    this.language = languageService.getShortLanguage();
  }
  setAdvancedFilterLiterals(literals) {
    this.advancedFilterLiterals = {
      cancelLabel: literals.filterCancelLabel,
      confirmLabel: literals.filterConfirmLabel,
      title: literals.filterTitle
    };
  }
  stringify(columns) {
    return JSON.stringify(columns, (key, value) => {
      if (key !== "searchService") {
        return value;
      }
    });
  }
  static \u0275fac = function PoPageDynamicSearchBaseComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicSearchBaseComponent)(\u0275\u0275directiveInject(PoLanguageService));
  };
  static \u0275dir = /* @__PURE__ */ \u0275\u0275defineDirective({
    type: _PoPageDynamicSearchBaseComponent,
    inputs: {
      actions: [0, "p-actions", "actions"],
      breadcrumb: [0, "p-breadcrumb", "breadcrumb"],
      keepFilters: [2, "p-keep-filters", "keepFilters", convertToBoolean],
      concatFilters: [2, "p-concat-filters", "concatFilters", convertToBoolean],
      hideRemoveAllDisclaimer: [2, "p-hide-remove-all-disclaimer", "hideRemoveAllDisclaimer", convertToBoolean],
      onLoad: [0, "p-load", "onLoad"],
      title: [0, "p-title", "title"],
      quickSearchValue: [0, "p-quick-search-value", "quickSearchValue"],
      visibleFixedFilters: [0, "p-visible-fixed-filters", "visibleFixedFilters"],
      componentsSize: [0, "p-components-size", "componentsSize"],
      literals: [0, "p-literals", "literals"],
      filters: [0, "p-filters", "filters"],
      quickSearchWidth: [0, "p-quick-search-width", "quickSearchWidth"],
      hideCloseDisclaimers: [0, "p-hide-close-disclaimers", "hideCloseDisclaimers"]
    },
    outputs: {
      advancedSearch: "p-advanced-search",
      changeDisclaimers: "p-change-disclaimers",
      quickSearch: "p-quick-search"
    }
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicSearchBaseComponent, [{
    type: Directive
  }], () => [{
    type: PoLanguageService
  }], {
    actions: [{
      type: Input,
      args: ["p-actions"]
    }],
    breadcrumb: [{
      type: Input,
      args: ["p-breadcrumb"]
    }],
    keepFilters: [{
      type: Input,
      args: [{
        alias: "p-keep-filters",
        transform: convertToBoolean
      }]
    }],
    concatFilters: [{
      type: Input,
      args: [{
        alias: "p-concat-filters",
        transform: convertToBoolean
      }]
    }],
    hideRemoveAllDisclaimer: [{
      type: Input,
      args: [{
        alias: "p-hide-remove-all-disclaimer",
        transform: convertToBoolean
      }]
    }],
    onLoad: [{
      type: Input,
      args: ["p-load"]
    }],
    title: [{
      type: Input,
      args: ["p-title"]
    }],
    quickSearchValue: [{
      type: Input,
      args: ["p-quick-search-value"]
    }],
    visibleFixedFilters: [{
      type: Input,
      args: ["p-visible-fixed-filters"]
    }],
    advancedSearch: [{
      type: Output,
      args: ["p-advanced-search"]
    }],
    changeDisclaimers: [{
      type: Output,
      args: ["p-change-disclaimers"]
    }],
    quickSearch: [{
      type: Output,
      args: ["p-quick-search"]
    }],
    componentsSize: [{
      type: Input,
      args: ["p-components-size"]
    }],
    literals: [{
      type: Input,
      args: ["p-literals"]
    }],
    filters: [{
      type: Input,
      args: ["p-filters"]
    }],
    quickSearchWidth: [{
      type: Input,
      args: ["p-quick-search-width"]
    }],
    hideCloseDisclaimers: [{
      type: Input,
      args: ["p-hide-close-disclaimers"]
    }]
  });
})();
var PoPageDynamicSearchComponent = class _PoPageDynamicSearchComponent extends PoPageDynamicSearchBaseComponent {
  languageService;
  poPageCustomizationService = inject(PoPageCustomizationService);
  changeDetector = inject(ChangeDetectorRef);
  poAdvancedFilter;
  poPageList;
  loadSubscription;
  _disclaimerGroup = {
    remove: this.onRemoveDisclaimer.bind(this),
    removeAll: this.onRemoveAllDisclaimers.bind(this),
    disclaimers: [],
    title: this.literals.disclaimerGroupTitle,
    hideRemoveAll: this.hideRemoveAllDisclaimer
  };
  _filterSettings = {
    action: this.onAction.bind(this),
    advancedAction: this.onAdvancedAction.bind(this),
    placeholder: this.literals.searchPlaceholder,
    width: this.quickSearchWidth
  };
  constructor() {
    const languageService = inject(PoLanguageService);
    super(languageService);
    this.languageService = languageService;
  }
  get disclaimerGroup() {
    return Object.assign({}, this._disclaimerGroup, {
      title: this.literals.disclaimerGroupTitle,
      hideRemoveAll: this.hideRemoveAllDisclaimer
    });
  }
  get filterSettings() {
    const thereAreValidFilters = this.filters.length > 0 && this.filters.some((filter) => filter.visible === true || filter.visible === void 0);
    this._filterSettings.advancedAction = thereAreValidFilters ? this.onAdvancedAction.bind(this) : void 0;
    return Object.assign({}, this._filterSettings, {
      placeholder: this.literals.searchPlaceholder,
      width: this.quickSearchWidth
    });
  }
  ngOnInit() {
    this.setAdvancedFilterLiterals(this.literals);
    if (this.onLoad) {
      this.loadOptionsOnInitialize(this.onLoad);
    }
    if (this.quickSearchValue) {
      this.onAction(this.quickSearchValue, true);
    }
  }
  ngOnDestroy() {
    if (this.loadSubscription) {
      this.loadSubscription.unsubscribe();
    }
  }
  ngAfterViewInit() {
    if (this.stringify(this.filters) !== this.stringify(this.previousFilters)) {
      this.onChangeFilters(this.filters);
      this.previousFilters = [...this.filters];
    }
  }
  ngOnChanges(changes) {
    const visibleFixedFilters = changes.visibleFixedFilters;
    if (visibleFixedFilters && visibleFixedFilters.currentValue !== visibleFixedFilters.previousValue && this.filters.some((filter) => filter.fixed)) {
      this.onChangeFilters(this.filters);
      this.previousFilters = [...this.filters];
    }
  }
  onChangeFilters(filters) {
    const filterObjectWithValue = filters.filter((filter) => filter.initValue).reduce((prev, current) => __spreadValues(__spreadValues({}, prev), {
      [current.property]: current.initValue
    }), {});
    if (Object.keys(filterObjectWithValue).length) {
      this.onAdvancedSearch({
        filter: filterObjectWithValue
      });
    }
  }
  onAction(quickFilter, quickSearchValue) {
    const disclaimerQuickSearchUpdated = {
      property: "search",
      label: `${this.literals.quickSearchLabel} ${quickFilter}`,
      value: quickFilter,
      hideClose: this.hideCloseDisclaimers.some((hideCloseDisclaimer) => hideCloseDisclaimer === "search") || false
    };
    const getDisclaimersWithConcatFilters = () => [...this.getDisclaimersWithoutQuickSearch(), disclaimerQuickSearchUpdated];
    this._disclaimerGroup.disclaimers = this.concatFilters ? getDisclaimersWithConcatFilters() : [disclaimerQuickSearchUpdated];
    if (this.quickSearch.observers && this.quickSearch.observers.length > 0 && !quickSearchValue) {
      this.quickSearch.emit(quickFilter);
    }
    if (this.keepFilters && !this.concatFilters) {
      this.filters.forEach((element) => delete element.initValue);
    }
    this.changeDetector.detectChanges();
  }
  onAdvancedAction() {
    this.poAdvancedFilter.open();
  }
  onAdvancedSearch(filteredItems, isAdvancedSearch) {
    const {
      optionsService
    } = filteredItems;
    let {
      filter
    } = filteredItems;
    const visibleFilters = this.visibleFixedFilters === false ? this.filters.filter((filter2) => !("fixed" in filter2) || !filter2.fixed) : this.filters;
    this._disclaimerGroup.disclaimers = this.setDisclaimers(filter, optionsService, visibleFilters);
    this.setFilters(filter);
    filter = this.addComplexFilter(filter);
    this.advancedSearch.emit(filter);
    if (isAdvancedSearch) {
      this.poPageList.clearInputSearch();
    }
  }
  getDisclaimersWithoutQuickSearch() {
    const quickSearchProperty = "search";
    return this._disclaimerGroup.disclaimers.filter((item) => item.property !== quickSearchProperty);
  }
  setFilters(filters) {
    const formattedFilters = this.convertToFilters(filters);
    this.filters.forEach((element) => {
      const compatibleObject = formattedFilters.find((item) => item.property === element.property);
      if (compatibleObject) {
        element.initValue = compatibleObject.value;
      } else {
        delete element.initValue;
      }
    });
  }
  convertToFilters(filters) {
    return Object.entries(filters).map(([property, value]) => ({
      property,
      value
    }));
  }
  optionsServiceDisclaimerLabel(value, optionsServiceObjectsList) {
    const optionServiceMatch = optionsServiceObjectsList.find((option) => option.value === value);
    return optionServiceMatch.label || optionServiceMatch.value;
  }
  applyDisclaimerLabelValue(field, filterValue) {
    const values = Array.isArray(filterValue) ? filterValue : [filterValue];
    const labels = values.map((value) => {
      const filteredField = field.options.find((option) => option.value === value || option === value);
      if (filteredField) {
        return filteredField.label || filteredField.value || filteredField;
      }
    });
    return labels.join(", ");
  }
  formatDate(date) {
    const year = parseInt(date.substr(0, 4), 10);
    const month = parseInt(date.substr(5, 2), 10);
    const day = parseInt(date.substr(8, 2), 10);
    return new Date(year, month - 1, day).toLocaleDateString(getBrowserLanguage());
  }
  formatArrayToObjectKeyValue(filters) {
    const formattedObject = filters.reduce((result, item) => Object.assign(result, {
      [item.property]: item.value || item.initValue
    }), {});
    Object.keys(formattedObject).forEach((key) => {
      if (!formattedObject[key]) {
        delete formattedObject[key];
      }
    });
    return formattedObject;
  }
  formatValueToCurrency(field, value) {
    const language = this.languageService.getLanguage();
    return new Intl.NumberFormat(field.locale ? field.locale : language, {
      minimumFractionDigits: 2
    }).format(value);
  }
  getFieldByProperty(fields, fieldName) {
    return fields.find((field) => field.property === fieldName);
  }
  getFilterValueToDisclaimer(field, value, optionsServiceObjectsList) {
    if (field.optionsService && optionsServiceObjectsList) {
      return this.optionsServiceDisclaimerLabel(value, optionsServiceObjectsList);
    }
    if (field.type === PoDynamicFieldType.Currency && value) {
      return this.formatValueToCurrency(field, value);
    }
    if (field.type === PoDynamicFieldType.Date || field.type?.toLowerCase() === PoDynamicFieldType.DateTime) {
      return field.range ? this.formatDate(value.start) + " - " + this.formatDate(value.end) : this.formatDate(value);
    }
    if (field.options && value) {
      return this.applyDisclaimerLabelValue(field, value);
    }
    return value;
  }
  emitChangesDisclaimers(currentDisclaimers) {
    this.changeDisclaimers.emit(currentDisclaimers);
    this.setFilters(this.formatArrayToObjectKeyValue(currentDisclaimers));
  }
  onRemoveAllDisclaimers() {
    const disclaimersToKeep = this.getFixedFiltersDisclaimers();
    this.emitChangesDisclaimers(disclaimersToKeep);
  }
  onRemoveDisclaimer(removeData) {
    const {
      currentDisclaimers
    } = removeData;
    const updatedDisclaimers = [...currentDisclaimers, ...this.getFixedFiltersDisclaimers(currentDisclaimers)];
    this.emitChangesDisclaimers(updatedDisclaimers);
  }
  getFixedFiltersDisclaimers(currentDisclaimers) {
    const fixedFilters = this.filters.filter((filter) => filter.fixed === true && filter.hasOwnProperty("initValue") && filter.initValue !== void 0 && filter.initValue !== null);
    return fixedFilters.map((filter) => ({
      property: filter.property,
      value: filter.initValue,
      label: `${filter.label}: ${filter.initValue}`,
      hideClose: true
    })).filter((fixedFilter) => !currentDisclaimers || !currentDisclaimers.some((disclaimer) => disclaimer.property === fixedFilter.property));
  }
  setDisclaimers(filters, optionsServiceObjects, visibleFilters) {
    const disclaimers = [];
    const properties = Object.keys(filters);
    const visibleProperties = visibleFilters ? visibleFilters.map((filter) => filter.property) : properties;
    properties.forEach((property) => {
      if (visibleProperties.includes(property)) {
        const field = this.getFieldByProperty(this.filters, property);
        const label = field.label || capitalizeFirstLetter(field.property);
        const value = filters[property];
        const hideClose = this.hideCloseDisclaimers.some((hideCloseDisclaimer) => hideCloseDisclaimer === property) || false;
        const valueDisplayedOnTheDisclaimerLabel = this.getFilterValueToDisclaimer(field, value, optionsServiceObjects);
        if (valueDisplayedOnTheDisclaimerLabel !== "") {
          disclaimers.push({
            label: `${label}: ${valueDisplayedOnTheDisclaimerLabel}`,
            property,
            value,
            hideClose
          });
        }
      }
    });
    return disclaimers;
  }
  loadOptionsOnInitialize(onLoad) {
    this.loadSubscription = this.getPoDynamicPageOptions(onLoad).subscribe((responsePoOption) => this.poPageCustomizationService.changeOriginalOptionsToNewOptions(this, responsePoOption));
  }
  getPoDynamicPageOptions(onLoad) {
    const originalOption = {
      title: this.title,
      actions: this.actions,
      breadcrumb: this.breadcrumb,
      filters: this.filters,
      keepFilters: this.keepFilters,
      concatFilters: this.concatFilters,
      hideRemoveAllDisclaimer: this.hideRemoveAllDisclaimer,
      hideCloseDisclaimers: this.hideCloseDisclaimers,
      quickSearchWidth: this.quickSearchWidth
    };
    const pageOptionSchema = {
      schema: [{
        nameProp: "filters",
        merge: true,
        keyForMerge: "property"
      }, {
        nameProp: "actions",
        merge: true,
        keyForMerge: "label"
      }, {
        nameProp: "breadcrumb"
      }, {
        nameProp: "title"
      }, {
        nameProp: "keepFilters"
      }, {
        nameProp: "concatFilters"
      }, {
        nameProp: "hideRemoveAllDisclaimer"
      }, {
        nameProp: "hideCloseDisclaimers"
      }, {
        nameProp: "quickSearchWidth"
      }]
    };
    return this.poPageCustomizationService.getCustomOptions(onLoad, originalOption, pageOptionSchema);
  }
  addComplexFilter(filter) {
    let complexFilter;
    Object.keys(filter).forEach((property) => {
      if (filter[property].start && filter[property].end) {
        if (!complexFilter) {
          complexFilter = "";
        } else {
          complexFilter += " and ";
        }
        complexFilter += `${property} ge '${filter[property].start}' and ${property} le '${filter[property].end}'`;
        delete filter[property];
      }
    });
    if (complexFilter) {
      filter = Object.assign(filter, {
        $filter: complexFilter
      });
    }
    return filter;
  }
  static \u0275fac = function PoPageDynamicSearchComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicSearchComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageDynamicSearchComponent,
    selectors: [["po-page-dynamic-search"]],
    viewQuery: function PoPageDynamicSearchComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(PoAdvancedFilterComponent, 7);
        \u0275\u0275viewQuery(PoPageListComponent, 7);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.poAdvancedFilter = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.poPageList = _t.first);
      }
    },
    standalone: false,
    features: [\u0275\u0275InheritDefinitionFeature, \u0275\u0275NgOnChangesFeature],
    ngContentSelectors: _c3,
    decls: 4,
    vars: 11,
    consts: [["poPageList", ""], [3, "p-actions", "p-breadcrumb", "p-components-size", "p-disclaimer-group", "p-filter", "p-title", "p-quick-search-value"], [3, "p-search-event", "p-components-size", "p-filters", "p-keep-filters", "p-literals"]],
    template: function PoPageDynamicSearchComponent_Template(rf, ctx) {
      if (rf & 1) {
        const _r1 = \u0275\u0275getCurrentView();
        \u0275\u0275projectionDef();
        \u0275\u0275elementStart(0, "po-page-list", 1, 0)(2, "po-advanced-filter", 2);
        \u0275\u0275listener("p-search-event", function PoPageDynamicSearchComponent_Template_po_advanced_filter_p_search_event_2_listener($event) {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.onAdvancedSearch($event, true));
        });
        \u0275\u0275elementEnd();
        \u0275\u0275projection(3);
        \u0275\u0275elementEnd();
      }
      if (rf & 2) {
        \u0275\u0275property("p-actions", ctx.actions)("p-breadcrumb", ctx.breadcrumb)("p-components-size", ctx.componentsSize)("p-disclaimer-group", ctx.disclaimerGroup)("p-filter", ctx.filterSettings)("p-title", ctx.title)("p-quick-search-value", ctx.quickSearchValue);
        \u0275\u0275advance(2);
        \u0275\u0275property("p-components-size", ctx.componentsSize)("p-filters", ctx.filters)("p-keep-filters", ctx.keepFilters)("p-literals", ctx.advancedFilterLiterals);
      }
    },
    dependencies: [PoPageListComponent, PoAdvancedFilterComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicSearchComponent, [{
    type: Component,
    args: [{
      selector: "po-page-dynamic-search",
      standalone: false,
      template: '<po-page-list\n  #poPageList\n  [p-actions]="actions"\n  [p-breadcrumb]="breadcrumb"\n  [p-components-size]="componentsSize"\n  [p-disclaimer-group]="disclaimerGroup"\n  [p-filter]="filterSettings"\n  [p-title]="title"\n  [p-quick-search-value]="quickSearchValue"\n>\n  <po-advanced-filter\n    [p-components-size]="componentsSize"\n    [p-filters]="filters"\n    [p-keep-filters]="keepFilters"\n    [p-literals]="advancedFilterLiterals"\n    (p-search-event)="onAdvancedSearch($event, true)"\n  >\n  </po-advanced-filter>\n\n  <ng-content></ng-content>\n</po-page-list>\n'
    }]
  }], () => [], {
    poAdvancedFilter: [{
      type: ViewChild,
      args: [PoAdvancedFilterComponent, {
        static: true
      }]
    }],
    poPageList: [{
      type: ViewChild,
      args: [PoPageListComponent, {
        static: true
      }]
    }]
  });
})();
var PoPageDynamicSearchModule = class _PoPageDynamicSearchModule {
  static \u0275fac = function PoPageDynamicSearchModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicSearchModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoPageDynamicSearchModule,
    declarations: [PoAdvancedFilterComponent, PoPageDynamicSearchComponent],
    imports: [CommonModule, FormsModule, RouterModule, PoDynamicModule, PoLanguageModule, PoModalModule, PoPageModule, PoPageCustomizationModule],
    exports: [PoPageDynamicSearchComponent]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    imports: [CommonModule, FormsModule, RouterModule, PoDynamicModule, PoLanguageModule, PoModalModule, PoPageModule, PoPageCustomizationModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicSearchModule, [{
    type: NgModule,
    args: [{
      imports: [CommonModule, FormsModule, RouterModule, PoDynamicModule, PoLanguageModule, PoModalModule, PoPageModule, PoPageCustomizationModule],
      declarations: [PoAdvancedFilterComponent, PoPageDynamicSearchComponent],
      exports: [PoPageDynamicSearchComponent]
    }]
  }], null, null);
})();
var PoPageDynamicListBaseComponent = class _PoPageDynamicListBaseComponent {
  /** Objeto com propriedades do breadcrumb. */
  breadcrumb = {
    items: []
  };
  /** Endpoint da API dos recursos que serão exibidos. */
  /**
   * @description
   *
   * Endpoint usado pelo template para requisição dos recursos que serão exibidos.
   *
   * Ao realizar requisições de busca, podem ser enviados os parâmetros (caso possuam valor): `page`, `pageSize`, `search` e `order`.
   *
   * Caso a coluna estiver ordenada descendentemente será enviada da seguinte forma: `-name`, se for ordenada
   * ascendentemente será enviada apenas com o nome da coluna, por exemplo: `name`.
   *
   * Exemplo de uma requisição de busca:
   *
   * > `GET {end-point}/{resource}?page=1&pageSize=10&search=components&order=-name`
   *
   * Caso a ação `remove` estiver configurada, será feito uma requisição de exclusão nesse mesmo endpoint passando os campos
   * setados como `key: true`.
   *
   * > `DELETE {end-point}/{keys}`
   *
   * ```
   *  <po-page-dynamic-table
   *    [p-actions]="{ remove: true }"
   *    [p-fields]="[ { property: 'id', key: true } ]"
   *    p-service="/api/po-samples/v1/people"
   *    ...>
   *  </po-page-dynamic-table>
   * ```
   *
   * Resquisição disparada, onde a propriedade `id` é igual a 2:
   *
   * ```
   *  DELETE /api/po-samples/v1/people/2 HTTP/1.1
   *  Host: localhost:4000
   *  Connection: keep-alive
   *  Accept: application/json, text/plain
   *  ...
   * ```
   *
   * Para a ação `removeAll`, será feito uma requisição de exclusão em lote para esse mesmo endpoint passando, uma lista
   * de objetos com os campos setados como `key: true` via `payload`.
   *
   * > `DELETE {end-point}`
   *
   * > `Payload: [ {key}, {key} ... {key} ]`
   *
   * ```
   *  <po-page-dynamic-table
   *    [p-actions]="{ removeAll: true }"
   *    [p-fields]="[ { property: 'id', key: true } ]"
   *    p-service="/api/po-samples/v1/people"
   *    ...>
   *  </po-page-dynamic-table>
   * ```
   *
   * Resquisição disparada, onde foram selecionados 3 itens para serem removidos:
   *
   * ```
   *  DELETE /api/po-samples/v1/people HTTP/1.1
   *  Host: localhost:4000
   *  Connection: keep-alive
   *  Accept: application/json, text/plain
   *  ...
   * ```
   *
   * Request payload:
   *
   * ```
   * [{"id":2},{"id":4},{"id":5}]
   * ```
   *
   * > Caso esteja usando metadados com o template, será disparado uma requisição na inicialização do template para buscar
   * > os metadados da página passando o tipo do metadado esperado e a versão cacheada pelo browser.
   * >
   * > `GET {end-point}/metadata?type=list&version={version}`
   */
  serviceApi;
  /** Título da página. */
  title;
  /**
   * @optional
   *
   * @description
   * Evento disparado ao fechar o popover do gerenciador de colunas após alterar as colunas visíveis.
   *
   * O componente envia como parâmetro um array de string com as colunas visíveis atualizadas.
   * Por exemplo: ["idCard", "name", "hireStatus", "age"].
   */
  changeVisibleColumns = new EventEmitter();
  /**
   * @optional
   *
   * @description
   * Evento disparado ao clicar no botão de restaurar padrão no gerenciador de colunas.
   *
   * O componente envia como parâmetro um array de string com as colunas configuradas inicialmente.
   * Por exemplo: ["idCard", "name", "hireStatus", "age"].
   */
  columnRestoreManager = new EventEmitter();
  /**
   * @optional
   *
   * @description
   *
   * Evento executado ao ordenar colunas da tabela.
   *
   * Recebe um objeto `{ column, type }` onde:
   *
   * - column (`PoTableColumn`): objeto da coluna que foi clicada/ordenada.
   * - type (`PoTableColumnSortType`): tipo da ordenação.
   */
  sortBy = new EventEmitter();
  _autoRouter = false;
  _columns = [];
  _duplicates = [];
  _fields = [];
  _filters = [];
  _keys = [];
  /**
   * @optional
   *
   * @description
   *
   * Cria automaticamente as rotas de edição (novo/duplicate) e detalhes caso sejam definidas ações na propriedade `p-actions`
   *
   * As rotas criadas serão baseadas na propriedade `p-actions`.
   *
   * > Para o correto funcionamento não pode haver nenhuma rota coringa (`**`) especificada.
   *
   * @default false
   */
  set autoRouter(value) {
    this._autoRouter = convertToBoolean(value);
  }
  get autoRouter() {
    return this._autoRouter;
  }
  /**
   * @optional
   *
   * @description
   *
   * Lista dos campos usados na tabela e busca avançada.
   *
   *
   * > Caso não seja definido fields a tabela assumirá o comportamento padrão.
   */
  set fields(fields) {
    this._fields = Array.isArray(fields) ? [...fields] : [];
    this.setFieldsProperties(this.fields);
  }
  get fields() {
    return this._fields;
  }
  set columns(value) {
    this._columns = [...this._columns = this.sortColumnsByOrder(value)];
  }
  get columns() {
    return this._columns;
  }
  set duplicates(value) {
    this._duplicates = [...value];
  }
  get duplicates() {
    return this._duplicates;
  }
  set filters(value) {
    this._filters = [...value];
  }
  get filters() {
    return this._filters;
  }
  set keys(value) {
    this._keys = [...value];
  }
  get keys() {
    return this._keys;
  }
  setFieldsProperties(fields) {
    let visibleFilter;
    this.filters = fields.filter((field) => field.filter === true).map((filterField) => {
      visibleFilter = !(filterField.initValue && filterField.fixed);
      return __spreadProps(__spreadValues({}, filterField), {
        visible: visibleFilter
      });
    });
    this.columns = fields.filter((field) => field.visible === void 0 || field.visible === true || field.allowColumnsManager === true);
    this.keys = fields.filter((field) => field.key === true).map((field) => field.property);
    this.duplicates = fields.filter((field) => field.duplicate === true).map((field) => field.property);
  }
  /**
   * Ordena um array de colunas com base na propriedade `order` de cada coluna.
   *
   * Este método é utilizado para organizar as colunas de uma tabela ou qualquer coleção similar
   * que necessite de ordenação baseada em um critério numérico definido pela propriedade `order`.
   * A ordenação segue as seguintes regras:
   *
   * 1. Colunas que possuem a propriedade `order` com um valor numérico válido e maior que zero
   *    são ordenadas em ordem crescente de acordo com este valor.
   *
   * 2. Colunas que não possuem a propriedade `order` ou que possuem um valor inválido ou não numérico
   *    para esta propriedade são consideradas iguais em termos de ordenação e mantêm a ordem original
   *    em que apareceram no array fornecido.
   *
   * 3. No caso de duas colunas com valores de `order` válidos e idênticos, a ordem entre essas duas colunas
   *    é determinada pela sua ordem original no array fornecido.
   *
   * @param columns Array de colunas a ser ordenado. Cada coluna é um objeto que pode conter uma propriedade `order`.
   *                O tipo `Array<any>` é utilizado aqui para permitir flexibilidade nos objetos de coluna que podem ser passados,
   *                mas espera-se que cada objeto tenha pelo menos uma propriedade `order` para a ordenação adequada.
   *
   * @returns Um novo array de colunas ordenado com base na propriedade `order`.
   */
  sortColumnsByOrder(columns) {
    return columns.sort((a, b) => {
      const hasValidOrderA = "order" in a && typeof a.order === "number" && a.order > 0;
      const hasValidOrderB = "order" in b && typeof b.order === "number" && b.order > 0;
      if (hasValidOrderA && hasValidOrderB) {
        return a.order - b.order;
      }
      if (hasValidOrderA) {
        return -1;
      }
      if (hasValidOrderB) {
        return 1;
      }
      return 0;
    });
  }
  static \u0275fac = function PoPageDynamicListBaseComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicListBaseComponent)();
  };
  static \u0275dir = /* @__PURE__ */ \u0275\u0275defineDirective({
    type: _PoPageDynamicListBaseComponent,
    inputs: {
      breadcrumb: [0, "p-breadcrumb", "breadcrumb"],
      serviceApi: [0, "p-service-api", "serviceApi"],
      title: [0, "p-title", "title"],
      autoRouter: [0, "p-auto-router", "autoRouter"],
      fields: [0, "p-fields", "fields"]
    },
    outputs: {
      changeVisibleColumns: "p-change-visible-columns",
      columnRestoreManager: "p-restore-column-manager",
      sortBy: "p-sort-by"
    }
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicListBaseComponent, [{
    type: Directive
  }], null, {
    breadcrumb: [{
      type: Input,
      args: ["p-breadcrumb"]
    }],
    serviceApi: [{
      type: Input,
      args: ["p-service-api"]
    }],
    title: [{
      type: Input,
      args: ["p-title"]
    }],
    changeVisibleColumns: [{
      type: Output,
      args: ["p-change-visible-columns"]
    }],
    columnRestoreManager: [{
      type: Output,
      args: ["p-restore-column-manager"]
    }],
    sortBy: [{
      type: Output,
      args: ["p-sort-by"]
    }],
    autoRouter: [{
      type: Input,
      args: ["p-auto-router"]
    }],
    fields: [{
      type: Input,
      args: ["p-fields"]
    }]
  });
})();
var PoPageDynamicTableActionsService = class _PoPageDynamicTableActionsService {
  http = inject(HttpClient);
  headers = new HttpHeaders({
    "X-PO-SCREEN-LOCK": "true"
  });
  beforeDuplicate(action, id, body) {
    const resource = body ?? {};
    return this.executeAction({
      action,
      resource,
      id
    });
  }
  beforeEdit(action, id, body) {
    const resource = body ?? {};
    return this.executeAction({
      action,
      resource,
      id
    });
  }
  beforeNew(action) {
    return this.executeAction({
      action
    });
  }
  beforeRemove(action, id, resource) {
    return this.executeAction({
      action,
      id,
      resource
    });
  }
  beforeRemoveAll(action, resources) {
    return this.executeAction({
      action,
      resource: resources
    });
  }
  beforeDetail(action, id, resource) {
    return this.executeAction({
      action,
      id,
      resource
    });
  }
  customAction(action, resource = []) {
    return this.executeAction({
      action,
      resource
    });
  }
  executeAction({
    action,
    resource = {},
    id
  }) {
    if (!action) {
      return of({});
    }
    if (typeof action === "string") {
      const url = id ? `${action}/${id}` : action;
      return this.http.post(url, resource, {
        headers: this.headers
      });
    }
    if (id) {
      return of(action(id, resource));
    }
    return of(action(resource));
  }
  static \u0275fac = function PoPageDynamicTableActionsService_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicTableActionsService)();
  };
  static \u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
    token: _PoPageDynamicTableActionsService,
    factory: _PoPageDynamicTableActionsService.\u0275fac,
    providedIn: "root"
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicTableActionsService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], null, null);
})();
var poPageDynamicTableLiteralsDefault = {
  en: {
    pageAction: "New",
    pageActionRemoveAll: "Delete",
    tableActionView: "View",
    tableActionEdit: "Edit",
    tableActionDuplicate: "Duplicate",
    tableActionDelete: "Delete",
    confirmRemoveTitle: "Confirm delete",
    confirmRemoveMessage: "Are you sure you want to delete this record? You can not undo this action.",
    confirmRemoveAllTitle: "Confirm batch deletion",
    confirmRemoveAllMessage: "Are you sure you want to delete all these records? You can not undo this action.",
    loadDataErrorNotification: "Service not found",
    removeSuccessNotification: "Item deleted successfully",
    removeAllSuccessNotification: "Items deleted successfully"
  },
  es: {
    pageAction: "Nuevo",
    pageActionRemoveAll: "Borrar",
    tableActionView: "Visualizar",
    tableActionEdit: "Editar",
    tableActionDuplicate: "Duplicar",
    tableActionDelete: "Borrar",
    confirmRemoveTitle: "Confirmar la exclusi\xF3n",
    confirmRemoveMessage: "\xBFEst\xE1 seguro de que desea eliminar este registro? No puede deshacer esta acci\xF3n.",
    confirmRemoveAllTitle: "Confirmar la exclusi\xF3n por lotes",
    confirmRemoveAllMessage: "\xBFEst\xE1 seguro de que desea eliminar todos estos registros? No puede deshacer esta acci\xF3n.",
    loadDataErrorNotification: "Servicio no informado.",
    removeSuccessNotification: "Elemento eliminado con \xE9xito",
    removeAllSuccessNotification: "Elementos eliminados con \xE9xito"
  },
  pt: {
    pageAction: "Novo",
    pageActionRemoveAll: "Excluir",
    tableActionView: "Visualizar",
    tableActionEdit: "Editar",
    tableActionDuplicate: "Duplicar",
    tableActionDelete: "Excluir",
    confirmRemoveTitle: "Confirmar exclus\xE3o",
    confirmRemoveMessage: "Tem certeza de que deseja excluir esse registro? Voc\xEA n\xE3o poder\xE1 desfazer essa a\xE7\xE3o.",
    confirmRemoveAllTitle: "Confirmar exclus\xE3o em lote",
    confirmRemoveAllMessage: "Tem certeza de que deseja excluir todos esses registros? Voc\xEA n\xE3o poder\xE1 desfazer essa a\xE7\xE3o.",
    loadDataErrorNotification: "Servi\xE7o n\xE3o informado.",
    removeSuccessNotification: "Item excluido com sucesso",
    removeAllSuccessNotification: "Items excluidos com sucesso"
  },
  ru: {
    pageAction: "\u041D\u043E\u0432\u044B\u0439",
    pageActionRemoveAll: "\u0423\u0434\u0430\u043B\u0438\u0442\u044C",
    tableActionView: "\u041F\u0440\u043E\u0441\u043C\u043E\u0442\u0440",
    tableActionEdit: "\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",
    tableActionDuplicate: "\u0414\u0443\u0431\u043B\u0438\u0440\u043E\u0432\u0430\u0442\u044C",
    tableActionDelete: "\u0423\u0434\u0430\u043B\u0438\u0442\u044C",
    confirmRemoveTitle: "\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F",
    confirmRemoveMessage: "\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u0442\u0443 \u0437\u0430\u043F\u0438\u0441\u044C?  \u0412\u044B \u043D\u0435 \u043C\u043E\u0436\u0435\u0442\u0435 \u043E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u044D\u0442\u043E \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435.",
    confirmRemoveAllTitle: "\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u043F\u0430\u043A\u0435\u0442\u0430",
    confirmRemoveAllMessage: "\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u0432\u0441\u0435 \u044D\u0442\u0438 \u0437\u0430\u043F\u0438\u0441\u0438? \u0412\u044B \u043D\u0435 \u043C\u043E\u0436\u0435\u0442\u0435 \u043E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u044D\u0442\u043E \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435.",
    loadDataErrorNotification: "\u0421\u0435\u0440\u0432\u0438\u0441 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D",
    removeSuccessNotification: "\u042D\u043B\u0435\u043C\u0435\u043D\u0442 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D",
    removeAllSuccessNotification: "\u042D\u043B\u0435\u043C\u0435\u043D\u0442\u044B \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D\u044B"
  }
};
var PAGE_SIZE_DEFAULT = 10;
var PoPageDynamicTableComponent = class _PoPageDynamicTableComponent extends PoPageDynamicListBaseComponent {
  router = inject(Router);
  activatedRoute = inject(ActivatedRoute);
  poDialogService = inject(PoDialogService);
  poNotification = inject(PoNotificationService);
  poPageDynamicService = inject(PoPageDynamicService);
  poPageCustomizationService = inject(PoPageCustomizationService);
  poPageDynamicTableActionsService = inject(PoPageDynamicTableActionsService);
  /**
   * Função ou serviço que será executado na inicialização do componente.
   *
   * A propriedade aceita os seguintes tipos:
   * - `string`: *Endpoint* usado pelo componente para requisição via `POST`.
   * - `function`: Método que será executado.
   *
   * O retorno desta função deve ser do tipo `PoPageDynamicTableOptions`,
   * onde o usuário poderá customizar novos campos, breadcrumb, title e actions
   *
   * Por exemplo:
   *
   * ```
   * getPageOptions(): PoPageDynamicTableOptions {
   * return {
   *   actions:
   *     { new: 'new', edit: 'edit/:id', remove: true },
   *   fields: [
   *     { property: 'idCard', gridColumns: 6 }
   *   ]
   * };
   * }
   *
   * ```
   * Para referenciar a sua função utilize a propriedade `bind`, por exemplo:
   * ```
   *  [p-load]="onLoadOptions.bind(this)"
   * ```
   */
  onLoad;
  /**
   * @optional
   *
   * @description
   *
   * Mantém na modal de `Busca Avançada` os valores preenchidos do último filtro realizado pelo usuário.
   *
   * @default `false`
   */
  keepFilters = false;
  /**
   * @optional
   *
   * @description
   *
   * Define que a coluna de ações ficará no lado direito da tabela.
   *
   * @default `false`
   */
  actionRight = false;
  /**
   * @optional
   *
   * @description
   *
   * Permite a utilização da pesquisa rápida junto com a pesquisa avançada.
   *
   * Desta forma, ao ter uma pesquisa avançada estabelecida e ser
   * preenchido a pesquisa rápida, o filtro será concatenado adicionando a pesquisa
   * rápida também na lista de `disclaimers` a aplicando uma nova busca com a concatenação.
   *
   * Por exemplo, com os seguintes filtros aplicados:
   *   - filtro avançado: `{ name: 'Mike', age: '12' }`
   *   - filtro rápido: `{ search: 'paper' }`
   *
   * A requisição dos dados na API ficará com os parâmetros:
   * ```
   * page=1&pageSize=10&name=Mike&age=12&search=paper
   * ```
   *
   * @default `false`
   */
  concatFilters = false;
  /**
   * @optional
   *
   * @description
   *
   * Permite que o gerenciador de colunas, responsável pela definição de quais colunas serão exibidas, seja escondido.
   *
   * @default `false`
   */
  hideColumnsManager = false;
  /**
   * @optional
   *
   * @description
   *
   * Oculta o botão para remover todos os *disclaimers* do grupo.
   *
   * > Por padrão, o mesmo é exibido à partir de dois ou mais *disclaimers* com a opção `hideClose` habilitada.
   *
   * @default `false`
   */
  hideRemoveAllDisclaimer = false;
  /**
   * @optional
   *
   * @description
   *
   * Se verdadeiro, ativa a funcionalidade de scroll infinito para a tabela e o botão "Carregar Mais" deixará de ser exibido. Ao chegar no fim da tabela
   * executará a função `p-show-more`.
   *
   * **Regras de utilização:**
   *  - O scroll infinito só funciona para tabelas que utilizam a propriedade `p-height` e que possuem o scroll já na carga inicial dos dados.
   *
   * @default `false`
   */
  infiniteScroll = false;
  hasNext = false;
  items = [];
  literals;
  pageActions = [];
  tableActions = [];
  _actions = {};
  _pageCustomActions = [];
  _height;
  _oldQuickSearchParam;
  _quickSearchParam = "search";
  _quickSearchValue;
  _quickSearchWidth;
  _tableCustomActions = [];
  page = 1;
  currentPage = 1;
  itemSelectedAction;
  params = {};
  sortedColumn;
  subscriptions = new Subscription();
  hasCustomActionWithSelectable = false;
  _componentsSize = void 0;
  _customPageListActions = [];
  _customTableActions = [];
  _defaultPageActions = [];
  _defaultTableActions = [];
  _hideCloseDisclaimers = [];
  _draggable = false;
  _virtualScroll = true;
  set defaultPageActions(value) {
    this._defaultPageActions = value;
    this.updatePageActions();
  }
  set defaultTableActions(value) {
    this._defaultTableActions = value;
    this.updateTableActions();
  }
  set customPageListActions(value) {
    this._customPageListActions = value;
    this.updatePageActions();
  }
  set customTableActions(value) {
    this._customTableActions = value;
    this.updateTableActions();
  }
  /**
   * @optional
   *
   * @description
   *
   * Ações da página e da tabela.
   * > Caso utilizar a ação padrão de excluir, a mesma será exibida por último na tabela.
   */
  set actions(value) {
    this._actions = value && typeof value === "object" && Object.keys(value).length > 0 ? value : {};
    this.setPageActions(this.actions);
    this.setRemoveAllAction();
    this.setTableActions(this.actions);
  }
  get actions() {
    return this._actions;
  }
  /**
   * @optional
   *
   * @description
   *
   * Define o tamanho dos componentes de formulário no template:
   * - `small`: aplica a medida small de cada componente (disponível apenas para acessibilidade AA).
   * - `medium`: aplica a medida medium de cada componente.
   *
   * > Caso a acessibilidade AA não esteja configurada, o tamanho `medium` será mantido.
   * Para mais detalhes, consulte a documentação do [po-theme](https://po-ui.io/documentation/po-theme).
   *
   * @default `medium`
   */
  set componentsSize(value) {
    this._componentsSize = validateSizeFn(value);
  }
  get componentsSize() {
    return this._componentsSize ?? getDefaultSizeFn();
  }
  /**
   * @optional
   *
   * @description
   *
   * Lista de ações customizadas da página que serão incorporadas às ações
   * informadas através da propriedade `p-actions`.
   *
   * Essas ações ficam localizadas na parte superior da página em botões com ações.
   *
   * Exemplo de utilização:
   * ```
   * [
   *  { label: 'Export', action: this.export.bind(this) },
   *  { label: 'Print', action: this.print.bind(this) }
   * ];
   * ```
   */
  set pageCustomActions(value) {
    this._pageCustomActions = Array.isArray(value) ? value : [];
    this.customPageListActions = this.transformCustomActionsToPageListAction(this.pageCustomActions);
    this.hasCustomActionWithSelectable = this.pageCustomActions.some((customAction) => customAction.selectable);
  }
  get pageCustomActions() {
    return this._pageCustomActions;
  }
  /**
   * @optional
   *
   * @description
   *
   * Lista de ações customizadas na tabela da página que serão incorporadas às ações
   * informadas através da propriedade `p-actions`.
   *
   * Exemplo de utilização:
   * ```
   * [
   *  { label: 'Apply discount', action: this.applyDiscount.bind(this) },
   *  { label: 'Details', action: this.details.bind(this) }
   * ];
   * ```
   * > Caso utilizar a ação padrão de excluir, a mesma será exibida por último na tabela.
   */
  set tableCustomActions(value) {
    this._tableCustomActions = Array.isArray(value) ? value : [];
    this.customTableActions = this.transformTableCustomActionsToTableActions(this.tableCustomActions);
  }
  get tableCustomActions() {
    return this._tableCustomActions;
  }
  /**
   * @optional
   *
   * @description
   *
   * Largura do campo de busca, utilizando o *Grid System*,
   * e limitado ao máximo de 6 colunas. O tamanho mínimo é controlado
   * conforme resolução de tela para manter a consistência do layout.
   */
  set quickSearchWidth(value) {
    this._quickSearchWidth = convertToInt(value);
  }
  get quickSearchWidth() {
    return this._quickSearchWidth;
  }
  /**
   * @optional
   *
   * @description
   *
   * Define a altura da tabela em *pixels* e fixa o cabeçalho.
   */
  set height(value) {
    this._height = convertToInt(value);
  }
  get height() {
    return this._height;
  }
  /**
   * @optional
   *
   * @description
   *
   * Lista de filtros que terão a opção de fechar ocultada
   * em seu respectivo disclaimer. Utilizar o atributo `property` do campo.
   *
   * Exemplo de utilização:
   * ```
   * ['city','name'];
   * ```
   */
  set hideCloseDisclaimers(value) {
    this._hideCloseDisclaimers = Array.isArray(value) ? value : [];
  }
  get hideCloseDisclaimers() {
    return this._hideCloseDisclaimers;
  }
  /**
   * @optional
   *
   * @description
   *
   * Identificador do parâmetro enviado ao serviço ao realizar uma busca rápida.
   *
   * @default 'search'
   */
  set quickSearchParam(value) {
    this._quickSearchParam = value ?? "search";
  }
  get quickSearchParam() {
    return this._quickSearchParam;
  }
  /**
   * @optional
   *
   * @description
   *
   * Valor padrão na busca rápida ao inicializar o componente
   *
   */
  set quickSearchValue(value) {
    this._quickSearchValue = value;
  }
  get quickSearchValue() {
    return this._quickSearchValue;
  }
  /**
   * @optional
   *
   * @description
   *
   * Objeto com as literais usadas no `po-page-dynamic-table`.
   *
   * Existem duas maneiras de customizar o componente, passando um objeto com todas as literais disponíveis:
   *
   * ```
   *  const customLiterals: PoPageDynamicSearchLiterals = {
   *    disclaimerGroupTitle: 'Filtros aplicados:',
   *    filterTitle: 'Filtro avançado',
   *    filterCancelLabel: 'Fechar',
   *    filterConfirmLabel: 'Aplicar',
   *    quickSearchLabel: 'Valor pesquisado:',
   *    searchPlaceholder: 'Pesquise aqui'
   *  };
   * ```
   *
   * Ou passando apenas as literais que deseja customizar:
   *
   * ```
   *  const customLiterals: PoPageDynamicSearchLiterals = {
   *    filterTitle: 'Filtro avançado'
   *  };
   * ```
   *
   * E para carregar as literais customizadas, basta apenas passar o objeto para o componente.
   *
   * ```
   * <po-page-dynamic-table
   *   [p-literals]="customLiterals">
   * </po-page-dynamic-table>
   * ```
   *
   * > O valor padrão será traduzido de acordo com o idioma configurado no [`PoI18nService`](/documentation/po-i18n) ou *browser*.
   */
  searchLiterals;
  /**
   * @optional
   *
   * @description
   *
   * Define o espaçamento interno das células, impactando diretamente na altura das linhas do table. Os valores
   * permitidos são definidos pelo enum **PoTableColumnSpacing**.
   *
   * > Em nível de acessibilidade **AA**, caso o valor de `p-spacing` não seja definido, o valor padrão será
   * > `extraSmall` nos seguintes cenários:
   * > - Quando o valor de `p-components-size` for `small`;
   * > - Quando o valor padrão dos componentes for configurado como `small` no
   * > [serviço de tema](https://po-ui.io/documentation/po-theme).
   *
   * @default `medium`
   */
  spacing;
  /**
   * @optional
   *
   * @description
   *
   * Habilita ou desabilita a quebra automática de texto. Quando ativada, o texto que excede
   * o espaço disponível é transferido para a próxima linha em pontos apropriados para uma
   * leitura clara.
   *
   * > Incompatível com `virtual-scroll`, que requer altura fixa nas linhas.
   *
   * @default `false`
   */
  textWrap = false;
  /**
   * @optional
   *
   * @description
   *
   * Habilita o modo drag and drop para as colunas da tabela.
   *
   */
  set draggable(value) {
    this._draggable = value;
  }
  get draggable() {
    return this._draggable;
  }
  /**
   * @optional
   *
   * @description
   *
   * Habilita o `virtual-scroll` na tabela para melhorar a performance com grandes volumes de dados.
   * Requer altura (`p-height`) para funcionar corretamente.
   *
   * > Incompatível com `p-text-wrap` e `master-detail`, pois o `virtual-scroll` exige altura fixa nas linhas.
   *
   * @default `true`
   */
  set virtualScroll(value) {
    this._virtualScroll = convertToBoolean(value && this.height > 0);
  }
  get virtualScroll() {
    return this._virtualScroll;
  }
  /**
   * @optional
   *
   * @description
   *
   * Controla a visibilidade dos filtros fixos na página.
   *
   * - Quando `true` (default), todos os filtros, incluindo os fixos, são exibidos, permitindo que o usuário visualize os filtros aplicados.
   * - Quando `false`, os filtros fixos são ocultados, não sendo exibidos na interface, mas ainda sendo aplicados como filtros nas requisições.
   *
   * Esta propriedade trabalha em conjunto com a propriedade `fixed` dos filtros individuais. Filtros marcados como `fixed: true` não serão exibidos na interface do filtro avançado quando `visibleFixedFilters` for `false`, mas continuarão a ser aplicados de forma transparente ao usuário. Dessa forma, permite-se maior flexibilidade no controle de quais filtros devem ser visíveis ao usuário ou devem ser aplicados permanentemente sem interferência.
   *
   * **Exemplo de uso:**
   * ```html
   * <!-- Para ocultar os filtros fixos -->
   * <po-page-dynamic-table [p-visible-fixed-filters]="false"></po-page-dynamic-table>
   * ```
   */
  visibleFixedFilters = true;
  /* eslint-disable max-params */
  constructor() {
    const languageService = inject(PoLanguageService);
    super();
    const language = languageService.getShortLanguage();
    this.literals = __spreadValues(__spreadValues({}, poPageDynamicTableLiteralsDefault[poLocaleDefault]), poPageDynamicTableLiteralsDefault[language]);
  }
  /* eslint-enable max-params */
  ngOnInit() {
    this.loadDataFromAPI();
  }
  ngOnDestroy() {
    this.subscriptions.unsubscribe();
  }
  onAdvancedSearch(filter) {
    this.subscriptions.add(this.loadData(__spreadValues({
      page: 1
    }, filter)).subscribe());
    this.params = filter;
    if (this.keepFilters) {
      this.updateFilterValue(filter);
    }
  }
  onChangeDisclaimers(disclaimers) {
    const filter = {};
    disclaimers.forEach((disclaimer) => {
      filter[disclaimer.property] = disclaimer.value;
    });
    this.onAdvancedSearch(filter);
  }
  onQuickSearch(termTypedInQuickSearch) {
    const quickSearchParam = termTypedInQuickSearch ? {
      [this.quickSearchParam]: termTypedInQuickSearch
    } : {};
    this.params = this.concatFilters ? __spreadValues(__spreadValues({}, this.params), quickSearchParam) : __spreadValues({}, quickSearchParam);
    if (this._oldQuickSearchParam in this.params && this._oldQuickSearchParam !== this.quickSearchParam) {
      delete this.params[this._oldQuickSearchParam];
    }
    this._oldQuickSearchParam = this.quickSearchParam;
    this.subscriptions.add(this.loadData(termTypedInQuickSearch ? __spreadValues({
      page: 1
    }, this.params) : void 0).subscribe());
  }
  onSort(sortedColumn) {
    if (this.height) {
      const order = sortedColumn.type === "ascending" ? true : false;
      sortArrayOfObjects(this.items, sortedColumn.column.property, order);
    }
    this.sortedColumn = sortedColumn;
  }
  onChangeVisibleColumns(value) {
    this.changeVisibleColumns.emit(value);
  }
  onColumnRestoreManager(value) {
    this.columnRestoreManager.emit(value);
  }
  onSortBy(sortedColumn) {
    this.sortBy.emit(sortedColumn);
  }
  showMore() {
    this.subscriptions.add(this.loadData(__spreadValues({
      page: ++this.page
    }, this.params)).subscribe());
  }
  get enableSelectionTable() {
    return this.hasActionRemoveAll || this.hasCustomActionWithSelectable;
  }
  get hasActionRemoveAll() {
    return !!this.actions.removeAll;
  }
  /**
   * Função que realiza a atualização dos dados da tabela.
   *
   * Para utilizá-la é necessário capturar a instância do `page dynamic table`, como por exemplo:
   *
   * ``` html
   * <po-page-dynamic-table #dynamicTable [p-service-api]="serviceApi"></po-page-dynamic-table>
   * ```
   *
   * ``` javascript
   * import { PoPageDynamicTableComponent, PoDynamicFormField } from '@po-ui/ng-components';
   *
   * ...
   *
   * @ViewChild('dynamicTable', { static: true }) dynamicTable: PoPageDynamicTableComponent;
   *
   * pageCustomActions: Array<PoPageDynamicTableCustomAction> = [
   * {
   *   label: 'Update',
   *   action: this.updateTable.bind(this),
   *   icon: 'an-arrows-clockwise'
   * }]
   *
   * updateTable() {
   *   this.dynamicTable.updateDataTable();
   * }
   * ```
   *
   *
   * @param {{page: number, key: value }} filter Propriedade para envio de um filtro customizado.
   * Exemplo de envio:
   *
   *```
   * this.dynamicTable.updateDataTable({page: 3, search: 'Brasil'});
   * ```
   * Caso não seja passado um filtro customizado para o método `updateDataTable` a tabela será atualizada conforme a página do ultimo item modificado.
   */
  updateDataTable(filter) {
    const indexItemSelected = this.items.findIndex((item) => item === this.itemSelectedAction);
    const pageNumber = Math.floor(indexItemSelected / PAGE_SIZE_DEFAULT);
    this.currentPage = pageNumber < 0 ? this.currentPage : pageNumber + 1;
    if (this.currentPage === void 0) {
      this.currentPage = 1;
    }
    if (filter) {
      this.subscriptions.add(this.loadData(filter).subscribe());
    } else {
      this.subscriptions.add(this.loadData(__spreadValues({
        page: this.currentPage
      }, this.params)).subscribe());
    }
  }
  confirmRemove(actionRemove, actionBeforeRemove, item) {
    const confirmOptions = {
      title: this.literals.confirmRemoveTitle,
      message: this.literals.confirmRemoveMessage,
      componentsSize: this.componentsSize,
      confirm: this.remove.bind(this, item, actionRemove, actionBeforeRemove)
    };
    this.poDialogService.confirm(confirmOptions);
  }
  confirmRemoveAll(actionRemoveAll, actionBeforeRemoveAll) {
    const confirmOptions = {
      title: this.literals.confirmRemoveAllTitle,
      message: this.literals.confirmRemoveAllMessage,
      confirm: this.removeAll.bind(this, actionRemoveAll, actionBeforeRemoveAll)
    };
    this.poDialogService.confirm(confirmOptions);
  }
  formatUniqueKey(item) {
    const keys2 = mapObjectByProperties(item, this.keys);
    return valuesFromObject(keys2).join("|");
  }
  getOrderParam(sortedColumn = {
    type: void 0
  }) {
    const {
      column,
      type
    } = sortedColumn;
    if (!column) {
      return {};
    }
    if (type === PoTableColumnSortType.Descending) {
      return {
        order: `-${column.property}`
      };
    }
    return {
      order: `${column.property}`
    };
  }
  loadData(params = {}) {
    if (!this.serviceApi) {
      this.poNotification.error(this.literals.loadDataErrorNotification);
      return EMPTY;
    }
    const orderParam = this.getOrderParam(this.sortedColumn);
    const defaultParams = {
      page: 1,
      pageSize: PAGE_SIZE_DEFAULT
    };
    const fullParams = __spreadValues(__spreadValues(__spreadValues({}, defaultParams), params), orderParam);
    return this.poPageDynamicService.getResources(fullParams).pipe(tap((response) => {
      let newArray;
      if (fullParams.page === 1) {
        newArray = removeDuplicateItemsWithArrayKey(response.items, response.items, this.keys);
      } else {
        newArray = removeDuplicateItemsWithArrayKey(this.items, response.items, this.keys);
      }
      this.items = newArray ? [...newArray] : this.items;
      this.page = fullParams.page;
      this.hasNext = response.hasNext;
    }));
  }
  getMetadata(serviceApiFromRoute, onLoad) {
    if (serviceApiFromRoute) {
      return this.poPageDynamicService.getMetadata().pipe(tap((response) => {
        this.autoRouter = response.autoRouter || this.autoRouter;
        this.actions = response.actions || this.actions;
        this.breadcrumb = response.breadcrumb || this.breadcrumb;
        this.fields = response.fields || this.fields;
        this.title = response.title || this.title;
        this.pageCustomActions = response.pageCustomActions || this.pageCustomActions;
        this.tableCustomActions = response.tableCustomActions || this.tableCustomActions;
        this.keepFilters = response.keepFilters || this.keepFilters;
        this.concatFilters = response.concatFilters || this.concatFilters;
        this.hideRemoveAllDisclaimer = response.hideRemoveAllDisclaimer || this.hideRemoveAllDisclaimer;
        this.hideCloseDisclaimers = response.hideCloseDisclaimers || this.hideCloseDisclaimers;
        this.quickSearchWidth = response.quickSearchWidth || this.quickSearchWidth;
      }), switchMap(() => this.loadOptionsOnInitialize(onLoad)));
    }
    return this.loadOptionsOnInitialize(onLoad);
  }
  // @todo Validar rotas na mão pois se existir uma rota '**' o catch do navigation não funciona.
  navigateTo(route, forceStopAutoRouter = false) {
    if (isExternalLink(route.path)) {
      return openExternalLink(route.path);
    }
    this.router.navigate([route.url || route.path], {
      queryParams: route.params
    }).catch(() => {
      if (forceStopAutoRouter || !this.autoRouter) {
        return;
      }
      this.router.config.unshift({
        path: route.path,
        component: route.component,
        data: {
          serviceApi: this.serviceApi,
          autoRouter: true
        }
      });
      this.navigateTo(route, true);
    });
  }
  createConcatenatedUrl(concatKeys, url, selectedItem) {
    const keys2 = this.keys.map((key) => encodeURIComponent(selectedItem[key])).join();
    return concatKeys ? `${url}/${keys2}` : url;
  }
  openDetail(action, item) {
    const id = this.formatUniqueKey(item);
    this.subscriptions.add(this.poPageDynamicTableActionsService.beforeDetail(this.actions.beforeDetail, id, item).subscribe((beforeDetailResult) => this.executeDetail(action, beforeDetailResult, id, item)));
  }
  executeDetail(action, beforeDetailResult, id, item) {
    const before = beforeDetailResult ?? {};
    const allowAction = typeof before.allowAction === "boolean" ? before.allowAction : true;
    const {
      newUrl
    } = before;
    if (allowAction && action) {
      if (newUrl) {
        const path = this.getPathFromNewUrl(newUrl, id);
        return this.navigateTo({
          path
        });
      }
      if (typeof action === "string") {
        const url = this.resolveUrl(item, action);
        this.navigateTo({
          path: action,
          url,
          component: PoPageDynamicDetailComponent
        });
      } else {
        action(id, item);
      }
    }
  }
  getPathFromNewUrl(newUrl, id) {
    if (newUrl.includes(":id")) {
      return newUrl.replace(/:id/g, id);
    }
    return newUrl;
  }
  openDuplicate(actionDuplicate, item) {
    const id = this.formatUniqueKey(item);
    const duplicates = removeKeysProperties(this.keys, mapObjectByProperties(item, this.duplicates));
    this.subscriptions.add(this.poPageDynamicTableActionsService.beforeDuplicate(this.actions.beforeDuplicate, id, duplicates).subscribe((beforeDuplicateResult) => this.executeDuplicate(actionDuplicate, beforeDuplicateResult, duplicates)));
  }
  executeDuplicate(actionDuplicate, beforeDuplicateResult, duplicates) {
    const before = beforeDuplicateResult ?? {};
    const allowAction = typeof before.allowAction === "boolean" ? before.allowAction : true;
    const beforeDuplicateResource = before.resource;
    const newAction = before.newUrl ?? actionDuplicate;
    if (allowAction && actionDuplicate) {
      if (typeof beforeDuplicateResource === "object" && beforeDuplicateResource !== null) {
        duplicates = removeKeysProperties(this.keys, beforeDuplicateResource);
      }
      if (typeof newAction === "string") {
        return this.navigateTo({
          path: newAction,
          params: {
            duplicate: JSON.stringify(duplicates)
          }
        });
      }
      return newAction(duplicates);
    }
  }
  openEdit(actionEdit, item) {
    const id = this.formatUniqueKey(item);
    this.subscriptions.add(this.poPageDynamicTableActionsService.beforeEdit(this.actions.beforeEdit, id, item).pipe(switchMap((beforeEditResult) => this.executeEditAction(actionEdit, beforeEditResult, item, id))).subscribe());
  }
  executeEditAction(action, beforeEditResult, item, id) {
    const newEditAction = beforeEditResult?.newUrl ?? action;
    const allowAction = beforeEditResult?.allowAction ?? true;
    if (!allowAction) {
      return EMPTY;
    }
    if (typeof newEditAction === "string") {
      this.openEditUrl(newEditAction, item);
    } else {
      const updatedItem = newEditAction(id, item);
      if (typeof updatedItem === "object" && updatedItem !== null) {
        this.modifyUITableItem(item, removeKeysProperties(this.keys, updatedItem));
      }
    }
    return EMPTY;
  }
  openEditUrl(path, item) {
    const url = this.resolveUrl(item, path);
    this.navigateTo({
      path,
      url
    });
  }
  modifyUITableItem(currentItem, newItemValue) {
    const tableItem = this.items.findIndex((item) => item === currentItem);
    this.items[tableItem] = __spreadValues(__spreadValues({}, currentItem), newItemValue);
  }
  openNew(actionNew) {
    this.subscriptions.add(this.poPageDynamicTableActionsService.beforeNew(this.actions.beforeNew).subscribe((beforeNewResult) => this.executeNew(actionNew, beforeNewResult)));
  }
  executeNew(actionNew, beforeNewResult) {
    const before = beforeNewResult ?? {};
    const allowAction = typeof before.allowAction === "boolean" ? before.allowAction : true;
    const {
      newUrl
    } = before;
    if (allowAction && actionNew) {
      if (newUrl) {
        return this.navigateTo({
          path: newUrl
        });
      }
      if (typeof actionNew === "string") {
        return this.navigateTo({
          path: actionNew
        });
      }
      return actionNew();
    }
  }
  /**
   * Caso exista mais de um identificador, será concatenado com '|'.
   *
   * Ex: { id: 1, company: 'po' }
   *
   * Para o endpoint /resources/:id será executada a url /resources/1|po
   */
  remove(item, actionRemove, actionBeforeRemove) {
    const uniqueKey = this.formatUniqueKey(item);
    this.subscriptions.add(this.poPageDynamicTableActionsService.beforeRemove(actionBeforeRemove, uniqueKey, item).pipe(switchMap((beforeRemove) => this.deleteAction(item, actionRemove, beforeRemove))).subscribe());
  }
  deleteAction(item, actionRemove, beforeRemove) {
    const {
      allowAction,
      newUrl
    } = beforeRemove || {};
    const allow = allowAction ?? true;
    if (allow) {
      let uniqueKey = this.formatUniqueKey(item);
      const resourceToRemoveKey = this.returnResourcesKeys([item]);
      if (typeof actionRemove === "boolean" || newUrl) {
        uniqueKey = newUrl ? void 0 : uniqueKey;
        return this.poPageDynamicService.deleteResource(uniqueKey, newUrl).pipe(map(() => this.removeFromUI(resourceToRemoveKey, this.literals.removeSuccessNotification)));
      }
      return of(actionRemove(uniqueKey, item)).pipe(tap((remove) => {
        const removeItem = remove ?? false;
        this.removeFromUI(resourceToRemoveKey, this.literals.removeSuccessNotification, removeItem);
      }));
    }
    return of({});
  }
  removeFromUI(items, message, remove = true) {
    if (remove === true && items?.length) {
      this.removeLocalItems(items);
      this.poNotification.success(message);
    }
  }
  removeAll(actionRemoveAll, actionBeforeRemoveAll) {
    const originalResourcesKeys = this.getSelectedItemsKeys();
    this.subscriptions.add(this.poPageDynamicTableActionsService.beforeRemoveAll(actionBeforeRemoveAll, originalResourcesKeys).pipe(switchMap((beforeRemove) => this.deleteAllAction(actionRemoveAll, beforeRemove, originalResourcesKeys))).subscribe());
  }
  getSelectedItemsKeys() {
    const resources = this.items.filter((item) => item.$selected);
    if (resources.length === 0) {
      return;
    }
    return this.returnResourcesKeys(resources);
  }
  returnResourcesKeys(resources) {
    return mapArrayByProperties(resources, this.keys);
  }
  deleteAllAction(actionRemoveAll, beforeRemoveAll, originalResources) {
    const {
      allowAction,
      newUrl,
      resources
    } = beforeRemoveAll ?? {};
    const allow = allowAction ?? true;
    const resourcestoDelete = resources ?? originalResources;
    if (allow && Array.isArray(resourcestoDelete)) {
      if (typeof actionRemoveAll === "boolean" || newUrl) {
        return this.poPageDynamicService.deleteResources(resourcestoDelete, newUrl).pipe(tap(() => {
          this.removeFromUI(resourcestoDelete, this.literals.removeAllSuccessNotification);
        }));
      }
      return of(actionRemoveAll(resourcestoDelete)).pipe(tap((removeItems) => this.removeFromUI(removeItems, this.literals.removeSuccessNotification)));
    }
    return of({});
  }
  removeLocalItems(itemsKeysToRemove = []) {
    if (itemsKeysToRemove.length) {
      this.items = this.items.filter((item) => {
        const itemKey = this.formatUniqueKey(item);
        return !itemsKeysToRemove.find((itemKeyToRemove) => valuesFromObject(itemKeyToRemove).join("|") === itemKey);
      });
    }
  }
  resolveUrl(item, path) {
    const uniqueKey = this.formatUniqueKey(item);
    return path.replace(/:id/g, uniqueKey);
  }
  setPageActions(actions) {
    if (actions?.new) {
      this.defaultPageActions = [{
        label: this.literals.pageAction,
        action: this.openNew.bind(this, actions.new)
      }];
    }
  }
  transformCustomActionsToPageListAction(customActions) {
    return customActions.map((customAction) => __spreadProps(__spreadValues({
      label: customAction.label,
      action: this.callPageCustomAction.bind(this, customAction),
      disabled: this.isDisablePageCustomAction.bind(this, customAction)
    }, customAction.icon && {
      icon: customAction.icon
    }), {
      visible: customAction.visible
    }));
  }
  transformTableCustomActionsToTableActions(tableCustomActions) {
    return tableCustomActions.map((tableCustomAction) => ({
      label: tableCustomAction.label,
      icon: tableCustomAction.icon,
      action: this.callTableCustomAction.bind(this, tableCustomAction),
      disabled: tableCustomAction.disabled,
      visible: tableCustomAction.visible
    }));
  }
  isDisablePageCustomAction(customAction) {
    return customAction.selectable && !this.getSelectedItemsKeys();
  }
  callPageCustomAction(customAction) {
    if (customAction.action) {
      const selectedItems = customAction.selectable ? this.getSelectedItemsKeys() : void 0;
      const sendCustomActionSubscription = this.poPageDynamicTableActionsService.customAction(customAction.action, selectedItems).subscribe();
      this.subscriptions.add(sendCustomActionSubscription);
    } else if (customAction.url) {
      this.navigateTo({
        path: customAction.url
      });
    }
  }
  callTableCustomAction(customAction, selectedItem) {
    this.itemSelectedAction = selectedItem;
    if (customAction.action) {
      const sendCustomActionSubscription = this.poPageDynamicTableActionsService.customAction(customAction.action, selectedItem).subscribe((updatedItem) => {
        if (typeof updatedItem === "object" && updatedItem !== null) {
          this.modifyUITableItem(selectedItem, removeKeysProperties(this.keys, updatedItem));
        }
      });
      this.subscriptions.add(sendCustomActionSubscription);
    } else if (customAction.url) {
      if (isExternalLink(customAction.url)) {
        openExternalLink(this.createConcatenatedUrl(customAction.concatKeys, customAction.url, selectedItem));
      } else {
        this.navigateTo({
          path: this.createConcatenatedUrl(customAction.concatKeys, customAction.url, selectedItem)
        });
      }
    }
  }
  setRemoveAllAction() {
    const action = this._actions;
    if (this.showRemove(action.removeAll)) {
      this.defaultPageActions = [...this._defaultPageActions, {
        label: this.literals.pageActionRemoveAll,
        action: this.confirmRemoveAll.bind(this, action.removeAll, action.beforeRemoveAll),
        disabled: this.disableRemoveAll.bind(this),
        type: "danger"
      }];
    }
  }
  disableRemoveAll() {
    return !this.getSelectedItemsKeys();
  }
  setTableActions(actions) {
    if (actions) {
      const visibleRemove = this.showRemove(actions.remove);
      this.defaultTableActions = [{
        action: this.openDetail.bind(this, actions.detail),
        label: this.literals.tableActionView,
        visible: !!this._actions.detail
      }, {
        action: this.openEdit.bind(this, actions.edit),
        label: this.literals.tableActionEdit,
        visible: !!this._actions.edit
      }, {
        action: this.openDuplicate.bind(this, actions.duplicate),
        label: this.literals.tableActionDuplicate,
        visible: !!this._actions.duplicate
      }, {
        action: this.confirmRemove.bind(this, actions.remove, actions.beforeRemove),
        label: this.literals.tableActionDelete,
        separator: true,
        type: "danger",
        visible: visibleRemove
      }];
    }
  }
  loadDataFromAPI() {
    const {
      serviceApi: serviceApiFromRoute,
      serviceMetadataApi,
      serviceLoadApi
    } = this.activatedRoute.snapshot.data;
    const onLoad = serviceLoadApi || this.onLoad;
    this.serviceApi = serviceApiFromRoute || this.serviceApi;
    this.poPageDynamicService.configServiceApi({
      endpoint: this.serviceApi,
      metadata: serviceMetadataApi
    });
    const metadata$ = this.getMetadata(serviceApiFromRoute, onLoad);
    let data$;
    if (this.quickSearchValue) {
      const paramsQuickSearchValue = {
        [this.quickSearchParam]: this.quickSearchValue
      };
      data$ = this.loadData(paramsQuickSearchValue);
    } else {
      data$ = this.loadData();
    }
    this.subscriptions.add(metadata$.pipe(switchMap(() => {
      const initialFilters = this.getInitialValuesFromFilter();
      if (!Object.keys(initialFilters).length) {
        return data$;
      }
      return EMPTY;
    })).subscribe());
  }
  getInitialValuesFromFilter() {
    const initialFilters = this.filters.reduce((result, item) => Object.assign(result, {
      [item.property]: item.initValue
    }), {});
    Object.keys(initialFilters).forEach((key) => {
      if (!initialFilters[key]) {
        delete initialFilters[key];
      }
    });
    return initialFilters;
  }
  loadOptionsOnInitialize(onLoad) {
    if (onLoad) {
      return this.getPoDynamicPageOptions(onLoad).pipe(tap((responsePoOption) => this.poPageCustomizationService.changeOriginalOptionsToNewOptions(this, responsePoOption)));
    }
    return of(null);
  }
  getPoDynamicPageOptions(onLoad) {
    const originalOption = {
      fields: this.fields,
      actions: this.actions,
      breadcrumb: this.breadcrumb,
      title: this.title,
      keepFilters: this.keepFilters,
      concatFilters: this.concatFilters,
      hideRemoveAllDisclaimer: this.hideRemoveAllDisclaimer,
      hideCloseDisclaimers: this.hideCloseDisclaimers,
      pageCustomActions: this.pageCustomActions,
      tableCustomActions: this.tableCustomActions,
      quickSearchWidth: this.quickSearchWidth
    };
    const pageOptionSchema = {
      schema: [{
        nameProp: "fields",
        merge: true,
        keyForMerge: "property"
      }, {
        nameProp: "actions",
        merge: true
      }, {
        nameProp: "breadcrumb"
      }, {
        nameProp: "title"
      }, {
        nameProp: "keepFilters"
      }, {
        nameProp: "quickSearchWidth"
      }, {
        nameProp: "concatFilters"
      }, {
        nameProp: "hideRemoveAllDisclaimer"
      }, {
        nameProp: "hideCloseDisclaimers"
      }, {
        nameProp: "pageCustomActions",
        merge: true,
        keyForMerge: "label"
      }, {
        nameProp: "tableCustomActions",
        merge: true,
        keyForMerge: "label"
      }]
    };
    return this.poPageCustomizationService.getCustomOptions(onLoad, originalOption, pageOptionSchema);
  }
  showRemove(actionRemove) {
    const action = actionRemove ?? false;
    if (typeof action === "boolean") {
      return action;
    }
    return true;
  }
  updateFilterValue(filter) {
    return this.fields.map((item) => {
      if (filter.hasOwnProperty(item.property)) {
        item.initValue = filter[item.property];
      }
    });
  }
  updatePageActions() {
    this.pageActions = [...this._defaultPageActions, ...this._customPageListActions];
  }
  updateTableActions() {
    const defaultTableActionsWithoutActionDelete = this._defaultTableActions.filter((tableAction) => tableAction.label !== this.literals.tableActionDelete);
    const tableActionDelete = this._defaultTableActions.find((tableAction) => tableAction.label === this.literals.tableActionDelete);
    const newTableActions = [...defaultTableActionsWithoutActionDelete, ...this._customTableActions];
    if (tableActionDelete) {
      newTableActions.push(tableActionDelete);
    }
    this.tableActions = newTableActions;
  }
  static \u0275fac = function PoPageDynamicTableComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicTableComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageDynamicTableComponent,
    selectors: [["po-page-dynamic-table"]],
    inputs: {
      onLoad: [0, "p-load", "onLoad"],
      keepFilters: [2, "p-keep-filters", "keepFilters", convertToBoolean],
      actionRight: [2, "p-actions-right", "actionRight", convertToBoolean],
      concatFilters: [2, "p-concat-filters", "concatFilters", convertToBoolean],
      hideColumnsManager: [2, "p-hide-columns-manager", "hideColumnsManager", convertToBoolean],
      hideRemoveAllDisclaimer: [2, "p-hide-remove-all-disclaimer", "hideRemoveAllDisclaimer", convertToBoolean],
      infiniteScroll: [2, "p-infinite-scroll", "infiniteScroll", convertToBoolean],
      actions: [0, "p-actions", "actions"],
      componentsSize: [0, "p-components-size", "componentsSize"],
      pageCustomActions: [0, "p-page-custom-actions", "pageCustomActions"],
      tableCustomActions: [0, "p-table-custom-actions", "tableCustomActions"],
      quickSearchWidth: [0, "p-quick-search-width", "quickSearchWidth"],
      height: [0, "p-height", "height"],
      hideCloseDisclaimers: [0, "p-hide-close-disclaimers", "hideCloseDisclaimers"],
      quickSearchParam: [0, "p-quick-search-param", "quickSearchParam"],
      quickSearchValue: [0, "p-quick-search-value", "quickSearchValue"],
      searchLiterals: [0, "p-literals", "searchLiterals"],
      spacing: [0, "p-spacing", "spacing"],
      textWrap: [2, "p-text-wrap", "textWrap", convertToBoolean],
      draggable: [0, "p-draggable", "draggable"],
      virtualScroll: [0, "p-virtual-scroll", "virtualScroll"],
      visibleFixedFilters: [0, "p-visible-fixed-filters", "visibleFixedFilters"]
    },
    standalone: false,
    features: [\u0275\u0275ProvidersFeature([PoPageDynamicService]), \u0275\u0275InheritDefinitionFeature],
    decls: 2,
    vars: 28,
    consts: [[3, "p-advanced-search", "p-change-disclaimers", "p-quick-search", "p-actions", "p-breadcrumb", "p-components-size", "p-hide-close-disclaimers", "p-filters", "p-keep-filters", "p-literals", "p-concat-filters", "p-hide-remove-all-disclaimer", "p-quick-search-width", "p-title", "p-visible-fixed-filters", "p-quick-search-value"], [3, "p-show-more", "p-sort-by", "p-change-visible-columns", "p-restore-column-manager", "p-sort", "p-actions", "p-actions-right", "p-selectable", "p-columns", "p-components-size", "p-items", "p-height", "p-hide-columns-manager", "p-infinite-scroll", "p-show-more-disabled", "p-text-wrap", "p-draggable", "p-spacing", "p-virtual-scroll"]],
    template: function PoPageDynamicTableComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "po-page-dynamic-search", 0);
        \u0275\u0275listener("p-advanced-search", function PoPageDynamicTableComponent_Template_po_page_dynamic_search_p_advanced_search_0_listener($event) {
          return ctx.onAdvancedSearch($event);
        })("p-change-disclaimers", function PoPageDynamicTableComponent_Template_po_page_dynamic_search_p_change_disclaimers_0_listener($event) {
          return ctx.onChangeDisclaimers($event);
        })("p-quick-search", function PoPageDynamicTableComponent_Template_po_page_dynamic_search_p_quick_search_0_listener($event) {
          return ctx.onQuickSearch($event);
        });
        \u0275\u0275elementStart(1, "po-table", 1);
        \u0275\u0275listener("p-show-more", function PoPageDynamicTableComponent_Template_po_table_p_show_more_1_listener() {
          return ctx.showMore();
        })("p-sort-by", function PoPageDynamicTableComponent_Template_po_table_p_sort_by_1_listener($event) {
          return ctx.onSort($event);
        })("p-change-visible-columns", function PoPageDynamicTableComponent_Template_po_table_p_change_visible_columns_1_listener($event) {
          return ctx.onChangeVisibleColumns($event);
        })("p-restore-column-manager", function PoPageDynamicTableComponent_Template_po_table_p_restore_column_manager_1_listener($event) {
          return ctx.onColumnRestoreManager($event);
        })("p-sort-by", function PoPageDynamicTableComponent_Template_po_table_p_sort_by_1_listener($event) {
          return ctx.onSortBy($event);
        });
        \u0275\u0275elementEnd()();
      }
      if (rf & 2) {
        \u0275\u0275property("p-actions", ctx.pageActions)("p-breadcrumb", ctx.breadcrumb)("p-components-size", ctx.componentsSize)("p-hide-close-disclaimers", ctx.hideCloseDisclaimers)("p-filters", ctx.filters)("p-keep-filters", ctx.keepFilters)("p-literals", ctx.searchLiterals)("p-concat-filters", ctx.concatFilters)("p-hide-remove-all-disclaimer", ctx.hideRemoveAllDisclaimer)("p-quick-search-width", ctx.quickSearchWidth)("p-title", ctx.title)("p-visible-fixed-filters", ctx.visibleFixedFilters)("p-quick-search-value", ctx.quickSearchValue || "");
        \u0275\u0275advance();
        \u0275\u0275property("p-sort", true)("p-actions", ctx.tableActions)("p-actions-right", ctx.actionRight)("p-selectable", ctx.enableSelectionTable)("p-columns", ctx.columns)("p-components-size", ctx.componentsSize)("p-items", ctx.items)("p-height", ctx.height)("p-hide-columns-manager", ctx.hideColumnsManager)("p-infinite-scroll", ctx.infiniteScroll)("p-show-more-disabled", !ctx.hasNext)("p-text-wrap", ctx.textWrap)("p-draggable", ctx.draggable)("p-spacing", ctx.spacing)("p-virtual-scroll", ctx.virtualScroll);
      }
    },
    dependencies: [PoTableComponent, PoPageDynamicSearchComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicTableComponent, [{
    type: Component,
    args: [{
      selector: "po-page-dynamic-table",
      providers: [PoPageDynamicService],
      standalone: false,
      template: `<po-page-dynamic-search
  [p-actions]="pageActions"
  [p-breadcrumb]="breadcrumb"
  [p-components-size]="componentsSize"
  [p-hide-close-disclaimers]="hideCloseDisclaimers"
  [p-filters]="filters"
  [p-keep-filters]="keepFilters"
  [p-literals]="searchLiterals"
  [p-concat-filters]="concatFilters"
  [p-hide-remove-all-disclaimer]="hideRemoveAllDisclaimer"
  [p-quick-search-width]="quickSearchWidth"
  [p-title]="title"
  [p-visible-fixed-filters]="visibleFixedFilters"
  (p-advanced-search)="onAdvancedSearch($event)"
  (p-change-disclaimers)="onChangeDisclaimers($event)"
  (p-quick-search)="onQuickSearch($event)"
  [p-quick-search-value]="quickSearchValue || ''"
>
  <po-table
    [p-sort]="true"
    [p-actions]="tableActions"
    [p-actions-right]="actionRight"
    [p-selectable]="enableSelectionTable"
    [p-columns]="columns"
    [p-components-size]="componentsSize"
    [p-items]="items"
    [p-height]="height"
    [p-hide-columns-manager]="hideColumnsManager"
    [p-infinite-scroll]="infiniteScroll"
    [p-show-more-disabled]="!hasNext"
    (p-show-more)="showMore()"
    (p-sort-by)="onSort($event)"
    (p-change-visible-columns)="onChangeVisibleColumns($event)"
    (p-restore-column-manager)="onColumnRestoreManager($event)"
    (p-sort-by)="onSortBy($event)"
    [p-text-wrap]="textWrap"
    [p-draggable]="draggable"
    [p-spacing]="spacing"
    [p-virtual-scroll]="virtualScroll"
  >
  </po-table>
</po-page-dynamic-search>
`
    }]
  }], () => [], {
    onLoad: [{
      type: Input,
      args: ["p-load"]
    }],
    keepFilters: [{
      type: Input,
      args: [{
        alias: "p-keep-filters",
        transform: convertToBoolean
      }]
    }],
    actionRight: [{
      type: Input,
      args: [{
        alias: "p-actions-right",
        transform: convertToBoolean
      }]
    }],
    concatFilters: [{
      type: Input,
      args: [{
        alias: "p-concat-filters",
        transform: convertToBoolean
      }]
    }],
    hideColumnsManager: [{
      type: Input,
      args: [{
        alias: "p-hide-columns-manager",
        transform: convertToBoolean
      }]
    }],
    hideRemoveAllDisclaimer: [{
      type: Input,
      args: [{
        alias: "p-hide-remove-all-disclaimer",
        transform: convertToBoolean
      }]
    }],
    infiniteScroll: [{
      type: Input,
      args: [{
        alias: "p-infinite-scroll",
        transform: convertToBoolean
      }]
    }],
    actions: [{
      type: Input,
      args: ["p-actions"]
    }],
    componentsSize: [{
      type: Input,
      args: ["p-components-size"]
    }],
    pageCustomActions: [{
      type: Input,
      args: ["p-page-custom-actions"]
    }],
    tableCustomActions: [{
      type: Input,
      args: ["p-table-custom-actions"]
    }],
    quickSearchWidth: [{
      type: Input,
      args: ["p-quick-search-width"]
    }],
    height: [{
      type: Input,
      args: ["p-height"]
    }],
    hideCloseDisclaimers: [{
      type: Input,
      args: ["p-hide-close-disclaimers"]
    }],
    quickSearchParam: [{
      type: Input,
      args: ["p-quick-search-param"]
    }],
    quickSearchValue: [{
      type: Input,
      args: ["p-quick-search-value"]
    }],
    searchLiterals: [{
      type: Input,
      args: ["p-literals"]
    }],
    spacing: [{
      type: Input,
      args: ["p-spacing"]
    }],
    textWrap: [{
      type: Input,
      args: [{
        alias: "p-text-wrap",
        transform: convertToBoolean
      }]
    }],
    draggable: [{
      type: Input,
      args: ["p-draggable"]
    }],
    virtualScroll: [{
      type: Input,
      args: ["p-virtual-scroll"]
    }],
    visibleFixedFilters: [{
      type: Input,
      args: ["p-visible-fixed-filters"]
    }]
  });
})();
var PoPageDynamicTableModule = class _PoPageDynamicTableModule {
  static \u0275fac = function PoPageDynamicTableModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageDynamicTableModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoPageDynamicTableModule,
    declarations: [PoPageDynamicTableComponent],
    imports: [CommonModule, FormsModule, RouterModule, PoTableModule, PoPageDynamicSearchModule, PoPageCustomizationModule, PoPageDynamicModule],
    exports: [PoPageDynamicTableComponent]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    imports: [CommonModule, FormsModule, RouterModule, PoTableModule, PoPageDynamicSearchModule, PoPageCustomizationModule, PoPageDynamicModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageDynamicTableModule, [{
    type: NgModule,
    args: [{
      imports: [CommonModule, FormsModule, RouterModule, PoTableModule, PoPageDynamicSearchModule, PoPageCustomizationModule, PoPageDynamicModule],
      declarations: [PoPageDynamicTableComponent],
      exports: [PoPageDynamicTableComponent]
    }]
  }], null, null);
})();
var PoPageJobSchedulerInternal = class {
  periodicity = "single";
  firstExecution = /* @__PURE__ */ new Date();
  firstExecutionHour = this.getCurrentHour(this.firstExecution);
  recurrent = true;
  frequency = {};
  getCurrentHour(date) {
    const hours = date.getHours() < 10 ? "0" + date.getHours() : date.getHours();
    const minutes = date.getMinutes() < 10 ? "0" + date.getMinutes() : date.getMinutes();
    return `${hours}:${minutes}`;
  }
};
var PoPageJobSchedulerService = class _PoPageJobSchedulerService {
  http = inject(HttpClient);
  headers = new HttpHeaders({
    "X-PO-SCREEN-LOCK": "true"
  });
  endpoint = "/";
  configServiceApi(config = {}) {
    this.endpoint = config.endpoint;
  }
  // Cria um recurso
  createResource(resource) {
    const newResouce = this.convertToJobScheduler(resource);
    return this.http.post(`${this.endpoint}`, newResouce, {
      headers: this.headers
    });
  }
  getHeadProcesses() {
    const headers = {
      "X-PO-No-Error": "true"
    };
    return this.http.head(`${this.endpoint}/processes`, {
      headers
    });
  }
  // Busca parametros pelo processo id
  getParametersByProcess(processId) {
    return this.http.get(`${this.endpoint}/processes/${processId}/parameters`, {
      headers: this.headers
    }).pipe(map((resource) => resource.items));
  }
  // Busca um único recurso
  getProcess(id) {
    return this.http.get(`${this.endpoint}/processes/${id}`, {
      headers: this.headers
    });
  }
  // Busca uma lista de processos
  getProcesses(params = {}) {
    return this.http.get(`${this.endpoint}/processes`, {
      params
    });
  }
  // Busca um único recurso
  getResource(id) {
    return this.http.get(`${this.endpoint}/${id}`, {
      headers: this.headers
    }).pipe(map((resource) => this.convertToJobSchedulerInternal(resource)));
  }
  // Atualiza um recurso
  updateResource(id, resource) {
    const newResouce = this.convertToJobScheduler(resource);
    return this.http.put(`${this.endpoint}/${id}`, newResouce, {
      headers: this.headers
    });
  }
  convertToJobScheduler(jobSchedulerInternal) {
    const jobScheduler = __spreadValues({}, jobSchedulerInternal);
    if (jobSchedulerInternal.periodicity) {
      if (jobSchedulerInternal.periodicity === "single") {
        jobScheduler.recurrent = false;
      } else {
        Object.assign(jobScheduler, this.convertToPeriodicity(jobSchedulerInternal));
      }
    }
    if (jobSchedulerInternal.firstExecutionHour) {
      jobScheduler.firstExecution = this.replaceHourFirstExecution(jobSchedulerInternal.firstExecution, jobSchedulerInternal.firstExecutionHour);
    }
    if (jobSchedulerInternal.frequency && jobSchedulerInternal.frequency.type) {
      jobScheduler.rangeExecutions = {
        frequency: __spreadValues({}, jobSchedulerInternal.frequency)
      };
      if (jobSchedulerInternal.rangeLimitHour) {
        const splitRangeLimitHour = jobSchedulerInternal.rangeLimitHour.split(":");
        jobScheduler.rangeExecutions.rangeLimit = {
          hour: parseInt(splitRangeLimitHour[0], 10),
          minute: parseInt(splitRangeLimitHour[1], 10)
        };
      }
      if (jobSchedulerInternal.rangeLimitDay) {
        jobScheduler.rangeExecutions.rangeLimit = __spreadProps(__spreadValues({}, jobScheduler.rangeExecutions.rangeLimit), {
          day: jobSchedulerInternal.rangeLimitDay
        });
      }
    }
    if (!Object.keys(this.returnValidExecutionParameter(jobScheduler.executionParameter)).length) {
      delete jobScheduler.executionParameter;
    }
    this.removeInvalidKeys(jobScheduler);
    return jobScheduler;
  }
  convertToJobSchedulerInternal(jobScheduler = {}) {
    const jobSchedulerInternal = __spreadValues({}, jobScheduler);
    if (jobScheduler.firstExecution) {
      jobSchedulerInternal.firstExecutionHour = this.getHourFirstExecution(jobScheduler.firstExecution);
    }
    Object.assign(jobSchedulerInternal, this.convertToPeriodicityInternal(jobScheduler));
    if (jobScheduler.rangeExecutions) {
      jobSchedulerInternal.rangeLimitHour = `${jobScheduler.rangeExecutions.rangeLimit.hour < 10 ? "0" + jobScheduler.rangeExecutions.rangeLimit.hour : jobScheduler.rangeExecutions.rangeLimit.hour}:${jobScheduler.rangeExecutions.rangeLimit.minute < 10 ? "0" + jobScheduler.rangeExecutions.rangeLimit.minute : jobScheduler.rangeExecutions.rangeLimit.minute}`;
      jobSchedulerInternal.rangeLimitDay = jobScheduler.rangeExecutions.rangeLimit.day;
      jobSchedulerInternal.frequency = {
        type: jobScheduler.rangeExecutions.frequency.type,
        value: jobScheduler.rangeExecutions.frequency.value
      };
    }
    this.removeInvalidKeys(jobSchedulerInternal, ["weekly", "monthly", "daily"]);
    return jobSchedulerInternal;
  }
  convertToPeriodicity(value) {
    const newValue = {};
    const valuePeriodicity = value.periodicity;
    if (valuePeriodicity) {
      newValue[valuePeriodicity] = {};
      if (valuePeriodicity === "monthly") {
        newValue[valuePeriodicity].day = value.dayOfMonth ? parseInt(value.dayOfMonth, 10) : 0;
      } else if (valuePeriodicity === "weekly") {
        newValue[valuePeriodicity].daysOfWeek = value.daysOfWeek;
      }
      newValue[valuePeriodicity].hour = value.hour ? parseInt(value.hour.split(":")[0], 10) : 0;
      newValue[valuePeriodicity].minute = value.hour ? parseInt(value.hour.split(":")[1], 10) : 0;
    }
    return newValue;
  }
  convertToPeriodicityInternal(value = {}) {
    if (value.monthly) {
      return {
        periodicity: "monthly",
        hour: `${addZero(value.monthly.hour)}:${addZero(value.monthly.minute)}`,
        dayOfMonth: value.monthly.day
      };
    } else if (value.daily) {
      return {
        periodicity: "daily",
        hour: `${addZero(value.daily.hour)}:${addZero(value.daily.minute)}`
      };
    } else if (value.weekly) {
      return {
        periodicity: "weekly",
        hour: `${addZero(value.weekly.hour)}:${addZero(value.weekly.minute)}`,
        daysOfWeek: [...value.weekly.daysOfWeek]
      };
    } else {
      return {
        periodicity: "single"
      };
    }
  }
  getCurrentHour(date) {
    const hours = addZero(date.getHours());
    const minutes = addZero(date.getMinutes());
    return `${hours}:${minutes}`;
  }
  getHourFirstExecution(firstExecutionDate) {
    return this.getCurrentHour(new Date(firstExecutionDate));
  }
  removeInvalidKeys(value, keys2) {
    const invalidKeys = keys2 || ["periodicity", "hour", "minute", "day", "daysOfWeek", "dayOfMonth", "firstExecutionHour", "frequency", "rangeLimitHour", "rangeLimitDay"];
    Object.keys(value).forEach((key) => {
      if (invalidKeys.includes(key)) {
        delete value[key];
      } else if (key === "rangeExecutions" && value["periodicity"] === "single") {
        delete value[key];
      }
    });
  }
  replaceHourFirstExecution(date, time) {
    try {
      if (!date) {
        return date;
      }
      const dateSplited = date.split("-");
      const timeSplited = time.split(":");
      if (dateSplited.length < 2 || timeSplited.length < 1) {
        return date;
      }
      const year = parseInt(dateSplited[0]);
      const monthIndex = parseInt(dateSplited[1]) - 1;
      const day = parseInt(dateSplited[2]);
      const hours = parseInt(timeSplited[0], 10);
      const minutes = parseInt(timeSplited[1], 10);
      const firstExecutionDate = new Date(year, monthIndex, day, hours, minutes);
      if (!(firstExecutionDate instanceof Date && !isNaN(firstExecutionDate.getTime()))) {
        return date;
      }
      return convertDateToISOExtended(firstExecutionDate);
    } catch {
      return date;
    }
  }
  returnValidExecutionParameter(parameter) {
    const newParameter = __spreadValues({}, parameter);
    for (const key in newParameter) {
      if (newParameter.hasOwnProperty(key) && newParameter[key] === void 0) {
        delete newParameter[key];
      }
    }
    return newParameter;
  }
  static \u0275fac = function PoPageJobSchedulerService_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageJobSchedulerService)();
  };
  static \u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
    token: _PoPageJobSchedulerService,
    factory: _PoPageJobSchedulerService.\u0275fac,
    providedIn: "root"
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageJobSchedulerService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], null, null);
})();
var PoPageJobSchedulerBaseComponent = class _PoPageJobSchedulerBaseComponent {
  poPageJobSchedulerService;
  _componentsSize = void 0;
  /** Objeto com as propriedades do breadcrumb. */
  breadcrumb = {
    items: []
  };
  /**
   * @optional
   *
   * @description
   *
   * Define o tamanho dos componentes de formulário no template:
   * - `small`: aplica a medida small de cada componente (disponível apenas para acessibilidade AA).
   * - `medium`: aplica a medida medium de cada componente.
   *
   * > Caso a acessibilidade AA não esteja configurada, o tamanho `medium` será mantido.
   * Para mais detalhes, consulte a documentação do [po-theme](https://po-ui.io/documentation/po-theme).
   *
   * @default `medium`
   */
  set componentsSize(value) {
    this._componentsSize = validateSizeFn(value);
  }
  get componentsSize() {
    return this._componentsSize ?? getDefaultSizeFn();
  }
  /**
   * Endpoint usado pelo componente para busca dos processos e parâmetros que serão utilizados para criação e edição dos agendamentos.
   *
   * #### Processos
   *
   * Os processos são as tarefas que estarão disponíveis para o usuário poder fazer os agendamentos.
   * Ao inicializar o componente, será feito uma requisição `GET` para o endpoint `{service-api}/processes`, para buscar
   * essa lista de processos.
   *
   * Este endpoint `{service-api}/processes` deve retornar uma lista de objetos que seguem a definição de dados abaixo:
   *
   * ```
   * GET {service-api}/processes
   * ```
   *
   * ```
   * {
   *   items: [
   *     { "processID": "ac4f", "description": "Gerar folha de pagamento" },
   *     { "processID": "df6l", "description": "Relatório de imposto a recolher" },
   *     { "processID": "dk3p", "description": "Títulos em aberto" },
   *   ]
   * }
   * ```
   *
   * Desta forma será renderizado um componente para selecionar o processo e/ou filtrá-los.
   *
   * Para realizar o filtro de busca do processo, será feita uma requisição enviando o conteúdo digitado na busca através do
   * parâmetro `search`. Da seguinte forma:
   *
   * ```
   * GET {service-api}/processes?search=relatorio
   * ```
   *
   * > Veja mais sobre paginação e filtros no [Guia de implementação de APIs](guides/api).
   * Caso seja informada a propriedade `p-parameters` não serão realizadas as requisições de processos e nem de parametros automaticamente.
   *
   * Também é possível fazer um agendamento de um processo específico, sem que seja necessário um endpoint para busca desses
   * processos. Então, caso o endpoint `{service-api}/processes` não seja válido, será apresentado um campo de entrada de
   * texto para o usuário informar diretamente
   * o **identificador do processo - `processID`** e ao salvar será enviado um `POST` para o endpoint difinido `serviceApi` conforme abaixo:
   *
   * ```
   * POST {service-api}
   * ```
   *
   * *Request payload* - estrutura de dados enviada no corpo da requisição conforme interface `PoJobScheduler`:
   *
   * ```
   * {
   *   "daily": { "hour": 10, "minute": 12 },
   *   "firstExecution": "2018-12-07T00:00:01-00:00",
   *   "recurrent": true,
   *   "processID": "ac0405"
   *   ...
   * }
   * ```
   *
   * Caso seja necessário informar parâmetros e adicionar configurações no processo selecionado, será realizado um `GET`
   * como exemplificado abaixo. Os parâmetros devem retornar uma lista de objetos que seguem a interface
   * [PoDynamicFormField](/documentation/po-dynamic-form). Porém, caso utilizar a propriedade `p-parameters` o componente não
   * realizará a busca automática e o campo de processos não será exibido.
   *
   * ```
   * GET {service-api}/processes/:id/parameters
   * ...
   * {
   *   items: [
   *     { "property": "vencimento", type: "date" },
   *     { "property": "imposto-retido", "label": "Imposto Retido", type: "boolean" }
   *   ]
   * }
   * ```
   *
   * #### Salvar e Atualizar
   *
   * Para salvar o agendamento, será feita uma requisição de criação, passando os valores preenchidos pelo usuário via *payload*.
   * Abaixo uma requisição `POST` disparada, onde as propriedades do *Job Scheduler* foram preenchidas:
   *
   * ```
   *  POST {service-api}
   * ```
   *
   * *Request payload* - estrutura de dados enviada no corpo da requisição conforme interface `PoJobScheduler`:
   *
   * ```
   * {
   *   "firstExecution": "2018-12-07T00:00:01-00:00",
   *   "recurrent": true,
   *   "monthly": { "day": 1, "hour": 10, "minute": 0 },
   *   "processID": "ac0405",
   *   "rangeExecutions: { "frequency": { "type": "hour", "value": 2 }, "rangeLimit": { "hour": 18, "minute": 0, "day": 20 } }
   * }
   * ```
   *
   * Caso queira que o componente carregue um agendamento já existente, deve ser incluído um parâmetro na rota chamado `id`.
   *
   * Exemplo de configuração de rota:
   *
   * ```
   *  RouterModule.forRoot([
   *    ...
   *    { path: 'edit/:id', component: ExampleJobSchedulerComponent },
   *    ...
   *  ],
   * ```
   *
   * Baseado nisso, na inicialização do template será disparado uma requisição para buscar o recurso que será editado.
   *
   * ```
   * GET {service-api}/{id}
   * ```
   *
   * Ao atualizar o agendamento, será disparado um `PUT` com os dados preenchidos.
   * Veja abaixo uma requisição `PUT` disparada, onde a propriedade *recurrent* e *daily* foram atualizadas:
   *
   * ```
   *  PUT {service-api}/{id}
   * ```
   *
   * *Request payload* - estrutura de dados enviada no corpo da requisição conforme interface `PoJobScheduler`:
   *
   * ```
   * {
   *   "firstExecution": "2018-12-07T00:00:01-00:00",
   *   "recurrent": true,
   *   "processID": "ac0405",
   *   "monthly": { "day": 1, "hour": 10, "minute": 0 },
   *   "processID": "ac0405",
   *   "rangeExecutions: { "frequency": { "type": "hour", "value": 2 }, "rangeLimit": { "hour": 18, "minute": 0, "day": 20 } }
   * }
   * ```
   */
  serviceApi;
  /** Título da página. */
  title;
  /**
   * Parâmetros que serão utilizados para criação e edição dos agendamentos.
   *
   * Ao utilizar esta propriedade, o componente não buscará automaticamente os parâmetros da API e o campo para preenchimento do processo não será exibido.
   *
   */
  parameters = [];
  set value(value) {
    this.model = this.poPageJobSchedulerService.convertToJobSchedulerInternal(value);
  }
  /**
   * @optional
   *
   * @description
   *
   * Define a orientação de exibição do `po-stepper`.
   *
   * > Quando não utilizada, segue o comportamento com base nas dimensões da tela.
   *
   * > Veja os valores válidos no *enum* [PoStepperOrientation](documentation/po-stepper#stepperOrientation).
   *
   */
  set stepperDefaultOrientation(value) {
    this._orientation = Object.values(PoStepperOrientation).includes(value) ? value : void 0;
  }
  get stepperDefaultOrientation() {
    return this._orientation;
  }
  /**
   * @optional
   *
   * @description
   *
   * Função chamada após realizar a confirmação da execução no PoPageJobScheduler.
   * Permite alterar os valores do model do PoPageJobScheduler antes de realizar o envio para a Api.
   *
   * > Deve retornar um objeto do tipo `PoPageJobScheduler` para ser adicionado ao model do PoPageJobScheduler.
   *
   * > Ao ser disparada, a mesma receberá por parâmetro o model do PoPageJobScheduler de interface `PoJobSchedulerInternal`.
   *
   * O contexto da função que será chamada, será o mesmo que o do `PoPageJobScheduler`, então para poder alterar
   * para o contexto do componente que o está utilizando, pode ser utilizado a propriedade `bind` do Javascript.
   * Por exemplo, para a função `beforeSend`:
   *
   * ```
   * <po-page-job-scheduler [p-service-api]="serviceApi" [p-parameters]="params" [p-before-send]="beforeSend.bind(this)">
   * ...
   * </po-page-job-scheduler>
   * ```
   */
  beforeSendAction;
  /**
   * @optional
   *
   * @description
   *
   * Define se o step `Agendamento` deve ser exibido como o último na sequência de steps
   *
   * > Aplicável apenas quando utilizado `PoJobSchedulerParametersTemplateDirective`
   */
  stepExecutionLast;
  /**
   * @optional
   *
   * @description
   *
   * Evento disparado ao concluir o processo de agendamento com sucesso.
   */
  success = new EventEmitter();
  /**
   * @optional
   *
   * @description
   *
   * Evento disparado ao ocorrer um erro impossibilitando a conclusão do agendamento.
   * Para este evento será passado como parâmetro os detalhes do erro.
   */
  error = new EventEmitter();
  model = new PoPageJobSchedulerInternal();
  _subscription = new Subscription();
  _orientation;
  constructor(poPageJobSchedulerService) {
    this.poPageJobSchedulerService = poPageJobSchedulerService;
  }
  ngOnDestroy() {
    this._subscription.unsubscribe();
  }
  loadData(id) {
    if (!id) {
      this.model = this.model || new PoPageJobSchedulerInternal();
      return;
    }
    this._subscription.add(this.poPageJobSchedulerService.getResource(id).subscribe((response) => {
      this.model = response;
    }, () => {
      this.model = new PoPageJobSchedulerInternal();
    }));
  }
  markAsDirtyInvalidControls(controls) {
    for (const key in controls) {
      if (controls.hasOwnProperty(key)) {
        const control = controls[key];
        if (control.invalid) {
          control.markAsDirty();
        }
      }
    }
  }
  static \u0275fac = function PoPageJobSchedulerBaseComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageJobSchedulerBaseComponent)(\u0275\u0275directiveInject(PoPageJobSchedulerService));
  };
  static \u0275dir = /* @__PURE__ */ \u0275\u0275defineDirective({
    type: _PoPageJobSchedulerBaseComponent,
    inputs: {
      breadcrumb: [0, "p-breadcrumb", "breadcrumb"],
      componentsSize: [0, "p-components-size", "componentsSize"],
      serviceApi: [0, "p-service-api", "serviceApi"],
      title: [0, "p-title", "title"],
      parameters: [0, "p-parameters", "parameters"],
      value: [0, "p-value", "value"],
      stepperDefaultOrientation: [0, "p-orientation", "stepperDefaultOrientation"],
      beforeSendAction: [0, "p-before-send", "beforeSendAction"],
      stepExecutionLast: [0, "p-step-execution-last", "stepExecutionLast"]
    },
    outputs: {
      success: "p-success",
      error: "p-error"
    }
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageJobSchedulerBaseComponent, [{
    type: Directive
  }], () => [{
    type: PoPageJobSchedulerService
  }], {
    breadcrumb: [{
      type: Input,
      args: ["p-breadcrumb"]
    }],
    componentsSize: [{
      type: Input,
      args: ["p-components-size"]
    }],
    serviceApi: [{
      type: Input,
      args: ["p-service-api"]
    }],
    title: [{
      type: Input,
      args: ["p-title"]
    }],
    parameters: [{
      type: Input,
      args: ["p-parameters"]
    }],
    value: [{
      type: Input,
      args: ["p-value"]
    }],
    stepperDefaultOrientation: [{
      type: Input,
      args: ["p-orientation"]
    }],
    beforeSendAction: [{
      type: Input,
      args: ["p-before-send"]
    }],
    stepExecutionLast: [{
      type: Input,
      args: ["p-step-execution-last"]
    }],
    success: [{
      type: Output,
      args: ["p-success"]
    }],
    error: [{
      type: Output,
      args: ["p-error"]
    }]
  });
})();
var poPageJobSchedulerLiteralsDefault = {
  en: {
    at: "at",
    back: "Back",
    next: "Next",
    periodicity: "Periodicity",
    execution: "Execution",
    process: "Process",
    enterProcess: "Enter a process",
    recurrent: "Recurrent",
    single: "Single",
    daily: "Daily",
    weekly: "Weekly",
    monthly: "Monthly",
    scheduling: "Scheduling",
    parameterization: "Parameterization",
    conclude: "Conclude",
    firstExecution: "First Execution",
    startTime: "Start time",
    endTime: "End time",
    time: "Time",
    hour: "Hour",
    minute: "Minute",
    day: "Day",
    endDay: "End day",
    startDay: "Start day",
    weekDays: "Week days",
    sunday: "Sunday",
    monday: "Monday",
    tuesday: "Tuesday",
    wednesday: "Wednesday",
    thursday: "Thursday",
    friday: "Friday",
    saturday: "Saturday",
    parameters: "Parameters",
    yes: "Yes",
    no: "No",
    notReported: "Not reported",
    periodicityData: "Periodicity data",
    confirmation: "Confirmation",
    confirmSaveMessage: "Are you sure you want to complete this schedule?",
    confirmUpdateMessage: "Are you sure you want to update this schedule?",
    saveNotificationSuccessUpdate: "Successfully updated scheduling",
    saveNotificationSuccessSave: "Successfully saved scheduling",
    parametersNotFound: "Parameters not found.",
    frequency: "Frequency",
    to: "to",
    from: "from"
  },
  es: {
    at: "a las",
    back: "Volver",
    next: "Avanzar",
    periodicity: "Periodicidad",
    execution: "Ejecuci\xF3n",
    process: "Proceso",
    enterProcess: "Informe un proceso",
    recurrent: "Recurrente",
    single: "\xDAnica",
    daily: "Diaria",
    weekly: "Semanal",
    monthly: "Mensual",
    scheduling: "Programaci\xF3n",
    parameterization: "Parametrizaci\xF3n",
    conclude: "Completar",
    firstExecution: "Primera ejecuci\xF3n",
    startTime: "Hora de inicio",
    endTime: "Hora de finalizaci\xF3n",
    time: "Hor\xE1rio",
    hour: "Hora",
    minute: "Minute",
    day: "D\xEDa",
    endDay: "\xDAltimo D\xEDa",
    startDay: "D\xEDa de inicio",
    weekDays: "Dias de la semana",
    sunday: "Domingo",
    monday: "Lunes",
    tuesday: "Martes",
    wednesday: "Mi\xE9rcoles",
    thursday: "Jueves",
    friday: "Viernes",
    saturday: "S\xE1bado",
    parameters: "Par\xE1metros",
    yes: "S\xED",
    no: "No",
    notReported: "No informado",
    periodicityData: "Dados da periodicidade",
    confirmation: "Confirmaci\xF3n",
    confirmSaveMessage: "\xBFEst\xE1 seguro de que desea completar esta programaci\xF3n de proceso?",
    confirmUpdateMessage: "\xBFEst\xE1 seguro de que desea cambiar esta programaci\xF3n de proceso?",
    saveNotificationSuccessUpdate: "Programaci\xF3n de proceso actualizada con \xE9xito.",
    saveNotificationSuccessSave: "Programaci\xF3n de proceso salvo con \xE9xito.",
    parametersNotFound: "No se encontraron par\xE1metros.",
    frequency: "Frecuencia",
    to: "de",
    from: "a"
  },
  pt: {
    at: "\xE0s",
    back: "Voltar",
    next: "Avan\xE7ar",
    periodicity: "Periodicidade",
    execution: "Execu\xE7\xE3o",
    process: "Processo",
    enterProcess: "Informe um processo",
    recurrent: "Recorrente",
    single: "\xDAnica",
    daily: "Di\xE1ria",
    weekly: "Semanal",
    monthly: "Mensal",
    scheduling: "Agendamento",
    parameterization: "Parametriza\xE7\xE3o",
    conclude: "Concluir",
    firstExecution: "Primeira execu\xE7\xE3o",
    startTime: "Hor\xE1rio inicial",
    endTime: "Hor\xE1rio final",
    time: "Hor\xE1rio",
    hour: "Hora",
    minute: "Minuto",
    day: "Dia",
    endDay: "Dia final",
    startDay: "Dia inicial",
    weekDays: "Dias de semana",
    sunday: "Domingo",
    monday: "Segunda-feira",
    tuesday: "Ter\xE7a-feira",
    wednesday: "Quarta-feira",
    thursday: "Quinta-feira",
    friday: "Sexta-feira",
    saturday: "S\xE1bado",
    parameters: "Par\xE2metros",
    yes: "Sim",
    no: "N\xE3o",
    notReported: "N\xE3o informado",
    periodicityData: "Dados da periodicidade",
    confirmation: "Confirma\xE7\xE3o",
    confirmSaveMessage: "Tem certeza que deseja concluir este agendamento de processo?",
    confirmUpdateMessage: "Tem certeza que deseja alterar este agendamento de processo?",
    saveNotificationSuccessUpdate: "Agendamento de processo atualizado com sucesso.",
    saveNotificationSuccessSave: "Agendamento de processo salvo com sucesso.",
    parametersNotFound: "Par\xE2metros n\xE3o foram encontrados.",
    frequency: "Frequ\xEAncia",
    to: "das",
    from: "at\xE9"
  },
  ru: {
    at: "\u0432",
    back: "\u041D\u0430\u0437\u0430\u0434",
    next: "\u0421\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439",
    periodicity: "\u041F\u0435\u0440\u0438\u043E\u0434\u0438\u0447\u043D\u043E\u0441\u0442\u044C",
    execution: "\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0435",
    process: "\u041F\u0440\u043E\u0446\u0435\u0441\u0441",
    enterProcess: "\u0423\u043A\u0430\u0436\u0438\u0442\u0435 \u043F\u0440\u043E\u0446\u0435\u0441\u0441",
    recurrent: "\u041F\u0435\u0440\u0438\u043E\u0434\u0438\u0447\u0435\u0441\u043A\u0438",
    single: "\u041E\u0434\u0438\u043D\u043E\u0447\u043D\u044B\u0439",
    daily: "\u0415\u0436\u0435\u0434\u043D\u0435\u0432\u043D\u043E",
    weekly: "\u0415\u0436\u0435\u043D\u0435\u0434\u0435\u043B\u044C\u043D\u043E",
    monthly: "\u0415\u0436\u0435\u043C\u0435\u0441\u044F\u0447\u043D\u043E",
    scheduling: "\u041F\u043B\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435",
    parameterization: "\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u0438\u0437\u0430\u0446\u0438\u044F",
    conclude: "\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044C",
    firstExecution: "\u041F\u0435\u0440\u0432\u0438\u0447\u043D\u043E\u0435 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0435",
    startTime: "\u043D\u0430\u0447\u0430\u043B\u044C\u043D\u043E\u0435 \u0432\u0440\u0435\u043C\u044F",
    endTime: "\u0432\u0440\u0435\u043C\u044F \u043E\u043A\u043E\u043D\u0447\u0430\u043D\u0438\u044F",
    time: "\u0440\u0430\u0441\u043F\u0438\u0441\u0430\u043D\u0438\u0435",
    hour: "\u0427\u0430\u0441",
    day: "\u0414\u0435\u043D\u044C",
    minute: "\u043C\u0438\u043D\u0443\u0442\u0430",
    endDay: "\u043F\u043E\u0441\u043B\u0435\u0434\u043D\u0438\u0439 \u0434\u0435\u043D\u044C",
    startDay: "\u0434\u0435\u043D\u044C \u043D\u0430\u0447\u0430\u043B\u0430",
    weekDays: "\u0420\u0430\u0431\u043E\u0447\u0438\u0435 \u0434\u043D\u0438",
    sunday: "\u0412\u043E\u0441\u043A\u0440\u0435\u0441\u0435\u043D\u044C\u0435",
    monday: "\u041F\u043E\u043D\u0435\u0434\u0435\u043B\u044C\u043D\u0438\u043A",
    tuesday: "\u0412\u0442\u043E\u0440\u043D\u0438\u043A",
    wednesday: "\u0421\u0440\u0435\u0434\u0430",
    thursday: "\u0427\u0435\u0442\u0432\u0435\u0440\u0433",
    friday: "\u041F\u044F\u0442\u043D\u0438\u0446\u0430",
    saturday: "\u0421\u0443\u0431\u0431\u043E\u0442\u0430",
    parameters: "\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B",
    yes: "\u0414\u0430",
    no: "\u041D\u0435\u0442",
    notReported: "\u041D\u0435 \u0441\u043E\u043E\u0431\u0449\u0430\u0435\u0442\u0441\u044F",
    periodicityData: "\u0414\u0430\u043D\u043D\u044B\u0435 \u043E \u043F\u0435\u0440\u0438\u043E\u0434\u0438\u0447\u043D\u043E\u0441\u0442\u0438",
    confirmation: "\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u0435",
    confirmSaveMessage: "\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044C \u044D\u0442\u043E \u0440\u0430\u0441\u043F\u0438\u0441\u0430\u043D\u0438\u0435?",
    confirmUpdateMessage: "\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u044C \u044D\u0442\u043E \u0440\u0430\u0441\u043F\u0438\u0441\u0430\u043D\u0438\u0435?",
    saveNotificationSuccessUpdate: "\u0420\u0430\u0441\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E",
    saveNotificationSuccessSave: "\u0420\u0430\u0441\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u043E ",
    parametersNotFound: "\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u044B",
    frequency: "\u0427\u0430\u0441\u0442\u043E\u0442\u0430",
    to: "\u0441",
    from: "\u0434\u043E"
  }
};
var PoPageJobSchedulerLookupService = class _PoPageJobSchedulerLookupService {
  poPageJobSchedulerService = inject(PoPageJobSchedulerService);
  getFilteredItems({
    filter,
    page,
    pageSize
  }) {
    const params = {
      page,
      pageSize,
      search: filter
    };
    return this.poPageJobSchedulerService.getProcesses(params);
  }
  getObjectByValue(processId) {
    return this.poPageJobSchedulerService.getProcess(processId);
  }
  static \u0275fac = function PoPageJobSchedulerLookupService_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageJobSchedulerLookupService)();
  };
  static \u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
    token: _PoPageJobSchedulerLookupService,
    factory: _PoPageJobSchedulerLookupService.\u0275fac,
    providedIn: "root"
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageJobSchedulerLookupService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], null, null);
})();
var PoJobSchedulerParametersTemplateDirective = class _PoJobSchedulerParametersTemplateDirective {
  templateRef;
  /**
   * @optional
   *
   * @description
   *
   * Objeto que deve conter as alterações feitas pelo componente de template que serão repassadas dentro do atributo
   * `executionParameter` para envio na api.
   *
   * > O componente deve manter essa propriedade atualizada. É chamada após o avançar da etapa de parametrização.
   */
  executionParameter;
  /**
   * @optional
   *
   * @default false
   *
   * @description
   *
   * Determina se deve desabilitar o botão de avançar para a próxima etapa
   *
   * > Pode ser utilizado para validar campos antes de avançar.
   */
  disabledAdvance = false;
  /**
   * @optional
   *
   * @description
   *
   * Determina o label do step
   */
  title;
  // Necessário manter templateRef para o funcionamento do row template.
  constructor(templateRef) {
    this.templateRef = templateRef;
  }
  static \u0275fac = function PoJobSchedulerParametersTemplateDirective_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoJobSchedulerParametersTemplateDirective)(\u0275\u0275directiveInject(TemplateRef));
  };
  static \u0275dir = /* @__PURE__ */ \u0275\u0275defineDirective({
    type: _PoJobSchedulerParametersTemplateDirective,
    selectors: [["", "p-job-scheduler-parameters-template", ""]],
    inputs: {
      executionParameter: [0, "p-execution-parameter", "executionParameter"],
      disabledAdvance: [0, "p-disable-advance", "disabledAdvance"],
      title: [0, "p-label-step", "title"]
    },
    standalone: false
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoJobSchedulerParametersTemplateDirective, [{
    type: Directive,
    args: [{
      selector: "[p-job-scheduler-parameters-template]",
      standalone: false
    }]
  }], () => [{
    type: TemplateRef
  }], {
    executionParameter: [{
      type: Input,
      args: ["p-execution-parameter"]
    }],
    disabledAdvance: [{
      type: Input,
      args: ["p-disable-advance"]
    }],
    title: [{
      type: Input,
      args: ["p-label-step"]
    }]
  });
})();
var PoJobSchedulerSummaryTemplateDirective = class _PoJobSchedulerSummaryTemplateDirective {
  templateRef;
  // Necessário manter templateRef para o funcionamento do row template.
  constructor(templateRef) {
    this.templateRef = templateRef;
  }
  static \u0275fac = function PoJobSchedulerSummaryTemplateDirective_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoJobSchedulerSummaryTemplateDirective)(\u0275\u0275directiveInject(TemplateRef));
  };
  static \u0275dir = /* @__PURE__ */ \u0275\u0275defineDirective({
    type: _PoJobSchedulerSummaryTemplateDirective,
    selectors: [["", "p-job-scheduler-summary-template", ""]],
    standalone: false
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoJobSchedulerSummaryTemplateDirective, [{
    type: Directive,
    args: [{
      selector: "[p-job-scheduler-summary-template]",
      standalone: false
    }]
  }], () => [{
    type: TemplateRef
  }], null);
})();
var PoPageJobSchedulerExecutionComponent = class _PoPageJobSchedulerExecutionComponent {
  poPageJobSchedulerService = inject(PoPageJobSchedulerService);
  poPageJobSchedulerLookup = inject(PoPageJobSchedulerLookupService);
  form;
  // templates
  dailyTemplate;
  monthlyTemplate;
  weeklyTempalte;
  componentsSize;
  isEdit = false;
  literals = {};
  noParameters = true;
  noCustomParamsComponent = true;
  changeProcess = new EventEmitter();
  dayPattern = "^(3[0-1]|[0-2][0-9]|[1-9]|0[1-9])$";
  existProcessAPI = true;
  minDateFirstExecution = /* @__PURE__ */ new Date();
  periodicityOptions = [];
  periodicityTemplates;
  timePattern = "^(2[0-3]|[01][0-9]):?([0-5][0-9])$";
  weekDays = [];
  frequencyOptions = [];
  containsFrequency = false;
  frequency = "hour";
  rangeLimitHour;
  _value = {};
  set value(value) {
    this._value = value && isTypeof(value, "object") ? value : {};
    this.containsFrequency = this._value.frequency && this._value.frequency.value ? true : false;
  }
  get value() {
    return this._value;
  }
  get startDateFirstExecution() {
    return this.isEdit ? void 0 : this.minDateFirstExecution;
  }
  get hourLabel() {
    return this.containsFrequency ? this.literals.startTime : this.literals.time;
  }
  get dayLabel() {
    return this.containsFrequency ? this.literals.startDay : this.literals.day;
  }
  ngAfterViewInit() {
    setTimeout(() => {
      this.subscribeProcessIdValueChanges();
      if (this.value.periodicity) {
        this.frequencyOptions = this.frequencyOptions.map((frequencyOption) => __spreadProps(__spreadValues({}, frequencyOption), {
          disabled: frequencyOption.value === "day" && this.value.periodicity !== "monthly"
        }));
      }
    });
  }
  ngOnInit() {
    this.periodicityTemplates = {
      daily: this.dailyTemplate,
      monthly: this.monthlyTemplate,
      weekly: this.weeklyTempalte
    };
    if (this.noParameters && this.noCustomParamsComponent) {
      this.checkExistsProcessesAPI();
    }
    this.periodicityOptions = this.getPeriodicityOptions();
    this.weekDays = this.getWeekDays();
    this.frequencyOptions = this.getFrequencyOptions();
  }
  onChangeContainsFrequency(containsFrequency) {
    if (containsFrequency) {
      this.value.frequency = {
        type: "hour",
        value: null
      };
    } else {
      this.value.frequency = {};
    }
    this.value.rangeLimitHour = null;
    this.value.rangeLimitDay = null;
    this.value.dayOfMonth = null;
  }
  onChangePeriodicityOptions(periodicity) {
    this.frequencyOptions = this.frequencyOptions.map((frequencyOption) => __spreadProps(__spreadValues({}, frequencyOption), {
      disabled: frequencyOption.value === "day" && periodicity !== "monthly"
    }));
    this.value.frequency.type = null;
  }
  onChangeFrequencyOptions() {
    this.value.rangeLimitHour = null;
  }
  checkExistsProcessesAPI() {
    this.poPageJobSchedulerService.getHeadProcesses().subscribe(void 0, (error) => {
      this.existProcessAPI = false;
    });
  }
  getPeriodicityOptions() {
    return [{
      label: this.literals.single,
      value: "single"
    }, {
      label: this.literals.daily,
      value: "daily"
    }, {
      label: this.literals.weekly,
      value: "weekly"
    }, {
      label: this.literals.monthly,
      value: "monthly"
    }];
  }
  getFrequencyOptions() {
    return [{
      label: this.literals.day,
      value: "day"
    }, {
      label: this.literals.hour,
      value: "hour"
    }, {
      label: this.literals.minute,
      value: "minute"
    }];
  }
  getWeekDays() {
    return [{
      label: this.literals.sunday,
      value: "Sunday"
    }, {
      label: this.literals.monday,
      value: "Monday"
    }, {
      label: this.literals.tuesday,
      value: "Tuesday"
    }, {
      label: this.literals.wednesday,
      value: "Wednesday"
    }, {
      label: this.literals.thursday,
      value: "Thursday"
    }, {
      label: this.literals.friday,
      value: "Friday"
    }, {
      label: this.literals.saturday,
      value: "Saturday"
    }];
  }
  subscribeProcessIdValueChanges() {
    this.form.controls["processID"]?.valueChanges.subscribe((processId) => {
      this.changeProcess.emit({
        processId,
        existAPI: this.existProcessAPI
      });
    });
  }
  static \u0275fac = function PoPageJobSchedulerExecutionComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageJobSchedulerExecutionComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageJobSchedulerExecutionComponent,
    selectors: [["po-page-job-scheduler-execution"]],
    viewQuery: function PoPageJobSchedulerExecutionComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c12, 7);
        \u0275\u0275viewQuery(_c13, 7);
        \u0275\u0275viewQuery(_c14, 7);
        \u0275\u0275viewQuery(_c15, 7);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.form = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.dailyTemplate = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.monthlyTemplate = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.weeklyTempalte = _t.first);
      }
    },
    inputs: {
      componentsSize: [0, "p-components-size", "componentsSize"],
      isEdit: [0, "p-is-edit", "isEdit"],
      literals: [0, "p-literals", "literals"],
      noParameters: [0, "p-no-parameters", "noParameters"],
      noCustomParamsComponent: [0, "p-no-custom-params-component", "noCustomParamsComponent"],
      value: [0, "p-value", "value"]
    },
    outputs: {
      changeProcess: "p-change-process"
    },
    standalone: false,
    decls: 21,
    vars: 17,
    consts: [["formExecution", "ngForm"], ["dailyTemplate", ""], ["weeklyTemplate", ""], ["monthlyTemplate", ""], ["inputHourTemplate", ""], [1, "po-row"], ["name", "processID", "p-required", "", 1, "po-md-12", 3, "ngModel", "p-disabled", "p-label", "p-placeholder", "p-size"], [1, "po-md-12", 3, "p-label"], ["name", "firstExecution", "p-placeholder", "dd/mm/aaaa", "p-required", "", 1, "po-md-4", 3, "ngModelChange", "ngModel", "p-disabled", "p-label", "p-min-date", "p-size"], ["name", "firstExecutionHour", "p-mask", "99:99", "p-mask-format-model", "", "p-placeholder", "HH:mm", "p-required", "", 1, "po-md-2", 3, "ngModelChange", "ngModel", "p-disabled", "p-label", "p-pattern", "p-size"], ["name", "periodicity", "p-columns", "4", "p-required", "", 1, "po-sm-12", 3, "ngModelChange", "p-change", "ngModel", "p-label", "p-options", "p-size"], ["name", "processID", "p-field-label", "description", "p-field-value", "processID", "p-required", "", 1, "po-md-12", 3, "ngModel", "p-disabled", "p-filter-service", "p-label", "p-placeholder", "p-size"], ["name", "processID", "p-field-label", "description", "p-field-value", "processID", "p-required", "", 1, "po-md-12", 3, "ngModelChange", "ngModel", "p-disabled", "p-filter-service", "p-label", "p-placeholder", "p-size"], ["name", "processID", "p-required", "", 1, "po-md-12", 3, "ngModelChange", "ngModel", "p-disabled", "p-label", "p-placeholder", "p-size"], ["name", "containsFrequency", 1, "po-md-12", 3, "ngModelChange", "p-change", "ngModel", "p-label", "p-label-off", "p-label-on", "p-size"], [4, "ngTemplateOutlet"], ["name", "recurrent", 1, "po-md-3", 3, "ngModelChange", "ngModel", "p-label", "p-label-off", "p-label-on", "p-size"], ["name", "frequencyType", "p-required", "", 1, "po-md-10", 3, "ngModelChange", "p-change", "ngModel", "p-columns", "p-options", "p-size"], ["name", "frequencyValue", "p-required", "", 1, "po-md-2", 3, "ngModelChange", "p-size", "ngModel"], ["name", "daysOfWeek", "p-columns", "4", "p-required", "", 1, "po-md-12", 3, "ngModelChange", "ngModel", "p-label", "p-options", "p-size"], ["name", "dayOfMonth", "p-required", "", 1, "po-md-3", 3, "ngModelChange", "ngModel", "p-error-pattern", "p-label", "p-max", "p-pattern", "p-size"], ["name", "rangeLimitDay", "p-required", "", 1, "po-md-3", 3, "ngModel", "p-error-pattern", "p-label", "p-max", "p-pattern", "p-size"], ["name", "rangeLimitDay", "p-required", "", 1, "po-md-3", 3, "ngModelChange", "ngModel", "p-error-pattern", "p-label", "p-max", "p-pattern", "p-size"], ["name", "hour", "p-mask", "99:99", "p-mask-format-model", "", "p-placeholder", "HH:mm", "p-required", "", 1, "po-md-2", 3, "ngModelChange", "ngModel", "p-label", "p-pattern", "p-size"], ["name", "rangeLimitHour", "p-mask", "99:99", "p-mask-format-model", "", "p-placeholder", "HH:mm", "p-required", "", 1, "po-md-2", 3, "ngModel", "p-label", "p-pattern", "p-size"], ["name", "rangeLimitHour", "p-mask", "99:99", "p-mask-format-model", "", "p-placeholder", "HH:mm", "p-required", "", 1, "po-md-2", 3, "ngModelChange", "ngModel", "p-label", "p-pattern", "p-size"]],
    template: function PoPageJobSchedulerExecutionComponent_Template(rf, ctx) {
      if (rf & 1) {
        const _r1 = \u0275\u0275getCurrentView();
        \u0275\u0275elementStart(0, "form", null, 0)(2, "div", 5);
        \u0275\u0275template(3, PoPageJobSchedulerExecutionComponent_Conditional_3_Template, 1, 1)(4, PoPageJobSchedulerExecutionComponent_Conditional_4_Template, 1, 5, "po-input", 6);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(5, "div", 5);
        \u0275\u0275element(6, "po-divider", 7);
        \u0275\u0275elementStart(7, "po-datepicker", 8);
        \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_Template_po_datepicker_ngModelChange_7_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.value.firstExecution, $event) || (ctx.value.firstExecution = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(8, "po-input", 9);
        \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_Template_po_input_ngModelChange_8_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.value.firstExecutionHour, $event) || (ctx.value.firstExecutionHour = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd()();
        \u0275\u0275element(9, "hr");
        \u0275\u0275elementStart(10, "div", 5)(11, "po-radio-group", 10);
        \u0275\u0275twoWayListener("ngModelChange", function PoPageJobSchedulerExecutionComponent_Template_po_radio_group_ngModelChange_11_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.value.periodicity, $event) || (ctx.value.periodicity = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275listener("p-change", function PoPageJobSchedulerExecutionComponent_Template_po_radio_group_p_change_11_listener($event) {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.onChangePeriodicityOptions($event));
        });
        \u0275\u0275elementEnd();
        \u0275\u0275template(12, PoPageJobSchedulerExecutionComponent_Conditional_12_Template, 8, 13);
        \u0275\u0275elementEnd();
        \u0275\u0275template(13, PoPageJobSchedulerExecutionComponent_ng_template_13_Template, 1, 1, "ng-template", null, 1, \u0275\u0275templateRefExtractor)(15, PoPageJobSchedulerExecutionComponent_ng_template_15_Template, 3, 5, "ng-template", null, 2, \u0275\u0275templateRefExtractor)(17, PoPageJobSchedulerExecutionComponent_ng_template_17_Template, 3, 8, "ng-template", null, 3, \u0275\u0275templateRefExtractor)(19, PoPageJobSchedulerExecutionComponent_ng_template_19_Template, 2, 5, "ng-template", null, 4, \u0275\u0275templateRefExtractor);
        \u0275\u0275elementEnd();
      }
      if (rf & 2) {
        \u0275\u0275advance(3);
        \u0275\u0275conditional(ctx.existProcessAPI ? 3 : 4);
        \u0275\u0275advance(3);
        \u0275\u0275property("p-label", ctx.literals.firstExecution);
        \u0275\u0275advance();
        \u0275\u0275twoWayProperty("ngModel", ctx.value.firstExecution);
        \u0275\u0275property("p-disabled", ctx.isEdit)("p-label", ctx.literals.day)("p-min-date", ctx.startDateFirstExecution)("p-size", ctx.componentsSize);
        \u0275\u0275advance();
        \u0275\u0275twoWayProperty("ngModel", ctx.value.firstExecutionHour);
        \u0275\u0275property("p-disabled", ctx.isEdit)("p-label", ctx.literals.time)("p-pattern", ctx.timePattern)("p-size", ctx.componentsSize);
        \u0275\u0275advance(3);
        \u0275\u0275twoWayProperty("ngModel", ctx.value.periodicity);
        \u0275\u0275property("p-label", ctx.literals.periodicity)("p-options", ctx.periodicityOptions)("p-size", ctx.componentsSize);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.value.periodicity !== "single" ? 12 : -1);
      }
    },
    dependencies: [NgTemplateOutlet, \u0275NgNoValidate, NgControlStatus, NgControlStatusGroup, NgModel, NgForm, PoDividerComponent, PoCheckboxGroupComponent, PoRadioGroupComponent, PoDatepickerComponent, PoInputComponent, PoLookupComponent, PoNumberComponent, PoSwitchComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageJobSchedulerExecutionComponent, [{
    type: Component,
    args: [{
      selector: "po-page-job-scheduler-execution",
      standalone: false,
      template: `<form #formExecution="ngForm">
  <div class="po-row">
    @if (existProcessAPI) {
      @if (noParameters && noCustomParamsComponent) {
        <po-lookup
          class="po-md-12"
          name="processID"
          [(ngModel)]="value.processID"
          p-field-label="description"
          p-field-value="processID"
          p-required
          [p-disabled]="isEdit"
          [p-filter-service]="poPageJobSchedulerLookup"
          [p-label]="literals.process"
          [p-placeholder]="literals.enterProcess"
          [p-size]="componentsSize"
        >
        </po-lookup>
      }
    } @else {
      <po-input
        class="po-md-12"
        name="processID"
        [(ngModel)]="value.processID"
        p-required
        [p-disabled]="isEdit"
        [p-label]="literals.process"
        [p-placeholder]="literals.enterProcess"
        [p-size]="componentsSize"
      >
      </po-input>
    }
  </div>

  <div class="po-row">
    <po-divider class="po-md-12" [p-label]="literals.firstExecution"></po-divider>

    <po-datepicker
      class="po-md-4"
      name="firstExecution"
      [(ngModel)]="value.firstExecution"
      p-placeholder="dd/mm/aaaa"
      p-required
      [p-disabled]="isEdit"
      [p-label]="literals.day"
      [p-min-date]="startDateFirstExecution"
      [p-size]="componentsSize"
    >
    </po-datepicker>

    <po-input
      class="po-md-2"
      name="firstExecutionHour"
      [(ngModel)]="value.firstExecutionHour"
      p-mask="99:99"
      p-mask-format-model
      p-placeholder="HH:mm"
      p-required
      [p-disabled]="isEdit"
      [p-label]="literals.time"
      [p-pattern]="timePattern"
      [p-size]="componentsSize"
    >
    </po-input>
  </div>

  <hr />

  <div class="po-row">
    <po-radio-group
      class="po-sm-12"
      name="periodicity"
      [(ngModel)]="value.periodicity"
      p-columns="4"
      p-required
      [p-label]="literals.periodicity"
      [p-options]="periodicityOptions"
      [p-size]="componentsSize"
      (p-change)="onChangePeriodicityOptions($event)"
    >
    </po-radio-group>

    @if (value.periodicity !== 'single') {
      <div class="po-row">
        <po-switch
          class="po-md-12"
          name="containsFrequency"
          [(ngModel)]="containsFrequency"
          [p-label]="literals.frequency"
          [p-label-off]="literals.no"
          [p-label-on]="literals.yes"
          [p-size]="componentsSize"
          (p-change)="onChangeContainsFrequency($event)"
        >
        </po-switch>
        @if (containsFrequency) {
          <po-radio-group
            class="po-md-10"
            name="frequencyType"
            p-required
            [(ngModel)]="value.frequency.type"
            [p-columns]="3"
            [p-options]="frequencyOptions"
            [p-size]="componentsSize"
            (p-change)="onChangeFrequencyOptions()"
          >
          </po-radio-group>
          <po-number
            class="po-md-2"
            name="frequencyValue"
            p-required
            [p-size]="componentsSize"
            [(ngModel)]="value.frequency.value"
          >
          </po-number>
        }
      </div>
      <div class="po-row">
        <po-divider class="po-md-12" [p-label]="literals.periodicityData"> </po-divider>
        <ng-container *ngTemplateOutlet="periodicityTemplates[value.periodicity]"> </ng-container>
      </div>
      <div class="po-row">
        <po-switch
          class="po-md-3"
          name="recurrent"
          [(ngModel)]="value.recurrent"
          [p-label]="literals.recurrent"
          [p-label-off]="literals.no"
          [p-label-on]="literals.yes"
          [p-size]="componentsSize"
        >
        </po-switch>
      </div>
    }
  </div>

  <ng-template #dailyTemplate>
    <ng-container *ngTemplateOutlet="inputHourTemplate"> </ng-container>
  </ng-template>

  <ng-template #weeklyTemplate>
    <div class="po-row">
      <ng-container *ngTemplateOutlet="inputHourTemplate"> </ng-container>
    </div>

    <po-checkbox-group
      class="po-md-12"
      name="daysOfWeek"
      [(ngModel)]="value.daysOfWeek"
      p-columns="4"
      p-required
      [p-label]="literals.weekDays"
      [p-options]="weekDays"
      [p-size]="componentsSize"
    >
    </po-checkbox-group>
  </ng-template>

  <ng-template #monthlyTemplate>
    <po-number
      class="po-md-3"
      name="dayOfMonth"
      [(ngModel)]="value.dayOfMonth"
      p-required
      [p-error-pattern]="'Dia inv\xE1lido'"
      [p-label]="dayLabel"
      [p-max]="31"
      [p-pattern]="dayPattern"
      [p-size]="componentsSize"
    >
    </po-number>

    @if (containsFrequency) {
      <po-number
        class="po-md-3"
        name="rangeLimitDay"
        [(ngModel)]="value.rangeLimitDay"
        p-required
        [p-error-pattern]="'Dia inv\xE1lido'"
        [p-label]="literals.endDay"
        [p-max]="31"
        [p-pattern]="dayPattern"
        [p-size]="componentsSize"
      >
      </po-number>
    }

    <ng-container *ngTemplateOutlet="inputHourTemplate"> </ng-container>
  </ng-template>

  <ng-template #inputHourTemplate>
    <po-input
      class="po-md-2"
      name="hour"
      [(ngModel)]="value.hour"
      p-mask="99:99"
      p-mask-format-model
      p-placeholder="HH:mm"
      p-required
      [p-label]="hourLabel"
      [p-pattern]="timePattern"
      [p-size]="componentsSize"
    >
    </po-input>

    @if (containsFrequency && value.frequency.type !== 'day') {
      <po-input
        class="po-md-2"
        name="rangeLimitHour"
        [(ngModel)]="value.rangeLimitHour"
        p-mask="99:99"
        p-mask-format-model
        p-placeholder="HH:mm"
        p-required
        [p-label]="literals.endTime"
        [p-pattern]="timePattern"
        [p-size]="componentsSize"
      >
      </po-input>
    }
  </ng-template>
</form>
`
    }]
  }], null, {
    form: [{
      type: ViewChild,
      args: ["formExecution", {
        static: true
      }]
    }],
    dailyTemplate: [{
      type: ViewChild,
      args: ["dailyTemplate", {
        static: true
      }]
    }],
    monthlyTemplate: [{
      type: ViewChild,
      args: ["monthlyTemplate", {
        static: true
      }]
    }],
    weeklyTempalte: [{
      type: ViewChild,
      args: ["weeklyTemplate", {
        static: true
      }]
    }],
    componentsSize: [{
      type: Input,
      args: ["p-components-size"]
    }],
    isEdit: [{
      type: Input,
      args: ["p-is-edit"]
    }],
    literals: [{
      type: Input,
      args: ["p-literals"]
    }],
    noParameters: [{
      type: Input,
      args: ["p-no-parameters"]
    }],
    noCustomParamsComponent: [{
      type: Input,
      args: ["p-no-custom-params-component"]
    }],
    changeProcess: [{
      type: Output,
      args: ["p-change-process"]
    }],
    value: [{
      type: Input,
      args: ["p-value"]
    }]
  });
})();
var PoPageJobSchedulerParametersComponent = class _PoPageJobSchedulerParametersComponent {
  form;
  componentsSize;
  literals = {};
  parameters = [];
  value;
  valueChange = new EventEmitter();
  ngAfterViewInit() {
    if (this.form) {
      setTimeout(() => {
        this.form.valueChanges.subscribe((value) => {
          this.valueChange.emit(value);
        });
      });
    }
  }
  static \u0275fac = function PoPageJobSchedulerParametersComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageJobSchedulerParametersComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageJobSchedulerParametersComponent,
    selectors: [["po-page-job-scheduler-parameters"]],
    viewQuery: function PoPageJobSchedulerParametersComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c16, 5);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.form = _t.first);
      }
    },
    inputs: {
      componentsSize: [0, "p-components-size", "componentsSize"],
      literals: [0, "p-literals", "literals"],
      parameters: [0, "p-parameters", "parameters"],
      value: [0, "p-value", "value"]
    },
    outputs: {
      valueChange: "p-valueChange"
    },
    standalone: false,
    decls: 2,
    vars: 1,
    consts: [["parametersForm", "ngForm"], [1, "po-text-center"], ["p-group-form", "", 3, "p-components-size", "p-fields", "p-value"], ["p-icon", "ICON_INFO"], [1, "po-font-text-large"]],
    template: function PoPageJobSchedulerParametersComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275template(0, PoPageJobSchedulerParametersComponent_Conditional_0_Template, 3, 3, "form")(1, PoPageJobSchedulerParametersComponent_Conditional_1_Template, 4, 1, "div", 1);
      }
      if (rf & 2) {
        \u0275\u0275conditional(ctx.parameters && ctx.parameters.length ? 0 : 1);
      }
    },
    dependencies: [\u0275NgNoValidate, NgControlStatusGroup, NgForm, PoDynamicFormComponent, PoIconComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageJobSchedulerParametersComponent, [{
    type: Component,
    args: [{
      selector: "po-page-job-scheduler-parameters",
      standalone: false,
      template: '@if (parameters && parameters.length) {\n  <form #parametersForm="ngForm">\n    <po-dynamic-form p-group-form [p-components-size]="componentsSize" [p-fields]="parameters" [p-value]="value">\n    </po-dynamic-form>\n  </form>\n} @else {\n  <div class="po-text-center">\n    <po-icon p-icon="ICON_INFO"></po-icon>\n    <span class="po-font-text-large">\n      {{ literals.parametersNotFound }}\n    </span>\n  </div>\n}\n'
    }]
  }], null, {
    form: [{
      type: ViewChild,
      args: ["parametersForm"]
    }],
    componentsSize: [{
      type: Input,
      args: ["p-components-size"]
    }],
    literals: [{
      type: Input,
      args: ["p-literals"]
    }],
    parameters: [{
      type: Input,
      args: ["p-parameters"]
    }],
    value: [{
      type: Input,
      args: ["p-value"]
    }],
    valueChange: [{
      type: Output,
      args: ["p-valueChange"]
    }]
  });
})();
var PoPageJobSchedulerSummaryComponent = class _PoPageJobSchedulerSummaryComponent {
  datePipe = inject(DatePipe);
  componentsSize;
  literals = {};
  parameters = [];
  value = {};
  noParameters = true;
  jobSchedulerSummaryTemplate;
  executionValue = "";
  firstExecutionValue = "";
  infoOrientation = PoInfoOrientation.Horizontal;
  periodicityValue = "";
  frequencyValue = "";
  rangeLimitHour = "";
  rangeLimitDay = "";
  recurrentValue = "";
  ngOnInit() {
    const {
      periodicity,
      hour,
      dayOfMonth,
      daysOfWeek,
      recurrent,
      firstExecution,
      firstExecutionHour,
      frequency,
      rangeLimitHour,
      rangeLimitDay
    } = this.value;
    this.periodicityValue = this.getPeriodicityLabel(periodicity);
    if (frequency) {
      this.frequencyValue = this.getFrequencyValue(frequency, periodicity);
    }
    this.executionValue = this.getExecutionValue(periodicity, hour, daysOfWeek, dayOfMonth, rangeLimitHour, rangeLimitDay);
    this.firstExecutionValue = this.getFirstExecutionLabel(firstExecution, firstExecutionHour);
    this.recurrentValue = this.getRecurrentValue(recurrent);
  }
  getFrequencyValue(frequency, periodicity) {
    return frequency["value"] && frequency["type"] && periodicity !== "single" ? `${frequency["value"]} - ${frequency["type"]}` : "";
  }
  getExecutionValue(periodicity, hour, daysOfWeek, dayOfMonth, rangeLimitHour, rangeLimitDay) {
    switch (periodicity) {
      case "daily":
        return this.getHourLabel(hour, rangeLimitHour);
      case "monthly":
        return this.getMonthlyLabelExecution(dayOfMonth, hour, rangeLimitHour, rangeLimitDay);
      case "weekly":
        return this.getWeeklyLabelExecution(daysOfWeek, hour, rangeLimitHour);
      default:
        return this.literals.notReported;
    }
  }
  getFirstExecutionLabel(firstExecution, firstExecutionHour) {
    if (firstExecution) {
      const date = this.datePipe.transform(firstExecution, "dd/MM/yyyy", "-0200");
      return `${date} ${this.getHourLabel(firstExecutionHour)}`;
    } else {
      return this.literals.notReported;
    }
  }
  getHourLabel(hour, rangeLimitHour) {
    return `${rangeLimitHour ? this.literals.from : this.literals.at} ${hour || "00:00"} ${rangeLimitHour ? this.literals.to + " " + rangeLimitHour : ""}`;
  }
  getMonthlyLabelExecution(dayOfMonth, hour, rangeLimitHour, rangeLimitDay) {
    const hourLabel = this.getHourLabel(hour, rangeLimitHour);
    return `${rangeLimitDay ? this.literals.from : ""} ${dayOfMonth} ${rangeLimitDay ? this.literals.to : ""} ${rangeLimitDay ? rangeLimitDay : ""} ${hourLabel}`;
  }
  getPeriodicityLabel(periodicity) {
    switch (periodicity) {
      case "daily":
        return this.literals.daily;
      case "monthly":
        return this.literals.monthly;
      case "weekly":
        return this.literals.weekly;
      default:
        return this.literals.single;
    }
  }
  getRecurrentValue(recurrent) {
    return recurrent ? this.literals.yes : this.literals.no;
  }
  getSorterWeekDays() {
    return {
      "sunday": 0,
      "monday": 1,
      "tuesday": 2,
      "wednesday": 3,
      "thursday": 4,
      "friday": 5,
      "saturday": 6
    };
  }
  getTranslateWeekDay(day) {
    const days2 = {
      Sunday: this.literals.sunday,
      Monday: this.literals.monday,
      Tuesday: this.literals.tuesday,
      Wednesday: this.literals.wednesday,
      Thursday: this.literals.thursday,
      Friday: this.literals.friday,
      Saturday: this.literals.saturday
    };
    return days2[day] || "";
  }
  getWeekDaysLabel(days2 = []) {
    const weekDaysSorted = this.sortWeekDays(days2);
    return weekDaysSorted.map((day) => this.getTranslateWeekDay(day)).join(", ");
  }
  getWeeklyLabelExecution(daysOfWeek, hour, rangeLimitHour) {
    if (daysOfWeek && Array.isArray(daysOfWeek)) {
      return `${this.getWeekDaysLabel(daysOfWeek)} ${this.getHourLabel(hour, rangeLimitHour)}`;
    } else {
      return this.literals.notReported;
    }
  }
  sortWeekDays(days2 = []) {
    const sorterWeekDays = this.getSorterWeekDays();
    return days2.sort((a, b) => {
      const currDay = a.toLowerCase();
      const nextDay = b.toLowerCase();
      return sorterWeekDays[currDay] > sorterWeekDays[nextDay] ? 1 : -1;
    });
  }
  static \u0275fac = function PoPageJobSchedulerSummaryComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageJobSchedulerSummaryComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageJobSchedulerSummaryComponent,
    selectors: [["po-page-job-scheduler-summary"]],
    inputs: {
      componentsSize: [0, "p-components-size", "componentsSize"],
      literals: [0, "p-literals", "literals"],
      parameters: [0, "p-parameters", "parameters"],
      value: [0, "p-value", "value"],
      noParameters: [0, "p-no-parameters", "noParameters"],
      jobSchedulerSummaryTemplate: [0, "p-summary-template", "jobSchedulerSummaryTemplate"]
    },
    standalone: false,
    decls: 9,
    vars: 17,
    consts: [[1, "po-md-12"], [3, "p-label", "p-orientation", "p-size", "p-value"], [1, "po-pt-1", "po-pb-1", "po-md-12", 3, "p-size", "p-title"], [1, "po-pt-1", "po-pb-1", "po-md-12"], [3, "p-components-size", "p-fields", "p-value"], [3, "ngTemplateOutlet"]],
    template: function PoPageJobSchedulerSummaryComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 0);
        \u0275\u0275template(1, PoPageJobSchedulerSummaryComponent_Conditional_1_Template, 1, 4, "po-info", 1);
        \u0275\u0275element(2, "po-info", 1);
        \u0275\u0275template(3, PoPageJobSchedulerSummaryComponent_Conditional_3_Template, 1, 4, "po-info", 1)(4, PoPageJobSchedulerSummaryComponent_Conditional_4_Template, 1, 4, "po-info", 1);
        \u0275\u0275element(5, "po-info", 1)(6, "po-info", 1);
        \u0275\u0275elementEnd();
        \u0275\u0275template(7, PoPageJobSchedulerSummaryComponent_Conditional_7_Template, 2, 5, "po-widget", 2)(8, PoPageJobSchedulerSummaryComponent_Conditional_8_Template, 2, 1, "div", 3);
      }
      if (rf & 2) {
        \u0275\u0275advance();
        \u0275\u0275conditional(!ctx.noParameters ? 1 : -1);
        \u0275\u0275advance();
        \u0275\u0275property("p-label", ctx.literals.periodicity)("p-orientation", ctx.infoOrientation)("p-size", ctx.componentsSize)("p-value", ctx.periodicityValue);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.frequencyValue !== "" ? 3 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.value.periodicity !== "single" ? 4 : -1);
        \u0275\u0275advance();
        \u0275\u0275property("p-label", ctx.literals.recurrent)("p-orientation", ctx.infoOrientation)("p-size", ctx.componentsSize)("p-value", ctx.recurrentValue);
        \u0275\u0275advance();
        \u0275\u0275property("p-label", ctx.literals.firstExecution)("p-orientation", ctx.infoOrientation)("p-size", ctx.componentsSize)("p-value", ctx.firstExecutionValue);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.parameters && ctx.parameters.length && !ctx.jobSchedulerSummaryTemplate ? 7 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.jobSchedulerSummaryTemplate ? 8 : -1);
      }
    },
    dependencies: [NgTemplateOutlet, PoDynamicViewComponent, PoInfoComponent, PoWidgetComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageJobSchedulerSummaryComponent, [{
    type: Component,
    args: [{
      selector: "po-page-job-scheduler-summary",
      standalone: false,
      template: `<div class="po-md-12">
  @if (!noParameters) {
    <po-info
      [p-label]="literals.process"
      [p-orientation]="infoOrientation"
      [p-size]="componentsSize"
      [p-value]="value.processID"
    >
    </po-info>
  }

  <po-info
    [p-label]="literals.periodicity"
    [p-orientation]="infoOrientation"
    [p-size]="componentsSize"
    [p-value]="periodicityValue"
  >
  </po-info>

  @if (frequencyValue !== '') {
    <po-info
      [p-label]="literals.frequency"
      [p-orientation]="infoOrientation"
      [p-size]="componentsSize"
      [p-value]="frequencyValue"
    >
    </po-info>
  }

  @if (value.periodicity !== 'single') {
    <po-info
      [p-label]="literals.execution"
      [p-orientation]="infoOrientation"
      [p-size]="componentsSize"
      [p-value]="executionValue"
    >
    </po-info>
  }

  <po-info
    [p-label]="literals.recurrent"
    [p-orientation]="infoOrientation"
    [p-size]="componentsSize"
    [p-value]="recurrentValue"
  >
  </po-info>

  <po-info
    [p-label]="literals.firstExecution"
    [p-orientation]="infoOrientation"
    [p-size]="componentsSize"
    [p-value]="firstExecutionValue"
  >
  </po-info>
</div>
@if (parameters && parameters.length && !jobSchedulerSummaryTemplate) {
  <po-widget class="po-pt-1 po-pb-1 po-md-12" [p-size]="componentsSize" [p-title]="literals.parameters">
    <po-dynamic-view [p-components-size]="componentsSize" [p-fields]="parameters" [p-value]="value.executionParameter">
    </po-dynamic-view>
  </po-widget>
}
@if (jobSchedulerSummaryTemplate) {
  <div class="po-pt-1 po-pb-1 po-md-12">
    <ng-template [ngTemplateOutlet]="jobSchedulerSummaryTemplate?.templateRef"></ng-template>
  </div>
}
`
    }]
  }], null, {
    componentsSize: [{
      type: Input,
      args: ["p-components-size"]
    }],
    literals: [{
      type: Input,
      args: ["p-literals"]
    }],
    parameters: [{
      type: Input,
      args: ["p-parameters"]
    }],
    value: [{
      type: Input,
      args: ["p-value"]
    }],
    noParameters: [{
      type: Input,
      args: ["p-no-parameters"]
    }],
    jobSchedulerSummaryTemplate: [{
      type: Input,
      args: ["p-summary-template"]
    }]
  });
})();
var PoPageJobSchedulerComponent = class _PoPageJobSchedulerComponent extends PoPageJobSchedulerBaseComponent {
  poPageDynamicLookupService = inject(PoPageJobSchedulerLookupService);
  activatedRoute = inject(ActivatedRoute);
  poDialogService = inject(PoDialogService);
  poNotification = inject(PoNotificationService);
  schedulerExecution;
  schedulerParameters;
  parametersTemplate;
  jobSchedulerSummaryTemplate;
  isEdit = false;
  literals = __spreadValues({}, poPageJobSchedulerLiteralsDefault[poLocaleDefault]);
  publicValues;
  saveOperation;
  step = 1;
  parametersEmpty = true;
  stepParametersInitialized = false;
  steps = [];
  backPageAction = {
    label: this.literals.back,
    action: this.nextStepOperation.bind(this, "back"),
    disabled: this.isDisabledBack.bind(this)
  };
  concludePageAction = {
    label: this.literals.conclude,
    action: this.confirmJobScheduler.bind(this)
  };
  nextPageAction = {
    label: this.literals.next,
    action: this.nextStepOperation.bind(this, "next"),
    disabled: this.isDisabledAdvance.bind(this)
  };
  concludePageActions = [this.concludePageAction, this.backPageAction];
  nextPageActions = [this.nextPageAction, this.backPageAction];
  // eslint-disable-next-line @typescript-eslint/member-ordering
  jobSchedulerActions = [...this.nextPageActions];
  stepExecution = 1;
  stepParameters = 2;
  stepSummary = 3;
  _stepExecutionLast;
  constructor() {
    const poPageJobSchedulerService = inject(PoPageJobSchedulerService);
    const languageService = inject(PoLanguageService);
    super(poPageJobSchedulerService);
    this.poPageJobSchedulerService = poPageJobSchedulerService;
    const language = languageService.getShortLanguage();
    this.literals = __spreadValues(__spreadValues({}, this.literals), poPageJobSchedulerLiteralsDefault[language]);
    this.backPageAction.label = this.literals.back;
    this.concludePageAction.label = this.literals.conclude;
    this.nextPageAction.label = this.literals.next;
  }
  get stepperOrientation() {
    return this.stepperDefaultOrientation || (window.innerWidth > 481 && window.innerWidth < 960 ? "horizontal" : "vertical");
  }
  ngOnInit() {
    const paramId = this.activatedRoute.snapshot.params["id"];
    this.isEdit = !!paramId;
    this.poPageJobSchedulerService.configServiceApi({
      endpoint: this.serviceApi
    });
    if (this.parameters.length) {
      this.parametersEmpty = false;
    }
    this.loadData(paramId);
  }
  ngAfterContentInit() {
    this.checkStepExecutionLast();
    this.getSteps();
  }
  changePageActionsBySteps(currentStep, nextStep) {
    const stepsLength = this.steps.length;
    if (nextStep === stepsLength) {
      this.jobSchedulerActions = [...this.concludePageActions];
    } else if (currentStep === stepsLength && nextStep < currentStep) {
      this.jobSchedulerActions = [...this.nextPageActions];
    }
  }
  nextStep(stepNumber) {
    const operation = stepNumber > this.step ? "next" : "back";
    const jumpStep = (stepNumber - this.step) * (operation === "back" ? -1 : 1);
    if (jumpStep > 1) {
      return;
    }
    if (!this.validateStepExecution()) {
      return;
    }
    if (operation === "next" && !this.validateStepSchedulerParameters()) {
      return;
    }
    if (operation === "next" && !this.validateStepTemplateParameters()) {
      return;
    }
    if (this.step === this.stepExecution) {
      this.setModelRecurrent();
    }
    this.setPropertiesFromTemplate();
    if (stepNumber === this.steps.length) {
      const model = JSON.parse(JSON.stringify(this.model));
      this.publicValues = this.hidesSecretValues(model);
    }
    this.steps[this.step - 1].status = operation === "next" ? PoStepperStatus.Done : PoStepperStatus.Default;
    this.changePageActionsBySteps(this.step, stepNumber);
    this.step = stepNumber;
    this.stepParametersInitialized = this.stepParametersInitialized || stepNumber === this.stepParameters;
  }
  onChangeProcess(process2) {
    if (process2.existAPI && process2.processId && this.parametersEmpty && !this.parametersTemplate.length) {
      this.getParametersByProcess(process2.processId);
      if (!this.isEdit) {
        this.model.executionParameter = {};
      }
    }
  }
  checkStepExecutionLast() {
    if (!this.parametersTemplate.length) {
      this._stepExecutionLast = false;
      return;
    }
    this._stepExecutionLast = this.stepExecutionLast;
  }
  confirmJobScheduler() {
    const paramId = this.activatedRoute.snapshot.params["id"];
    const confirmMessage = paramId ? this.literals.confirmUpdateMessage : this.literals.confirmSaveMessage;
    this.poDialogService.confirm({
      title: this.literals.confirmation,
      message: confirmMessage,
      confirm: () => {
        const beforeSendModel = this.beforeSendAction ? this.beforeSendAction(this.model) : void 0;
        const model = __spreadValues({}, beforeSendModel || this.model);
        this.save(model, paramId);
      }
    });
  }
  emitSuccessMessage(msgSuccess, saveOperation) {
    saveOperation.subscribe({
      next: () => {
        this.success.emit();
        this.poNotification.success(msgSuccess);
        this.resetJobSchedulerForm();
      },
      error: (e) => this.error.emit(e)
    });
  }
  getParametersByProcess(process2) {
    this.poPageJobSchedulerService.getParametersByProcess(process2).subscribe((parameters) => {
      this.parameters = parameters;
    });
  }
  hidesSecretValues(model) {
    const hiddenSecretValue = "**********";
    this.parameters.forEach((parameter) => {
      if (this.isSecretParameter(model, parameter)) {
        model.executionParameter[parameter.property] = hiddenSecretValue;
      }
    });
    return model;
  }
  getSteps() {
    const templateArray = [];
    this.parametersTemplate.toArray().forEach((value, index, array) => {
      templateArray.push({
        label: value.title || `${this.literals.parameterization} ${array.length > 1 ? index + 1 : ""}`
      });
    });
    let _steps = [];
    if (!this._stepExecutionLast) {
      _steps.push({
        label: this.literals.scheduling
      });
    }
    if (!templateArray.length) {
      _steps.push({
        label: this.literals.parameterization
      });
    } else {
      _steps = [..._steps, ...templateArray];
    }
    if (this._stepExecutionLast) {
      _steps.push({
        label: this.literals.scheduling
      });
    }
    _steps.push({
      label: this.literals.conclude
    });
    this.steps = _steps;
    this.stepSummary = this.steps.length;
    if (this._stepExecutionLast) {
      this.stepExecution = this.stepSummary - 1;
    }
  }
  getTemplateCurrent() {
    const indexTemplate = this.step - (this.stepExecutionLast ? 1 : 2);
    return this.parametersTemplate.toArray()[indexTemplate];
  }
  templateHasDisable() {
    const template = this.getTemplateCurrent();
    return !template?.disabledAdvance;
  }
  isDisabledAdvance() {
    if (this.step === this.stepExecution) {
      return this.schedulerExecution?.form?.invalid;
    }
    if (this.schedulerParameters) {
      return this.schedulerParameters?.form?.invalid;
    }
    const templateCurrent = this.getTemplateCurrent();
    if (templateCurrent) {
      return templateCurrent.disabledAdvance;
    }
    return false;
  }
  isDisabledBack() {
    return this.step === 1;
  }
  isSecretParameter(model, parameter) {
    return model.executionParameter && parameter.hasOwnProperty("secret") && parameter["secret"] === true && model.executionParameter.hasOwnProperty(parameter.property);
  }
  nextStepOperation(operation) {
    const stepNumber = operation === "back" ? this.step - 1 : this.step + 1;
    this.nextStep(stepNumber);
  }
  resetJobSchedulerForm() {
    this.schedulerExecution.form.reset();
    setTimeout(() => {
      this.model = new PoPageJobSchedulerInternal();
      this.step = 1;
      this.steps.forEach((step) => {
        step.status = PoStepperStatus.Default;
      });
      this.jobSchedulerActions = [...this.nextPageActions];
    });
  }
  save(model, paramId) {
    const saveOperation = paramId ? this.poPageJobSchedulerService.updateResource(paramId, model) : this.poPageJobSchedulerService.createResource(model);
    const msgSuccess = paramId ? this.literals.saveNotificationSuccessUpdate : this.literals.saveNotificationSuccessSave;
    this.emitSuccessMessage(msgSuccess, saveOperation);
  }
  setModelRecurrent() {
    this.model.recurrent = this.model.periodicity === "single" ? false : this.model.recurrent;
  }
  setPropertiesFromTemplate() {
    const templateCurrent = this.getTemplateCurrent();
    if (!templateCurrent) {
      return;
    }
    this.model = __spreadProps(__spreadValues({}, this.model), {
      executionParameter: __spreadValues(__spreadValues({}, this.model.executionParameter), templateCurrent.executionParameter)
    });
  }
  validateStepExecution() {
    const stepCurrent = this.step;
    if (stepCurrent == this.stepExecution && this.schedulerExecution.form.invalid) {
      this.markAsDirtyInvalidControls(this.schedulerExecution.form.controls);
      return false;
    }
    return true;
  }
  validateStepSchedulerParameters() {
    if (this.step === this.stepExecution || this.step === this.stepSummary) {
      return true;
    }
    if (this.schedulerParameters && this.schedulerParameters.form && this.schedulerParameters.form.invalid) {
      this.markAsDirtyInvalidControls(this.schedulerParameters.form.controls);
      return false;
    }
    return true;
  }
  validateStepTemplateParameters() {
    if (this.step === this.stepExecution || this.step === this.stepSummary) {
      return true;
    }
    if (!this.parametersTemplate.length) {
      return true;
    }
    return this.templateHasDisable();
  }
  static \u0275fac = function PoPageJobSchedulerComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageJobSchedulerComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageJobSchedulerComponent,
    selectors: [["po-page-job-scheduler"]],
    contentQueries: function PoPageJobSchedulerComponent_ContentQueries(rf, ctx, dirIndex) {
      if (rf & 1) {
        \u0275\u0275contentQuery(dirIndex, PoJobSchedulerSummaryTemplateDirective, 5);
        \u0275\u0275contentQuery(dirIndex, PoJobSchedulerParametersTemplateDirective, 4);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.jobSchedulerSummaryTemplate = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.parametersTemplate = _t);
      }
    },
    viewQuery: function PoPageJobSchedulerComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c17, 7);
        \u0275\u0275viewQuery(_c18, 5);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.schedulerExecution = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.schedulerParameters = _t.first);
      }
    },
    standalone: false,
    features: [\u0275\u0275InheritDefinitionFeature],
    decls: 13,
    vars: 18,
    consts: [["formScheduler", "ngForm"], ["schedulerExecution", ""], ["schedulerParameters", ""], [3, "p-actions", "p-breadcrumb", "p-components-size", "p-title"], [1, "po-row"], ["p-sequential", "true", 3, "p-change-step", "ngClass", "p-orientation", "p-step", "p-steps"], [3, "ngClass"], [1, "po-md-12", 3, "p-change-process", "p-no-parameters", "p-no-custom-params-component", "hidden", "p-components-size", "p-is-edit", "p-literals", "p-value"], [1, "po-md-12", 3, "hidden", "p-components-size", "p-literals", "p-parameters", "p-value"], [1, "po-md-12", 3, "p-no-parameters", "p-summary-template", "p-components-size", "p-literals", "p-parameters", "p-value"], [3, "hidden"], [1, "po-md-12", 3, "p-valueChange", "hidden", "p-components-size", "p-literals", "p-parameters", "p-value"], [3, "ngTemplateOutlet"]],
    template: function PoPageJobSchedulerComponent_Template(rf, ctx) {
      if (rf & 1) {
        const _r1 = \u0275\u0275getCurrentView();
        \u0275\u0275elementStart(0, "po-page-default", 3)(1, "div", 4)(2, "po-stepper", 5);
        \u0275\u0275listener("p-change-step", function PoPageJobSchedulerComponent_Template_po_stepper_p_change_step_2_listener($event) {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.nextStep($event));
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(3, "po-container", 6)(4, "form", null, 0)(6, "div", 4)(7, "po-page-job-scheduler-execution", 7, 1);
        \u0275\u0275listener("p-change-process", function PoPageJobSchedulerComponent_Template_po_page_job_scheduler_execution_p_change_process_7_listener($event) {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.onChangeProcess($event));
        });
        \u0275\u0275elementEnd();
        \u0275\u0275template(9, PoPageJobSchedulerComponent_Conditional_9_Template, 2, 6, "po-page-job-scheduler-parameters", 8)(10, PoPageJobSchedulerComponent_Conditional_10_Template, 1, 6, "po-page-job-scheduler-summary", 9);
        \u0275\u0275elementEnd()();
        \u0275\u0275repeaterCreate(11, PoPageJobSchedulerComponent_For_12_Template, 2, 2, "div", 10, \u0275\u0275repeaterTrackByIdentity);
        \u0275\u0275elementEnd()()();
      }
      if (rf & 2) {
        \u0275\u0275property("p-actions", ctx.jobSchedulerActions)("p-breadcrumb", ctx.breadcrumb)("p-components-size", ctx.componentsSize)("p-title", ctx.title);
        \u0275\u0275advance(2);
        \u0275\u0275property("ngClass", ctx.stepperDefaultOrientation === "horizontal" ? "po-lg-12 po-xl-12" : "po-lg-3 po-xl-2")("p-orientation", ctx.stepperOrientation)("p-step", ctx.step)("p-steps", ctx.steps);
        \u0275\u0275advance();
        \u0275\u0275property("ngClass", ctx.stepperDefaultOrientation === "horizontal" ? "po-lg-12 po-xl-12" : "po-lg-8 po-xl-6");
        \u0275\u0275advance(4);
        \u0275\u0275property("p-no-parameters", ctx.parametersEmpty)("p-no-custom-params-component", !ctx.parametersTemplate.length)("hidden", ctx.step !== ctx.stepExecution)("p-components-size", ctx.componentsSize)("p-is-edit", ctx.isEdit)("p-literals", ctx.literals)("p-value", ctx.model);
        \u0275\u0275advance(2);
        \u0275\u0275conditional(ctx.stepParametersInitialized && !ctx.parametersTemplate.length ? 9 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.step === ctx.stepSummary ? 10 : -1);
        \u0275\u0275advance();
        \u0275\u0275repeater(ctx.parametersTemplate);
      }
    },
    dependencies: [NgClass, NgTemplateOutlet, \u0275NgNoValidate, NgControlStatusGroup, NgForm, PoContainerComponent, PoPageDefaultComponent, PoStepperComponent, PoPageJobSchedulerExecutionComponent, PoPageJobSchedulerParametersComponent, PoPageJobSchedulerSummaryComponent],
    styles: ["po-container .po-container{overflow-y:unset}\n"],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageJobSchedulerComponent, [{
    type: Component,
    args: [{
      selector: "po-page-job-scheduler",
      encapsulation: ViewEncapsulation.None,
      standalone: false,
      template: `<po-page-default
  [p-actions]="jobSchedulerActions"
  [p-breadcrumb]="breadcrumb"
  [p-components-size]="componentsSize"
  [p-title]="title"
>
  <div class="po-row">
    <po-stepper
      [ngClass]="stepperDefaultOrientation === 'horizontal' ? 'po-lg-12 po-xl-12' : 'po-lg-3 po-xl-2'"
      p-sequential="true"
      [p-orientation]="stepperOrientation"
      [p-step]="step"
      [p-steps]="steps"
      (p-change-step)="nextStep($event)"
    >
    </po-stepper>

    <po-container [ngClass]="stepperDefaultOrientation === 'horizontal' ? 'po-lg-12 po-xl-12' : 'po-lg-8 po-xl-6'">
      <form #formScheduler="ngForm">
        <div class="po-row">
          <po-page-job-scheduler-execution
            [p-no-parameters]="parametersEmpty"
            [p-no-custom-params-component]="!parametersTemplate.length"
            [hidden]="step !== stepExecution"
            #schedulerExecution
            class="po-md-12"
            [p-components-size]="componentsSize"
            [p-is-edit]="isEdit"
            [p-literals]="literals"
            [p-value]="model"
            (p-change-process)="onChangeProcess($event)"
          >
          </po-page-job-scheduler-execution>

          @if (stepParametersInitialized && !parametersTemplate.length) {
            <po-page-job-scheduler-parameters
              [hidden]="step !== stepParameters"
              #schedulerParameters
              class="po-md-12"
              [p-components-size]="componentsSize"
              [p-literals]="literals"
              [p-parameters]="parameters || []"
              [(p-value)]="model.executionParameter"
            >
            </po-page-job-scheduler-parameters>
          }

          @if (step === stepSummary) {
            <po-page-job-scheduler-summary
              [p-no-parameters]="!parameters.length"
              [p-summary-template]="jobSchedulerSummaryTemplate"
              class="po-md-12"
              [p-components-size]="componentsSize"
              [p-literals]="literals"
              [p-parameters]="parameters"
              [p-value]="publicValues"
            >
            </po-page-job-scheduler-summary>
          }
        </div>
      </form>

      @for (template of parametersTemplate; track template; let index = $index) {
        <div [hidden]="step !== index + (_stepExecutionLast ? 1 : 2)">
          <ng-template [ngTemplateOutlet]="template?.templateRef"></ng-template>
        </div>
      }
    </po-container>
  </div>
</po-page-default>
`,
      styles: ["po-container .po-container{overflow-y:unset}\n"]
    }]
  }], () => [], {
    schedulerExecution: [{
      type: ViewChild,
      args: ["schedulerExecution", {
        static: true
      }]
    }],
    schedulerParameters: [{
      type: ViewChild,
      args: ["schedulerParameters"]
    }],
    parametersTemplate: [{
      type: ContentChildren,
      args: [PoJobSchedulerParametersTemplateDirective]
    }],
    jobSchedulerSummaryTemplate: [{
      type: ContentChild,
      args: [PoJobSchedulerSummaryTemplateDirective]
    }]
  });
})();
var PoPageJobSchedulerModule = class _PoPageJobSchedulerModule {
  static \u0275fac = function PoPageJobSchedulerModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageJobSchedulerModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoPageJobSchedulerModule,
    declarations: [PoPageJobSchedulerComponent, PoPageJobSchedulerExecutionComponent, PoPageJobSchedulerParametersComponent, PoPageJobSchedulerSummaryComponent, PoJobSchedulerParametersTemplateDirective, PoJobSchedulerSummaryTemplateDirective],
    imports: [CommonModule, FormsModule, PoButtonModule, PoContainerModule, PoDialogModule, PoDividerModule, PoDynamicModule, PoFieldModule, PoIconModule, PoInfoModule, PoPageModule, PoStepperModule, PoWidgetModule],
    exports: [PoPageJobSchedulerComponent, PoJobSchedulerParametersTemplateDirective, PoJobSchedulerSummaryTemplateDirective]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    providers: [PoPageJobSchedulerService, PoPageJobSchedulerLookupService],
    imports: [CommonModule, FormsModule, PoButtonModule, PoContainerModule, PoDialogModule, PoDividerModule, PoDynamicModule, PoFieldModule, PoIconModule, PoInfoModule, PoPageModule, PoStepperModule, PoWidgetModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageJobSchedulerModule, [{
    type: NgModule,
    args: [{
      declarations: [PoPageJobSchedulerComponent, PoPageJobSchedulerExecutionComponent, PoPageJobSchedulerParametersComponent, PoPageJobSchedulerSummaryComponent, PoJobSchedulerParametersTemplateDirective, PoJobSchedulerSummaryTemplateDirective],
      exports: [PoPageJobSchedulerComponent, PoJobSchedulerParametersTemplateDirective, PoJobSchedulerSummaryTemplateDirective],
      imports: [CommonModule, FormsModule, PoButtonModule, PoContainerModule, PoDialogModule, PoDividerModule, PoDynamicModule, PoFieldModule, PoIconModule, PoInfoModule, PoPageModule, PoStepperModule, PoWidgetModule],
      providers: [PoPageJobSchedulerService, PoPageJobSchedulerLookupService]
    }]
  }], null, null);
})();
var PoPageLoginAuthenticationType;
(function(PoPageLoginAuthenticationType2) {
  PoPageLoginAuthenticationType2["Basic"] = "Basic";
  PoPageLoginAuthenticationType2["Bearer"] = "Bearer";
})(PoPageLoginAuthenticationType || (PoPageLoginAuthenticationType = {}));
var PoPageLoginService = class _PoPageLoginService {
  http;
  constructor(http) {
    this.http = http;
  }
  onLogin(url, type, loginForm) {
    if (type === PoPageLoginAuthenticationType.Bearer) {
      loginForm.password = btoa(loginForm.password);
      return this.http.post(url, loginForm);
    } else {
      const user = `(${loginForm.login}:${loginForm.password})`;
      const headers = new HttpHeaders({
        "Authorization": `${type} ` + btoa(user)
      });
      delete loginForm.login;
      delete loginForm.password;
      return this.http.post(url, loginForm, {
        headers
      });
    }
  }
  static \u0275fac = function PoPageLoginService_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageLoginService)(\u0275\u0275inject(HttpClient));
  };
  static \u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
    token: _PoPageLoginService,
    factory: _PoPageLoginService.\u0275fac,
    providedIn: "root"
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageLoginService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [{
    type: HttpClient
  }], null);
})();
var poPageLoginContentMaxLength = 40;
var poPageLoginLiteralsDefault = {
  en: {
    title: "Welcome",
    loginErrorPattern: "Invalid Login",
    loginHint: `Your login user was given to you at your first day.
    If you don't have this information contact support`,
    loginPlaceholder: "Insert your e-mail",
    passwordErrorPattern: "Invalid Password",
    passwordPlaceholder: "Insert your password",
    customFieldErrorPattern: "Invalid value",
    customFieldPlaceholder: "Please enter a value",
    rememberUser: "Automatic login",
    rememberUserHint: "You can disable this option in system configuration",
    submitLabel: "Enter",
    submittedLabel: "Loading...",
    forgotPassword: "Forgot your Password?",
    highlightInfo: "",
    registerUrl: "New register",
    titlePopover: "Oops!",
    forgotYourPassword: "Forgot your password?",
    ifYouTryHarder: "If you try ",
    attempts: "{0} more time(s) ",
    yourUserWillBeBlocked: "without success your user will be blocked and you will be left 24 hours without being able to access :(",
    createANewPasswordNow: "Better create a new password now! You will be able to log into the system right away.",
    iForgotMyPassword: "I forgot my password",
    welcome: "Welcome",
    support: "Support"
  },
  es: {
    title: "Bienvenido",
    loginErrorPattern: "Login inv\xE1lido",
    loginHint: `Su usuario ha sido entregado para usted en su primer d\xEDa.
    Si no tiene esta informaci\xF3n, p\xF3ngase en contacto con el soporte t\xE9cnico`,
    loginPlaceholder: "Inserte su e-mail",
    passwordErrorPattern: "Contrase\xF1a inv\xE1lida",
    passwordPlaceholder: "Inserte su contrase\xF1a",
    customFieldErrorPattern: "Valor no v\xE1lido.",
    customFieldPlaceholder: "Por favor introduzca un valor",
    rememberUser: "Inicio de sesi\xF3n autom\xE1ticamente",
    rememberUserHint: "Puede deshabilitar esta opci\xF3n en el men\xFA del sistema.",
    submitLabel: "Entrar",
    submittedLabel: "Cargando...",
    forgotPassword: "Olvidaste tu contrase\xF1a?",
    highlightInfo: "",
    registerUrl: "Nuevo registro",
    titlePopover: "Opa!",
    forgotYourPassword: "Olvidaste tu contrase\xF1a?",
    ifYouTryHarder: "Si intenta m\xE1s ",
    attempts: "{0} vez/veces ",
    yourUserWillBeBlocked: "sin \xE9xito su usuario sera bloqueado y usted v\xE1s permanecer 24 horas sin poder acceder a :(",
    createANewPasswordNow: "\xA1Mejor crear una nueva contrase\xF1a ahora! Usted podr\xE1 entrar en el sistema inmediatamente despu\xE9s.",
    iForgotMyPassword: "Olvide mi contrase\xF1a",
    welcome: "Bienvenido",
    support: "Soporte"
  },
  pt: {
    title: "Bem-vindo",
    loginErrorPattern: "Login inv\xE1lido",
    loginHint: `Seu usu\xE1rio foi entregue a voc\xEA no seu primeiro dia.
    Caso n\xE3o tenha mais essa informa\xE7\xE3o contacte o suporte`,
    loginPlaceholder: "Insira seu e-mail",
    passwordErrorPattern: "Senha inv\xE1lida",
    passwordPlaceholder: "Insira sua senha",
    customFieldErrorPattern: "Valor inv\xE1lido.",
    customFieldPlaceholder: "Por favor insira um valor",
    rememberUser: "Logar automaticamente",
    rememberUserHint: "Voc\xEA pode desabilitar essa op\xE7\xE3o no menu do sistema",
    submitLabel: "Entrar",
    submittedLabel: "Carregando...",
    forgotPassword: "Esqueceu sua senha?",
    highlightInfo: "",
    registerUrl: "Novo registro",
    titlePopover: "Opa!",
    forgotYourPassword: "Esqueceu sua senha?",
    ifYouTryHarder: "Se tentar mais ",
    attempts: "{0} vez(es) ",
    yourUserWillBeBlocked: "sem sucesso seu usu\xE1rio ser\xE1 bloqueado e voc\xEA fica 24 horas sem poder acessar :(",
    createANewPasswordNow: "Melhor criar uma senha nova agora! Voc\xEA vai poder entrar no sistema logo em seguida.",
    iForgotMyPassword: "Esqueci minha senha",
    welcome: "Boas-vindas",
    support: "Suporte"
  },
  ru: {
    title: "\u0414\u043E\u0431\u0440\u043E \u043F\u043E\u0436\u0430\u043B\u043E\u0432\u0430\u0442\u044C!",
    loginErrorPattern: "\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0439 \u043B\u043E\u0433\u0438\u043D",
    loginHint: `\u0412\u0430\u0448 \u043B\u043E\u0433\u0438\u043D \u0431\u044B\u043B \u043F\u0440\u0435\u0434\u043E\u0441\u0442\u0430\u0432\u043B\u0435\u043D \u0432\u0430\u043C \u0432 \u043F\u0435\u0440\u0432\u044B\u0439 \u0434\u0435\u043D\u044C.
    \u0415\u0441\u043B\u0438 \u0443 \u0432\u0430\u0441 \u043D\u0435\u0442 \u044D\u0442\u043E\u0439 \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u0438, \u043E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u0432 \u0441\u043B\u0443\u0436\u0431\u0443 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u0438`,
    loginPlaceholder: "\u0412\u0441\u0442\u0430\u0432\u044C\u0442\u0435 \u0441\u0432\u043E\u0439 \u0430\u0434\u0440\u0435\u0441 \u044D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u043E\u0439 \u043F\u043E\u0447\u0442\u044B",
    passwordErrorPattern: "\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0439 \u043F\u0430\u0440\u043E\u043B\u044C",
    passwordPlaceholder: "\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0432\u043E\u0439 \u043F\u0430\u0440\u043E\u043B\u044C",
    customFieldErrorPattern: "\u041D\u0435\u0432\u0435\u0440\u043D\u043E\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435.",
    customFieldPlaceholder: "\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",
    rememberUser: "\u0410\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u0432\u0445\u043E\u0434",
    rememberUserHint: "\u0412\u044B \u043C\u043E\u0436\u0435\u0442\u0435 \u043E\u0442\u043A\u043B\u044E\u0447\u0438\u0442\u044C \u044D\u0442\u0443 \u043E\u043F\u0446\u0438\u044E \u0432 \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0441\u0438\u0441\u0442\u0435\u043C\u044B",
    submitLabel: "\u0412\u043E\u0439\u0442\u0438",
    submittedLabel: "3\u0430\u0433\u0440\u0443\u0437\u043A\u0430...",
    forgotPassword: "\u0417\u0430\u0431\u044B\u043B\u0438 \u043F\u0430\u0440\u043E\u043B\u044C?",
    highlightInfo: "",
    registerUrl: "\u041D\u043E\u0432\u044B\u0439 \u0440\u0435\u0433\u0438\u0441\u0442\u0440",
    titlePopover: "\u041E\u0439!",
    forgotYourPassword: "\u0417\u0430\u0431\u044B\u043B\u0438 \u043F\u0430\u0440\u043E\u043B\u044C?",
    ifYouTryHarder: "\u0415\u0441\u043B\u0438 \u0432\u044B \u0431\u0435\u0437\u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043F\u043E\u043F\u044B\u0442\u0430\u0435\u0442\u0435\u0441\u044C \u0432\u043E\u0439\u0442\u0438 \u0435\u0449\u0435 ",
    attempts: "{0} \u0440\u0430\u0437(\u0430) ",
    yourUserWillBeBlocked: "\u0412\u0430\u0448 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u0430\u043D, \u0438 \u0412\u044B \u043E\u0441\u0442\u0430\u043D\u0435\u0442\u0435\u0441\u044C \u043D\u0430 24 \u0447\u0430\u0441\u0430 \u0431\u0435\u0437 \u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E\u0441\u0442\u0438 \u0434\u043E\u0441\u0442\u0443\u043F\u0430 :(",
    createANewPasswordNow: "\u041B\u0443\u0447\u0448\u0435 \u0441\u043E\u0437\u0434\u0430\u0439\u0442\u0435 \u043D\u043E\u0432\u044B\u0439 \u043F\u0430\u0440\u043E\u043B\u044C \u0441\u0435\u0439\u0447\u0430\u0441!\xA0\u0412\u044B \u0441\u043C\u043E\u0436\u0435\u0442\u0435 \u0441\u0440\u0430\u0437\u0443 \u0432\u043E\u0439\u0442\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043C\u0443.",
    iForgotMyPassword: "\u042F \u0437\u0430\u0431\u044B\u043B \u0441\u0432\u043E\u0439 \u043F\u0430\u0440\u043E\u043B\u044C",
    welcome: "\u0434\u043E\u0431\u0440\u043E \u043F\u043E\u0436\u0430\u043B\u043E\u0432\u0430\u0442\u044C",
    support: "\u041F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u0430"
  }
};
var poPageLoginLiteralIn = {
  en: "in",
  es: "en",
  pt: "em",
  ru: "\u0432"
};
var PoPageLoginBaseComponent = class _PoPageLoginBaseComponent {
  loginService;
  router;
  poLanguageService;
  /**
   * O `p-background` permite inserir uma imagem de destaque ao lado direito do formulário de login, caso a propriedade
   * não seja preenchida o formulário será centralizado no espaço disponível.
   *
   * A fonte da imagem pode ser de um caminho local ou uma url de um servidor externo.
   *
   * Além da imagem, é possível adicionar um texto informativo por cima da imagem da imagem de destaque, para isso informe
   * um valor para a literal `highlightInfo`.
   *
   * > Veja mais sobre as literais na propriedade `p-literals`.
   *
   * Exemplos de valores válidos:
   * - **local**: `./assets/images/login-background.png`
   * - **url externa**: `https://po-ui.io/assets/images/login-background.png`
   *
   * > Essa propriedade é ignorada para aplicações mobile.
   */
  background;
  /**
   * @optional
   *
   * @description
   *
   * Caminho para a logomarca localizada na parte superior.
   *
   * > Caso seja indefinida o espaço se mantém preservado porém vazio.
   */
  logo;
  /**
   * @optional
   *
   * @description
   *
   * Expressão regular para validar o campo de login, caso a expressão não seja atentida, a literal `loginErrorPattern`
   * será exibida.
   *
   * Exemplos de valores válidos:
   * - email: `[expressao-regular-email]`
   * - cpf: `[expressao-regular-cpf]`
   *
   * > Veja a propriedade `p-literals` para customizar a literal `loginErrorPattern`.
   */
  loginPattern;
  /**
   * @optional
   *
   * @description
   *
   * Expressão regular para validar o campo de password, caso a expressão não seja atentida, a literal `passwordErrorPattern`
   * será exibida.
   *
   * Exemplos de valores válidos:
   * - Apenas números: `\d?`
   * - Letras mínusculas: `\z?`
   *
   * > Veja a propriedade `p-literals` para customizar a literal `passwordErrorPattern`.
   */
  passwordPattern;
  /**
   * @optional
   *
   * @description
   *
   * Caminho para a logomarca localizada no rodapé.
   */
  secondaryLogo;
  /**
   * @optional
   *
   * @description
   *
   * Evento disparado quando o usuário alterar o input do campo login.
   *
   * Esse evento receberá como parâmetro uma variável do tipo `string` com o texto informado no campo.
   *
   * > Esta propriedade será ignorada se for definido valor para a propriedade `p-authentication-url`.
   */
  loginChange = new EventEmitter();
  /**
   * Evento disparado ao submeter o formulário de login (apertando `Enter` dentro dos campos ou pressionando o botão de confirmação).
   *
   * Esse evento receberá como parâmetro um objeto do tipo `PoPageLogin` com os dados informados no formulário.
   *
   * > Esta propriedade será ignorada se for definido valor para a propriedade `p-url-recovery`.
   *
   * > Para mais detalhes consulte a documentação sobre a interface `PoPageLogin` mais abaixo.
   */
  loginSubmit = new EventEmitter();
  /**
   * @optional
   *
   * @description
   *
   * Evento disparado quando o usuário alterar o input do campo password.
   *
   * Esse evento receberá como parâmetro uma variável do tipo `string` com o texto informado no campo.
   *
   * > Esta propriedade será ignorada se for definido valor para a propriedade `p-authentication-url`.
   */
  passwordChange = new EventEmitter();
  /**
   * @optional
   *
   * @description
   *
   * Evento disparado quando o usuário alterar o idioma da página.
   *
   * Esse evento receberá como parâmetro um objeto do tipo `PoLanguage` com a linguagem selecionada.
   *
   */
  languageChange = new EventEmitter();
  /**
   * @optional
   *
   * @description
   *
   * Define a propriedade nativa `autocomplete` do campo como `off`.
   *
   * @default `true`
   */
  noAutocompleteLogin = true;
  /**
   * @optional
   *
   * @description
   *
   * Define a propriedade nativa `autocomplete` do campo como `off`.
   *
   * > No componente `po-password` será definido como `new-password`.
   *
   * @default `true`
   */
  noAutocompletePassword = true;
  /**
   * @optional
   *
   * @description
   *
   * Indica se o status do `model` do switch de lembrar o usuário será escondido visualmente.
   *
   * > Por padrão será atribuído `false`.
   * @default `false`
   */
  hideLabelStatus = false;
  /**
   * @optional
   *
   * @description
   *
   * Permite esconder a função de espiar a senha digitada.
   *
   * @default `false`
   */
  hidePasswordPeek;
  allLoginErrors = [];
  allPasswordErrors = [];
  customFieldObject;
  customFieldType;
  loginSubscription;
  password;
  rememberUser = false;
  selectedLanguage;
  showExceededAttemptsWarning = false;
  _authenticationType = PoPageLoginAuthenticationType.Basic;
  _authenticationUrl;
  _blockedUrl;
  _componentsSize = void 0;
  _contactEmail;
  _customField;
  _environment;
  _exceededAttemptsWarning;
  _hideRememberUser = false;
  _literals;
  _loading = false;
  _login;
  _loginErrors = [];
  _passwordErrors = [];
  _productName;
  _recovery;
  _registerUrl;
  _support;
  _languagesList;
  /**
   * @optional
   *
   * @description
   *
   * Define o tamanho dos componentes de formulário no template:
   * - `small`: aplica a medida small de cada componente (disponível apenas para acessibilidade AA).
   * - `medium`: aplica a medida medium de cada componente.
   *
   * > Caso a acessibilidade AA não esteja configurada, o tamanho `medium` será mantido.
   * Para mais detalhes, consulte a documentação do [po-theme](https://po-ui.io/documentation/po-theme).
   *
   * @default `medium`
   */
  set componentsSize(value) {
    this._componentsSize = validateSizeFn(value);
  }
  get componentsSize() {
    return this._componentsSize ?? getDefaultSizeFn();
  }
  /**
   * @optional
   *
   * @description
   *
   * Ao informar um valor do tipo `string`, o mesmo será aplicado como a chave do campo customizado e utilizará
   * os valores padrões contidos na propriedade `literals` como `customFieldErrorPattern` e `customFieldPlaceholder`.
   *
   * Existe a possibilidade de informar um objeto que segue a definição da interface `PoPageLoginCustomField`, onde
   * através dos parâmetros enviados pode gerar um `po-input`, `po-combo` especificamente para serviços
   * ou `po-select` para valores fixos.
   *
   * Abaixo seguem os exemplos de cada tipo de campo.
   *
   * `po-input`:
   *
   * ```
   * {
   *   property: 'domain',
   *   value: 'jv01',
   *   placeholder: 'Enter your domain',
   *   pattern: '[a-z]',
   *   errorPattern: 'Invalid value'
   * }
   * ```
   *
   * `po-combo`:
   *
   * ```
   * {
   *   property: 'domain',
   *   value: 'jv01',
   *   placeholder: 'Enter your domain',
   *   url: 'https://po-ui.io/sample/api/comboOption/domains',
   *   fieldValue: 'nickname'
   * }
   * ```
   *
   * `po-select`:
   *
   * ```
   * {
   *   property: 'domain',
   *   value: 'jv01',
   *   placeholder: 'Enter your domain',
   *   options: [{label: 'Domain 1', value: '1'}, {label: 'Domain 2', value: '2'}]
   * }
   * ```
   *
   * Caso o customField possua options, url e fieldValue preenchidos, será priorizado o po-select
   * utilizando o options.
   *
   */
  set customField(value) {
    if (value) {
      if (isTypeof(value, "string")) {
        this.customFieldType = "input";
        this._customField = value;
        this.customFieldObject = this.getDefaultCustomFieldObject(value);
        return;
      }
      if (isTypeof(value, "object") && !Array.isArray(value) && value["property"]) {
        this._customField = value;
        this.customFieldObject = value;
        if (!this.customFieldObject.options && !this.customFieldObject.url) {
          this.customFieldType = "input";
        } else {
          this.customFieldType = this.customFieldObject.options ? "select" : "combo";
        }
        return;
      }
    }
    this._customField = void 0;
    this.customFieldObject = void 0;
  }
  get customField() {
    return this._customField;
  }
  /**
   * @optional
   *
   * @description
   *
   * Personaliza o e-mail que é exibido na mensagem de dica de login padrão para contato de suporte.
   */
  set contactEmail(value) {
    this._contactEmail = value;
  }
  get contactEmail() {
    return this._contactEmail;
  }
  /**
   * @optional
   *
   * @description
   *
   * Texto customizado que fica entre a logo e a mensagem de boas-vindas.
   */
  set productName(value) {
    this._productName = value;
  }
  get productName() {
    return this._productName;
  }
  /**
   * @optional
   *
   * @description
   * Adiciona uma `tag` abaixo do título que especifica o ambiente que o usuário está fazendo o login.
   *
   * > Essa propriedade limita o texto em 40 caracteres.
   */
  set environment(environment2) {
    if (environment2 && environment2.length > poPageLoginContentMaxLength) {
      this._environment = environment2.substring(0, poPageLoginContentMaxLength);
    } else {
      this._environment = environment2;
    }
  }
  get environment() {
    return this._environment;
  }
  /**
   * @optional
   *
   * @description
   * Exibe um aviso de bloqueio de acordo com a quantidade restante de tentativas.
   * O aviso será exibido somente se a quantidade for maior que zero.
   *
   * > Caso tenha algum valor atribuído para o atributo `p-authentication-url` e o retorno da requisição estiver atribuindo valor
   * para o `p-exceeded-attempts-warning`, o valor considerado será o do retorno da requisição.
   *
   * @default `0`
   */
  set exceededAttemptsWarning(value) {
    this._exceededAttemptsWarning = convertToInt(value);
    this.showExceededAttemptsWarning = this.exceededAttemptsWarning > 0;
  }
  get exceededAttemptsWarning() {
    return this._exceededAttemptsWarning;
  }
  /**
   * @optional
   *
   * @description
   *
   * Esconde a função "Lembrar usuário" do formulário de login.
   *
   * Quando essa propriedade é setada com `true` a propriedade `rememberUser` enviada no evento `p-login-submit` será sempre
   * `false`.
   *
   * > Veja a propriedade `p-literals` para customizar a literal `rememberUser`.
   *
   * @default `false`
   */
  set hideRememberUser(value) {
    this._hideRememberUser = value === "" ? true : convertToBoolean(value);
    if (this._hideRememberUser) {
      this.rememberUser = false;
    }
  }
  get hideRememberUser() {
    return this._hideRememberUser;
  }
  /**
   * @optional
   *
   * @description
   *
   * Objeto com as literais usadas no `po-page-login`.
   *
   * Existem duas maneiras de customizar o componente, passando um objeto com todas as literais disponíveis:
   *
   * ```
   *  const customLiterals: PoPageLoginLiterals = {
   *    attempts: '{0} vez(es) ',
   *    createANewPasswordNow: 'Melhor criar uma senha nova agora! Você vai poder entrar no sistema logo em seguida.',
   *    forgotPassword: 'Esqueceu sua senha?',
   *    forgotYourPassword: 'Esqueceu sua senha?',
   *    highlightInfo: '',
   *    iForgotMyPassword: 'Esqueci minha senha',
   *    ifYouTryHarder: 'Se tentar mais ',
   *    welcome: 'Boas-vindas',
   *    loginErrorPattern: 'Login obrigatório',
   *    loginHint: 'Caso não possua usuário entre em contato com o suporte',
   *    loginLabel: 'Insira seu usuário',
   *    loginPlaceholder: 'Insira seu usuário de acesso',
   *    passwordErrorPattern: 'Senha obrigatória',
   *    passwordLabel: 'Insira sua senha',
   *    passwordPlaceholder: 'Insira sua senha de acesso',
   *    customFieldErrorPattern: 'Campo customizado inválido',
   *    customFieldPlaceholder: 'Por favor insira um valor',
   *    registerUrl: 'Novo registro',
   *    rememberUser: 'Lembrar usuário',
   *    rememberUserHint: 'Esta opção pode ser desabilitada nas configurações do sistema',
   *    submitLabel: 'Acessar sistema',
   *    submittedLabel: 'Carregando...',
   *    titlePopover: 'Opa!',
   *    yourUserWillBeBlocked: 'sem sucesso seu usuário será bloqueado e você fica 24 horas sem poder acessar :('
   *  };
   * ```
   *
   * Ou passando apenas as literais que deseja customizar:
   *
   * ```
   *  const customLiterals: PoPageLoginLiterals = {
   *    loginPlaceholder: 'Insira seu usuário de acesso',
   *    passwordPlaceholder: 'Insira sua senha de acesso',
   *    submitLabel: 'Acessar sistema'
   *  };
   * ```
   *
   * E para carregar as literais customizadas, basta apenas passar o objeto para o componente.
   *
   * ```
   * <po-page-login
   *   [p-literals]="customLiterals">
   * </po-page-login>
   * ```
   *
   *  > O objeto padrão de literais será traduzido de acordo com o idioma do browser (pt, en, es).
   *  > É também possível alternar o objeto padrão de literais através do seletor de idiomas localizado na parte inferior do template,
   * nesse caso, há também a opção do idioma russo.
   */
  set literals(value) {
    this._literals = value;
  }
  get literals() {
    return this._literals;
  }
  /**
   * @optional
   *
   * @description
   *
   * Habilita um estado de carregamento ao botão de *login*.
   *
   * > É necessário atribuir `true` à esta propriedade na função definida em `p-login-submit`.
   *
   * @default `false`
   */
  set loading(value) {
    this._loading = convertToBoolean(value);
  }
  get loading() {
    return this._loading;
  }
  /**
   * @optional
   *
   * @description
   *
   * Valor do modelo do campo de login.
   */
  set login(value) {
    this._login = value;
    if (!this.authenticationUrl) {
      this.loginChange.emit(this._login);
    }
  }
  get login() {
    return this._login;
  }
  /**
   * @optional
   *
   * @description
   *
   * Atributo que recebe uma lista de erros e exibe abaixo do campo de login.
   */
  set loginErrors(value) {
    this._loginErrors = value || [];
    this.setLoginErrors(this._loginErrors);
  }
  get loginErrors() {
    return this._loginErrors;
  }
  /**
   * @optional
   *
   * @description
   *
   * Atributo que recebe uma lista de erros e exibe abaixo do campo de password.
   */
  set passwordErrors(value) {
    this._passwordErrors = value || [];
    this.setPasswordErrors(this._passwordErrors);
  }
  get passwordErrors() {
    return this._passwordErrors;
  }
  /**
   * @optional
   *
   * @description
   *
   * Exibe um link abaixo do formulário de login para que os usuários da aplicação façam a recuperação dos dados de autenticação.
   *
   * A propriedade aceita os seguintes tipos:
   *
   * - **String**: informe uma url externa ou uma rota válida;
   * - **Function**: pode-se customizar a ação. Para esta possilidade basta atribuir:
   *   ```
   *   <po-page-login>
   *     [recovery]="this.myRecovery.bind(this)">
   *   </po-page-login>
   *   ```
   *
   * - **PoPageLoginRecovery**: cria-se vínculo automático com o template **po-modal-password-recovery**.
   *   O objeto deve conter a **url** para requisição dos recursos e pode-se definir o **tipo** de modal para recuperação de senha,
   *   **email** para contato e **máscara** do campo de telefone.
   */
  set recovery(value) {
    this._recovery = value;
  }
  get recovery() {
    return this._recovery;
  }
  /**
   * @optional
   *
   * @description
   *
   * Caso a aplicação tenha um link para novos cadastros, informe uma url externa ou uma rota válida, dessa
   * forma será exibido um link abaixo do formulário de login para os usuários da aplicação.
   *
   * Exemplos de valores válidos:
   * - **local**: `/home`
   * - **url externa**: `https://po-ui.io`
   *
   * > Veja a propriedade `p-literals` para customizar a literal `registerUrl`.
   */
  set registerUrl(value) {
    this._registerUrl = isTypeof(value, "string") ? value : void 0;
  }
  get registerUrl() {
    return this._registerUrl;
  }
  /**
   * @optional
   *
   * @description
   *
   * Atributo que recebe o tipo de esquema da autenticação, sendo suportados apenas os valores `Basic` e `Bearer`.
   *
   * > Caso o tipo definido seja `Basic`, o componente fará uma requisição `POST` contendo:
   *
   * ```
   * headers {
   *  Authorization: Basic base64(login:password)
   * }
   *
   * body {
   *  rememberUser: rememberUser
   * }
   * ```
   *
   * > Caso o tipo definido seja `Bearer`, o componente fará uma requisição `POST` contendo:
   *
   * ```
   * body {
   *  login: login,
   *  password: base64(password),
   *  rememberUser: rememberUser
   * }
   * ```
   *
   * @default `PoPageLoginAuthenticationType.Basic`
   */
  set authenticationType(value) {
    this._authenticationType = Object.values(PoPageLoginAuthenticationType).includes(value) ? value : PoPageLoginAuthenticationType.Basic;
  }
  get authenticationType() {
    return this._authenticationType;
  }
  /**
   * @optional
   *
   * @description
   *
   * Endpoint usado pelo template para requisição do recurso. Quando preenchido, o método `p-login-submit` será ignorado e o
   * componente adquirirá automatização para o processo de autenticação.
   *
   * ### Processos
   * Ao digitar um valor válido no campo de login/password e pressionar **Enter**, o componente fará uma requisição `POST`
   * na url especificada nesta propriedade passando o objeto contendo o valor definido pelo usuário:
   *
   * ```
   * headers {
   *  Authorization: Basic base64(login:password)
   * }
   *
   * body {
   *  rememberUser: rememberUser
   * }
   * ```
   *
   * Em caso de **sucesso**, o objeto de retorno é armazenado no `sessionStorage` e o usuário é redirecionado para a página inicial da
   * aplicação `/`.
   *
   * ```
   * 200:
   *  {
   *    user: user
   *  }
   * ```
   *
   * Em caso de **erro** na autenticação, espera-se o seguinte retorno:
   *
   * ```
   * 400/401
   *  {
   *    code: 400/401,
   *    message: message,
   *    detailedMessage: detailedMessage,
   *    helpUrl?: helpUrl
   *  }
   * ```
   *
   * > Pode-se atribuir uma quantidade máxima de tentativas restantes (maxAttemptsRemaining) para o atributo `p-exceeded-attempts-warning`,
   * assim como os avisos relacionados aos campos login e password (loginWarnings, passwordWarnings) para os atributos `p-login-errors` e
   * `p-password-errors` conforme retorno abaixo:
   *
   * ```
   * 400
   *  {
   *    code: 400/401,
   *    message: message,
   *    detailedMessage: detailedMessage,
   *    helpUrl?: helpUrl,
   *    maxAttemptsRemaining?: maxAttemptsRemaining,
   *    loginWarnings?: [loginWarnings],
   *    passwordWarnings?: [passwordWarnings]
   *  }
   * ```
   *
   * > Caso o valor atribuído para `p-exceeded-attempts-warning` seja igual a 0(zero), poderá ser passado um valor para o
   * atributo `p-blocked-url` e o usuário será redirecionado para uma tela de bloqueio.
   *
   * *Processo finalizado.*
   *
   * _______________
   *
   * #### Praticidade
   * As informações do serviço de autenticação também podem ser transmitidas diretamente pelas configuraçãos de rota e, desta maneira,
   * dispensa-se qualquer menção e/ou importação do componente `po-page-login` no restante da aplicação. O exemplo abaixo exemplifica
   * a forma dinâmica com a qual o template de tela de login pode ser gerado ao navegar para rota `/login`, e também como ele se comunica
   * com o serviço para efetuação do processo de autenticação do usuário e solicitação de nova senha.
   * Basta definir nas configurações de rota:
   *
   *
   * ```
   *   import { PoPageLoginComponent, PoPageLoginAthenticationType } from '@po-ui/ng-templates';
   *
   *   ...
   *   const routes: Routes = [
   *     {
   *       path: 'login', component: PoPageLoginComponent, data: {
   *         serviceApi: 'https://po-ui.io/sample/api/users/authentication',
   *         environment: 'development',
   *         recovery: {
   *           url: 'https://po-ui.io/sample/api/users',
   *           type: PoModalPasswordRecoveryType.All,
   *           contactMail: 'dev.po@po-ui.com',
   *           phoneMask: '9-999-999-9999'
   *         },
   *         registerUrl: '/new-password',
   *         authenticationType: PoPageLoginAthenticationType.Basic
   *       }
   *     }
   *     ...
   *   ];
   *
   *   @NgModule({
   *     imports: [RouterModule.forRoot(routes)],
   *     exports: [RouterModule]
   *   })
   *   export class AppRoutingModule { }
   * ```
   *
   *
   * O metadado `serviceApi` deve ser a **url** para requisição dos recursos de autenticação, o `environment` alimenta a propriedade
   * `p-environment`, `recovery` é a interface `PoPageLoginRecovery` responsável pelas especificações contidas na modal de recuperação de
   * senha, `registerUrl` alimenta a propriedade `p-register-url` e `authenticationType` que define a propriedade `p-authentication-type`.
   *
   * > É essencial que siga a nomenclatura dos atributos exemplificados acima para sua efetiva funcionalidade.
   *
   */
  set authenticationUrl(value) {
    this._authenticationUrl = isTypeof(value, "string") ? value : void 0;
  }
  get authenticationUrl() {
    return this._authenticationUrl;
  }
  /**
   * @optional
   *
   * @description
   *
   * Caso o valor atribuído para `p-exceeded-attempts-warning` seja igual a 0(zero) e a aplicação tenha um link de bloqueio de usuário,
   * informe uma url externa ou uma rota válida, dessa forma em caso de bloqueio o usuário será redirecionado.
   */
  set blockedUrl(value) {
    this._blockedUrl = isTypeof(value, "string") ? value : void 0;
  }
  get blockedUrl() {
    return this._blockedUrl;
  }
  /**
   * @optional
   *
   * @description
   *
   * Exibe um botão para suporte.
   *
   * A propriedade aceita os seguintes tipos:
   *
   * - **String**: URL externa ou uma rota válida;
   * - **Function**: Função a ser disparada ao clicar no botão de suporte;
   *   ```
   *   <po-page-login>
   *     [p-support]="this.mySupport.bind(this)">
   *   </po-page-login>
   *   ```
   *
   */
  set support(value) {
    this._support = value;
  }
  get support() {
    return this._support;
  }
  /**
   * @optional
   *
   * @description
   *
   * Coleção de idiomas que o componente irá tratar e disponibilizará para o usuário escolher.
   *
   * Caso essa propriedade não seja utilizada o componente mostrará no combo os idiomas que ele suporta por padrão.
   *
   * Caso a coleção tenha um idioma, a página estará nesse idioma e não mostrará o combo.
   *
   * Caso seja passado um array vazio, a página terá o idioma configurado no `i18n` e não mostrará o combo de seleção.
   *
   * > Se for passado um idioma não suportado, será preciso passar as literais pela propriedade `p-literals`.
   *
   *
   */
  set languagesList(languagesList) {
    if (languagesList) {
      if (languagesList.length) {
        this._languagesList = languagesList;
      } else {
        this._languagesList = poLanguageDefault.filter((language) => language.language === this.language);
      }
    }
  }
  get languagesList() {
    if (this._languagesList) {
      return this._languagesList;
    }
    return poLanguageDefault;
  }
  get showLanguage() {
    return this.languagesList.length > 1;
  }
  get language() {
    return this.selectedLanguage || getShortBrowserLanguage();
  }
  get pageLoginLiterals() {
    const loginHintWithContactEmail = this.contactEmail ? this.concatenateLoginHintWithContactEmail(this.contactEmail) : void 0;
    return __spreadValues(__spreadValues(__spreadValues(__spreadValues({}, poPageLoginLiteralsDefault[poLocaleDefault]), poPageLoginLiteralsDefault[this.language]), loginHintWithContactEmail), this.literals);
  }
  constructor(loginService, router, poLanguageService) {
    this.loginService = loginService;
    this.router = router;
    this.poLanguageService = poLanguageService;
    this.selectedLanguage = this.poLanguageService.getShortLanguage();
  }
  ngOnDestroy() {
    if (this.loginSubscription) {
      this.loginSubscription.unsubscribe();
    }
  }
  closePopover() {
    this.showExceededAttemptsWarning = false;
  }
  onLoginSubmit() {
    const loginForm = {
      login: this.login,
      password: this.password,
      rememberUser: this.rememberUser
    };
    if (this.customField) {
      loginForm[this.customFieldObject.property] = this.customFieldObject.value;
    }
    if (this.authenticationUrl) {
      this.loading = true;
      this.loginSubscription = this.loginService.onLogin(this.authenticationUrl, this.authenticationType, loginForm).subscribe((data) => {
        this.setValuesToProperties();
        sessionStorage.setItem("PO_USER_LOGIN", JSON.stringify(data));
        this.openInternalLink("/");
        this.loading = false;
      }, (error) => {
        if (error.error.code === "400" || error.error.code === "401") {
          this.setValuesToProperties(error);
          this.redirectBlockedUrl(this.exceededAttemptsWarning, this.blockedUrl);
        }
        this.loading = false;
      });
    } else {
      this.loginSubmit.emit(loginForm);
      this.showExceededAttemptsWarning = this.exceededAttemptsWarning > 0;
    }
  }
  getDefaultCustomFieldObject(property) {
    return {
      property
    };
  }
  openExternalLink(url) {
    window.open(url, "_blank");
  }
  openInternalLink(url) {
    this.router.navigate([url]);
  }
  redirectBlockedUrl(attempts, blockedUrl) {
    if (attempts === 0 && blockedUrl) {
      this.showExceededAttemptsWarning = false;
      isExternalLink(blockedUrl) ? this.openExternalLink(blockedUrl) : this.openInternalLink(blockedUrl);
    }
  }
  setValuesToProperties(result) {
    if (result) {
      this.exceededAttemptsWarning = result.error.maxAttemptsRemaining;
      this.loginErrors = result.error.loginWarnings;
      this.passwordErrors = result.error.passwordWarnings;
      this.blockedUrl = result.error.blockedUrl;
    } else {
      this.exceededAttemptsWarning = 0;
      this.loginErrors = [];
      this.passwordErrors = [];
      this.blockedUrl = "";
    }
  }
  static \u0275fac = function PoPageLoginBaseComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageLoginBaseComponent)(\u0275\u0275directiveInject(PoPageLoginService), \u0275\u0275directiveInject(Router), \u0275\u0275directiveInject(PoLanguageService));
  };
  static \u0275dir = /* @__PURE__ */ \u0275\u0275defineDirective({
    type: _PoPageLoginBaseComponent,
    hostVars: 1,
    hostBindings: function PoPageLoginBaseComponent_HostBindings(rf, ctx) {
      if (rf & 2) {
        \u0275\u0275attribute("p-components-size", ctx.componentsSize);
      }
    },
    inputs: {
      background: [0, "p-background", "background"],
      logo: [0, "p-logo", "logo"],
      loginPattern: [0, "p-login-pattern", "loginPattern"],
      passwordPattern: [0, "p-password-pattern", "passwordPattern"],
      secondaryLogo: [0, "p-secondary-logo", "secondaryLogo"],
      noAutocompleteLogin: [0, "p-no-autocomplete-login", "noAutocompleteLogin"],
      noAutocompletePassword: [0, "p-no-autocomplete-password", "noAutocompletePassword"],
      hideLabelStatus: [2, "p-hide-label-status", "hideLabelStatus", convertToBoolean],
      hidePasswordPeek: [0, "p-hide-password-peek", "hidePasswordPeek"],
      componentsSize: [0, "p-components-size", "componentsSize"],
      customField: [0, "p-custom-field", "customField"],
      contactEmail: [0, "p-contact-email", "contactEmail"],
      productName: [0, "p-product-name", "productName"],
      environment: [0, "p-environment", "environment"],
      exceededAttemptsWarning: [0, "p-exceeded-attempts-warning", "exceededAttemptsWarning"],
      hideRememberUser: [0, "p-hide-remember-user", "hideRememberUser"],
      literals: [0, "p-literals", "literals"],
      loading: [0, "p-loading", "loading"],
      login: [0, "p-login", "login"],
      loginErrors: [0, "p-login-errors", "loginErrors"],
      passwordErrors: [0, "p-password-errors", "passwordErrors"],
      recovery: [0, "p-recovery", "recovery"],
      registerUrl: [0, "p-register-url", "registerUrl"],
      authenticationType: [0, "p-authentication-type", "authenticationType"],
      authenticationUrl: [0, "p-authentication-url", "authenticationUrl"],
      blockedUrl: [0, "p-blocked-url", "blockedUrl"],
      support: [0, "p-support", "support"],
      languagesList: [0, "p-languages", "languagesList"]
    },
    outputs: {
      loginChange: "p-login-change",
      loginSubmit: "p-login-submit",
      passwordChange: "p-password-change",
      languageChange: "p-language-change"
    }
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageLoginBaseComponent, [{
    type: Directive
  }], () => [{
    type: PoPageLoginService
  }, {
    type: Router
  }, {
    type: PoLanguageService
  }], {
    background: [{
      type: Input,
      args: ["p-background"]
    }],
    logo: [{
      type: Input,
      args: ["p-logo"]
    }],
    loginPattern: [{
      type: Input,
      args: ["p-login-pattern"]
    }],
    passwordPattern: [{
      type: Input,
      args: ["p-password-pattern"]
    }],
    secondaryLogo: [{
      type: Input,
      args: ["p-secondary-logo"]
    }],
    loginChange: [{
      type: Output,
      args: ["p-login-change"]
    }],
    loginSubmit: [{
      type: Output,
      args: ["p-login-submit"]
    }],
    passwordChange: [{
      type: Output,
      args: ["p-password-change"]
    }],
    languageChange: [{
      type: Output,
      args: ["p-language-change"]
    }],
    noAutocompleteLogin: [{
      type: Input,
      args: ["p-no-autocomplete-login"]
    }],
    noAutocompletePassword: [{
      type: Input,
      args: ["p-no-autocomplete-password"]
    }],
    hideLabelStatus: [{
      type: Input,
      args: [{
        alias: "p-hide-label-status",
        transform: convertToBoolean
      }]
    }],
    hidePasswordPeek: [{
      type: Input,
      args: ["p-hide-password-peek"]
    }],
    componentsSize: [{
      type: HostBinding,
      args: ["attr.p-components-size"]
    }, {
      type: Input,
      args: ["p-components-size"]
    }],
    customField: [{
      type: Input,
      args: ["p-custom-field"]
    }],
    contactEmail: [{
      type: Input,
      args: ["p-contact-email"]
    }],
    productName: [{
      type: Input,
      args: ["p-product-name"]
    }],
    environment: [{
      type: Input,
      args: ["p-environment"]
    }],
    exceededAttemptsWarning: [{
      type: Input,
      args: ["p-exceeded-attempts-warning"]
    }],
    hideRememberUser: [{
      type: Input,
      args: ["p-hide-remember-user"]
    }],
    literals: [{
      type: Input,
      args: ["p-literals"]
    }],
    loading: [{
      type: Input,
      args: ["p-loading"]
    }],
    login: [{
      type: Input,
      args: ["p-login"]
    }],
    loginErrors: [{
      type: Input,
      args: ["p-login-errors"]
    }],
    passwordErrors: [{
      type: Input,
      args: ["p-password-errors"]
    }],
    recovery: [{
      type: Input,
      args: ["p-recovery"]
    }],
    registerUrl: [{
      type: Input,
      args: ["p-register-url"]
    }],
    authenticationType: [{
      type: Input,
      args: ["p-authentication-type"]
    }],
    authenticationUrl: [{
      type: Input,
      args: ["p-authentication-url"]
    }],
    blockedUrl: [{
      type: Input,
      args: ["p-blocked-url"]
    }],
    support: [{
      type: Input,
      args: ["p-support"]
    }],
    languagesList: [{
      type: Input,
      args: ["p-languages"]
    }]
  });
})();
var PoPageLoginPopoverComponent = class _PoPageLoginPopoverComponent {
  literals;
  /** exibe o link de 'esqueci minha senha' e verifica se o valor é um link interno ou externo */
  set recovery(value) {
    this._recovery = value;
    if (isTypeof(value, "string")) {
      this.recoveryType = isExternalLink(value) ? "externalLink" : "internalLink";
    }
  }
  get recovery() {
    return this._recovery;
  }
  /** define se a mensagem deverá ser exibida caso seja maior que 0(zero) */
  remainingAttempts;
  /** se 'p-recovery' for do tipo Function ou PoPageLoginRecovery, emite para o método 'openUrl' do componente 'po-page-login' */
  forgotPassword = new EventEmitter();
  recoveryType;
  _recovery;
  onForgotPasswordClick(recovery) {
    this.forgotPassword.emit(recovery);
  }
  static \u0275fac = function PoPageLoginPopoverComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageLoginPopoverComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageLoginPopoverComponent,
    selectors: [["po-page-login-popover"]],
    inputs: {
      literals: [0, "p-literals", "literals"],
      recovery: [0, "p-recovery", "recovery"],
      remainingAttempts: [0, "p-remaining-attempts", "remainingAttempts"]
    },
    outputs: {
      forgotPassword: "p-forgot-password"
    },
    standalone: false,
    decls: 18,
    vars: 10,
    consts: [[1, "po-page-login-popover-container"], [1, "po-page-login-popover"], [1, "po-page-login-popover-arrow"], [1, "po-page-login-popover-content"], [1, "po-font-text-bold", "po-page-login-popover-title"], [1, "po-font-text"], [1, "po-font-text-bold", "po-page-login-popover-attempts"], [1, "po-font-text-bold", "po-mt-1", "po-page-login-popover-link-container"], [1, "po-page-login-popover-link", 3, "routerLink"], ["target", "_blank", 1, "po-page-login-popover-link", 3, "href"], [1, "po-page-login-popover-link"], [1, "po-page-login-popover-link", 3, "click"]],
    template: function PoPageLoginPopoverComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 0)(1, "div", 1);
        \u0275\u0275element(2, "div", 2);
        \u0275\u0275elementStart(3, "div", 3)(4, "p", 4);
        \u0275\u0275text(5);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(6, "p", 5);
        \u0275\u0275text(7);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(8, "p", 5);
        \u0275\u0275text(9);
        \u0275\u0275elementStart(10, "span", 6);
        \u0275\u0275text(11);
        \u0275\u0275pipe(12, "poI18n");
        \u0275\u0275elementEnd();
        \u0275\u0275text(13);
        \u0275\u0275elementEnd();
        \u0275\u0275element(14, "br");
        \u0275\u0275elementStart(15, "p", 5);
        \u0275\u0275text(16);
        \u0275\u0275elementEnd();
        \u0275\u0275template(17, PoPageLoginPopoverComponent_Conditional_17_Template, 4, 3, "div", 7);
        \u0275\u0275elementEnd()()();
      }
      if (rf & 2) {
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate1(" ", ctx.literals == null ? null : ctx.literals.titlePopover, " ");
        \u0275\u0275advance(2);
        \u0275\u0275textInterpolate1(" ", ctx.literals == null ? null : ctx.literals.forgotYourPassword, " ");
        \u0275\u0275advance(2);
        \u0275\u0275textInterpolate1(" ", ctx.literals == null ? null : ctx.literals.ifYouTryHarder, " ");
        \u0275\u0275advance(2);
        \u0275\u0275textInterpolate1(" ", \u0275\u0275pipeBind2(12, 7, ctx.literals == null ? null : ctx.literals.attempts, ctx.remainingAttempts), " ");
        \u0275\u0275advance(2);
        \u0275\u0275textInterpolate1("", ctx.literals == null ? null : ctx.literals.yourUserWillBeBlocked, " ");
        \u0275\u0275advance(3);
        \u0275\u0275textInterpolate1(" ", ctx.literals == null ? null : ctx.literals.createANewPasswordNow, " ");
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.recovery ? 17 : -1);
      }
    },
    dependencies: [RouterLink, PoI18nPipe],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageLoginPopoverComponent, [{
    type: Component,
    args: [{
      selector: "po-page-login-popover",
      standalone: false,
      template: `<div class="po-page-login-popover-container">
  <div class="po-page-login-popover">
    <div class="po-page-login-popover-arrow"></div>
    <div class="po-page-login-popover-content">
      <p class="po-font-text-bold po-page-login-popover-title">
        {{ literals?.titlePopover }}
      </p>
      <p class="po-font-text">
        {{ literals?.forgotYourPassword }}
      </p>
      <p class="po-font-text">
        {{ literals?.ifYouTryHarder }}
        <span class="po-font-text-bold po-page-login-popover-attempts">
          {{ literals?.attempts | poI18n: remainingAttempts }} </span
        >{{ literals?.yourUserWillBeBlocked }}
      </p>
      <br />
      <p class="po-font-text">
        {{ literals?.createANewPasswordNow }}
      </p>
      @if (recovery) {
        <div class="po-font-text-bold po-mt-1 po-page-login-popover-link-container">
          @if (recoveryType === 'internalLink') {
            <a class="po-page-login-popover-link" [routerLink]="recovery">
              {{ literals?.iForgotMyPassword }}
            </a>
          }
          @if (recoveryType === 'externalLink') {
            <a class="po-page-login-popover-link" [href]="recovery" target="_blank">
              {{ literals?.iForgotMyPassword }}
            </a>
          }
          @if (!recoveryType) {
            <a class="po-page-login-popover-link" (click)="onForgotPasswordClick(recovery)">
              {{ literals?.iForgotMyPassword }}
            </a>
          }
        </div>
      }
    </div>
  </div>
</div>
`
    }]
  }], null, {
    literals: [{
      type: Input,
      args: ["p-literals"]
    }],
    recovery: [{
      type: Input,
      args: ["p-recovery"]
    }],
    remainingAttempts: [{
      type: Input,
      args: ["p-remaining-attempts"]
    }],
    forgotPassword: [{
      type: Output,
      args: ["p-forgot-password"]
    }]
  });
})();
var PoPageLoginComponent = class _PoPageLoginComponent extends PoPageLoginBaseComponent {
  changeDetector = inject(ChangeDetectorRef);
  activatedRoute = inject(ActivatedRoute);
  poComponentInjector = inject(PoComponentInjectorService);
  loginForm;
  pageLogin;
  initialSelectLanguage;
  componentRef = null;
  differ;
  customPasswordError = {
    custom: false
  };
  constructor() {
    const differs = inject(IterableDiffers);
    const loginService = inject(PoPageLoginService);
    const router = inject(Router);
    const poLanguageService = inject(PoLanguageService);
    super(loginService, router, poLanguageService);
    this.differ = differs.find([]).create(null);
  }
  ngAfterViewChecked() {
    if (this.differ) {
      this.validateArrayChanges(this.differ, [{
        array: this.loginErrors,
        callback: this.generateLoginError.bind(this)
      }, {
        array: this.passwordErrors,
        callback: this.generatePasswordError.bind(this)
      }]);
    }
  }
  ngOnInit() {
    this.checkingForRouteMetadata(this.activatedRoute.snapshot.data);
    this.selectedLanguage = this.initializeLanguage();
    this.initialSelectLanguage = this.selectedLanguage;
  }
  activateSupport() {
    switch (typeof this.support) {
      case "string": {
        this.setUrlRedirect(this.support);
        break;
      }
      case "function": {
        this.support();
        break;
      }
    }
  }
  changeLoginModel() {
    if (this.authenticationUrl) {
      this.loginErrors = [];
    } else {
      this.setLoginErrors(this.loginErrors);
      this.loginChange.emit(this.login);
    }
  }
  changePasswordModel() {
    if (this.authenticationUrl) {
      this.passwordErrors = [];
    } else {
      this.setPasswordErrors(this.passwordErrors);
      this.passwordChange.emit(this.password);
    }
  }
  onSelectedLanguage(language) {
    this.languageChange.emit(this.languagesList.find((languageItem) => languageItem.language === language));
    this.selectedLanguage = language;
  }
  openUrl(recovery) {
    switch (typeof recovery) {
      case "string": {
        this.setUrlRedirect(recovery);
        break;
      }
      case "function": {
        recovery();
        break;
      }
      case "object": {
        this.createModalPasswordRecoveryComponent(recovery);
        break;
      }
    }
  }
  concatenateLoginHintWithContactEmail(contactEmail) {
    const defaultLoginHintLiteral = poPageLoginLiteralsDefault[this.language].loginHint;
    const prepositionLiteral = poPageLoginLiteralIn[this.language];
    return this.concatenateLiteral(contactEmail, "loginHint", defaultLoginHintLiteral, prepositionLiteral);
  }
  setLoginErrors(errors) {
    const control = this.loginForm.form.controls["login"];
    this.setControlErrors("allLoginErrors", control, errors, this.pageLoginLiterals.loginErrorPattern);
  }
  setPasswordErrors(errors) {
    const control = this.loginForm.form.controls["password"];
    this.setControlErrors("allPasswordErrors", control, errors, this.pageLoginLiterals.passwordErrorPattern);
  }
  checkingForMetadataProperty(object, property) {
    if (Object.prototype.hasOwnProperty.call(object, property)) {
      return object[property];
    }
  }
  checkingForRouteMetadata(data) {
    if (Object.keys(data).length !== 0) {
      this.authenticationUrl = this.checkingForMetadataProperty(data, "serviceApi") || this.authenticationUrl;
      this.authenticationType = this.checkingForMetadataProperty(data, "authenticationType") || this.authenticationType;
      this.environment = this.checkingForMetadataProperty(data, "environment") || this.environment;
      this.recovery = this.checkingForMetadataProperty(data, "recovery") || this.recovery;
      this.registerUrl = this.checkingForMetadataProperty(data, "registerUrl") || this.registerUrl;
    }
  }
  concatenate(defaultLiteral, prefixLiteral, value) {
    return `${defaultLiteral} ${prefixLiteral} ${value}`;
  }
  concatenateLiteral(value, literal, defaultLiteral, prepositionLiteral) {
    return {
      [literal]: this.concatenate(defaultLiteral, prepositionLiteral, value)
    };
  }
  createModalPasswordRecoveryComponent(poPageLoginRecovery) {
    if (this.componentRef) {
      this.poComponentInjector.destroyComponentInApplication(this.componentRef);
    }
    this.componentRef = this.poComponentInjector.createComponentInApplication(PoModalPasswordRecoveryComponent);
    this.componentRef.instance.urlRecovery = poPageLoginRecovery.url;
    this.componentRef.instance.contactEmail = poPageLoginRecovery.contactMail;
    this.componentRef.instance.phoneMask = poPageLoginRecovery.phoneMask;
    this.componentRef.instance.type = poPageLoginRecovery.type || PoModalPasswordRecoveryType.Email;
    this.componentRef.changeDetectorRef.detectChanges();
    setTimeout(() => {
      this.componentRef.instance.open();
    });
  }
  generateLoginError() {
    if (this.loginErrors && this.loginErrors.length) {
      this.setLoginErrors(this.loginErrors);
    } else {
      const control = this.loginForm.form.controls["login"];
      if (control) {
        this.resetControl(control);
      }
    }
  }
  generatePasswordError() {
    if (this.passwordErrors && this.passwordErrors.length) {
      this.setPasswordErrors(this.passwordErrors);
    } else {
      const control = this.loginForm.form.controls["password"];
      if (control) {
        this.resetControl(control);
      }
    }
  }
  resetControl(control) {
    control.markAsPristine();
    control.markAsUntouched();
    control.updateValueAndValidity();
  }
  setControlErrors(allErrors, control, errors, patternError) {
    if (control) {
      this[allErrors] = control.hasError("pattern") ? [...errors, ...[patternError]] : [...errors];
      if (errors && errors.length && (control.valid || control.pristine)) {
        control.markAsTouched();
        control.markAsDirty();
        control.setErrors(this.customPasswordError);
      }
    }
  }
  setUrlRedirect(url) {
    isExternalLink(url) ? window.open(url, "_blank") : this.router.navigate([url]);
  }
  validateArrayChanges(differ, array) {
    array.forEach((element) => {
      const changes = differ.diff(element.array);
      if (changes) {
        element.callback();
        this.changeDetector.detectChanges();
      }
    });
  }
  initializeLanguage() {
    const language = this.languagesList.find((languageItem) => languageItem.language === this.language);
    return language?.language || this.languagesList[0].language;
  }
  static \u0275fac = function PoPageLoginComponent_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageLoginComponent)();
  };
  static \u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
    type: _PoPageLoginComponent,
    selectors: [["po-page-login"]],
    viewQuery: function PoPageLoginComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c20, 7, NgForm);
        \u0275\u0275viewQuery(_c21, 7, ViewContainerRef);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.loginForm = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.pageLogin = _t.first);
      }
    },
    standalone: false,
    features: [\u0275\u0275InheritDefinitionFeature],
    decls: 38,
    vars: 44,
    consts: [["pageLogin", ""], ["loginForm", "ngForm"], [1, "po-page-login-support", 3, "click", "hidden"], ["p-icon", "ICON_HELP"], [3, "p-selected-language", "p-components-size", "p-show-select-language", "p-languages", "p-initial-language", "p-background", "p-highlight-info", "p-logo", "p-secondary-logo"], [1, "po-page-login-header"], [1, "po-page-login-header-product-name"], [1, "po-page-login-header-product-environment", "po-mb-md-4", "po-mb-sm-1"], ["p-type", "warning", 3, "p-value"], [1, "po-page-login-header-welcome", "po-mb-md-4", "po-mb-sm-2"], [1, "po-page-login-form"], [1, "po-row"], [1, "po-lg-12"], [1, "po-page-login-hint", "po-page-login-info-container"], ["name", "login", "p-auto-focus", "", "p-required", "", 1, "po-page-login-info-field", 3, "ngModelChange", "click", "keyup.enter", "p-change-model", "ngModel", "p-label", "p-no-autocomplete", "p-pattern", "p-placeholder", "p-size"], [1, "po-page-login-info-icon-container", 3, "po-page-login-info-icon-container-dynamic"], [1, "po-field-container-bottom", "po-field-container-error-container"], [1, "po-field-container-bottom-text-error", "po-field-container-error-item"], [1, "po-page-login-password-container"], ["name", "password", "p-required", "", 1, "po-page-login-field-size", "po-page-login-password-item", 3, "ngModelChange", "click", "keyup.enter", "p-change-model", "ngModel", "p-hide-password-peek", "p-label", "p-no-autocomplete", "p-pattern", "p-placeholder", "p-size"], [1, "po-page-login-password-item", "po-page-login-password-popover-container"], ["name", "customFieldInput", "p-required", "", 1, "po-page-login-field-size", "po-lg-12", 3, "po-page-login-field-size-dynamic", "ngModel", "p-error-pattern", "p-pattern", "p-placeholder", "p-size"], ["name", "customFieldCombo", "p-required", "", 1, "po-page-login-field-size", "po-lg-12", 3, "po-page-login-field-size-dynamic", "ngModel", "p-field-value", "p-filter-service", "p-placeholder", "p-size"], ["name", "customFieldSelect", "p-required", "", 1, "po-page-login-field-size", "po-lg-12", 3, "po-page-login-field-size-dynamic", "ngModel", "p-placeholder", "p-options", "p-size"], ["p-kind", "primary", 1, "po-lg-12", "po-page-login-button", "po-page-login-field-size", 3, "p-click", "p-disabled", "p-label", "p-loading", "p-size"], [1, "po-page-login-recovery-link"], [1, "po-page-login-register-link"], [1, "po-page-login-info-icon-container"], ["p-icon", "ICON_INFO po-field-icon", "p-tooltip-position", "right", 3, "p-tooltip"], ["p-icon", "ICON_EXCLAMATION"], [1, "po-field-error-message"], [3, "p-literals", "p-recovery", "p-remaining-attempts"], [3, "p-forgot-password", "p-literals", "p-recovery", "p-remaining-attempts"], ["name", "customFieldInput", "p-required", "", 1, "po-page-login-field-size", "po-lg-12", 3, "ngModelChange", "keyup.enter", "ngModel", "p-error-pattern", "p-pattern", "p-placeholder", "p-size"], ["name", "customFieldCombo", "p-required", "", 1, "po-page-login-field-size", "po-lg-12", 3, "ngModelChange", "ngModel", "p-field-value", "p-filter-service", "p-placeholder", "p-size"], ["name", "customFieldSelect", "p-required", "", 1, "po-page-login-field-size", "po-lg-12", 3, "ngModelChange", "ngModel", "p-placeholder", "p-options", "p-size"], ["name", "rememberUser", "p-label-position", "1", 1, "po-page-login-info-field", "po-lg-7", "po-offset-lg-5", "po-offset-xl-5", 3, "ngModelChange", "keyup.enter", "ngModel", "p-label-off", "p-label-on", "p-size", "p-hide-label-status"], [1, "po-page-login-info-icon-container", "po-page-login-info-icon-remember-user", 3, "po-page-login-info-icon-container-dynamic"], [1, "po-page-login-info-icon-container", "po-page-login-info-icon-remember-user"], [1, "po-font-text-large-bold", 3, "click"]],
    template: function PoPageLoginComponent_Template(rf, ctx) {
      if (rf & 1) {
        const _r1 = \u0275\u0275getCurrentView();
        \u0275\u0275elementStart(0, "button", 2);
        \u0275\u0275listener("click", function PoPageLoginComponent_Template_button_click_0_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.activateSupport());
        });
        \u0275\u0275element(1, "po-icon", 3);
        \u0275\u0275text(2);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(3, "po-page-background", 4, 0);
        \u0275\u0275listener("p-selected-language", function PoPageLoginComponent_Template_po_page_background_p_selected_language_3_listener($event) {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.onSelectedLanguage($event));
        });
        \u0275\u0275elementStart(5, "header", 5)(6, "div", 6)(7, "h1");
        \u0275\u0275text(8);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(9, "div", 7);
        \u0275\u0275template(10, PoPageLoginComponent_Conditional_10_Template, 1, 1, "po-tag", 8);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(11, "div", 9);
        \u0275\u0275text(12);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(13, "form", 10, 1)(15, "div", 11)(16, "div", 12)(17, "div", 13)(18, "po-login", 14);
        \u0275\u0275twoWayListener("ngModelChange", function PoPageLoginComponent_Template_po_login_ngModelChange_18_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.login, $event) || (ctx.login = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275listener("click", function PoPageLoginComponent_Template_po_login_click_18_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.closePopover());
        })("keyup.enter", function PoPageLoginComponent_Template_po_login_keyup_enter_18_listener() {
          \u0275\u0275restoreView(_r1);
          const loginForm_r3 = \u0275\u0275reference(14);
          return \u0275\u0275resetView(loginForm_r3.valid && ctx.onLoginSubmit());
        })("p-change-model", function PoPageLoginComponent_Template_po_login_p_change_model_18_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.changeLoginModel());
        });
        \u0275\u0275elementEnd();
        \u0275\u0275template(19, PoPageLoginComponent_Conditional_19_Template, 2, 3, "div", 15);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(20, "div", 16);
        \u0275\u0275repeaterCreate(21, PoPageLoginComponent_For_22_Template, 4, 1, "div", 17, \u0275\u0275repeaterTrackByIdentity);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(23, "div", 12)(24, "div", 18)(25, "po-password", 19);
        \u0275\u0275twoWayListener("ngModelChange", function PoPageLoginComponent_Template_po_password_ngModelChange_25_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.password, $event) || (ctx.password = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275listener("click", function PoPageLoginComponent_Template_po_password_click_25_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.closePopover());
        })("keyup.enter", function PoPageLoginComponent_Template_po_password_keyup_enter_25_listener() {
          \u0275\u0275restoreView(_r1);
          const loginForm_r3 = \u0275\u0275reference(14);
          return \u0275\u0275resetView(loginForm_r3.valid && ctx.onLoginSubmit());
        })("p-change-model", function PoPageLoginComponent_Template_po_password_p_change_model_25_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.changePasswordModel());
        });
        \u0275\u0275elementEnd();
        \u0275\u0275template(26, PoPageLoginComponent_Conditional_26_Template, 2, 1, "div", 20);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(27, "div", 16);
        \u0275\u0275repeaterCreate(28, PoPageLoginComponent_For_29_Template, 4, 1, "div", 17, \u0275\u0275repeaterTrackByIdentity);
        \u0275\u0275elementEnd()();
        \u0275\u0275template(30, PoPageLoginComponent_Conditional_30_Template, 1, 7, "po-input", 21)(31, PoPageLoginComponent_Conditional_31_Template, 1, 7, "po-combo", 22)(32, PoPageLoginComponent_Conditional_32_Template, 1, 6, "po-select", 23);
        \u0275\u0275elementStart(33, "div", 12);
        \u0275\u0275template(34, PoPageLoginComponent_Conditional_34_Template, 3, 6, "div", 13);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(35, "po-button", 24);
        \u0275\u0275listener("p-click", function PoPageLoginComponent_Template_po_button_p_click_35_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.onLoginSubmit());
        });
        \u0275\u0275elementEnd();
        \u0275\u0275template(36, PoPageLoginComponent_Conditional_36_Template, 3, 1, "div", 25)(37, PoPageLoginComponent_Conditional_37_Template, 3, 1, "div", 26);
        \u0275\u0275elementEnd()()();
      }
      if (rf & 2) {
        const loginForm_r3 = \u0275\u0275reference(14);
        \u0275\u0275property("hidden", !ctx.support);
        \u0275\u0275advance(2);
        \u0275\u0275textInterpolate1(" ", ctx.pageLoginLiterals == null ? null : ctx.pageLoginLiterals.support, "\n");
        \u0275\u0275advance();
        \u0275\u0275property("p-components-size", ctx.componentsSize)("p-show-select-language", ctx.showLanguage)("p-languages", ctx.languagesList)("p-initial-language", ctx.initialSelectLanguage)("p-background", ctx.background)("p-highlight-info", ctx.pageLoginLiterals.highlightInfo)("p-logo", ctx.logo)("p-secondary-logo", ctx.secondaryLogo);
        \u0275\u0275advance(5);
        \u0275\u0275textInterpolate(ctx.productName);
        \u0275\u0275advance(2);
        \u0275\u0275conditional(ctx.environment ? 10 : -1);
        \u0275\u0275advance(2);
        \u0275\u0275textInterpolate(ctx.pageLoginLiterals.welcome);
        \u0275\u0275advance(6);
        \u0275\u0275classProp("po-page-login-info-field-dynamic", !ctx.pageLoginLiterals.loginHint && !ctx.pageLoginLiterals.rememberUserHint);
        \u0275\u0275twoWayProperty("ngModel", ctx.login);
        \u0275\u0275property("p-label", ctx.pageLoginLiterals.loginLabel)("p-no-autocomplete", ctx.noAutocompleteLogin)("p-pattern", ctx.loginPattern)("p-placeholder", ctx.pageLoginLiterals.loginPlaceholder)("p-size", ctx.componentsSize);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.pageLoginLiterals.loginHint || ctx.pageLoginLiterals.rememberUserHint ? 19 : -1);
        \u0275\u0275advance(2);
        \u0275\u0275repeater(ctx.allLoginErrors);
        \u0275\u0275advance(4);
        \u0275\u0275classProp("po-page-login-field-size-dynamic", !ctx.pageLoginLiterals.loginHint && !ctx.pageLoginLiterals.rememberUserHint);
        \u0275\u0275twoWayProperty("ngModel", ctx.password);
        \u0275\u0275property("p-hide-password-peek", ctx.hidePasswordPeek)("p-label", ctx.pageLoginLiterals.passwordLabel)("p-no-autocomplete", ctx.noAutocompletePassword)("p-pattern", ctx.passwordPattern)("p-placeholder", ctx.pageLoginLiterals.passwordPlaceholder)("p-size", ctx.componentsSize);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.pageLoginLiterals.loginHint || ctx.pageLoginLiterals.rememberUserHint ? 26 : -1);
        \u0275\u0275advance(2);
        \u0275\u0275repeater(ctx.allPasswordErrors);
        \u0275\u0275advance(2);
        \u0275\u0275conditional(ctx.customField && ctx.customFieldType === "input" ? 30 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.customField && ctx.customFieldType === "combo" ? 31 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.customField && ctx.customFieldType === "select" ? 32 : -1);
        \u0275\u0275advance(2);
        \u0275\u0275conditional(!ctx.hideRememberUser ? 34 : -1);
        \u0275\u0275advance();
        \u0275\u0275classProp("po-page-login-button-dynamic", !ctx.pageLoginLiterals.loginHint && !ctx.pageLoginLiterals.rememberUserHint);
        \u0275\u0275property("p-disabled", loginForm_r3.invalid)("p-label", ctx.loading ? ctx.pageLoginLiterals.submittedLabel : ctx.pageLoginLiterals.submitLabel)("p-loading", ctx.loading)("p-size", ctx.componentsSize);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.recovery ? 36 : -1);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.registerUrl ? 37 : -1);
      }
    },
    dependencies: [\u0275NgNoValidate, NgControlStatus, NgControlStatusGroup, NgModel, NgForm, PoPageBackgroundComponent, PoButtonComponent, PoComboComponent, PoInputComponent, PoLoginComponent, PoPasswordComponent, PoSelectComponent, PoSwitchComponent, PoTagComponent, PoIconComponent, PoTooltipDirective, PoPageLoginPopoverComponent],
    encapsulation: 2
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageLoginComponent, [{
    type: Component,
    args: [{
      selector: "po-page-login",
      standalone: false,
      template: `<button class="po-page-login-support" (click)="activateSupport()" [hidden]="!support">
  <po-icon p-icon="ICON_HELP"></po-icon>
  {{ pageLoginLiterals?.support }}
</button>

<po-page-background
  #pageLogin
  [p-components-size]="componentsSize"
  [p-show-select-language]="showLanguage"
  [p-languages]="languagesList"
  [p-initial-language]="initialSelectLanguage"
  [p-background]="background"
  [p-highlight-info]="pageLoginLiterals.highlightInfo"
  [p-logo]="logo"
  [p-secondary-logo]="secondaryLogo"
  (p-selected-language)="onSelectedLanguage($event)"
>
  <header class="po-page-login-header">
    <div class="po-page-login-header-product-name">
      <h1>{{ productName }}</h1>
    </div>

    <div class="po-page-login-header-product-environment po-mb-md-4 po-mb-sm-1">
      @if (environment) {
        <po-tag p-type="warning" [p-value]="environment"> </po-tag>
      }
    </div>
    <div class="po-page-login-header-welcome po-mb-md-4 po-mb-sm-2">{{ pageLoginLiterals.welcome }}</div>
  </header>

  <form #loginForm="ngForm" class="po-page-login-form">
    <div class="po-row">
      <div class="po-lg-12">
        <div class="po-page-login-hint po-page-login-info-container">
          <po-login
            class="po-page-login-info-field"
            [class.po-page-login-info-field-dynamic]="
              !pageLoginLiterals.loginHint && !pageLoginLiterals.rememberUserHint
            "
            name="login"
            [(ngModel)]="login"
            p-auto-focus
            p-required
            [p-label]="pageLoginLiterals.loginLabel"
            [p-no-autocomplete]="noAutocompleteLogin"
            [p-pattern]="loginPattern"
            [p-placeholder]="pageLoginLiterals.loginPlaceholder"
            [p-size]="componentsSize"
            (click)="closePopover()"
            (keyup.enter)="loginForm.valid && onLoginSubmit()"
            (p-change-model)="changeLoginModel()"
          >
          </po-login>

          @if (pageLoginLiterals.loginHint || pageLoginLiterals.rememberUserHint) {
            <div
              class="po-page-login-info-icon-container"
              [class.po-page-login-info-icon-container-dynamic]="
                !pageLoginLiterals.loginHint && !pageLoginLiterals.rememberUserHint
              "
            >
              @if (pageLoginLiterals.loginHint) {
                <po-icon
                  p-icon="ICON_INFO po-field-icon"
                  p-tooltip-position="right"
                  [p-tooltip]="pageLoginLiterals.loginHint"
                >
                </po-icon>
              }
            </div>
          }
        </div>

        <div class="po-field-container-bottom po-field-container-error-container">
          @for (error of allLoginErrors; track error) {
            <div class="po-field-container-bottom-text-error po-field-container-error-item">
              <po-icon p-icon="ICON_EXCLAMATION"></po-icon>
              <span class="po-field-error-message">{{ error }}</span>
            </div>
          }
        </div>
      </div>

      <div class="po-lg-12">
        <div class="po-page-login-password-container">
          <po-password
            class="po-page-login-field-size po-page-login-password-item"
            [class.po-page-login-field-size-dynamic]="
              !pageLoginLiterals.loginHint && !pageLoginLiterals.rememberUserHint
            "
            name="password"
            [(ngModel)]="password"
            p-required
            [p-hide-password-peek]="hidePasswordPeek"
            [p-label]="pageLoginLiterals.passwordLabel"
            [p-no-autocomplete]="noAutocompletePassword"
            [p-pattern]="passwordPattern"
            [p-placeholder]="pageLoginLiterals.passwordPlaceholder"
            [p-size]="componentsSize"
            (click)="closePopover()"
            (keyup.enter)="loginForm.valid && onLoginSubmit()"
            (p-change-model)="changePasswordModel()"
          >
          </po-password>
          @if (pageLoginLiterals.loginHint || pageLoginLiterals.rememberUserHint) {
            <div class="po-page-login-password-item po-page-login-password-popover-container">
              @if (showExceededAttemptsWarning && exceededAttemptsWarning) {
                <po-page-login-popover
                  [p-literals]="pageLoginLiterals"
                  [p-recovery]="recovery"
                  [p-remaining-attempts]="exceededAttemptsWarning"
                  (p-forgot-password)="openUrl($event)"
                >
                </po-page-login-popover>
              }
            </div>
          }
        </div>
        <div class="po-field-container-bottom po-field-container-error-container">
          @for (error of allPasswordErrors; track error) {
            <div class="po-field-container-bottom-text-error po-field-container-error-item">
              <po-icon p-icon="ICON_EXCLAMATION"></po-icon>
              <span class="po-field-error-message">{{ error }}</span>
            </div>
          }
        </div>
      </div>

      @if (customField && customFieldType === 'input') {
        <po-input
          [class.po-page-login-field-size-dynamic]="!pageLoginLiterals.loginHint && !pageLoginLiterals.rememberUserHint"
          class="po-page-login-field-size po-lg-12"
          name="customFieldInput"
          [(ngModel)]="customFieldObject.value"
          p-required
          [p-error-pattern]="customFieldObject.errorPattern || pageLoginLiterals.customFieldErrorPattern"
          [p-pattern]="customFieldObject.pattern"
          [p-placeholder]="customFieldObject.placeholder || pageLoginLiterals.customFieldPlaceholder"
          [p-size]="componentsSize"
          (keyup.enter)="loginForm.valid && onLoginSubmit()"
        >
        </po-input>
      }

      @if (customField && customFieldType === 'combo') {
        <po-combo
          [class.po-page-login-field-size-dynamic]="!pageLoginLiterals.loginHint && !pageLoginLiterals.rememberUserHint"
          class="po-page-login-field-size po-lg-12"
          name="customFieldCombo"
          [(ngModel)]="customFieldObject.value"
          p-required
          [p-field-value]="customFieldObject.fieldValue"
          [p-filter-service]="customFieldObject.url"
          [p-placeholder]="customFieldObject.placeholder || pageLoginLiterals.customFieldPlaceholder"
          [p-size]="componentsSize"
        >
        </po-combo>
      }

      @if (customField && customFieldType === 'select') {
        <po-select
          [class.po-page-login-field-size-dynamic]="!pageLoginLiterals.loginHint && !pageLoginLiterals.rememberUserHint"
          class="po-page-login-field-size po-lg-12"
          name="customFieldSelect"
          [(ngModel)]="customFieldObject.value"
          p-required
          [p-placeholder]="customFieldObject.placeholder || pageLoginLiterals.customFieldPlaceholder"
          [p-options]="customFieldObject.options"
          [p-size]="componentsSize"
        >
        </po-select>
      }

      <div class="po-lg-12">
        @if (!hideRememberUser) {
          <div class="po-page-login-hint po-page-login-info-container">
            <po-switch
              class="po-page-login-info-field po-lg-7 po-offset-lg-5 po-offset-xl-5"
              name="rememberUser"
              [(ngModel)]="rememberUser"
              p-label-position="1"
              [p-label-off]="pageLoginLiterals.rememberUser"
              [p-label-on]="pageLoginLiterals.rememberUser"
              [p-size]="componentsSize"
              (keyup.enter)="loginForm.valid && onLoginSubmit()"
              [p-hide-label-status]="hideLabelStatus"
            >
            </po-switch>
            @if (pageLoginLiterals.loginHint || pageLoginLiterals.rememberUserHint) {
              <div
                class="po-page-login-info-icon-container po-page-login-info-icon-remember-user"
                [class.po-page-login-info-icon-container-dynamic]="!pageLoginLiterals.rememberUserHint"
              >
                @if (pageLoginLiterals.rememberUserHint) {
                  <po-icon
                    p-icon="ICON_INFO po-field-icon"
                    p-tooltip-position="right"
                    [p-tooltip]="pageLoginLiterals.rememberUserHint"
                  >
                  </po-icon>
                }
              </div>
            }
          </div>
        }
      </div>

      <po-button
        [class.po-page-login-button-dynamic]="!pageLoginLiterals.loginHint && !pageLoginLiterals.rememberUserHint"
        class="po-lg-12 po-page-login-button po-page-login-field-size"
        p-kind="primary"
        [p-disabled]="loginForm.invalid"
        [p-label]="loading ? pageLoginLiterals.submittedLabel : pageLoginLiterals.submitLabel"
        [p-loading]="loading"
        [p-size]="componentsSize"
        (p-click)="onLoginSubmit()"
      >
      </po-button>

      @if (recovery) {
        <div class="po-page-login-recovery-link">
          <a class="po-font-text-large-bold" (click)="openUrl(recovery)">{{ pageLoginLiterals.forgotPassword }}</a>
        </div>
      }

      @if (registerUrl) {
        <div class="po-page-login-register-link">
          <a class="po-font-text-large-bold" (click)="openUrl(registerUrl)">{{ pageLoginLiterals.registerUrl }}</a>
        </div>
      }
    </div>
  </form>
</po-page-background>
`
    }]
  }], () => [], {
    loginForm: [{
      type: ViewChild,
      args: ["loginForm", {
        read: NgForm,
        static: true
      }]
    }],
    pageLogin: [{
      type: ViewChild,
      args: ["pageLogin", {
        read: ViewContainerRef,
        static: true
      }]
    }]
  });
})();
var PoPageLoginModule = class _PoPageLoginModule {
  static \u0275fac = function PoPageLoginModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoPageLoginModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoPageLoginModule,
    declarations: [PoPageLoginComponent, PoPageLoginPopoverComponent],
    imports: [CommonModule, FormsModule, RouterModule, PoPageBackgroundModule, PoModule],
    exports: [PoPageLoginComponent]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    providers: [PoPageLoginService],
    imports: [CommonModule, FormsModule, RouterModule, PoPageBackgroundModule, PoModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoPageLoginModule, [{
    type: NgModule,
    args: [{
      imports: [CommonModule, FormsModule, RouterModule, PoPageBackgroundModule, PoModule],
      declarations: [PoPageLoginComponent, PoPageLoginPopoverComponent],
      exports: [PoPageLoginComponent],
      providers: [PoPageLoginService]
    }]
  }], null, null);
})();
var PoComponentsModule = class _PoComponentsModule {
  static \u0275fac = function PoComponentsModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoComponentsModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoComponentsModule,
    imports: [PoModalPasswordRecoveryModule, PoPageBackgroundModule, PoPageBlockedUserModule, PoPageChangePasswordModule, PoPageDynamicDetailModule, PoPageDynamicEditModule, PoPageDynamicSearchModule, PoPageDynamicTableModule, PoPageJobSchedulerModule, PoPageLoginModule],
    exports: [PoModalPasswordRecoveryModule, PoPageBackgroundModule, PoPageBlockedUserModule, PoPageChangePasswordModule, PoPageDynamicDetailModule, PoPageDynamicEditModule, PoPageDynamicSearchModule, PoPageDynamicTableModule, PoPageJobSchedulerModule, PoPageLoginModule]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    imports: [PoModalPasswordRecoveryModule, PoPageBackgroundModule, PoPageBlockedUserModule, PoPageChangePasswordModule, PoPageDynamicDetailModule, PoPageDynamicEditModule, PoPageDynamicSearchModule, PoPageDynamicTableModule, PoPageJobSchedulerModule, PoPageLoginModule, PoModalPasswordRecoveryModule, PoPageBackgroundModule, PoPageBlockedUserModule, PoPageChangePasswordModule, PoPageDynamicDetailModule, PoPageDynamicEditModule, PoPageDynamicSearchModule, PoPageDynamicTableModule, PoPageJobSchedulerModule, PoPageLoginModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoComponentsModule, [{
    type: NgModule,
    args: [{
      imports: [PoModalPasswordRecoveryModule, PoPageBackgroundModule, PoPageBlockedUserModule, PoPageChangePasswordModule, PoPageDynamicDetailModule, PoPageDynamicEditModule, PoPageDynamicSearchModule, PoPageDynamicTableModule, PoPageJobSchedulerModule, PoPageLoginModule],
      exports: [PoModalPasswordRecoveryModule, PoPageBackgroundModule, PoPageBlockedUserModule, PoPageChangePasswordModule, PoPageDynamicDetailModule, PoPageDynamicEditModule, PoPageDynamicSearchModule, PoPageDynamicTableModule, PoPageJobSchedulerModule, PoPageLoginModule]
    }]
  }], null, null);
})();
var PoServicesModule = class _PoServicesModule {
  static \u0275fac = function PoServicesModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoServicesModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoServicesModule,
    imports: [PoPageCustomizationModule, PoPageDynamicModule],
    exports: [PoPageCustomizationModule, PoPageDynamicModule]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    imports: [PoPageCustomizationModule, PoPageDynamicModule, PoPageCustomizationModule, PoPageDynamicModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoServicesModule, [{
    type: NgModule,
    args: [{
      imports: [PoPageCustomizationModule, PoPageDynamicModule],
      exports: [PoPageCustomizationModule, PoPageDynamicModule]
    }]
  }], null, null);
})();
var PoTemplatesModule = class _PoTemplatesModule {
  static \u0275fac = function PoTemplatesModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _PoTemplatesModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _PoTemplatesModule,
    imports: [PoComponentsModule, PoServicesModule],
    exports: [PoComponentsModule, PoServicesModule]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    imports: [PoComponentsModule, PoServicesModule, PoComponentsModule, PoServicesModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(PoTemplatesModule, [{
    type: NgModule,
    args: [{
      imports: [PoComponentsModule, PoServicesModule],
      exports: [PoComponentsModule, PoServicesModule]
    }]
  }], null, null);
})();

// src/app/login/login.component.ts
var LoginComponent = class _LoginComponent {
  constructor(authService, router, poStorageService, activatedRoute) {
    this.authService = authService;
    this.router = router;
    this.poStorageService = poStorageService;
    this.activatedRoute = activatedRoute;
    this.attempts = 3;
    this.loginErrors = [];
    this.passwordErrors = [];
    this.loading = false;
    this.showPageBlocked = false;
    this.pProductName = environment.nomePortal;
  }
  ngOnInit() {
    this.loading = false;
    localStorage.clear();
    this.poStorageService.clear();
    sessionStorage.clear();
  }
  checkLogin(formData) {
    this.loading = true;
    this.authService.login(formData.login, formData.password).subscribe({
      next: (token) => {
        this.passwordErrors = [];
        this.loginErrors = [];
        localStorage.setItem("token", JSON.stringify(__spreadProps(__spreadValues({}, token), { last_token_refresh: (/* @__PURE__ */ new Date()).getTime() / 1e3 })));
        localStorage.setItem("tipoUsuario", "protheus");
        this.authService.getUser().subscribe({
          next: (usuario) => {
            this.poStorageService.set("usuario", usuario);
            if (usuario.AEMPRESA) {
              this.poStorageService.set("empresaSelecionada", usuario.AEMPRESA[0]);
              localStorage.setItem("tenantid", `${usuario.AEMPRESA[0].CM0CODIGO},${usuario.AEMPRESA[0].CM0CODFIL}`);
              localStorage.setItem("CUSRID", usuario.CUSRID);
              localStorage.setItem("CUSUARIOPORTALCODIGO", usuario.CUSRID);
              localStorage.setItem("CUSUARIOPORTALNOME", usuario.CUSRNOME);
              localStorage.setItem("portal", "protheus");
              this.poStorageService.get("redirectUrl").then((url) => this.router.navigateByUrl(url));
            }
          },
          error: () => {
            this.loading = false;
            this.passwordErrors = ["Senha e/ou usu\xE1rio inv\xE1lido, verifique e tente novamente."];
          }
        });
      },
      error: () => {
        this.loading = false;
        this.passwordErrors = ["Senha e/ou usu\xE1rio inv\xE1lido, verifique e tente novamente."];
      }
    });
  }
  loginChange() {
    if (this.passwordErrors.length) {
      this.passwordErrors = [];
      this.loginErrors = [];
    }
  }
  static {
    this.\u0275fac = function LoginComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _LoginComponent)(\u0275\u0275directiveInject(AuthService), \u0275\u0275directiveInject(Router), \u0275\u0275directiveInject(PoStorageService), \u0275\u0275directiveInject(ActivatedRoute));
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _LoginComponent, selectors: [["app-login"]], standalone: false, decls: 4, vars: 5, consts: [[1, "logoDiv"], ["alt", "main-logo", "src", "./assets/image/logo.png", 1, "logo"], [3, "p-login-change", "p-password-change", "p-login-submit", "p-hide-remember-user", "p-product-name", "p-loading", "p-password-errors", "p-login-errors"]], template: function LoginComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 0);
        \u0275\u0275element(1, "img", 1);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(2, "div")(3, "po-page-login", 2);
        \u0275\u0275listener("p-login-change", function LoginComponent_Template_po_page_login_p_login_change_3_listener() {
          return ctx.loginChange();
        })("p-password-change", function LoginComponent_Template_po_page_login_p_password_change_3_listener() {
          return ctx.loginChange();
        })("p-login-submit", function LoginComponent_Template_po_page_login_p_login_submit_3_listener($event) {
          return ctx.checkLogin($event);
        });
        \u0275\u0275elementEnd()();
      }
      if (rf & 2) {
        \u0275\u0275advance(3);
        \u0275\u0275property("p-hide-remember-user", true)("p-product-name", ctx.pProductName)("p-loading", ctx.loading)("p-password-errors", ctx.passwordErrors)("p-login-errors", ctx.loginErrors);
      }
    }, dependencies: [PoPageLoginComponent], styles: ["\n\n.logoDiv[_ngcontent-%COMP%] {\n  background-color: #29A1D8;\n  top: 50px;\n  height: 80px;\n  width: 100%;\n  margin-top: 10px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n.logo[_ngcontent-%COMP%] {\n  background-color: #29A1D8;\n  margin-top: 10px;\n  align-content: center;\n}"] });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(LoginComponent, [{
    type: Component,
    args: [{ selector: "app-login", standalone: false, template: '\r\n  <div class="logoDiv">\r\n    <img alt="main-logo" class="logo" src="./assets/image/logo.png">\r\n  </div>\r\n  <div>\r\n  <po-page-login\r\n\r\n      [p-hide-remember-user]="true"\r\n      [p-product-name]="pProductName"\r\n      [p-loading]="loading"\r\n      [p-password-errors]="passwordErrors"\r\n      [p-login-errors]="loginErrors"\r\n      (p-login-change)="loginChange()"\r\n      (p-password-change)="loginChange()"\r\n      (p-login-submit)="checkLogin($event)"\r\n    >\r\n    </po-page-login>\r\n  </div>\r\n', styles: ["/* src/app/login/login.component.css */\n.logoDiv {\n  background-color: #29A1D8;\n  top: 50px;\n  height: 80px;\n  width: 100%;\n  margin-top: 10px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n.logo {\n  background-color: #29A1D8;\n  margin-top: 10px;\n  align-content: center;\n}\n"] }]
  }], () => [{ type: AuthService }, { type: Router }, { type: PoStorageService }, { type: ActivatedRoute }], null);
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(LoginComponent, { className: "LoginComponent", filePath: "src/app/login/login.component.ts", lineNumber: 13 });
})();

// src/app/auth/maisti.guard.ts
var MaistiGuard = class _MaistiGuard {
  constructor(poStorageService, authService, router) {
    this.poStorageService = poStorageService;
    this.authService = authService;
    this.router = router;
  }
  canActivate(route, state) {
    const url = state.url;
    let permissao = "";
    if (route.children && route.children.length) {
      permissao = route.children[0].data.permissao;
    } else {
      permissao = route.data.permissao;
    }
    return this.checkAcess(url, route.queryParams, permissao).then((value) => {
      return value;
    });
  }
  // @ts-ignore
  checkAcess(url, params, permissao) {
    return __async(this, null, function* () {
      let urlLogin = "/login";
      let tipoUsuario = localStorage.getItem("tipoUsuario");
      if (tipoUsuario === "funcionario" || url === "/login-rh") {
        urlLogin = "/login-rh";
      } else if (tipoUsuario === "fornecedor" || url === "/login-fornecedor") {
        urlLogin = "/login-fornecedor";
      }
      return new Promise((resolve, reject) => {
        this.poStorageService.get("usuario").then((usuario) => {
          if (usuario) {
            const tokenJson = localStorage.getItem("token");
            if (tokenJson) {
              const token = JSON.parse(tokenJson);
              const diffTime = Math.abs(token.last_token_refresh - (/* @__PURE__ */ new Date()).getTime() / 1e3);
              if (diffTime > token.expires_in - 600) {
                this.authService.refreshToken(token.refresh_token).subscribe({
                  next: (newToken) => {
                    localStorage.setItem("token", JSON.stringify(__spreadProps(__spreadValues({}, newToken), { last_token_refresh: (/* @__PURE__ */ new Date()).getTime() / 1e3 })));
                  },
                  error: () => {
                    this.reloadGoToLogin(url, urlLogin);
                    resolve(false);
                  }
                });
              }
              if (permissao && permissao.length) {
                const aPermissao = usuario.APRIVILEGIO.filter((item) => permissao.includes(item.CCODIGO));
                if (aPermissao && aPermissao.length) {
                  resolve(true);
                } else {
                  this.router.navigateByUrl(urlLogin);
                  resolve(false);
                }
              } else {
                resolve(true);
              }
            } else {
              this.reloadGoToLogin(url, urlLogin);
              resolve(false);
            }
          } else {
            this.reloadGoToLogin(url, urlLogin);
            resolve(false);
          }
        }).catch(() => {
          this.reloadGoToLogin(url, urlLogin);
          resolve(false);
        });
      });
    });
  }
  reloadGoToLogin(url, urlLogin) {
    localStorage.clear();
    this.poStorageService.clear();
    this.poStorageService.set("redirectUrl", url);
    this.router.navigateByUrl(urlLogin);
  }
  static {
    this.\u0275fac = function MaistiGuard_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _MaistiGuard)(\u0275\u0275inject(PoStorageService), \u0275\u0275inject(AuthService), \u0275\u0275inject(Router));
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({ token: _MaistiGuard, factory: _MaistiGuard.\u0275fac, providedIn: "root" });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(MaistiGuard, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [{ type: PoStorageService }, { type: AuthService }, { type: Router }], null);
})();

// node_modules/@angular/animations/fesm2022/util-D9FfmVnv.mjs
var LINE_START = "\n - ";
function invalidTimingValue(exp) {
  return new RuntimeError(3e3, ngDevMode && `The provided timing value "${exp}" is invalid.`);
}
function negativeStepValue() {
  return new RuntimeError(3100, ngDevMode && "Duration values below 0 are not allowed for this animation step.");
}
function negativeDelayValue() {
  return new RuntimeError(3101, ngDevMode && "Delay values below 0 are not allowed for this animation step.");
}
function invalidStyleParams(varName) {
  return new RuntimeError(3001, ngDevMode && `Unable to resolve the local animation param ${varName} in the given list of values`);
}
function invalidParamValue(varName) {
  return new RuntimeError(3003, ngDevMode && `Please provide a value for the animation param ${varName}`);
}
function invalidNodeType(nodeType) {
  return new RuntimeError(3004, ngDevMode && `Unable to resolve animation metadata node #${nodeType}`);
}
function invalidCssUnitValue(userProvidedProperty, value) {
  return new RuntimeError(3005, ngDevMode && `Please provide a CSS unit value for ${userProvidedProperty}:${value}`);
}
function invalidTrigger() {
  return new RuntimeError(3006, ngDevMode && "animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))");
}
function invalidDefinition() {
  return new RuntimeError(3007, ngDevMode && "only state() and transition() definitions can sit inside of a trigger()");
}
function invalidState(metadataName, missingSubs) {
  return new RuntimeError(3008, ngDevMode && `state("${metadataName}", ...) must define default values for all the following style substitutions: ${missingSubs.join(", ")}`);
}
function invalidStyleValue(value) {
  return new RuntimeError(3002, ngDevMode && `The provided style string value ${value} is not allowed.`);
}
function invalidParallelAnimation(prop, firstStart, firstEnd, secondStart, secondEnd) {
  return new RuntimeError(3010, ngDevMode && `The CSS property "${prop}" that exists between the times of "${firstStart}ms" and "${firstEnd}ms" is also being animated in a parallel animation between the times of "${secondStart}ms" and "${secondEnd}ms"`);
}
function invalidKeyframes() {
  return new RuntimeError(3011, ngDevMode && `keyframes() must be placed inside of a call to animate()`);
}
function invalidOffset() {
  return new RuntimeError(3012, ngDevMode && `Please ensure that all keyframe offsets are between 0 and 1`);
}
function keyframeOffsetsOutOfOrder() {
  return new RuntimeError(3200, ngDevMode && `Please ensure that all keyframe offsets are in order`);
}
function keyframesMissingOffsets() {
  return new RuntimeError(3202, ngDevMode && `Not all style() steps within the declared keyframes() contain offsets`);
}
function invalidStagger() {
  return new RuntimeError(3013, ngDevMode && `stagger() can only be used inside of query()`);
}
function invalidQuery(selector) {
  return new RuntimeError(3014, ngDevMode && `\`query("${selector}")\` returned zero elements. (Use \`query("${selector}", { optional: true })\` if you wish to allow this.)`);
}
function invalidExpression(expr) {
  return new RuntimeError(3015, ngDevMode && `The provided transition expression "${expr}" is not supported`);
}
function invalidTransitionAlias(alias) {
  return new RuntimeError(3016, ngDevMode && `The transition alias value "${alias}" is not supported`);
}
function triggerBuildFailed(name, errors) {
  return new RuntimeError(3404, ngDevMode && `The animation trigger "${name}" has failed to build due to the following errors:
 - ${errors.map((err) => err.message).join("\n - ")}`);
}
function animationFailed(errors) {
  return new RuntimeError(3502, ngDevMode && `Unable to animate due to the following errors:${LINE_START}${errors.map((err) => err.message).join(LINE_START)}`);
}
function registerFailed(errors) {
  return new RuntimeError(3503, ngDevMode && `Unable to build the animation due to the following errors: ${errors.map((err) => err.message).join("\n")}`);
}
function missingOrDestroyedAnimation() {
  return new RuntimeError(3300, ngDevMode && "The requested animation doesn't exist or has already been destroyed");
}
function createAnimationFailed(errors) {
  return new RuntimeError(3504, ngDevMode && `Unable to create the animation due to the following errors:${errors.map((err) => err.message).join("\n")}`);
}
function missingPlayer(id) {
  return new RuntimeError(3301, ngDevMode && `Unable to find the timeline player referenced by ${id}`);
}
function missingTrigger(phase, name) {
  return new RuntimeError(3302, ngDevMode && `Unable to listen on the animation trigger event "${phase}" because the animation trigger "${name}" doesn't exist!`);
}
function missingEvent(name) {
  return new RuntimeError(3303, ngDevMode && `Unable to listen on the animation trigger "${name}" because the provided event is undefined!`);
}
function unsupportedTriggerEvent(phase, name) {
  return new RuntimeError(3400, ngDevMode && `The provided animation trigger event "${phase}" for the animation trigger "${name}" is not supported!`);
}
function unregisteredTrigger(name) {
  return new RuntimeError(3401, ngDevMode && `The provided animation trigger "${name}" has not been registered!`);
}
function triggerTransitionsFailed(errors) {
  return new RuntimeError(3402, ngDevMode && `Unable to process animations due to the following failed trigger transitions
 ${errors.map((err) => err.message).join("\n")}`);
}
function transitionFailed(name, errors) {
  return new RuntimeError(3505, ngDevMode && `@${name} has failed due to:
 ${errors.map((err) => err.message).join("\n- ")}`);
}
var ANIMATABLE_PROP_SET = /* @__PURE__ */ new Set(["-moz-outline-radius", "-moz-outline-radius-bottomleft", "-moz-outline-radius-bottomright", "-moz-outline-radius-topleft", "-moz-outline-radius-topright", "-ms-grid-columns", "-ms-grid-rows", "-webkit-line-clamp", "-webkit-text-fill-color", "-webkit-text-stroke", "-webkit-text-stroke-color", "accent-color", "all", "backdrop-filter", "background", "background-color", "background-position", "background-size", "block-size", "border", "border-block-end", "border-block-end-color", "border-block-end-width", "border-block-start", "border-block-start-color", "border-block-start-width", "border-bottom", "border-bottom-color", "border-bottom-left-radius", "border-bottom-right-radius", "border-bottom-width", "border-color", "border-end-end-radius", "border-end-start-radius", "border-image-outset", "border-image-slice", "border-image-width", "border-inline-end", "border-inline-end-color", "border-inline-end-width", "border-inline-start", "border-inline-start-color", "border-inline-start-width", "border-left", "border-left-color", "border-left-width", "border-radius", "border-right", "border-right-color", "border-right-width", "border-start-end-radius", "border-start-start-radius", "border-top", "border-top-color", "border-top-left-radius", "border-top-right-radius", "border-top-width", "border-width", "bottom", "box-shadow", "caret-color", "clip", "clip-path", "color", "column-count", "column-gap", "column-rule", "column-rule-color", "column-rule-width", "column-width", "columns", "filter", "flex", "flex-basis", "flex-grow", "flex-shrink", "font", "font-size", "font-size-adjust", "font-stretch", "font-variation-settings", "font-weight", "gap", "grid-column-gap", "grid-gap", "grid-row-gap", "grid-template-columns", "grid-template-rows", "height", "inline-size", "input-security", "inset", "inset-block", "inset-block-end", "inset-block-start", "inset-inline", "inset-inline-end", "inset-inline-start", "left", "letter-spacing", "line-clamp", "line-height", "margin", "margin-block-end", "margin-block-start", "margin-bottom", "margin-inline-end", "margin-inline-start", "margin-left", "margin-right", "margin-top", "mask", "mask-border", "mask-position", "mask-size", "max-block-size", "max-height", "max-inline-size", "max-lines", "max-width", "min-block-size", "min-height", "min-inline-size", "min-width", "object-position", "offset", "offset-anchor", "offset-distance", "offset-path", "offset-position", "offset-rotate", "opacity", "order", "outline", "outline-color", "outline-offset", "outline-width", "padding", "padding-block-end", "padding-block-start", "padding-bottom", "padding-inline-end", "padding-inline-start", "padding-left", "padding-right", "padding-top", "perspective", "perspective-origin", "right", "rotate", "row-gap", "scale", "scroll-margin", "scroll-margin-block", "scroll-margin-block-end", "scroll-margin-block-start", "scroll-margin-bottom", "scroll-margin-inline", "scroll-margin-inline-end", "scroll-margin-inline-start", "scroll-margin-left", "scroll-margin-right", "scroll-margin-top", "scroll-padding", "scroll-padding-block", "scroll-padding-block-end", "scroll-padding-block-start", "scroll-padding-bottom", "scroll-padding-inline", "scroll-padding-inline-end", "scroll-padding-inline-start", "scroll-padding-left", "scroll-padding-right", "scroll-padding-top", "scroll-snap-coordinate", "scroll-snap-destination", "scrollbar-color", "shape-image-threshold", "shape-margin", "shape-outside", "tab-size", "text-decoration", "text-decoration-color", "text-decoration-thickness", "text-emphasis", "text-emphasis-color", "text-indent", "text-shadow", "text-underline-offset", "top", "transform", "transform-origin", "translate", "vertical-align", "visibility", "width", "word-spacing", "z-index", "zoom"]);
function optimizeGroupPlayer(players) {
  switch (players.length) {
    case 0:
      return new NoopAnimationPlayer();
    case 1:
      return players[0];
    default:
      return new AnimationGroupPlayer(players);
  }
}
function normalizeKeyframes$1(normalizer, keyframes, preStyles = /* @__PURE__ */ new Map(), postStyles = /* @__PURE__ */ new Map()) {
  const errors = [];
  const normalizedKeyframes = [];
  let previousOffset = -1;
  let previousKeyframe = null;
  keyframes.forEach((kf) => {
    const offset = kf.get("offset");
    const isSameOffset = offset == previousOffset;
    const normalizedKeyframe = isSameOffset && previousKeyframe || /* @__PURE__ */ new Map();
    kf.forEach((val, prop) => {
      let normalizedProp = prop;
      let normalizedValue = val;
      if (prop !== "offset") {
        normalizedProp = normalizer.normalizePropertyName(normalizedProp, errors);
        switch (normalizedValue) {
          case \u0275PRE_STYLE:
            normalizedValue = preStyles.get(prop);
            break;
          case AUTO_STYLE:
            normalizedValue = postStyles.get(prop);
            break;
          default:
            normalizedValue = normalizer.normalizeStyleValue(prop, normalizedProp, normalizedValue, errors);
            break;
        }
      }
      normalizedKeyframe.set(normalizedProp, normalizedValue);
    });
    if (!isSameOffset) {
      normalizedKeyframes.push(normalizedKeyframe);
    }
    previousKeyframe = normalizedKeyframe;
    previousOffset = offset;
  });
  if (errors.length) {
    throw animationFailed(errors);
  }
  return normalizedKeyframes;
}
function listenOnPlayer(player, eventName, event, callback) {
  switch (eventName) {
    case "start":
      player.onStart(() => callback(event && copyAnimationEvent(event, "start", player)));
      break;
    case "done":
      player.onDone(() => callback(event && copyAnimationEvent(event, "done", player)));
      break;
    case "destroy":
      player.onDestroy(() => callback(event && copyAnimationEvent(event, "destroy", player)));
      break;
  }
}
function copyAnimationEvent(e, phaseName, player) {
  const totalTime = player.totalTime;
  const disabled = player.disabled ? true : false;
  const event = makeAnimationEvent(e.element, e.triggerName, e.fromState, e.toState, phaseName || e.phaseName, totalTime == void 0 ? e.totalTime : totalTime, disabled);
  const data = e["_data"];
  if (data != null) {
    event["_data"] = data;
  }
  return event;
}
function makeAnimationEvent(element, triggerName, fromState, toState, phaseName = "", totalTime = 0, disabled) {
  return {
    element,
    triggerName,
    fromState,
    toState,
    phaseName,
    totalTime,
    disabled: !!disabled
  };
}
function getOrSetDefaultValue(map2, key, defaultValue) {
  let value = map2.get(key);
  if (!value) {
    map2.set(key, value = defaultValue);
  }
  return value;
}
function parseTimelineCommand(command) {
  const separatorPos = command.indexOf(":");
  const id = command.substring(1, separatorPos);
  const action = command.slice(separatorPos + 1);
  return [id, action];
}
var documentElement = /* @__PURE__ */ (() => typeof document === "undefined" ? null : document.documentElement)();
function getParentElement(element) {
  const parent = element.parentNode || element.host || null;
  if (parent === documentElement) {
    return null;
  }
  return parent;
}
function containsVendorPrefix(prop) {
  return prop.substring(1, 6) == "ebkit";
}
var _CACHED_BODY = null;
var _IS_WEBKIT = false;
function validateStyleProperty(prop) {
  if (!_CACHED_BODY) {
    _CACHED_BODY = getBodyNode() || {};
    _IS_WEBKIT = _CACHED_BODY.style ? "WebkitAppearance" in _CACHED_BODY.style : false;
  }
  let result = true;
  if (_CACHED_BODY.style && !containsVendorPrefix(prop)) {
    result = prop in _CACHED_BODY.style;
    if (!result && _IS_WEBKIT) {
      const camelProp = "Webkit" + prop.charAt(0).toUpperCase() + prop.slice(1);
      result = camelProp in _CACHED_BODY.style;
    }
  }
  return result;
}
function validateWebAnimatableStyleProperty(prop) {
  return ANIMATABLE_PROP_SET.has(prop);
}
function getBodyNode() {
  if (typeof document != "undefined") {
    return document.body;
  }
  return null;
}
function containsElement(elm1, elm2) {
  while (elm2) {
    if (elm2 === elm1) {
      return true;
    }
    elm2 = getParentElement(elm2);
  }
  return false;
}
function invokeQuery(element, selector, multi) {
  if (multi) {
    return Array.from(element.querySelectorAll(selector));
  }
  const elem = element.querySelector(selector);
  return elem ? [elem] : [];
}
var ONE_SECOND = 1e3;
var SUBSTITUTION_EXPR_START = "{{";
var SUBSTITUTION_EXPR_END = "}}";
var ENTER_CLASSNAME = "ng-enter";
var LEAVE_CLASSNAME = "ng-leave";
var NG_TRIGGER_CLASSNAME = "ng-trigger";
var NG_TRIGGER_SELECTOR = ".ng-trigger";
var NG_ANIMATING_CLASSNAME = "ng-animating";
var NG_ANIMATING_SELECTOR = ".ng-animating";
function resolveTimingValue(value) {
  if (typeof value == "number") return value;
  const matches = value.match(/^(-?[\.\d]+)(m?s)/);
  if (!matches || matches.length < 2) return 0;
  return _convertTimeValueToMS(parseFloat(matches[1]), matches[2]);
}
function _convertTimeValueToMS(value, unit) {
  switch (unit) {
    case "s":
      return value * ONE_SECOND;
    default:
      return value;
  }
}
function resolveTiming(timings, errors, allowNegativeValues) {
  return timings.hasOwnProperty("duration") ? timings : parseTimeExpression(timings, errors, allowNegativeValues);
}
function parseTimeExpression(exp, errors, allowNegativeValues) {
  const regex = /^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i;
  let duration;
  let delay = 0;
  let easing = "";
  if (typeof exp === "string") {
    const matches = exp.match(regex);
    if (matches === null) {
      errors.push(invalidTimingValue(exp));
      return {
        duration: 0,
        delay: 0,
        easing: ""
      };
    }
    duration = _convertTimeValueToMS(parseFloat(matches[1]), matches[2]);
    const delayMatch = matches[3];
    if (delayMatch != null) {
      delay = _convertTimeValueToMS(parseFloat(delayMatch), matches[4]);
    }
    const easingVal = matches[5];
    if (easingVal) {
      easing = easingVal;
    }
  } else {
    duration = exp;
  }
  if (!allowNegativeValues) {
    let containsErrors = false;
    let startIndex = errors.length;
    if (duration < 0) {
      errors.push(negativeStepValue());
      containsErrors = true;
    }
    if (delay < 0) {
      errors.push(negativeDelayValue());
      containsErrors = true;
    }
    if (containsErrors) {
      errors.splice(startIndex, 0, invalidTimingValue(exp));
    }
  }
  return {
    duration,
    delay,
    easing
  };
}
function normalizeKeyframes(keyframes) {
  if (!keyframes.length) {
    return [];
  }
  if (keyframes[0] instanceof Map) {
    return keyframes;
  }
  return keyframes.map((kf) => new Map(Object.entries(kf)));
}
function setStyles(element, styles, formerStyles) {
  styles.forEach((val, prop) => {
    const camelProp = dashCaseToCamelCase(prop);
    if (formerStyles && !formerStyles.has(prop)) {
      formerStyles.set(prop, element.style[camelProp]);
    }
    element.style[camelProp] = val;
  });
}
function eraseStyles(element, styles) {
  styles.forEach((_, prop) => {
    const camelProp = dashCaseToCamelCase(prop);
    element.style[camelProp] = "";
  });
}
function normalizeAnimationEntry(steps) {
  if (Array.isArray(steps)) {
    if (steps.length == 1) return steps[0];
    return sequence(steps);
  }
  return steps;
}
function validateStyleParams(value, options, errors) {
  const params = options.params || {};
  const matches = extractStyleParams(value);
  if (matches.length) {
    matches.forEach((varName) => {
      if (!params.hasOwnProperty(varName)) {
        errors.push(invalidStyleParams(varName));
      }
    });
  }
}
var PARAM_REGEX = /* @__PURE__ */ new RegExp(`${SUBSTITUTION_EXPR_START}\\s*(.+?)\\s*${SUBSTITUTION_EXPR_END}`, "g");
function extractStyleParams(value) {
  let params = [];
  if (typeof value === "string") {
    let match;
    while (match = PARAM_REGEX.exec(value)) {
      params.push(match[1]);
    }
    PARAM_REGEX.lastIndex = 0;
  }
  return params;
}
function interpolateParams(value, params, errors) {
  const original = `${value}`;
  const str = original.replace(PARAM_REGEX, (_, varName) => {
    let localVal = params[varName];
    if (localVal == null) {
      errors.push(invalidParamValue(varName));
      localVal = "";
    }
    return localVal.toString();
  });
  return str == original ? value : str;
}
var DASH_CASE_REGEXP = /-+([a-z0-9])/g;
function dashCaseToCamelCase(input) {
  return input.replace(DASH_CASE_REGEXP, (...m) => m[1].toUpperCase());
}
function camelCaseToDashCase(input) {
  return input.replace(/([a-z])([A-Z])/g, "$1-$2").toLowerCase();
}
function allowPreviousPlayerStylesMerge(duration, delay) {
  return duration === 0 || delay === 0;
}
function balancePreviousStylesIntoKeyframes(element, keyframes, previousStyles) {
  if (previousStyles.size && keyframes.length) {
    let startingKeyframe = keyframes[0];
    let missingStyleProps = [];
    previousStyles.forEach((val, prop) => {
      if (!startingKeyframe.has(prop)) {
        missingStyleProps.push(prop);
      }
      startingKeyframe.set(prop, val);
    });
    if (missingStyleProps.length) {
      for (let i = 1; i < keyframes.length; i++) {
        let kf = keyframes[i];
        missingStyleProps.forEach((prop) => kf.set(prop, computeStyle(element, prop)));
      }
    }
  }
  return keyframes;
}
function visitDslNode(visitor, node, context) {
  switch (node.type) {
    case AnimationMetadataType.Trigger:
      return visitor.visitTrigger(node, context);
    case AnimationMetadataType.State:
      return visitor.visitState(node, context);
    case AnimationMetadataType.Transition:
      return visitor.visitTransition(node, context);
    case AnimationMetadataType.Sequence:
      return visitor.visitSequence(node, context);
    case AnimationMetadataType.Group:
      return visitor.visitGroup(node, context);
    case AnimationMetadataType.Animate:
      return visitor.visitAnimate(node, context);
    case AnimationMetadataType.Keyframes:
      return visitor.visitKeyframes(node, context);
    case AnimationMetadataType.Style:
      return visitor.visitStyle(node, context);
    case AnimationMetadataType.Reference:
      return visitor.visitReference(node, context);
    case AnimationMetadataType.AnimateChild:
      return visitor.visitAnimateChild(node, context);
    case AnimationMetadataType.AnimateRef:
      return visitor.visitAnimateRef(node, context);
    case AnimationMetadataType.Query:
      return visitor.visitQuery(node, context);
    case AnimationMetadataType.Stagger:
      return visitor.visitStagger(node, context);
    default:
      throw invalidNodeType(node.type);
  }
}
function computeStyle(element, prop) {
  return window.getComputedStyle(element)[prop];
}

// node_modules/@angular/animations/fesm2022/browser.mjs
var NoopAnimationDriver = class _NoopAnimationDriver {
  /**
   * @returns Whether `prop` is a valid CSS property
   */
  validateStyleProperty(prop) {
    return validateStyleProperty(prop);
  }
  /**
   *
   * @returns Whether elm1 contains elm2.
   */
  containsElement(elm1, elm2) {
    return containsElement(elm1, elm2);
  }
  /**
   * @returns Rhe parent of the given element or `null` if the element is the `document`
   */
  getParentElement(element) {
    return getParentElement(element);
  }
  /**
   * @returns The result of the query selector on the element. The array will contain up to 1 item
   *     if `multi` is  `false`.
   */
  query(element, selector, multi) {
    return invokeQuery(element, selector, multi);
  }
  /**
   * @returns The `defaultValue` or empty string
   */
  computeStyle(element, prop, defaultValue) {
    return defaultValue || "";
  }
  /**
   * @returns An `NoopAnimationPlayer`
   */
  animate(element, keyframes, duration, delay, easing, previousPlayers = [], scrubberAccessRequested) {
    return new NoopAnimationPlayer(duration, delay);
  }
  static \u0275fac = function NoopAnimationDriver_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _NoopAnimationDriver)();
  };
  static \u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
    token: _NoopAnimationDriver,
    factory: _NoopAnimationDriver.\u0275fac
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(NoopAnimationDriver, [{
    type: Injectable
  }], null, null);
})();
var AnimationDriver = class {
  /**
   * @deprecated Use the NoopAnimationDriver class.
   */
  static NOOP = new NoopAnimationDriver();
};
var AnimationStyleNormalizer = class {
};
var DIMENSIONAL_PROP_SET = /* @__PURE__ */ new Set(["width", "height", "minWidth", "minHeight", "maxWidth", "maxHeight", "left", "top", "bottom", "right", "fontSize", "outlineWidth", "outlineOffset", "paddingTop", "paddingLeft", "paddingBottom", "paddingRight", "marginTop", "marginLeft", "marginBottom", "marginRight", "borderRadius", "borderWidth", "borderTopWidth", "borderLeftWidth", "borderRightWidth", "borderBottomWidth", "textIndent", "perspective"]);
var WebAnimationsStyleNormalizer = class extends AnimationStyleNormalizer {
  normalizePropertyName(propertyName, errors) {
    return dashCaseToCamelCase(propertyName);
  }
  normalizeStyleValue(userProvidedProperty, normalizedProperty, value, errors) {
    let unit = "";
    const strVal = value.toString().trim();
    if (DIMENSIONAL_PROP_SET.has(normalizedProperty) && value !== 0 && value !== "0") {
      if (typeof value === "number") {
        unit = "px";
      } else {
        const valAndSuffixMatch = value.match(/^[+-]?[\d\.]+([a-z]*)$/);
        if (valAndSuffixMatch && valAndSuffixMatch[1].length == 0) {
          errors.push(invalidCssUnitValue(userProvidedProperty, value));
        }
      }
    }
    return strVal + unit;
  }
};
function createListOfWarnings(warnings) {
  const LINE_START2 = "\n - ";
  return `${LINE_START2}${warnings.filter(Boolean).map((warning) => warning).join(LINE_START2)}`;
}
function warnTriggerBuild(name, warnings) {
  console.warn(`The animation trigger "${name}" has built with the following warnings:${createListOfWarnings(warnings)}`);
}
function warnRegister(warnings) {
  console.warn(`Animation built with the following warnings:${createListOfWarnings(warnings)}`);
}
function pushUnrecognizedPropertiesWarning(warnings, props) {
  if (props.length) {
    warnings.push(`The following provided properties are not recognized: ${props.join(", ")}`);
  }
}
var ANY_STATE = "*";
function parseTransitionExpr(transitionValue, errors) {
  const expressions = [];
  if (typeof transitionValue == "string") {
    transitionValue.split(/\s*,\s*/).forEach((str) => parseInnerTransitionStr(str, expressions, errors));
  } else {
    expressions.push(transitionValue);
  }
  return expressions;
}
function parseInnerTransitionStr(eventStr, expressions, errors) {
  if (eventStr[0] == ":") {
    const result = parseAnimationAlias(eventStr, errors);
    if (typeof result == "function") {
      expressions.push(result);
      return;
    }
    eventStr = result;
  }
  const match = eventStr.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);
  if (match == null || match.length < 4) {
    errors.push(invalidExpression(eventStr));
    return expressions;
  }
  const fromState = match[1];
  const separator = match[2];
  const toState = match[3];
  expressions.push(makeLambdaFromStates(fromState, toState));
  const isFullAnyStateExpr = fromState == ANY_STATE && toState == ANY_STATE;
  if (separator[0] == "<" && !isFullAnyStateExpr) {
    expressions.push(makeLambdaFromStates(toState, fromState));
  }
  return;
}
function parseAnimationAlias(alias, errors) {
  switch (alias) {
    case ":enter":
      return "void => *";
    case ":leave":
      return "* => void";
    case ":increment":
      return (fromState, toState) => parseFloat(toState) > parseFloat(fromState);
    case ":decrement":
      return (fromState, toState) => parseFloat(toState) < parseFloat(fromState);
    default:
      errors.push(invalidTransitionAlias(alias));
      return "* => *";
  }
}
var TRUE_BOOLEAN_VALUES = /* @__PURE__ */ new Set(["true", "1"]);
var FALSE_BOOLEAN_VALUES = /* @__PURE__ */ new Set(["false", "0"]);
function makeLambdaFromStates(lhs, rhs) {
  const LHS_MATCH_BOOLEAN = TRUE_BOOLEAN_VALUES.has(lhs) || FALSE_BOOLEAN_VALUES.has(lhs);
  const RHS_MATCH_BOOLEAN = TRUE_BOOLEAN_VALUES.has(rhs) || FALSE_BOOLEAN_VALUES.has(rhs);
  return (fromState, toState) => {
    let lhsMatch = lhs == ANY_STATE || lhs == fromState;
    let rhsMatch = rhs == ANY_STATE || rhs == toState;
    if (!lhsMatch && LHS_MATCH_BOOLEAN && typeof fromState === "boolean") {
      lhsMatch = fromState ? TRUE_BOOLEAN_VALUES.has(lhs) : FALSE_BOOLEAN_VALUES.has(lhs);
    }
    if (!rhsMatch && RHS_MATCH_BOOLEAN && typeof toState === "boolean") {
      rhsMatch = toState ? TRUE_BOOLEAN_VALUES.has(rhs) : FALSE_BOOLEAN_VALUES.has(rhs);
    }
    return lhsMatch && rhsMatch;
  };
}
var SELF_TOKEN = ":self";
var SELF_TOKEN_REGEX = /* @__PURE__ */ new RegExp(`s*${SELF_TOKEN}s*,?`, "g");
function buildAnimationAst(driver, metadata, errors, warnings) {
  return new AnimationAstBuilderVisitor(driver).build(metadata, errors, warnings);
}
var ROOT_SELECTOR = "";
var AnimationAstBuilderVisitor = class {
  _driver;
  constructor(_driver) {
    this._driver = _driver;
  }
  build(metadata, errors, warnings) {
    const context = new AnimationAstBuilderContext(errors);
    this._resetContextStyleTimingState(context);
    const ast = visitDslNode(this, normalizeAnimationEntry(metadata), context);
    if (typeof ngDevMode === "undefined" || ngDevMode) {
      if (context.unsupportedCSSPropertiesFound.size) {
        pushUnrecognizedPropertiesWarning(warnings, [...context.unsupportedCSSPropertiesFound.keys()]);
      }
    }
    return ast;
  }
  _resetContextStyleTimingState(context) {
    context.currentQuerySelector = ROOT_SELECTOR;
    context.collectedStyles = /* @__PURE__ */ new Map();
    context.collectedStyles.set(ROOT_SELECTOR, /* @__PURE__ */ new Map());
    context.currentTime = 0;
  }
  visitTrigger(metadata, context) {
    let queryCount = context.queryCount = 0;
    let depCount = context.depCount = 0;
    const states = [];
    const transitions = [];
    if (metadata.name.charAt(0) == "@") {
      context.errors.push(invalidTrigger());
    }
    metadata.definitions.forEach((def) => {
      this._resetContextStyleTimingState(context);
      if (def.type == AnimationMetadataType.State) {
        const stateDef = def;
        const name = stateDef.name;
        name.toString().split(/\s*,\s*/).forEach((n) => {
          stateDef.name = n;
          states.push(this.visitState(stateDef, context));
        });
        stateDef.name = name;
      } else if (def.type == AnimationMetadataType.Transition) {
        const transition = this.visitTransition(def, context);
        queryCount += transition.queryCount;
        depCount += transition.depCount;
        transitions.push(transition);
      } else {
        context.errors.push(invalidDefinition());
      }
    });
    return {
      type: AnimationMetadataType.Trigger,
      name: metadata.name,
      states,
      transitions,
      queryCount,
      depCount,
      options: null
    };
  }
  visitState(metadata, context) {
    const styleAst = this.visitStyle(metadata.styles, context);
    const astParams = metadata.options && metadata.options.params || null;
    if (styleAst.containsDynamicStyles) {
      const missingSubs = /* @__PURE__ */ new Set();
      const params = astParams || {};
      styleAst.styles.forEach((style2) => {
        if (style2 instanceof Map) {
          style2.forEach((value) => {
            extractStyleParams(value).forEach((sub) => {
              if (!params.hasOwnProperty(sub)) {
                missingSubs.add(sub);
              }
            });
          });
        }
      });
      if (missingSubs.size) {
        context.errors.push(invalidState(metadata.name, [...missingSubs.values()]));
      }
    }
    return {
      type: AnimationMetadataType.State,
      name: metadata.name,
      style: styleAst,
      options: astParams ? {
        params: astParams
      } : null
    };
  }
  visitTransition(metadata, context) {
    context.queryCount = 0;
    context.depCount = 0;
    const animation = visitDslNode(this, normalizeAnimationEntry(metadata.animation), context);
    const matchers = parseTransitionExpr(metadata.expr, context.errors);
    return {
      type: AnimationMetadataType.Transition,
      matchers,
      animation,
      queryCount: context.queryCount,
      depCount: context.depCount,
      options: normalizeAnimationOptions(metadata.options)
    };
  }
  visitSequence(metadata, context) {
    return {
      type: AnimationMetadataType.Sequence,
      steps: metadata.steps.map((s) => visitDslNode(this, s, context)),
      options: normalizeAnimationOptions(metadata.options)
    };
  }
  visitGroup(metadata, context) {
    const currentTime = context.currentTime;
    let furthestTime = 0;
    const steps = metadata.steps.map((step) => {
      context.currentTime = currentTime;
      const innerAst = visitDslNode(this, step, context);
      furthestTime = Math.max(furthestTime, context.currentTime);
      return innerAst;
    });
    context.currentTime = furthestTime;
    return {
      type: AnimationMetadataType.Group,
      steps,
      options: normalizeAnimationOptions(metadata.options)
    };
  }
  visitAnimate(metadata, context) {
    const timingAst = constructTimingAst(metadata.timings, context.errors);
    context.currentAnimateTimings = timingAst;
    let styleAst;
    let styleMetadata = metadata.styles ? metadata.styles : style({});
    if (styleMetadata.type == AnimationMetadataType.Keyframes) {
      styleAst = this.visitKeyframes(styleMetadata, context);
    } else {
      let styleMetadata2 = metadata.styles;
      let isEmpty = false;
      if (!styleMetadata2) {
        isEmpty = true;
        const newStyleData = {};
        if (timingAst.easing) {
          newStyleData["easing"] = timingAst.easing;
        }
        styleMetadata2 = style(newStyleData);
      }
      context.currentTime += timingAst.duration + timingAst.delay;
      const _styleAst = this.visitStyle(styleMetadata2, context);
      _styleAst.isEmptyStep = isEmpty;
      styleAst = _styleAst;
    }
    context.currentAnimateTimings = null;
    return {
      type: AnimationMetadataType.Animate,
      timings: timingAst,
      style: styleAst,
      options: null
    };
  }
  visitStyle(metadata, context) {
    const ast = this._makeStyleAst(metadata, context);
    this._validateStyleAst(ast, context);
    return ast;
  }
  _makeStyleAst(metadata, context) {
    const styles = [];
    const metadataStyles = Array.isArray(metadata.styles) ? metadata.styles : [metadata.styles];
    for (let styleTuple of metadataStyles) {
      if (typeof styleTuple === "string") {
        if (styleTuple === AUTO_STYLE) {
          styles.push(styleTuple);
        } else {
          context.errors.push(invalidStyleValue(styleTuple));
        }
      } else {
        styles.push(new Map(Object.entries(styleTuple)));
      }
    }
    let containsDynamicStyles = false;
    let collectedEasing = null;
    styles.forEach((styleData) => {
      if (styleData instanceof Map) {
        if (styleData.has("easing")) {
          collectedEasing = styleData.get("easing");
          styleData.delete("easing");
        }
        if (!containsDynamicStyles) {
          for (let value of styleData.values()) {
            if (value.toString().indexOf(SUBSTITUTION_EXPR_START) >= 0) {
              containsDynamicStyles = true;
              break;
            }
          }
        }
      }
    });
    return {
      type: AnimationMetadataType.Style,
      styles,
      easing: collectedEasing,
      offset: metadata.offset,
      containsDynamicStyles,
      options: null
    };
  }
  _validateStyleAst(ast, context) {
    const timings = context.currentAnimateTimings;
    let endTime = context.currentTime;
    let startTime = context.currentTime;
    if (timings && startTime > 0) {
      startTime -= timings.duration + timings.delay;
    }
    ast.styles.forEach((tuple) => {
      if (typeof tuple === "string") return;
      tuple.forEach((value, prop) => {
        if (typeof ngDevMode === "undefined" || ngDevMode) {
          if (!this._driver.validateStyleProperty(prop)) {
            tuple.delete(prop);
            context.unsupportedCSSPropertiesFound.add(prop);
            return;
          }
        }
        const collectedStyles = context.collectedStyles.get(context.currentQuerySelector);
        const collectedEntry = collectedStyles.get(prop);
        let updateCollectedStyle = true;
        if (collectedEntry) {
          if (startTime != endTime && startTime >= collectedEntry.startTime && endTime <= collectedEntry.endTime) {
            context.errors.push(invalidParallelAnimation(prop, collectedEntry.startTime, collectedEntry.endTime, startTime, endTime));
            updateCollectedStyle = false;
          }
          startTime = collectedEntry.startTime;
        }
        if (updateCollectedStyle) {
          collectedStyles.set(prop, {
            startTime,
            endTime
          });
        }
        if (context.options) {
          validateStyleParams(value, context.options, context.errors);
        }
      });
    });
  }
  visitKeyframes(metadata, context) {
    const ast = {
      type: AnimationMetadataType.Keyframes,
      styles: [],
      options: null
    };
    if (!context.currentAnimateTimings) {
      context.errors.push(invalidKeyframes());
      return ast;
    }
    const MAX_KEYFRAME_OFFSET = 1;
    let totalKeyframesWithOffsets = 0;
    const offsets = [];
    let offsetsOutOfOrder = false;
    let keyframesOutOfRange = false;
    let previousOffset = 0;
    const keyframes = metadata.steps.map((styles) => {
      const style2 = this._makeStyleAst(styles, context);
      let offsetVal = style2.offset != null ? style2.offset : consumeOffset(style2.styles);
      let offset = 0;
      if (offsetVal != null) {
        totalKeyframesWithOffsets++;
        offset = style2.offset = offsetVal;
      }
      keyframesOutOfRange = keyframesOutOfRange || offset < 0 || offset > 1;
      offsetsOutOfOrder = offsetsOutOfOrder || offset < previousOffset;
      previousOffset = offset;
      offsets.push(offset);
      return style2;
    });
    if (keyframesOutOfRange) {
      context.errors.push(invalidOffset());
    }
    if (offsetsOutOfOrder) {
      context.errors.push(keyframeOffsetsOutOfOrder());
    }
    const length = metadata.steps.length;
    let generatedOffset = 0;
    if (totalKeyframesWithOffsets > 0 && totalKeyframesWithOffsets < length) {
      context.errors.push(keyframesMissingOffsets());
    } else if (totalKeyframesWithOffsets == 0) {
      generatedOffset = MAX_KEYFRAME_OFFSET / (length - 1);
    }
    const limit = length - 1;
    const currentTime = context.currentTime;
    const currentAnimateTimings = context.currentAnimateTimings;
    const animateDuration = currentAnimateTimings.duration;
    keyframes.forEach((kf, i) => {
      const offset = generatedOffset > 0 ? i == limit ? 1 : generatedOffset * i : offsets[i];
      const durationUpToThisFrame = offset * animateDuration;
      context.currentTime = currentTime + currentAnimateTimings.delay + durationUpToThisFrame;
      currentAnimateTimings.duration = durationUpToThisFrame;
      this._validateStyleAst(kf, context);
      kf.offset = offset;
      ast.styles.push(kf);
    });
    return ast;
  }
  visitReference(metadata, context) {
    return {
      type: AnimationMetadataType.Reference,
      animation: visitDslNode(this, normalizeAnimationEntry(metadata.animation), context),
      options: normalizeAnimationOptions(metadata.options)
    };
  }
  visitAnimateChild(metadata, context) {
    context.depCount++;
    return {
      type: AnimationMetadataType.AnimateChild,
      options: normalizeAnimationOptions(metadata.options)
    };
  }
  visitAnimateRef(metadata, context) {
    return {
      type: AnimationMetadataType.AnimateRef,
      animation: this.visitReference(metadata.animation, context),
      options: normalizeAnimationOptions(metadata.options)
    };
  }
  visitQuery(metadata, context) {
    const parentSelector = context.currentQuerySelector;
    const options = metadata.options || {};
    context.queryCount++;
    context.currentQuery = metadata;
    const [selector, includeSelf] = normalizeSelector(metadata.selector);
    context.currentQuerySelector = parentSelector.length ? parentSelector + " " + selector : selector;
    getOrSetDefaultValue(context.collectedStyles, context.currentQuerySelector, /* @__PURE__ */ new Map());
    const animation = visitDslNode(this, normalizeAnimationEntry(metadata.animation), context);
    context.currentQuery = null;
    context.currentQuerySelector = parentSelector;
    return {
      type: AnimationMetadataType.Query,
      selector,
      limit: options.limit || 0,
      optional: !!options.optional,
      includeSelf,
      animation,
      originalSelector: metadata.selector,
      options: normalizeAnimationOptions(metadata.options)
    };
  }
  visitStagger(metadata, context) {
    if (!context.currentQuery) {
      context.errors.push(invalidStagger());
    }
    const timings = metadata.timings === "full" ? {
      duration: 0,
      delay: 0,
      easing: "full"
    } : resolveTiming(metadata.timings, context.errors, true);
    return {
      type: AnimationMetadataType.Stagger,
      animation: visitDslNode(this, normalizeAnimationEntry(metadata.animation), context),
      timings,
      options: null
    };
  }
};
function normalizeSelector(selector) {
  const hasAmpersand = selector.split(/\s*,\s*/).find((token) => token == SELF_TOKEN) ? true : false;
  if (hasAmpersand) {
    selector = selector.replace(SELF_TOKEN_REGEX, "");
  }
  selector = selector.replace(/@\*/g, NG_TRIGGER_SELECTOR).replace(/@\w+/g, (match) => NG_TRIGGER_SELECTOR + "-" + match.slice(1)).replace(/:animating/g, NG_ANIMATING_SELECTOR);
  return [selector, hasAmpersand];
}
function normalizeParams(obj) {
  return obj ? __spreadValues({}, obj) : null;
}
var AnimationAstBuilderContext = class {
  errors;
  queryCount = 0;
  depCount = 0;
  currentTransition = null;
  currentQuery = null;
  currentQuerySelector = null;
  currentAnimateTimings = null;
  currentTime = 0;
  collectedStyles = /* @__PURE__ */ new Map();
  options = null;
  unsupportedCSSPropertiesFound = /* @__PURE__ */ new Set();
  constructor(errors) {
    this.errors = errors;
  }
};
function consumeOffset(styles) {
  if (typeof styles == "string") return null;
  let offset = null;
  if (Array.isArray(styles)) {
    styles.forEach((styleTuple) => {
      if (styleTuple instanceof Map && styleTuple.has("offset")) {
        const obj = styleTuple;
        offset = parseFloat(obj.get("offset"));
        obj.delete("offset");
      }
    });
  } else if (styles instanceof Map && styles.has("offset")) {
    const obj = styles;
    offset = parseFloat(obj.get("offset"));
    obj.delete("offset");
  }
  return offset;
}
function constructTimingAst(value, errors) {
  if (value.hasOwnProperty("duration")) {
    return value;
  }
  if (typeof value == "number") {
    const duration = resolveTiming(value, errors).duration;
    return makeTimingAst(duration, 0, "");
  }
  const strValue = value;
  const isDynamic = strValue.split(/\s+/).some((v) => v.charAt(0) == "{" && v.charAt(1) == "{");
  if (isDynamic) {
    const ast = makeTimingAst(0, 0, "");
    ast.dynamic = true;
    ast.strValue = strValue;
    return ast;
  }
  const timings = resolveTiming(strValue, errors);
  return makeTimingAst(timings.duration, timings.delay, timings.easing);
}
function normalizeAnimationOptions(options) {
  if (options) {
    options = __spreadValues({}, options);
    if (options["params"]) {
      options["params"] = normalizeParams(options["params"]);
    }
  } else {
    options = {};
  }
  return options;
}
function makeTimingAst(duration, delay, easing) {
  return {
    duration,
    delay,
    easing
  };
}
function createTimelineInstruction(element, keyframes, preStyleProps, postStyleProps, duration, delay, easing = null, subTimeline = false) {
  return {
    type: 1,
    element,
    keyframes,
    preStyleProps,
    postStyleProps,
    duration,
    delay,
    totalTime: duration + delay,
    easing,
    subTimeline
  };
}
var ElementInstructionMap = class {
  _map = /* @__PURE__ */ new Map();
  get(element) {
    return this._map.get(element) || [];
  }
  append(element, instructions) {
    let existingInstructions = this._map.get(element);
    if (!existingInstructions) {
      this._map.set(element, existingInstructions = []);
    }
    existingInstructions.push(...instructions);
  }
  has(element) {
    return this._map.has(element);
  }
  clear() {
    this._map.clear();
  }
};
var ONE_FRAME_IN_MILLISECONDS = 1;
var ENTER_TOKEN = ":enter";
var ENTER_TOKEN_REGEX = /* @__PURE__ */ new RegExp(ENTER_TOKEN, "g");
var LEAVE_TOKEN = ":leave";
var LEAVE_TOKEN_REGEX = /* @__PURE__ */ new RegExp(LEAVE_TOKEN, "g");
function buildAnimationTimelines(driver, rootElement, ast, enterClassName, leaveClassName, startingStyles = /* @__PURE__ */ new Map(), finalStyles = /* @__PURE__ */ new Map(), options, subInstructions, errors = []) {
  return new AnimationTimelineBuilderVisitor().buildKeyframes(driver, rootElement, ast, enterClassName, leaveClassName, startingStyles, finalStyles, options, subInstructions, errors);
}
var AnimationTimelineBuilderVisitor = class {
  buildKeyframes(driver, rootElement, ast, enterClassName, leaveClassName, startingStyles, finalStyles, options, subInstructions, errors = []) {
    subInstructions = subInstructions || new ElementInstructionMap();
    const context = new AnimationTimelineContext(driver, rootElement, subInstructions, enterClassName, leaveClassName, errors, []);
    context.options = options;
    const delay = options.delay ? resolveTimingValue(options.delay) : 0;
    context.currentTimeline.delayNextStep(delay);
    context.currentTimeline.setStyles([startingStyles], null, context.errors, options);
    visitDslNode(this, ast, context);
    const timelines = context.timelines.filter((timeline) => timeline.containsAnimation());
    if (timelines.length && finalStyles.size) {
      let lastRootTimeline;
      for (let i = timelines.length - 1; i >= 0; i--) {
        const timeline = timelines[i];
        if (timeline.element === rootElement) {
          lastRootTimeline = timeline;
          break;
        }
      }
      if (lastRootTimeline && !lastRootTimeline.allowOnlyTimelineStyles()) {
        lastRootTimeline.setStyles([finalStyles], null, context.errors, options);
      }
    }
    return timelines.length ? timelines.map((timeline) => timeline.buildKeyframes()) : [createTimelineInstruction(rootElement, [], [], [], 0, delay, "", false)];
  }
  visitTrigger(ast, context) {
  }
  visitState(ast, context) {
  }
  visitTransition(ast, context) {
  }
  visitAnimateChild(ast, context) {
    const elementInstructions = context.subInstructions.get(context.element);
    if (elementInstructions) {
      const innerContext = context.createSubContext(ast.options);
      const startTime = context.currentTimeline.currentTime;
      const endTime = this._visitSubInstructions(elementInstructions, innerContext, innerContext.options);
      if (startTime != endTime) {
        context.transformIntoNewTimeline(endTime);
      }
    }
    context.previousNode = ast;
  }
  visitAnimateRef(ast, context) {
    const innerContext = context.createSubContext(ast.options);
    innerContext.transformIntoNewTimeline();
    this._applyAnimationRefDelays([ast.options, ast.animation.options], context, innerContext);
    this.visitReference(ast.animation, innerContext);
    context.transformIntoNewTimeline(innerContext.currentTimeline.currentTime);
    context.previousNode = ast;
  }
  _applyAnimationRefDelays(animationsRefsOptions, context, innerContext) {
    for (const animationRefOptions of animationsRefsOptions) {
      const animationDelay = animationRefOptions?.delay;
      if (animationDelay) {
        const animationDelayValue = typeof animationDelay === "number" ? animationDelay : resolveTimingValue(interpolateParams(animationDelay, animationRefOptions?.params ?? {}, context.errors));
        innerContext.delayNextStep(animationDelayValue);
      }
    }
  }
  _visitSubInstructions(instructions, context, options) {
    const startTime = context.currentTimeline.currentTime;
    let furthestTime = startTime;
    const duration = options.duration != null ? resolveTimingValue(options.duration) : null;
    const delay = options.delay != null ? resolveTimingValue(options.delay) : null;
    if (duration !== 0) {
      instructions.forEach((instruction) => {
        const instructionTimings = context.appendInstructionToTimeline(instruction, duration, delay);
        furthestTime = Math.max(furthestTime, instructionTimings.duration + instructionTimings.delay);
      });
    }
    return furthestTime;
  }
  visitReference(ast, context) {
    context.updateOptions(ast.options, true);
    visitDslNode(this, ast.animation, context);
    context.previousNode = ast;
  }
  visitSequence(ast, context) {
    const subContextCount = context.subContextCount;
    let ctx = context;
    const options = ast.options;
    if (options && (options.params || options.delay)) {
      ctx = context.createSubContext(options);
      ctx.transformIntoNewTimeline();
      if (options.delay != null) {
        if (ctx.previousNode.type == AnimationMetadataType.Style) {
          ctx.currentTimeline.snapshotCurrentStyles();
          ctx.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;
        }
        const delay = resolveTimingValue(options.delay);
        ctx.delayNextStep(delay);
      }
    }
    if (ast.steps.length) {
      ast.steps.forEach((s) => visitDslNode(this, s, ctx));
      ctx.currentTimeline.applyStylesToKeyframe();
      if (ctx.subContextCount > subContextCount) {
        ctx.transformIntoNewTimeline();
      }
    }
    context.previousNode = ast;
  }
  visitGroup(ast, context) {
    const innerTimelines = [];
    let furthestTime = context.currentTimeline.currentTime;
    const delay = ast.options && ast.options.delay ? resolveTimingValue(ast.options.delay) : 0;
    ast.steps.forEach((s) => {
      const innerContext = context.createSubContext(ast.options);
      if (delay) {
        innerContext.delayNextStep(delay);
      }
      visitDslNode(this, s, innerContext);
      furthestTime = Math.max(furthestTime, innerContext.currentTimeline.currentTime);
      innerTimelines.push(innerContext.currentTimeline);
    });
    innerTimelines.forEach((timeline) => context.currentTimeline.mergeTimelineCollectedStyles(timeline));
    context.transformIntoNewTimeline(furthestTime);
    context.previousNode = ast;
  }
  _visitTiming(ast, context) {
    if (ast.dynamic) {
      const strValue = ast.strValue;
      const timingValue = context.params ? interpolateParams(strValue, context.params, context.errors) : strValue;
      return resolveTiming(timingValue, context.errors);
    } else {
      return {
        duration: ast.duration,
        delay: ast.delay,
        easing: ast.easing
      };
    }
  }
  visitAnimate(ast, context) {
    const timings = context.currentAnimateTimings = this._visitTiming(ast.timings, context);
    const timeline = context.currentTimeline;
    if (timings.delay) {
      context.incrementTime(timings.delay);
      timeline.snapshotCurrentStyles();
    }
    const style2 = ast.style;
    if (style2.type == AnimationMetadataType.Keyframes) {
      this.visitKeyframes(style2, context);
    } else {
      context.incrementTime(timings.duration);
      this.visitStyle(style2, context);
      timeline.applyStylesToKeyframe();
    }
    context.currentAnimateTimings = null;
    context.previousNode = ast;
  }
  visitStyle(ast, context) {
    const timeline = context.currentTimeline;
    const timings = context.currentAnimateTimings;
    if (!timings && timeline.hasCurrentStyleProperties()) {
      timeline.forwardFrame();
    }
    const easing = timings && timings.easing || ast.easing;
    if (ast.isEmptyStep) {
      timeline.applyEmptyStep(easing);
    } else {
      timeline.setStyles(ast.styles, easing, context.errors, context.options);
    }
    context.previousNode = ast;
  }
  visitKeyframes(ast, context) {
    const currentAnimateTimings = context.currentAnimateTimings;
    const startTime = context.currentTimeline.duration;
    const duration = currentAnimateTimings.duration;
    const innerContext = context.createSubContext();
    const innerTimeline = innerContext.currentTimeline;
    innerTimeline.easing = currentAnimateTimings.easing;
    ast.styles.forEach((step) => {
      const offset = step.offset || 0;
      innerTimeline.forwardTime(offset * duration);
      innerTimeline.setStyles(step.styles, step.easing, context.errors, context.options);
      innerTimeline.applyStylesToKeyframe();
    });
    context.currentTimeline.mergeTimelineCollectedStyles(innerTimeline);
    context.transformIntoNewTimeline(startTime + duration);
    context.previousNode = ast;
  }
  visitQuery(ast, context) {
    const startTime = context.currentTimeline.currentTime;
    const options = ast.options || {};
    const delay = options.delay ? resolveTimingValue(options.delay) : 0;
    if (delay && (context.previousNode.type === AnimationMetadataType.Style || startTime == 0 && context.currentTimeline.hasCurrentStyleProperties())) {
      context.currentTimeline.snapshotCurrentStyles();
      context.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;
    }
    let furthestTime = startTime;
    const elms = context.invokeQuery(ast.selector, ast.originalSelector, ast.limit, ast.includeSelf, options.optional ? true : false, context.errors);
    context.currentQueryTotal = elms.length;
    let sameElementTimeline = null;
    elms.forEach((element, i) => {
      context.currentQueryIndex = i;
      const innerContext = context.createSubContext(ast.options, element);
      if (delay) {
        innerContext.delayNextStep(delay);
      }
      if (element === context.element) {
        sameElementTimeline = innerContext.currentTimeline;
      }
      visitDslNode(this, ast.animation, innerContext);
      innerContext.currentTimeline.applyStylesToKeyframe();
      const endTime = innerContext.currentTimeline.currentTime;
      furthestTime = Math.max(furthestTime, endTime);
    });
    context.currentQueryIndex = 0;
    context.currentQueryTotal = 0;
    context.transformIntoNewTimeline(furthestTime);
    if (sameElementTimeline) {
      context.currentTimeline.mergeTimelineCollectedStyles(sameElementTimeline);
      context.currentTimeline.snapshotCurrentStyles();
    }
    context.previousNode = ast;
  }
  visitStagger(ast, context) {
    const parentContext = context.parentContext;
    const tl = context.currentTimeline;
    const timings = ast.timings;
    const duration = Math.abs(timings.duration);
    const maxTime = duration * (context.currentQueryTotal - 1);
    let delay = duration * context.currentQueryIndex;
    let staggerTransformer = timings.duration < 0 ? "reverse" : timings.easing;
    switch (staggerTransformer) {
      case "reverse":
        delay = maxTime - delay;
        break;
      case "full":
        delay = parentContext.currentStaggerTime;
        break;
    }
    const timeline = context.currentTimeline;
    if (delay) {
      timeline.delayNextStep(delay);
    }
    const startingTime = timeline.currentTime;
    visitDslNode(this, ast.animation, context);
    context.previousNode = ast;
    parentContext.currentStaggerTime = tl.currentTime - startingTime + (tl.startTime - parentContext.currentTimeline.startTime);
  }
};
var DEFAULT_NOOP_PREVIOUS_NODE = {};
var AnimationTimelineContext = class _AnimationTimelineContext {
  _driver;
  element;
  subInstructions;
  _enterClassName;
  _leaveClassName;
  errors;
  timelines;
  parentContext = null;
  currentTimeline;
  currentAnimateTimings = null;
  previousNode = DEFAULT_NOOP_PREVIOUS_NODE;
  subContextCount = 0;
  options = {};
  currentQueryIndex = 0;
  currentQueryTotal = 0;
  currentStaggerTime = 0;
  constructor(_driver, element, subInstructions, _enterClassName, _leaveClassName, errors, timelines, initialTimeline) {
    this._driver = _driver;
    this.element = element;
    this.subInstructions = subInstructions;
    this._enterClassName = _enterClassName;
    this._leaveClassName = _leaveClassName;
    this.errors = errors;
    this.timelines = timelines;
    this.currentTimeline = initialTimeline || new TimelineBuilder(this._driver, element, 0);
    timelines.push(this.currentTimeline);
  }
  get params() {
    return this.options.params;
  }
  updateOptions(options, skipIfExists) {
    if (!options) return;
    const newOptions = options;
    let optionsToUpdate = this.options;
    if (newOptions.duration != null) {
      optionsToUpdate.duration = resolveTimingValue(newOptions.duration);
    }
    if (newOptions.delay != null) {
      optionsToUpdate.delay = resolveTimingValue(newOptions.delay);
    }
    const newParams = newOptions.params;
    if (newParams) {
      let paramsToUpdate = optionsToUpdate.params;
      if (!paramsToUpdate) {
        paramsToUpdate = this.options.params = {};
      }
      Object.keys(newParams).forEach((name) => {
        if (!skipIfExists || !paramsToUpdate.hasOwnProperty(name)) {
          paramsToUpdate[name] = interpolateParams(newParams[name], paramsToUpdate, this.errors);
        }
      });
    }
  }
  _copyOptions() {
    const options = {};
    if (this.options) {
      const oldParams = this.options.params;
      if (oldParams) {
        const params = options["params"] = {};
        Object.keys(oldParams).forEach((name) => {
          params[name] = oldParams[name];
        });
      }
    }
    return options;
  }
  createSubContext(options = null, element, newTime) {
    const target = element || this.element;
    const context = new _AnimationTimelineContext(this._driver, target, this.subInstructions, this._enterClassName, this._leaveClassName, this.errors, this.timelines, this.currentTimeline.fork(target, newTime || 0));
    context.previousNode = this.previousNode;
    context.currentAnimateTimings = this.currentAnimateTimings;
    context.options = this._copyOptions();
    context.updateOptions(options);
    context.currentQueryIndex = this.currentQueryIndex;
    context.currentQueryTotal = this.currentQueryTotal;
    context.parentContext = this;
    this.subContextCount++;
    return context;
  }
  transformIntoNewTimeline(newTime) {
    this.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;
    this.currentTimeline = this.currentTimeline.fork(this.element, newTime);
    this.timelines.push(this.currentTimeline);
    return this.currentTimeline;
  }
  appendInstructionToTimeline(instruction, duration, delay) {
    const updatedTimings = {
      duration: duration != null ? duration : instruction.duration,
      delay: this.currentTimeline.currentTime + (delay != null ? delay : 0) + instruction.delay,
      easing: ""
    };
    const builder = new SubTimelineBuilder(this._driver, instruction.element, instruction.keyframes, instruction.preStyleProps, instruction.postStyleProps, updatedTimings, instruction.stretchStartingKeyframe);
    this.timelines.push(builder);
    return updatedTimings;
  }
  incrementTime(time) {
    this.currentTimeline.forwardTime(this.currentTimeline.duration + time);
  }
  delayNextStep(delay) {
    if (delay > 0) {
      this.currentTimeline.delayNextStep(delay);
    }
  }
  invokeQuery(selector, originalSelector, limit, includeSelf, optional, errors) {
    let results = [];
    if (includeSelf) {
      results.push(this.element);
    }
    if (selector.length > 0) {
      selector = selector.replace(ENTER_TOKEN_REGEX, "." + this._enterClassName);
      selector = selector.replace(LEAVE_TOKEN_REGEX, "." + this._leaveClassName);
      const multi = limit != 1;
      let elements = this._driver.query(this.element, selector, multi);
      if (limit !== 0) {
        elements = limit < 0 ? elements.slice(elements.length + limit, elements.length) : elements.slice(0, limit);
      }
      results.push(...elements);
    }
    if (!optional && results.length == 0) {
      errors.push(invalidQuery(originalSelector));
    }
    return results;
  }
};
var TimelineBuilder = class _TimelineBuilder {
  _driver;
  element;
  startTime;
  _elementTimelineStylesLookup;
  duration = 0;
  easing = null;
  _previousKeyframe = /* @__PURE__ */ new Map();
  _currentKeyframe = /* @__PURE__ */ new Map();
  _keyframes = /* @__PURE__ */ new Map();
  _styleSummary = /* @__PURE__ */ new Map();
  _localTimelineStyles = /* @__PURE__ */ new Map();
  _globalTimelineStyles;
  _pendingStyles = /* @__PURE__ */ new Map();
  _backFill = /* @__PURE__ */ new Map();
  _currentEmptyStepKeyframe = null;
  constructor(_driver, element, startTime, _elementTimelineStylesLookup) {
    this._driver = _driver;
    this.element = element;
    this.startTime = startTime;
    this._elementTimelineStylesLookup = _elementTimelineStylesLookup;
    if (!this._elementTimelineStylesLookup) {
      this._elementTimelineStylesLookup = /* @__PURE__ */ new Map();
    }
    this._globalTimelineStyles = this._elementTimelineStylesLookup.get(element);
    if (!this._globalTimelineStyles) {
      this._globalTimelineStyles = this._localTimelineStyles;
      this._elementTimelineStylesLookup.set(element, this._localTimelineStyles);
    }
    this._loadKeyframe();
  }
  containsAnimation() {
    switch (this._keyframes.size) {
      case 0:
        return false;
      case 1:
        return this.hasCurrentStyleProperties();
      default:
        return true;
    }
  }
  hasCurrentStyleProperties() {
    return this._currentKeyframe.size > 0;
  }
  get currentTime() {
    return this.startTime + this.duration;
  }
  delayNextStep(delay) {
    const hasPreStyleStep = this._keyframes.size === 1 && this._pendingStyles.size;
    if (this.duration || hasPreStyleStep) {
      this.forwardTime(this.currentTime + delay);
      if (hasPreStyleStep) {
        this.snapshotCurrentStyles();
      }
    } else {
      this.startTime += delay;
    }
  }
  fork(element, currentTime) {
    this.applyStylesToKeyframe();
    return new _TimelineBuilder(this._driver, element, currentTime || this.currentTime, this._elementTimelineStylesLookup);
  }
  _loadKeyframe() {
    if (this._currentKeyframe) {
      this._previousKeyframe = this._currentKeyframe;
    }
    this._currentKeyframe = this._keyframes.get(this.duration);
    if (!this._currentKeyframe) {
      this._currentKeyframe = /* @__PURE__ */ new Map();
      this._keyframes.set(this.duration, this._currentKeyframe);
    }
  }
  forwardFrame() {
    this.duration += ONE_FRAME_IN_MILLISECONDS;
    this._loadKeyframe();
  }
  forwardTime(time) {
    this.applyStylesToKeyframe();
    this.duration = time;
    this._loadKeyframe();
  }
  _updateStyle(prop, value) {
    this._localTimelineStyles.set(prop, value);
    this._globalTimelineStyles.set(prop, value);
    this._styleSummary.set(prop, {
      time: this.currentTime,
      value
    });
  }
  allowOnlyTimelineStyles() {
    return this._currentEmptyStepKeyframe !== this._currentKeyframe;
  }
  applyEmptyStep(easing) {
    if (easing) {
      this._previousKeyframe.set("easing", easing);
    }
    for (let [prop, value] of this._globalTimelineStyles) {
      this._backFill.set(prop, value || AUTO_STYLE);
      this._currentKeyframe.set(prop, AUTO_STYLE);
    }
    this._currentEmptyStepKeyframe = this._currentKeyframe;
  }
  setStyles(input, easing, errors, options) {
    if (easing) {
      this._previousKeyframe.set("easing", easing);
    }
    const params = options && options.params || {};
    const styles = flattenStyles(input, this._globalTimelineStyles);
    for (let [prop, value] of styles) {
      const val = interpolateParams(value, params, errors);
      this._pendingStyles.set(prop, val);
      if (!this._localTimelineStyles.has(prop)) {
        this._backFill.set(prop, this._globalTimelineStyles.get(prop) ?? AUTO_STYLE);
      }
      this._updateStyle(prop, val);
    }
  }
  applyStylesToKeyframe() {
    if (this._pendingStyles.size == 0) return;
    this._pendingStyles.forEach((val, prop) => {
      this._currentKeyframe.set(prop, val);
    });
    this._pendingStyles.clear();
    this._localTimelineStyles.forEach((val, prop) => {
      if (!this._currentKeyframe.has(prop)) {
        this._currentKeyframe.set(prop, val);
      }
    });
  }
  snapshotCurrentStyles() {
    for (let [prop, val] of this._localTimelineStyles) {
      this._pendingStyles.set(prop, val);
      this._updateStyle(prop, val);
    }
  }
  getFinalKeyframe() {
    return this._keyframes.get(this.duration);
  }
  get properties() {
    const properties = [];
    for (let prop in this._currentKeyframe) {
      properties.push(prop);
    }
    return properties;
  }
  mergeTimelineCollectedStyles(timeline) {
    timeline._styleSummary.forEach((details1, prop) => {
      const details0 = this._styleSummary.get(prop);
      if (!details0 || details1.time > details0.time) {
        this._updateStyle(prop, details1.value);
      }
    });
  }
  buildKeyframes() {
    this.applyStylesToKeyframe();
    const preStyleProps = /* @__PURE__ */ new Set();
    const postStyleProps = /* @__PURE__ */ new Set();
    const isEmpty = this._keyframes.size === 1 && this.duration === 0;
    let finalKeyframes = [];
    this._keyframes.forEach((keyframe, time) => {
      const finalKeyframe = new Map([...this._backFill, ...keyframe]);
      finalKeyframe.forEach((value, prop) => {
        if (value === \u0275PRE_STYLE) {
          preStyleProps.add(prop);
        } else if (value === AUTO_STYLE) {
          postStyleProps.add(prop);
        }
      });
      if (!isEmpty) {
        finalKeyframe.set("offset", time / this.duration);
      }
      finalKeyframes.push(finalKeyframe);
    });
    const preProps = [...preStyleProps.values()];
    const postProps = [...postStyleProps.values()];
    if (isEmpty) {
      const kf0 = finalKeyframes[0];
      const kf1 = new Map(kf0);
      kf0.set("offset", 0);
      kf1.set("offset", 1);
      finalKeyframes = [kf0, kf1];
    }
    return createTimelineInstruction(this.element, finalKeyframes, preProps, postProps, this.duration, this.startTime, this.easing, false);
  }
};
var SubTimelineBuilder = class extends TimelineBuilder {
  keyframes;
  preStyleProps;
  postStyleProps;
  _stretchStartingKeyframe;
  timings;
  constructor(driver, element, keyframes, preStyleProps, postStyleProps, timings, _stretchStartingKeyframe = false) {
    super(driver, element, timings.delay);
    this.keyframes = keyframes;
    this.preStyleProps = preStyleProps;
    this.postStyleProps = postStyleProps;
    this._stretchStartingKeyframe = _stretchStartingKeyframe;
    this.timings = {
      duration: timings.duration,
      delay: timings.delay,
      easing: timings.easing
    };
  }
  containsAnimation() {
    return this.keyframes.length > 1;
  }
  buildKeyframes() {
    let keyframes = this.keyframes;
    let {
      delay,
      duration,
      easing
    } = this.timings;
    if (this._stretchStartingKeyframe && delay) {
      const newKeyframes = [];
      const totalTime = duration + delay;
      const startingGap = delay / totalTime;
      const newFirstKeyframe = new Map(keyframes[0]);
      newFirstKeyframe.set("offset", 0);
      newKeyframes.push(newFirstKeyframe);
      const oldFirstKeyframe = new Map(keyframes[0]);
      oldFirstKeyframe.set("offset", roundOffset(startingGap));
      newKeyframes.push(oldFirstKeyframe);
      const limit = keyframes.length - 1;
      for (let i = 1; i <= limit; i++) {
        let kf = new Map(keyframes[i]);
        const oldOffset = kf.get("offset");
        const timeAtKeyframe = delay + oldOffset * duration;
        kf.set("offset", roundOffset(timeAtKeyframe / totalTime));
        newKeyframes.push(kf);
      }
      duration = totalTime;
      delay = 0;
      easing = "";
      keyframes = newKeyframes;
    }
    return createTimelineInstruction(this.element, keyframes, this.preStyleProps, this.postStyleProps, duration, delay, easing, true);
  }
};
function roundOffset(offset, decimalPoints = 3) {
  const mult = Math.pow(10, decimalPoints - 1);
  return Math.round(offset * mult) / mult;
}
function flattenStyles(input, allStyles) {
  const styles = /* @__PURE__ */ new Map();
  let allProperties;
  input.forEach((token) => {
    if (token === "*") {
      allProperties ??= allStyles.keys();
      for (let prop of allProperties) {
        styles.set(prop, AUTO_STYLE);
      }
    } else {
      for (let [prop, val] of token) {
        styles.set(prop, val);
      }
    }
  });
  return styles;
}
function createTransitionInstruction(element, triggerName, fromState, toState, isRemovalTransition, fromStyles, toStyles, timelines, queriedElements, preStyleProps, postStyleProps, totalTime, errors) {
  return {
    type: 0,
    element,
    triggerName,
    isRemovalTransition,
    fromState,
    fromStyles,
    toState,
    toStyles,
    timelines,
    queriedElements,
    preStyleProps,
    postStyleProps,
    totalTime,
    errors
  };
}
var EMPTY_OBJECT = {};
var AnimationTransitionFactory = class {
  _triggerName;
  ast;
  _stateStyles;
  constructor(_triggerName, ast, _stateStyles) {
    this._triggerName = _triggerName;
    this.ast = ast;
    this._stateStyles = _stateStyles;
  }
  match(currentState, nextState, element, params) {
    return oneOrMoreTransitionsMatch(this.ast.matchers, currentState, nextState, element, params);
  }
  buildStyles(stateName, params, errors) {
    let styler = this._stateStyles.get("*");
    if (stateName !== void 0) {
      styler = this._stateStyles.get(stateName?.toString()) || styler;
    }
    return styler ? styler.buildStyles(params, errors) : /* @__PURE__ */ new Map();
  }
  build(driver, element, currentState, nextState, enterClassName, leaveClassName, currentOptions, nextOptions, subInstructions, skipAstBuild) {
    const errors = [];
    const transitionAnimationParams = this.ast.options && this.ast.options.params || EMPTY_OBJECT;
    const currentAnimationParams = currentOptions && currentOptions.params || EMPTY_OBJECT;
    const currentStateStyles = this.buildStyles(currentState, currentAnimationParams, errors);
    const nextAnimationParams = nextOptions && nextOptions.params || EMPTY_OBJECT;
    const nextStateStyles = this.buildStyles(nextState, nextAnimationParams, errors);
    const queriedElements = /* @__PURE__ */ new Set();
    const preStyleMap = /* @__PURE__ */ new Map();
    const postStyleMap = /* @__PURE__ */ new Map();
    const isRemoval = nextState === "void";
    const animationOptions = {
      params: applyParamDefaults(nextAnimationParams, transitionAnimationParams),
      delay: this.ast.options?.delay
    };
    const timelines = skipAstBuild ? [] : buildAnimationTimelines(driver, element, this.ast.animation, enterClassName, leaveClassName, currentStateStyles, nextStateStyles, animationOptions, subInstructions, errors);
    let totalTime = 0;
    timelines.forEach((tl) => {
      totalTime = Math.max(tl.duration + tl.delay, totalTime);
    });
    if (errors.length) {
      return createTransitionInstruction(element, this._triggerName, currentState, nextState, isRemoval, currentStateStyles, nextStateStyles, [], [], preStyleMap, postStyleMap, totalTime, errors);
    }
    timelines.forEach((tl) => {
      const elm = tl.element;
      const preProps = getOrSetDefaultValue(preStyleMap, elm, /* @__PURE__ */ new Set());
      tl.preStyleProps.forEach((prop) => preProps.add(prop));
      const postProps = getOrSetDefaultValue(postStyleMap, elm, /* @__PURE__ */ new Set());
      tl.postStyleProps.forEach((prop) => postProps.add(prop));
      if (elm !== element) {
        queriedElements.add(elm);
      }
    });
    if (typeof ngDevMode === "undefined" || ngDevMode) {
      checkNonAnimatableInTimelines(timelines, this._triggerName, driver);
    }
    return createTransitionInstruction(element, this._triggerName, currentState, nextState, isRemoval, currentStateStyles, nextStateStyles, timelines, [...queriedElements.values()], preStyleMap, postStyleMap, totalTime);
  }
};
function checkNonAnimatableInTimelines(timelines, triggerName, driver) {
  if (!driver.validateAnimatableStyleProperty) {
    return;
  }
  const allowedNonAnimatableProps = /* @__PURE__ */ new Set([
    // 'easing' is a utility/synthetic prop we use to represent
    // easing functions, it represents a property of the animation
    // which is not animatable but different values can be used
    // in different steps
    "easing"
  ]);
  const invalidNonAnimatableProps = /* @__PURE__ */ new Set();
  timelines.forEach(({
    keyframes
  }) => {
    const nonAnimatablePropsInitialValues = /* @__PURE__ */ new Map();
    keyframes.forEach((keyframe) => {
      const entriesToCheck = Array.from(keyframe.entries()).filter(([prop]) => !allowedNonAnimatableProps.has(prop));
      for (const [prop, value] of entriesToCheck) {
        if (!driver.validateAnimatableStyleProperty(prop)) {
          if (nonAnimatablePropsInitialValues.has(prop) && !invalidNonAnimatableProps.has(prop)) {
            const propInitialValue = nonAnimatablePropsInitialValues.get(prop);
            if (propInitialValue !== value) {
              invalidNonAnimatableProps.add(prop);
            }
          } else {
            nonAnimatablePropsInitialValues.set(prop, value);
          }
        }
      }
    });
  });
  if (invalidNonAnimatableProps.size > 0) {
    console.warn(`Warning: The animation trigger "${triggerName}" is attempting to animate the following not animatable properties: ` + Array.from(invalidNonAnimatableProps).join(", ") + "\n(to check the list of all animatable properties visit https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_animated_properties)");
  }
}
function oneOrMoreTransitionsMatch(matchFns, currentState, nextState, element, params) {
  return matchFns.some((fn) => fn(currentState, nextState, element, params));
}
function applyParamDefaults(userParams, defaults) {
  const result = __spreadValues({}, defaults);
  Object.entries(userParams).forEach(([key, value]) => {
    if (value != null) {
      result[key] = value;
    }
  });
  return result;
}
var AnimationStateStyles = class {
  styles;
  defaultParams;
  normalizer;
  constructor(styles, defaultParams, normalizer) {
    this.styles = styles;
    this.defaultParams = defaultParams;
    this.normalizer = normalizer;
  }
  buildStyles(params, errors) {
    const finalStyles = /* @__PURE__ */ new Map();
    const combinedParams = applyParamDefaults(params, this.defaultParams);
    this.styles.styles.forEach((value) => {
      if (typeof value !== "string") {
        value.forEach((val, prop) => {
          if (val) {
            val = interpolateParams(val, combinedParams, errors);
          }
          const normalizedProp = this.normalizer.normalizePropertyName(prop, errors);
          val = this.normalizer.normalizeStyleValue(prop, normalizedProp, val, errors);
          finalStyles.set(prop, val);
        });
      }
    });
    return finalStyles;
  }
};
function buildTrigger(name, ast, normalizer) {
  return new AnimationTrigger(name, ast, normalizer);
}
var AnimationTrigger = class {
  name;
  ast;
  _normalizer;
  transitionFactories = [];
  fallbackTransition;
  states = /* @__PURE__ */ new Map();
  constructor(name, ast, _normalizer) {
    this.name = name;
    this.ast = ast;
    this._normalizer = _normalizer;
    ast.states.forEach((ast2) => {
      const defaultParams = ast2.options && ast2.options.params || {};
      this.states.set(ast2.name, new AnimationStateStyles(ast2.style, defaultParams, _normalizer));
    });
    balanceProperties(this.states, "true", "1");
    balanceProperties(this.states, "false", "0");
    ast.transitions.forEach((ast2) => {
      this.transitionFactories.push(new AnimationTransitionFactory(name, ast2, this.states));
    });
    this.fallbackTransition = createFallbackTransition(name, this.states);
  }
  get containsQueries() {
    return this.ast.queryCount > 0;
  }
  matchTransition(currentState, nextState, element, params) {
    const entry = this.transitionFactories.find((f) => f.match(currentState, nextState, element, params));
    return entry || null;
  }
  matchStyles(currentState, params, errors) {
    return this.fallbackTransition.buildStyles(currentState, params, errors);
  }
};
function createFallbackTransition(triggerName, states, normalizer) {
  const matchers = [(fromState, toState) => true];
  const animation = {
    type: AnimationMetadataType.Sequence,
    steps: [],
    options: null
  };
  const transition = {
    type: AnimationMetadataType.Transition,
    animation,
    matchers,
    options: null,
    queryCount: 0,
    depCount: 0
  };
  return new AnimationTransitionFactory(triggerName, transition, states);
}
function balanceProperties(stateMap, key1, key2) {
  if (stateMap.has(key1)) {
    if (!stateMap.has(key2)) {
      stateMap.set(key2, stateMap.get(key1));
    }
  } else if (stateMap.has(key2)) {
    stateMap.set(key1, stateMap.get(key2));
  }
}
var EMPTY_INSTRUCTION_MAP = /* @__PURE__ */ new ElementInstructionMap();
var TimelineAnimationEngine = class {
  bodyNode;
  _driver;
  _normalizer;
  _animations = /* @__PURE__ */ new Map();
  _playersById = /* @__PURE__ */ new Map();
  players = [];
  constructor(bodyNode, _driver, _normalizer) {
    this.bodyNode = bodyNode;
    this._driver = _driver;
    this._normalizer = _normalizer;
  }
  register(id, metadata) {
    const errors = [];
    const warnings = [];
    const ast = buildAnimationAst(this._driver, metadata, errors, warnings);
    if (errors.length) {
      throw registerFailed(errors);
    } else {
      if (typeof ngDevMode === "undefined" || ngDevMode) {
        if (warnings.length) {
          warnRegister(warnings);
        }
      }
      this._animations.set(id, ast);
    }
  }
  _buildPlayer(i, preStyles, postStyles) {
    const element = i.element;
    const keyframes = normalizeKeyframes$1(this._normalizer, i.keyframes, preStyles, postStyles);
    return this._driver.animate(element, keyframes, i.duration, i.delay, i.easing, [], true);
  }
  create(id, element, options = {}) {
    const errors = [];
    const ast = this._animations.get(id);
    let instructions;
    const autoStylesMap = /* @__PURE__ */ new Map();
    if (ast) {
      instructions = buildAnimationTimelines(this._driver, element, ast, ENTER_CLASSNAME, LEAVE_CLASSNAME, /* @__PURE__ */ new Map(), /* @__PURE__ */ new Map(), options, EMPTY_INSTRUCTION_MAP, errors);
      instructions.forEach((inst) => {
        const styles = getOrSetDefaultValue(autoStylesMap, inst.element, /* @__PURE__ */ new Map());
        inst.postStyleProps.forEach((prop) => styles.set(prop, null));
      });
    } else {
      errors.push(missingOrDestroyedAnimation());
      instructions = [];
    }
    if (errors.length) {
      throw createAnimationFailed(errors);
    }
    autoStylesMap.forEach((styles, element2) => {
      styles.forEach((_, prop) => {
        styles.set(prop, this._driver.computeStyle(element2, prop, AUTO_STYLE));
      });
    });
    const players = instructions.map((i) => {
      const styles = autoStylesMap.get(i.element);
      return this._buildPlayer(i, /* @__PURE__ */ new Map(), styles);
    });
    const player = optimizeGroupPlayer(players);
    this._playersById.set(id, player);
    player.onDestroy(() => this.destroy(id));
    this.players.push(player);
    return player;
  }
  destroy(id) {
    const player = this._getPlayer(id);
    player.destroy();
    this._playersById.delete(id);
    const index = this.players.indexOf(player);
    if (index >= 0) {
      this.players.splice(index, 1);
    }
  }
  _getPlayer(id) {
    const player = this._playersById.get(id);
    if (!player) {
      throw missingPlayer(id);
    }
    return player;
  }
  listen(id, element, eventName, callback) {
    const baseEvent = makeAnimationEvent(element, "", "", "");
    listenOnPlayer(this._getPlayer(id), eventName, baseEvent, callback);
    return () => {
    };
  }
  command(id, element, command, args) {
    if (command == "register") {
      this.register(id, args[0]);
      return;
    }
    if (command == "create") {
      const options = args[0] || {};
      this.create(id, element, options);
      return;
    }
    const player = this._getPlayer(id);
    switch (command) {
      case "play":
        player.play();
        break;
      case "pause":
        player.pause();
        break;
      case "reset":
        player.reset();
        break;
      case "restart":
        player.restart();
        break;
      case "finish":
        player.finish();
        break;
      case "init":
        player.init();
        break;
      case "setPosition":
        player.setPosition(parseFloat(args[0]));
        break;
      case "destroy":
        this.destroy(id);
        break;
    }
  }
};
var QUEUED_CLASSNAME = "ng-animate-queued";
var QUEUED_SELECTOR = ".ng-animate-queued";
var DISABLED_CLASSNAME = "ng-animate-disabled";
var DISABLED_SELECTOR = ".ng-animate-disabled";
var STAR_CLASSNAME = "ng-star-inserted";
var STAR_SELECTOR = ".ng-star-inserted";
var EMPTY_PLAYER_ARRAY = [];
var NULL_REMOVAL_STATE = {
  namespaceId: "",
  setForRemoval: false,
  setForMove: false,
  hasAnimation: false,
  removedBeforeQueried: false
};
var NULL_REMOVED_QUERIED_STATE = {
  namespaceId: "",
  setForMove: false,
  setForRemoval: false,
  hasAnimation: false,
  removedBeforeQueried: true
};
var REMOVAL_FLAG = "__ng_removed";
var StateValue = class {
  namespaceId;
  value;
  options;
  get params() {
    return this.options.params;
  }
  constructor(input, namespaceId = "") {
    this.namespaceId = namespaceId;
    const isObj = input && input.hasOwnProperty("value");
    const value = isObj ? input["value"] : input;
    this.value = normalizeTriggerValue(value);
    if (isObj) {
      const _a = input, {
        value: value2
      } = _a, options = __objRest(_a, [
        "value"
      ]);
      this.options = options;
    } else {
      this.options = {};
    }
    if (!this.options.params) {
      this.options.params = {};
    }
  }
  absorbOptions(options) {
    const newParams = options.params;
    if (newParams) {
      const oldParams = this.options.params;
      Object.keys(newParams).forEach((prop) => {
        if (oldParams[prop] == null) {
          oldParams[prop] = newParams[prop];
        }
      });
    }
  }
};
var VOID_VALUE = "void";
var DEFAULT_STATE_VALUE = /* @__PURE__ */ new StateValue(VOID_VALUE);
var AnimationTransitionNamespace = class {
  id;
  hostElement;
  _engine;
  players = [];
  _triggers = /* @__PURE__ */ new Map();
  _queue = [];
  _elementListeners = /* @__PURE__ */ new Map();
  _hostClassName;
  constructor(id, hostElement, _engine) {
    this.id = id;
    this.hostElement = hostElement;
    this._engine = _engine;
    this._hostClassName = "ng-tns-" + id;
    addClass(hostElement, this._hostClassName);
  }
  listen(element, name, phase, callback) {
    if (!this._triggers.has(name)) {
      throw missingTrigger(phase, name);
    }
    if (phase == null || phase.length == 0) {
      throw missingEvent(name);
    }
    if (!isTriggerEventValid(phase)) {
      throw unsupportedTriggerEvent(phase, name);
    }
    const listeners = getOrSetDefaultValue(this._elementListeners, element, []);
    const data = {
      name,
      phase,
      callback
    };
    listeners.push(data);
    const triggersWithStates = getOrSetDefaultValue(this._engine.statesByElement, element, /* @__PURE__ */ new Map());
    if (!triggersWithStates.has(name)) {
      addClass(element, NG_TRIGGER_CLASSNAME);
      addClass(element, NG_TRIGGER_CLASSNAME + "-" + name);
      triggersWithStates.set(name, DEFAULT_STATE_VALUE);
    }
    return () => {
      this._engine.afterFlush(() => {
        const index = listeners.indexOf(data);
        if (index >= 0) {
          listeners.splice(index, 1);
        }
        if (!this._triggers.has(name)) {
          triggersWithStates.delete(name);
        }
      });
    };
  }
  register(name, ast) {
    if (this._triggers.has(name)) {
      return false;
    } else {
      this._triggers.set(name, ast);
      return true;
    }
  }
  _getTrigger(name) {
    const trigger = this._triggers.get(name);
    if (!trigger) {
      throw unregisteredTrigger(name);
    }
    return trigger;
  }
  trigger(element, triggerName, value, defaultToFallback = true) {
    const trigger = this._getTrigger(triggerName);
    const player = new TransitionAnimationPlayer(this.id, triggerName, element);
    let triggersWithStates = this._engine.statesByElement.get(element);
    if (!triggersWithStates) {
      addClass(element, NG_TRIGGER_CLASSNAME);
      addClass(element, NG_TRIGGER_CLASSNAME + "-" + triggerName);
      this._engine.statesByElement.set(element, triggersWithStates = /* @__PURE__ */ new Map());
    }
    let fromState = triggersWithStates.get(triggerName);
    const toState = new StateValue(value, this.id);
    const isObj = value && value.hasOwnProperty("value");
    if (!isObj && fromState) {
      toState.absorbOptions(fromState.options);
    }
    triggersWithStates.set(triggerName, toState);
    if (!fromState) {
      fromState = DEFAULT_STATE_VALUE;
    }
    const isRemoval = toState.value === VOID_VALUE;
    if (!isRemoval && fromState.value === toState.value) {
      if (!objEquals(fromState.params, toState.params)) {
        const errors = [];
        const fromStyles = trigger.matchStyles(fromState.value, fromState.params, errors);
        const toStyles = trigger.matchStyles(toState.value, toState.params, errors);
        if (errors.length) {
          this._engine.reportError(errors);
        } else {
          this._engine.afterFlush(() => {
            eraseStyles(element, fromStyles);
            setStyles(element, toStyles);
          });
        }
      }
      return;
    }
    const playersOnElement = getOrSetDefaultValue(this._engine.playersByElement, element, []);
    playersOnElement.forEach((player2) => {
      if (player2.namespaceId == this.id && player2.triggerName == triggerName && player2.queued) {
        player2.destroy();
      }
    });
    let transition = trigger.matchTransition(fromState.value, toState.value, element, toState.params);
    let isFallbackTransition = false;
    if (!transition) {
      if (!defaultToFallback) return;
      transition = trigger.fallbackTransition;
      isFallbackTransition = true;
    }
    this._engine.totalQueuedPlayers++;
    this._queue.push({
      element,
      triggerName,
      transition,
      fromState,
      toState,
      player,
      isFallbackTransition
    });
    if (!isFallbackTransition) {
      addClass(element, QUEUED_CLASSNAME);
      player.onStart(() => {
        removeClass(element, QUEUED_CLASSNAME);
      });
    }
    player.onDone(() => {
      let index = this.players.indexOf(player);
      if (index >= 0) {
        this.players.splice(index, 1);
      }
      const players = this._engine.playersByElement.get(element);
      if (players) {
        let index2 = players.indexOf(player);
        if (index2 >= 0) {
          players.splice(index2, 1);
        }
      }
    });
    this.players.push(player);
    playersOnElement.push(player);
    return player;
  }
  deregister(name) {
    this._triggers.delete(name);
    this._engine.statesByElement.forEach((stateMap) => stateMap.delete(name));
    this._elementListeners.forEach((listeners, element) => {
      this._elementListeners.set(element, listeners.filter((entry) => {
        return entry.name != name;
      }));
    });
  }
  clearElementCache(element) {
    this._engine.statesByElement.delete(element);
    this._elementListeners.delete(element);
    const elementPlayers = this._engine.playersByElement.get(element);
    if (elementPlayers) {
      elementPlayers.forEach((player) => player.destroy());
      this._engine.playersByElement.delete(element);
    }
  }
  _signalRemovalForInnerTriggers(rootElement, context) {
    const elements = this._engine.driver.query(rootElement, NG_TRIGGER_SELECTOR, true);
    elements.forEach((elm) => {
      if (elm[REMOVAL_FLAG]) return;
      const namespaces = this._engine.fetchNamespacesByElement(elm);
      if (namespaces.size) {
        namespaces.forEach((ns) => ns.triggerLeaveAnimation(elm, context, false, true));
      } else {
        this.clearElementCache(elm);
      }
    });
    this._engine.afterFlushAnimationsDone(() => elements.forEach((elm) => this.clearElementCache(elm)));
  }
  triggerLeaveAnimation(element, context, destroyAfterComplete, defaultToFallback) {
    const triggerStates = this._engine.statesByElement.get(element);
    const previousTriggersValues = /* @__PURE__ */ new Map();
    if (triggerStates) {
      const players = [];
      triggerStates.forEach((state, triggerName) => {
        previousTriggersValues.set(triggerName, state.value);
        if (this._triggers.has(triggerName)) {
          const player = this.trigger(element, triggerName, VOID_VALUE, defaultToFallback);
          if (player) {
            players.push(player);
          }
        }
      });
      if (players.length) {
        this._engine.markElementAsRemoved(this.id, element, true, context, previousTriggersValues);
        if (destroyAfterComplete) {
          optimizeGroupPlayer(players).onDone(() => this._engine.processLeaveNode(element));
        }
        return true;
      }
    }
    return false;
  }
  prepareLeaveAnimationListeners(element) {
    const listeners = this._elementListeners.get(element);
    const elementStates = this._engine.statesByElement.get(element);
    if (listeners && elementStates) {
      const visitedTriggers = /* @__PURE__ */ new Set();
      listeners.forEach((listener) => {
        const triggerName = listener.name;
        if (visitedTriggers.has(triggerName)) return;
        visitedTriggers.add(triggerName);
        const trigger = this._triggers.get(triggerName);
        const transition = trigger.fallbackTransition;
        const fromState = elementStates.get(triggerName) || DEFAULT_STATE_VALUE;
        const toState = new StateValue(VOID_VALUE);
        const player = new TransitionAnimationPlayer(this.id, triggerName, element);
        this._engine.totalQueuedPlayers++;
        this._queue.push({
          element,
          triggerName,
          transition,
          fromState,
          toState,
          player,
          isFallbackTransition: true
        });
      });
    }
  }
  removeNode(element, context) {
    const engine = this._engine;
    if (element.childElementCount) {
      this._signalRemovalForInnerTriggers(element, context);
    }
    if (this.triggerLeaveAnimation(element, context, true)) return;
    let containsPotentialParentTransition = false;
    if (engine.totalAnimations) {
      const currentPlayers = engine.players.length ? engine.playersByQueriedElement.get(element) : [];
      if (currentPlayers && currentPlayers.length) {
        containsPotentialParentTransition = true;
      } else {
        let parent = element;
        while (parent = parent.parentNode) {
          const triggers = engine.statesByElement.get(parent);
          if (triggers) {
            containsPotentialParentTransition = true;
            break;
          }
        }
      }
    }
    this.prepareLeaveAnimationListeners(element);
    if (containsPotentialParentTransition) {
      engine.markElementAsRemoved(this.id, element, false, context);
    } else {
      const removalFlag = element[REMOVAL_FLAG];
      if (!removalFlag || removalFlag === NULL_REMOVAL_STATE) {
        engine.afterFlush(() => this.clearElementCache(element));
        engine.destroyInnerAnimations(element);
        engine._onRemovalComplete(element, context);
      }
    }
  }
  insertNode(element, parent) {
    addClass(element, this._hostClassName);
  }
  drainQueuedTransitions(microtaskId) {
    const instructions = [];
    this._queue.forEach((entry) => {
      const player = entry.player;
      if (player.destroyed) return;
      const element = entry.element;
      const listeners = this._elementListeners.get(element);
      if (listeners) {
        listeners.forEach((listener) => {
          if (listener.name == entry.triggerName) {
            const baseEvent = makeAnimationEvent(element, entry.triggerName, entry.fromState.value, entry.toState.value);
            baseEvent["_data"] = microtaskId;
            listenOnPlayer(entry.player, listener.phase, baseEvent, listener.callback);
          }
        });
      }
      if (player.markedForDestroy) {
        this._engine.afterFlush(() => {
          player.destroy();
        });
      } else {
        instructions.push(entry);
      }
    });
    this._queue = [];
    return instructions.sort((a, b) => {
      const d0 = a.transition.ast.depCount;
      const d1 = b.transition.ast.depCount;
      if (d0 == 0 || d1 == 0) {
        return d0 - d1;
      }
      return this._engine.driver.containsElement(a.element, b.element) ? 1 : -1;
    });
  }
  destroy(context) {
    this.players.forEach((p) => p.destroy());
    this._signalRemovalForInnerTriggers(this.hostElement, context);
  }
};
var TransitionAnimationEngine = class {
  bodyNode;
  driver;
  _normalizer;
  players = [];
  newHostElements = /* @__PURE__ */ new Map();
  playersByElement = /* @__PURE__ */ new Map();
  playersByQueriedElement = /* @__PURE__ */ new Map();
  statesByElement = /* @__PURE__ */ new Map();
  disabledNodes = /* @__PURE__ */ new Set();
  totalAnimations = 0;
  totalQueuedPlayers = 0;
  _namespaceLookup = {};
  _namespaceList = [];
  _flushFns = [];
  _whenQuietFns = [];
  namespacesByHostElement = /* @__PURE__ */ new Map();
  collectedEnterElements = [];
  collectedLeaveElements = [];
  // this method is designed to be overridden by the code that uses this engine
  onRemovalComplete = (element, context) => {
  };
  /** @internal */
  _onRemovalComplete(element, context) {
    this.onRemovalComplete(element, context);
  }
  constructor(bodyNode, driver, _normalizer) {
    this.bodyNode = bodyNode;
    this.driver = driver;
    this._normalizer = _normalizer;
  }
  get queuedPlayers() {
    const players = [];
    this._namespaceList.forEach((ns) => {
      ns.players.forEach((player) => {
        if (player.queued) {
          players.push(player);
        }
      });
    });
    return players;
  }
  createNamespace(namespaceId, hostElement) {
    const ns = new AnimationTransitionNamespace(namespaceId, hostElement, this);
    if (this.bodyNode && this.driver.containsElement(this.bodyNode, hostElement)) {
      this._balanceNamespaceList(ns, hostElement);
    } else {
      this.newHostElements.set(hostElement, ns);
      this.collectEnterElement(hostElement);
    }
    return this._namespaceLookup[namespaceId] = ns;
  }
  _balanceNamespaceList(ns, hostElement) {
    const namespaceList = this._namespaceList;
    const namespacesByHostElement = this.namespacesByHostElement;
    const limit = namespaceList.length - 1;
    if (limit >= 0) {
      let found = false;
      let ancestor = this.driver.getParentElement(hostElement);
      while (ancestor) {
        const ancestorNs = namespacesByHostElement.get(ancestor);
        if (ancestorNs) {
          const index = namespaceList.indexOf(ancestorNs);
          namespaceList.splice(index + 1, 0, ns);
          found = true;
          break;
        }
        ancestor = this.driver.getParentElement(ancestor);
      }
      if (!found) {
        namespaceList.unshift(ns);
      }
    } else {
      namespaceList.push(ns);
    }
    namespacesByHostElement.set(hostElement, ns);
    return ns;
  }
  register(namespaceId, hostElement) {
    let ns = this._namespaceLookup[namespaceId];
    if (!ns) {
      ns = this.createNamespace(namespaceId, hostElement);
    }
    return ns;
  }
  registerTrigger(namespaceId, name, trigger) {
    let ns = this._namespaceLookup[namespaceId];
    if (ns && ns.register(name, trigger)) {
      this.totalAnimations++;
    }
  }
  destroy(namespaceId, context) {
    if (!namespaceId) return;
    this.afterFlush(() => {
    });
    this.afterFlushAnimationsDone(() => {
      const ns = this._fetchNamespace(namespaceId);
      this.namespacesByHostElement.delete(ns.hostElement);
      const index = this._namespaceList.indexOf(ns);
      if (index >= 0) {
        this._namespaceList.splice(index, 1);
      }
      ns.destroy(context);
      delete this._namespaceLookup[namespaceId];
    });
  }
  _fetchNamespace(id) {
    return this._namespaceLookup[id];
  }
  fetchNamespacesByElement(element) {
    const namespaces = /* @__PURE__ */ new Set();
    const elementStates = this.statesByElement.get(element);
    if (elementStates) {
      for (let stateValue of elementStates.values()) {
        if (stateValue.namespaceId) {
          const ns = this._fetchNamespace(stateValue.namespaceId);
          if (ns) {
            namespaces.add(ns);
          }
        }
      }
    }
    return namespaces;
  }
  trigger(namespaceId, element, name, value) {
    if (isElementNode(element)) {
      const ns = this._fetchNamespace(namespaceId);
      if (ns) {
        ns.trigger(element, name, value);
        return true;
      }
    }
    return false;
  }
  insertNode(namespaceId, element, parent, insertBefore) {
    if (!isElementNode(element)) return;
    const details = element[REMOVAL_FLAG];
    if (details && details.setForRemoval) {
      details.setForRemoval = false;
      details.setForMove = true;
      const index = this.collectedLeaveElements.indexOf(element);
      if (index >= 0) {
        this.collectedLeaveElements.splice(index, 1);
      }
    }
    if (namespaceId) {
      const ns = this._fetchNamespace(namespaceId);
      if (ns) {
        ns.insertNode(element, parent);
      }
    }
    if (insertBefore) {
      this.collectEnterElement(element);
    }
  }
  collectEnterElement(element) {
    this.collectedEnterElements.push(element);
  }
  markElementAsDisabled(element, value) {
    if (value) {
      if (!this.disabledNodes.has(element)) {
        this.disabledNodes.add(element);
        addClass(element, DISABLED_CLASSNAME);
      }
    } else if (this.disabledNodes.has(element)) {
      this.disabledNodes.delete(element);
      removeClass(element, DISABLED_CLASSNAME);
    }
  }
  removeNode(namespaceId, element, context) {
    if (isElementNode(element)) {
      const ns = namespaceId ? this._fetchNamespace(namespaceId) : null;
      if (ns) {
        ns.removeNode(element, context);
      } else {
        this.markElementAsRemoved(namespaceId, element, false, context);
      }
      const hostNS = this.namespacesByHostElement.get(element);
      if (hostNS && hostNS.id !== namespaceId) {
        hostNS.removeNode(element, context);
      }
    } else {
      this._onRemovalComplete(element, context);
    }
  }
  markElementAsRemoved(namespaceId, element, hasAnimation, context, previousTriggersValues) {
    this.collectedLeaveElements.push(element);
    element[REMOVAL_FLAG] = {
      namespaceId,
      setForRemoval: context,
      hasAnimation,
      removedBeforeQueried: false,
      previousTriggersValues
    };
  }
  listen(namespaceId, element, name, phase, callback) {
    if (isElementNode(element)) {
      return this._fetchNamespace(namespaceId).listen(element, name, phase, callback);
    }
    return () => {
    };
  }
  _buildInstruction(entry, subTimelines, enterClassName, leaveClassName, skipBuildAst) {
    return entry.transition.build(this.driver, entry.element, entry.fromState.value, entry.toState.value, enterClassName, leaveClassName, entry.fromState.options, entry.toState.options, subTimelines, skipBuildAst);
  }
  destroyInnerAnimations(containerElement) {
    let elements = this.driver.query(containerElement, NG_TRIGGER_SELECTOR, true);
    elements.forEach((element) => this.destroyActiveAnimationsForElement(element));
    if (this.playersByQueriedElement.size == 0) return;
    elements = this.driver.query(containerElement, NG_ANIMATING_SELECTOR, true);
    elements.forEach((element) => this.finishActiveQueriedAnimationOnElement(element));
  }
  destroyActiveAnimationsForElement(element) {
    const players = this.playersByElement.get(element);
    if (players) {
      players.forEach((player) => {
        if (player.queued) {
          player.markedForDestroy = true;
        } else {
          player.destroy();
        }
      });
    }
  }
  finishActiveQueriedAnimationOnElement(element) {
    const players = this.playersByQueriedElement.get(element);
    if (players) {
      players.forEach((player) => player.finish());
    }
  }
  whenRenderingDone() {
    return new Promise((resolve) => {
      if (this.players.length) {
        return optimizeGroupPlayer(this.players).onDone(() => resolve());
      } else {
        resolve();
      }
    });
  }
  processLeaveNode(element) {
    const details = element[REMOVAL_FLAG];
    if (details && details.setForRemoval) {
      element[REMOVAL_FLAG] = NULL_REMOVAL_STATE;
      if (details.namespaceId) {
        this.destroyInnerAnimations(element);
        const ns = this._fetchNamespace(details.namespaceId);
        if (ns) {
          ns.clearElementCache(element);
        }
      }
      this._onRemovalComplete(element, details.setForRemoval);
    }
    if (element.classList?.contains(DISABLED_CLASSNAME)) {
      this.markElementAsDisabled(element, false);
    }
    this.driver.query(element, DISABLED_SELECTOR, true).forEach((node) => {
      this.markElementAsDisabled(node, false);
    });
  }
  flush(microtaskId = -1) {
    let players = [];
    if (this.newHostElements.size) {
      this.newHostElements.forEach((ns, element) => this._balanceNamespaceList(ns, element));
      this.newHostElements.clear();
    }
    if (this.totalAnimations && this.collectedEnterElements.length) {
      for (let i = 0; i < this.collectedEnterElements.length; i++) {
        const elm = this.collectedEnterElements[i];
        addClass(elm, STAR_CLASSNAME);
      }
    }
    if (this._namespaceList.length && (this.totalQueuedPlayers || this.collectedLeaveElements.length)) {
      const cleanupFns = [];
      try {
        players = this._flushAnimations(cleanupFns, microtaskId);
      } finally {
        for (let i = 0; i < cleanupFns.length; i++) {
          cleanupFns[i]();
        }
      }
    } else {
      for (let i = 0; i < this.collectedLeaveElements.length; i++) {
        const element = this.collectedLeaveElements[i];
        this.processLeaveNode(element);
      }
    }
    this.totalQueuedPlayers = 0;
    this.collectedEnterElements.length = 0;
    this.collectedLeaveElements.length = 0;
    this._flushFns.forEach((fn) => fn());
    this._flushFns = [];
    if (this._whenQuietFns.length) {
      const quietFns = this._whenQuietFns;
      this._whenQuietFns = [];
      if (players.length) {
        optimizeGroupPlayer(players).onDone(() => {
          quietFns.forEach((fn) => fn());
        });
      } else {
        quietFns.forEach((fn) => fn());
      }
    }
  }
  reportError(errors) {
    throw triggerTransitionsFailed(errors);
  }
  _flushAnimations(cleanupFns, microtaskId) {
    const subTimelines = new ElementInstructionMap();
    const skippedPlayers = [];
    const skippedPlayersMap = /* @__PURE__ */ new Map();
    const queuedInstructions = [];
    const queriedElements = /* @__PURE__ */ new Map();
    const allPreStyleElements = /* @__PURE__ */ new Map();
    const allPostStyleElements = /* @__PURE__ */ new Map();
    const disabledElementsSet = /* @__PURE__ */ new Set();
    this.disabledNodes.forEach((node) => {
      disabledElementsSet.add(node);
      const nodesThatAreDisabled = this.driver.query(node, QUEUED_SELECTOR, true);
      for (let i2 = 0; i2 < nodesThatAreDisabled.length; i2++) {
        disabledElementsSet.add(nodesThatAreDisabled[i2]);
      }
    });
    const bodyNode = this.bodyNode;
    const allTriggerElements = Array.from(this.statesByElement.keys());
    const enterNodeMap = buildRootMap(allTriggerElements, this.collectedEnterElements);
    const enterNodeMapIds = /* @__PURE__ */ new Map();
    let i = 0;
    enterNodeMap.forEach((nodes, root) => {
      const className = ENTER_CLASSNAME + i++;
      enterNodeMapIds.set(root, className);
      nodes.forEach((node) => addClass(node, className));
    });
    const allLeaveNodes = [];
    const mergedLeaveNodes = /* @__PURE__ */ new Set();
    const leaveNodesWithoutAnimations = /* @__PURE__ */ new Set();
    for (let i2 = 0; i2 < this.collectedLeaveElements.length; i2++) {
      const element = this.collectedLeaveElements[i2];
      const details = element[REMOVAL_FLAG];
      if (details && details.setForRemoval) {
        allLeaveNodes.push(element);
        mergedLeaveNodes.add(element);
        if (details.hasAnimation) {
          this.driver.query(element, STAR_SELECTOR, true).forEach((elm) => mergedLeaveNodes.add(elm));
        } else {
          leaveNodesWithoutAnimations.add(element);
        }
      }
    }
    const leaveNodeMapIds = /* @__PURE__ */ new Map();
    const leaveNodeMap = buildRootMap(allTriggerElements, Array.from(mergedLeaveNodes));
    leaveNodeMap.forEach((nodes, root) => {
      const className = LEAVE_CLASSNAME + i++;
      leaveNodeMapIds.set(root, className);
      nodes.forEach((node) => addClass(node, className));
    });
    cleanupFns.push(() => {
      enterNodeMap.forEach((nodes, root) => {
        const className = enterNodeMapIds.get(root);
        nodes.forEach((node) => removeClass(node, className));
      });
      leaveNodeMap.forEach((nodes, root) => {
        const className = leaveNodeMapIds.get(root);
        nodes.forEach((node) => removeClass(node, className));
      });
      allLeaveNodes.forEach((element) => {
        this.processLeaveNode(element);
      });
    });
    const allPlayers = [];
    const erroneousTransitions = [];
    for (let i2 = this._namespaceList.length - 1; i2 >= 0; i2--) {
      const ns = this._namespaceList[i2];
      ns.drainQueuedTransitions(microtaskId).forEach((entry) => {
        const player = entry.player;
        const element = entry.element;
        allPlayers.push(player);
        if (this.collectedEnterElements.length) {
          const details = element[REMOVAL_FLAG];
          if (details && details.setForMove) {
            if (details.previousTriggersValues && details.previousTriggersValues.has(entry.triggerName)) {
              const previousValue = details.previousTriggersValues.get(entry.triggerName);
              const triggersWithStates = this.statesByElement.get(entry.element);
              if (triggersWithStates && triggersWithStates.has(entry.triggerName)) {
                const state = triggersWithStates.get(entry.triggerName);
                state.value = previousValue;
                triggersWithStates.set(entry.triggerName, state);
              }
            }
            player.destroy();
            return;
          }
        }
        const nodeIsOrphaned = !bodyNode || !this.driver.containsElement(bodyNode, element);
        const leaveClassName = leaveNodeMapIds.get(element);
        const enterClassName = enterNodeMapIds.get(element);
        const instruction = this._buildInstruction(entry, subTimelines, enterClassName, leaveClassName, nodeIsOrphaned);
        if (instruction.errors && instruction.errors.length) {
          erroneousTransitions.push(instruction);
          return;
        }
        if (nodeIsOrphaned) {
          player.onStart(() => eraseStyles(element, instruction.fromStyles));
          player.onDestroy(() => setStyles(element, instruction.toStyles));
          skippedPlayers.push(player);
          return;
        }
        if (entry.isFallbackTransition) {
          player.onStart(() => eraseStyles(element, instruction.fromStyles));
          player.onDestroy(() => setStyles(element, instruction.toStyles));
          skippedPlayers.push(player);
          return;
        }
        const timelines = [];
        instruction.timelines.forEach((tl) => {
          tl.stretchStartingKeyframe = true;
          if (!this.disabledNodes.has(tl.element)) {
            timelines.push(tl);
          }
        });
        instruction.timelines = timelines;
        subTimelines.append(element, instruction.timelines);
        const tuple = {
          instruction,
          player,
          element
        };
        queuedInstructions.push(tuple);
        instruction.queriedElements.forEach((element2) => getOrSetDefaultValue(queriedElements, element2, []).push(player));
        instruction.preStyleProps.forEach((stringMap, element2) => {
          if (stringMap.size) {
            let setVal = allPreStyleElements.get(element2);
            if (!setVal) {
              allPreStyleElements.set(element2, setVal = /* @__PURE__ */ new Set());
            }
            stringMap.forEach((_, prop) => setVal.add(prop));
          }
        });
        instruction.postStyleProps.forEach((stringMap, element2) => {
          let setVal = allPostStyleElements.get(element2);
          if (!setVal) {
            allPostStyleElements.set(element2, setVal = /* @__PURE__ */ new Set());
          }
          stringMap.forEach((_, prop) => setVal.add(prop));
        });
      });
    }
    if (erroneousTransitions.length) {
      const errors = [];
      erroneousTransitions.forEach((instruction) => {
        errors.push(transitionFailed(instruction.triggerName, instruction.errors));
      });
      allPlayers.forEach((player) => player.destroy());
      this.reportError(errors);
    }
    const allPreviousPlayersMap = /* @__PURE__ */ new Map();
    const animationElementMap = /* @__PURE__ */ new Map();
    queuedInstructions.forEach((entry) => {
      const element = entry.element;
      if (subTimelines.has(element)) {
        animationElementMap.set(element, element);
        this._beforeAnimationBuild(entry.player.namespaceId, entry.instruction, allPreviousPlayersMap);
      }
    });
    skippedPlayers.forEach((player) => {
      const element = player.element;
      const previousPlayers = this._getPreviousPlayers(element, false, player.namespaceId, player.triggerName, null);
      previousPlayers.forEach((prevPlayer) => {
        getOrSetDefaultValue(allPreviousPlayersMap, element, []).push(prevPlayer);
        prevPlayer.destroy();
      });
    });
    const replaceNodes = allLeaveNodes.filter((node) => {
      return replacePostStylesAsPre(node, allPreStyleElements, allPostStyleElements);
    });
    const postStylesMap = /* @__PURE__ */ new Map();
    const allLeaveQueriedNodes = cloakAndComputeStyles(postStylesMap, this.driver, leaveNodesWithoutAnimations, allPostStyleElements, AUTO_STYLE);
    allLeaveQueriedNodes.forEach((node) => {
      if (replacePostStylesAsPre(node, allPreStyleElements, allPostStyleElements)) {
        replaceNodes.push(node);
      }
    });
    const preStylesMap = /* @__PURE__ */ new Map();
    enterNodeMap.forEach((nodes, root) => {
      cloakAndComputeStyles(preStylesMap, this.driver, new Set(nodes), allPreStyleElements, \u0275PRE_STYLE);
    });
    replaceNodes.forEach((node) => {
      const post = postStylesMap.get(node);
      const pre = preStylesMap.get(node);
      postStylesMap.set(node, new Map([...post?.entries() ?? [], ...pre?.entries() ?? []]));
    });
    const rootPlayers = [];
    const subPlayers = [];
    const NO_PARENT_ANIMATION_ELEMENT_DETECTED = {};
    queuedInstructions.forEach((entry) => {
      const {
        element,
        player,
        instruction
      } = entry;
      if (subTimelines.has(element)) {
        if (disabledElementsSet.has(element)) {
          player.onDestroy(() => setStyles(element, instruction.toStyles));
          player.disabled = true;
          player.overrideTotalTime(instruction.totalTime);
          skippedPlayers.push(player);
          return;
        }
        let parentWithAnimation = NO_PARENT_ANIMATION_ELEMENT_DETECTED;
        if (animationElementMap.size > 1) {
          let elm = element;
          const parentsToAdd = [];
          while (elm = elm.parentNode) {
            const detectedParent = animationElementMap.get(elm);
            if (detectedParent) {
              parentWithAnimation = detectedParent;
              break;
            }
            parentsToAdd.push(elm);
          }
          parentsToAdd.forEach((parent) => animationElementMap.set(parent, parentWithAnimation));
        }
        const innerPlayer = this._buildAnimation(player.namespaceId, instruction, allPreviousPlayersMap, skippedPlayersMap, preStylesMap, postStylesMap);
        player.setRealPlayer(innerPlayer);
        if (parentWithAnimation === NO_PARENT_ANIMATION_ELEMENT_DETECTED) {
          rootPlayers.push(player);
        } else {
          const parentPlayers = this.playersByElement.get(parentWithAnimation);
          if (parentPlayers && parentPlayers.length) {
            player.parentPlayer = optimizeGroupPlayer(parentPlayers);
          }
          skippedPlayers.push(player);
        }
      } else {
        eraseStyles(element, instruction.fromStyles);
        player.onDestroy(() => setStyles(element, instruction.toStyles));
        subPlayers.push(player);
        if (disabledElementsSet.has(element)) {
          skippedPlayers.push(player);
        }
      }
    });
    subPlayers.forEach((player) => {
      const playersForElement = skippedPlayersMap.get(player.element);
      if (playersForElement && playersForElement.length) {
        const innerPlayer = optimizeGroupPlayer(playersForElement);
        player.setRealPlayer(innerPlayer);
      }
    });
    skippedPlayers.forEach((player) => {
      if (player.parentPlayer) {
        player.syncPlayerEvents(player.parentPlayer);
      } else {
        player.destroy();
      }
    });
    for (let i2 = 0; i2 < allLeaveNodes.length; i2++) {
      const element = allLeaveNodes[i2];
      const details = element[REMOVAL_FLAG];
      removeClass(element, LEAVE_CLASSNAME);
      if (details && details.hasAnimation) continue;
      let players = [];
      if (queriedElements.size) {
        let queriedPlayerResults = queriedElements.get(element);
        if (queriedPlayerResults && queriedPlayerResults.length) {
          players.push(...queriedPlayerResults);
        }
        let queriedInnerElements = this.driver.query(element, NG_ANIMATING_SELECTOR, true);
        for (let j = 0; j < queriedInnerElements.length; j++) {
          let queriedPlayers = queriedElements.get(queriedInnerElements[j]);
          if (queriedPlayers && queriedPlayers.length) {
            players.push(...queriedPlayers);
          }
        }
      }
      const activePlayers = players.filter((p) => !p.destroyed);
      if (activePlayers.length) {
        removeNodesAfterAnimationDone(this, element, activePlayers);
      } else {
        this.processLeaveNode(element);
      }
    }
    allLeaveNodes.length = 0;
    rootPlayers.forEach((player) => {
      this.players.push(player);
      player.onDone(() => {
        player.destroy();
        const index = this.players.indexOf(player);
        this.players.splice(index, 1);
      });
      player.play();
    });
    return rootPlayers;
  }
  afterFlush(callback) {
    this._flushFns.push(callback);
  }
  afterFlushAnimationsDone(callback) {
    this._whenQuietFns.push(callback);
  }
  _getPreviousPlayers(element, isQueriedElement, namespaceId, triggerName, toStateValue) {
    let players = [];
    if (isQueriedElement) {
      const queriedElementPlayers = this.playersByQueriedElement.get(element);
      if (queriedElementPlayers) {
        players = queriedElementPlayers;
      }
    } else {
      const elementPlayers = this.playersByElement.get(element);
      if (elementPlayers) {
        const isRemovalAnimation = !toStateValue || toStateValue == VOID_VALUE;
        elementPlayers.forEach((player) => {
          if (player.queued) return;
          if (!isRemovalAnimation && player.triggerName != triggerName) return;
          players.push(player);
        });
      }
    }
    if (namespaceId || triggerName) {
      players = players.filter((player) => {
        if (namespaceId && namespaceId != player.namespaceId) return false;
        if (triggerName && triggerName != player.triggerName) return false;
        return true;
      });
    }
    return players;
  }
  _beforeAnimationBuild(namespaceId, instruction, allPreviousPlayersMap) {
    const triggerName = instruction.triggerName;
    const rootElement = instruction.element;
    const targetNameSpaceId = instruction.isRemovalTransition ? void 0 : namespaceId;
    const targetTriggerName = instruction.isRemovalTransition ? void 0 : triggerName;
    for (const timelineInstruction of instruction.timelines) {
      const element = timelineInstruction.element;
      const isQueriedElement = element !== rootElement;
      const players = getOrSetDefaultValue(allPreviousPlayersMap, element, []);
      const previousPlayers = this._getPreviousPlayers(element, isQueriedElement, targetNameSpaceId, targetTriggerName, instruction.toState);
      previousPlayers.forEach((player) => {
        const realPlayer = player.getRealPlayer();
        if (realPlayer.beforeDestroy) {
          realPlayer.beforeDestroy();
        }
        player.destroy();
        players.push(player);
      });
    }
    eraseStyles(rootElement, instruction.fromStyles);
  }
  _buildAnimation(namespaceId, instruction, allPreviousPlayersMap, skippedPlayersMap, preStylesMap, postStylesMap) {
    const triggerName = instruction.triggerName;
    const rootElement = instruction.element;
    const allQueriedPlayers = [];
    const allConsumedElements = /* @__PURE__ */ new Set();
    const allSubElements = /* @__PURE__ */ new Set();
    const allNewPlayers = instruction.timelines.map((timelineInstruction) => {
      const element = timelineInstruction.element;
      allConsumedElements.add(element);
      const details = element[REMOVAL_FLAG];
      if (details && details.removedBeforeQueried) return new NoopAnimationPlayer(timelineInstruction.duration, timelineInstruction.delay);
      const isQueriedElement = element !== rootElement;
      const previousPlayers = flattenGroupPlayers((allPreviousPlayersMap.get(element) || EMPTY_PLAYER_ARRAY).map((p) => p.getRealPlayer())).filter((p) => {
        const pp = p;
        return pp.element ? pp.element === element : false;
      });
      const preStyles = preStylesMap.get(element);
      const postStyles = postStylesMap.get(element);
      const keyframes = normalizeKeyframes$1(this._normalizer, timelineInstruction.keyframes, preStyles, postStyles);
      const player2 = this._buildPlayer(timelineInstruction, keyframes, previousPlayers);
      if (timelineInstruction.subTimeline && skippedPlayersMap) {
        allSubElements.add(element);
      }
      if (isQueriedElement) {
        const wrappedPlayer = new TransitionAnimationPlayer(namespaceId, triggerName, element);
        wrappedPlayer.setRealPlayer(player2);
        allQueriedPlayers.push(wrappedPlayer);
      }
      return player2;
    });
    allQueriedPlayers.forEach((player2) => {
      getOrSetDefaultValue(this.playersByQueriedElement, player2.element, []).push(player2);
      player2.onDone(() => deleteOrUnsetInMap(this.playersByQueriedElement, player2.element, player2));
    });
    allConsumedElements.forEach((element) => addClass(element, NG_ANIMATING_CLASSNAME));
    const player = optimizeGroupPlayer(allNewPlayers);
    player.onDestroy(() => {
      allConsumedElements.forEach((element) => removeClass(element, NG_ANIMATING_CLASSNAME));
      setStyles(rootElement, instruction.toStyles);
    });
    allSubElements.forEach((element) => {
      getOrSetDefaultValue(skippedPlayersMap, element, []).push(player);
    });
    return player;
  }
  _buildPlayer(instruction, keyframes, previousPlayers) {
    if (keyframes.length > 0) {
      return this.driver.animate(instruction.element, keyframes, instruction.duration, instruction.delay, instruction.easing, previousPlayers);
    }
    return new NoopAnimationPlayer(instruction.duration, instruction.delay);
  }
};
var TransitionAnimationPlayer = class {
  namespaceId;
  triggerName;
  element;
  _player = new NoopAnimationPlayer();
  _containsRealPlayer = false;
  _queuedCallbacks = /* @__PURE__ */ new Map();
  destroyed = false;
  parentPlayer = null;
  markedForDestroy = false;
  disabled = false;
  queued = true;
  totalTime = 0;
  constructor(namespaceId, triggerName, element) {
    this.namespaceId = namespaceId;
    this.triggerName = triggerName;
    this.element = element;
  }
  setRealPlayer(player) {
    if (this._containsRealPlayer) return;
    this._player = player;
    this._queuedCallbacks.forEach((callbacks, phase) => {
      callbacks.forEach((callback) => listenOnPlayer(player, phase, void 0, callback));
    });
    this._queuedCallbacks.clear();
    this._containsRealPlayer = true;
    this.overrideTotalTime(player.totalTime);
    this.queued = false;
  }
  getRealPlayer() {
    return this._player;
  }
  overrideTotalTime(totalTime) {
    this.totalTime = totalTime;
  }
  syncPlayerEvents(player) {
    const p = this._player;
    if (p.triggerCallback) {
      player.onStart(() => p.triggerCallback("start"));
    }
    player.onDone(() => this.finish());
    player.onDestroy(() => this.destroy());
  }
  _queueEvent(name, callback) {
    getOrSetDefaultValue(this._queuedCallbacks, name, []).push(callback);
  }
  onDone(fn) {
    if (this.queued) {
      this._queueEvent("done", fn);
    }
    this._player.onDone(fn);
  }
  onStart(fn) {
    if (this.queued) {
      this._queueEvent("start", fn);
    }
    this._player.onStart(fn);
  }
  onDestroy(fn) {
    if (this.queued) {
      this._queueEvent("destroy", fn);
    }
    this._player.onDestroy(fn);
  }
  init() {
    this._player.init();
  }
  hasStarted() {
    return this.queued ? false : this._player.hasStarted();
  }
  play() {
    !this.queued && this._player.play();
  }
  pause() {
    !this.queued && this._player.pause();
  }
  restart() {
    !this.queued && this._player.restart();
  }
  finish() {
    this._player.finish();
  }
  destroy() {
    this.destroyed = true;
    this._player.destroy();
  }
  reset() {
    !this.queued && this._player.reset();
  }
  setPosition(p) {
    if (!this.queued) {
      this._player.setPosition(p);
    }
  }
  getPosition() {
    return this.queued ? 0 : this._player.getPosition();
  }
  /** @internal */
  triggerCallback(phaseName) {
    const p = this._player;
    if (p.triggerCallback) {
      p.triggerCallback(phaseName);
    }
  }
};
function deleteOrUnsetInMap(map2, key, value) {
  let currentValues = map2.get(key);
  if (currentValues) {
    if (currentValues.length) {
      const index = currentValues.indexOf(value);
      currentValues.splice(index, 1);
    }
    if (currentValues.length == 0) {
      map2.delete(key);
    }
  }
  return currentValues;
}
function normalizeTriggerValue(value) {
  return value != null ? value : null;
}
function isElementNode(node) {
  return node && node["nodeType"] === 1;
}
function isTriggerEventValid(eventName) {
  return eventName == "start" || eventName == "done";
}
function cloakElement(element, value) {
  const oldValue = element.style.display;
  element.style.display = value != null ? value : "none";
  return oldValue;
}
function cloakAndComputeStyles(valuesMap, driver, elements, elementPropsMap, defaultStyle) {
  const cloakVals = [];
  elements.forEach((element) => cloakVals.push(cloakElement(element)));
  const failedElements = [];
  elementPropsMap.forEach((props, element) => {
    const styles = /* @__PURE__ */ new Map();
    props.forEach((prop) => {
      const value = driver.computeStyle(element, prop, defaultStyle);
      styles.set(prop, value);
      if (!value || value.length == 0) {
        element[REMOVAL_FLAG] = NULL_REMOVED_QUERIED_STATE;
        failedElements.push(element);
      }
    });
    valuesMap.set(element, styles);
  });
  let i = 0;
  elements.forEach((element) => cloakElement(element, cloakVals[i++]));
  return failedElements;
}
function buildRootMap(roots, nodes) {
  const rootMap = /* @__PURE__ */ new Map();
  roots.forEach((root) => rootMap.set(root, []));
  if (nodes.length == 0) return rootMap;
  const NULL_NODE = 1;
  const nodeSet = new Set(nodes);
  const localRootMap = /* @__PURE__ */ new Map();
  function getRoot(node) {
    if (!node) return NULL_NODE;
    let root = localRootMap.get(node);
    if (root) return root;
    const parent = node.parentNode;
    if (rootMap.has(parent)) {
      root = parent;
    } else if (nodeSet.has(parent)) {
      root = NULL_NODE;
    } else {
      root = getRoot(parent);
    }
    localRootMap.set(node, root);
    return root;
  }
  nodes.forEach((node) => {
    const root = getRoot(node);
    if (root !== NULL_NODE) {
      rootMap.get(root).push(node);
    }
  });
  return rootMap;
}
function addClass(element, className) {
  element.classList?.add(className);
}
function removeClass(element, className) {
  element.classList?.remove(className);
}
function removeNodesAfterAnimationDone(engine, element, players) {
  optimizeGroupPlayer(players).onDone(() => engine.processLeaveNode(element));
}
function flattenGroupPlayers(players) {
  const finalPlayers = [];
  _flattenGroupPlayersRecur(players, finalPlayers);
  return finalPlayers;
}
function _flattenGroupPlayersRecur(players, finalPlayers) {
  for (let i = 0; i < players.length; i++) {
    const player = players[i];
    if (player instanceof AnimationGroupPlayer) {
      _flattenGroupPlayersRecur(player.players, finalPlayers);
    } else {
      finalPlayers.push(player);
    }
  }
}
function objEquals(a, b) {
  const k1 = Object.keys(a);
  const k2 = Object.keys(b);
  if (k1.length != k2.length) return false;
  for (let i = 0; i < k1.length; i++) {
    const prop = k1[i];
    if (!b.hasOwnProperty(prop) || a[prop] !== b[prop]) return false;
  }
  return true;
}
function replacePostStylesAsPre(element, allPreStyleElements, allPostStyleElements) {
  const postEntry = allPostStyleElements.get(element);
  if (!postEntry) return false;
  let preEntry = allPreStyleElements.get(element);
  if (preEntry) {
    postEntry.forEach((data) => preEntry.add(data));
  } else {
    allPreStyleElements.set(element, postEntry);
  }
  allPostStyleElements.delete(element);
  return true;
}
var AnimationEngine = class {
  _driver;
  _normalizer;
  _transitionEngine;
  _timelineEngine;
  _triggerCache = {};
  // this method is designed to be overridden by the code that uses this engine
  onRemovalComplete = (element, context) => {
  };
  constructor(doc, _driver, _normalizer) {
    this._driver = _driver;
    this._normalizer = _normalizer;
    this._transitionEngine = new TransitionAnimationEngine(doc.body, _driver, _normalizer);
    this._timelineEngine = new TimelineAnimationEngine(doc.body, _driver, _normalizer);
    this._transitionEngine.onRemovalComplete = (element, context) => this.onRemovalComplete(element, context);
  }
  registerTrigger(componentId, namespaceId, hostElement, name, metadata) {
    const cacheKey = componentId + "-" + name;
    let trigger = this._triggerCache[cacheKey];
    if (!trigger) {
      const errors = [];
      const warnings = [];
      const ast = buildAnimationAst(this._driver, metadata, errors, warnings);
      if (errors.length) {
        throw triggerBuildFailed(name, errors);
      }
      if (typeof ngDevMode === "undefined" || ngDevMode) {
        if (warnings.length) {
          warnTriggerBuild(name, warnings);
        }
      }
      trigger = buildTrigger(name, ast, this._normalizer);
      this._triggerCache[cacheKey] = trigger;
    }
    this._transitionEngine.registerTrigger(namespaceId, name, trigger);
  }
  register(namespaceId, hostElement) {
    this._transitionEngine.register(namespaceId, hostElement);
  }
  destroy(namespaceId, context) {
    this._transitionEngine.destroy(namespaceId, context);
  }
  onInsert(namespaceId, element, parent, insertBefore) {
    this._transitionEngine.insertNode(namespaceId, element, parent, insertBefore);
  }
  onRemove(namespaceId, element, context) {
    this._transitionEngine.removeNode(namespaceId, element, context);
  }
  disableAnimations(element, disable) {
    this._transitionEngine.markElementAsDisabled(element, disable);
  }
  process(namespaceId, element, property, value) {
    if (property.charAt(0) == "@") {
      const [id, action] = parseTimelineCommand(property);
      const args = value;
      this._timelineEngine.command(id, element, action, args);
    } else {
      this._transitionEngine.trigger(namespaceId, element, property, value);
    }
  }
  listen(namespaceId, element, eventName, eventPhase, callback) {
    if (eventName.charAt(0) == "@") {
      const [id, action] = parseTimelineCommand(eventName);
      return this._timelineEngine.listen(id, element, action, callback);
    }
    return this._transitionEngine.listen(namespaceId, element, eventName, eventPhase, callback);
  }
  flush(microtaskId = -1) {
    this._transitionEngine.flush(microtaskId);
  }
  get players() {
    return [...this._transitionEngine.players, ...this._timelineEngine.players];
  }
  whenRenderingDone() {
    return this._transitionEngine.whenRenderingDone();
  }
  afterFlushAnimationsDone(cb) {
    this._transitionEngine.afterFlushAnimationsDone(cb);
  }
};
function packageNonAnimatableStyles(element, styles) {
  let startStyles = null;
  let endStyles = null;
  if (Array.isArray(styles) && styles.length) {
    startStyles = filterNonAnimatableStyles(styles[0]);
    if (styles.length > 1) {
      endStyles = filterNonAnimatableStyles(styles[styles.length - 1]);
    }
  } else if (styles instanceof Map) {
    startStyles = filterNonAnimatableStyles(styles);
  }
  return startStyles || endStyles ? new SpecialCasedStyles(element, startStyles, endStyles) : null;
}
var SpecialCasedStyles = class _SpecialCasedStyles {
  _element;
  _startStyles;
  _endStyles;
  static initialStylesByElement = /* @__PURE__ */ new WeakMap();
  _state = 0;
  _initialStyles;
  constructor(_element, _startStyles, _endStyles) {
    this._element = _element;
    this._startStyles = _startStyles;
    this._endStyles = _endStyles;
    let initialStyles = _SpecialCasedStyles.initialStylesByElement.get(_element);
    if (!initialStyles) {
      _SpecialCasedStyles.initialStylesByElement.set(_element, initialStyles = /* @__PURE__ */ new Map());
    }
    this._initialStyles = initialStyles;
  }
  start() {
    if (this._state < 1) {
      if (this._startStyles) {
        setStyles(this._element, this._startStyles, this._initialStyles);
      }
      this._state = 1;
    }
  }
  finish() {
    this.start();
    if (this._state < 2) {
      setStyles(this._element, this._initialStyles);
      if (this._endStyles) {
        setStyles(this._element, this._endStyles);
        this._endStyles = null;
      }
      this._state = 1;
    }
  }
  destroy() {
    this.finish();
    if (this._state < 3) {
      _SpecialCasedStyles.initialStylesByElement.delete(this._element);
      if (this._startStyles) {
        eraseStyles(this._element, this._startStyles);
        this._endStyles = null;
      }
      if (this._endStyles) {
        eraseStyles(this._element, this._endStyles);
        this._endStyles = null;
      }
      setStyles(this._element, this._initialStyles);
      this._state = 3;
    }
  }
};
function filterNonAnimatableStyles(styles) {
  let result = null;
  styles.forEach((val, prop) => {
    if (isNonAnimatableStyle(prop)) {
      result = result || /* @__PURE__ */ new Map();
      result.set(prop, val);
    }
  });
  return result;
}
function isNonAnimatableStyle(prop) {
  return prop === "display" || prop === "position";
}
var WebAnimationsPlayer = class {
  element;
  keyframes;
  options;
  _specialStyles;
  _onDoneFns = [];
  _onStartFns = [];
  _onDestroyFns = [];
  _duration;
  _delay;
  _initialized = false;
  _finished = false;
  _started = false;
  _destroyed = false;
  _finalKeyframe;
  // the following original fns are persistent copies of the _onStartFns and _onDoneFns
  // and are used to reset the fns to their original values upon reset()
  // (since the _onStartFns and _onDoneFns get deleted after they are called)
  _originalOnDoneFns = [];
  _originalOnStartFns = [];
  // using non-null assertion because it's re(set) by init();
  domPlayer;
  time = 0;
  parentPlayer = null;
  currentSnapshot = /* @__PURE__ */ new Map();
  constructor(element, keyframes, options, _specialStyles) {
    this.element = element;
    this.keyframes = keyframes;
    this.options = options;
    this._specialStyles = _specialStyles;
    this._duration = options["duration"];
    this._delay = options["delay"] || 0;
    this.time = this._duration + this._delay;
  }
  _onFinish() {
    if (!this._finished) {
      this._finished = true;
      this._onDoneFns.forEach((fn) => fn());
      this._onDoneFns = [];
    }
  }
  init() {
    this._buildPlayer();
    this._preparePlayerBeforeStart();
  }
  _buildPlayer() {
    if (this._initialized) return;
    this._initialized = true;
    const keyframes = this.keyframes;
    this.domPlayer = this._triggerWebAnimation(this.element, keyframes, this.options);
    this._finalKeyframe = keyframes.length ? keyframes[keyframes.length - 1] : /* @__PURE__ */ new Map();
    const onFinish = () => this._onFinish();
    this.domPlayer.addEventListener("finish", onFinish);
    this.onDestroy(() => {
      this.domPlayer.removeEventListener("finish", onFinish);
    });
  }
  _preparePlayerBeforeStart() {
    if (this._delay) {
      this._resetDomPlayerState();
    } else {
      this.domPlayer.pause();
    }
  }
  _convertKeyframesToObject(keyframes) {
    const kfs = [];
    keyframes.forEach((frame) => {
      kfs.push(Object.fromEntries(frame));
    });
    return kfs;
  }
  /** @internal */
  _triggerWebAnimation(element, keyframes, options) {
    return element.animate(this._convertKeyframesToObject(keyframes), options);
  }
  onStart(fn) {
    this._originalOnStartFns.push(fn);
    this._onStartFns.push(fn);
  }
  onDone(fn) {
    this._originalOnDoneFns.push(fn);
    this._onDoneFns.push(fn);
  }
  onDestroy(fn) {
    this._onDestroyFns.push(fn);
  }
  play() {
    this._buildPlayer();
    if (!this.hasStarted()) {
      this._onStartFns.forEach((fn) => fn());
      this._onStartFns = [];
      this._started = true;
      if (this._specialStyles) {
        this._specialStyles.start();
      }
    }
    this.domPlayer.play();
  }
  pause() {
    this.init();
    this.domPlayer.pause();
  }
  finish() {
    this.init();
    if (this._specialStyles) {
      this._specialStyles.finish();
    }
    this._onFinish();
    this.domPlayer.finish();
  }
  reset() {
    this._resetDomPlayerState();
    this._destroyed = false;
    this._finished = false;
    this._started = false;
    this._onStartFns = this._originalOnStartFns;
    this._onDoneFns = this._originalOnDoneFns;
  }
  _resetDomPlayerState() {
    if (this.domPlayer) {
      this.domPlayer.cancel();
    }
  }
  restart() {
    this.reset();
    this.play();
  }
  hasStarted() {
    return this._started;
  }
  destroy() {
    if (!this._destroyed) {
      this._destroyed = true;
      this._resetDomPlayerState();
      this._onFinish();
      if (this._specialStyles) {
        this._specialStyles.destroy();
      }
      this._onDestroyFns.forEach((fn) => fn());
      this._onDestroyFns = [];
    }
  }
  setPosition(p) {
    if (this.domPlayer === void 0) {
      this.init();
    }
    this.domPlayer.currentTime = p * this.time;
  }
  getPosition() {
    return +(this.domPlayer.currentTime ?? 0) / this.time;
  }
  get totalTime() {
    return this._delay + this._duration;
  }
  beforeDestroy() {
    const styles = /* @__PURE__ */ new Map();
    if (this.hasStarted()) {
      const finalKeyframe = this._finalKeyframe;
      finalKeyframe.forEach((val, prop) => {
        if (prop !== "offset") {
          styles.set(prop, this._finished ? val : computeStyle(this.element, prop));
        }
      });
    }
    this.currentSnapshot = styles;
  }
  /** @internal */
  triggerCallback(phaseName) {
    const methods = phaseName === "start" ? this._onStartFns : this._onDoneFns;
    methods.forEach((fn) => fn());
    methods.length = 0;
  }
};
var WebAnimationsDriver = class {
  validateStyleProperty(prop) {
    if (typeof ngDevMode === "undefined" || ngDevMode) {
      return validateStyleProperty(prop);
    }
    return true;
  }
  validateAnimatableStyleProperty(prop) {
    if (typeof ngDevMode === "undefined" || ngDevMode) {
      const cssProp = camelCaseToDashCase(prop);
      return validateWebAnimatableStyleProperty(cssProp);
    }
    return true;
  }
  containsElement(elm1, elm2) {
    return containsElement(elm1, elm2);
  }
  getParentElement(element) {
    return getParentElement(element);
  }
  query(element, selector, multi) {
    return invokeQuery(element, selector, multi);
  }
  computeStyle(element, prop, defaultValue) {
    return computeStyle(element, prop);
  }
  animate(element, keyframes, duration, delay, easing, previousPlayers = []) {
    const fill2 = delay == 0 ? "both" : "forwards";
    const playerOptions = {
      duration,
      delay,
      fill: fill2
    };
    if (easing) {
      playerOptions["easing"] = easing;
    }
    const previousStyles = /* @__PURE__ */ new Map();
    const previousWebAnimationPlayers = previousPlayers.filter((player) => player instanceof WebAnimationsPlayer);
    if (allowPreviousPlayerStylesMerge(duration, delay)) {
      previousWebAnimationPlayers.forEach((player) => {
        player.currentSnapshot.forEach((val, prop) => previousStyles.set(prop, val));
      });
    }
    let _keyframes = normalizeKeyframes(keyframes).map((styles) => new Map(styles));
    _keyframes = balancePreviousStylesIntoKeyframes(element, _keyframes, previousStyles);
    const specialStyles = packageNonAnimatableStyles(element, _keyframes);
    return new WebAnimationsPlayer(element, _keyframes, playerOptions, specialStyles);
  }
};
var ANIMATION_PREFIX = "@";
var DISABLE_ANIMATIONS_FLAG = "@.disabled";
var BaseAnimationRenderer = class {
  namespaceId;
  delegate;
  engine;
  _onDestroy;
  // We need to explicitly type this property because of an api-extractor bug
  // See https://github.com/microsoft/rushstack/issues/4390
  \u0275type = 0;
  constructor(namespaceId, delegate, engine, _onDestroy) {
    this.namespaceId = namespaceId;
    this.delegate = delegate;
    this.engine = engine;
    this._onDestroy = _onDestroy;
  }
  get data() {
    return this.delegate.data;
  }
  destroyNode(node) {
    this.delegate.destroyNode?.(node);
  }
  destroy() {
    this.engine.destroy(this.namespaceId, this.delegate);
    this.engine.afterFlushAnimationsDone(() => {
      queueMicrotask(() => {
        this.delegate.destroy();
      });
    });
    this._onDestroy?.();
  }
  createElement(name, namespace) {
    return this.delegate.createElement(name, namespace);
  }
  createComment(value) {
    return this.delegate.createComment(value);
  }
  createText(value) {
    return this.delegate.createText(value);
  }
  appendChild(parent, newChild) {
    this.delegate.appendChild(parent, newChild);
    this.engine.onInsert(this.namespaceId, newChild, parent, false);
  }
  insertBefore(parent, newChild, refChild, isMove = true) {
    this.delegate.insertBefore(parent, newChild, refChild);
    this.engine.onInsert(this.namespaceId, newChild, parent, isMove);
  }
  removeChild(parent, oldChild, isHostElement) {
    if (this.parentNode(oldChild)) {
      this.engine.onRemove(this.namespaceId, oldChild, this.delegate);
    }
  }
  selectRootElement(selectorOrNode, preserveContent) {
    return this.delegate.selectRootElement(selectorOrNode, preserveContent);
  }
  parentNode(node) {
    return this.delegate.parentNode(node);
  }
  nextSibling(node) {
    return this.delegate.nextSibling(node);
  }
  setAttribute(el, name, value, namespace) {
    this.delegate.setAttribute(el, name, value, namespace);
  }
  removeAttribute(el, name, namespace) {
    this.delegate.removeAttribute(el, name, namespace);
  }
  addClass(el, name) {
    this.delegate.addClass(el, name);
  }
  removeClass(el, name) {
    this.delegate.removeClass(el, name);
  }
  setStyle(el, style2, value, flags) {
    this.delegate.setStyle(el, style2, value, flags);
  }
  removeStyle(el, style2, flags) {
    this.delegate.removeStyle(el, style2, flags);
  }
  setProperty(el, name, value) {
    if (name.charAt(0) == ANIMATION_PREFIX && name == DISABLE_ANIMATIONS_FLAG) {
      this.disableAnimations(el, !!value);
    } else {
      this.delegate.setProperty(el, name, value);
    }
  }
  setValue(node, value) {
    this.delegate.setValue(node, value);
  }
  listen(target, eventName, callback, options) {
    return this.delegate.listen(target, eventName, callback, options);
  }
  disableAnimations(element, value) {
    this.engine.disableAnimations(element, value);
  }
};
var AnimationRenderer = class extends BaseAnimationRenderer {
  factory;
  constructor(factory, namespaceId, delegate, engine, onDestroy) {
    super(namespaceId, delegate, engine, onDestroy);
    this.factory = factory;
    this.namespaceId = namespaceId;
  }
  setProperty(el, name, value) {
    if (name.charAt(0) == ANIMATION_PREFIX) {
      if (name.charAt(1) == "." && name == DISABLE_ANIMATIONS_FLAG) {
        value = value === void 0 ? true : !!value;
        this.disableAnimations(el, value);
      } else {
        this.engine.process(this.namespaceId, el, name.slice(1), value);
      }
    } else {
      this.delegate.setProperty(el, name, value);
    }
  }
  listen(target, eventName, callback, options) {
    if (eventName.charAt(0) == ANIMATION_PREFIX) {
      const element = resolveElementFromTarget(target);
      let name = eventName.slice(1);
      let phase = "";
      if (name.charAt(0) != ANIMATION_PREFIX) {
        [name, phase] = parseTriggerCallbackName(name);
      }
      return this.engine.listen(this.namespaceId, element, name, phase, (event) => {
        const countId = event["_data"] || -1;
        this.factory.scheduleListenerCallback(countId, callback, event);
      });
    }
    return this.delegate.listen(target, eventName, callback, options);
  }
};
function resolveElementFromTarget(target) {
  switch (target) {
    case "body":
      return document.body;
    case "document":
      return document;
    case "window":
      return window;
    default:
      return target;
  }
}
function parseTriggerCallbackName(triggerName) {
  const dotIndex = triggerName.indexOf(".");
  const trigger = triggerName.substring(0, dotIndex);
  const phase = triggerName.slice(dotIndex + 1);
  return [trigger, phase];
}
var AnimationRendererFactory = class {
  delegate;
  engine;
  _zone;
  _currentId = 0;
  _microtaskId = 1;
  _animationCallbacksBuffer = [];
  _rendererCache = /* @__PURE__ */ new Map();
  _cdRecurDepth = 0;
  constructor(delegate, engine, _zone) {
    this.delegate = delegate;
    this.engine = engine;
    this._zone = _zone;
    engine.onRemovalComplete = (element, delegate2) => {
      delegate2?.removeChild(null, element);
    };
  }
  createRenderer(hostElement, type) {
    const EMPTY_NAMESPACE_ID = "";
    const delegate = this.delegate.createRenderer(hostElement, type);
    if (!hostElement || !type?.data?.["animation"]) {
      const cache = this._rendererCache;
      let renderer = cache.get(delegate);
      if (!renderer) {
        const onRendererDestroy = () => cache.delete(delegate);
        renderer = new BaseAnimationRenderer(EMPTY_NAMESPACE_ID, delegate, this.engine, onRendererDestroy);
        cache.set(delegate, renderer);
      }
      return renderer;
    }
    const componentId = type.id;
    const namespaceId = type.id + "-" + this._currentId;
    this._currentId++;
    this.engine.register(namespaceId, hostElement);
    const registerTrigger = (trigger) => {
      if (Array.isArray(trigger)) {
        trigger.forEach(registerTrigger);
      } else {
        this.engine.registerTrigger(componentId, namespaceId, hostElement, trigger.name, trigger);
      }
    };
    const animationTriggers = type.data["animation"];
    animationTriggers.forEach(registerTrigger);
    return new AnimationRenderer(this, namespaceId, delegate, this.engine);
  }
  begin() {
    this._cdRecurDepth++;
    if (this.delegate.begin) {
      this.delegate.begin();
    }
  }
  _scheduleCountTask() {
    queueMicrotask(() => {
      this._microtaskId++;
    });
  }
  /** @internal */
  scheduleListenerCallback(count, fn, data) {
    if (count >= 0 && count < this._microtaskId) {
      this._zone.run(() => fn(data));
      return;
    }
    const animationCallbacksBuffer = this._animationCallbacksBuffer;
    if (animationCallbacksBuffer.length == 0) {
      queueMicrotask(() => {
        this._zone.run(() => {
          animationCallbacksBuffer.forEach((tuple) => {
            const [fn2, data2] = tuple;
            fn2(data2);
          });
          this._animationCallbacksBuffer = [];
        });
      });
    }
    animationCallbacksBuffer.push([fn, data]);
  }
  end() {
    this._cdRecurDepth--;
    if (this._cdRecurDepth == 0) {
      this._zone.runOutsideAngular(() => {
        this._scheduleCountTask();
        this.engine.flush(this._microtaskId);
      });
    }
    if (this.delegate.end) {
      this.delegate.end();
    }
  }
  whenRenderingDone() {
    return this.engine.whenRenderingDone();
  }
  /**
   * Used during HMR to clear any cached data about a component.
   * @param componentId ID of the component that is being replaced.
   */
  componentReplaced(componentId) {
    this.engine.flush();
    this.delegate.componentReplaced?.(componentId);
  }
};

// node_modules/@angular/platform-browser/fesm2022/animations.mjs
var InjectableAnimationEngine = class _InjectableAnimationEngine extends AnimationEngine {
  // The `ApplicationRef` is injected here explicitly to force the dependency ordering.
  // Since the `ApplicationRef` should be created earlier before the `AnimationEngine`, they
  // both have `ngOnDestroy` hooks and `flush()` must be called after all views are destroyed.
  constructor(doc, driver, normalizer) {
    super(doc, driver, normalizer);
  }
  ngOnDestroy() {
    this.flush();
  }
  static \u0275fac = function InjectableAnimationEngine_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _InjectableAnimationEngine)(\u0275\u0275inject(DOCUMENT), \u0275\u0275inject(AnimationDriver), \u0275\u0275inject(AnimationStyleNormalizer));
  };
  static \u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
    token: _InjectableAnimationEngine,
    factory: _InjectableAnimationEngine.\u0275fac
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(InjectableAnimationEngine, [{
    type: Injectable
  }], () => [{
    type: Document,
    decorators: [{
      type: Inject,
      args: [DOCUMENT]
    }]
  }, {
    type: AnimationDriver
  }, {
    type: AnimationStyleNormalizer
  }], null);
})();
function instantiateDefaultStyleNormalizer() {
  return new WebAnimationsStyleNormalizer();
}
function instantiateRendererFactory(renderer, engine, zone) {
  return new AnimationRendererFactory(renderer, engine, zone);
}
var SHARED_ANIMATION_PROVIDERS = [{
  provide: AnimationStyleNormalizer,
  useFactory: instantiateDefaultStyleNormalizer
}, {
  provide: AnimationEngine,
  useClass: InjectableAnimationEngine
}, {
  provide: RendererFactory2,
  useFactory: instantiateRendererFactory,
  deps: [DomRendererFactory2, AnimationEngine, NgZone]
}];
var BROWSER_NOOP_ANIMATIONS_PROVIDERS = [{
  provide: AnimationDriver,
  useClass: NoopAnimationDriver
}, {
  provide: ANIMATION_MODULE_TYPE,
  useValue: "NoopAnimations"
}, ...SHARED_ANIMATION_PROVIDERS];
var BROWSER_ANIMATIONS_PROVIDERS = [
  // Note: the `ngServerMode` happen inside factories to give the variable time to initialize.
  {
    provide: AnimationDriver,
    useFactory: () => false ? new NoopAnimationDriver() : new WebAnimationsDriver()
  },
  {
    provide: ANIMATION_MODULE_TYPE,
    useFactory: () => false ? "NoopAnimations" : "BrowserAnimations"
  },
  ...SHARED_ANIMATION_PROVIDERS
];
var BrowserAnimationsModule = class _BrowserAnimationsModule {
  /**
   * Configures the module based on the specified object.
   *
   * @param config Object used to configure the behavior of the `BrowserAnimationsModule`.
   * @see {@link BrowserAnimationsModuleConfig}
   *
   * @usageNotes
   * When registering the `BrowserAnimationsModule`, you can use the `withConfig`
   * function as follows:
   * ```ts
   * @NgModule({
   *   imports: [BrowserAnimationsModule.withConfig(config)]
   * })
   * class MyNgModule {}
   * ```
   */
  static withConfig(config) {
    return {
      ngModule: _BrowserAnimationsModule,
      providers: config.disableAnimations ? BROWSER_NOOP_ANIMATIONS_PROVIDERS : BROWSER_ANIMATIONS_PROVIDERS
    };
  }
  static \u0275fac = function BrowserAnimationsModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _BrowserAnimationsModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _BrowserAnimationsModule,
    exports: [BrowserModule]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    providers: BROWSER_ANIMATIONS_PROVIDERS,
    imports: [BrowserModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(BrowserAnimationsModule, [{
    type: NgModule,
    args: [{
      exports: [BrowserModule],
      providers: BROWSER_ANIMATIONS_PROVIDERS
    }]
  }], null, null);
})();
var NoopAnimationsModule = class _NoopAnimationsModule {
  static \u0275fac = function NoopAnimationsModule_Factory(__ngFactoryType__) {
    return new (__ngFactoryType__ || _NoopAnimationsModule)();
  };
  static \u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
    type: _NoopAnimationsModule,
    exports: [BrowserModule]
  });
  static \u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({
    providers: BROWSER_NOOP_ANIMATIONS_PROVIDERS,
    imports: [BrowserModule]
  });
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(NoopAnimationsModule, [{
    type: NgModule,
    args: [{
      exports: [BrowserModule],
      providers: BROWSER_NOOP_ANIMATIONS_PROVIDERS
    }]
  }], null, null);
})();

// src/app/auth/permissao.ts
var PO_RH_LISTA_MENU = ["PORTAL_ADMINISTRADOR", "PO_RH_LISTA_MENU"];
var PO_RH_SOLICITACAO_MENU = ["PORTAL_ADMINISTRADOR", "PO_RH_SOLICITACAO_MENU"];
var PO_RH_RELFATMENSAL_MENU = ["PORTAL_ADMINISTRADOR", "PO_RH_RELFATMENSAL_MENU"];
var PO_RH_RESUMOAREFI_MENU = ["PORTAL_ADMINISTRADOR", "PO_RH_RESUMOAREFI_MENU"];
var PO_RH_MENU = [
  ...PO_RH_LISTA_MENU,
  ...PO_RH_SOLICITACAO_MENU,
  ...PO_RH_RELFATMENSAL_MENU,
  ...PO_RH_RESUMOAREFI_MENU
];

// src/app/main/main.component.ts
var MainComponent = class _MainComponent {
  constructor(poStorageService, router) {
    this.poStorageService = poStorageService;
    this.router = router;
    this.profileActions = [
      {
        icon: "po-icon-key",
        label: "Alterar Senha",
        separator: true,
        action: this.alterarSenha.bind(this),
        visible: this.visibleAlterarSenha.bind(this)
      },
      {
        icon: "an an-book-bookmark",
        label: "Manual do Usu\xE1rio",
        separator: true,
        action: this.visualizaManual.bind(this)
      },
      {
        icon: "an an-sign-out",
        label: "Sair",
        type: "danger",
        separator: true,
        action: this.logout.bind(this)
      }
    ];
    this.close = {
      action: () => {
        this.poModal?.close();
      },
      label: "Cancelar",
      danger: true
    };
    this.menus = [
      {
        icon: "an an-list-bullets",
        label: "Home",
        shortLabel: "Home",
        link: "/",
        codigos: [""]
      },
      {
        icon: " an an-list-bullets",
        label: "RH",
        shortLabel: "RH",
        codigos: PO_RH_MENU,
        subItems: [
          { label: "Guia Atendimento M\xE9dico", shortLabel: "Guia", link: "/rh/saude/guia/lista", codigos: PO_RH_LISTA_MENU },
          { label: "Rel Fechamento Mensal", shortLabel: "Fat Mensal", link: "/rh/saude/relatorio/fechamento-mensal", codigos: PO_RH_RELFATMENSAL_MENU },
          { label: "Resumo Apura\xE7\xE3o Arefi", shortLabel: "Resumo Arefi", link: "/rh/saude/resumo-arefi", codigos: PO_RH_RESUMOAREFI_MENU }
        ]
      }
    ];
    this.menusFiltrados = [];
    this.columns = [
      { property: "CM0CODIGO", label: "Codigo", width: "10%" },
      { property: "CM0CODFIL", label: "Codigo Filial", width: "15%" },
      { property: "CM0CGC", label: "CNPJ", width: "15%" },
      { property: "CM0NOME", label: "Empresa", width: "20%" },
      { property: "CM0FILIAL", label: "Filial", width: "40%" }
    ];
    this.itens = [];
    this.title = "";
    this.actions = [
      { label: "Selecione", action: this.openModal.bind(this) }
    ];
    this.poStorageService.get("empresaSelecionada").then((empresaSelecionada) => {
      if (empresaSelecionada) {
        let firstName = empresaSelecionada.CM0NOMECOM.substr(0, empresaSelecionada.CM0NOMECOM.indexOf(" "));
        if (environment.production) {
          this.title = `${firstName}`;
        } else {
          this.title = `${firstName} << BASE TESTE >`;
        }
        this.actions = [
          { label: firstName, action: this.openModal.bind(this) }
        ];
      }
    });
    this.profile = {
      subtitle: localStorage.getItem("CUSUARIOPORTALCODIGO") || "",
      title: localStorage.getItem("CUSUARIOPORTALNOME") || ""
    };
  }
  ngOnInit() {
    this.poStorageService.get("usuario").then((usuario) => {
      this.menuFilter(usuario.APRIVILEGIO);
    });
  }
  menuFilter(filters) {
    let menuAtual = this.menus;
    this.menusFiltrados = menuAtual.filter((menu) => {
      return filters.some((permissao) => menu.codigos && menu.codigos.includes(permissao.CCODIGO));
    });
    this.menusFiltrados.map((subMenus) => {
      if (subMenus.subItems && subMenus.subItems.length) {
        subMenus.subItems = subMenus.subItems.filter((menu) => {
          return filters.some((permissao) => menu.codigos && menu.codigos.includes(permissao.CCODIGO));
        });
      }
    });
  }
  openModal() {
    this.poStorageService.get("usuario").then((usuario) => {
      if (usuario && usuario.AEMPRESA) {
        this.itens = usuario.AEMPRESA;
        this.poModal?.open();
      }
    });
  }
  empresaSelecionada(row) {
    this.poStorageService.set("empresaSelecionada", row);
    this.poModal?.close();
    window.location.reload();
  }
  logout() {
    let urlLogin = "/login";
    let tipoUsuario = localStorage.getItem("tipoUsuario");
    if (tipoUsuario === "funcionario") {
      urlLogin = "/login-rh";
    } else if (tipoUsuario === "fornecedor") {
      urlLogin = "/login-fornecedor";
    }
    localStorage.clear();
    this.poStorageService.clear();
    this.router.navigateByUrl(urlLogin);
  }
  alterarSenha() {
    this.router.navigateByUrl("/change-password-fornecedor");
  }
  visibleAlterarSenha() {
    return localStorage.getItem("tipoUsuario") === "fornecedor";
  }
  visualizaManual() {
    const tipoUsuario = localStorage.getItem("tipoUsuario");
    if (tipoUsuario === "fornecedor") {
      window.open("https://intra.inplac.com.br/pdfs/MANUAL_PORTA_AREF_Fornecedor.pdf", "_blank");
    } else if (tipoUsuario === "funcionario") {
      window.open("https://intra.inplac.com.br/pdfs/MANUAL_PORTA_AREF_colaborador.pdf", "_blank");
    } else if (tipoUsuario === "protheus") {
      window.open("https://intra.inplac.com.br/pdfs/MANUAL_PORTA_AREF_administrador.pdf", "_blank");
    }
  }
  static {
    this.\u0275fac = function MainComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _MainComponent)(\u0275\u0275directiveInject(PoStorageService), \u0275\u0275directiveInject(Router));
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _MainComponent, selectors: [["app-main"]], viewQuery: function MainComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(PoModalComponent, 7);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.poModal = _t.first);
      }
    }, standalone: false, decls: 5, vars: 7, consts: [["mainMenu", ""], [1, "po-wrapper"], ["p-short-logo", "./assets/image/logo_short.png", "p-logo", "./assets/image/logo_escura.png", 3, "p-collapsed", "p-filter", "p-menus"], ["p-actions-icon", "an an-building-apartment", 3, "p-profile", "p-profile-actions", "p-actions", "p-title"]], template: function MainComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "div", 1);
        \u0275\u0275element(1, "po-menu", 2, 0)(3, "po-toolbar", 3)(4, "router-outlet");
        \u0275\u0275elementEnd();
      }
      if (rf & 2) {
        \u0275\u0275advance();
        \u0275\u0275property("p-collapsed", false)("p-filter", true)("p-menus", ctx.menusFiltrados);
        \u0275\u0275advance(2);
        \u0275\u0275property("p-profile", ctx.profile)("p-profile-actions", ctx.profileActions)("p-actions", ctx.actions)("p-title", ctx.title);
      }
    }, dependencies: [PoMenuComponent, PoToolbarComponent, RouterOutlet], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(MainComponent, [{
    type: Component,
    args: [{ selector: "app-main", standalone: false, template: '<div class="po-wrapper">\r\n\r\n  <!-- [*MainMenu] -->\r\n  <po-menu #mainMenu\r\n    [p-collapsed]="false"\r\n    [p-filter]="true"\r\n    p-short-logo="./assets/image/logo_short.png"\r\n    p-logo="./assets/image/logo_escura.png"\r\n    [p-menus]="menusFiltrados">\r\n  </po-menu>\r\n\r\n  <po-toolbar\r\n    p-actions-icon="an an-building-apartment"\r\n    [p-profile]="profile"\r\n    [p-profile-actions]="profileActions"\r\n    [p-actions]="actions"\r\n    [p-title]="title">\r\n  </po-toolbar>\r\n\r\n  <!-- [*Router] -->\r\n  <router-outlet></router-outlet>\r\n\r\n</div>\r\n' }]
  }], () => [{ type: PoStorageService }, { type: Router }], { poModal: [{
    type: ViewChild,
    args: [PoModalComponent, { static: true }]
  }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(MainComponent, { className: "MainComponent", filePath: "src/app/main/main.component.ts", lineNumber: 27 });
})();

// src/app/auth/toke-auth.ts
var TokenInterceptor = class _TokenInterceptor {
  constructor(router, poStorageService, authService) {
    this.router = router;
    this.poStorageService = poStorageService;
    this.authService = authService;
  }
  intercept(request, next) {
    let urlLogin = "/login";
    let tipoUsuario = localStorage.getItem("tipoUsuario");
    if (tipoUsuario === "funcionario") {
      urlLogin = "/login-rh";
    } else if (tipoUsuario === "fornecedor") {
      urlLogin = "/login-fornecedor";
    }
    if (request.url.includes(environment.urlApiProtheus)) {
      const tokenJson = localStorage.getItem("token");
      if (tokenJson) {
        const token = JSON.parse(tokenJson);
        const diffTime = Math.abs(token.last_token_refresh - (/* @__PURE__ */ new Date()).getTime() / 1e3);
        if (diffTime > token.expires_in) {
          this.reloadGoToLogin(urlLogin);
          return next.handle(request);
        }
        if (diffTime > token.expires_in - 1800 && !request.url.includes("oauth2")) {
          this.authService.refreshToken(token.refresh_token).subscribe({
            next: (newToken) => {
              localStorage.setItem("token", JSON.stringify(__spreadProps(__spreadValues({}, newToken), { last_token_refresh: (/* @__PURE__ */ new Date()).getTime() / 1e3 })));
            },
            error: (e) => {
              console.log(e);
              this.reloadGoToLogin(urlLogin);
            }
          });
        }
        request = request.clone({
          setHeaders: {
            "X-PO-Screen-Lock": "true",
            Authorization: `${token.token_type} ${token.access_token}`,
            tenantid: localStorage.getItem("tenantid") || "",
            CUSRID: localStorage.getItem("CUSRID") || "",
            portal: localStorage.getItem("portal") || ""
          }
        });
      }
    } else if (request.url.includes(environment.urlGestaoArquivo)) {
      request = request.clone({
        setHeaders: {
          "X-PO-Screen-Lock": "true",
          CUSRID: localStorage.getItem("CUSRID") || ""
        }
      });
    }
    return next.handle(request);
  }
  reloadGoToLogin(urlLogin) {
    localStorage.clear();
    this.poStorageService.clear();
    this.router.navigateByUrl(urlLogin);
  }
  static {
    this.\u0275fac = function TokenInterceptor_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _TokenInterceptor)(\u0275\u0275inject(Router), \u0275\u0275inject(PoStorageService), \u0275\u0275inject(AuthService));
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({ token: _TokenInterceptor, factory: _TokenInterceptor.\u0275fac });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(TokenInterceptor, [{
    type: Injectable
  }], () => [{ type: Router }, { type: PoStorageService }, { type: AuthService }], null);
})();

// node_modules/angular-device-information/fesm2022/angular-device-information.mjs
var Filter = class {
  constructor() {
  }
  test(str, regex) {
    if (typeof regex === "string") {
      regex = new RegExp(regex);
    }
    if (regex instanceof RegExp) {
      return regex.test(str);
    } else if (regex && Array.isArray(regex.and)) {
      return regex.and.every((item) => {
        return this.test(str, item);
      });
    } else if (regex && Array.isArray(regex.or)) {
      return regex.or.some((item) => {
        return this.test(str, item);
      });
    } else if (regex && regex.not) {
      return !this.test(str, regex.not);
    } else {
      return false;
    }
  }
  exec(str, regex) {
    if (typeof regex === "string") {
      regex = new RegExp(regex);
    }
    if (regex instanceof RegExp) {
      return regex.exec(str);
    } else if (regex && Array.isArray(regex)) {
      return regex.reduce((res, item) => {
        return !!res ? res : this.exec(str, item);
      }, null);
    } else {
      return null;
    }
  }
};
var AngularDeviceInformationService = class _AngularDeviceInformationService {
  constructor(platformId) {
    this.platformId = platformId;
    this.userAgent = "";
    this.appVersion = "";
    this.appName = "";
    this.getDeviceType = (userAgent = this.userAgent) => {
      const ua = userAgent;
      if (this.isTablet()) return "Tablet";
      if (this.isMobile()) return "Mobile";
      return "Desktop";
    };
    if (isPlatformBrowser(this.platformId) && typeof window !== "undefined") {
      this.userAgent = window.navigator.userAgent;
      this.appVersion = window.navigator.appVersion;
      this.appName = window.navigator.appName;
    }
    this.filter = new Filter();
    this.setDeviceInfo(this.userAgent, this.appVersion, this.appName);
  }
  /**
   * @desc Sets the initial value of the device when the service is initiated.
   * This value is later accessible for usage
   */
  setDeviceInfo(userAgent, appVersion, appName) {
    let unknown = "-";
    let screenSize = "";
    if (screen.width) {
      let width = screen.width ? screen.width : "";
      let height = screen.height ? screen.height : "";
      screenSize += "" + width + " x " + height;
    }
    let nVer = appVersion;
    let nAgt = userAgent;
    let browser = appName;
    let version2 = "" + parseFloat(navigator.appVersion);
    let majorVersion = parseInt(navigator.appVersion, 10);
    let nameOffset, verOffset, ix;
    if ((verOffset = nAgt.indexOf("Opera")) != -1) {
      browser = "Opera";
      version2 = nAgt.substring(verOffset + 6);
      if ((verOffset = nAgt.indexOf("Version")) != -1) {
        version2 = nAgt.substring(verOffset + 8);
      }
    }
    if ((verOffset = nAgt.indexOf("OPR")) != -1) {
      browser = "Opera";
      version2 = nAgt.substring(verOffset + 4);
    } else if ((verOffset = nAgt.indexOf("Edge")) != -1) {
      browser = "Microsoft Legacy Edge";
      version2 = nAgt.substring(verOffset + 5);
    } else if ((verOffset = nAgt.indexOf("Edg")) != -1) {
      browser = "Microsoft Edge";
      version2 = nAgt.substring(verOffset + 4);
    } else if ((verOffset = nAgt.indexOf("MSIE")) != -1) {
      browser = "Microsoft Internet Explorer";
      version2 = nAgt.substring(verOffset + 5);
    } else if ((verOffset = nAgt.indexOf("Chrome")) != -1) {
      browser = "Chrome";
      version2 = nAgt.substring(verOffset + 7);
    } else if ((verOffset = nAgt.indexOf("Safari")) != -1) {
      browser = "Safari";
      version2 = nAgt.substring(verOffset + 7);
      if ((verOffset = nAgt.indexOf("Version")) != -1) {
        version2 = nAgt.substring(verOffset + 8);
      }
    } else if ((verOffset = nAgt.indexOf("Firefox")) != -1) {
      browser = "Firefox";
      version2 = nAgt.substring(verOffset + 8);
    } else if (nAgt.indexOf("Trident/") != -1) {
      browser = "Microsoft Internet Explorer";
      version2 = nAgt.substring(nAgt.indexOf("rv:") + 3);
    } else if ((nameOffset = nAgt.lastIndexOf(" ") + 1) < (verOffset = nAgt.lastIndexOf("/"))) {
      browser = nAgt.substring(nameOffset, verOffset);
      version2 = nAgt.substring(verOffset + 1);
      if (browser.toLowerCase() == browser.toUpperCase()) {
        browser = navigator.appName;
      }
    }
    if ((ix = version2.indexOf(";")) != -1) {
      version2 = version2.substring(0, ix);
    }
    if ((ix = version2.indexOf(" ")) != -1) {
      version2 = version2.substring(0, ix);
    }
    if ((ix = version2.indexOf(")")) != -1) {
      version2 = version2.substring(0, ix);
    }
    browser = function() {
      var test = function(regexp) {
        return regexp.test(window.navigator.userAgent);
      };
      switch (true) {
        case test(/edg/i):
          return "Microsoft Edge";
        case test(/trident/i):
          return "Microsoft Internet Explorer";
        case test(/firefox|fxios/i):
          return "Firefox";
        case test(/opr\//i):
          return "Opera";
        case test(/ucbrowser/i):
          return "UC Browser";
        case test(/samsungbrowser/i):
          return "Samsung Browser";
        case test(/chrome|chromium|crios/i):
          return "Chrome";
        case test(/safari/i):
          return "Safari";
        default:
          return "Other";
      }
    }();
    majorVersion = parseInt("" + version2, 10);
    if (isNaN(majorVersion)) {
      version2 = "" + parseFloat(navigator.appVersion);
      majorVersion = parseInt(navigator.appVersion, 10);
    }
    let cookieEnabled = navigator.cookieEnabled ? true : false;
    if (typeof navigator.cookieEnabled == "undefined" && !cookieEnabled) {
      document.cookie = "testcookie";
      cookieEnabled = document.cookie.indexOf("testcookie") != -1 ? true : false;
    }
    let os = "unknown";
    let clientStrings = [{
      s: "Windows 10",
      r: /(Windows 10.0|Windows NT 10.0)/
    }, {
      s: "Windows 8.1",
      r: /(Windows 8.1|Windows NT 6.3)/
    }, {
      s: "Windows 8",
      r: /(Windows 8|Windows NT 6.2)/
    }, {
      s: "Windows 7",
      r: /(Windows 7|Windows NT 6.1)/
    }, {
      s: "Windows Vista",
      r: /Windows NT 6.0/
    }, {
      s: "Windows Server 2003",
      r: /Windows NT 5.2/
    }, {
      s: "Windows XP",
      r: /(Windows NT 5.1|Windows XP)/
    }, {
      s: "Windows 2000",
      r: /(Windows NT 5.0|Windows 2000)/
    }, {
      s: "Windows ME",
      r: /(Win 9x 4.90|Windows ME)/
    }, {
      s: "Windows 98",
      r: /(Windows 98|Win98)/
    }, {
      s: "Windows 95",
      r: /(Windows 95|Win95|Windows_95)/
    }, {
      s: "Windows NT 4.0",
      r: /(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/
    }, {
      s: "Windows CE",
      r: /Windows CE/
    }, {
      s: "Windows 3.11",
      r: /Win16/
    }, {
      s: "Android",
      r: /Android/
    }, {
      s: "Open BSD",
      r: /OpenBSD/
    }, {
      s: "Sun OS",
      r: /SunOS/
    }, {
      s: "Chrome OS",
      r: /CrOS/
    }, {
      s: "Linux",
      r: /(Linux|X11(?!.*CrOS))/
    }, {
      s: "iOS",
      r: /(iPhone|iPad|iPod)/
    }, {
      s: "Mac OS X",
      r: /Mac OS X/
    }, {
      s: "Mac OS",
      r: /(Mac OS|MacPPC|MacIntel|Mac_PowerPC|Macintosh)/
    }, {
      s: "QNX",
      r: /QNX/
    }, {
      s: "UNIX",
      r: /UNIX/
    }, {
      s: "BeOS",
      r: /BeOS/
    }, {
      s: "OS/2",
      r: /OS\/2/
    }, {
      s: "BlackBerry",
      r: /BlackBerry/
    }, {
      s: "PlayBook",
      r: /PlayBook/
    }, {
      s: "Search Bot",
      r: /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/
    }];
    for (let id in clientStrings) {
      let cs = clientStrings[id];
      if (cs.r.test(nAgt)) {
        os = cs.s;
        break;
      }
    }
    let osVersion = "unknown";
    if (/Windows/.test(os)) {
      osVersion = /Windows (.*)/.exec(os)[1];
      os = "Windows";
    }
    switch (os) {
      case "Mac OS":
      case "Mac OS X":
      case "Android":
        osVersion = /(?:Android|Mac OS|Mac OS X|MacPPC|MacIntel|Mac_PowerPC|Macintosh) ([\.\_\d]+)/.exec(nAgt)[1];
        osVersion = osVersion.replaceAll("_", ".");
        break;
      case "BlackBerry":
        osVersion = nAgt.match(/BlackBerry\s[0-9]*/)[0];
        osVersion = osVersion.replaceAll("_", ".");
        break;
      case "PlayBook":
        osVersion = nAgt.match(/RIM Tablet OS\s[0-9].[0-9].[0-9]/)[0];
        osVersion = osVersion.replaceAll("_", ".");
        break;
      case "iOS":
        osVersion = /OS (\d+)_(\d+)_?(\d+)?/.exec(nAgt);
        osVersion = osVersion[1] + "." + osVersion[2] + "." + (osVersion[3] | 0);
        osVersion = osVersion.replaceAll("_", ".");
        break;
    }
    this.deviceInfo = {
      userAgent: this.userAgent,
      screen_resolution: screenSize,
      browser,
      browserVersion: version2,
      browserMajorVersion: majorVersion,
      osVersion,
      os,
      cookies: cookieEnabled
    };
  }
  /**
   * @desc Returns the device information
   * @returns the device information object.
   */
  getDeviceInfo() {
    return this.deviceInfo;
  }
  /**
   * @desc Compares the current device info with the mobile devices to check
   * if the current device is a mobile and also check current device is tablet so it will return false.
   * @returns whether the current device is a mobile
   */
  isMobile(userAgent = this.userAgent) {
    if (this.isTablet(userAgent)) {
      return false;
    }
    const match = Object.keys(MOBILES_RE).find((mobile) => {
      return this.filter.test(userAgent, MOBILES_RE[mobile]);
    });
    return !!match;
  }
  /**
   * @desc Compares the current device info with the tablet devices to check
   * if the current device is a tablet.
   * @returns whether the current device is a tablet
   */
  isTablet(userAgent = this.userAgent) {
    const match = Object.keys(TABLETS_RE).find((mobile) => {
      return !!this.filter.test(userAgent, TABLETS_RE[mobile]);
    });
    return !!match;
  }
  /**
   * @desc Compares the current device info with the desktop devices to check
   * if the current device is a desktop device.
   * @returns whether the current device is a desktop device
   */
  isDesktop(userAgent = this.userAgent) {
    if (!this.isMobile(userAgent) && !this.isTablet(userAgent)) {
      return true;
    }
    return false;
  }
  static {
    this.\u0275fac = function AngularDeviceInformationService_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _AngularDeviceInformationService)(\u0275\u0275inject(PLATFORM_ID));
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({
      token: _AngularDeviceInformationService,
      factory: _AngularDeviceInformationService.\u0275fac,
      providedIn: "root"
    });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(AngularDeviceInformationService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], function() {
    return [{
      type: void 0,
      decorators: [{
        type: Inject,
        args: [PLATFORM_ID]
      }]
    }];
  }, null);
})();
var MOBILES_RE = {
  // tslint:disable-next-line:max-line-length
  HTC: /HTC|HTC.*(Sensation|Evo|Vision|Explorer|6800|8100|8900|A7272|S510e|C110e|Legend|Desire|T8282)|APX515CKT|Qtek9090|APA9292KT|HD_mini|Sensation.*Z710e|PG86100|Z715e|Desire.*(A8181|HD)|ADR6200|ADR6400L|ADR6425|001HT|Inspire 4G|Android.*\bEVO\b|T-Mobile G1|Z520m|Android [0-9.]+; Pixel/,
  NEXUS_PHONE: /Nexus One|Nexus S|Galaxy.*Nexus|Android.*Nexus.*Mobile|Nexus 4|Nexus 5|Nexus 6/,
  DELL: /Dell[;]? (Streak|Aero|Venue|Venue Pro|Flash|Smoke|Mini 3iX)|XCD28|XCD35|\b001DL\b|\b101DL\b|\bGS01\b/,
  MOTOROLA: new RegExp(`Motorola|DROIDX|DROID BIONIC|\\bDroid\\b.*Build|Android.*Xoom|HRI39|MOT-|A1260|A1680|A555|A853|
      A855|A953|A955|A956|Motorola.*ELECTRIFY|Motorola.*i1|i867|i940|MB200|MB300|MB501|MB502|MB508|MB511|
      MB520|MB525|MB526|MB611|MB612|MB632|MB810|MB855|MB860|MB861|MB865|MB870|ME501|ME502|ME511|ME525|ME600|
      ME632|ME722|ME811|ME860|ME863|ME865|MT620|MT710|MT716|MT720|MT810|MT870|MT917|Motorola.*TITANIUM|WX435|
      WX445|XT300|XT301|XT311|XT316|XT317|XT319|XT320|XT390|XT502|XT530|XT531|XT532|XT535|XT603|XT610|XT611|
      XT615|XT681|XT701|XT702|XT711|XT720|XT800|XT806|XT860|XT862|XT875|XT882|XT883|XT894|XT901|XT907|XT909|
      XT910|XT912|XT928|XT926|XT915|XT919|XT925|XT1021|\\bMoto E\\b|XT1068|XT1092|XT1052`),
  SAMSUNG: new RegExp(`\\bSamsung\\b|SM-G950F|SM-G955F|SM-G9250|GT-19300|SGH-I337|BGT-S5230|GT-B2100|GT-B2700|GT-B2710|
      GT-B3210|GT-B3310|GT-B3410|GT-B3730|GT-B3740|GT-B5510|GT-B5512|GT-B5722|GT-B6520|GT-B7300|GT-B7320|
      GT-B7330|GT-B7350|GT-B7510|GT-B7722|GT-B7800|GT-C3010|GT-C3011|GT-C3060|GT-C3200|GT-C3212|GT-C3212I|
      GT-C3262|GT-C3222|GT-C3300|GT-C3300K|GT-C3303|GT-C3303K|GT-C3310|GT-C3322|GT-C3330|GT-C3350|GT-C3500|
      GT-C3510|GT-C3530|GT-C3630|GT-C3780|GT-C5010|GT-C5212|GT-C6620|GT-C6625|GT-C6712|GT-E1050|GT-E1070|
      GT-E1075|GT-E1080|GT-E1081|GT-E1085|GT-E1087|GT-E1100|GT-E1107|GT-E1110|GT-E1120|GT-E1125|GT-E1130|
      GT-E1160|GT-E1170|GT-E1175|GT-E1180|GT-E1182|GT-E1200|GT-E1210|GT-E1225|GT-E1230|GT-E1390|GT-E2100|
      GT-E2120|GT-E2121|GT-E2152|GT-E2220|GT-E2222|GT-E2230|GT-E2232|GT-E2250|GT-E2370|GT-E2550|GT-E2652|
      GT-E3210|GT-E3213|GT-I5500|GT-I5503|GT-I5700|GT-I5800|GT-I5801|GT-I6410|GT-I6420|GT-I7110|GT-I7410|
      GT-I7500|GT-I8000|GT-I8150|GT-I8160|GT-I8190|GT-I8320|GT-I8330|GT-I8350|GT-I8530|GT-I8700|GT-I8703|
      GT-I8910|GT-I9000|GT-I9001|GT-I9003|GT-I9010|GT-I9020|GT-I9023|GT-I9070|GT-I9082|GT-I9100|GT-I9103|
      GT-I9220|GT-I9250|GT-I9300|GT-I9305|GT-I9500|GT-I9505|GT-M3510|GT-M5650|GT-M7500|GT-M7600|GT-M7603|
      GT-M8800|GT-M8910|GT-N7000|GT-S3110|GT-S3310|GT-S3350|GT-S3353|GT-S3370|GT-S3650|GT-S3653|GT-S3770|
      GT-S3850|GT-S5210|GT-S5220|GT-S5229|GT-S5230|GT-S5233|GT-S5250|GT-S5253|GT-S5260|GT-S5263|GT-S5270|
      GT-S5300|GT-S5330|GT-S5350|GT-S5360|GT-S5363|GT-S5369|GT-S5380|GT-S5380D|GT-S5560|GT-S5570|GT-S5600|
      GT-S5603|GT-S5610|GT-S5620|GT-S5660|GT-S5670|GT-S5690|GT-S5750|GT-S5780|GT-S5830|GT-S5839|GT-S6102|
      GT-S6500|GT-S7070|GT-S7200|GT-S7220|GT-S7230|GT-S7233|GT-S7250|GT-S7500|GT-S7530|GT-S7550|GT-S7562|
      GT-S7710|GT-S8000|GT-S8003|GT-S8500|GT-S8530|GT-S8600|SCH-A310|SCH-A530|SCH-A570|SCH-A610|SCH-A630|
      SCH-A650|SCH-A790|SCH-A795|SCH-A850|SCH-A870|SCH-A890|SCH-A930|SCH-A950|SCH-A970|SCH-A990|SCH-I100|
      SCH-I110|SCH-I400|SCH-I405|SCH-I500|SCH-I510|SCH-I515|SCH-I600|SCH-I730|SCH-I760|SCH-I770|SCH-I830|
      SCH-I910|SCH-I920|SCH-I959|SCH-LC11|SCH-N150|SCH-N300|SCH-R100|SCH-R300|SCH-R351|SCH-R400|SCH-R410|
      SCH-T300|SCH-U310|SCH-U320|SCH-U350|SCH-U360|SCH-U365|SCH-U370|SCH-U380|SCH-U410|SCH-U430|SCH-U450|
      SCH-U460|SCH-U470|SCH-U490|SCH-U540|SCH-U550|SCH-U620|SCH-U640|SCH-U650|SCH-U660|SCH-U700|SCH-U740|
      SCH-U750|SCH-U810|SCH-U820|SCH-U900|SCH-U940|SCH-U960|SCS-26UC|SGH-A107|SGH-A117|SGH-A127|SGH-A137|
      SGH-A157|SGH-A167|SGH-A177|SGH-A187|SGH-A197|SGH-A227|SGH-A237|SGH-A257|SGH-A437|SGH-A517|SGH-A597|
      SGH-A637|SGH-A657|SGH-A667|SGH-A687|SGH-A697|SGH-A707|SGH-A717|SGH-A727|SGH-A737|SGH-A747|SGH-A767|
      SGH-A777|SGH-A797|SGH-A817|SGH-A827|SGH-A837|SGH-A847|SGH-A867|SGH-A877|SGH-A887|SGH-A897|SGH-A927|
      SGH-B100|SGH-B130|SGH-B200|SGH-B220|SGH-C100|SGH-C110|SGH-C120|SGH-C130|SGH-C140|SGH-C160|SGH-C170|
      SGH-C180|SGH-C200|SGH-C207|SGH-C210|SGH-C225|SGH-C230|SGH-C417|SGH-C450|SGH-D307|SGH-D347|SGH-D357|
      SGH-D407|SGH-D415|SGH-D780|SGH-D807|SGH-D980|SGH-E105|SGH-E200|SGH-E315|SGH-E316|SGH-E317|SGH-E335|
      SGH-E590|SGH-E635|SGH-E715|SGH-E890|SGH-F300|SGH-F480|SGH-I200|SGH-I300|SGH-I320|SGH-I550|SGH-I577|
      SGH-I600|SGH-I607|SGH-I617|SGH-I627|SGH-I637|SGH-I677|SGH-I700|SGH-I717|SGH-I727|SGH-i747M|SGH-I777|
      SGH-I780|SGH-I827|SGH-I847|SGH-I857|SGH-I896|SGH-I897|SGH-I900|SGH-I907|SGH-I917|SGH-I927|SGH-I937|
      SGH-I997|SGH-J150|SGH-J200|SGH-L170|SGH-L700|SGH-M110|SGH-M150|SGH-M200|SGH-N105|SGH-N500|SGH-N600|
      SGH-N620|SGH-N625|SGH-N700|SGH-N710|SGH-P107|SGH-P207|SGH-P300|SGH-P310|SGH-P520|SGH-P735|SGH-P777|
      SGH-Q105|SGH-R210|SGH-R220|SGH-R225|SGH-S105|SGH-S307|SGH-T109|SGH-T119|SGH-T139|SGH-T209|SGH-T219|
      SGH-T229|SGH-T239|SGH-T249|SGH-T259|SGH-T309|SGH-T319|SGH-T329|SGH-T339|SGH-T349|SGH-T359|SGH-T369|
      SGH-T379|SGH-T409|SGH-T429|SGH-T439|SGH-T459|SGH-T469|SGH-T479|SGH-T499|SGH-T509|SGH-T519|SGH-T539|
      SGH-T559|SGH-T589|SGH-T609|SGH-T619|SGH-T629|SGH-T639|SGH-T659|SGH-T669|SGH-T679|SGH-T709|SGH-T719|
      SGH-T729|SGH-T739|SGH-T746|SGH-T749|SGH-T759|SGH-T769|SGH-T809|SGH-T819|SGH-T839|SGH-T919|SGH-T929|
      SGH-T939|SGH-T959|SGH-T989|SGH-U100|SGH-U200|SGH-U800|SGH-V205|SGH-V206|SGH-X100|SGH-X105|SGH-X120|
      SGH-X140|SGH-X426|SGH-X427|SGH-X475|SGH-X495|SGH-X497|SGH-X507|SGH-X600|SGH-X610|SGH-X620|SGH-X630|
      SGH-X700|SGH-X820|SGH-X890|SGH-Z130|SGH-Z150|SGH-Z170|SGH-ZX10|SGH-ZX20|SHW-M110|SPH-A120|SPH-A400|
      SPH-A420|SPH-A460|SPH-A500|SPH-A560|SPH-A600|SPH-A620|SPH-A660|SPH-A700|SPH-A740|SPH-A760|SPH-A790|
      SPH-A800|SPH-A820|SPH-A840|SPH-A880|SPH-A900|SPH-A940|SPH-A960|SPH-D600|SPH-D700|SPH-D710|SPH-D720|
      SPH-I300|SPH-I325|SPH-I330|SPH-I350|SPH-I500|SPH-I600|SPH-I700|SPH-L700|SPH-M100|SPH-M220|SPH-M240|
      SPH-M300|SPH-M305|SPH-M320|SPH-M330|SPH-M350|SPH-M360|SPH-M370|SPH-M380|SPH-M510|SPH-M540|SPH-M550|
      SPH-M560|SPH-M570|SPH-M580|SPH-M610|SPH-M620|SPH-M630|SPH-M800|SPH-M810|SPH-M850|SPH-M900|SPH-M910|
      SPH-M920|SPH-M930|SPH-N100|SPH-N200|SPH-N240|SPH-N300|SPH-N400|SPH-Z400|SWC-E100|SCH-i909|GT-N7100|
      GT-N7105|SCH-I535|SM-N900A|SM-N900T|SGH-I317|SGH-T999L|GT-S5360B|GT-I8262|GT-S6802|GT-S6312|GT-S6310|GT-S5312|
      GT-S5310|GT-I9105|GT-I8510|GT-S6790N|SM-G7105|SM-N9005|GT-S5301|GT-I9295|GT-I9195|SM-C101|GT-S7392|GT-S7560|
      GT-B7610|GT-I5510|GT-S7582|GT-S7530E|GT-I8750|SM-G9006V|SM-G9008V|SM-G9009D|SM-G900A|SM-G900D|SM-G900F|
      SM-G900H|SM-G900I|SM-G900J|SM-G900K|SM-G900L|SM-G900M|SM-G900P|SM-G900R4|SM-G900S|SM-G900T|SM-G900V|
      SM-G900W8|SHV-E160K|SCH-P709|SCH-P729|SM-T2558|GT-I9205|SM-G9350|SM-J120F|SM-G920F|SM-G920V|SM-G930F|
      SM-N910C|SM-A310F|GT-I9190|SM-J500FN|SM-G903F|SM-J330F`),
  LG: new RegExp(`\\bLG\\b;|LG[- ]?(C800|C900|E400|E610|E900|E-900|F160|F180K|F180L|F180S|730|855|L160|LS740|LS840|LS970|
      LU6200|MS690|MS695|MS770|MS840|MS870|MS910|P500|P700|P705|VM696|AS680|AS695|AX840|C729|E970|GS505|272|
      C395|E739BK|E960|L55C|L75C|LS696|LS860|P769BK|P350|P500|P509|P870|UN272|US730|VS840|VS950|LN272|LN510|
      LS670|LS855|LW690|MN270|MN510|P509|P769|P930|UN200|UN270|UN510|UN610|US670|US740|US760|UX265|UX840|VN271|
      VN530|VS660|VS700|VS740|VS750|VS910|VS920|VS930|VX9200|VX11000|AX840A|LW770|P506|P925|P999|E612|D955|D802|
      MS323|M257)`),
  SONY: /SonyST|SonyLT|SonyEricsson|SonyEricssonLT15iv|LT18i|E10i|LT28h|LT26w|SonyEricssonMT27i|C5303|C6902|C6903|C6906|C6943|D2533/,
  ASUS: /Asus.*Galaxy|PadFone.*Mobile/,
  NOKIA_LUMIA: /Lumia [0-9]{3,4}/,
  MICROMAX: /Micromax.*\b(A210|A92|A88|A72|A111|A110Q|A115|A116|A110|A90S|A26|A51|A35|A54|A25|A27|A89|A68|A65|A57|A90)\b/,
  PALM: /PalmSource|Palm/,
  VERTU: /Vertu|Vertu.*Ltd|Vertu.*Ascent|Vertu.*Ayxta|Vertu.*Constellation(F|Quest)?|Vertu.*Monika|Vertu.*Signature/,
  PANTECH: new RegExp(`PANTECH|IM-A850S|IM-A840S|IM-A830L|IM-A830K|IM-A830S|IM-A820L|IM-A810K|IM-A810S|IM-A800S|IM-T100K|
        IM-A725L|IM-A780L|IM-A775C|IM-A770K|IM-A760S|IM-A750K|IM-A740S|IM-A730S|IM-A720L|IM-A710K|IM-A690L|
        IM-A690S|IM-A650S|IM-A630K|IM-A600S|VEGA PTL21|PT003|P8010|ADR910L|P6030|P6020|P9070|P4100|P9060|P5000|
        CDM8992|TXT8045|ADR8995|IS11PT|P2030|P6010|P8000|PT002|IS06|CDM8999|P9050|PT001|TXT8040|P2020|P9020|
        P2000|P7040|P7000|C790`),
  FLY: /IQ230|IQ444|IQ450|IQ440|IQ442|IQ441|IQ245|IQ256|IQ236|IQ255|IQ235|IQ245|IQ275|IQ240|IQ285|IQ280|IQ270|IQ260|IQ250/,
  WIKO: new RegExp(`KITE 4G|HIGHWAY|GETAWAY|STAIRWAY|DARKSIDE|DARKFULL|DARKNIGHT|DARKMOON|SLIDE|WAX 4G|RAINBOW|BLOOM|
        SUNSET|GOA(?!nna)|LENNY|BARRY|IGGY|OZZY|CINK FIVE|CINK PEAX|CINK PEAX 2|CINK SLIM|CINK SLIM 2|CINK +|
        CINK KING|CINK PEAX|CINK SLIM|SUBLIM`),
  I_MOBILE: /i-mobile (IQ|i-STYLE|idea|ZAA|Hitz)/,
  SIMVALLEY: /\b(SP-80|XT-930|SX-340|XT-930|SX-310|SP-360|SP60|SPT-800|SP-120|SPT-800|SP-140|SPX-5|SPX-8|SP-100|SPX-8|SPX-12)\b/,
  WOLFGANG: /AT-B24D|AT-AS50HD|AT-AS40W|AT-AS55HD|AT-AS45q2|AT-B26D|AT-AS50Q/,
  ALCATEL: /Alcatel|Mobile; rv:49.0|Mobile; ALCATEL 4052R; rv:48.0/,
  NINTENDO: /Nintendo (3DS|Switch)/,
  AMOI: /Amoi/,
  INQ: /INQ/,
  VITA: /\bVita\b/,
  BLACKBERRY: /\bBlackBerry\b|\bBB10\b|rim[0-9]+/,
  FIREFOX_OS: /\bFirefox-OS\b/,
  IPHONE: /\biPhone\b/,
  iPod: /\biPod\b/,
  ANDROID: /\bAndroid\b/,
  WINDOWS_PHONE: /\bWindows-Phone\b/,
  GENERIC_PHONE: new RegExp(`Tapatalk|PDA;|SAGEM|\\bmmp\\b|pocket|\\bpsp\\b|symbian|Smartphone|smartfon|treo|up.browser|
        up.link|vodafone|\\bwap\\b|nokia|Nokia|Series40|Series60|S60|SonyEricsson|N900|MAUI.*WAP.*Browser`)
};
var TABLETS_RE = {
  iPad: /iPad|iPad.*Mobile/,
  NexusTablet: /Android.*Nexus[\s]+(7|9|10)/,
  GoogleTablet: /Android.*Pixel C/,
  SamsungTablet: new RegExp(`SAMSUNG.*Tablet|Galaxy.*Tab|SC-01C|GT-P1000|GT-P1003|GT-P1010|GT-P3105|GT-P6210|
        GT-P6800|GT-P6810|GT-P7100|GT-P7300|GT-P7310|GT-P7500|GT-P7510|SCH-I800|SCH-I815|SCH-I905|
        SGH-I957|SGH-I987|SGH-T849|SGH-T859|SGH-T869|SPH-P100|GT-P3100|GT-P3108|GT-P3110|GT-P5100|
        GT-P5110|GT-P6200|GT-P7320|GT-P7511|GT-N8000|GT-P8510|SGH-I497|SPH-P500|SGH-T779|SCH-I705|
        SCH-I915|GT-N8013|GT-P3113|GT-P5113|GT-P8110|GT-N8010|GT-N8005|GT-N8020|GT-P1013|GT-P6201|
        GT-P7501|GT-N5100|GT-N5105|GT-N5110|SHV-E140K|SHV-E140L|SHV-E140S|SHV-E150S|SHV-E230K|SHV-E230L|
        SHV-E230S|SHW-M180K|SHW-M180L|SM-T865|SM-T290|SHW-M180S|SHW-M180W|SHW-M300W|SHW-M305W|SHW-M380K|SHW-M380S|SHW-M380W|
        SHW-M430W|SHW-M480K|SHW-M480S|SHW-M480W|SHW-M485W|SHW-M486W|SHW-M500W|GT-I9228|SCH-P739|SCH-I925|
        GT-I9200|GT-P5200|GT-P5210|GT-P5210X|SM-T385M|SM-P585M|SM-T311|SM-T310|SM-T310X|SM-T210|SM-T210R|SM-T211|SM-P600|
        SM-P601|SM-P605|SM-P615|SM-P900|SM-P901|SM-T217|SM-T217A|SM-T217S|SM-P6000|SM-T3100|SGH-I467|XE500|SM-T110|
        GT-P5220|GT-I9200X|GT-N5110X|GT-N5120|SM-P905|SM-T111|SM-T2105|SM-T315|SM-T320|SM-T320X|SM-T321|
        SM-T510|SM-T520|SM-T525|SM-T530NU|SM-T230NU|SM-T330NU|SM-T900|XE500T1C|SM-P605V|SM-P905V|SM-T337V|SM-T537V|
        SM-T707V|SM-T807V|SM-P600X|SM-P900X|SM-T210X|SM-T230|SM-T230X|SM-T325|GT-P7503|SM-T531|SM-T500|SM-T330|
        SM-T530|SM-T705|SM-T705C|SM-T535|SM-T331|SM-T800|SM-T700|SM-T537|SM-T807|SM-P907A|SM-T337A|SM-T537A|
        SM-T707A|SM-T807A|SM-T237|SM-T807P|SM-P607T|SM-T217T|SM-T337T|SM-T807T|SM-T116NQ|SM-T116BU|SM-P550|
        SM-T350|SM-T550|SM-T9000|SM-P9000|SM-T705Y|SM-T805|GT-P3113|SM-T710|SM-T810|SM-T815|SM-T360|SM-T533|
        SM-T113|SM-T335|SM-T715|SM-T560|SM-T670|SM-T677|SM-T377|SM-T567|SM-T357T|SM-T555|SM-T561|SM-T713|
        SM-T719|SM-T725|SM-T813|SM-T819|SM-T580|SM-T590|SM-T355Y?|SM-T280|SM-T817A|SM-T820|SM-W700|SM-P580|SM-T587|SM-P350|
        SM-P555M|SM-P355M|SM-T113NU|SM-T815Y|SM-T585|SM-T285|SM-T825|SM-W708|SM-T835|SM-P585Y`),
  Kindle: new RegExp(`Kindle|Silk.*Accelerated|Android.*\\b(KFOT|KFTT|KFJWI|KFJWA|KFOTE|KFSOWI|KFTHWI|KFTHWA|KFAPWI|
        KFAPWA|WFJWAE|KFSAWA|KFSAWI|KFASWI|KFARWI|KFFOWI|KFGIWI|KFMEWI)\\b|Android.*Silk/[0-9.]+ like Chrome        /[0-9.]+ (?!Mobile)`),
  SurfaceTablet: /Windows NT [0-9.]+; ARM;.*(Tablet|ARMBJS)/,
  HPTablet: /HP Slate (7|8|10)|HP ElitePad 900|hp-tablet|EliteBook.*Touch|HP 8|Slate 21|HP SlateBook 10/,
  AsusTablet: new RegExp(`^.*PadFone((?!Mobile).)*$|Transformer|TF101|TF101G|TF300T|TF300TG|TF300TL|TF700T|TF700KL|
        TF701T|TF810C|ME171|ME301T|ME302C|ME371MG|ME370T|ME372MG|ME172V|ME173X|ME400C|
        Slider SL101|\\bK00F\\b|\\bK00C\\b|\\bK00E\\b|\\bK00L\\b|TX201LA|ME176C|ME102A|\\bM80TA\\b|ME372CL|
        ME560CG|ME372CG|ME302KL| K010 | K011 | K017 | K01E |ME572C|ME103K|ME170C|ME171C|\\bME70C\\b|ME581C|
        ME581CL|ME8510C|ME181C|P01Y|PO1MA|P01Z|\\bP027\\b|\\bP024\\b|\\bP00C\\b`),
  BlackBerryTablet: /PlayBook|RIM Tablet/,
  HTCtablet: /HTC_Flyer_P512|HTC Flyer|HTC Jetstream|HTC-P715a|HTC EVO View 4G|PG41200|PG09410/,
  MotorolaTablet: /xoom|sholest|MZ615|MZ605|MZ505|MZ601|MZ602|MZ603|MZ604|MZ606|MZ607|MZ608|MZ609|MZ615|MZ616|MZ617/,
  NookTablet: /Android.*Nook|NookColor|nook browser|BNRV200|BNRV200A|BNTV250|BNTV250A|BNTV400|BNTV600|LogicPD Zoom2/,
  AcerTablet: new RegExp(`Android.*; \\b(A100|A101|A110|A200|A210|A211|A500|A501|A510|A511|A700|A701|W500|W500P|W501|
        W501P|W510|W511|W700|G100|G100W|B1-A71|B1-710|B1-711|A1-810|A1-811|A1-830)\\b|W3-810|\\bA3-A10\\b|\\bA3-A11\\b|
        \\bA3-A20\\b|\\bA3-A30`),
  ToshibaTablet: /Android.*(AT100|AT105|AT200|AT205|AT270|AT275|AT300|AT305|AT1S5|AT500|AT570|AT700|AT830)|TOSHIBA.*FOLIO/,
  LGTablet: /\bL-06C|LG-V909|LG-V900|LG-V700|LG-V510|LG-V500|LG-V410|LG-V400|LG-VK810\b/,
  FujitsuTablet: /Android.*\b(F-01D|F-02F|F-05E|F-10D|M532|Q572)\b/,
  PrestigioTablet: new RegExp(`PMP3170B|PMP3270B|PMP3470B|PMP7170B|PMP3370B|PMP3570C|PMP5870C|PMP3670B|PMP5570C|
        PMP5770D|PMP3970B|PMP3870C|PMP5580C|PMP5880D|PMP5780D|PMP5588C|PMP7280C|PMP7280C3G|PMP7280|PMP7880D|
        PMP5597D|PMP5597|PMP7100D|PER3464|PER3274|PER3574|PER3884|PER5274|PER5474|PMP5097CPRO|PMP5097|PMP7380D|
        PMP5297C|PMP5297C_QUAD|PMP812E|PMP812E3G|PMP812F|PMP810E|PMP880TD|PMT3017|PMT3037|PMT3047|PMT3057|PMT7008|
        PMT5887|PMT5001|PMT5002`),
  LenovoTablet: new RegExp(`Lenovo TAB|Idea(Tab|Pad)( A1|A10| K1|)|ThinkPad([ ]+)?Tablet|YT3-850M|YT3-X90L|YT3-X90F|
        YT3-X90X|Lenovo.*(S2109|S2110|S5000|S6000|K3011|A3000|A3500|A1000|A2107|A2109|A1107|A5500|A7600|B6000|
        B8000|B8080)(-|)(FL|F|HV|H|)|TB-X606F|TB-X103F|TB-X304F|TB-X304L|TB-X704F|TB-8703F|Tab2A7-10F|TB2-X30L|TB-8504F`),
  DellTablet: /Venue 11|Venue 8|Venue 7|Dell Streak 10|Dell Streak 7/,
  YarvikTablet: new RegExp(`Android.*\\b(TAB210|TAB211|TAB224|TAB250|TAB260|TAB264|TAB310|TAB360|TAB364|TAB410|TAB411|
        TAB420|TAB424|TAB450|TAB460|TAB461|TAB464|TAB465|TAB467|TAB468|TAB07-100|TAB07-101|TAB07-150|TAB07-151|
        TAB07-152|TAB07-200|TAB07-201-3G|TAB07-210|TAB07-211|TAB07-212|TAB07-214|TAB07-220|TAB07-400|TAB07-485|
        TAB08-150|TAB08-200|TAB08-201-3G|TAB08-201-30|TAB09-100|TAB09-211|TAB09-410|TAB10-150|TAB10-201|TAB10-211|
        TAB10-400|TAB10-410|TAB13-201|TAB274EUK|TAB275EUK|TAB374EUK|TAB462EUK|TAB474EUK|TAB9-200)\\b`),
  MedionTablet: /Android.*\bOYO\b|LIFE.*(P9212|P9514|P9516|S9512)|LIFETAB/,
  ArnovaTablet: /97G4|AN10G2|AN7bG3|AN7fG3|AN8G3|AN8cG3|AN7G3|AN9G3|AN7dG3|AN7dG3ST|AN7dG3ChildPad|AN10bG3|AN10bG3DT|AN9G2/,
  IntensoTablet: /INM8002KP|INM1010FP|INM805ND|Intenso Tab|TAB1004/,
  IRUTablet: /M702pro/,
  MegafonTablet: /MegaFon V9|\bZTE V9\b|Android.*\bMT7A\b/,
  EbodaTablet: /E-Boda (Supreme|Impresspeed|Izzycomm|Essential)/,
  AllViewTablet: /Allview.*(Viva|Alldro|City|Speed|All TV|Frenzy|Quasar|Shine|TX1|AX1|AX2)/,
  ArchosTablet: new RegExp(`\\b(101G9|80G9|A101IT)\\b|Qilive 97R|Archos5|\\bARCHOS (70|79|80|90|97|101|FAMILYPAD|)(b|c|)(G10|
         Cobalt| TITANIUM(HD|)| Xenon| Neon|XSK| 2| XS 2| PLATINUM| CARBON|GAMEPAD)\\b`),
  AinolTablet: /NOVO7|NOVO8|NOVO10|Novo7Aurora|Novo7Basic|NOVO7PALADIN|novo9-Spark/,
  NokiaLumiaTablet: /Lumia 2520/,
  SonyTablet: new RegExp(`Sony.*Tablet|Xperia Tablet|Sony Tablet S|SO-03E|SGPT12|SGPT13|SGPT114|SGPT121|SGPT122|SGPT123|
        SGPT111|SGPT112|SGPT113|SGPT131|SGPT132|SGPT133|SGPT211|SGPT212|SGPT213|SGP311|SGP312|SGP321|EBRD1101|
        EBRD1102|EBRD1201|SGP351|SGP341|SGP511|SGP512|SGP521|SGP541|SGP551|SGP621|SGP641|SGP612|SOT31|SGP771|SGP611|
        SGP612|SGP712`),
  PhilipsTablet: /\b(PI2010|PI3000|PI3100|PI3105|PI3110|PI3205|PI3210|PI3900|PI4010|PI7000|PI7100)\b/,
  CubeTablet: /Android.*(K8GT|U9GT|U10GT|U16GT|U17GT|U18GT|U19GT|U20GT|U23GT|U30GT)|CUBE U8GT/,
  CobyTablet: new RegExp(`MID1042|MID1045|MID1125|MID1126|MID7012|MID7014|MID7015|MID7034|MID7035|MID7036|MID7042|MID7048|
        MID7127|MID8042|MID8048|MID8127|MID9042|MID9740|MID9742|MID7022|MID7010`),
  MIDTablet: new RegExp(`M9701|M9000|M9100|M806|M1052|M806|T703|MID701|MID713|MID710|MID727|MID760|MID830|MID728|MID933|
        MID125|MID810|MID732|MID120|MID930|MID800|MID731|MID900|MID100|MID820|MID735|MID980|MID130|MID833|MID737|
        MID960|MID135|MID860|MID736|MID140|MID930|MID835|MID733|MID4X10`),
  MSITablet: new RegExp(`MSI \\b(Primo 73K|Primo 73L|Primo 81L|Primo 77|Primo 93|Primo 75|Primo 76|Primo 73|Primo 81|
        Primo 91|Primo 90|Enjoy 71|Enjoy 7|Enjoy 10)\\b`),
  SMiTTablet: /Android.*(\bMID\b|MID-560|MTV-T1200|MTV-PND531|MTV-P1101|MTV-PND530)/,
  RockChipTablet: /Android.*(RK2818|RK2808A|RK2918|RK3066)|RK2738|RK2808A/,
  FlyTablet: /IQ310|Fly Vision/,
  bqTablet: new RegExp(`Android.*(bq)?.*(Elcano|Curie|Edison|Maxwell|Kepler|Pascal|Tesla|Hypatia|Platon|Newton|
        Livingstone|Cervantes|Avant|Aquaris ([E|M]10|M8))|Maxwell.*Lite|Maxwell.*Plus`),
  HuaweiTablet: new RegExp(`MediaPad|MediaPad 7 Youth|MediaPad T3 10|IDEOS S7|S7-201c|S7-202u|S7-101|S7-103|S7-104|S7-105|S7-106|
        S7-201|S7-Slim|M2-A01L|BAH-L09|BAH-W09|AGS-W09`),
  NecTablet: /\bN-06D|\bN-08D/,
  PantechTablet: /Pantech.*P4100/,
  BronchoTablet: /Broncho.*(N701|N708|N802|a710)/,
  VersusTablet: /TOUCHPAD.*[78910]|\bTOUCHTAB\b/,
  ZyncTablet: /z1000|Z99 2G|z99|z930|z999|z990|z909|Z919|z900/,
  PositivoTablet: /TB07STA|TB10STA|TB07FTA|TB10FTA/,
  NabiTablet: /Android.*\bNabi/,
  KoboTablet: /Kobo Touch|\bK080\b|\bVox\b Build|\bArc\b Build/,
  DanewTablet: /DSlide.*\b(700|701R|702|703R|704|802|970|971|972|973|974|1010|1012)\b/,
  TexetTablet: new RegExp(`NaviPad|TB-772A|TM-7045|TM-7055|TM-9750|TM-7016|TM-7024|TM-7026|TM-7041|TM-7043|TM-7047|
        TM-8041|TM-9741|TM-9747|TM-9748|TM-9751|TM-7022|TM-7021|TM-7020|TM-7011|TM-7010|TM-7023|TM-7025|
        TM-7037W|TM-7038W|TM-7027W|TM-9720|TM-9725|TM-9737W|TM-1020|TM-9738W|TM-9740|TM-9743W|TB-807A|TB-771A|
        TB-727A|TB-725A|TB-719A|TB-823A|TB-805A|TB-723A|TB-715A|TB-707A|TB-705A|TB-709A|TB-711A|TB-890HD|
        TB-880HD|TB-790HD|TB-780HD|TB-770HD|TB-721HD|TB-710HD|TB-434HD|TB-860HD|TB-840HD|TB-760HD|TB-750HD|
        TB-740HD|TB-730HD|TB-722HD|TB-720HD|TB-700HD|TB-500HD|TB-470HD|TB-431HD|TB-430HD|TB-506|TB-504|TB-446|
        TB-436|TB-416|TB-146SE|TB-126SE`),
  PlaystationTablet: /Playstation.*(Portable|Vita)/,
  TrekstorTablet: /ST10416-1|VT10416-1|ST70408-1|ST702xx-1|ST702xx-2|ST80208|ST97216|ST70104-2|VT10416-2|ST10216-2A|SurfTab/,
  PyleAudioTablet: /\b(PTBL10CEU|PTBL10C|PTBL72BC|PTBL72BCEU|PTBL7CEU|PTBL7C|PTBL92BC|PTBL92BCEU|PTBL9CEU|PTBL9CUK|PTBL9C)\b/,
  AdvanTablet: new RegExp(`Android.* \\b(E3A|T3X|T5C|T5B|T3E|T3C|T3B|T1J|T1F|T2A|T1H|T1i|E1C|T1-E|T5-A|T4|E1-B|T2Ci|
        T1-B|T1-D|O1-A|E1-A|T1-A|T3A|T4i)\\b`),
  DanyTechTablet: `Genius Tab G3|Genius Tab S2|Genius Tab Q3|Genius Tab G4|Genius Tab Q4|Genius Tab G-II|
        Genius TAB GII|Genius TAB GIII|Genius Tab S1`,
  GalapadTablet: /Android.*\bG1\b(?!\))/,
  MicromaxTablet: /Funbook|Micromax.*\b(P250|P560|P360|P362|P600|P300|P350|P500|P275)\b/,
  KarbonnTablet: /Android.*\b(A39|A37|A34|ST8|ST10|ST7|Smart Tab3|Smart Tab2)\b/,
  AllFineTablet: /Fine7 Genius|Fine7 Shine|Fine7 Air|Fine8 Style|Fine9 More|Fine10 Joy|Fine11 Wide/,
  PROSCANTablet: new RegExp(`\\b(PEM63|PLT1023G|PLT1041|PLT1044|PLT1044G|PLT1091|PLT4311|PLT4311PL|PLT4315|PLT7030|
        PLT7033|PLT7033D|PLT7035|PLT7035D|PLT7044K|PLT7045K|PLT7045KB|PLT7071KG|PLT7072|PLT7223G|PLT7225G|
        PLT7777G|PLT7810K|PLT7849G|PLT7851G|PLT7852G|PLT8015|PLT8031|PLT8034|PLT8036|PLT8080K|PLT8082|PLT8088|
        PLT8223G|PLT8234G|PLT8235G|PLT8816K|PLT9011|PLT9045K|PLT9233G|PLT9735|PLT9760G|PLT9770G)\\b`),
  YONESTablet: /BQ1078|BC1003|BC1077|RK9702|BC9730|BC9001|IT9001|BC7008|BC7010|BC708|BC728|BC7012|BC7030|BC7027|BC7026/,
  ChangJiaTablet: new RegExp(`TPC7102|TPC7103|TPC7105|TPC7106|TPC7107|TPC7201|TPC7203|TPC7205|TPC7210|TPC7708|TPC7709|
        TPC7712|TPC7110|TPC8101|TPC8103|TPC8105|TPC8106|TPC8203|TPC8205|TPC8503|TPC9106|TPC9701|TPC97101|TPC97103|
        TPC97105|TPC97106|TPC97111|TPC97113|TPC97203|TPC97603|TPC97809|TPC97205|TPC10101|TPC10103|TPC10106|
        TPC10111|TPC10203|TPC10205|TPC10503`),
  GUTablet: /TX-A1301|TX-M9002|Q702|kf026/,
  PointOfViewTablet: new RegExp(`TAB-P506|TAB-navi-7-3G-M|TAB-P517|TAB-P-527|TAB-P701|TAB-P703|TAB-P721|TAB-P731N|
        TAB-P741|TAB-P825|TAB-P905|TAB-P925|TAB-PR945|TAB-PL1015|TAB-P1025|TAB-PI1045|TAB-P1325|TAB-PROTAB[0-9]+|
        TAB-PROTAB25|TAB-PROTAB26|TAB-PROTAB27|TAB-PROTAB26XL|TAB-PROTAB2-IPS9|TAB-PROTAB30-IPS9|TAB-PROTAB25XXL|
        TAB-PROTAB26-IPS10|TAB-PROTAB30-IPS10`),
  OvermaxTablet: new RegExp(`OV-(SteelCore|NewBase|Basecore|Baseone|Exellen|Quattor|EduTab|Solution|ACTION|BasicTab|TeddyTab|
        MagicTab|Stream|TB-08|TB-09)|Qualcore 1027`),
  HCLTablet: /HCL.*Tablet|Connect-3G-2.0|Connect-2G-2.0|ME Tablet U1|ME Tablet U2|ME Tablet G1|ME Tablet X1|ME Tablet Y2|ME Tablet Sync/,
  DPSTablet: /DPS Dream 9|DPS Dual 7/,
  VistureTablet: /V97 HD|i75 3G|Visture V4( HD)?|Visture V5( HD)?|Visture V10/,
  CrestaTablet: /CTP(-)?810|CTP(-)?818|CTP(-)?828|CTP(-)?838|CTP(-)?888|CTP(-)?978|CTP(-)?980|CTP(-)?987|CTP(-)?988|CTP(-)?989/,
  MediatekTablet: /\bMT8125|MT8389|MT8135|MT8377\b/,
  ConcordeTablet: /Concorde([ ]+)?Tab|ConCorde ReadMan/,
  GoCleverTablet: new RegExp(`GOCLEVER TAB|A7GOCLEVER|M1042|M7841|M742|R1042BK|R1041|TAB A975|TAB A7842|TAB A741|TAB A741L|TAB M723G|
        TAB M721|TAB A1021|TAB I921|TAB R721|TAB I720|TAB T76|TAB R70|TAB R76.2|TAB R106|TAB R83.2|TAB M813G|TAB I721|
        GCTA722|TAB I70|TAB I71|TAB S73|TAB R73|TAB R74|TAB R93|TAB R75|TAB R76.1|TAB A73|TAB A93|TAB A93.2|TAB T72|
        TAB R83|TAB R974|TAB R973|TAB A101|TAB A103|TAB A104|TAB A104.2|R105BK|M713G|A972BK|TAB A971|TAB R974.2|
        TAB R104|TAB R83.3|TAB A1042`),
  ModecomTablet: new RegExp(`FreeTAB 9000|FreeTAB 7.4|FreeTAB 7004|FreeTAB 7800|FreeTAB 2096|FreeTAB 7.5|FreeTAB 1014|
        FreeTAB 1001 |FreeTAB 8001|FreeTAB 9706|FreeTAB 9702|FreeTAB 7003|FreeTAB 7002|FreeTAB 1002|FreeTAB 7801|
        FreeTAB 1331|FreeTAB 1004|FreeTAB 8002|FreeTAB 8014|FreeTAB 9704|FreeTAB 1003`),
  VoninoTablet: new RegExp(`\\b(Argus[ _]?S|Diamond[ _]?79HD|Emerald[ _]?78E|Luna[ _]?70C|Onyx[ _]?S|Onyx[ _]?Z|
        Orin[ _]?HD|Orin[ _]?S|Otis[ _]?S|SpeedStar[ _]?S|Magnet[ _]?M9|Primus[ _]?94[ _]?3G|Primus[ _]?94HD|
        Primus[ _]?QS|Android.*\\bQ8\\b|Sirius[ _]?EVO[ _]?QS|Sirius[ _]?QS|Spirit[ _]?S)\\b`),
  ECSTablet: /V07OT2|TM105A|S10OT1|TR10CS1/,
  StorexTablet: /eZee[_']?(Tab|Go)[0-9]+|TabLC7|Looney Tunes Tab/,
  VodafoneTablet: /SmartTab([ ]+)?[0-9]+|SmartTabII10|SmartTabII7|VF-1497/,
  EssentielBTablet: /Smart[ ']?TAB[ ]+?[0-9]+|Family[ ']?TAB2/,
  RossMoorTablet: /RM-790|RM-997|RMD-878G|RMD-974R|RMT-705A|RMT-701|RME-601|RMT-501|RMT-711/,
  iMobileTablet: /i-mobile i-note/,
  TolinoTablet: /tolino tab [0-9.]+|tolino shine/,
  AudioSonicTablet: /\bC-22Q|T7-QC|T-17B|T-17P\b/,
  AMPETablet: /Android.* A78 /,
  SkkTablet: /Android.* (SKYPAD|PHOENIX|CYCLOPS)/,
  TecnoTablet: /TECNO P9|TECNO DP8D/,
  JXDTablet: new RegExp(`Android.* \\b(F3000|A3300|JXD5000|JXD3000|JXD2000|JXD300B|JXD300|S5800|S7800|S602b|S5110b|S7300|
        S5300|S602|S603|S5100|S5110|S601|S7100a|P3000F|P3000s|P101|P200s|P1000m|P200m|P9100|P1000s|S6600b|S908|
        P1000|P300|S18|S6600|S9100)\\b`),
  iJoyTablet: new RegExp(`Tablet (Spirit 7|Essentia|Galatea|Fusion|Onix 7|Landa|Titan|Scooby|Deox|Stella|Themis|Argon|
        Unique 7|Sygnus|Hexen|Finity 7|Cream|Cream X2|Jade|Neon 7|Neron 7|Kandy|Scape|Saphyr 7|Rebel|Biox|Rebel|
        Rebel 8GB|Myst|Draco 7|Myst|Tab7-004|Myst|Tadeo Jones|Tablet Boing|Arrow|Draco Dual Cam|Aurix|Mint|Amity|
        Revolution|Finity 9|Neon 9|T9w|Amity 4GB Dual Cam|Stone 4GB|Stone 8GB|Andromeda|Silken|X2|Andromeda II|
        Halley|Flame|Saphyr 9,7|Touch 8|Planet|Triton|Unique 10|Hexen 10|Memphis 4GB|Memphis 8GB|Onix 10)`),
  FX2Tablet: /FX2 PAD7|FX2 PAD10/,
  XoroTablet: new RegExp(`KidsPAD 701|PAD[ ]?712|PAD[ ]?714|PAD[ ]?716|PAD[ ]?717|PAD[ ]?718|PAD[ ]?720|PAD[ ]?721|
        PAD[ ]?722|PAD[ ]?790|PAD[ ]?792|PAD[ ]?900|PAD[ ]?9715D|PAD[ ]?9716DR|PAD[ ]?9718DR|PAD[ ]?9719QR|
        PAD[ ]?9720QR|TelePAD1030|Telepad1032|TelePAD730|TelePAD731|TelePAD732|TelePAD735Q|TelePAD830|TelePAD9730|
        TelePAD795|MegaPAD 1331|MegaPAD 1851|MegaPAD 2151`),
  ViewsonicTablet: /ViewPad 10pi|ViewPad 10e|ViewPad 10s|ViewPad E72|ViewPad7|ViewPad E100|ViewPad 7e|ViewSonic VB733|VB100a/,
  VerizonTablet: /QTAQZ3|QTAIR7|QTAQTZ3|QTASUN1|QTASUN2|QTAXIA1/,
  OdysTablet: /LOOX|XENO10|ODYS[ -](Space|EVO|Xpress|NOON)|\bXELIO\b|Xelio10Pro|XELIO7PHONETAB|XELIO10EXTREME|XELIOPT2|NEO_QUAD10/,
  CaptivaTablet: /CAPTIVA PAD/,
  IconbitTablet: new RegExp(`NetTAB|NT-3702|NT-3702S|NT-3702S|NT-3603P|NT-3603P|NT-0704S|NT-0704S|NT-3805C|NT-3805C|
        NT-0806C|NT-0806C|NT-0909T|NT-0909T|NT-0907S|NT-0907S|NT-0902S|NT-0902S`),
  TeclastTablet: new RegExp(`T98 4G|\\bP80\\b|\\bX90HD\\b|X98 Air|X98 Air 3G|\\bX89\\b|P80 3G|\\bX80h\\b|P98 Air|
        \\bX89HD\\b|P98 3G|\\bP90HD\\b|P89 3G|X98 3G|\\bP70h\\b|P79HD 3G|G18d 3G|\\bP79HD\\b|\\bP89s\\b|\\bA88\\b|
        \\bP10HD\\b|\\bP19HD\\b|G18 3G|\\bP78HD\\b|\\bA78\\b|\\bP75\\b|G17s 3G|G17h 3G|\\bP85t\\b|\\bP90\\b|
        \\bP11\\b|\\bP98t\\b|\\bP98HD\\b|\\bG18d\\b|\\bP85s\\b|\\bP11HD\\b|\\bP88s\\b|\\bA80HD\\b|\\bA80se\\b|
        \\bA10h\\b|\\bP89\\b|\\bP78s\\b|\\bG18\\b|\\bP85\\b|\\bA70h\\b|\\bA70\\b|\\bG17\\b|\\bP18\\b|\\bA80s\\b|
        \\bA11s\\b|\\bP88HD\\b|\\bA80h\\b|\\bP76s\\b|\\bP76h\\b|\\bP98\\b|\\bA10HD\\b|\\bP78\\b|\\bP88\\b|\\bA11\\b|
        \\bA10t\\b|\\bP76a\\b|\\bP76t\\b|\\bP76e\\b|\\bP85HD\\b|\\bP85a\\b|\\bP86\\b|\\bP75HD\\b|\\bP76v\\b|\\bA12\\b|
        \\bP75a\\b|\\bA15\\b|\\bP76Ti\\b|\\bP81HD\\b|\\bA10\\b|\\bT760VE\\b|\\bT720HD\\b|\\bP76\\b|\\bP73\\b|\\bP71\\b|
        \\bP72\\b|\\bT720SE\\b|\\bC520Ti\\b|\\bT760\\b|\\bT720VE\\b|T720-3GE|T720-WiFi`),
  OndaTablet: new RegExp(`\\b(V975i|Vi30|VX530|V701|Vi60|V701s|Vi50|V801s|V719|Vx610w|VX610W|V819i|Vi10|VX580W|Vi10|
        V711s|V813|V811|V820w|V820|Vi20|V711|VI30W|V712|V891w|V972|V819w|V820w|Vi60|V820w|V711|V813s|V801|V819|
        V975s|V801|V819|V819|V818|V811|V712|V975m|V101w|V961w|V812|V818|V971|V971s|V919|V989|V116w|V102w|V973|
        Vi40)\\b[s]+|V10 \\b4G\\b`),
  JaytechTablet: /TPC-PA762/,
  BlaupunktTablet: /Endeavour 800NG|Endeavour 1010/,
  DigmaTablet: /\b(iDx10|iDx9|iDx8|iDx7|iDxD7|iDxD8|iDsQ8|iDsQ7|iDsQ8|iDsD10|iDnD7|3TS804H|iDsQ11|iDj7|iDs10)\b/,
  EvolioTablet: /ARIA_Mini_wifi|Aria[ _]Mini|Evolio X10|Evolio X7|Evolio X8|\bEvotab\b|\bNeura\b/,
  LavaTablet: /QPAD E704|\bIvoryS\b|E-TAB IVORY|\bE-TAB\b/,
  AocTablet: /MW0811|MW0812|MW0922|MTK8382|MW1031|MW0831|MW0821|MW0931|MW0712/,
  MpmanTablet: new RegExp(`MP11 OCTA|MP10 OCTA|MPQC1114|MPQC1004|MPQC994|MPQC974|MPQC973|MPQC804|MPQC784|MPQC780|
        \\bMPG7\\b|MPDCG75|MPDCG71|MPDC1006|MP101DC|MPDC9000|MPDC905|MPDC706HD|MPDC706|MPDC705|MPDC110|
        MPDC100|MPDC99|MPDC97|MPDC88|MPDC8|MPDC77|MP709|MID701|MID711|MID170|MPDC703|MPQC1010`),
  CelkonTablet: /CT695|CT888|CT[\s]?910|CT7 Tab|CT9 Tab|CT3 Tab|CT2 Tab|CT1 Tab|C820|C720|\bCT-1\b/,
  WolderTablet: new RegExp(`miTab \\b(DIAMOND|SPACE|BROOKLYN|NEO|FLY|MANHATTAN|FUNK|EVOLUTION|SKY|GOCAR|IRON|GENIUS|
        POP|MINT|EPSILON|BROADWAY|JUMP|HOP|LEGEND|NEW AGE|LINE|ADVANCE|FEEL|FOLLOW|LIKE|LINK|LIVE|THINK|
        FREEDOM|CHICAGO|CLEVELAND|BALTIMORE-GH|IOWA|BOSTON|SEATTLE|PHOENIX|DALLAS|IN 101|MasterChef)\\b`),
  MediacomTablet: "M-MPI10C3G|M-SP10EG|M-SP10EGP|M-SP10HXAH|M-SP7HXAH|M-SP10HXBH|M-SP8HXAH|M-SP8MXA",
  MiTablet: /\bMI PAD\b|\bHM NOTE 1W\b/,
  NibiruTablet: /Nibiru M1|Nibiru Jupiter One/,
  NexoTablet: /NEXO NOVA|NEXO 10|NEXO AVIO|NEXO FREE|NEXO GO|NEXO EVO|NEXO 3G|NEXO SMART|NEXO KIDDO|NEXO MOBI/,
  LeaderTablet: new RegExp(`TBLT10Q|TBLT10I|TBL-10WDKB|TBL-10WDKBO2013|TBL-W230V2|TBL-W450|TBL-W500|SV572|TBLT7I|
        TBA-AC7-8G|TBLT79|TBL-8W16|TBL-10W32|TBL-10WKB|TBL-W100`),
  UbislateTablet: /UbiSlate[\s]?7C/,
  PocketBookTablet: /Pocketbook/,
  KocasoTablet: /\b(TB-1207)\b/,
  HisenseTablet: /\b(F5281|E2371)\b/,
  Hudl: /Hudl HT7S3|Hudl 2/,
  TelstraTablet: /T-Hub2/,
  Honeywell: /RT10A/,
  GenericTablet: new RegExp(`Android.*\\b97D\\b|Tablet(?!.*PC)|BNTV250A|MID-WCDMA|LogicPD Zoom2|\\bA7EB\\b|CatNova8|
        A1_07|CT704|CT1002|\\bM721\\b|rk30sdk|\\bEVOTAB\\b|M758A|ET904|ALUMIUM10|Smartfren Tab|Endeavour 1010|
        Tablet-PC-4|Tagi Tab|\\bM6pro\\b|CT1020W|arc 10HD|\\bTP750\\b|\\bQTAQZ3\\b|WVT101|TM1088|KT107`)
};
var AngularDeviceInformationComponent = class _AngularDeviceInformationComponent {
  constructor() {
  }
  ngOnInit() {
  }
  static {
    this.\u0275fac = function AngularDeviceInformationComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _AngularDeviceInformationComponent)();
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({
      type: _AngularDeviceInformationComponent,
      selectors: [["lib-angular-device-information"]],
      standalone: false,
      decls: 2,
      vars: 0,
      template: function AngularDeviceInformationComponent_Template(rf, ctx) {
        if (rf & 1) {
          \u0275\u0275elementStart(0, "p");
          \u0275\u0275text(1, " angular-device-information works! ");
          \u0275\u0275elementEnd();
        }
      },
      encapsulation: 2
    });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(AngularDeviceInformationComponent, [{
    type: Component,
    args: [{
      selector: "lib-angular-device-information",
      template: `
    <p>
      angular-device-information works!
    </p>
  `
    }]
  }], function() {
    return [];
  }, null);
})();
var AngularDeviceInformationModule = class _AngularDeviceInformationModule {
  static {
    this.\u0275fac = function AngularDeviceInformationModule_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _AngularDeviceInformationModule)();
    };
  }
  static {
    this.\u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({
      type: _AngularDeviceInformationModule,
      declarations: [AngularDeviceInformationComponent],
      exports: [AngularDeviceInformationComponent]
    });
  }
  static {
    this.\u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({});
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(AngularDeviceInformationModule, [{
    type: NgModule,
    args: [{
      declarations: [AngularDeviceInformationComponent],
      imports: [],
      exports: [AngularDeviceInformationComponent]
    }]
  }], null, null);
})();

// src/app/service/excel-service.ts
var FileSaver = __toESM(require_FileSaver_min());

// node_modules/xlsx/xlsx.mjs
var XLSX = {};
XLSX.version = "0.18.5";
var current_codepage = 1200;
var current_ansi = 1252;
var VALID_ANSI = [874, 932, 936, 949, 950, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 1e4];
var CS2CP = {
  /*::[*/
  0: 1252,
  /* ANSI */
  /*::[*/
  1: 65001,
  /* DEFAULT */
  /*::[*/
  2: 65001,
  /* SYMBOL */
  /*::[*/
  77: 1e4,
  /* MAC */
  /*::[*/
  128: 932,
  /* SHIFTJIS */
  /*::[*/
  129: 949,
  /* HANGUL */
  /*::[*/
  130: 1361,
  /* JOHAB */
  /*::[*/
  134: 936,
  /* GB2312 */
  /*::[*/
  136: 950,
  /* CHINESEBIG5 */
  /*::[*/
  161: 1253,
  /* GREEK */
  /*::[*/
  162: 1254,
  /* TURKISH */
  /*::[*/
  163: 1258,
  /* VIETNAMESE */
  /*::[*/
  177: 1255,
  /* HEBREW */
  /*::[*/
  178: 1256,
  /* ARABIC */
  /*::[*/
  186: 1257,
  /* BALTIC */
  /*::[*/
  204: 1251,
  /* RUSSIAN */
  /*::[*/
  222: 874,
  /* THAI */
  /*::[*/
  238: 1250,
  /* EASTEUROPE */
  /*::[*/
  255: 1252,
  /* OEM */
  /*::[*/
  69: 6969
  /* MISC */
};
var set_ansi = function(cp) {
  if (VALID_ANSI.indexOf(cp) == -1) return;
  current_ansi = CS2CP[0] = cp;
};
function reset_ansi() {
  set_ansi(1252);
}
var set_cp = function(cp) {
  current_codepage = cp;
  set_ansi(cp);
};
function reset_cp() {
  set_cp(1200);
  reset_ansi();
}
function utf16beread(data) {
  var o = [];
  for (var i = 0; i < data.length >> 1; ++i) o[i] = String.fromCharCode(data.charCodeAt(2 * i + 1) + (data.charCodeAt(2 * i) << 8));
  return o.join("");
}
var _getchar = function _gc1(x) {
  return String.fromCharCode(x);
};
var _getansi = function _ga1(x) {
  return String.fromCharCode(x);
};
var $cptable;
var DENSE = null;
var DIF_XL = true;
var Base64_map = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
function Base64_encode(input) {
  var o = "";
  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;
  for (var i = 0; i < input.length; ) {
    c1 = input.charCodeAt(i++);
    e1 = c1 >> 2;
    c2 = input.charCodeAt(i++);
    e2 = (c1 & 3) << 4 | c2 >> 4;
    c3 = input.charCodeAt(i++);
    e3 = (c2 & 15) << 2 | c3 >> 6;
    e4 = c3 & 63;
    if (isNaN(c2)) {
      e3 = e4 = 64;
    } else if (isNaN(c3)) {
      e4 = 64;
    }
    o += Base64_map.charAt(e1) + Base64_map.charAt(e2) + Base64_map.charAt(e3) + Base64_map.charAt(e4);
  }
  return o;
}
function Base64_decode(input) {
  var o = "";
  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;
  input = input.replace(/[^\w\+\/\=]/g, "");
  for (var i = 0; i < input.length; ) {
    e1 = Base64_map.indexOf(input.charAt(i++));
    e2 = Base64_map.indexOf(input.charAt(i++));
    c1 = e1 << 2 | e2 >> 4;
    o += String.fromCharCode(c1);
    e3 = Base64_map.indexOf(input.charAt(i++));
    c2 = (e2 & 15) << 4 | e3 >> 2;
    if (e3 !== 64) {
      o += String.fromCharCode(c2);
    }
    e4 = Base64_map.indexOf(input.charAt(i++));
    c3 = (e3 & 3) << 6 | e4;
    if (e4 !== 64) {
      o += String.fromCharCode(c3);
    }
  }
  return o;
}
var has_buf = /* @__PURE__ */ function() {
  return typeof Buffer !== "undefined" && typeof process !== "undefined" && typeof process.versions !== "undefined" && !!process.versions.node;
}();
var Buffer_from = /* @__PURE__ */ function() {
  if (typeof Buffer !== "undefined") {
    var nbfs = !Buffer.from;
    if (!nbfs) try {
      Buffer.from("foo", "utf8");
    } catch (e) {
      nbfs = true;
    }
    return nbfs ? function(buf, enc) {
      return enc ? new Buffer(buf, enc) : new Buffer(buf);
    } : Buffer.from.bind(Buffer);
  }
  return function() {
  };
}();
function new_raw_buf(len) {
  if (has_buf) return Buffer.alloc ? Buffer.alloc(len) : new Buffer(len);
  return typeof Uint8Array != "undefined" ? new Uint8Array(len) : new Array(len);
}
function new_unsafe_buf(len) {
  if (has_buf) return Buffer.allocUnsafe ? Buffer.allocUnsafe(len) : new Buffer(len);
  return typeof Uint8Array != "undefined" ? new Uint8Array(len) : new Array(len);
}
var s2a = function s2a2(s) {
  if (has_buf) return Buffer_from(s, "binary");
  return s.split("").map(function(x) {
    return x.charCodeAt(0) & 255;
  });
};
function s2ab(s) {
  if (typeof ArrayBuffer === "undefined") return s2a(s);
  var buf = new ArrayBuffer(s.length), view = new Uint8Array(buf);
  for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 255;
  return buf;
}
function a2s(data) {
  if (Array.isArray(data)) return data.map(function(c) {
    return String.fromCharCode(c);
  }).join("");
  var o = [];
  for (var i = 0; i < data.length; ++i) o[i] = String.fromCharCode(data[i]);
  return o.join("");
}
function a2u(data) {
  if (typeof Uint8Array === "undefined") throw new Error("Unsupported");
  return new Uint8Array(data);
}
var bconcat = has_buf ? function(bufs) {
  return Buffer.concat(bufs.map(function(buf) {
    return Buffer.isBuffer(buf) ? buf : Buffer_from(buf);
  }));
} : function(bufs) {
  if (typeof Uint8Array !== "undefined") {
    var i = 0, maxlen = 0;
    for (i = 0; i < bufs.length; ++i) maxlen += bufs[i].length;
    var o = new Uint8Array(maxlen);
    var len = 0;
    for (i = 0, maxlen = 0; i < bufs.length; maxlen += len, ++i) {
      len = bufs[i].length;
      if (bufs[i] instanceof Uint8Array) o.set(bufs[i], maxlen);
      else if (typeof bufs[i] == "string") {
        throw "wtf";
      } else o.set(new Uint8Array(bufs[i]), maxlen);
    }
    return o;
  }
  return [].concat.apply([], bufs.map(function(buf) {
    return Array.isArray(buf) ? buf : [].slice.call(buf);
  }));
};
function utf8decode(content) {
  var out = [], widx = 0, L = content.length + 250;
  var o = new_raw_buf(content.length + 255);
  for (var ridx = 0; ridx < content.length; ++ridx) {
    var c = content.charCodeAt(ridx);
    if (c < 128) o[widx++] = c;
    else if (c < 2048) {
      o[widx++] = 192 | c >> 6 & 31;
      o[widx++] = 128 | c & 63;
    } else if (c >= 55296 && c < 57344) {
      c = (c & 1023) + 64;
      var d = content.charCodeAt(++ridx) & 1023;
      o[widx++] = 240 | c >> 8 & 7;
      o[widx++] = 128 | c >> 2 & 63;
      o[widx++] = 128 | d >> 6 & 15 | (c & 3) << 4;
      o[widx++] = 128 | d & 63;
    } else {
      o[widx++] = 224 | c >> 12 & 15;
      o[widx++] = 128 | c >> 6 & 63;
      o[widx++] = 128 | c & 63;
    }
    if (widx > L) {
      out.push(o.slice(0, widx));
      widx = 0;
      o = new_raw_buf(65535);
      L = 65530;
    }
  }
  out.push(o.slice(0, widx));
  return bconcat(out);
}
var chr0 = /\u0000/g;
var chr1 = /[\u0001-\u0006]/g;
function _strrev(x) {
  var o = "", i = x.length - 1;
  while (i >= 0) o += x.charAt(i--);
  return o;
}
function pad0(v, d) {
  var t = "" + v;
  return t.length >= d ? t : fill("0", d - t.length) + t;
}
function pad_(v, d) {
  var t = "" + v;
  return t.length >= d ? t : fill(" ", d - t.length) + t;
}
function rpad_(v, d) {
  var t = "" + v;
  return t.length >= d ? t : t + fill(" ", d - t.length);
}
function pad0r1(v, d) {
  var t = "" + Math.round(v);
  return t.length >= d ? t : fill("0", d - t.length) + t;
}
function pad0r2(v, d) {
  var t = "" + v;
  return t.length >= d ? t : fill("0", d - t.length) + t;
}
var p2_32 = /* @__PURE__ */ Math.pow(2, 32);
function pad0r(v, d) {
  if (v > p2_32 || v < -p2_32) return pad0r1(v, d);
  var i = Math.round(v);
  return pad0r2(i, d);
}
function SSF_isgeneral(s, i) {
  i = i || 0;
  return s.length >= 7 + i && (s.charCodeAt(i) | 32) === 103 && (s.charCodeAt(i + 1) | 32) === 101 && (s.charCodeAt(i + 2) | 32) === 110 && (s.charCodeAt(i + 3) | 32) === 101 && (s.charCodeAt(i + 4) | 32) === 114 && (s.charCodeAt(i + 5) | 32) === 97 && (s.charCodeAt(i + 6) | 32) === 108;
}
var days = [["Sun", "Sunday"], ["Mon", "Monday"], ["Tue", "Tuesday"], ["Wed", "Wednesday"], ["Thu", "Thursday"], ["Fri", "Friday"], ["Sat", "Saturday"]];
var months = [["J", "Jan", "January"], ["F", "Feb", "February"], ["M", "Mar", "March"], ["A", "Apr", "April"], ["M", "May", "May"], ["J", "Jun", "June"], ["J", "Jul", "July"], ["A", "Aug", "August"], ["S", "Sep", "September"], ["O", "Oct", "October"], ["N", "Nov", "November"], ["D", "Dec", "December"]];
function SSF_init_table(t) {
  if (!t) t = {};
  t[0] = "General";
  t[1] = "0";
  t[2] = "0.00";
  t[3] = "#,##0";
  t[4] = "#,##0.00";
  t[9] = "0%";
  t[10] = "0.00%";
  t[11] = "0.00E+00";
  t[12] = "# ?/?";
  t[13] = "# ??/??";
  t[14] = "m/d/yy";
  t[15] = "d-mmm-yy";
  t[16] = "d-mmm";
  t[17] = "mmm-yy";
  t[18] = "h:mm AM/PM";
  t[19] = "h:mm:ss AM/PM";
  t[20] = "h:mm";
  t[21] = "h:mm:ss";
  t[22] = "m/d/yy h:mm";
  t[37] = "#,##0 ;(#,##0)";
  t[38] = "#,##0 ;[Red](#,##0)";
  t[39] = "#,##0.00;(#,##0.00)";
  t[40] = "#,##0.00;[Red](#,##0.00)";
  t[45] = "mm:ss";
  t[46] = "[h]:mm:ss";
  t[47] = "mmss.0";
  t[48] = "##0.0E+0";
  t[49] = "@";
  t[56] = '"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "';
  return t;
}
var table_fmt = {
  0: "General",
  1: "0",
  2: "0.00",
  3: "#,##0",
  4: "#,##0.00",
  9: "0%",
  10: "0.00%",
  11: "0.00E+00",
  12: "# ?/?",
  13: "# ??/??",
  14: "m/d/yy",
  15: "d-mmm-yy",
  16: "d-mmm",
  17: "mmm-yy",
  18: "h:mm AM/PM",
  19: "h:mm:ss AM/PM",
  20: "h:mm",
  21: "h:mm:ss",
  22: "m/d/yy h:mm",
  37: "#,##0 ;(#,##0)",
  38: "#,##0 ;[Red](#,##0)",
  39: "#,##0.00;(#,##0.00)",
  40: "#,##0.00;[Red](#,##0.00)",
  45: "mm:ss",
  46: "[h]:mm:ss",
  47: "mmss.0",
  48: "##0.0E+0",
  49: "@",
  56: '"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'
};
var SSF_default_map = {
  5: 37,
  6: 38,
  7: 39,
  8: 40,
  //  5 -> 37 ...  8 -> 40
  23: 0,
  24: 0,
  25: 0,
  26: 0,
  // 23 ->  0 ... 26 ->  0
  27: 14,
  28: 14,
  29: 14,
  30: 14,
  31: 14,
  // 27 -> 14 ... 31 -> 14
  50: 14,
  51: 14,
  52: 14,
  53: 14,
  54: 14,
  // 50 -> 14 ... 58 -> 14
  55: 14,
  56: 14,
  57: 14,
  58: 14,
  59: 1,
  60: 2,
  61: 3,
  62: 4,
  // 59 ->  1 ... 62 ->  4
  67: 9,
  68: 10,
  // 67 ->  9 ... 68 -> 10
  69: 12,
  70: 13,
  71: 14,
  // 69 -> 12 ... 71 -> 14
  72: 14,
  73: 15,
  74: 16,
  75: 17,
  // 72 -> 14 ... 75 -> 17
  76: 20,
  77: 21,
  78: 22,
  // 76 -> 20 ... 78 -> 22
  79: 45,
  80: 46,
  81: 47,
  // 79 -> 45 ... 81 -> 47
  82: 0
  // 82 ->  0 ... 65536 -> 0 (omitted)
};
var SSF_default_str = {
  //  5 -- Currency,   0 decimal, black negative
  5: '"$"#,##0_);\\("$"#,##0\\)',
  63: '"$"#,##0_);\\("$"#,##0\\)',
  //  6 -- Currency,   0 decimal, red   negative
  6: '"$"#,##0_);[Red]\\("$"#,##0\\)',
  64: '"$"#,##0_);[Red]\\("$"#,##0\\)',
  //  7 -- Currency,   2 decimal, black negative
  7: '"$"#,##0.00_);\\("$"#,##0.00\\)',
  65: '"$"#,##0.00_);\\("$"#,##0.00\\)',
  //  8 -- Currency,   2 decimal, red   negative
  8: '"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',
  66: '"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',
  // 41 -- Accounting, 0 decimal, No Symbol
  41: '_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',
  // 42 -- Accounting, 0 decimal, $  Symbol
  42: '_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',
  // 43 -- Accounting, 2 decimal, No Symbol
  43: '_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',
  // 44 -- Accounting, 2 decimal, $  Symbol
  44: '_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'
};
function SSF_frac(x, D, mixed) {
  var sgn = x < 0 ? -1 : 1;
  var B = x * sgn;
  var P_2 = 0, P_1 = 1, P = 0;
  var Q_2 = 1, Q_1 = 0, Q = 0;
  var A = Math.floor(B);
  while (Q_1 < D) {
    A = Math.floor(B);
    P = A * P_1 + P_2;
    Q = A * Q_1 + Q_2;
    if (B - A < 5e-8) break;
    B = 1 / (B - A);
    P_2 = P_1;
    P_1 = P;
    Q_2 = Q_1;
    Q_1 = Q;
  }
  if (Q > D) {
    if (Q_1 > D) {
      Q = Q_2;
      P = P_2;
    } else {
      Q = Q_1;
      P = P_1;
    }
  }
  if (!mixed) return [0, sgn * P, Q];
  var q = Math.floor(sgn * P / Q);
  return [q, sgn * P - q * Q, Q];
}
function SSF_parse_date_code(v, opts, b2) {
  if (v > 2958465 || v < 0) return null;
  var date = v | 0, time = Math.floor(86400 * (v - date)), dow = 0;
  var dout = [];
  var out = {
    D: date,
    T: time,
    u: 86400 * (v - date) - time,
    y: 0,
    m: 0,
    d: 0,
    H: 0,
    M: 0,
    S: 0,
    q: 0
  };
  if (Math.abs(out.u) < 1e-6) out.u = 0;
  if (opts && opts.date1904) date += 1462;
  if (out.u > 0.9999) {
    out.u = 0;
    if (++time == 86400) {
      out.T = time = 0;
      ++date;
      ++out.D;
    }
  }
  if (date === 60) {
    dout = b2 ? [1317, 10, 29] : [1900, 2, 29];
    dow = 3;
  } else if (date === 0) {
    dout = b2 ? [1317, 8, 29] : [1900, 1, 0];
    dow = 6;
  } else {
    if (date > 60) --date;
    var d = new Date(1900, 0, 1);
    d.setDate(d.getDate() + date - 1);
    dout = [d.getFullYear(), d.getMonth() + 1, d.getDate()];
    dow = d.getDay();
    if (date < 60) dow = (dow + 6) % 7;
    if (b2) dow = SSF_fix_hijri(d, dout);
  }
  out.y = dout[0];
  out.m = dout[1];
  out.d = dout[2];
  out.S = time % 60;
  time = Math.floor(time / 60);
  out.M = time % 60;
  time = Math.floor(time / 60);
  out.H = time;
  out.q = dow;
  return out;
}
var SSFbasedate = /* @__PURE__ */ new Date(1899, 11, 31, 0, 0, 0);
var SSFdnthresh = /* @__PURE__ */ SSFbasedate.getTime();
var SSFbase1904 = /* @__PURE__ */ new Date(1900, 2, 1, 0, 0, 0);
function datenum_local(v, date1904) {
  var epoch = /* @__PURE__ */ v.getTime();
  if (date1904) epoch -= 1461 * 24 * 60 * 60 * 1e3;
  else if (v >= SSFbase1904) epoch += 24 * 60 * 60 * 1e3;
  return (epoch - (SSFdnthresh + (/* @__PURE__ */ v.getTimezoneOffset() - /* @__PURE__ */ SSFbasedate.getTimezoneOffset()) * 6e4)) / (24 * 60 * 60 * 1e3);
}
function SSF_strip_decimal(o) {
  return o.indexOf(".") == -1 ? o : o.replace(/(?:\.0*|(\.\d*[1-9])0+)$/, "$1");
}
function SSF_normalize_exp(o) {
  if (o.indexOf("E") == -1) return o;
  return o.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/, "$1E").replace(/(E[+-])(\d)$/, "$10$2");
}
function SSF_small_exp(v) {
  var w = v < 0 ? 12 : 11;
  var o = SSF_strip_decimal(v.toFixed(12));
  if (o.length <= w) return o;
  o = v.toPrecision(10);
  if (o.length <= w) return o;
  return v.toExponential(5);
}
function SSF_large_exp(v) {
  var o = SSF_strip_decimal(v.toFixed(11));
  return o.length > (v < 0 ? 12 : 11) || o === "0" || o === "-0" ? v.toPrecision(6) : o;
}
function SSF_general_num(v) {
  var V = Math.floor(Math.log(Math.abs(v)) * Math.LOG10E), o;
  if (V >= -4 && V <= -1) o = v.toPrecision(10 + V);
  else if (Math.abs(V) <= 9) o = SSF_small_exp(v);
  else if (V === 10) o = v.toFixed(10).substr(0, 12);
  else o = SSF_large_exp(v);
  return SSF_strip_decimal(SSF_normalize_exp(o.toUpperCase()));
}
function SSF_general(v, opts) {
  switch (typeof v) {
    case "string":
      return v;
    case "boolean":
      return v ? "TRUE" : "FALSE";
    case "number":
      return (v | 0) === v ? v.toString(10) : SSF_general_num(v);
    case "undefined":
      return "";
    case "object":
      if (v == null) return "";
      if (v instanceof Date) return SSF_format(14, datenum_local(v, opts && opts.date1904), opts);
  }
  throw new Error("unsupported value in General format: " + v);
}
function SSF_fix_hijri(date, o) {
  o[0] -= 581;
  var dow = date.getDay();
  if (date < 60) dow = (dow + 6) % 7;
  return dow;
}
function SSF_write_date(type, fmt, val, ss0) {
  var o = "", ss = 0, tt = 0, y = val.y, out, outl = 0;
  switch (type) {
    case 98:
      y = val.y + 543;
    /* falls through */
    case 121:
      switch (fmt.length) {
        case 1:
        case 2:
          out = y % 100;
          outl = 2;
          break;
        default:
          out = y % 1e4;
          outl = 4;
          break;
      }
      break;
    case 109:
      switch (fmt.length) {
        case 1:
        case 2:
          out = val.m;
          outl = fmt.length;
          break;
        case 3:
          return months[val.m - 1][1];
        case 5:
          return months[val.m - 1][0];
        default:
          return months[val.m - 1][2];
      }
      break;
    case 100:
      switch (fmt.length) {
        case 1:
        case 2:
          out = val.d;
          outl = fmt.length;
          break;
        case 3:
          return days[val.q][0];
        default:
          return days[val.q][1];
      }
      break;
    case 104:
      switch (fmt.length) {
        case 1:
        case 2:
          out = 1 + (val.H + 11) % 12;
          outl = fmt.length;
          break;
        default:
          throw "bad hour format: " + fmt;
      }
      break;
    case 72:
      switch (fmt.length) {
        case 1:
        case 2:
          out = val.H;
          outl = fmt.length;
          break;
        default:
          throw "bad hour format: " + fmt;
      }
      break;
    case 77:
      switch (fmt.length) {
        case 1:
        case 2:
          out = val.M;
          outl = fmt.length;
          break;
        default:
          throw "bad minute format: " + fmt;
      }
      break;
    case 115:
      if (fmt != "s" && fmt != "ss" && fmt != ".0" && fmt != ".00" && fmt != ".000") throw "bad second format: " + fmt;
      if (val.u === 0 && (fmt == "s" || fmt == "ss")) return pad0(val.S, fmt.length);
      if (ss0 >= 2) tt = ss0 === 3 ? 1e3 : 100;
      else tt = ss0 === 1 ? 10 : 1;
      ss = Math.round(tt * (val.S + val.u));
      if (ss >= 60 * tt) ss = 0;
      if (fmt === "s") return ss === 0 ? "0" : "" + ss / tt;
      o = pad0(ss, 2 + ss0);
      if (fmt === "ss") return o.substr(0, 2);
      return "." + o.substr(2, fmt.length - 1);
    case 90:
      switch (fmt) {
        case "[h]":
        case "[hh]":
          out = val.D * 24 + val.H;
          break;
        case "[m]":
        case "[mm]":
          out = (val.D * 24 + val.H) * 60 + val.M;
          break;
        case "[s]":
        case "[ss]":
          out = ((val.D * 24 + val.H) * 60 + val.M) * 60 + Math.round(val.S + val.u);
          break;
        default:
          throw "bad abstime format: " + fmt;
      }
      outl = fmt.length === 3 ? 1 : 2;
      break;
    case 101:
      out = y;
      outl = 1;
      break;
  }
  var outstr = outl > 0 ? pad0(out, outl) : "";
  return outstr;
}
function commaify(s) {
  var w = 3;
  if (s.length <= w) return s;
  var j = s.length % w, o = s.substr(0, j);
  for (; j != s.length; j += w) o += (o.length > 0 ? "," : "") + s.substr(j, w);
  return o;
}
var pct1 = /%/g;
function write_num_pct(type, fmt, val) {
  var sfmt = fmt.replace(pct1, ""), mul = fmt.length - sfmt.length;
  return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill("%", mul);
}
function write_num_cm(type, fmt, val) {
  var idx = fmt.length - 1;
  while (fmt.charCodeAt(idx - 1) === 44) --idx;
  return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));
}
function write_num_exp(fmt, val) {
  var o;
  var idx = fmt.indexOf("E") - fmt.indexOf(".") - 1;
  if (fmt.match(/^#+0.0E\+0$/)) {
    if (val == 0) return "0.0E+0";
    else if (val < 0) return "-" + write_num_exp(fmt, -val);
    var period = fmt.indexOf(".");
    if (period === -1) period = fmt.indexOf("E");
    var ee = Math.floor(Math.log(val) * Math.LOG10E) % period;
    if (ee < 0) ee += period;
    o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);
    if (o.indexOf("e") === -1) {
      var fakee = Math.floor(Math.log(val) * Math.LOG10E);
      if (o.indexOf(".") === -1) o = o.charAt(0) + "." + o.substr(1) + "E+" + (fakee - o.length + ee);
      else o += "E+" + (fakee - ee);
      while (o.substr(0, 2) === "0.") {
        o = o.charAt(0) + o.substr(2, period) + "." + o.substr(2 + period);
        o = o.replace(/^0+([1-9])/, "$1").replace(/^0+\./, "0.");
      }
      o = o.replace(/\+-/, "-");
    }
    o = o.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/, function($$, $1, $2, $3) {
      return $1 + $2 + $3.substr(0, (period + ee) % period) + "." + $3.substr(ee) + "E";
    });
  } else o = val.toExponential(idx);
  if (fmt.match(/E\+00$/) && o.match(/e[+-]\d$/)) o = o.substr(0, o.length - 1) + "0" + o.charAt(o.length - 1);
  if (fmt.match(/E\-/) && o.match(/e\+/)) o = o.replace(/e\+/, "e");
  return o.replace("e", "E");
}
var frac1 = /# (\?+)( ?)\/( ?)(\d+)/;
function write_num_f1(r, aval, sign) {
  var den = parseInt(r[4], 10), rr = Math.round(aval * den), base = Math.floor(rr / den);
  var myn = rr - base * den, myd = den;
  return sign + (base === 0 ? "" : "" + base) + " " + (myn === 0 ? fill(" ", r[1].length + 1 + r[4].length) : pad_(myn, r[1].length) + r[2] + "/" + r[3] + pad0(myd, r[4].length));
}
function write_num_f2(r, aval, sign) {
  return sign + (aval === 0 ? "" : "" + aval) + fill(" ", r[1].length + 2 + r[4].length);
}
var dec1 = /^#*0*\.([0#]+)/;
var closeparen = /\).*[0#]/;
var phone = /\(###\) ###\\?-####/;
function hashq(str) {
  var o = "", cc;
  for (var i = 0; i != str.length; ++i) switch (cc = str.charCodeAt(i)) {
    case 35:
      break;
    case 63:
      o += " ";
      break;
    case 48:
      o += "0";
      break;
    default:
      o += String.fromCharCode(cc);
  }
  return o;
}
function rnd(val, d) {
  var dd = Math.pow(10, d);
  return "" + Math.round(val * dd) / dd;
}
function dec(val, d) {
  var _frac = val - Math.floor(val), dd = Math.pow(10, d);
  if (d < ("" + Math.round(_frac * dd)).length) return 0;
  return Math.round(_frac * dd);
}
function carry(val, d) {
  if (d < ("" + Math.round((val - Math.floor(val)) * Math.pow(10, d))).length) {
    return 1;
  }
  return 0;
}
function flr(val) {
  if (val < 2147483647 && val > -2147483648) return "" + (val >= 0 ? val | 0 : val - 1 | 0);
  return "" + Math.floor(val);
}
function write_num_flt(type, fmt, val) {
  if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {
    var ffmt = fmt.replace(/\( */, "").replace(/ \)/, "").replace(/\)/, "");
    if (val >= 0) return write_num_flt("n", ffmt, val);
    return "(" + write_num_flt("n", ffmt, -val) + ")";
  }
  if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);
  if (fmt.indexOf("%") !== -1) return write_num_pct(type, fmt, val);
  if (fmt.indexOf("E") !== -1) return write_num_exp(fmt, val);
  if (fmt.charCodeAt(0) === 36) return "$" + write_num_flt(type, fmt.substr(fmt.charAt(1) == " " ? 2 : 1), val);
  var o;
  var r, ri, ff, aval = Math.abs(val), sign = val < 0 ? "-" : "";
  if (fmt.match(/^00+$/)) return sign + pad0r(aval, fmt.length);
  if (fmt.match(/^[#?]+$/)) {
    o = pad0r(val, 0);
    if (o === "0") o = "";
    return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;
  }
  if (r = fmt.match(frac1)) return write_num_f1(r, aval, sign);
  if (fmt.match(/^#+0+$/)) return sign + pad0r(aval, fmt.length - fmt.indexOf("0"));
  if (r = fmt.match(dec1)) {
    o = rnd(val, r[1].length).replace(/^([^\.]+)$/, "$1." + hashq(r[1])).replace(/\.$/, "." + hashq(r[1])).replace(/\.(\d*)$/, function($$, $1) {
      return "." + $1 + fill("0", hashq(
        /*::(*/
        r[1]
      ).length - $1.length);
    });
    return fmt.indexOf("0.") !== -1 ? o : o.replace(/^0\./, ".");
  }
  fmt = fmt.replace(/^#+([0.])/, "$1");
  if (r = fmt.match(/^(0*)\.(#*)$/)) {
    return sign + rnd(aval, r[2].length).replace(/\.(\d*[1-9])0*$/, ".$1").replace(/^(-?\d*)$/, "$1.").replace(/^0\./, r[1].length ? "0." : ".");
  }
  if (r = fmt.match(/^#{1,3},##0(\.?)$/)) return sign + commaify(pad0r(aval, 0));
  if (r = fmt.match(/^#,##0\.([#0]*0)$/)) {
    return val < 0 ? "-" + write_num_flt(type, fmt, -val) : commaify("" + (Math.floor(val) + carry(val, r[1].length))) + "." + pad0(dec(val, r[1].length), r[1].length);
  }
  if (r = fmt.match(/^#,#*,#0/)) return write_num_flt(type, fmt.replace(/^#,#*,/, ""), val);
  if (r = fmt.match(/^([0#]+)(\\?-([0#]+))+$/)) {
    o = _strrev(write_num_flt(type, fmt.replace(/[\\-]/g, ""), val));
    ri = 0;
    return _strrev(_strrev(fmt.replace(/\\/g, "")).replace(/[0#]/g, function(x2) {
      return ri < o.length ? o.charAt(ri++) : x2 === "0" ? "0" : "";
    }));
  }
  if (fmt.match(phone)) {
    o = write_num_flt(type, "##########", val);
    return "(" + o.substr(0, 3) + ") " + o.substr(3, 3) + "-" + o.substr(6);
  }
  var oa = "";
  if (r = fmt.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/)) {
    ri = Math.min(
      /*::String(*/
      r[4].length,
      7
    );
    ff = SSF_frac(aval, Math.pow(10, ri) - 1, false);
    o = "" + sign;
    oa = write_num(
      "n",
      /*::String(*/
      r[1],
      ff[1]
    );
    if (oa.charAt(oa.length - 1) == " ") oa = oa.substr(0, oa.length - 1) + "0";
    o += oa + /*::String(*/
    r[2] + "/" + /*::String(*/
    r[3];
    oa = rpad_(ff[2], ri);
    if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;
    o += oa;
    return o;
  }
  if (r = fmt.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/)) {
    ri = Math.min(Math.max(r[1].length, r[4].length), 7);
    ff = SSF_frac(aval, Math.pow(10, ri) - 1, true);
    return sign + (ff[0] || (ff[1] ? "" : "0")) + " " + (ff[1] ? pad_(ff[1], ri) + r[2] + "/" + r[3] + rpad_(ff[2], ri) : fill(" ", 2 * ri + 1 + r[2].length + r[3].length));
  }
  if (r = fmt.match(/^[#0?]+$/)) {
    o = pad0r(val, 0);
    if (fmt.length <= o.length) return o;
    return hashq(fmt.substr(0, fmt.length - o.length)) + o;
  }
  if (r = fmt.match(/^([#0?]+)\.([#0]+)$/)) {
    o = "" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, "$1");
    ri = o.indexOf(".");
    var lres = fmt.indexOf(".") - ri, rres = fmt.length - o.length - lres;
    return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));
  }
  if (r = fmt.match(/^00,000\.([#0]*0)$/)) {
    ri = dec(val, r[1].length);
    return val < 0 ? "-" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\d,\d{3}$/, "0$&").replace(/^\d*$/, function($$) {
      return "00," + ($$.length < 3 ? pad0(0, 3 - $$.length) : "") + $$;
    }) + "." + pad0(ri, r[1].length);
  }
  switch (fmt) {
    case "###,##0.00":
      return write_num_flt(type, "#,##0.00", val);
    case "###,###":
    case "##,###":
    case "#,###":
      var x = commaify(pad0r(aval, 0));
      return x !== "0" ? sign + x : "";
    case "###,###.00":
      return write_num_flt(type, "###,##0.00", val).replace(/^0\./, ".");
    case "#,###.00":
      return write_num_flt(type, "#,##0.00", val).replace(/^0\./, ".");
    default:
  }
  throw new Error("unsupported format |" + fmt + "|");
}
function write_num_cm2(type, fmt, val) {
  var idx = fmt.length - 1;
  while (fmt.charCodeAt(idx - 1) === 44) --idx;
  return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));
}
function write_num_pct2(type, fmt, val) {
  var sfmt = fmt.replace(pct1, ""), mul = fmt.length - sfmt.length;
  return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill("%", mul);
}
function write_num_exp2(fmt, val) {
  var o;
  var idx = fmt.indexOf("E") - fmt.indexOf(".") - 1;
  if (fmt.match(/^#+0.0E\+0$/)) {
    if (val == 0) return "0.0E+0";
    else if (val < 0) return "-" + write_num_exp2(fmt, -val);
    var period = fmt.indexOf(".");
    if (period === -1) period = fmt.indexOf("E");
    var ee = Math.floor(Math.log(val) * Math.LOG10E) % period;
    if (ee < 0) ee += period;
    o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);
    if (!o.match(/[Ee]/)) {
      var fakee = Math.floor(Math.log(val) * Math.LOG10E);
      if (o.indexOf(".") === -1) o = o.charAt(0) + "." + o.substr(1) + "E+" + (fakee - o.length + ee);
      else o += "E+" + (fakee - ee);
      o = o.replace(/\+-/, "-");
    }
    o = o.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/, function($$, $1, $2, $3) {
      return $1 + $2 + $3.substr(0, (period + ee) % period) + "." + $3.substr(ee) + "E";
    });
  } else o = val.toExponential(idx);
  if (fmt.match(/E\+00$/) && o.match(/e[+-]\d$/)) o = o.substr(0, o.length - 1) + "0" + o.charAt(o.length - 1);
  if (fmt.match(/E\-/) && o.match(/e\+/)) o = o.replace(/e\+/, "e");
  return o.replace("e", "E");
}
function write_num_int(type, fmt, val) {
  if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {
    var ffmt = fmt.replace(/\( */, "").replace(/ \)/, "").replace(/\)/, "");
    if (val >= 0) return write_num_int("n", ffmt, val);
    return "(" + write_num_int("n", ffmt, -val) + ")";
  }
  if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);
  if (fmt.indexOf("%") !== -1) return write_num_pct2(type, fmt, val);
  if (fmt.indexOf("E") !== -1) return write_num_exp2(fmt, val);
  if (fmt.charCodeAt(0) === 36) return "$" + write_num_int(type, fmt.substr(fmt.charAt(1) == " " ? 2 : 1), val);
  var o;
  var r, ri, ff, aval = Math.abs(val), sign = val < 0 ? "-" : "";
  if (fmt.match(/^00+$/)) return sign + pad0(aval, fmt.length);
  if (fmt.match(/^[#?]+$/)) {
    o = "" + val;
    if (val === 0) o = "";
    return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;
  }
  if (r = fmt.match(frac1)) return write_num_f2(r, aval, sign);
  if (fmt.match(/^#+0+$/)) return sign + pad0(aval, fmt.length - fmt.indexOf("0"));
  if (r = fmt.match(dec1)) {
    o = ("" + val).replace(/^([^\.]+)$/, "$1." + hashq(r[1])).replace(/\.$/, "." + hashq(r[1]));
    o = o.replace(/\.(\d*)$/, function($$, $1) {
      return "." + $1 + fill("0", hashq(r[1]).length - $1.length);
    });
    return fmt.indexOf("0.") !== -1 ? o : o.replace(/^0\./, ".");
  }
  fmt = fmt.replace(/^#+([0.])/, "$1");
  if (r = fmt.match(/^(0*)\.(#*)$/)) {
    return sign + ("" + aval).replace(/\.(\d*[1-9])0*$/, ".$1").replace(/^(-?\d*)$/, "$1.").replace(/^0\./, r[1].length ? "0." : ".");
  }
  if (r = fmt.match(/^#{1,3},##0(\.?)$/)) return sign + commaify("" + aval);
  if (r = fmt.match(/^#,##0\.([#0]*0)$/)) {
    return val < 0 ? "-" + write_num_int(type, fmt, -val) : commaify("" + val) + "." + fill("0", r[1].length);
  }
  if (r = fmt.match(/^#,#*,#0/)) return write_num_int(type, fmt.replace(/^#,#*,/, ""), val);
  if (r = fmt.match(/^([0#]+)(\\?-([0#]+))+$/)) {
    o = _strrev(write_num_int(type, fmt.replace(/[\\-]/g, ""), val));
    ri = 0;
    return _strrev(_strrev(fmt.replace(/\\/g, "")).replace(/[0#]/g, function(x2) {
      return ri < o.length ? o.charAt(ri++) : x2 === "0" ? "0" : "";
    }));
  }
  if (fmt.match(phone)) {
    o = write_num_int(type, "##########", val);
    return "(" + o.substr(0, 3) + ") " + o.substr(3, 3) + "-" + o.substr(6);
  }
  var oa = "";
  if (r = fmt.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/)) {
    ri = Math.min(
      /*::String(*/
      r[4].length,
      7
    );
    ff = SSF_frac(aval, Math.pow(10, ri) - 1, false);
    o = "" + sign;
    oa = write_num(
      "n",
      /*::String(*/
      r[1],
      ff[1]
    );
    if (oa.charAt(oa.length - 1) == " ") oa = oa.substr(0, oa.length - 1) + "0";
    o += oa + /*::String(*/
    r[2] + "/" + /*::String(*/
    r[3];
    oa = rpad_(ff[2], ri);
    if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;
    o += oa;
    return o;
  }
  if (r = fmt.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/)) {
    ri = Math.min(Math.max(r[1].length, r[4].length), 7);
    ff = SSF_frac(aval, Math.pow(10, ri) - 1, true);
    return sign + (ff[0] || (ff[1] ? "" : "0")) + " " + (ff[1] ? pad_(ff[1], ri) + r[2] + "/" + r[3] + rpad_(ff[2], ri) : fill(" ", 2 * ri + 1 + r[2].length + r[3].length));
  }
  if (r = fmt.match(/^[#0?]+$/)) {
    o = "" + val;
    if (fmt.length <= o.length) return o;
    return hashq(fmt.substr(0, fmt.length - o.length)) + o;
  }
  if (r = fmt.match(/^([#0]+)\.([#0]+)$/)) {
    o = "" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, "$1");
    ri = o.indexOf(".");
    var lres = fmt.indexOf(".") - ri, rres = fmt.length - o.length - lres;
    return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));
  }
  if (r = fmt.match(/^00,000\.([#0]*0)$/)) {
    return val < 0 ? "-" + write_num_int(type, fmt, -val) : commaify("" + val).replace(/^\d,\d{3}$/, "0$&").replace(/^\d*$/, function($$) {
      return "00," + ($$.length < 3 ? pad0(0, 3 - $$.length) : "") + $$;
    }) + "." + pad0(0, r[1].length);
  }
  switch (fmt) {
    case "###,###":
    case "##,###":
    case "#,###":
      var x = commaify("" + aval);
      return x !== "0" ? sign + x : "";
    default:
      if (fmt.match(/\.[0#?]*$/)) return write_num_int(type, fmt.slice(0, fmt.lastIndexOf(".")), val) + hashq(fmt.slice(fmt.lastIndexOf(".")));
  }
  throw new Error("unsupported format |" + fmt + "|");
}
function write_num(type, fmt, val) {
  return (val | 0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);
}
function SSF_split_fmt(fmt) {
  var out = [];
  var in_str = false;
  for (var i = 0, j = 0; i < fmt.length; ++i) switch (
    /*cc=*/
    fmt.charCodeAt(i)
  ) {
    case 34:
      in_str = !in_str;
      break;
    case 95:
    case 42:
    case 92:
      ++i;
      break;
    case 59:
      out[out.length] = fmt.substr(j, i - j);
      j = i + 1;
  }
  out[out.length] = fmt.substr(j);
  if (in_str === true) throw new Error("Format |" + fmt + "| unterminated string ");
  return out;
}
var SSF_abstime = /\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;
function fmt_is_date(fmt) {
  var i = 0, c = "", o = "";
  while (i < fmt.length) {
    switch (c = fmt.charAt(i)) {
      case "G":
        if (SSF_isgeneral(fmt, i)) i += 6;
        i++;
        break;
      case '"':
        for (
          ;
          /*cc=*/
          fmt.charCodeAt(++i) !== 34 && i < fmt.length;
        ) {
        }
        ++i;
        break;
      case "\\":
        i += 2;
        break;
      case "_":
        i += 2;
        break;
      case "@":
        ++i;
        break;
      case "B":
      case "b":
        if (fmt.charAt(i + 1) === "1" || fmt.charAt(i + 1) === "2") return true;
      /* falls through */
      case "M":
      case "D":
      case "Y":
      case "H":
      case "S":
      case "E":
      /* falls through */
      case "m":
      case "d":
      case "y":
      case "h":
      case "s":
      case "e":
      case "g":
        return true;
      case "A":
      case "a":
      case "\u4E0A":
        if (fmt.substr(i, 3).toUpperCase() === "A/P") return true;
        if (fmt.substr(i, 5).toUpperCase() === "AM/PM") return true;
        if (fmt.substr(i, 5).toUpperCase() === "\u4E0A\u5348/\u4E0B\u5348") return true;
        ++i;
        break;
      case "[":
        o = c;
        while (fmt.charAt(i++) !== "]" && i < fmt.length) o += fmt.charAt(i);
        if (o.match(SSF_abstime)) return true;
        break;
      case ".":
      /* falls through */
      case "0":
      case "#":
        while (i < fmt.length && ("0#?.,E+-%".indexOf(c = fmt.charAt(++i)) > -1 || c == "\\" && fmt.charAt(i + 1) == "-" && "0#".indexOf(fmt.charAt(i + 2)) > -1)) {
        }
        break;
      case "?":
        while (fmt.charAt(++i) === c) {
        }
        break;
      case "*":
        ++i;
        if (fmt.charAt(i) == " " || fmt.charAt(i) == "*") ++i;
        break;
      case "(":
      case ")":
        ++i;
        break;
      case "1":
      case "2":
      case "3":
      case "4":
      case "5":
      case "6":
      case "7":
      case "8":
      case "9":
        while (i < fmt.length && "0123456789".indexOf(fmt.charAt(++i)) > -1) {
        }
        break;
      case " ":
        ++i;
        break;
      default:
        ++i;
        break;
    }
  }
  return false;
}
function eval_fmt(fmt, v, opts, flen) {
  var out = [], o = "", i = 0, c = "", lst = "t", dt, j, cc;
  var hr = "H";
  while (i < fmt.length) {
    switch (c = fmt.charAt(i)) {
      case "G":
        if (!SSF_isgeneral(fmt, i)) throw new Error("unrecognized character " + c + " in " + fmt);
        out[out.length] = {
          t: "G",
          v: "General"
        };
        i += 7;
        break;
      case '"':
        for (o = ""; (cc = fmt.charCodeAt(++i)) !== 34 && i < fmt.length; ) o += String.fromCharCode(cc);
        out[out.length] = {
          t: "t",
          v: o
        };
        ++i;
        break;
      case "\\":
        var w = fmt.charAt(++i), t = w === "(" || w === ")" ? w : "t";
        out[out.length] = {
          t,
          v: w
        };
        ++i;
        break;
      case "_":
        out[out.length] = {
          t: "t",
          v: " "
        };
        i += 2;
        break;
      case "@":
        out[out.length] = {
          t: "T",
          v
        };
        ++i;
        break;
      case "B":
      case "b":
        if (fmt.charAt(i + 1) === "1" || fmt.charAt(i + 1) === "2") {
          if (dt == null) {
            dt = SSF_parse_date_code(v, opts, fmt.charAt(i + 1) === "2");
            if (dt == null) return "";
          }
          out[out.length] = {
            t: "X",
            v: fmt.substr(i, 2)
          };
          lst = c;
          i += 2;
          break;
        }
      /* falls through */
      case "M":
      case "D":
      case "Y":
      case "H":
      case "S":
      case "E":
        c = c.toLowerCase();
      /* falls through */
      case "m":
      case "d":
      case "y":
      case "h":
      case "s":
      case "e":
      case "g":
        if (v < 0) return "";
        if (dt == null) {
          dt = SSF_parse_date_code(v, opts);
          if (dt == null) return "";
        }
        o = c;
        while (++i < fmt.length && fmt.charAt(i).toLowerCase() === c) o += c;
        if (c === "m" && lst.toLowerCase() === "h") c = "M";
        if (c === "h") c = hr;
        out[out.length] = {
          t: c,
          v: o
        };
        lst = c;
        break;
      case "A":
      case "a":
      case "\u4E0A":
        var q = {
          t: c,
          v: c
        };
        if (dt == null) dt = SSF_parse_date_code(v, opts);
        if (fmt.substr(i, 3).toUpperCase() === "A/P") {
          if (dt != null) q.v = dt.H >= 12 ? "P" : "A";
          q.t = "T";
          hr = "h";
          i += 3;
        } else if (fmt.substr(i, 5).toUpperCase() === "AM/PM") {
          if (dt != null) q.v = dt.H >= 12 ? "PM" : "AM";
          q.t = "T";
          i += 5;
          hr = "h";
        } else if (fmt.substr(i, 5).toUpperCase() === "\u4E0A\u5348/\u4E0B\u5348") {
          if (dt != null) q.v = dt.H >= 12 ? "\u4E0B\u5348" : "\u4E0A\u5348";
          q.t = "T";
          i += 5;
          hr = "h";
        } else {
          q.t = "t";
          ++i;
        }
        if (dt == null && q.t === "T") return "";
        out[out.length] = q;
        lst = c;
        break;
      case "[":
        o = c;
        while (fmt.charAt(i++) !== "]" && i < fmt.length) o += fmt.charAt(i);
        if (o.slice(-1) !== "]") throw 'unterminated "[" block: |' + o + "|";
        if (o.match(SSF_abstime)) {
          if (dt == null) {
            dt = SSF_parse_date_code(v, opts);
            if (dt == null) return "";
          }
          out[out.length] = {
            t: "Z",
            v: o.toLowerCase()
          };
          lst = o.charAt(1);
        } else if (o.indexOf("$") > -1) {
          o = (o.match(/\$([^-\[\]]*)/) || [])[1] || "$";
          if (!fmt_is_date(fmt)) out[out.length] = {
            t: "t",
            v: o
          };
        }
        break;
      /* Numbers */
      case ".":
        if (dt != null) {
          o = c;
          while (++i < fmt.length && (c = fmt.charAt(i)) === "0") o += c;
          out[out.length] = {
            t: "s",
            v: o
          };
          break;
        }
      /* falls through */
      case "0":
      case "#":
        o = c;
        while (++i < fmt.length && "0#?.,E+-%".indexOf(c = fmt.charAt(i)) > -1) o += c;
        out[out.length] = {
          t: "n",
          v: o
        };
        break;
      case "?":
        o = c;
        while (fmt.charAt(++i) === c) o += c;
        out[out.length] = {
          t: c,
          v: o
        };
        lst = c;
        break;
      case "*":
        ++i;
        if (fmt.charAt(i) == " " || fmt.charAt(i) == "*") ++i;
        break;
      // **
      case "(":
      case ")":
        out[out.length] = {
          t: flen === 1 ? "t" : c,
          v: c
        };
        ++i;
        break;
      case "1":
      case "2":
      case "3":
      case "4":
      case "5":
      case "6":
      case "7":
      case "8":
      case "9":
        o = c;
        while (i < fmt.length && "0123456789".indexOf(fmt.charAt(++i)) > -1) o += fmt.charAt(i);
        out[out.length] = {
          t: "D",
          v: o
        };
        break;
      case " ":
        out[out.length] = {
          t: c,
          v: c
        };
        ++i;
        break;
      case "$":
        out[out.length] = {
          t: "t",
          v: "$"
        };
        ++i;
        break;
      default:
        if (",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(c) === -1) throw new Error("unrecognized character " + c + " in " + fmt);
        out[out.length] = {
          t: "t",
          v: c
        };
        ++i;
        break;
    }
  }
  var bt = 0, ss0 = 0, ssm;
  for (i = out.length - 1, lst = "t"; i >= 0; --i) {
    switch (out[i].t) {
      case "h":
      case "H":
        out[i].t = hr;
        lst = "h";
        if (bt < 1) bt = 1;
        break;
      case "s":
        if (ssm = out[i].v.match(/\.0+$/)) ss0 = Math.max(ss0, ssm[0].length - 1);
        if (bt < 3) bt = 3;
      /* falls through */
      case "d":
      case "y":
      case "M":
      case "e":
        lst = out[i].t;
        break;
      case "m":
        if (lst === "s") {
          out[i].t = "M";
          if (bt < 2) bt = 2;
        }
        break;
      case "X":
        break;
      case "Z":
        if (bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;
        if (bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;
        if (bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;
    }
  }
  switch (bt) {
    case 0:
      break;
    case 1:
      if (dt.u >= 0.5) {
        dt.u = 0;
        ++dt.S;
      }
      if (dt.S >= 60) {
        dt.S = 0;
        ++dt.M;
      }
      if (dt.M >= 60) {
        dt.M = 0;
        ++dt.H;
      }
      break;
    case 2:
      if (dt.u >= 0.5) {
        dt.u = 0;
        ++dt.S;
      }
      if (dt.S >= 60) {
        dt.S = 0;
        ++dt.M;
      }
      break;
  }
  var nstr = "", jj;
  for (i = 0; i < out.length; ++i) {
    switch (out[i].t) {
      case "t":
      case "T":
      case " ":
      case "D":
        break;
      case "X":
        out[i].v = "";
        out[i].t = ";";
        break;
      case "d":
      case "m":
      case "y":
      case "h":
      case "H":
      case "M":
      case "s":
      case "e":
      case "b":
      case "Z":
        out[i].v = SSF_write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);
        out[i].t = "t";
        break;
      case "n":
      case "?":
        jj = i + 1;
        while (out[jj] != null && ((c = out[jj].t) === "?" || c === "D" || (c === " " || c === "t") && out[jj + 1] != null && (out[jj + 1].t === "?" || out[jj + 1].t === "t" && out[jj + 1].v === "/") || out[i].t === "(" && (c === " " || c === "n" || c === ")") || c === "t" && (out[jj].v === "/" || out[jj].v === " " && out[jj + 1] != null && out[jj + 1].t == "?"))) {
          out[i].v += out[jj].v;
          out[jj] = {
            v: "",
            t: ";"
          };
          ++jj;
        }
        nstr += out[i].v;
        i = jj - 1;
        break;
      case "G":
        out[i].t = "t";
        out[i].v = SSF_general(v, opts);
        break;
    }
  }
  var vv = "", myv, ostr;
  if (nstr.length > 0) {
    if (nstr.charCodeAt(0) == 40) {
      myv = v < 0 && nstr.charCodeAt(0) === 45 ? -v : v;
      ostr = write_num("n", nstr, myv);
    } else {
      myv = v < 0 && flen > 1 ? -v : v;
      ostr = write_num("n", nstr, myv);
      if (myv < 0 && out[0] && out[0].t == "t") {
        ostr = ostr.substr(1);
        out[0].v = "-" + out[0].v;
      }
    }
    jj = ostr.length - 1;
    var decpt = out.length;
    for (i = 0; i < out.length; ++i) if (out[i] != null && out[i].t != "t" && out[i].v.indexOf(".") > -1) {
      decpt = i;
      break;
    }
    var lasti = out.length;
    if (decpt === out.length && ostr.indexOf("E") === -1) {
      for (i = out.length - 1; i >= 0; --i) {
        if (out[i] == null || "n?".indexOf(out[i].t) === -1) continue;
        if (jj >= out[i].v.length - 1) {
          jj -= out[i].v.length;
          out[i].v = ostr.substr(jj + 1, out[i].v.length);
        } else if (jj < 0) out[i].v = "";
        else {
          out[i].v = ostr.substr(0, jj + 1);
          jj = -1;
        }
        out[i].t = "t";
        lasti = i;
      }
      if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;
    } else if (decpt !== out.length && ostr.indexOf("E") === -1) {
      jj = ostr.indexOf(".") - 1;
      for (i = decpt; i >= 0; --i) {
        if (out[i] == null || "n?".indexOf(out[i].t) === -1) continue;
        j = out[i].v.indexOf(".") > -1 && i === decpt ? out[i].v.indexOf(".") - 1 : out[i].v.length - 1;
        vv = out[i].v.substr(j + 1);
        for (; j >= 0; --j) {
          if (jj >= 0 && (out[i].v.charAt(j) === "0" || out[i].v.charAt(j) === "#")) vv = ostr.charAt(jj--) + vv;
        }
        out[i].v = vv;
        out[i].t = "t";
        lasti = i;
      }
      if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;
      jj = ostr.indexOf(".") + 1;
      for (i = decpt; i < out.length; ++i) {
        if (out[i] == null || "n?(".indexOf(out[i].t) === -1 && i !== decpt) continue;
        j = out[i].v.indexOf(".") > -1 && i === decpt ? out[i].v.indexOf(".") + 1 : 0;
        vv = out[i].v.substr(0, j);
        for (; j < out[i].v.length; ++j) {
          if (jj < ostr.length) vv += ostr.charAt(jj++);
        }
        out[i].v = vv;
        out[i].t = "t";
        lasti = i;
      }
    }
  }
  for (i = 0; i < out.length; ++i) if (out[i] != null && "n?".indexOf(out[i].t) > -1) {
    myv = flen > 1 && v < 0 && i > 0 && out[i - 1].v === "-" ? -v : v;
    out[i].v = write_num(out[i].t, out[i].v, myv);
    out[i].t = "t";
  }
  var retval = "";
  for (i = 0; i !== out.length; ++i) if (out[i] != null) retval += out[i].v;
  return retval;
}
var cfregex2 = /\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;
function chkcond(v, rr) {
  if (rr == null) return false;
  var thresh = parseFloat(rr[2]);
  switch (rr[1]) {
    case "=":
      if (v == thresh) return true;
      break;
    case ">":
      if (v > thresh) return true;
      break;
    case "<":
      if (v < thresh) return true;
      break;
    case "<>":
      if (v != thresh) return true;
      break;
    case ">=":
      if (v >= thresh) return true;
      break;
    case "<=":
      if (v <= thresh) return true;
      break;
  }
  return false;
}
function choose_fmt(f, v) {
  var fmt = SSF_split_fmt(f);
  var l = fmt.length, lat = fmt[l - 1].indexOf("@");
  if (l < 4 && lat > -1) --l;
  if (fmt.length > 4) throw new Error("cannot find right format for |" + fmt.join("|") + "|");
  if (typeof v !== "number") return [4, fmt.length === 4 || lat > -1 ? fmt[fmt.length - 1] : "@"];
  switch (fmt.length) {
    case 1:
      fmt = lat > -1 ? ["General", "General", "General", fmt[0]] : [fmt[0], fmt[0], fmt[0], "@"];
      break;
    case 2:
      fmt = lat > -1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], "@"];
      break;
    case 3:
      fmt = lat > -1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], "@"];
      break;
    case 4:
      break;
  }
  var ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];
  if (fmt[0].indexOf("[") === -1 && fmt[1].indexOf("[") === -1) return [l, ff];
  if (fmt[0].match(/\[[=<>]/) != null || fmt[1].match(/\[[=<>]/) != null) {
    var m1 = fmt[0].match(cfregex2);
    var m2 = fmt[1].match(cfregex2);
    return chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];
  }
  return [l, ff];
}
function SSF_format(fmt, v, o) {
  if (o == null) o = {};
  var sfmt = "";
  switch (typeof fmt) {
    case "string":
      if (fmt == "m/d/yy" && o.dateNF) sfmt = o.dateNF;
      else sfmt = fmt;
      break;
    case "number":
      if (fmt == 14 && o.dateNF) sfmt = o.dateNF;
      else sfmt = (o.table != null ? o.table : table_fmt)[fmt];
      if (sfmt == null) sfmt = o.table && o.table[SSF_default_map[fmt]] || table_fmt[SSF_default_map[fmt]];
      if (sfmt == null) sfmt = SSF_default_str[fmt] || "General";
      break;
  }
  if (SSF_isgeneral(sfmt, 0)) return SSF_general(v, o);
  if (v instanceof Date) v = datenum_local(v, o.date1904);
  var f = choose_fmt(sfmt, v);
  if (SSF_isgeneral(f[1])) return SSF_general(v, o);
  if (v === true) v = "TRUE";
  else if (v === false) v = "FALSE";
  else if (v === "" || v == null) return "";
  return eval_fmt(f[1], v, o, f[0]);
}
function SSF_load(fmt, idx) {
  if (typeof idx != "number") {
    idx = +idx || -1;
    for (var i = 0; i < 392; ++i) {
      if (table_fmt[i] == void 0) {
        if (idx < 0) idx = i;
        continue;
      }
      if (table_fmt[i] == fmt) {
        idx = i;
        break;
      }
    }
    if (idx < 0) idx = 391;
  }
  table_fmt[idx] = fmt;
  return idx;
}
function SSF_load_table(tbl) {
  for (var i = 0; i != 392; ++i) if (tbl[i] !== void 0) SSF_load(tbl[i], i);
}
function make_ssf() {
  table_fmt = SSF_init_table();
}
var dateNFregex = /[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;
function dateNF_regex(dateNF) {
  var fmt = typeof dateNF == "number" ? table_fmt[dateNF] : dateNF;
  fmt = fmt.replace(dateNFregex, "(\\d+)");
  return new RegExp("^" + fmt + "$");
}
function dateNF_fix(str, dateNF, match) {
  var Y = -1, m = -1, d = -1, H = -1, M = -1, S = -1;
  (dateNF.match(dateNFregex) || []).forEach(function(n, i) {
    var v = parseInt(match[i + 1], 10);
    switch (n.toLowerCase().charAt(0)) {
      case "y":
        Y = v;
        break;
      case "d":
        d = v;
        break;
      case "h":
        H = v;
        break;
      case "s":
        S = v;
        break;
      case "m":
        if (H >= 0) M = v;
        else m = v;
        break;
    }
  });
  if (S >= 0 && M == -1 && m >= 0) {
    M = m;
    m = -1;
  }
  var datestr = ("" + (Y >= 0 ? Y : (/* @__PURE__ */ new Date()).getFullYear())).slice(-4) + "-" + ("00" + (m >= 1 ? m : 1)).slice(-2) + "-" + ("00" + (d >= 1 ? d : 1)).slice(-2);
  if (datestr.length == 7) datestr = "0" + datestr;
  if (datestr.length == 8) datestr = "20" + datestr;
  var timestr = ("00" + (H >= 0 ? H : 0)).slice(-2) + ":" + ("00" + (M >= 0 ? M : 0)).slice(-2) + ":" + ("00" + (S >= 0 ? S : 0)).slice(-2);
  if (H == -1 && M == -1 && S == -1) return datestr;
  if (Y == -1 && m == -1 && d == -1) return timestr;
  return datestr + "T" + timestr;
}
var CRC32 = /* @__PURE__ */ function() {
  var CRC322 = {};
  CRC322.version = "1.2.0";
  function signed_crc_table() {
    var c = 0, table = new Array(256);
    for (var n = 0; n != 256; ++n) {
      c = n;
      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;
      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;
      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;
      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;
      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;
      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;
      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;
      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;
      table[n] = c;
    }
    return typeof Int32Array !== "undefined" ? new Int32Array(table) : table;
  }
  var T0 = signed_crc_table();
  function slice_by_16_tables(T) {
    var c = 0, v = 0, n = 0, table = typeof Int32Array !== "undefined" ? new Int32Array(4096) : new Array(4096);
    for (n = 0; n != 256; ++n) table[n] = T[n];
    for (n = 0; n != 256; ++n) {
      v = T[n];
      for (c = 256 + n; c < 4096; c += 256) v = table[c] = v >>> 8 ^ T[v & 255];
    }
    var out = [];
    for (n = 1; n != 16; ++n) out[n - 1] = typeof Int32Array !== "undefined" ? table.subarray(n * 256, n * 256 + 256) : table.slice(n * 256, n * 256 + 256);
    return out;
  }
  var TT = slice_by_16_tables(T0);
  var T1 = TT[0], T2 = TT[1], T3 = TT[2], T4 = TT[3], T5 = TT[4];
  var T6 = TT[5], T7 = TT[6], T8 = TT[7], T9 = TT[8], Ta = TT[9];
  var Tb = TT[10], Tc = TT[11], Td = TT[12], Te = TT[13], Tf = TT[14];
  function crc32_bstr(bstr, seed) {
    var C = seed ^ -1;
    for (var i = 0, L = bstr.length; i < L; ) C = C >>> 8 ^ T0[(C ^ bstr.charCodeAt(i++)) & 255];
    return ~C;
  }
  function crc32_buf(B, seed) {
    var C = seed ^ -1, L = B.length - 15, i = 0;
    for (; i < L; ) C = Tf[B[i++] ^ C & 255] ^ Te[B[i++] ^ C >> 8 & 255] ^ Td[B[i++] ^ C >> 16 & 255] ^ Tc[B[i++] ^ C >>> 24] ^ Tb[B[i++]] ^ Ta[B[i++]] ^ T9[B[i++]] ^ T8[B[i++]] ^ T7[B[i++]] ^ T6[B[i++]] ^ T5[B[i++]] ^ T4[B[i++]] ^ T3[B[i++]] ^ T2[B[i++]] ^ T1[B[i++]] ^ T0[B[i++]];
    L += 15;
    while (i < L) C = C >>> 8 ^ T0[(C ^ B[i++]) & 255];
    return ~C;
  }
  function crc32_str(str, seed) {
    var C = seed ^ -1;
    for (var i = 0, L = str.length, c = 0, d = 0; i < L; ) {
      c = str.charCodeAt(i++);
      if (c < 128) {
        C = C >>> 8 ^ T0[(C ^ c) & 255];
      } else if (c < 2048) {
        C = C >>> 8 ^ T0[(C ^ (192 | c >> 6 & 31)) & 255];
        C = C >>> 8 ^ T0[(C ^ (128 | c & 63)) & 255];
      } else if (c >= 55296 && c < 57344) {
        c = (c & 1023) + 64;
        d = str.charCodeAt(i++) & 1023;
        C = C >>> 8 ^ T0[(C ^ (240 | c >> 8 & 7)) & 255];
        C = C >>> 8 ^ T0[(C ^ (128 | c >> 2 & 63)) & 255];
        C = C >>> 8 ^ T0[(C ^ (128 | d >> 6 & 15 | (c & 3) << 4)) & 255];
        C = C >>> 8 ^ T0[(C ^ (128 | d & 63)) & 255];
      } else {
        C = C >>> 8 ^ T0[(C ^ (224 | c >> 12 & 15)) & 255];
        C = C >>> 8 ^ T0[(C ^ (128 | c >> 6 & 63)) & 255];
        C = C >>> 8 ^ T0[(C ^ (128 | c & 63)) & 255];
      }
    }
    return ~C;
  }
  CRC322.table = T0;
  CRC322.bstr = crc32_bstr;
  CRC322.buf = crc32_buf;
  CRC322.str = crc32_str;
  return CRC322;
}();
var CFB = /* @__PURE__ */ function _CFB() {
  var exports = {};
  exports.version = "1.2.1";
  function namecmp(l, r) {
    var L = l.split("/"), R = r.split("/");
    for (var i2 = 0, c = 0, Z = Math.min(L.length, R.length); i2 < Z; ++i2) {
      if (c = L[i2].length - R[i2].length) return c;
      if (L[i2] != R[i2]) return L[i2] < R[i2] ? -1 : 1;
    }
    return L.length - R.length;
  }
  function dirname(p) {
    if (p.charAt(p.length - 1) == "/") return p.slice(0, -1).indexOf("/") === -1 ? p : dirname(p.slice(0, -1));
    var c = p.lastIndexOf("/");
    return c === -1 ? p : p.slice(0, c + 1);
  }
  function filename(p) {
    if (p.charAt(p.length - 1) == "/") return filename(p.slice(0, -1));
    var c = p.lastIndexOf("/");
    return c === -1 ? p : p.slice(c + 1);
  }
  function write_dos_date(buf, date) {
    if (typeof date === "string") date = new Date(date);
    var hms = date.getHours();
    hms = hms << 6 | date.getMinutes();
    hms = hms << 5 | date.getSeconds() >>> 1;
    buf.write_shift(2, hms);
    var ymd = date.getFullYear() - 1980;
    ymd = ymd << 4 | date.getMonth() + 1;
    ymd = ymd << 5 | date.getDate();
    buf.write_shift(2, ymd);
  }
  function parse_dos_date(buf) {
    var hms = buf.read_shift(2) & 65535;
    var ymd = buf.read_shift(2) & 65535;
    var val = /* @__PURE__ */ new Date();
    var d = ymd & 31;
    ymd >>>= 5;
    var m = ymd & 15;
    ymd >>>= 4;
    val.setMilliseconds(0);
    val.setFullYear(ymd + 1980);
    val.setMonth(m - 1);
    val.setDate(d);
    var S = hms & 31;
    hms >>>= 5;
    var M = hms & 63;
    hms >>>= 6;
    val.setHours(hms);
    val.setMinutes(M);
    val.setSeconds(S << 1);
    return val;
  }
  function parse_extra_field(blob) {
    prep_blob(blob, 0);
    var o = (
      /*::(*/
      {}
    );
    var flags = 0;
    while (blob.l <= blob.length - 4) {
      var type = blob.read_shift(2);
      var sz = blob.read_shift(2), tgt = blob.l + sz;
      var p = {};
      switch (type) {
        /* UNIX-style Timestamps */
        case 21589:
          {
            flags = blob.read_shift(1);
            if (flags & 1) p.mtime = blob.read_shift(4);
            if (sz > 5) {
              if (flags & 2) p.atime = blob.read_shift(4);
              if (flags & 4) p.ctime = blob.read_shift(4);
            }
            if (p.mtime) p.mt = new Date(p.mtime * 1e3);
          }
          break;
      }
      blob.l = tgt;
      o[type] = p;
    }
    return o;
  }
  var fs;
  function get_fs() {
    return fs || (fs = {});
  }
  function parse(file, options) {
    if (file[0] == 80 && file[1] == 75) return parse_zip(file, options);
    if ((file[0] | 32) == 109 && (file[1] | 32) == 105) return parse_mad(file, options);
    if (file.length < 512) throw new Error("CFB file size " + file.length + " < 512");
    var mver = 3;
    var ssz = 512;
    var nmfs = 0;
    var difat_sec_cnt = 0;
    var dir_start = 0;
    var minifat_start = 0;
    var difat_start = 0;
    var fat_addrs = [];
    var blob = (
      /*::(*/
      file.slice(0, 512)
    );
    prep_blob(blob, 0);
    var mv = check_get_mver(blob);
    mver = mv[0];
    switch (mver) {
      case 3:
        ssz = 512;
        break;
      case 4:
        ssz = 4096;
        break;
      case 0:
        if (mv[1] == 0) return parse_zip(file, options);
      /* falls through */
      default:
        throw new Error("Major Version: Expected 3 or 4 saw " + mver);
    }
    if (ssz !== 512) {
      blob = /*::(*/
      file.slice(0, ssz);
      prep_blob(
        blob,
        28
        /* blob.l */
      );
    }
    var header = file.slice(0, ssz);
    check_shifts(blob, mver);
    var dir_cnt = blob.read_shift(4, "i");
    if (mver === 3 && dir_cnt !== 0) throw new Error("# Directory Sectors: Expected 0 saw " + dir_cnt);
    blob.l += 4;
    dir_start = blob.read_shift(4, "i");
    blob.l += 4;
    blob.chk("00100000", "Mini Stream Cutoff Size: ");
    minifat_start = blob.read_shift(4, "i");
    nmfs = blob.read_shift(4, "i");
    difat_start = blob.read_shift(4, "i");
    difat_sec_cnt = blob.read_shift(4, "i");
    for (var q2 = -1, j = 0; j < 109; ++j) {
      q2 = blob.read_shift(4, "i");
      if (q2 < 0) break;
      fat_addrs[j] = q2;
    }
    var sectors = sectorify(file, ssz);
    sleuth_fat(difat_start, difat_sec_cnt, sectors, ssz, fat_addrs);
    var sector_list = make_sector_list(sectors, dir_start, fat_addrs, ssz);
    sector_list[dir_start].name = "!Directory";
    if (nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = "!MiniFAT";
    sector_list[fat_addrs[0]].name = "!FAT";
    sector_list.fat_addrs = fat_addrs;
    sector_list.ssz = ssz;
    var files = {}, Paths = [], FileIndex = [], FullPaths = [];
    read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, minifat_start);
    build_full_paths(FileIndex, FullPaths, Paths);
    Paths.shift();
    var o = {
      FileIndex,
      FullPaths
    };
    if (options && options.raw) o.raw = {
      header,
      sectors
    };
    return o;
  }
  function check_get_mver(blob) {
    if (blob[blob.l] == 80 && blob[blob.l + 1] == 75) return [0, 0];
    blob.chk(HEADER_SIGNATURE, "Header Signature: ");
    blob.l += 16;
    var mver = blob.read_shift(2, "u");
    return [blob.read_shift(2, "u"), mver];
  }
  function check_shifts(blob, mver) {
    var shift = 9;
    blob.l += 2;
    switch (shift = blob.read_shift(2)) {
      case 9:
        if (mver != 3) throw new Error("Sector Shift: Expected 9 saw " + shift);
        break;
      case 12:
        if (mver != 4) throw new Error("Sector Shift: Expected 12 saw " + shift);
        break;
      default:
        throw new Error("Sector Shift: Expected 9 or 12 saw " + shift);
    }
    blob.chk("0600", "Mini Sector Shift: ");
    blob.chk("000000000000", "Reserved: ");
  }
  function sectorify(file, ssz) {
    var nsectors = Math.ceil(file.length / ssz) - 1;
    var sectors = [];
    for (var i2 = 1; i2 < nsectors; ++i2) sectors[i2 - 1] = file.slice(i2 * ssz, (i2 + 1) * ssz);
    sectors[nsectors - 1] = file.slice(nsectors * ssz);
    return sectors;
  }
  function build_full_paths(FI, FP, Paths) {
    var i2 = 0, L = 0, R = 0, C = 0, j = 0, pl = Paths.length;
    var dad = [], q2 = [];
    for (; i2 < pl; ++i2) {
      dad[i2] = q2[i2] = i2;
      FP[i2] = Paths[i2];
    }
    for (; j < q2.length; ++j) {
      i2 = q2[j];
      L = FI[i2].L;
      R = FI[i2].R;
      C = FI[i2].C;
      if (dad[i2] === i2) {
        if (L !== -1 && dad[L] !== L) dad[i2] = dad[L];
        if (R !== -1 && dad[R] !== R) dad[i2] = dad[R];
      }
      if (C !== -1) dad[C] = i2;
      if (L !== -1 && i2 != dad[i2]) {
        dad[L] = dad[i2];
        if (q2.lastIndexOf(L) < j) q2.push(L);
      }
      if (R !== -1 && i2 != dad[i2]) {
        dad[R] = dad[i2];
        if (q2.lastIndexOf(R) < j) q2.push(R);
      }
    }
    for (i2 = 1; i2 < pl; ++i2) if (dad[i2] === i2) {
      if (R !== -1 && dad[R] !== R) dad[i2] = dad[R];
      else if (L !== -1 && dad[L] !== L) dad[i2] = dad[L];
    }
    for (i2 = 1; i2 < pl; ++i2) {
      if (FI[i2].type === 0) continue;
      j = i2;
      if (j != dad[j]) do {
        j = dad[j];
        FP[i2] = FP[j] + "/" + FP[i2];
      } while (j !== 0 && -1 !== dad[j] && j != dad[j]);
      dad[i2] = -1;
    }
    FP[0] += "/";
    for (i2 = 1; i2 < pl; ++i2) {
      if (FI[i2].type !== 2) FP[i2] += "/";
    }
  }
  function get_mfat_entry(entry, payload, mini) {
    var start = entry.start, size = entry.size;
    var o = [];
    var idx = start;
    while (mini && size > 0 && idx >= 0) {
      o.push(payload.slice(idx * MSSZ, idx * MSSZ + MSSZ));
      size -= MSSZ;
      idx = __readInt32LE(mini, idx * 4);
    }
    if (o.length === 0) return new_buf(0);
    return bconcat(o).slice(0, entry.size);
  }
  function sleuth_fat(idx, cnt, sectors, ssz, fat_addrs) {
    var q2 = ENDOFCHAIN;
    if (idx === ENDOFCHAIN) {
      if (cnt !== 0) throw new Error("DIFAT chain shorter than expected");
    } else if (idx !== -1) {
      var sector = sectors[idx], m = (ssz >>> 2) - 1;
      if (!sector) return;
      for (var i2 = 0; i2 < m; ++i2) {
        if ((q2 = __readInt32LE(sector, i2 * 4)) === ENDOFCHAIN) break;
        fat_addrs.push(q2);
      }
      sleuth_fat(__readInt32LE(sector, ssz - 4), cnt - 1, sectors, ssz, fat_addrs);
    }
  }
  function get_sector_list(sectors, start, fat_addrs, ssz, chkd) {
    var buf = [], buf_chain = [];
    if (!chkd) chkd = [];
    var modulus = ssz - 1, j = 0, jj = 0;
    for (j = start; j >= 0; ) {
      chkd[j] = true;
      buf[buf.length] = j;
      buf_chain.push(sectors[j]);
      var addr = fat_addrs[Math.floor(j * 4 / ssz)];
      jj = j * 4 & modulus;
      if (ssz < 4 + jj) throw new Error("FAT boundary crossed: " + j + " 4 " + ssz);
      if (!sectors[addr]) break;
      j = __readInt32LE(sectors[addr], jj);
    }
    return {
      nodes: buf,
      data: __toBuffer([buf_chain])
    };
  }
  function make_sector_list(sectors, dir_start, fat_addrs, ssz) {
    var sl = sectors.length, sector_list = [];
    var chkd = [], buf = [], buf_chain = [];
    var modulus = ssz - 1, i2 = 0, j = 0, k = 0, jj = 0;
    for (i2 = 0; i2 < sl; ++i2) {
      buf = [];
      k = i2 + dir_start;
      if (k >= sl) k -= sl;
      if (chkd[k]) continue;
      buf_chain = [];
      var seen = [];
      for (j = k; j >= 0; ) {
        seen[j] = true;
        chkd[j] = true;
        buf[buf.length] = j;
        buf_chain.push(sectors[j]);
        var addr = fat_addrs[Math.floor(j * 4 / ssz)];
        jj = j * 4 & modulus;
        if (ssz < 4 + jj) throw new Error("FAT boundary crossed: " + j + " 4 " + ssz);
        if (!sectors[addr]) break;
        j = __readInt32LE(sectors[addr], jj);
        if (seen[j]) break;
      }
      sector_list[k] = {
        nodes: buf,
        data: __toBuffer([buf_chain])
      };
    }
    return sector_list;
  }
  function read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, mini) {
    var minifat_store = 0, pl = Paths.length ? 2 : 0;
    var sector = sector_list[dir_start].data;
    var i2 = 0, namelen = 0, name;
    for (; i2 < sector.length; i2 += 128) {
      var blob = (
        /*::(*/
        sector.slice(i2, i2 + 128)
      );
      prep_blob(blob, 64);
      namelen = blob.read_shift(2);
      name = __utf16le(blob, 0, namelen - pl);
      Paths.push(name);
      var o = {
        name,
        type: blob.read_shift(1),
        color: blob.read_shift(1),
        L: blob.read_shift(4, "i"),
        R: blob.read_shift(4, "i"),
        C: blob.read_shift(4, "i"),
        clsid: blob.read_shift(16),
        state: blob.read_shift(4, "i"),
        start: 0,
        size: 0
      };
      var ctime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);
      if (ctime !== 0) o.ct = read_date(blob, blob.l - 8);
      var mtime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);
      if (mtime !== 0) o.mt = read_date(blob, blob.l - 8);
      o.start = blob.read_shift(4, "i");
      o.size = blob.read_shift(4, "i");
      if (o.size < 0 && o.start < 0) {
        o.size = o.type = 0;
        o.start = ENDOFCHAIN;
        o.name = "";
      }
      if (o.type === 5) {
        minifat_store = o.start;
        if (nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = "!StreamData";
      } else if (o.size >= 4096) {
        o.storage = "fat";
        if (sector_list[o.start] === void 0) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);
        sector_list[o.start].name = o.name;
        o.content = sector_list[o.start].data.slice(0, o.size);
      } else {
        o.storage = "minifat";
        if (o.size < 0) o.size = 0;
        else if (minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN && sector_list[minifat_store]) {
          o.content = get_mfat_entry(o, sector_list[minifat_store].data, (sector_list[mini] || {}).data);
        }
      }
      if (o.content) prep_blob(o.content, 0);
      files[name] = o;
      FileIndex.push(o);
    }
  }
  function read_date(blob, offset) {
    return new Date((__readUInt32LE(blob, offset + 4) / 1e7 * Math.pow(2, 32) + __readUInt32LE(blob, offset) / 1e7 - 11644473600) * 1e3);
  }
  function read_file(filename2, options) {
    get_fs();
    return parse(fs.readFileSync(filename2), options);
  }
  function read(blob, options) {
    var type = options && options.type;
    if (!type) {
      if (has_buf && Buffer.isBuffer(blob)) type = "buffer";
    }
    switch (type || "base64") {
      case "file":
        return read_file(blob, options);
      case "base64":
        return parse(s2a(Base64_decode(blob)), options);
      case "binary":
        return parse(s2a(blob), options);
    }
    return parse(
      /*::typeof blob == 'string' ? new Buffer(blob, 'utf-8') : */
      blob,
      options
    );
  }
  function init_cfb(cfb, opts) {
    var o = opts || {}, root = o.root || "Root Entry";
    if (!cfb.FullPaths) cfb.FullPaths = [];
    if (!cfb.FileIndex) cfb.FileIndex = [];
    if (cfb.FullPaths.length !== cfb.FileIndex.length) throw new Error("inconsistent CFB structure");
    if (cfb.FullPaths.length === 0) {
      cfb.FullPaths[0] = root + "/";
      cfb.FileIndex[0] = {
        name: root,
        type: 5
      };
    }
    if (o.CLSID) cfb.FileIndex[0].clsid = o.CLSID;
    seed_cfb(cfb);
  }
  function seed_cfb(cfb) {
    var nm = "Sh33tJ5";
    if (CFB.find(cfb, "/" + nm)) return;
    var p = new_buf(4);
    p[0] = 55;
    p[1] = p[3] = 50;
    p[2] = 54;
    cfb.FileIndex.push(
      {
        name: nm,
        type: 2,
        content: p,
        size: 4,
        L: 69,
        R: 69,
        C: 69
      }
      /*:any*/
    );
    cfb.FullPaths.push(cfb.FullPaths[0] + nm);
    rebuild_cfb(cfb);
  }
  function rebuild_cfb(cfb, f) {
    init_cfb(cfb);
    var gc = false, s = false;
    for (var i2 = cfb.FullPaths.length - 1; i2 >= 0; --i2) {
      var _file = cfb.FileIndex[i2];
      switch (_file.type) {
        case 0:
          if (s) gc = true;
          else {
            cfb.FileIndex.pop();
            cfb.FullPaths.pop();
          }
          break;
        case 1:
        case 2:
        case 5:
          s = true;
          if (isNaN(_file.R * _file.L * _file.C)) gc = true;
          if (_file.R > -1 && _file.L > -1 && _file.R == _file.L) gc = true;
          break;
        default:
          gc = true;
          break;
      }
    }
    if (!gc && !f) return;
    var now = new Date(1987, 1, 19), j = 0;
    var fullPaths = Object.create ? /* @__PURE__ */ Object.create(null) : {};
    var data = [];
    for (i2 = 0; i2 < cfb.FullPaths.length; ++i2) {
      fullPaths[cfb.FullPaths[i2]] = true;
      if (cfb.FileIndex[i2].type === 0) continue;
      data.push([cfb.FullPaths[i2], cfb.FileIndex[i2]]);
    }
    for (i2 = 0; i2 < data.length; ++i2) {
      var dad = dirname(data[i2][0]);
      s = fullPaths[dad];
      if (!s) {
        data.push([
          dad,
          {
            name: filename(dad).replace("/", ""),
            type: 1,
            clsid: HEADER_CLSID,
            ct: now,
            mt: now,
            content: null
          }
          /*:any*/
        ]);
        fullPaths[dad] = true;
      }
    }
    data.sort(function(x, y) {
      return namecmp(x[0], y[0]);
    });
    cfb.FullPaths = [];
    cfb.FileIndex = [];
    for (i2 = 0; i2 < data.length; ++i2) {
      cfb.FullPaths[i2] = data[i2][0];
      cfb.FileIndex[i2] = data[i2][1];
    }
    for (i2 = 0; i2 < data.length; ++i2) {
      var elt = cfb.FileIndex[i2];
      var nm = cfb.FullPaths[i2];
      elt.name = filename(nm).replace("/", "");
      elt.L = elt.R = elt.C = -(elt.color = 1);
      elt.size = elt.content ? elt.content.length : 0;
      elt.start = 0;
      elt.clsid = elt.clsid || HEADER_CLSID;
      if (i2 === 0) {
        elt.C = data.length > 1 ? 1 : -1;
        elt.size = 0;
        elt.type = 5;
      } else if (nm.slice(-1) == "/") {
        for (j = i2 + 1; j < data.length; ++j) if (dirname(cfb.FullPaths[j]) == nm) break;
        elt.C = j >= data.length ? -1 : j;
        for (j = i2 + 1; j < data.length; ++j) if (dirname(cfb.FullPaths[j]) == dirname(nm)) break;
        elt.R = j >= data.length ? -1 : j;
        elt.type = 1;
      } else {
        if (dirname(cfb.FullPaths[i2 + 1] || "") == dirname(nm)) elt.R = i2 + 1;
        elt.type = 2;
      }
    }
  }
  function _write(cfb, options) {
    var _opts = options || {};
    if (_opts.fileType == "mad") return write_mad(cfb, _opts);
    rebuild_cfb(cfb);
    switch (_opts.fileType) {
      case "zip":
        return write_zip2(cfb, _opts);
    }
    var L = function(cfb2) {
      var mini_size = 0, fat_size = 0;
      for (var i3 = 0; i3 < cfb2.FileIndex.length; ++i3) {
        var file2 = cfb2.FileIndex[i3];
        if (!file2.content) continue;
        var flen2 = file2.content.length;
        if (flen2 > 0) {
          if (flen2 < 4096) mini_size += flen2 + 63 >> 6;
          else fat_size += flen2 + 511 >> 9;
        }
      }
      var dir_cnt = cfb2.FullPaths.length + 3 >> 2;
      var mini_cnt = mini_size + 7 >> 3;
      var mfat_cnt = mini_size + 127 >> 7;
      var fat_base = mini_cnt + fat_size + dir_cnt + mfat_cnt;
      var fat_cnt = fat_base + 127 >> 7;
      var difat_cnt = fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt - 109) / 127);
      while (fat_base + fat_cnt + difat_cnt + 127 >> 7 > fat_cnt) difat_cnt = ++fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt - 109) / 127);
      var L2 = [1, difat_cnt, fat_cnt, mfat_cnt, dir_cnt, fat_size, mini_size, 0];
      cfb2.FileIndex[0].size = mini_size << 6;
      L2[7] = (cfb2.FileIndex[0].start = L2[0] + L2[1] + L2[2] + L2[3] + L2[4] + L2[5]) + (L2[6] + 7 >> 3);
      return L2;
    }(cfb);
    var o = new_buf(L[7] << 9);
    var i2 = 0, T = 0;
    {
      for (i2 = 0; i2 < 8; ++i2) o.write_shift(1, HEADER_SIG[i2]);
      for (i2 = 0; i2 < 8; ++i2) o.write_shift(2, 0);
      o.write_shift(2, 62);
      o.write_shift(2, 3);
      o.write_shift(2, 65534);
      o.write_shift(2, 9);
      o.write_shift(2, 6);
      for (i2 = 0; i2 < 3; ++i2) o.write_shift(2, 0);
      o.write_shift(4, 0);
      o.write_shift(4, L[2]);
      o.write_shift(4, L[0] + L[1] + L[2] + L[3] - 1);
      o.write_shift(4, 0);
      o.write_shift(4, 1 << 12);
      o.write_shift(4, L[3] ? L[0] + L[1] + L[2] - 1 : ENDOFCHAIN);
      o.write_shift(4, L[3]);
      o.write_shift(-4, L[1] ? L[0] - 1 : ENDOFCHAIN);
      o.write_shift(4, L[1]);
      for (i2 = 0; i2 < 109; ++i2) o.write_shift(-4, i2 < L[2] ? L[1] + i2 : -1);
    }
    if (L[1]) {
      for (T = 0; T < L[1]; ++T) {
        for (; i2 < 236 + T * 127; ++i2) o.write_shift(-4, i2 < L[2] ? L[1] + i2 : -1);
        o.write_shift(-4, T === L[1] - 1 ? ENDOFCHAIN : T + 1);
      }
    }
    var chainit = function(w) {
      for (T += w; i2 < T - 1; ++i2) o.write_shift(-4, i2 + 1);
      if (w) {
        ++i2;
        o.write_shift(-4, ENDOFCHAIN);
      }
    };
    T = i2 = 0;
    for (T += L[1]; i2 < T; ++i2) o.write_shift(-4, consts.DIFSECT);
    for (T += L[2]; i2 < T; ++i2) o.write_shift(-4, consts.FATSECT);
    chainit(L[3]);
    chainit(L[4]);
    var j = 0, flen = 0;
    var file = cfb.FileIndex[0];
    for (; j < cfb.FileIndex.length; ++j) {
      file = cfb.FileIndex[j];
      if (!file.content) continue;
      flen = file.content.length;
      if (flen < 4096) continue;
      file.start = T;
      chainit(flen + 511 >> 9);
    }
    chainit(L[6] + 7 >> 3);
    while (o.l & 511) o.write_shift(-4, consts.ENDOFCHAIN);
    T = i2 = 0;
    for (j = 0; j < cfb.FileIndex.length; ++j) {
      file = cfb.FileIndex[j];
      if (!file.content) continue;
      flen = file.content.length;
      if (!flen || flen >= 4096) continue;
      file.start = T;
      chainit(flen + 63 >> 6);
    }
    while (o.l & 511) o.write_shift(-4, consts.ENDOFCHAIN);
    for (i2 = 0; i2 < L[4] << 2; ++i2) {
      var nm = cfb.FullPaths[i2];
      if (!nm || nm.length === 0) {
        for (j = 0; j < 17; ++j) o.write_shift(4, 0);
        for (j = 0; j < 3; ++j) o.write_shift(4, -1);
        for (j = 0; j < 12; ++j) o.write_shift(4, 0);
        continue;
      }
      file = cfb.FileIndex[i2];
      if (i2 === 0) file.start = file.size ? file.start - 1 : ENDOFCHAIN;
      var _nm = i2 === 0 && _opts.root || file.name;
      flen = 2 * (_nm.length + 1);
      o.write_shift(64, _nm, "utf16le");
      o.write_shift(2, flen);
      o.write_shift(1, file.type);
      o.write_shift(1, file.color);
      o.write_shift(-4, file.L);
      o.write_shift(-4, file.R);
      o.write_shift(-4, file.C);
      if (!file.clsid) for (j = 0; j < 4; ++j) o.write_shift(4, 0);
      else o.write_shift(16, file.clsid, "hex");
      o.write_shift(4, file.state || 0);
      o.write_shift(4, 0);
      o.write_shift(4, 0);
      o.write_shift(4, 0);
      o.write_shift(4, 0);
      o.write_shift(4, file.start);
      o.write_shift(4, file.size);
      o.write_shift(4, 0);
    }
    for (i2 = 1; i2 < cfb.FileIndex.length; ++i2) {
      file = cfb.FileIndex[i2];
      if (file.size >= 4096) {
        o.l = file.start + 1 << 9;
        if (has_buf && Buffer.isBuffer(file.content)) {
          file.content.copy(o, o.l, 0, file.size);
          o.l += file.size + 511 & -512;
        } else {
          for (j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);
          for (; j & 511; ++j) o.write_shift(1, 0);
        }
      }
    }
    for (i2 = 1; i2 < cfb.FileIndex.length; ++i2) {
      file = cfb.FileIndex[i2];
      if (file.size > 0 && file.size < 4096) {
        if (has_buf && Buffer.isBuffer(file.content)) {
          file.content.copy(o, o.l, 0, file.size);
          o.l += file.size + 63 & -64;
        } else {
          for (j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);
          for (; j & 63; ++j) o.write_shift(1, 0);
        }
      }
    }
    if (has_buf) {
      o.l = o.length;
    } else {
      while (o.l < o.length) o.write_shift(1, 0);
    }
    return o;
  }
  function find(cfb, path) {
    var UCFullPaths = cfb.FullPaths.map(function(x) {
      return x.toUpperCase();
    });
    var UCPaths = UCFullPaths.map(function(x) {
      var y = x.split("/");
      return y[y.length - (x.slice(-1) == "/" ? 2 : 1)];
    });
    var k = false;
    if (path.charCodeAt(0) === 47) {
      k = true;
      path = UCFullPaths[0].slice(0, -1) + path;
    } else k = path.indexOf("/") !== -1;
    var UCPath = path.toUpperCase();
    var w = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);
    if (w !== -1) return cfb.FileIndex[w];
    var m = !UCPath.match(chr1);
    UCPath = UCPath.replace(chr0, "");
    if (m) UCPath = UCPath.replace(chr1, "!");
    for (w = 0; w < UCFullPaths.length; ++w) {
      if ((m ? UCFullPaths[w].replace(chr1, "!") : UCFullPaths[w]).replace(chr0, "") == UCPath) return cfb.FileIndex[w];
      if ((m ? UCPaths[w].replace(chr1, "!") : UCPaths[w]).replace(chr0, "") == UCPath) return cfb.FileIndex[w];
    }
    return null;
  }
  var MSSZ = 64;
  var ENDOFCHAIN = -2;
  var HEADER_SIGNATURE = "d0cf11e0a1b11ae1";
  var HEADER_SIG = [208, 207, 17, 224, 161, 177, 26, 225];
  var HEADER_CLSID = "00000000000000000000000000000000";
  var consts = {
    /* 2.1 Compund File Sector Numbers and Types */
    MAXREGSECT: -6,
    DIFSECT: -4,
    FATSECT: -3,
    ENDOFCHAIN,
    FREESECT: -1,
    /* 2.2 Compound File Header */
    HEADER_SIGNATURE,
    HEADER_MINOR_VERSION: "3e00",
    MAXREGSID: -6,
    NOSTREAM: -1,
    HEADER_CLSID,
    /* 2.6.1 Compound File Directory Entry */
    EntryTypes: ["unknown", "storage", "stream", "lockbytes", "property", "root"]
  };
  function write_file(cfb, filename2, options) {
    get_fs();
    var o = _write(cfb, options);
    fs.writeFileSync(filename2, o);
  }
  function a2s2(o) {
    var out = new Array(o.length);
    for (var i2 = 0; i2 < o.length; ++i2) out[i2] = String.fromCharCode(o[i2]);
    return out.join("");
  }
  function write(cfb, options) {
    var o = _write(cfb, options);
    switch (options && options.type || "buffer") {
      case "file":
        get_fs();
        fs.writeFileSync(
          options.filename,
          o
          /*:any*/
        );
        return o;
      case "binary":
        return typeof o == "string" ? o : a2s2(o);
      case "base64":
        return Base64_encode(typeof o == "string" ? o : a2s2(o));
      case "buffer":
        if (has_buf) return Buffer.isBuffer(o) ? o : Buffer_from(o);
      /* falls through */
      case "array":
        return typeof o == "string" ? s2a(o) : o;
    }
    return o;
  }
  var _zlib;
  function use_zlib(zlib) {
    try {
      var InflateRaw = zlib.InflateRaw;
      var InflRaw = new InflateRaw();
      InflRaw._processChunk(new Uint8Array([3, 0]), InflRaw._finishFlushFlag);
      if (InflRaw.bytesRead) _zlib = zlib;
      else throw new Error("zlib does not expose bytesRead");
    } catch (e) {
      console.error("cannot use native zlib: " + (e.message || e));
    }
  }
  function _inflateRawSync(payload, usz) {
    if (!_zlib) return _inflate(payload, usz);
    var InflateRaw = _zlib.InflateRaw;
    var InflRaw = new InflateRaw();
    var out = InflRaw._processChunk(payload.slice(payload.l), InflRaw._finishFlushFlag);
    payload.l += InflRaw.bytesRead;
    return out;
  }
  function _deflateRawSync(payload) {
    return _zlib ? _zlib.deflateRawSync(payload) : _deflate(payload);
  }
  var CLEN_ORDER = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];
  var LEN_LN = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258];
  var DST_LN = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577];
  function bit_swap_8(n) {
    var t = (n << 1 | n << 11) & 139536 | (n << 5 | n << 15) & 558144;
    return (t >> 16 | t >> 8 | t) & 255;
  }
  var use_typed_arrays = typeof Uint8Array !== "undefined";
  var bitswap8 = use_typed_arrays ? new Uint8Array(1 << 8) : [];
  for (var q = 0; q < 1 << 8; ++q) bitswap8[q] = bit_swap_8(q);
  function bit_swap_n(n, b) {
    var rev = bitswap8[n & 255];
    if (b <= 8) return rev >>> 8 - b;
    rev = rev << 8 | bitswap8[n >> 8 & 255];
    if (b <= 16) return rev >>> 16 - b;
    rev = rev << 8 | bitswap8[n >> 16 & 255];
    return rev >>> 24 - b;
  }
  function read_bits_2(buf, bl) {
    var w = bl & 7, h = bl >>> 3;
    return (buf[h] | (w <= 6 ? 0 : buf[h + 1] << 8)) >>> w & 3;
  }
  function read_bits_3(buf, bl) {
    var w = bl & 7, h = bl >>> 3;
    return (buf[h] | (w <= 5 ? 0 : buf[h + 1] << 8)) >>> w & 7;
  }
  function read_bits_4(buf, bl) {
    var w = bl & 7, h = bl >>> 3;
    return (buf[h] | (w <= 4 ? 0 : buf[h + 1] << 8)) >>> w & 15;
  }
  function read_bits_5(buf, bl) {
    var w = bl & 7, h = bl >>> 3;
    return (buf[h] | (w <= 3 ? 0 : buf[h + 1] << 8)) >>> w & 31;
  }
  function read_bits_7(buf, bl) {
    var w = bl & 7, h = bl >>> 3;
    return (buf[h] | (w <= 1 ? 0 : buf[h + 1] << 8)) >>> w & 127;
  }
  function read_bits_n(buf, bl, n) {
    var w = bl & 7, h = bl >>> 3, f = (1 << n) - 1;
    var v = buf[h] >>> w;
    if (n < 8 - w) return v & f;
    v |= buf[h + 1] << 8 - w;
    if (n < 16 - w) return v & f;
    v |= buf[h + 2] << 16 - w;
    if (n < 24 - w) return v & f;
    v |= buf[h + 3] << 24 - w;
    return v & f;
  }
  function write_bits_3(buf, bl, v) {
    var w = bl & 7, h = bl >>> 3;
    if (w <= 5) buf[h] |= (v & 7) << w;
    else {
      buf[h] |= v << w & 255;
      buf[h + 1] = (v & 7) >> 8 - w;
    }
    return bl + 3;
  }
  function write_bits_1(buf, bl, v) {
    var w = bl & 7, h = bl >>> 3;
    v = (v & 1) << w;
    buf[h] |= v;
    return bl + 1;
  }
  function write_bits_8(buf, bl, v) {
    var w = bl & 7, h = bl >>> 3;
    v <<= w;
    buf[h] |= v & 255;
    v >>>= 8;
    buf[h + 1] = v;
    return bl + 8;
  }
  function write_bits_16(buf, bl, v) {
    var w = bl & 7, h = bl >>> 3;
    v <<= w;
    buf[h] |= v & 255;
    v >>>= 8;
    buf[h + 1] = v & 255;
    buf[h + 2] = v >>> 8;
    return bl + 16;
  }
  function realloc(b, sz) {
    var L = b.length, M = 2 * L > sz ? 2 * L : sz + 5, i2 = 0;
    if (L >= sz) return b;
    if (has_buf) {
      var o = new_unsafe_buf(M);
      if (b.copy) b.copy(o);
      else for (; i2 < b.length; ++i2) o[i2] = b[i2];
      return o;
    } else if (use_typed_arrays) {
      var a = new Uint8Array(M);
      if (a.set) a.set(b);
      else for (; i2 < L; ++i2) a[i2] = b[i2];
      return a;
    }
    b.length = M;
    return b;
  }
  function zero_fill_array(n) {
    var o = new Array(n);
    for (var i2 = 0; i2 < n; ++i2) o[i2] = 0;
    return o;
  }
  function build_tree(clens, cmap, MAX) {
    var maxlen = 1, w = 0, i2 = 0, j = 0, ccode = 0, L = clens.length;
    var bl_count = use_typed_arrays ? new Uint16Array(32) : zero_fill_array(32);
    for (i2 = 0; i2 < 32; ++i2) bl_count[i2] = 0;
    for (i2 = L; i2 < MAX; ++i2) clens[i2] = 0;
    L = clens.length;
    var ctree = use_typed_arrays ? new Uint16Array(L) : zero_fill_array(L);
    for (i2 = 0; i2 < L; ++i2) {
      bl_count[w = clens[i2]]++;
      if (maxlen < w) maxlen = w;
      ctree[i2] = 0;
    }
    bl_count[0] = 0;
    for (i2 = 1; i2 <= maxlen; ++i2) bl_count[i2 + 16] = ccode = ccode + bl_count[i2 - 1] << 1;
    for (i2 = 0; i2 < L; ++i2) {
      ccode = clens[i2];
      if (ccode != 0) ctree[i2] = bl_count[ccode + 16]++;
    }
    var cleni = 0;
    for (i2 = 0; i2 < L; ++i2) {
      cleni = clens[i2];
      if (cleni != 0) {
        ccode = bit_swap_n(ctree[i2], maxlen) >> maxlen - cleni;
        for (j = (1 << maxlen + 4 - cleni) - 1; j >= 0; --j) cmap[ccode | j << cleni] = cleni & 15 | i2 << 4;
      }
    }
    return maxlen;
  }
  var fix_lmap = use_typed_arrays ? new Uint16Array(512) : zero_fill_array(512);
  var fix_dmap = use_typed_arrays ? new Uint16Array(32) : zero_fill_array(32);
  if (!use_typed_arrays) {
    for (var i = 0; i < 512; ++i) fix_lmap[i] = 0;
    for (i = 0; i < 32; ++i) fix_dmap[i] = 0;
  }
  (function() {
    var dlens = [];
    var i2 = 0;
    for (; i2 < 32; i2++) dlens.push(5);
    build_tree(dlens, fix_dmap, 32);
    var clens = [];
    i2 = 0;
    for (; i2 <= 143; i2++) clens.push(8);
    for (; i2 <= 255; i2++) clens.push(9);
    for (; i2 <= 279; i2++) clens.push(7);
    for (; i2 <= 287; i2++) clens.push(8);
    build_tree(clens, fix_lmap, 288);
  })();
  var _deflateRaw = /* @__PURE__ */ function _deflateRawIIFE() {
    var DST_LN_RE = use_typed_arrays ? new Uint8Array(32768) : [];
    var j = 0, k = 0;
    for (; j < DST_LN.length - 1; ++j) {
      for (; k < DST_LN[j + 1]; ++k) DST_LN_RE[k] = j;
    }
    for (; k < 32768; ++k) DST_LN_RE[k] = 29;
    var LEN_LN_RE = use_typed_arrays ? new Uint8Array(259) : [];
    for (j = 0, k = 0; j < LEN_LN.length - 1; ++j) {
      for (; k < LEN_LN[j + 1]; ++k) LEN_LN_RE[k] = j;
    }
    function write_stored(data, out) {
      var boff = 0;
      while (boff < data.length) {
        var L = Math.min(65535, data.length - boff);
        var h = boff + L == data.length;
        out.write_shift(1, +h);
        out.write_shift(2, L);
        out.write_shift(2, ~L & 65535);
        while (L-- > 0) out[out.l++] = data[boff++];
      }
      return out.l;
    }
    function write_huff_fixed(data, out) {
      var bl = 0;
      var boff = 0;
      var addrs = use_typed_arrays ? new Uint16Array(32768) : [];
      while (boff < data.length) {
        var L = (
          /* data.length - boff; */
          Math.min(65535, data.length - boff)
        );
        if (L < 10) {
          bl = write_bits_3(out, bl, +!!(boff + L == data.length));
          if (bl & 7) bl += 8 - (bl & 7);
          out.l = bl / 8 | 0;
          out.write_shift(2, L);
          out.write_shift(2, ~L & 65535);
          while (L-- > 0) out[out.l++] = data[boff++];
          bl = out.l * 8;
          continue;
        }
        bl = write_bits_3(out, bl, +!!(boff + L == data.length) + 2);
        var hash = 0;
        while (L-- > 0) {
          var d = data[boff];
          hash = (hash << 5 ^ d) & 32767;
          var match = -1, mlen = 0;
          if (match = addrs[hash]) {
            match |= boff & ~32767;
            if (match > boff) match -= 32768;
            if (match < boff) while (data[match + mlen] == data[boff + mlen] && mlen < 250) ++mlen;
          }
          if (mlen > 2) {
            d = LEN_LN_RE[mlen];
            if (d <= 22) bl = write_bits_8(out, bl, bitswap8[d + 1] >> 1) - 1;
            else {
              write_bits_8(out, bl, 3);
              bl += 5;
              write_bits_8(out, bl, bitswap8[d - 23] >> 5);
              bl += 3;
            }
            var len_eb = d < 8 ? 0 : d - 4 >> 2;
            if (len_eb > 0) {
              write_bits_16(out, bl, mlen - LEN_LN[d]);
              bl += len_eb;
            }
            d = DST_LN_RE[boff - match];
            bl = write_bits_8(out, bl, bitswap8[d] >> 3);
            bl -= 3;
            var dst_eb = d < 4 ? 0 : d - 2 >> 1;
            if (dst_eb > 0) {
              write_bits_16(out, bl, boff - match - DST_LN[d]);
              bl += dst_eb;
            }
            for (var q2 = 0; q2 < mlen; ++q2) {
              addrs[hash] = boff & 32767;
              hash = (hash << 5 ^ data[boff]) & 32767;
              ++boff;
            }
            L -= mlen - 1;
          } else {
            if (d <= 143) d = d + 48;
            else bl = write_bits_1(out, bl, 1);
            bl = write_bits_8(out, bl, bitswap8[d]);
            addrs[hash] = boff & 32767;
            ++boff;
          }
        }
        bl = write_bits_8(out, bl, 0) - 1;
      }
      out.l = (bl + 7) / 8 | 0;
      return out.l;
    }
    return function _deflateRaw2(data, out) {
      if (data.length < 8) return write_stored(data, out);
      return write_huff_fixed(data, out);
    };
  }();
  function _deflate(data) {
    var buf = new_buf(50 + Math.floor(data.length * 1.1));
    var off = _deflateRaw(data, buf);
    return buf.slice(0, off);
  }
  var dyn_lmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);
  var dyn_dmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);
  var dyn_cmap = use_typed_arrays ? new Uint16Array(128) : zero_fill_array(128);
  var dyn_len_1 = 1, dyn_len_2 = 1;
  function dyn(data, boff) {
    var _HLIT = read_bits_5(data, boff) + 257;
    boff += 5;
    var _HDIST = read_bits_5(data, boff) + 1;
    boff += 5;
    var _HCLEN = read_bits_4(data, boff) + 4;
    boff += 4;
    var w = 0;
    var clens = use_typed_arrays ? new Uint8Array(19) : zero_fill_array(19);
    var ctree = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    var maxlen = 1;
    var bl_count = use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);
    var next_code = use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);
    var L = clens.length;
    for (var i2 = 0; i2 < _HCLEN; ++i2) {
      clens[CLEN_ORDER[i2]] = w = read_bits_3(data, boff);
      if (maxlen < w) maxlen = w;
      bl_count[w]++;
      boff += 3;
    }
    var ccode = 0;
    bl_count[0] = 0;
    for (i2 = 1; i2 <= maxlen; ++i2) next_code[i2] = ccode = ccode + bl_count[i2 - 1] << 1;
    for (i2 = 0; i2 < L; ++i2) if ((ccode = clens[i2]) != 0) ctree[i2] = next_code[ccode]++;
    var cleni = 0;
    for (i2 = 0; i2 < L; ++i2) {
      cleni = clens[i2];
      if (cleni != 0) {
        ccode = bitswap8[ctree[i2]] >> 8 - cleni;
        for (var j = (1 << 7 - cleni) - 1; j >= 0; --j) dyn_cmap[ccode | j << cleni] = cleni & 7 | i2 << 3;
      }
    }
    var hcodes = [];
    maxlen = 1;
    for (; hcodes.length < _HLIT + _HDIST; ) {
      ccode = dyn_cmap[read_bits_7(data, boff)];
      boff += ccode & 7;
      switch (ccode >>>= 3) {
        case 16:
          w = 3 + read_bits_2(data, boff);
          boff += 2;
          ccode = hcodes[hcodes.length - 1];
          while (w-- > 0) hcodes.push(ccode);
          break;
        case 17:
          w = 3 + read_bits_3(data, boff);
          boff += 3;
          while (w-- > 0) hcodes.push(0);
          break;
        case 18:
          w = 11 + read_bits_7(data, boff);
          boff += 7;
          while (w-- > 0) hcodes.push(0);
          break;
        default:
          hcodes.push(ccode);
          if (maxlen < ccode) maxlen = ccode;
          break;
      }
    }
    var h1 = hcodes.slice(0, _HLIT), h2 = hcodes.slice(_HLIT);
    for (i2 = _HLIT; i2 < 286; ++i2) h1[i2] = 0;
    for (i2 = _HDIST; i2 < 30; ++i2) h2[i2] = 0;
    dyn_len_1 = build_tree(h1, dyn_lmap, 286);
    dyn_len_2 = build_tree(h2, dyn_dmap, 30);
    return boff;
  }
  function inflate(data, usz) {
    if (data[0] == 3 && !(data[1] & 3)) {
      return [new_raw_buf(usz), 2];
    }
    var boff = 0;
    var header = 0;
    var outbuf = new_unsafe_buf(usz ? usz : 1 << 18);
    var woff = 0;
    var OL = outbuf.length >>> 0;
    var max_len_1 = 0, max_len_2 = 0;
    while ((header & 1) == 0) {
      header = read_bits_3(data, boff);
      boff += 3;
      if (header >>> 1 == 0) {
        if (boff & 7) boff += 8 - (boff & 7);
        var sz = data[boff >>> 3] | data[(boff >>> 3) + 1] << 8;
        boff += 32;
        if (sz > 0) {
          if (!usz && OL < woff + sz) {
            outbuf = realloc(outbuf, woff + sz);
            OL = outbuf.length;
          }
          while (sz-- > 0) {
            outbuf[woff++] = data[boff >>> 3];
            boff += 8;
          }
        }
        continue;
      } else if (header >> 1 == 1) {
        max_len_1 = 9;
        max_len_2 = 5;
      } else {
        boff = dyn(data, boff);
        max_len_1 = dyn_len_1;
        max_len_2 = dyn_len_2;
      }
      for (; ; ) {
        if (!usz && OL < woff + 32767) {
          outbuf = realloc(outbuf, woff + 32767);
          OL = outbuf.length;
        }
        var bits = read_bits_n(data, boff, max_len_1);
        var code = header >>> 1 == 1 ? fix_lmap[bits] : dyn_lmap[bits];
        boff += code & 15;
        code >>>= 4;
        if ((code >>> 8 & 255) === 0) outbuf[woff++] = code;
        else if (code == 256) break;
        else {
          code -= 257;
          var len_eb = code < 8 ? 0 : code - 4 >> 2;
          if (len_eb > 5) len_eb = 0;
          var tgt = woff + LEN_LN[code];
          if (len_eb > 0) {
            tgt += read_bits_n(data, boff, len_eb);
            boff += len_eb;
          }
          bits = read_bits_n(data, boff, max_len_2);
          code = header >>> 1 == 1 ? fix_dmap[bits] : dyn_dmap[bits];
          boff += code & 15;
          code >>>= 4;
          var dst_eb = code < 4 ? 0 : code - 2 >> 1;
          var dst = DST_LN[code];
          if (dst_eb > 0) {
            dst += read_bits_n(data, boff, dst_eb);
            boff += dst_eb;
          }
          if (!usz && OL < tgt) {
            outbuf = realloc(outbuf, tgt + 100);
            OL = outbuf.length;
          }
          while (woff < tgt) {
            outbuf[woff] = outbuf[woff - dst];
            ++woff;
          }
        }
      }
    }
    if (usz) return [outbuf, boff + 7 >>> 3];
    return [outbuf.slice(0, woff), boff + 7 >>> 3];
  }
  function _inflate(payload, usz) {
    var data = payload.slice(payload.l || 0);
    var out = inflate(data, usz);
    payload.l += out[1];
    return out[0];
  }
  function warn_or_throw(wrn, msg) {
    if (wrn) {
      if (typeof console !== "undefined") console.error(msg);
    } else throw new Error(msg);
  }
  function parse_zip(file, options) {
    var blob = (
      /*::(*/
      file
    );
    prep_blob(blob, 0);
    var FileIndex = [], FullPaths = [];
    var o = {
      FileIndex,
      FullPaths
    };
    init_cfb(o, {
      root: options.root
    });
    var i2 = blob.length - 4;
    while ((blob[i2] != 80 || blob[i2 + 1] != 75 || blob[i2 + 2] != 5 || blob[i2 + 3] != 6) && i2 >= 0) --i2;
    blob.l = i2 + 4;
    blob.l += 4;
    var fcnt = blob.read_shift(2);
    blob.l += 6;
    var start_cd = blob.read_shift(4);
    blob.l = start_cd;
    for (i2 = 0; i2 < fcnt; ++i2) {
      blob.l += 20;
      var csz = blob.read_shift(4);
      var usz = blob.read_shift(4);
      var namelen = blob.read_shift(2);
      var efsz = blob.read_shift(2);
      var fcsz = blob.read_shift(2);
      blob.l += 8;
      var offset = blob.read_shift(4);
      var EF = parse_extra_field(
        /*::(*/
        blob.slice(blob.l + namelen, blob.l + namelen + efsz)
        /*:: :any)*/
      );
      blob.l += namelen + efsz + fcsz;
      var L = blob.l;
      blob.l = offset + 4;
      parse_local_file(blob, csz, usz, o, EF);
      blob.l = L;
    }
    return o;
  }
  function parse_local_file(blob, csz, usz, o, EF) {
    blob.l += 2;
    var flags = blob.read_shift(2);
    var meth = blob.read_shift(2);
    var date = parse_dos_date(blob);
    if (flags & 8257) throw new Error("Unsupported ZIP encryption");
    var crc32 = blob.read_shift(4);
    var _csz = blob.read_shift(4);
    var _usz = blob.read_shift(4);
    var namelen = blob.read_shift(2);
    var efsz = blob.read_shift(2);
    var name = "";
    for (var i2 = 0; i2 < namelen; ++i2) name += String.fromCharCode(blob[blob.l++]);
    if (efsz) {
      var ef = parse_extra_field(
        /*::(*/
        blob.slice(blob.l, blob.l + efsz)
        /*:: :any)*/
      );
      if ((ef[21589] || {}).mt) date = ef[21589].mt;
      if (((EF || {})[21589] || {}).mt) date = EF[21589].mt;
    }
    blob.l += efsz;
    var data = blob.slice(blob.l, blob.l + _csz);
    switch (meth) {
      case 8:
        data = _inflateRawSync(blob, _usz);
        break;
      case 0:
        break;
      // TODO: scan for magic number
      default:
        throw new Error("Unsupported ZIP Compression method " + meth);
    }
    var wrn = false;
    if (flags & 8) {
      crc32 = blob.read_shift(4);
      if (crc32 == 134695760) {
        crc32 = blob.read_shift(4);
        wrn = true;
      }
      _csz = blob.read_shift(4);
      _usz = blob.read_shift(4);
    }
    if (_csz != csz) warn_or_throw(wrn, "Bad compressed size: " + csz + " != " + _csz);
    if (_usz != usz) warn_or_throw(wrn, "Bad uncompressed size: " + usz + " != " + _usz);
    cfb_add(o, name, data, {
      unsafe: true,
      mt: date
    });
  }
  function write_zip2(cfb, options) {
    var _opts = options || {};
    var out = [], cdirs = [];
    var o = new_buf(1);
    var method = _opts.compression ? 8 : 0, flags = 0;
    var desc = false;
    if (desc) flags |= 8;
    var i2 = 0, j = 0;
    var start_cd = 0, fcnt = 0;
    var root = cfb.FullPaths[0], fp = root, fi = cfb.FileIndex[0];
    var crcs = [];
    var sz_cd = 0;
    for (i2 = 1; i2 < cfb.FullPaths.length; ++i2) {
      fp = cfb.FullPaths[i2].slice(root.length);
      fi = cfb.FileIndex[i2];
      if (!fi.size || !fi.content || fp == "Sh33tJ5") continue;
      var start = start_cd;
      var namebuf = new_buf(fp.length);
      for (j = 0; j < fp.length; ++j) namebuf.write_shift(1, fp.charCodeAt(j) & 127);
      namebuf = namebuf.slice(0, namebuf.l);
      crcs[fcnt] = CRC32.buf(
        /*::((*/
        fi.content,
        0
      );
      var outbuf = fi.content;
      if (method == 8) outbuf = _deflateRawSync(outbuf);
      o = new_buf(30);
      o.write_shift(4, 67324752);
      o.write_shift(2, 20);
      o.write_shift(2, flags);
      o.write_shift(2, method);
      if (fi.mt) write_dos_date(o, fi.mt);
      else o.write_shift(4, 0);
      o.write_shift(-4, flags & 8 ? 0 : crcs[fcnt]);
      o.write_shift(4, flags & 8 ? 0 : outbuf.length);
      o.write_shift(4, flags & 8 ? 0 : (
        /*::(*/
        fi.content.length
      ));
      o.write_shift(2, namebuf.length);
      o.write_shift(2, 0);
      start_cd += o.length;
      out.push(o);
      start_cd += namebuf.length;
      out.push(namebuf);
      start_cd += outbuf.length;
      out.push(outbuf);
      if (flags & 8) {
        o = new_buf(12);
        o.write_shift(-4, crcs[fcnt]);
        o.write_shift(4, outbuf.length);
        o.write_shift(
          4,
          /*::(*/
          fi.content.length
        );
        start_cd += o.l;
        out.push(o);
      }
      o = new_buf(46);
      o.write_shift(4, 33639248);
      o.write_shift(2, 0);
      o.write_shift(2, 20);
      o.write_shift(2, flags);
      o.write_shift(2, method);
      o.write_shift(4, 0);
      o.write_shift(-4, crcs[fcnt]);
      o.write_shift(4, outbuf.length);
      o.write_shift(
        4,
        /*::(*/
        fi.content.length
      );
      o.write_shift(2, namebuf.length);
      o.write_shift(2, 0);
      o.write_shift(2, 0);
      o.write_shift(2, 0);
      o.write_shift(2, 0);
      o.write_shift(4, 0);
      o.write_shift(4, start);
      sz_cd += o.l;
      cdirs.push(o);
      sz_cd += namebuf.length;
      cdirs.push(namebuf);
      ++fcnt;
    }
    o = new_buf(22);
    o.write_shift(4, 101010256);
    o.write_shift(2, 0);
    o.write_shift(2, 0);
    o.write_shift(2, fcnt);
    o.write_shift(2, fcnt);
    o.write_shift(4, sz_cd);
    o.write_shift(4, start_cd);
    o.write_shift(2, 0);
    return bconcat(
      [bconcat(
        out
        /*:any*/
      ), bconcat(cdirs), o]
      /*:any*/
    );
  }
  var ContentTypeMap = {
    "htm": "text/html",
    "xml": "text/xml",
    "gif": "image/gif",
    "jpg": "image/jpeg",
    "png": "image/png",
    "mso": "application/x-mso",
    "thmx": "application/vnd.ms-officetheme",
    "sh33tj5": "application/octet-stream"
  };
  function get_content_type(fi, fp) {
    if (fi.ctype) return fi.ctype;
    var ext = fi.name || "", m = ext.match(/\.([^\.]+)$/);
    if (m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];
    if (fp) {
      m = (ext = fp).match(/[\.\\]([^\.\\])+$/);
      if (m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];
    }
    return "application/octet-stream";
  }
  function write_base64_76(bstr) {
    var data = Base64_encode(bstr);
    var o = [];
    for (var i2 = 0; i2 < data.length; i2 += 76) o.push(data.slice(i2, i2 + 76));
    return o.join("\r\n") + "\r\n";
  }
  function write_quoted_printable(text) {
    var encoded = text.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g, function(c) {
      var w = c.charCodeAt(0).toString(16).toUpperCase();
      return "=" + (w.length == 1 ? "0" + w : w);
    });
    encoded = encoded.replace(/ $/mg, "=20").replace(/\t$/mg, "=09");
    if (encoded.charAt(0) == "\n") encoded = "=0D" + encoded.slice(1);
    encoded = encoded.replace(/\r(?!\n)/mg, "=0D").replace(/\n\n/mg, "\n=0A").replace(/([^\r\n])\n/mg, "$1=0A");
    var o = [], split = encoded.split("\r\n");
    for (var si = 0; si < split.length; ++si) {
      var str = split[si];
      if (str.length == 0) {
        o.push("");
        continue;
      }
      for (var i2 = 0; i2 < str.length; ) {
        var end = 76;
        var tmp = str.slice(i2, i2 + end);
        if (tmp.charAt(end - 1) == "=") end--;
        else if (tmp.charAt(end - 2) == "=") end -= 2;
        else if (tmp.charAt(end - 3) == "=") end -= 3;
        tmp = str.slice(i2, i2 + end);
        i2 += end;
        if (i2 < str.length) tmp += "=";
        o.push(tmp);
      }
    }
    return o.join("\r\n");
  }
  function parse_quoted_printable(data) {
    var o = [];
    for (var di = 0; di < data.length; ++di) {
      var line = data[di];
      while (di <= data.length && line.charAt(line.length - 1) == "=") line = line.slice(0, line.length - 1) + data[++di];
      o.push(line);
    }
    for (var oi = 0; oi < o.length; ++oi) o[oi] = o[oi].replace(/[=][0-9A-Fa-f]{2}/g, function($$) {
      return String.fromCharCode(parseInt($$.slice(1), 16));
    });
    return s2a(o.join("\r\n"));
  }
  function parse_mime(cfb, data, root) {
    var fname = "", cte = "", ctype = "", fdata;
    var di = 0;
    for (; di < 10; ++di) {
      var line = data[di];
      if (!line || line.match(/^\s*$/)) break;
      var m = line.match(/^(.*?):\s*([^\s].*)$/);
      if (m) switch (m[1].toLowerCase()) {
        case "content-location":
          fname = m[2].trim();
          break;
        case "content-type":
          ctype = m[2].trim();
          break;
        case "content-transfer-encoding":
          cte = m[2].trim();
          break;
      }
    }
    ++di;
    switch (cte.toLowerCase()) {
      case "base64":
        fdata = s2a(Base64_decode(data.slice(di).join("")));
        break;
      case "quoted-printable":
        fdata = parse_quoted_printable(data.slice(di));
        break;
      default:
        throw new Error("Unsupported Content-Transfer-Encoding " + cte);
    }
    var file = cfb_add(cfb, fname.slice(root.length), fdata, {
      unsafe: true
    });
    if (ctype) file.ctype = ctype;
  }
  function parse_mad(file, options) {
    if (a2s2(file.slice(0, 13)).toLowerCase() != "mime-version:") throw new Error("Unsupported MAD header");
    var root = options && options.root || "";
    var data = (has_buf && Buffer.isBuffer(file) ? file.toString("binary") : a2s2(file)).split("\r\n");
    var di = 0, row = "";
    for (di = 0; di < data.length; ++di) {
      row = data[di];
      if (!/^Content-Location:/i.test(row)) continue;
      row = row.slice(row.indexOf("file"));
      if (!root) root = row.slice(0, row.lastIndexOf("/") + 1);
      if (row.slice(0, root.length) == root) continue;
      while (root.length > 0) {
        root = root.slice(0, root.length - 1);
        root = root.slice(0, root.lastIndexOf("/") + 1);
        if (row.slice(0, root.length) == root) break;
      }
    }
    var mboundary = (data[1] || "").match(/boundary="(.*?)"/);
    if (!mboundary) throw new Error("MAD cannot find boundary");
    var boundary = "--" + (mboundary[1] || "");
    var FileIndex = [], FullPaths = [];
    var o = {
      FileIndex,
      FullPaths
    };
    init_cfb(o);
    var start_di, fcnt = 0;
    for (di = 0; di < data.length; ++di) {
      var line = data[di];
      if (line !== boundary && line !== boundary + "--") continue;
      if (fcnt++) parse_mime(o, data.slice(start_di, di), root);
      start_di = di;
    }
    return o;
  }
  function write_mad(cfb, options) {
    var opts = options || {};
    var boundary = opts.boundary || "SheetJS";
    boundary = "------=" + boundary;
    var out = ["MIME-Version: 1.0", 'Content-Type: multipart/related; boundary="' + boundary.slice(2) + '"', "", "", ""];
    var root = cfb.FullPaths[0], fp = root, fi = cfb.FileIndex[0];
    for (var i2 = 1; i2 < cfb.FullPaths.length; ++i2) {
      fp = cfb.FullPaths[i2].slice(root.length);
      fi = cfb.FileIndex[i2];
      if (!fi.size || !fi.content || fp == "Sh33tJ5") continue;
      fp = fp.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g, function(c) {
        return "_x" + c.charCodeAt(0).toString(16) + "_";
      }).replace(/[\u0080-\uFFFF]/g, function(u2) {
        return "_u" + u2.charCodeAt(0).toString(16) + "_";
      });
      var ca = fi.content;
      var cstr = has_buf && Buffer.isBuffer(ca) ? ca.toString("binary") : a2s2(ca);
      var dispcnt = 0, L = Math.min(1024, cstr.length), cc = 0;
      for (var csl = 0; csl <= L; ++csl) if ((cc = cstr.charCodeAt(csl)) >= 32 && cc < 128) ++dispcnt;
      var qp = dispcnt >= L * 4 / 5;
      out.push(boundary);
      out.push("Content-Location: " + (opts.root || "file:///C:/SheetJS/") + fp);
      out.push("Content-Transfer-Encoding: " + (qp ? "quoted-printable" : "base64"));
      out.push("Content-Type: " + get_content_type(fi, fp));
      out.push("");
      out.push(qp ? write_quoted_printable(cstr) : write_base64_76(cstr));
    }
    out.push(boundary + "--\r\n");
    return out.join("\r\n");
  }
  function cfb_new(opts) {
    var o = {};
    init_cfb(o, opts);
    return o;
  }
  function cfb_add(cfb, name, content, opts) {
    var unsafe = opts && opts.unsafe;
    if (!unsafe) init_cfb(cfb);
    var file = !unsafe && CFB.find(cfb, name);
    if (!file) {
      var fpath = cfb.FullPaths[0];
      if (name.slice(0, fpath.length) == fpath) fpath = name;
      else {
        if (fpath.slice(-1) != "/") fpath += "/";
        fpath = (fpath + name).replace("//", "/");
      }
      file = {
        name: filename(name),
        type: 2
      };
      cfb.FileIndex.push(file);
      cfb.FullPaths.push(fpath);
      if (!unsafe) CFB.utils.cfb_gc(cfb);
    }
    file.content = content;
    file.size = content ? content.length : 0;
    if (opts) {
      if (opts.CLSID) file.clsid = opts.CLSID;
      if (opts.mt) file.mt = opts.mt;
      if (opts.ct) file.ct = opts.ct;
    }
    return file;
  }
  function cfb_del(cfb, name) {
    init_cfb(cfb);
    var file = CFB.find(cfb, name);
    if (file) {
      for (var j = 0; j < cfb.FileIndex.length; ++j) if (cfb.FileIndex[j] == file) {
        cfb.FileIndex.splice(j, 1);
        cfb.FullPaths.splice(j, 1);
        return true;
      }
    }
    return false;
  }
  function cfb_mov(cfb, old_name, new_name) {
    init_cfb(cfb);
    var file = CFB.find(cfb, old_name);
    if (file) {
      for (var j = 0; j < cfb.FileIndex.length; ++j) if (cfb.FileIndex[j] == file) {
        cfb.FileIndex[j].name = filename(new_name);
        cfb.FullPaths[j] = new_name;
        return true;
      }
    }
    return false;
  }
  function cfb_gc(cfb) {
    rebuild_cfb(cfb, true);
  }
  exports.find = find;
  exports.read = read;
  exports.parse = parse;
  exports.write = write;
  exports.writeFile = write_file;
  exports.utils = {
    cfb_new,
    cfb_add,
    cfb_del,
    cfb_mov,
    cfb_gc,
    ReadShift,
    CheckField,
    prep_blob,
    bconcat,
    use_zlib,
    _deflateRaw: _deflate,
    _inflateRaw: _inflate,
    consts
  };
  return exports;
}();
var _fs = void 0;
function blobify(data) {
  if (typeof data === "string") return s2ab(data);
  if (Array.isArray(data)) return a2u(data);
  return data;
}
function write_dl(fname, payload, enc) {
  if (typeof _fs !== "undefined" && _fs.writeFileSync) return enc ? _fs.writeFileSync(fname, payload, enc) : _fs.writeFileSync(fname, payload);
  if (typeof Deno !== "undefined") {
    if (enc && typeof payload == "string") switch (enc) {
      case "utf8":
        payload = new TextEncoder(enc).encode(payload);
        break;
      case "binary":
        payload = s2ab(payload);
        break;
      /* TODO: binary equivalent */
      default:
        throw new Error("Unsupported encoding " + enc);
    }
    return Deno.writeFileSync(fname, payload);
  }
  var data = enc == "utf8" ? utf8write(payload) : payload;
  if (typeof IE_SaveFile !== "undefined") return IE_SaveFile(data, fname);
  if (typeof Blob !== "undefined") {
    var blob = new Blob([blobify(data)], {
      type: "application/octet-stream"
    });
    if (typeof navigator !== "undefined" && navigator.msSaveBlob) return navigator.msSaveBlob(blob, fname);
    if (typeof saveAs !== "undefined") return saveAs(blob, fname);
    if (typeof URL !== "undefined" && typeof document !== "undefined" && document.createElement && URL.createObjectURL) {
      var url = URL.createObjectURL(blob);
      if (typeof chrome === "object" && typeof (chrome.downloads || {}).download == "function") {
        if (URL.revokeObjectURL && typeof setTimeout !== "undefined") setTimeout(function() {
          URL.revokeObjectURL(url);
        }, 6e4);
        return chrome.downloads.download({
          url,
          filename: fname,
          saveAs: true
        });
      }
      var a = document.createElement("a");
      if (a.download != null) {
        a.download = fname;
        a.href = url;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        if (URL.revokeObjectURL && typeof setTimeout !== "undefined") setTimeout(function() {
          URL.revokeObjectURL(url);
        }, 6e4);
        return url;
      }
    }
  }
  if (typeof $ !== "undefined" && typeof File !== "undefined" && typeof Folder !== "undefined") try {
    var out = File(fname);
    out.open("w");
    out.encoding = "binary";
    if (Array.isArray(payload)) payload = a2s(payload);
    out.write(payload);
    out.close();
    return payload;
  } catch (e) {
    if (!e.message || !e.message.match(/onstruct/)) throw e;
  }
  throw new Error("cannot save file " + fname);
}
function keys(o) {
  var ks = Object.keys(o), o2 = [];
  for (var i = 0; i < ks.length; ++i) if (Object.prototype.hasOwnProperty.call(o, ks[i])) o2.push(ks[i]);
  return o2;
}
function evert_key(obj, key) {
  var o = [], K = keys(obj);
  for (var i = 0; i !== K.length; ++i) if (o[obj[K[i]][key]] == null) o[obj[K[i]][key]] = K[i];
  return o;
}
function evert(obj) {
  var o = [], K = keys(obj);
  for (var i = 0; i !== K.length; ++i) o[obj[K[i]]] = K[i];
  return o;
}
function evert_num(obj) {
  var o = [], K = keys(obj);
  for (var i = 0; i !== K.length; ++i) o[obj[K[i]]] = parseInt(K[i], 10);
  return o;
}
function evert_arr(obj) {
  var o = [], K = keys(obj);
  for (var i = 0; i !== K.length; ++i) {
    if (o[obj[K[i]]] == null) o[obj[K[i]]] = [];
    o[obj[K[i]]].push(K[i]);
  }
  return o;
}
var basedate = /* @__PURE__ */ new Date(1899, 11, 30, 0, 0, 0);
function datenum(v, date1904) {
  var epoch = /* @__PURE__ */ v.getTime();
  if (date1904) epoch -= 1462 * 24 * 60 * 60 * 1e3;
  var dnthresh2 = /* @__PURE__ */ basedate.getTime() + (/* @__PURE__ */ v.getTimezoneOffset() - /* @__PURE__ */ basedate.getTimezoneOffset()) * 6e4;
  return (epoch - dnthresh2) / (24 * 60 * 60 * 1e3);
}
var refdate = /* @__PURE__ */ new Date();
var dnthresh = /* @__PURE__ */ basedate.getTime() + (/* @__PURE__ */ refdate.getTimezoneOffset() - /* @__PURE__ */ basedate.getTimezoneOffset()) * 6e4;
var refoffset = /* @__PURE__ */ refdate.getTimezoneOffset();
function numdate(v) {
  var out = /* @__PURE__ */ new Date();
  out.setTime(v * 24 * 60 * 60 * 1e3 + dnthresh);
  if (out.getTimezoneOffset() !== refoffset) {
    out.setTime(out.getTime() + (out.getTimezoneOffset() - refoffset) * 6e4);
  }
  return out;
}
var good_pd_date_1 = /* @__PURE__ */ new Date("2017-02-19T19:06:09.000Z");
var good_pd_date = /* @__PURE__ */ isNaN(/* @__PURE__ */ good_pd_date_1.getFullYear()) ? /* @__PURE__ */ new Date("2/19/17") : good_pd_date_1;
var good_pd = /* @__PURE__ */ good_pd_date.getFullYear() == 2017;
function parseDate(str, fixdate) {
  var d = new Date(str);
  if (good_pd) {
    if (fixdate > 0) d.setTime(d.getTime() + d.getTimezoneOffset() * 60 * 1e3);
    else if (fixdate < 0) d.setTime(d.getTime() - d.getTimezoneOffset() * 60 * 1e3);
    return d;
  }
  if (str instanceof Date) return str;
  if (good_pd_date.getFullYear() == 1917 && !isNaN(d.getFullYear())) {
    var s = d.getFullYear();
    if (str.indexOf("" + s) > -1) return d;
    d.setFullYear(d.getFullYear() + 100);
    return d;
  }
  var n = str.match(/\d+/g) || ["2017", "2", "19", "0", "0", "0"];
  var out = new Date(+n[0], +n[1] - 1, +n[2], +n[3] || 0, +n[4] || 0, +n[5] || 0);
  if (str.indexOf("Z") > -1) out = new Date(out.getTime() - out.getTimezoneOffset() * 60 * 1e3);
  return out;
}
function cc2str(arr, debomit) {
  if (has_buf && Buffer.isBuffer(arr)) {
    if (debomit) {
      if (arr[0] == 255 && arr[1] == 254) return utf8write(arr.slice(2).toString("utf16le"));
      if (arr[1] == 254 && arr[2] == 255) return utf8write(utf16beread(arr.slice(2).toString("binary")));
    }
    return arr.toString("binary");
  }
  if (typeof TextDecoder !== "undefined") try {
    if (debomit) {
      if (arr[0] == 255 && arr[1] == 254) return utf8write(new TextDecoder("utf-16le").decode(arr.slice(2)));
      if (arr[0] == 254 && arr[1] == 255) return utf8write(new TextDecoder("utf-16be").decode(arr.slice(2)));
    }
    var rev = {
      "\u20AC": "\x80",
      "\u201A": "\x82",
      "\u0192": "\x83",
      "\u201E": "\x84",
      "\u2026": "\x85",
      "\u2020": "\x86",
      "\u2021": "\x87",
      "\u02C6": "\x88",
      "\u2030": "\x89",
      "\u0160": "\x8A",
      "\u2039": "\x8B",
      "\u0152": "\x8C",
      "\u017D": "\x8E",
      "\u2018": "\x91",
      "\u2019": "\x92",
      "\u201C": "\x93",
      "\u201D": "\x94",
      "\u2022": "\x95",
      "\u2013": "\x96",
      "\u2014": "\x97",
      "\u02DC": "\x98",
      "\u2122": "\x99",
      "\u0161": "\x9A",
      "\u203A": "\x9B",
      "\u0153": "\x9C",
      "\u017E": "\x9E",
      "\u0178": "\x9F"
    };
    if (Array.isArray(arr)) arr = new Uint8Array(arr);
    return new TextDecoder("latin1").decode(arr).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g, function(c) {
      return rev[c] || c;
    });
  } catch (e) {
  }
  var o = [];
  for (var i = 0; i != arr.length; ++i) o.push(String.fromCharCode(arr[i]));
  return o.join("");
}
function dup(o) {
  if (typeof JSON != "undefined" && !Array.isArray(o)) return JSON.parse(JSON.stringify(o));
  if (typeof o != "object" || o == null) return o;
  if (o instanceof Date) return new Date(o.getTime());
  var out = {};
  for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) out[k] = dup(o[k]);
  return out;
}
function fill(c, l) {
  var o = "";
  while (o.length < l) o += c;
  return o;
}
function fuzzynum(s) {
  var v = Number(s);
  if (!isNaN(v)) return isFinite(v) ? v : NaN;
  if (!/\d/.test(s)) return v;
  var wt = 1;
  var ss = s.replace(/([\d]),([\d])/g, "$1$2").replace(/[$]/g, "").replace(/[%]/g, function() {
    wt *= 100;
    return "";
  });
  if (!isNaN(v = Number(ss))) return v / wt;
  ss = ss.replace(/[(](.*)[)]/, function($$, $1) {
    wt = -wt;
    return $1;
  });
  if (!isNaN(v = Number(ss))) return v / wt;
  return v;
}
var lower_months = ["january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december"];
function fuzzydate(s) {
  var o = new Date(s), n = /* @__PURE__ */ new Date(NaN);
  var y = o.getYear(), m = o.getMonth(), d = o.getDate();
  if (isNaN(d)) return n;
  var lower = s.toLowerCase();
  if (lower.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)) {
    lower = lower.replace(/[^a-z]/g, "").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/, "");
    if (lower.length > 3 && lower_months.indexOf(lower) == -1) return n;
  } else if (lower.match(/[a-z]/)) return n;
  if (y < 0 || y > 8099) return n;
  if ((m > 0 || d > 1) && y != 101) return o;
  if (s.match(/[^-0-9:,\/\\]/)) return n;
  return o;
}
function zip_add_file(zip, path, content) {
  if (zip.FullPaths) {
    if (typeof content == "string") {
      var res;
      if (has_buf) res = Buffer_from(content);
      else res = utf8decode(content);
      return CFB.utils.cfb_add(zip, path, res);
    }
    CFB.utils.cfb_add(zip, path, content);
  } else zip.file(path, content);
}
function zip_new() {
  return CFB.utils.cfb_new();
}
var XML_HEADER = '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';
var encodings = {
  "&quot;": '"',
  "&apos;": "'",
  "&gt;": ">",
  "&lt;": "<",
  "&amp;": "&"
};
var rencoding = /* @__PURE__ */ evert(encodings);
var decregex = /[&<>'"]/g;
var charegex = /[\u0000-\u0008\u000b-\u001f]/g;
function escapexml(text) {
  var s = text + "";
  return s.replace(decregex, function(y) {
    return rencoding[y];
  }).replace(charegex, function(s2) {
    return "_x" + ("000" + s2.charCodeAt(0).toString(16)).slice(-4) + "_";
  });
}
function escapexmltag(text) {
  return escapexml(text).replace(/ /g, "_x0020_");
}
var htmlcharegex = /[\u0000-\u001f]/g;
function escapehtml(text) {
  var s = text + "";
  return s.replace(decregex, function(y) {
    return rencoding[y];
  }).replace(/\n/g, "<br/>").replace(htmlcharegex, function(s2) {
    return "&#x" + ("000" + s2.charCodeAt(0).toString(16)).slice(-4) + ";";
  });
}
function escapexlml(text) {
  var s = text + "";
  return s.replace(decregex, function(y) {
    return rencoding[y];
  }).replace(htmlcharegex, function(s2) {
    return "&#x" + s2.charCodeAt(0).toString(16).toUpperCase() + ";";
  });
}
function xlml_unfixstr(str) {
  return str.replace(/(\r\n|[\r\n])/g, "&#10;");
}
function parsexmlbool(value) {
  switch (value) {
    case 1:
    case true:
    case "1":
    case "true":
    case "TRUE":
      return true;
    /* case '0': case 'false': case 'FALSE':*/
    default:
      return false;
  }
}
function utf8reada(orig) {
  var out = "", i = 0, c = 0, d = 0, e = 0, f = 0, w = 0;
  while (i < orig.length) {
    c = orig.charCodeAt(i++);
    if (c < 128) {
      out += String.fromCharCode(c);
      continue;
    }
    d = orig.charCodeAt(i++);
    if (c > 191 && c < 224) {
      f = (c & 31) << 6;
      f |= d & 63;
      out += String.fromCharCode(f);
      continue;
    }
    e = orig.charCodeAt(i++);
    if (c < 240) {
      out += String.fromCharCode((c & 15) << 12 | (d & 63) << 6 | e & 63);
      continue;
    }
    f = orig.charCodeAt(i++);
    w = ((c & 7) << 18 | (d & 63) << 12 | (e & 63) << 6 | f & 63) - 65536;
    out += String.fromCharCode(55296 + (w >>> 10 & 1023));
    out += String.fromCharCode(56320 + (w & 1023));
  }
  return out;
}
function utf8readb(data) {
  var out = new_raw_buf(2 * data.length), w, i, j = 1, k = 0, ww = 0, c;
  for (i = 0; i < data.length; i += j) {
    j = 1;
    if ((c = data.charCodeAt(i)) < 128) w = c;
    else if (c < 224) {
      w = (c & 31) * 64 + (data.charCodeAt(i + 1) & 63);
      j = 2;
    } else if (c < 240) {
      w = (c & 15) * 4096 + (data.charCodeAt(i + 1) & 63) * 64 + (data.charCodeAt(i + 2) & 63);
      j = 3;
    } else {
      j = 4;
      w = (c & 7) * 262144 + (data.charCodeAt(i + 1) & 63) * 4096 + (data.charCodeAt(i + 2) & 63) * 64 + (data.charCodeAt(i + 3) & 63);
      w -= 65536;
      ww = 55296 + (w >>> 10 & 1023);
      w = 56320 + (w & 1023);
    }
    if (ww !== 0) {
      out[k++] = ww & 255;
      out[k++] = ww >>> 8;
      ww = 0;
    }
    out[k++] = w % 256;
    out[k++] = w >>> 8;
  }
  return out.slice(0, k).toString("ucs2");
}
function utf8readc(data) {
  return Buffer_from(data, "binary").toString("utf8");
}
var utf8corpus = "foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3";
var utf8read = has_buf && (/* @__PURE__ */ utf8readc(utf8corpus) == /* @__PURE__ */ utf8reada(utf8corpus) && utf8readc || /* @__PURE__ */ utf8readb(utf8corpus) == /* @__PURE__ */ utf8reada(utf8corpus) && utf8readb) || utf8reada;
var utf8write = has_buf ? function(data) {
  return Buffer_from(data, "utf8").toString("binary");
} : function(orig) {
  var out = [], i = 0, c = 0, d = 0;
  while (i < orig.length) {
    c = orig.charCodeAt(i++);
    switch (true) {
      case c < 128:
        out.push(String.fromCharCode(c));
        break;
      case c < 2048:
        out.push(String.fromCharCode(192 + (c >> 6)));
        out.push(String.fromCharCode(128 + (c & 63)));
        break;
      case (c >= 55296 && c < 57344):
        c -= 55296;
        d = orig.charCodeAt(i++) - 56320 + (c << 10);
        out.push(String.fromCharCode(240 + (d >> 18 & 7)));
        out.push(String.fromCharCode(144 + (d >> 12 & 63)));
        out.push(String.fromCharCode(128 + (d >> 6 & 63)));
        out.push(String.fromCharCode(128 + (d & 63)));
        break;
      default:
        out.push(String.fromCharCode(224 + (c >> 12)));
        out.push(String.fromCharCode(128 + (c >> 6 & 63)));
        out.push(String.fromCharCode(128 + (c & 63)));
    }
  }
  return out.join("");
};
var htmldecode = /* @__PURE__ */ function() {
  var entities = [["nbsp", " "], ["middot", "\xB7"], ["quot", '"'], ["apos", "'"], ["gt", ">"], ["lt", "<"], ["amp", "&"]].map(function(x) {
    return [new RegExp("&" + x[0] + ";", "ig"), x[1]];
  });
  return function htmldecode2(str) {
    var o = str.replace(/^[\t\n\r ]+/, "").replace(/[\t\n\r ]+$/, "").replace(/>\s+/g, ">").replace(/\s+</g, "<").replace(/[\t\n\r ]+/g, " ").replace(/<\s*[bB][rR]\s*\/?>/g, "\n").replace(/<[^>]*>/g, "");
    for (var i = 0; i < entities.length; ++i) o = o.replace(entities[i][0], entities[i][1]);
    return o;
  };
}();
var wtregex = /(^\s|\s$|\n)/;
function writetag(f, g) {
  return "<" + f + (g.match(wtregex) ? ' xml:space="preserve"' : "") + ">" + g + "</" + f + ">";
}
function wxt_helper(h) {
  return keys(h).map(function(k) {
    return " " + k + '="' + h[k] + '"';
  }).join("");
}
function writextag(f, g, h) {
  return "<" + f + (h != null ? wxt_helper(h) : "") + (g != null ? (g.match(wtregex) ? ' xml:space="preserve"' : "") + ">" + g + "</" + f : "/") + ">";
}
function write_w3cdtf(d, t) {
  try {
    return d.toISOString().replace(/\.\d*/, "");
  } catch (e) {
    if (t) throw e;
  }
  return "";
}
function write_vt(s, xlsx) {
  switch (typeof s) {
    case "string":
      var o = writextag("vt:lpwstr", escapexml(s));
      if (xlsx) o = o.replace(/&quot;/g, "_x0022_");
      return o;
    case "number":
      return writextag((s | 0) == s ? "vt:i4" : "vt:r8", escapexml(String(s)));
    case "boolean":
      return writextag("vt:bool", s ? "true" : "false");
  }
  if (s instanceof Date) return writextag("vt:filetime", write_w3cdtf(s));
  throw new Error("Unable to serialize " + s);
}
var XMLNS = {
  CORE_PROPS: "http://schemas.openxmlformats.org/package/2006/metadata/core-properties",
  CUST_PROPS: "http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",
  EXT_PROPS: "http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",
  CT: "http://schemas.openxmlformats.org/package/2006/content-types",
  RELS: "http://schemas.openxmlformats.org/package/2006/relationships",
  TCMNT: "http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",
  "dc": "http://purl.org/dc/elements/1.1/",
  "dcterms": "http://purl.org/dc/terms/",
  "dcmitype": "http://purl.org/dc/dcmitype/",
  "mx": "http://schemas.microsoft.com/office/mac/excel/2008/main",
  "r": "http://schemas.openxmlformats.org/officeDocument/2006/relationships",
  "sjs": "http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",
  "vt": "http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",
  "xsi": "http://www.w3.org/2001/XMLSchema-instance",
  "xsd": "http://www.w3.org/2001/XMLSchema"
};
var XMLNS_main = ["http://schemas.openxmlformats.org/spreadsheetml/2006/main", "http://purl.oclc.org/ooxml/spreadsheetml/main", "http://schemas.microsoft.com/office/excel/2006/main", "http://schemas.microsoft.com/office/excel/2006/2"];
var XLMLNS = {
  "o": "urn:schemas-microsoft-com:office:office",
  "x": "urn:schemas-microsoft-com:office:excel",
  "ss": "urn:schemas-microsoft-com:office:spreadsheet",
  "dt": "uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",
  "mv": "http://macVmlSchemaUri",
  "v": "urn:schemas-microsoft-com:vml",
  "html": "http://www.w3.org/TR/REC-html40"
};
function read_double_le(b, idx) {
  var s = 1 - 2 * (b[idx + 7] >>> 7);
  var e = ((b[idx + 7] & 127) << 4) + (b[idx + 6] >>> 4 & 15);
  var m = b[idx + 6] & 15;
  for (var i = 5; i >= 0; --i) m = m * 256 + b[idx + i];
  if (e == 2047) return m == 0 ? s * Infinity : NaN;
  if (e == 0) e = -1022;
  else {
    e -= 1023;
    m += Math.pow(2, 52);
  }
  return s * Math.pow(2, e - 52) * m;
}
function write_double_le(b, v, idx) {
  var bs = (v < 0 || 1 / v == -Infinity ? 1 : 0) << 7, e = 0, m = 0;
  var av = bs ? -v : v;
  if (!isFinite(av)) {
    e = 2047;
    m = isNaN(v) ? 26985 : 0;
  } else if (av == 0) e = m = 0;
  else {
    e = Math.floor(Math.log(av) / Math.LN2);
    m = av * Math.pow(2, 52 - e);
    if (e <= -1023 && (!isFinite(m) || m < Math.pow(2, 52))) {
      e = -1022;
    } else {
      m -= Math.pow(2, 52);
      e += 1023;
    }
  }
  for (var i = 0; i <= 5; ++i, m /= 256) b[idx + i] = m & 255;
  b[idx + 6] = (e & 15) << 4 | m & 15;
  b[idx + 7] = e >> 4 | bs;
}
var ___toBuffer = function(bufs) {
  var x = [], w = 10240;
  for (var i = 0; i < bufs[0].length; ++i) if (bufs[0][i]) for (var j = 0, L = bufs[0][i].length; j < L; j += w) x.push.apply(x, bufs[0][i].slice(j, j + w));
  return x;
};
var __toBuffer = has_buf ? function(bufs) {
  return bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0]) ? Buffer.concat(bufs[0].map(function(x) {
    return Buffer.isBuffer(x) ? x : Buffer_from(x);
  })) : ___toBuffer(bufs);
} : ___toBuffer;
var ___utf16le = function(b, s, e) {
  var ss = [];
  for (var i = s; i < e; i += 2) ss.push(String.fromCharCode(__readUInt16LE(b, i)));
  return ss.join("").replace(chr0, "");
};
var __utf16le = has_buf ? function(b, s, e) {
  if (!Buffer.isBuffer(b)) return ___utf16le(b, s, e);
  return b.toString("utf16le", s, e).replace(chr0, "");
} : ___utf16le;
var ___hexlify = function(b, s, l) {
  var ss = [];
  for (var i = s; i < s + l; ++i) ss.push(("0" + b[i].toString(16)).slice(-2));
  return ss.join("");
};
var __hexlify = has_buf ? function(b, s, l) {
  return Buffer.isBuffer(b) ? b.toString("hex", s, s + l) : ___hexlify(b, s, l);
} : ___hexlify;
var ___utf8 = function(b, s, e) {
  var ss = [];
  for (var i = s; i < e; i++) ss.push(String.fromCharCode(__readUInt8(b, i)));
  return ss.join("");
};
var __utf8 = has_buf ? function utf8_b(b, s, e) {
  return Buffer.isBuffer(b) ? b.toString("utf8", s, e) : ___utf8(b, s, e);
} : ___utf8;
var ___lpstr = function(b, i) {
  var len = __readUInt32LE(b, i);
  return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : "";
};
var __lpstr = ___lpstr;
var ___cpstr = function(b, i) {
  var len = __readUInt32LE(b, i);
  return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : "";
};
var __cpstr = ___cpstr;
var ___lpwstr = function(b, i) {
  var len = 2 * __readUInt32LE(b, i);
  return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : "";
};
var __lpwstr = ___lpwstr;
var ___lpp4 = function lpp4_(b, i) {
  var len = __readUInt32LE(b, i);
  return len > 0 ? __utf16le(b, i + 4, i + 4 + len) : "";
};
var __lpp4 = ___lpp4;
var ___8lpp4 = function(b, i) {
  var len = __readUInt32LE(b, i);
  return len > 0 ? __utf8(b, i + 4, i + 4 + len) : "";
};
var __8lpp4 = ___8lpp4;
var ___double = function(b, idx) {
  return read_double_le(b, idx);
};
var __double = ___double;
var is_buf = function is_buf_a(a) {
  return Array.isArray(a) || typeof Uint8Array !== "undefined" && a instanceof Uint8Array;
};
if (has_buf) {
  __lpstr = function lpstr_b(b, i) {
    if (!Buffer.isBuffer(b)) return ___lpstr(b, i);
    var len = b.readUInt32LE(i);
    return len > 0 ? b.toString("utf8", i + 4, i + 4 + len - 1) : "";
  };
  __cpstr = function cpstr_b(b, i) {
    if (!Buffer.isBuffer(b)) return ___cpstr(b, i);
    var len = b.readUInt32LE(i);
    return len > 0 ? b.toString("utf8", i + 4, i + 4 + len - 1) : "";
  };
  __lpwstr = function lpwstr_b(b, i) {
    if (!Buffer.isBuffer(b)) return ___lpwstr(b, i);
    var len = 2 * b.readUInt32LE(i);
    return b.toString("utf16le", i + 4, i + 4 + len - 1);
  };
  __lpp4 = function lpp4_b(b, i) {
    if (!Buffer.isBuffer(b)) return ___lpp4(b, i);
    var len = b.readUInt32LE(i);
    return b.toString("utf16le", i + 4, i + 4 + len);
  };
  __8lpp4 = function lpp4_8b(b, i) {
    if (!Buffer.isBuffer(b)) return ___8lpp4(b, i);
    var len = b.readUInt32LE(i);
    return b.toString("utf8", i + 4, i + 4 + len);
  };
  __double = function double_(b, i) {
    if (Buffer.isBuffer(b)) return b.readDoubleLE(i);
    return ___double(b, i);
  };
  is_buf = function is_buf_b(a) {
    return Buffer.isBuffer(a) || Array.isArray(a) || typeof Uint8Array !== "undefined" && a instanceof Uint8Array;
  };
}
function cpdoit() {
  __utf16le = function(b, s, e) {
    return $cptable.utils.decode(1200, b.slice(s, e)).replace(chr0, "");
  };
  __utf8 = function(b, s, e) {
    return $cptable.utils.decode(65001, b.slice(s, e));
  };
  __lpstr = function(b, i) {
    var len = __readUInt32LE(b, i);
    return len > 0 ? $cptable.utils.decode(current_ansi, b.slice(i + 4, i + 4 + len - 1)) : "";
  };
  __cpstr = function(b, i) {
    var len = __readUInt32LE(b, i);
    return len > 0 ? $cptable.utils.decode(current_codepage, b.slice(i + 4, i + 4 + len - 1)) : "";
  };
  __lpwstr = function(b, i) {
    var len = 2 * __readUInt32LE(b, i);
    return len > 0 ? $cptable.utils.decode(1200, b.slice(i + 4, i + 4 + len - 1)) : "";
  };
  __lpp4 = function(b, i) {
    var len = __readUInt32LE(b, i);
    return len > 0 ? $cptable.utils.decode(1200, b.slice(i + 4, i + 4 + len)) : "";
  };
  __8lpp4 = function(b, i) {
    var len = __readUInt32LE(b, i);
    return len > 0 ? $cptable.utils.decode(65001, b.slice(i + 4, i + 4 + len)) : "";
  };
}
if (typeof $cptable !== "undefined") cpdoit();
var __readUInt8 = function(b, idx) {
  return b[idx];
};
var __readUInt16LE = function(b, idx) {
  return b[idx + 1] * (1 << 8) + b[idx];
};
var __readInt16LE = function(b, idx) {
  var u2 = b[idx + 1] * (1 << 8) + b[idx];
  return u2 < 32768 ? u2 : (65535 - u2 + 1) * -1;
};
var __readUInt32LE = function(b, idx) {
  return b[idx + 3] * (1 << 24) + (b[idx + 2] << 16) + (b[idx + 1] << 8) + b[idx];
};
var __readInt32LE = function(b, idx) {
  return b[idx + 3] << 24 | b[idx + 2] << 16 | b[idx + 1] << 8 | b[idx];
};
var __readInt32BE = function(b, idx) {
  return b[idx] << 24 | b[idx + 1] << 16 | b[idx + 2] << 8 | b[idx + 3];
};
function ReadShift(size, t) {
  var o = "", oI, oR, oo = [], w, vv, i, loc;
  switch (t) {
    case "dbcs":
      loc = this.l;
      if (has_buf && Buffer.isBuffer(this)) o = this.slice(this.l, this.l + 2 * size).toString("utf16le");
      else for (i = 0; i < size; ++i) {
        o += String.fromCharCode(__readUInt16LE(this, loc));
        loc += 2;
      }
      size *= 2;
      break;
    case "utf8":
      o = __utf8(this, this.l, this.l + size);
      break;
    case "utf16le":
      size *= 2;
      o = __utf16le(this, this.l, this.l + size);
      break;
    case "wstr":
      if (typeof $cptable !== "undefined") o = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l + 2 * size));
      else return ReadShift.call(this, size, "dbcs");
      size = 2 * size;
      break;
    /* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */
    case "lpstr-ansi":
      o = __lpstr(this, this.l);
      size = 4 + __readUInt32LE(this, this.l);
      break;
    case "lpstr-cp":
      o = __cpstr(this, this.l);
      size = 4 + __readUInt32LE(this, this.l);
      break;
    /* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */
    case "lpwstr":
      o = __lpwstr(this, this.l);
      size = 4 + 2 * __readUInt32LE(this, this.l);
      break;
    /* [MS-OFFCRYPTO] 2.1.2 Length-Prefixed Padded Unicode String (UNICODE-LP-P4) */
    case "lpp4":
      size = 4 + __readUInt32LE(this, this.l);
      o = __lpp4(this, this.l);
      if (size & 2) size += 2;
      break;
    /* [MS-OFFCRYPTO] 2.1.3 Length-Prefixed UTF-8 String (UTF-8-LP-P4) */
    case "8lpp4":
      size = 4 + __readUInt32LE(this, this.l);
      o = __8lpp4(this, this.l);
      if (size & 3) size += 4 - (size & 3);
      break;
    case "cstr":
      size = 0;
      o = "";
      while ((w = __readUInt8(this, this.l + size++)) !== 0) oo.push(_getchar(w));
      o = oo.join("");
      break;
    case "_wstr":
      size = 0;
      o = "";
      while ((w = __readUInt16LE(this, this.l + size)) !== 0) {
        oo.push(_getchar(w));
        size += 2;
      }
      size += 2;
      o = oo.join("");
      break;
    /* sbcs and dbcs support continue records in the SST way TODO codepages */
    case "dbcs-cont":
      o = "";
      loc = this.l;
      for (i = 0; i < size; ++i) {
        if (this.lens && this.lens.indexOf(loc) !== -1) {
          w = __readUInt8(this, loc);
          this.l = loc + 1;
          vv = ReadShift.call(this, size - i, w ? "dbcs-cont" : "sbcs-cont");
          return oo.join("") + vv;
        }
        oo.push(_getchar(__readUInt16LE(this, loc)));
        loc += 2;
      }
      o = oo.join("");
      size *= 2;
      break;
    case "cpstr":
      if (typeof $cptable !== "undefined") {
        o = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l + size));
        break;
      }
    /* falls through */
    case "sbcs-cont":
      o = "";
      loc = this.l;
      for (i = 0; i != size; ++i) {
        if (this.lens && this.lens.indexOf(loc) !== -1) {
          w = __readUInt8(this, loc);
          this.l = loc + 1;
          vv = ReadShift.call(this, size - i, w ? "dbcs-cont" : "sbcs-cont");
          return oo.join("") + vv;
        }
        oo.push(_getchar(__readUInt8(this, loc)));
        loc += 1;
      }
      o = oo.join("");
      break;
    default:
      switch (size) {
        case 1:
          oI = __readUInt8(this, this.l);
          this.l++;
          return oI;
        case 2:
          oI = (t === "i" ? __readInt16LE : __readUInt16LE)(this, this.l);
          this.l += 2;
          return oI;
        case 4:
        case -4:
          if (t === "i" || (this[this.l + 3] & 128) === 0) {
            oI = (size > 0 ? __readInt32LE : __readInt32BE)(this, this.l);
            this.l += 4;
            return oI;
          } else {
            oR = __readUInt32LE(this, this.l);
            this.l += 4;
          }
          return oR;
        case 8:
        case -8:
          if (t === "f") {
            if (size == 8) oR = __double(this, this.l);
            else oR = __double([this[this.l + 7], this[this.l + 6], this[this.l + 5], this[this.l + 4], this[this.l + 3], this[this.l + 2], this[this.l + 1], this[this.l + 0]], 0);
            this.l += 8;
            return oR;
          } else size = 8;
        /* falls through */
        case 16:
          o = __hexlify(this, this.l, size);
          break;
      }
  }
  this.l += size;
  return o;
}
var __writeUInt32LE = function(b, val, idx) {
  b[idx] = val & 255;
  b[idx + 1] = val >>> 8 & 255;
  b[idx + 2] = val >>> 16 & 255;
  b[idx + 3] = val >>> 24 & 255;
};
var __writeInt32LE = function(b, val, idx) {
  b[idx] = val & 255;
  b[idx + 1] = val >> 8 & 255;
  b[idx + 2] = val >> 16 & 255;
  b[idx + 3] = val >> 24 & 255;
};
var __writeUInt16LE = function(b, val, idx) {
  b[idx] = val & 255;
  b[idx + 1] = val >>> 8 & 255;
};
function WriteShift(t, val, f) {
  var size = 0, i = 0;
  if (f === "dbcs") {
    for (i = 0; i != val.length; ++i) __writeUInt16LE(this, val.charCodeAt(i), this.l + 2 * i);
    size = 2 * val.length;
  } else if (f === "sbcs") {
    if (typeof $cptable !== "undefined" && current_ansi == 874) {
      for (i = 0; i != val.length; ++i) {
        var cppayload = $cptable.utils.encode(current_ansi, val.charAt(i));
        this[this.l + i] = cppayload[0];
      }
    } else {
      val = val.replace(/[^\x00-\x7F]/g, "_");
      for (i = 0; i != val.length; ++i) this[this.l + i] = val.charCodeAt(i) & 255;
    }
    size = val.length;
  } else if (f === "hex") {
    for (; i < t; ++i) {
      this[this.l++] = parseInt(val.slice(2 * i, 2 * i + 2), 16) || 0;
    }
    return this;
  } else if (f === "utf16le") {
    var end = Math.min(this.l + t, this.length);
    for (i = 0; i < Math.min(val.length, t); ++i) {
      var cc = val.charCodeAt(i);
      this[this.l++] = cc & 255;
      this[this.l++] = cc >> 8;
    }
    while (this.l < end) this[this.l++] = 0;
    return this;
  } else switch (t) {
    case 1:
      size = 1;
      this[this.l] = val & 255;
      break;
    case 2:
      size = 2;
      this[this.l] = val & 255;
      val >>>= 8;
      this[this.l + 1] = val & 255;
      break;
    case 3:
      size = 3;
      this[this.l] = val & 255;
      val >>>= 8;
      this[this.l + 1] = val & 255;
      val >>>= 8;
      this[this.l + 2] = val & 255;
      break;
    case 4:
      size = 4;
      __writeUInt32LE(this, val, this.l);
      break;
    case 8:
      size = 8;
      if (f === "f") {
        write_double_le(this, val, this.l);
        break;
      }
    /* falls through */
    case 16:
      break;
    case -4:
      size = 4;
      __writeInt32LE(this, val, this.l);
      break;
  }
  this.l += size;
  return this;
}
function CheckField(hexstr, fld) {
  var m = __hexlify(this, this.l, hexstr.length >> 1);
  if (m !== hexstr) throw new Error(fld + "Expected " + hexstr + " saw " + m);
  this.l += hexstr.length >> 1;
}
function prep_blob(blob, pos) {
  blob.l = pos;
  blob.read_shift = /*::(*/
  ReadShift;
  blob.chk = CheckField;
  blob.write_shift = WriteShift;
}
function parsenoop(blob, length) {
  blob.l += length;
}
function new_buf(sz) {
  var o = new_raw_buf(sz);
  prep_blob(o, 0);
  return o;
}
function buf_array() {
  var bufs = [], blksz = has_buf ? 256 : 2048;
  var newblk = function ba_newblk(sz) {
    var o = new_buf(sz);
    prep_blob(o, 0);
    return o;
  };
  var curbuf = newblk(blksz);
  var endbuf = function ba_endbuf() {
    if (!curbuf) return;
    if (curbuf.length > curbuf.l) {
      curbuf = curbuf.slice(0, curbuf.l);
      curbuf.l = curbuf.length;
    }
    if (curbuf.length > 0) bufs.push(curbuf);
    curbuf = null;
  };
  var next = function ba_next(sz) {
    if (curbuf && sz < curbuf.length - curbuf.l) return curbuf;
    endbuf();
    return curbuf = newblk(Math.max(sz + 1, blksz));
  };
  var end = function ba_end() {
    endbuf();
    return bconcat(bufs);
  };
  var push = function ba_push(buf) {
    endbuf();
    curbuf = buf;
    if (curbuf.l == null) curbuf.l = curbuf.length;
    next(blksz);
  };
  return {
    next,
    push,
    end,
    _bufs: bufs
  };
}
function write_record(ba, type, payload, length) {
  var t = +type, l;
  if (isNaN(t)) return;
  if (!length) length = XLSBRecordEnum[t].p || (payload || []).length || 0;
  l = 1 + (t >= 128 ? 1 : 0) + 1;
  if (length >= 128) ++l;
  if (length >= 16384) ++l;
  if (length >= 2097152) ++l;
  var o = ba.next(l);
  if (t <= 127) o.write_shift(1, t);
  else {
    o.write_shift(1, (t & 127) + 128);
    o.write_shift(1, t >> 7);
  }
  for (var i = 0; i != 4; ++i) {
    if (length >= 128) {
      o.write_shift(1, (length & 127) + 128);
      length >>= 7;
    } else {
      o.write_shift(1, length);
      break;
    }
  }
  if (
    /*:: length != null &&*/
    length > 0 && is_buf(payload)
  ) ba.push(payload);
}
function shift_cell_xls(cell, tgt, opts) {
  var out = dup(cell);
  if (tgt.s) {
    if (out.cRel) out.c += tgt.s.c;
    if (out.rRel) out.r += tgt.s.r;
  } else {
    if (out.cRel) out.c += tgt.c;
    if (out.rRel) out.r += tgt.r;
  }
  if (!opts || opts.biff < 12) {
    while (out.c >= 256) out.c -= 256;
    while (out.r >= 65536) out.r -= 65536;
  }
  return out;
}
function shift_range_xls(cell, range, opts) {
  var out = dup(cell);
  out.s = shift_cell_xls(out.s, range.s, opts);
  out.e = shift_cell_xls(out.e, range.s, opts);
  return out;
}
function encode_cell_xls(c, biff) {
  if (c.cRel && c.c < 0) {
    c = dup(c);
    while (c.c < 0) c.c += biff > 8 ? 16384 : 256;
  }
  if (c.rRel && c.r < 0) {
    c = dup(c);
    while (c.r < 0) c.r += biff > 8 ? 1048576 : biff > 5 ? 65536 : 16384;
  }
  var s = encode_cell(c);
  if (!c.cRel && c.cRel != null) s = fix_col(s);
  if (!c.rRel && c.rRel != null) s = fix_row(s);
  return s;
}
function encode_range_xls(r, opts) {
  if (r.s.r == 0 && !r.s.rRel) {
    if (r.e.r == (opts.biff >= 12 ? 1048575 : opts.biff >= 8 ? 65536 : 16384) && !r.e.rRel) {
      return (r.s.cRel ? "" : "$") + encode_col(r.s.c) + ":" + (r.e.cRel ? "" : "$") + encode_col(r.e.c);
    }
  }
  if (r.s.c == 0 && !r.s.cRel) {
    if (r.e.c == (opts.biff >= 12 ? 16383 : 255) && !r.e.cRel) {
      return (r.s.rRel ? "" : "$") + encode_row(r.s.r) + ":" + (r.e.rRel ? "" : "$") + encode_row(r.e.r);
    }
  }
  return encode_cell_xls(r.s, opts.biff) + ":" + encode_cell_xls(r.e, opts.biff);
}
function decode_row(rowstr) {
  return parseInt(unfix_row(rowstr), 10) - 1;
}
function encode_row(row) {
  return "" + (row + 1);
}
function fix_row(cstr) {
  return cstr.replace(/([A-Z]|^)(\d+)$/, "$1$$$2");
}
function unfix_row(cstr) {
  return cstr.replace(/\$(\d+)$/, "$1");
}
function decode_col(colstr) {
  var c = unfix_col(colstr), d = 0, i = 0;
  for (; i !== c.length; ++i) d = 26 * d + c.charCodeAt(i) - 64;
  return d - 1;
}
function encode_col(col) {
  if (col < 0) throw new Error("invalid column " + col);
  var s = "";
  for (++col; col; col = Math.floor((col - 1) / 26)) s = String.fromCharCode((col - 1) % 26 + 65) + s;
  return s;
}
function fix_col(cstr) {
  return cstr.replace(/^([A-Z])/, "$$$1");
}
function unfix_col(cstr) {
  return cstr.replace(/^\$([A-Z])/, "$1");
}
function split_cell(cstr) {
  return cstr.replace(/(\$?[A-Z]*)(\$?\d*)/, "$1,$2").split(",");
}
function decode_cell(cstr) {
  var R = 0, C = 0;
  for (var i = 0; i < cstr.length; ++i) {
    var cc = cstr.charCodeAt(i);
    if (cc >= 48 && cc <= 57) R = 10 * R + (cc - 48);
    else if (cc >= 65 && cc <= 90) C = 26 * C + (cc - 64);
  }
  return {
    c: C - 1,
    r: R - 1
  };
}
function encode_cell(cell) {
  var col = cell.c + 1;
  var s = "";
  for (; col; col = (col - 1) / 26 | 0) s = String.fromCharCode((col - 1) % 26 + 65) + s;
  return s + (cell.r + 1);
}
function decode_range(range) {
  var idx = range.indexOf(":");
  if (idx == -1) return {
    s: decode_cell(range),
    e: decode_cell(range)
  };
  return {
    s: decode_cell(range.slice(0, idx)),
    e: decode_cell(range.slice(idx + 1))
  };
}
function encode_range(cs, ce) {
  if (typeof ce === "undefined" || typeof ce === "number") {
    return encode_range(cs.s, cs.e);
  }
  if (typeof cs !== "string") cs = encode_cell(
    cs
    /*:any*/
  );
  if (typeof ce !== "string") ce = encode_cell(
    ce
    /*:any*/
  );
  return cs == ce ? cs : cs + ":" + ce;
}
function safe_decode_range(range) {
  var o = {
    s: {
      c: 0,
      r: 0
    },
    e: {
      c: 0,
      r: 0
    }
  };
  var idx = 0, i = 0, cc = 0;
  var len = range.length;
  for (idx = 0; i < len; ++i) {
    if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;
    idx = 26 * idx + cc;
  }
  o.s.c = --idx;
  for (idx = 0; i < len; ++i) {
    if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;
    idx = 10 * idx + cc;
  }
  o.s.r = --idx;
  if (i === len || cc != 10) {
    o.e.c = o.s.c;
    o.e.r = o.s.r;
    return o;
  }
  ++i;
  for (idx = 0; i != len; ++i) {
    if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;
    idx = 26 * idx + cc;
  }
  o.e.c = --idx;
  for (idx = 0; i != len; ++i) {
    if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;
    idx = 10 * idx + cc;
  }
  o.e.r = --idx;
  return o;
}
function safe_format_cell(cell, v) {
  var q = cell.t == "d" && v instanceof Date;
  if (cell.z != null) try {
    return cell.w = SSF_format(cell.z, q ? datenum(v) : v);
  } catch (e) {
  }
  try {
    return cell.w = SSF_format((cell.XF || {}).numFmtId || (q ? 14 : 0), q ? datenum(v) : v);
  } catch (e) {
    return "" + v;
  }
}
function format_cell(cell, v, o) {
  if (cell == null || cell.t == null || cell.t == "z") return "";
  if (cell.w !== void 0) return cell.w;
  if (cell.t == "d" && !cell.z && o && o.dateNF) cell.z = o.dateNF;
  if (cell.t == "e") return BErr[cell.v] || cell.v;
  if (v == void 0) return safe_format_cell(cell, cell.v);
  return safe_format_cell(cell, v);
}
function sheet_to_workbook(sheet, opts) {
  var n = opts && opts.sheet ? opts.sheet : "Sheet1";
  var sheets = {};
  sheets[n] = sheet;
  return {
    SheetNames: [n],
    Sheets: sheets
  };
}
function sheet_add_aoa(_ws, data, opts) {
  var o = opts || {};
  var dense = _ws ? Array.isArray(_ws) : o.dense;
  if (DENSE != null && dense == null) dense = DENSE;
  var ws = _ws || (dense ? [] : {});
  var _R = 0, _C = 0;
  if (ws && o.origin != null) {
    if (typeof o.origin == "number") _R = o.origin;
    else {
      var _origin = typeof o.origin == "string" ? decode_cell(o.origin) : o.origin;
      _R = _origin.r;
      _C = _origin.c;
    }
    if (!ws["!ref"]) ws["!ref"] = "A1:A1";
  }
  var range = {
    s: {
      c: 1e7,
      r: 1e7
    },
    e: {
      c: 0,
      r: 0
    }
  };
  if (ws["!ref"]) {
    var _range = safe_decode_range(ws["!ref"]);
    range.s.c = _range.s.c;
    range.s.r = _range.s.r;
    range.e.c = Math.max(range.e.c, _range.e.c);
    range.e.r = Math.max(range.e.r, _range.e.r);
    if (_R == -1) range.e.r = _R = _range.e.r + 1;
  }
  for (var R = 0; R != data.length; ++R) {
    if (!data[R]) continue;
    if (!Array.isArray(data[R])) throw new Error("aoa_to_sheet expects an array of arrays");
    for (var C = 0; C != data[R].length; ++C) {
      if (typeof data[R][C] === "undefined") continue;
      var cell = {
        v: data[R][C]
      };
      var __R = _R + R, __C = _C + C;
      if (range.s.r > __R) range.s.r = __R;
      if (range.s.c > __C) range.s.c = __C;
      if (range.e.r < __R) range.e.r = __R;
      if (range.e.c < __C) range.e.c = __C;
      if (data[R][C] && typeof data[R][C] === "object" && !Array.isArray(data[R][C]) && !(data[R][C] instanceof Date)) cell = data[R][C];
      else {
        if (Array.isArray(cell.v)) {
          cell.f = data[R][C][1];
          cell.v = cell.v[0];
        }
        if (cell.v === null) {
          if (cell.f) cell.t = "n";
          else if (o.nullError) {
            cell.t = "e";
            cell.v = 0;
          } else if (!o.sheetStubs) continue;
          else cell.t = "z";
        } else if (typeof cell.v === "number") cell.t = "n";
        else if (typeof cell.v === "boolean") cell.t = "b";
        else if (cell.v instanceof Date) {
          cell.z = o.dateNF || table_fmt[14];
          if (o.cellDates) {
            cell.t = "d";
            cell.w = SSF_format(cell.z, datenum(cell.v));
          } else {
            cell.t = "n";
            cell.v = datenum(cell.v);
            cell.w = SSF_format(cell.z, cell.v);
          }
        } else cell.t = "s";
      }
      if (dense) {
        if (!ws[__R]) ws[__R] = [];
        if (ws[__R][__C] && ws[__R][__C].z) cell.z = ws[__R][__C].z;
        ws[__R][__C] = cell;
      } else {
        var cell_ref = encode_cell(
          {
            c: __C,
            r: __R
          }
          /*:any*/
        );
        if (ws[cell_ref] && ws[cell_ref].z) cell.z = ws[cell_ref].z;
        ws[cell_ref] = cell;
      }
    }
  }
  if (range.s.c < 1e7) ws["!ref"] = encode_range(range);
  return ws;
}
function aoa_to_sheet(data, opts) {
  return sheet_add_aoa(null, data, opts);
}
function parse_Int32LE(data) {
  return data.read_shift(4, "i");
}
function write_UInt32LE(x, o) {
  if (!o) o = new_buf(4);
  o.write_shift(4, x);
  return o;
}
function parse_XLWideString(data) {
  var cchCharacters = data.read_shift(4);
  return cchCharacters === 0 ? "" : data.read_shift(cchCharacters, "dbcs");
}
function write_XLWideString(data, o) {
  var _null = false;
  if (o == null) {
    _null = true;
    o = new_buf(4 + 2 * data.length);
  }
  o.write_shift(4, data.length);
  if (data.length > 0) o.write_shift(0, data, "dbcs");
  return _null ? o.slice(0, o.l) : o;
}
function parse_StrRun(data) {
  return {
    ich: data.read_shift(2),
    ifnt: data.read_shift(2)
  };
}
function write_StrRun(run, o) {
  if (!o) o = new_buf(4);
  o.write_shift(2, run.ich || 0);
  o.write_shift(2, run.ifnt || 0);
  return o;
}
function parse_RichStr(data, length) {
  var start = data.l;
  var flags = data.read_shift(1);
  var str = parse_XLWideString(data);
  var rgsStrRun = [];
  var z = {
    t: str,
    h: str
  };
  if ((flags & 1) !== 0) {
    var dwSizeStrRun = data.read_shift(4);
    for (var i = 0; i != dwSizeStrRun; ++i) rgsStrRun.push(parse_StrRun(data));
    z.r = rgsStrRun;
  } else z.r = [{
    ich: 0,
    ifnt: 0
  }];
  data.l = start + length;
  return z;
}
function write_RichStr(str, o) {
  var _null = false;
  if (o == null) {
    _null = true;
    o = new_buf(15 + 4 * str.t.length);
  }
  o.write_shift(1, 0);
  write_XLWideString(str.t, o);
  return _null ? o.slice(0, o.l) : o;
}
var parse_BrtCommentText = parse_RichStr;
function write_BrtCommentText(str, o) {
  var _null = false;
  if (o == null) {
    _null = true;
    o = new_buf(23 + 4 * str.t.length);
  }
  o.write_shift(1, 1);
  write_XLWideString(str.t, o);
  o.write_shift(4, 1);
  write_StrRun({
    ich: 0,
    ifnt: 0
  }, o);
  return _null ? o.slice(0, o.l) : o;
}
function parse_XLSBCell(data) {
  var col = data.read_shift(4);
  var iStyleRef = data.read_shift(2);
  iStyleRef += data.read_shift(1) << 16;
  data.l++;
  return {
    c: col,
    iStyleRef
  };
}
function write_XLSBCell(cell, o) {
  if (o == null) o = new_buf(8);
  o.write_shift(-4, cell.c);
  o.write_shift(3, cell.iStyleRef || cell.s);
  o.write_shift(1, 0);
  return o;
}
function parse_XLSBShortCell(data) {
  var iStyleRef = data.read_shift(2);
  iStyleRef += data.read_shift(1) << 16;
  data.l++;
  return {
    c: -1,
    iStyleRef
  };
}
function write_XLSBShortCell(cell, o) {
  if (o == null) o = new_buf(4);
  o.write_shift(3, cell.iStyleRef || cell.s);
  o.write_shift(1, 0);
  return o;
}
var parse_XLSBCodeName = parse_XLWideString;
var write_XLSBCodeName = write_XLWideString;
function parse_XLNullableWideString(data) {
  var cchCharacters = data.read_shift(4);
  return cchCharacters === 0 || cchCharacters === 4294967295 ? "" : data.read_shift(cchCharacters, "dbcs");
}
function write_XLNullableWideString(data, o) {
  var _null = false;
  if (o == null) {
    _null = true;
    o = new_buf(127);
  }
  o.write_shift(4, data.length > 0 ? data.length : 4294967295);
  if (data.length > 0) o.write_shift(0, data, "dbcs");
  return _null ? o.slice(0, o.l) : o;
}
var parse_XLNameWideString = parse_XLWideString;
var parse_RelID = parse_XLNullableWideString;
var write_RelID = write_XLNullableWideString;
function parse_RkNumber(data) {
  var b = data.slice(data.l, data.l + 4);
  var fX100 = b[0] & 1, fInt = b[0] & 2;
  data.l += 4;
  var RK = fInt === 0 ? __double([0, 0, 0, 0, b[0] & 252, b[1], b[2], b[3]], 0) : __readInt32LE(b, 0) >> 2;
  return fX100 ? RK / 100 : RK;
}
function write_RkNumber(data, o) {
  if (o == null) o = new_buf(4);
  var fX100 = 0, fInt = 0, d100 = data * 100;
  if (data == (data | 0) && data >= -(1 << 29) && data < 1 << 29) {
    fInt = 1;
  } else if (d100 == (d100 | 0) && d100 >= -(1 << 29) && d100 < 1 << 29) {
    fInt = 1;
    fX100 = 1;
  }
  if (fInt) o.write_shift(-4, ((fX100 ? d100 : data) << 2) + (fX100 + 2));
  else throw new Error("unsupported RkNumber " + data);
}
function parse_RfX(data) {
  var cell = {
    s: {},
    e: {}
  };
  cell.s.r = data.read_shift(4);
  cell.e.r = data.read_shift(4);
  cell.s.c = data.read_shift(4);
  cell.e.c = data.read_shift(4);
  return cell;
}
function write_RfX(r, o) {
  if (!o) o = new_buf(16);
  o.write_shift(4, r.s.r);
  o.write_shift(4, r.e.r);
  o.write_shift(4, r.s.c);
  o.write_shift(4, r.e.c);
  return o;
}
var parse_UncheckedRfX = parse_RfX;
var write_UncheckedRfX = write_RfX;
function parse_Xnum(data) {
  if (data.length - data.l < 8) throw "XLS Xnum Buffer underflow";
  return data.read_shift(8, "f");
}
function write_Xnum(data, o) {
  return (o || new_buf(8)).write_shift(8, data, "f");
}
function parse_BrtColor(data) {
  var out = {};
  var d = data.read_shift(1);
  var xColorType = d >>> 1;
  var index = data.read_shift(1);
  var nTS = data.read_shift(2, "i");
  var bR = data.read_shift(1);
  var bG = data.read_shift(1);
  var bB = data.read_shift(1);
  data.l++;
  switch (xColorType) {
    case 0:
      out.auto = 1;
      break;
    case 1:
      out.index = index;
      var icv = XLSIcv[index];
      if (icv) out.rgb = rgb2Hex(icv);
      break;
    case 2:
      out.rgb = rgb2Hex([bR, bG, bB]);
      break;
    case 3:
      out.theme = index;
      break;
  }
  if (nTS != 0) out.tint = nTS > 0 ? nTS / 32767 : nTS / 32768;
  return out;
}
function write_BrtColor(color, o) {
  if (!o) o = new_buf(8);
  if (!color || color.auto) {
    o.write_shift(4, 0);
    o.write_shift(4, 0);
    return o;
  }
  if (color.index != null) {
    o.write_shift(1, 2);
    o.write_shift(1, color.index);
  } else if (color.theme != null) {
    o.write_shift(1, 6);
    o.write_shift(1, color.theme);
  } else {
    o.write_shift(1, 5);
    o.write_shift(1, 0);
  }
  var nTS = color.tint || 0;
  if (nTS > 0) nTS *= 32767;
  else if (nTS < 0) nTS *= 32768;
  o.write_shift(2, nTS);
  if (!color.rgb || color.theme != null) {
    o.write_shift(2, 0);
    o.write_shift(1, 0);
    o.write_shift(1, 0);
  } else {
    var rgb = color.rgb || "FFFFFF";
    if (typeof rgb == "number") rgb = ("000000" + rgb.toString(16)).slice(-6);
    o.write_shift(1, parseInt(rgb.slice(0, 2), 16));
    o.write_shift(1, parseInt(rgb.slice(2, 4), 16));
    o.write_shift(1, parseInt(rgb.slice(4, 6), 16));
    o.write_shift(1, 255);
  }
  return o;
}
function parse_FontFlags(data) {
  var d = data.read_shift(1);
  data.l++;
  var out = {
    fBold: d & 1,
    fItalic: d & 2,
    fUnderline: d & 4,
    fStrikeout: d & 8,
    fOutline: d & 16,
    fShadow: d & 32,
    fCondense: d & 64,
    fExtend: d & 128
  };
  return out;
}
function write_FontFlags(font, o) {
  if (!o) o = new_buf(2);
  var grbit = (font.italic ? 2 : 0) | (font.strike ? 8 : 0) | (font.outline ? 16 : 0) | (font.shadow ? 32 : 0) | (font.condense ? 64 : 0) | (font.extend ? 128 : 0);
  o.write_shift(1, grbit);
  o.write_shift(1, 0);
  return o;
}
var VT_I2 = 2;
var VT_I4 = 3;
var VT_BOOL = 11;
var VT_UI4 = 19;
var VT_FILETIME = 64;
var VT_BLOB = 65;
var VT_CF = 71;
var VT_VECTOR_VARIANT = 4108;
var VT_VECTOR_LPSTR = 4126;
var VT_STRING = 80;
var DocSummaryPIDDSI = {
  /*::[*/
  1: {
    n: "CodePage",
    t: VT_I2
  },
  /*::[*/
  2: {
    n: "Category",
    t: VT_STRING
  },
  /*::[*/
  3: {
    n: "PresentationFormat",
    t: VT_STRING
  },
  /*::[*/
  4: {
    n: "ByteCount",
    t: VT_I4
  },
  /*::[*/
  5: {
    n: "LineCount",
    t: VT_I4
  },
  /*::[*/
  6: {
    n: "ParagraphCount",
    t: VT_I4
  },
  /*::[*/
  7: {
    n: "SlideCount",
    t: VT_I4
  },
  /*::[*/
  8: {
    n: "NoteCount",
    t: VT_I4
  },
  /*::[*/
  9: {
    n: "HiddenCount",
    t: VT_I4
  },
  /*::[*/
  10: {
    n: "MultimediaClipCount",
    t: VT_I4
  },
  /*::[*/
  11: {
    n: "ScaleCrop",
    t: VT_BOOL
  },
  /*::[*/
  12: {
    n: "HeadingPairs",
    t: VT_VECTOR_VARIANT
    /* VT_VECTOR | VT_VARIANT */
  },
  /*::[*/
  13: {
    n: "TitlesOfParts",
    t: VT_VECTOR_LPSTR
    /* VT_VECTOR | VT_LPSTR */
  },
  /*::[*/
  14: {
    n: "Manager",
    t: VT_STRING
  },
  /*::[*/
  15: {
    n: "Company",
    t: VT_STRING
  },
  /*::[*/
  16: {
    n: "LinksUpToDate",
    t: VT_BOOL
  },
  /*::[*/
  17: {
    n: "CharacterCount",
    t: VT_I4
  },
  /*::[*/
  19: {
    n: "SharedDoc",
    t: VT_BOOL
  },
  /*::[*/
  22: {
    n: "HyperlinksChanged",
    t: VT_BOOL
  },
  /*::[*/
  23: {
    n: "AppVersion",
    t: VT_I4,
    p: "version"
  },
  /*::[*/
  24: {
    n: "DigSig",
    t: VT_BLOB
  },
  /*::[*/
  26: {
    n: "ContentType",
    t: VT_STRING
  },
  /*::[*/
  27: {
    n: "ContentStatus",
    t: VT_STRING
  },
  /*::[*/
  28: {
    n: "Language",
    t: VT_STRING
  },
  /*::[*/
  29: {
    n: "Version",
    t: VT_STRING
  },
  /*::[*/
  255: {},
  /* [MS-OLEPS] 2.18 */
  /*::[*/
  2147483648: {
    n: "Locale",
    t: VT_UI4
  },
  /*::[*/
  2147483651: {
    n: "Behavior",
    t: VT_UI4
  },
  /*::[*/
  1919054434: {}
};
var SummaryPIDSI = {
  /*::[*/
  1: {
    n: "CodePage",
    t: VT_I2
  },
  /*::[*/
  2: {
    n: "Title",
    t: VT_STRING
  },
  /*::[*/
  3: {
    n: "Subject",
    t: VT_STRING
  },
  /*::[*/
  4: {
    n: "Author",
    t: VT_STRING
  },
  /*::[*/
  5: {
    n: "Keywords",
    t: VT_STRING
  },
  /*::[*/
  6: {
    n: "Comments",
    t: VT_STRING
  },
  /*::[*/
  7: {
    n: "Template",
    t: VT_STRING
  },
  /*::[*/
  8: {
    n: "LastAuthor",
    t: VT_STRING
  },
  /*::[*/
  9: {
    n: "RevNumber",
    t: VT_STRING
  },
  /*::[*/
  10: {
    n: "EditTime",
    t: VT_FILETIME
  },
  /*::[*/
  11: {
    n: "LastPrinted",
    t: VT_FILETIME
  },
  /*::[*/
  12: {
    n: "CreatedDate",
    t: VT_FILETIME
  },
  /*::[*/
  13: {
    n: "ModifiedDate",
    t: VT_FILETIME
  },
  /*::[*/
  14: {
    n: "PageCount",
    t: VT_I4
  },
  /*::[*/
  15: {
    n: "WordCount",
    t: VT_I4
  },
  /*::[*/
  16: {
    n: "CharCount",
    t: VT_I4
  },
  /*::[*/
  17: {
    n: "Thumbnail",
    t: VT_CF
  },
  /*::[*/
  18: {
    n: "Application",
    t: VT_STRING
  },
  /*::[*/
  19: {
    n: "DocSecurity",
    t: VT_I4
  },
  /*::[*/
  255: {},
  /* [MS-OLEPS] 2.18 */
  /*::[*/
  2147483648: {
    n: "Locale",
    t: VT_UI4
  },
  /*::[*/
  2147483651: {
    n: "Behavior",
    t: VT_UI4
  },
  /*::[*/
  1919054434: {}
};
function rgbify(arr) {
  return arr.map(function(x) {
    return [x >> 16 & 255, x >> 8 & 255, x & 255];
  });
}
var _XLSIcv = /* @__PURE__ */ rgbify([
  /* Color Constants */
  0,
  16777215,
  16711680,
  65280,
  255,
  16776960,
  16711935,
  65535,
  /* Overridable Defaults */
  0,
  16777215,
  16711680,
  65280,
  255,
  16776960,
  16711935,
  65535,
  8388608,
  32768,
  128,
  8421376,
  8388736,
  32896,
  12632256,
  8421504,
  10066431,
  10040166,
  16777164,
  13434879,
  6684774,
  16744576,
  26316,
  13421823,
  128,
  16711935,
  16776960,
  65535,
  8388736,
  8388608,
  32896,
  255,
  52479,
  13434879,
  13434828,
  16777113,
  10079487,
  16751052,
  13408767,
  16764057,
  3368703,
  3394764,
  10079232,
  16763904,
  16750848,
  16737792,
  6710937,
  9868950,
  13158,
  3381606,
  13056,
  3355392,
  10040064,
  10040166,
  3355545,
  3355443,
  /* Other entries to appease BIFF8/12 */
  16777215,
  /* 0x40 icvForeground ?? */
  0,
  /* 0x41 icvBackground ?? */
  0,
  /* 0x42 icvFrame ?? */
  0,
  /* 0x43 icv3D ?? */
  0,
  /* 0x44 icv3DText ?? */
  0,
  /* 0x45 icv3DHilite ?? */
  0,
  /* 0x46 icv3DShadow ?? */
  0,
  /* 0x47 icvHilite ?? */
  0,
  /* 0x48 icvCtlText ?? */
  0,
  /* 0x49 icvCtlScrl ?? */
  0,
  /* 0x4A icvCtlInv ?? */
  0,
  /* 0x4B icvCtlBody ?? */
  0,
  /* 0x4C icvCtlFrame ?? */
  0,
  /* 0x4D icvCtlFore ?? */
  0,
  /* 0x4E icvCtlBack ?? */
  0,
  /* 0x4F icvCtlNeutral */
  0,
  /* 0x50 icvInfoBk ?? */
  0
  /* 0x51 icvInfoText ?? */
]);
var XLSIcv = /* @__PURE__ */ dup(_XLSIcv);
var BErr = {
  /*::[*/
  0: "#NULL!",
  /*::[*/
  7: "#DIV/0!",
  /*::[*/
  15: "#VALUE!",
  /*::[*/
  23: "#REF!",
  /*::[*/
  29: "#NAME?",
  /*::[*/
  36: "#NUM!",
  /*::[*/
  42: "#N/A",
  /*::[*/
  43: "#GETTING_DATA",
  /*::[*/
  255: "#WTF?"
};
var ct2type = {
  /* Workbook */
  "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml": "workbooks",
  "application/vnd.ms-excel.sheet.macroEnabled.main+xml": "workbooks",
  "application/vnd.ms-excel.sheet.binary.macroEnabled.main": "workbooks",
  "application/vnd.ms-excel.addin.macroEnabled.main+xml": "workbooks",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml": "workbooks",
  /* Worksheet */
  "application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml": "sheets",
  "application/vnd.ms-excel.worksheet": "sheets",
  "application/vnd.ms-excel.binIndexWs": "TODO",
  /* Binary Index */
  /* Chartsheet */
  "application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml": "charts",
  "application/vnd.ms-excel.chartsheet": "charts",
  /* Macrosheet */
  "application/vnd.ms-excel.macrosheet+xml": "macros",
  "application/vnd.ms-excel.macrosheet": "macros",
  "application/vnd.ms-excel.intlmacrosheet": "TODO",
  "application/vnd.ms-excel.binIndexMs": "TODO",
  /* Binary Index */
  /* Dialogsheet */
  "application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml": "dialogs",
  "application/vnd.ms-excel.dialogsheet": "dialogs",
  /* Shared Strings */
  "application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml": "strs",
  "application/vnd.ms-excel.sharedStrings": "strs",
  /* Styles */
  "application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml": "styles",
  "application/vnd.ms-excel.styles": "styles",
  /* File Properties */
  "application/vnd.openxmlformats-package.core-properties+xml": "coreprops",
  "application/vnd.openxmlformats-officedocument.custom-properties+xml": "custprops",
  "application/vnd.openxmlformats-officedocument.extended-properties+xml": "extprops",
  /* Custom Data Properties */
  "application/vnd.openxmlformats-officedocument.customXmlProperties+xml": "TODO",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty": "TODO",
  /* Comments */
  "application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml": "comments",
  "application/vnd.ms-excel.comments": "comments",
  "application/vnd.ms-excel.threadedcomments+xml": "threadedcomments",
  "application/vnd.ms-excel.person+xml": "people",
  /* Metadata (Stock/Geography and Dynamic Array) */
  "application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml": "metadata",
  "application/vnd.ms-excel.sheetMetadata": "metadata",
  /* PivotTable */
  "application/vnd.ms-excel.pivotTable": "TODO",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml": "TODO",
  /* Chart Objects */
  "application/vnd.openxmlformats-officedocument.drawingml.chart+xml": "TODO",
  /* Chart Colors */
  "application/vnd.ms-office.chartcolorstyle+xml": "TODO",
  /* Chart Style */
  "application/vnd.ms-office.chartstyle+xml": "TODO",
  /* Chart Advanced */
  "application/vnd.ms-office.chartex+xml": "TODO",
  /* Calculation Chain */
  "application/vnd.ms-excel.calcChain": "calcchains",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml": "calcchains",
  /* Printer Settings */
  "application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings": "TODO",
  /* ActiveX */
  "application/vnd.ms-office.activeX": "TODO",
  "application/vnd.ms-office.activeX+xml": "TODO",
  /* Custom Toolbars */
  "application/vnd.ms-excel.attachedToolbars": "TODO",
  /* External Data Connections */
  "application/vnd.ms-excel.connections": "TODO",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml": "TODO",
  /* External Links */
  "application/vnd.ms-excel.externalLink": "links",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml": "links",
  /* PivotCache */
  "application/vnd.ms-excel.pivotCacheDefinition": "TODO",
  "application/vnd.ms-excel.pivotCacheRecords": "TODO",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml": "TODO",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml": "TODO",
  /* Query Table */
  "application/vnd.ms-excel.queryTable": "TODO",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml": "TODO",
  /* Shared Workbook */
  "application/vnd.ms-excel.userNames": "TODO",
  "application/vnd.ms-excel.revisionHeaders": "TODO",
  "application/vnd.ms-excel.revisionLog": "TODO",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml": "TODO",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml": "TODO",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml": "TODO",
  /* Single Cell Table */
  "application/vnd.ms-excel.tableSingleCells": "TODO",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml": "TODO",
  /* Slicer */
  "application/vnd.ms-excel.slicer": "TODO",
  "application/vnd.ms-excel.slicerCache": "TODO",
  "application/vnd.ms-excel.slicer+xml": "TODO",
  "application/vnd.ms-excel.slicerCache+xml": "TODO",
  /* Sort Map */
  "application/vnd.ms-excel.wsSortMap": "TODO",
  /* Table */
  "application/vnd.ms-excel.table": "TODO",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml": "TODO",
  /* Themes */
  "application/vnd.openxmlformats-officedocument.theme+xml": "themes",
  /* Theme Override */
  "application/vnd.openxmlformats-officedocument.themeOverride+xml": "TODO",
  /* Timeline */
  "application/vnd.ms-excel.Timeline+xml": "TODO",
  /* verify */
  "application/vnd.ms-excel.TimelineCache+xml": "TODO",
  /* verify */
  /* VBA */
  "application/vnd.ms-office.vbaProject": "vba",
  "application/vnd.ms-office.vbaProjectSignature": "TODO",
  /* Volatile Dependencies */
  "application/vnd.ms-office.volatileDependencies": "TODO",
  "application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml": "TODO",
  /* Control Properties */
  "application/vnd.ms-excel.controlproperties+xml": "TODO",
  /* Data Model */
  "application/vnd.openxmlformats-officedocument.model+data": "TODO",
  /* Survey */
  "application/vnd.ms-excel.Survey+xml": "TODO",
  /* Drawing */
  "application/vnd.openxmlformats-officedocument.drawing+xml": "drawings",
  "application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml": "TODO",
  "application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml": "TODO",
  "application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml": "TODO",
  "application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml": "TODO",
  "application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml": "TODO",
  /* VML */
  "application/vnd.openxmlformats-officedocument.vmlDrawing": "TODO",
  "application/vnd.openxmlformats-package.relationships+xml": "rels",
  "application/vnd.openxmlformats-officedocument.oleObject": "TODO",
  /* Image */
  "image/png": "TODO",
  "sheet": "js"
};
var CT_LIST = {
  workbooks: {
    xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",
    xlsm: "application/vnd.ms-excel.sheet.macroEnabled.main+xml",
    xlsb: "application/vnd.ms-excel.sheet.binary.macroEnabled.main",
    xlam: "application/vnd.ms-excel.addin.macroEnabled.main+xml",
    xltx: "application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"
  },
  strs: {
    /* Shared Strings */
    xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",
    xlsb: "application/vnd.ms-excel.sharedStrings"
  },
  comments: {
    /* Comments */
    xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",
    xlsb: "application/vnd.ms-excel.comments"
  },
  sheets: {
    /* Worksheet */
    xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",
    xlsb: "application/vnd.ms-excel.worksheet"
  },
  charts: {
    /* Chartsheet */
    xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",
    xlsb: "application/vnd.ms-excel.chartsheet"
  },
  dialogs: {
    /* Dialogsheet */
    xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",
    xlsb: "application/vnd.ms-excel.dialogsheet"
  },
  macros: {
    /* Macrosheet (Excel 4.0 Macros) */
    xlsx: "application/vnd.ms-excel.macrosheet+xml",
    xlsb: "application/vnd.ms-excel.macrosheet"
  },
  metadata: {
    /* Metadata (Stock/Geography and Dynamic Array) */
    xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",
    xlsb: "application/vnd.ms-excel.sheetMetadata"
  },
  styles: {
    /* Styles */
    xlsx: "application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",
    xlsb: "application/vnd.ms-excel.styles"
  }
};
function new_ct() {
  return {
    workbooks: [],
    sheets: [],
    charts: [],
    dialogs: [],
    macros: [],
    rels: [],
    strs: [],
    comments: [],
    threadedcomments: [],
    links: [],
    coreprops: [],
    extprops: [],
    custprops: [],
    themes: [],
    styles: [],
    calcchains: [],
    vba: [],
    drawings: [],
    metadata: [],
    people: [],
    TODO: [],
    xmlns: ""
  };
}
function write_ct(ct, opts) {
  var type2ct = evert_arr(ct2type);
  var o = [], v;
  o[o.length] = XML_HEADER;
  o[o.length] = writextag("Types", null, {
    "xmlns": XMLNS.CT,
    "xmlns:xsd": XMLNS.xsd,
    "xmlns:xsi": XMLNS.xsi
  });
  o = o.concat([
    ["xml", "application/xml"],
    ["bin", "application/vnd.ms-excel.sheet.binary.macroEnabled.main"],
    ["vml", "application/vnd.openxmlformats-officedocument.vmlDrawing"],
    ["data", "application/vnd.openxmlformats-officedocument.model+data"],
    /* from test files */
    ["bmp", "image/bmp"],
    ["png", "image/png"],
    ["gif", "image/gif"],
    ["emf", "image/x-emf"],
    ["wmf", "image/x-wmf"],
    ["jpg", "image/jpeg"],
    ["jpeg", "image/jpeg"],
    ["tif", "image/tiff"],
    ["tiff", "image/tiff"],
    ["pdf", "application/pdf"],
    ["rels", "application/vnd.openxmlformats-package.relationships+xml"]
  ].map(function(x) {
    return writextag("Default", null, {
      "Extension": x[0],
      "ContentType": x[1]
    });
  }));
  var f1 = function(w) {
    if (ct[w] && ct[w].length > 0) {
      v = ct[w][0];
      o[o.length] = writextag("Override", null, {
        "PartName": (v[0] == "/" ? "" : "/") + v,
        "ContentType": CT_LIST[w][opts.bookType] || CT_LIST[w]["xlsx"]
      });
    }
  };
  var f2 = function(w) {
    (ct[w] || []).forEach(function(v2) {
      o[o.length] = writextag("Override", null, {
        "PartName": (v2[0] == "/" ? "" : "/") + v2,
        "ContentType": CT_LIST[w][opts.bookType] || CT_LIST[w]["xlsx"]
      });
    });
  };
  var f3 = function(t) {
    (ct[t] || []).forEach(function(v2) {
      o[o.length] = writextag("Override", null, {
        "PartName": (v2[0] == "/" ? "" : "/") + v2,
        "ContentType": type2ct[t][0]
      });
    });
  };
  f1("workbooks");
  f2("sheets");
  f2("charts");
  f3("themes");
  ["strs", "styles"].forEach(f1);
  ["coreprops", "extprops", "custprops"].forEach(f3);
  f3("vba");
  f3("comments");
  f3("threadedcomments");
  f3("drawings");
  f2("metadata");
  f3("people");
  if (o.length > 2) {
    o[o.length] = "</Types>";
    o[1] = o[1].replace("/>", ">");
  }
  return o.join("");
}
var RELS = {
  WB: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",
  SHEET: "http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",
  HLINK: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",
  VML: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",
  XPATH: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",
  XMISS: "http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",
  XLINK: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",
  CXML: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",
  CXMLP: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",
  CMNT: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",
  CORE_PROPS: "http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",
  EXT_PROPS: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",
  CUST_PROPS: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",
  SST: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",
  STY: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",
  THEME: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",
  CHART: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",
  CHARTEX: "http://schemas.microsoft.com/office/2014/relationships/chartEx",
  CS: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",
  WS: ["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet", "http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],
  DS: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",
  MS: "http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",
  IMG: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",
  DRAW: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",
  XLMETA: "http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",
  TCMNT: "http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",
  PEOPLE: "http://schemas.microsoft.com/office/2017/10/relationships/person",
  VBA: "http://schemas.microsoft.com/office/2006/relationships/vbaProject"
};
function get_rels_path(file) {
  var n = file.lastIndexOf("/");
  return file.slice(0, n + 1) + "_rels/" + file.slice(n + 1) + ".rels";
}
function write_rels(rels) {
  var o = [XML_HEADER, writextag("Relationships", null, {
    //'xmlns:ns0': XMLNS.RELS,
    "xmlns": XMLNS.RELS
  })];
  keys(rels["!id"]).forEach(function(rid) {
    o[o.length] = writextag("Relationship", null, rels["!id"][rid]);
  });
  if (o.length > 2) {
    o[o.length] = "</Relationships>";
    o[1] = o[1].replace("/>", ">");
  }
  return o.join("");
}
function add_rels(rels, rId, f, type, relobj, targetmode) {
  if (!relobj) relobj = {};
  if (!rels["!id"]) rels["!id"] = {};
  if (!rels["!idx"]) rels["!idx"] = 1;
  if (rId < 0) for (rId = rels["!idx"]; rels["!id"]["rId" + rId]; ++rId) {
  }
  rels["!idx"] = rId + 1;
  relobj.Id = "rId" + rId;
  relobj.Type = type;
  relobj.Target = f;
  if (targetmode) relobj.TargetMode = targetmode;
  else if ([RELS.HLINK, RELS.XPATH, RELS.XMISS].indexOf(relobj.Type) > -1) relobj.TargetMode = "External";
  if (rels["!id"][relobj.Id]) throw new Error("Cannot rewrite rId " + rId);
  rels["!id"][relobj.Id] = relobj;
  rels[("/" + relobj.Target).replace("//", "/")] = relobj;
  return rId;
}
function write_manifest(manifest) {
  var o = [XML_HEADER];
  o.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n');
  o.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');
  for (var i = 0; i < manifest.length; ++i) o.push('  <manifest:file-entry manifest:full-path="' + manifest[i][0] + '" manifest:media-type="' + manifest[i][1] + '"/>\n');
  o.push("</manifest:manifest>");
  return o.join("");
}
function write_rdf_type(file, res, tag) {
  return ['  <rdf:Description rdf:about="' + file + '">\n', '    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/' + (tag || "odf") + "#" + res + '"/>\n', "  </rdf:Description>\n"].join("");
}
function write_rdf_has(base, file) {
  return ['  <rdf:Description rdf:about="' + base + '">\n', '    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="' + file + '"/>\n', "  </rdf:Description>\n"].join("");
}
function write_rdf(rdf) {
  var o = [XML_HEADER];
  o.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');
  for (var i = 0; i != rdf.length; ++i) {
    o.push(write_rdf_type(rdf[i][0], rdf[i][1]));
    o.push(write_rdf_has("", rdf[i][0]));
  }
  o.push(write_rdf_type("", "Document", "pkg"));
  o.push("</rdf:RDF>");
  return o.join("");
}
function write_meta_ods() {
  return '<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS ' + XLSX.version + "</meta:generator></office:meta></office:document-meta>";
}
var CORE_PROPS = [["cp:category", "Category"], ["cp:contentStatus", "ContentStatus"], ["cp:keywords", "Keywords"], ["cp:lastModifiedBy", "LastAuthor"], ["cp:lastPrinted", "LastPrinted"], ["cp:revision", "RevNumber"], ["cp:version", "Version"], ["dc:creator", "Author"], ["dc:description", "Comments"], ["dc:identifier", "Identifier"], ["dc:language", "Language"], ["dc:subject", "Subject"], ["dc:title", "Title"], ["dcterms:created", "CreatedDate", "date"], ["dcterms:modified", "ModifiedDate", "date"]];
function cp_doit(f, g, h, o, p) {
  if (p[f] != null || g == null || g === "") return;
  p[f] = g;
  g = escapexml(g);
  o[o.length] = h ? writextag(f, g, h) : writetag(f, g);
}
function write_core_props(cp, _opts) {
  var opts = _opts || {};
  var o = [XML_HEADER, writextag("cp:coreProperties", null, {
    //'xmlns': XMLNS.CORE_PROPS,
    "xmlns:cp": XMLNS.CORE_PROPS,
    "xmlns:dc": XMLNS.dc,
    "xmlns:dcterms": XMLNS.dcterms,
    "xmlns:dcmitype": XMLNS.dcmitype,
    "xmlns:xsi": XMLNS.xsi
  })], p = {};
  if (!cp && !opts.Props) return o.join("");
  if (cp) {
    if (cp.CreatedDate != null) cp_doit("dcterms:created", typeof cp.CreatedDate === "string" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts.WTF), {
      "xsi:type": "dcterms:W3CDTF"
    }, o, p);
    if (cp.ModifiedDate != null) cp_doit("dcterms:modified", typeof cp.ModifiedDate === "string" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts.WTF), {
      "xsi:type": "dcterms:W3CDTF"
    }, o, p);
  }
  for (var i = 0; i != CORE_PROPS.length; ++i) {
    var f = CORE_PROPS[i];
    var v = opts.Props && opts.Props[f[1]] != null ? opts.Props[f[1]] : cp ? cp[f[1]] : null;
    if (v === true) v = "1";
    else if (v === false) v = "0";
    else if (typeof v == "number") v = String(v);
    if (v != null) cp_doit(f[0], v, null, o, p);
  }
  if (o.length > 2) {
    o[o.length] = "</cp:coreProperties>";
    o[1] = o[1].replace("/>", ">");
  }
  return o.join("");
}
var EXT_PROPS = [["Application", "Application", "string"], ["AppVersion", "AppVersion", "string"], ["Company", "Company", "string"], ["DocSecurity", "DocSecurity", "string"], ["Manager", "Manager", "string"], ["HyperlinksChanged", "HyperlinksChanged", "bool"], ["SharedDoc", "SharedDoc", "bool"], ["LinksUpToDate", "LinksUpToDate", "bool"], ["ScaleCrop", "ScaleCrop", "bool"], ["HeadingPairs", "HeadingPairs", "raw"], ["TitlesOfParts", "TitlesOfParts", "raw"]];
var PseudoPropsPairs = ["Worksheets", "SheetNames", "NamedRanges", "DefinedNames", "Chartsheets", "ChartNames"];
function write_ext_props(cp) {
  var o = [], W = writextag;
  if (!cp) cp = {};
  cp.Application = "SheetJS";
  o[o.length] = XML_HEADER;
  o[o.length] = writextag("Properties", null, {
    "xmlns": XMLNS.EXT_PROPS,
    "xmlns:vt": XMLNS.vt
  });
  EXT_PROPS.forEach(function(f) {
    if (cp[f[1]] === void 0) return;
    var v;
    switch (f[2]) {
      case "string":
        v = escapexml(String(cp[f[1]]));
        break;
      case "bool":
        v = cp[f[1]] ? "true" : "false";
        break;
    }
    if (v !== void 0) o[o.length] = W(f[0], v);
  });
  o[o.length] = W("HeadingPairs", W("vt:vector", W("vt:variant", "<vt:lpstr>Worksheets</vt:lpstr>") + W("vt:variant", W("vt:i4", String(cp.Worksheets))), {
    size: 2,
    baseType: "variant"
  }));
  o[o.length] = W("TitlesOfParts", W("vt:vector", cp.SheetNames.map(function(s) {
    return "<vt:lpstr>" + escapexml(s) + "</vt:lpstr>";
  }).join(""), {
    size: cp.Worksheets,
    baseType: "lpstr"
  }));
  if (o.length > 2) {
    o[o.length] = "</Properties>";
    o[1] = o[1].replace("/>", ">");
  }
  return o.join("");
}
function write_cust_props(cp) {
  var o = [XML_HEADER, writextag("Properties", null, {
    "xmlns": XMLNS.CUST_PROPS,
    "xmlns:vt": XMLNS.vt
  })];
  if (!cp) return o.join("");
  var pid = 1;
  keys(cp).forEach(function custprop(k) {
    ++pid;
    o[o.length] = writextag("property", write_vt(cp[k], true), {
      "fmtid": "{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",
      "pid": pid,
      "name": escapexml(k)
    });
  });
  if (o.length > 2) {
    o[o.length] = "</Properties>";
    o[1] = o[1].replace("/>", ">");
  }
  return o.join("");
}
var XLMLDocPropsMap = {
  Title: "Title",
  Subject: "Subject",
  Author: "Author",
  Keywords: "Keywords",
  Comments: "Description",
  LastAuthor: "LastAuthor",
  RevNumber: "Revision",
  Application: "AppName",
  /* TotalTime: 'TotalTime', */
  LastPrinted: "LastPrinted",
  CreatedDate: "Created",
  ModifiedDate: "LastSaved",
  /* Pages */
  /* Words */
  /* Characters */
  Category: "Category",
  /* PresentationFormat */
  Manager: "Manager",
  Company: "Company",
  /* Guid */
  /* HyperlinkBase */
  /* Bytes */
  /* Lines */
  /* Paragraphs */
  /* CharactersWithSpaces */
  AppVersion: "Version",
  ContentStatus: "ContentStatus",
  /* NOTE: missing from schema */
  Identifier: "Identifier",
  /* NOTE: missing from schema */
  Language: "Language"
  /* NOTE: missing from schema */
};
function xlml_write_docprops(Props, opts) {
  var o = [];
  keys(XLMLDocPropsMap).map(function(m) {
    for (var i = 0; i < CORE_PROPS.length; ++i) if (CORE_PROPS[i][1] == m) return CORE_PROPS[i];
    for (i = 0; i < EXT_PROPS.length; ++i) if (EXT_PROPS[i][1] == m) return EXT_PROPS[i];
    throw m;
  }).forEach(function(p) {
    if (Props[p[1]] == null) return;
    var m = opts && opts.Props && opts.Props[p[1]] != null ? opts.Props[p[1]] : Props[p[1]];
    switch (p[2]) {
      case "date":
        m = new Date(m).toISOString().replace(/\.\d*Z/, "Z");
        break;
    }
    if (typeof m == "number") m = String(m);
    else if (m === true || m === false) {
      m = m ? "1" : "0";
    } else if (m instanceof Date) m = new Date(m).toISOString().replace(/\.\d*Z/, "");
    o.push(writetag(XLMLDocPropsMap[p[1]] || p[1], m));
  });
  return writextag("DocumentProperties", o.join(""), {
    xmlns: XLMLNS.o
  });
}
function xlml_write_custprops(Props, Custprops) {
  var BLACKLIST = ["Worksheets", "SheetNames"];
  var T = "CustomDocumentProperties";
  var o = [];
  if (Props) keys(Props).forEach(function(k) {
    if (!Object.prototype.hasOwnProperty.call(Props, k)) return;
    for (var i = 0; i < CORE_PROPS.length; ++i) if (k == CORE_PROPS[i][1]) return;
    for (i = 0; i < EXT_PROPS.length; ++i) if (k == EXT_PROPS[i][1]) return;
    for (i = 0; i < BLACKLIST.length; ++i) if (k == BLACKLIST[i]) return;
    var m = Props[k];
    var t = "string";
    if (typeof m == "number") {
      t = "float";
      m = String(m);
    } else if (m === true || m === false) {
      t = "boolean";
      m = m ? "1" : "0";
    } else m = String(m);
    o.push(writextag(escapexmltag(k), m, {
      "dt:dt": t
    }));
  });
  if (Custprops) keys(Custprops).forEach(function(k) {
    if (!Object.prototype.hasOwnProperty.call(Custprops, k)) return;
    if (Props && Object.prototype.hasOwnProperty.call(Props, k)) return;
    var m = Custprops[k];
    var t = "string";
    if (typeof m == "number") {
      t = "float";
      m = String(m);
    } else if (m === true || m === false) {
      t = "boolean";
      m = m ? "1" : "0";
    } else if (m instanceof Date) {
      t = "dateTime.tz";
      m = m.toISOString();
    } else m = String(m);
    o.push(writextag(escapexmltag(k), m, {
      "dt:dt": t
    }));
  });
  return "<" + T + ' xmlns="' + XLMLNS.o + '">' + o.join("") + "</" + T + ">";
}
function write_FILETIME(time) {
  var date = typeof time == "string" ? new Date(Date.parse(time)) : time;
  var t = date.getTime() / 1e3 + 11644473600;
  var l = t % Math.pow(2, 32), h = (t - l) / Math.pow(2, 32);
  l *= 1e7;
  h *= 1e7;
  var w = l / Math.pow(2, 32) | 0;
  if (w > 0) {
    l = l % Math.pow(2, 32);
    h += w;
  }
  var o = new_buf(8);
  o.write_shift(4, l);
  o.write_shift(4, h);
  return o;
}
function write_TypedPropertyValue(type, value) {
  var o = new_buf(4), p = new_buf(4);
  o.write_shift(4, type == 80 ? 31 : type);
  switch (type) {
    case 3:
      p.write_shift(-4, value);
      break;
    case 5:
      p = new_buf(8);
      p.write_shift(8, value, "f");
      break;
    case 11:
      p.write_shift(4, value ? 1 : 0);
      break;
    case 64:
      p = write_FILETIME(value);
      break;
    case 31:
    case 80:
      p = new_buf(4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));
      p.write_shift(4, value.length + 1);
      p.write_shift(0, value, "dbcs");
      while (p.l != p.length) p.write_shift(1, 0);
      break;
    default:
      throw new Error("TypedPropertyValue unrecognized type " + type + " " + value);
  }
  return bconcat([o, p]);
}
var XLSPSSkip = ["CodePage", "Thumbnail", "_PID_LINKBASE", "_PID_HLINKS", "SystemIdentifier", "FMTID"];
function guess_property_type(val) {
  switch (typeof val) {
    case "boolean":
      return 11;
    case "number":
      return (val | 0) == val ? 3 : 5;
    case "string":
      return 31;
    case "object":
      if (val instanceof Date) return 64;
      break;
  }
  return -1;
}
function write_PropertySet(entries, RE, PIDSI) {
  var hdr = new_buf(8), piao = [], prop = [];
  var sz = 8, i = 0;
  var pr = new_buf(8), pio = new_buf(8);
  pr.write_shift(4, 2);
  pr.write_shift(4, 1200);
  pio.write_shift(4, 1);
  prop.push(pr);
  piao.push(pio);
  sz += 8 + pr.length;
  if (!RE) {
    pio = new_buf(8);
    pio.write_shift(4, 0);
    piao.unshift(pio);
    var bufs = [new_buf(4)];
    bufs[0].write_shift(4, entries.length);
    for (i = 0; i < entries.length; ++i) {
      var value = entries[i][0];
      pr = new_buf(4 + 4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));
      pr.write_shift(4, i + 2);
      pr.write_shift(4, value.length + 1);
      pr.write_shift(0, value, "dbcs");
      while (pr.l != pr.length) pr.write_shift(1, 0);
      bufs.push(pr);
    }
    pr = bconcat(bufs);
    prop.unshift(pr);
    sz += 8 + pr.length;
  }
  for (i = 0; i < entries.length; ++i) {
    if (RE && !RE[entries[i][0]]) continue;
    if (XLSPSSkip.indexOf(entries[i][0]) > -1 || PseudoPropsPairs.indexOf(entries[i][0]) > -1) continue;
    if (entries[i][1] == null) continue;
    var val = entries[i][1], idx = 0;
    if (RE) {
      idx = +RE[entries[i][0]];
      var pinfo = PIDSI[idx];
      if (pinfo.p == "version" && typeof val == "string") {
        var arr = val.split(".");
        val = (+arr[0] << 16) + (+arr[1] || 0);
      }
      pr = write_TypedPropertyValue(pinfo.t, val);
    } else {
      var T = guess_property_type(val);
      if (T == -1) {
        T = 31;
        val = String(val);
      }
      pr = write_TypedPropertyValue(T, val);
    }
    prop.push(pr);
    pio = new_buf(8);
    pio.write_shift(4, !RE ? 2 + i : idx);
    piao.push(pio);
    sz += 8 + pr.length;
  }
  var w = 8 * (prop.length + 1);
  for (i = 0; i < prop.length; ++i) {
    piao[i].write_shift(4, w);
    w += prop[i].length;
  }
  hdr.write_shift(4, sz);
  hdr.write_shift(4, prop.length);
  return bconcat([hdr].concat(piao).concat(prop));
}
function write_PropertySetStream(entries, clsid, RE, PIDSI, entries2, clsid2) {
  var hdr = new_buf(entries2 ? 68 : 48);
  var bufs = [hdr];
  hdr.write_shift(2, 65534);
  hdr.write_shift(2, 0);
  hdr.write_shift(4, 842412599);
  hdr.write_shift(16, CFB.utils.consts.HEADER_CLSID, "hex");
  hdr.write_shift(4, entries2 ? 2 : 1);
  hdr.write_shift(16, clsid, "hex");
  hdr.write_shift(4, entries2 ? 68 : 48);
  var ps0 = write_PropertySet(entries, RE, PIDSI);
  bufs.push(ps0);
  if (entries2) {
    var ps1 = write_PropertySet(entries2, null, null);
    hdr.write_shift(16, clsid2, "hex");
    hdr.write_shift(4, 68 + ps0.length);
    bufs.push(ps1);
  }
  return bconcat(bufs);
}
function writezeroes(n, o) {
  if (!o) o = new_buf(n);
  for (var j = 0; j < n; ++j) o.write_shift(1, 0);
  return o;
}
function parsebool(blob, length) {
  return blob.read_shift(length) === 1;
}
function writebool(v, o) {
  if (!o) o = new_buf(2);
  o.write_shift(2, +!!v);
  return o;
}
function parseuint16(blob) {
  return blob.read_shift(2, "u");
}
function writeuint16(v, o) {
  if (!o) o = new_buf(2);
  o.write_shift(2, v);
  return o;
}
function write_Bes(v, t, o) {
  if (!o) o = new_buf(2);
  o.write_shift(1, t == "e" ? +v : +!!v);
  o.write_shift(1, t == "e" ? 1 : 0);
  return o;
}
function parse_ShortXLUnicodeString(blob, length, opts) {
  var cch = blob.read_shift(opts && opts.biff >= 12 ? 2 : 1);
  var encoding = "sbcs-cont";
  var cp = current_codepage;
  if (opts && opts.biff >= 8) current_codepage = 1200;
  if (!opts || opts.biff == 8) {
    var fHighByte = blob.read_shift(1);
    if (fHighByte) {
      encoding = "dbcs-cont";
    }
  } else if (opts.biff == 12) {
    encoding = "wstr";
  }
  if (opts.biff >= 2 && opts.biff <= 5) encoding = "cpstr";
  var o = cch ? blob.read_shift(cch, encoding) : "";
  current_codepage = cp;
  return o;
}
function write_XLUnicodeRichExtendedString(xlstr) {
  var str = xlstr.t || "", nfmts = 1;
  var hdr = new_buf(3 + (nfmts > 1 ? 2 : 0));
  hdr.write_shift(2, str.length);
  hdr.write_shift(1, (nfmts > 1 ? 8 : 0) | 1);
  if (nfmts > 1) hdr.write_shift(2, nfmts);
  var otext = new_buf(2 * str.length);
  otext.write_shift(2 * str.length, str, "utf16le");
  var out = [hdr, otext];
  return bconcat(out);
}
function parse_XLUnicodeStringNoCch(blob, cch, opts) {
  var retval;
  if (opts) {
    if (opts.biff >= 2 && opts.biff <= 5) return blob.read_shift(cch, "cpstr");
    if (opts.biff >= 12) return blob.read_shift(cch, "dbcs-cont");
  }
  var fHighByte = blob.read_shift(1);
  if (fHighByte === 0) {
    retval = blob.read_shift(cch, "sbcs-cont");
  } else {
    retval = blob.read_shift(cch, "dbcs-cont");
  }
  return retval;
}
function parse_XLUnicodeString(blob, length, opts) {
  var cch = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);
  if (cch === 0) {
    blob.l++;
    return "";
  }
  return parse_XLUnicodeStringNoCch(blob, cch, opts);
}
function parse_XLUnicodeString2(blob, length, opts) {
  if (opts.biff > 5) return parse_XLUnicodeString(blob, length, opts);
  var cch = blob.read_shift(1);
  if (cch === 0) {
    blob.l++;
    return "";
  }
  return blob.read_shift(cch, opts.biff <= 4 || !blob.lens ? "cpstr" : "sbcs-cont");
}
function write_XLUnicodeString(str, opts, o) {
  if (!o) o = new_buf(3 + 2 * str.length);
  o.write_shift(2, str.length);
  o.write_shift(1, 1);
  o.write_shift(31, str, "utf16le");
  return o;
}
function write_HyperlinkString(str, o) {
  if (!o) o = new_buf(6 + str.length * 2);
  o.write_shift(4, 1 + str.length);
  for (var i = 0; i < str.length; ++i) o.write_shift(2, str.charCodeAt(i));
  o.write_shift(2, 0);
  return o;
}
function write_Hyperlink(hl) {
  var out = new_buf(512), i = 0;
  var Target = hl.Target;
  if (Target.slice(0, 7) == "file://") Target = Target.slice(7);
  var hashidx = Target.indexOf("#");
  var F = hashidx > -1 ? 31 : 23;
  switch (Target.charAt(0)) {
    case "#":
      F = 28;
      break;
    case ".":
      F &= ~2;
      break;
  }
  out.write_shift(4, 2);
  out.write_shift(4, F);
  var data = [8, 6815827, 6619237, 4849780, 83];
  for (i = 0; i < data.length; ++i) out.write_shift(4, data[i]);
  if (F == 28) {
    Target = Target.slice(1);
    write_HyperlinkString(Target, out);
  } else if (F & 2) {
    data = "e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" ");
    for (i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));
    var Pretarget = hashidx > -1 ? Target.slice(0, hashidx) : Target;
    out.write_shift(4, 2 * (Pretarget.length + 1));
    for (i = 0; i < Pretarget.length; ++i) out.write_shift(2, Pretarget.charCodeAt(i));
    out.write_shift(2, 0);
    if (F & 8) write_HyperlinkString(hashidx > -1 ? Target.slice(hashidx + 1) : "", out);
  } else {
    data = "03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" ");
    for (i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));
    var P = 0;
    while (Target.slice(P * 3, P * 3 + 3) == "../" || Target.slice(P * 3, P * 3 + 3) == "..\\") ++P;
    out.write_shift(2, P);
    out.write_shift(4, Target.length - 3 * P + 1);
    for (i = 0; i < Target.length - 3 * P; ++i) out.write_shift(1, Target.charCodeAt(i + 3 * P) & 255);
    out.write_shift(1, 0);
    out.write_shift(2, 65535);
    out.write_shift(2, 57005);
    for (i = 0; i < 6; ++i) out.write_shift(4, 0);
  }
  return out.slice(0, out.l);
}
function write_XLSCell(R, C, ixfe, o) {
  if (!o) o = new_buf(6);
  o.write_shift(2, R);
  o.write_shift(2, C);
  o.write_shift(2, ixfe || 0);
  return o;
}
function parse_XTI(blob, length, opts) {
  var w = opts.biff > 8 ? 4 : 2;
  var iSupBook = blob.read_shift(w), itabFirst = blob.read_shift(w, "i"), itabLast = blob.read_shift(w, "i");
  return [iSupBook, itabFirst, itabLast];
}
function parse_Ref8U(blob) {
  var rwFirst = blob.read_shift(2);
  var rwLast = blob.read_shift(2);
  var colFirst = blob.read_shift(2);
  var colLast = blob.read_shift(2);
  return {
    s: {
      c: colFirst,
      r: rwFirst
    },
    e: {
      c: colLast,
      r: rwLast
    }
  };
}
function write_Ref8U(r, o) {
  if (!o) o = new_buf(8);
  o.write_shift(2, r.s.r);
  o.write_shift(2, r.e.r);
  o.write_shift(2, r.s.c);
  o.write_shift(2, r.e.c);
  return o;
}
function write_BOF(wb, t, o) {
  var h = 1536, w = 16;
  switch (o.bookType) {
    case "biff8":
      break;
    case "biff5":
      h = 1280;
      w = 8;
      break;
    case "biff4":
      h = 4;
      w = 6;
      break;
    case "biff3":
      h = 3;
      w = 6;
      break;
    case "biff2":
      h = 2;
      w = 4;
      break;
    case "xla":
      break;
    default:
      throw new Error("unsupported BIFF version");
  }
  var out = new_buf(w);
  out.write_shift(2, h);
  out.write_shift(2, t);
  if (w > 4) out.write_shift(2, 29282);
  if (w > 6) out.write_shift(2, 1997);
  if (w > 8) {
    out.write_shift(2, 49161);
    out.write_shift(2, 1);
    out.write_shift(2, 1798);
    out.write_shift(2, 0);
  }
  return out;
}
function write_WriteAccess(s, opts) {
  var b8 = !opts || opts.biff == 8;
  var o = new_buf(b8 ? 112 : 54);
  o.write_shift(opts.biff == 8 ? 2 : 1, 7);
  if (b8) o.write_shift(1, 0);
  o.write_shift(4, 859007059);
  o.write_shift(4, 5458548 | (b8 ? 0 : 536870912));
  while (o.l < o.length) o.write_shift(1, b8 ? 0 : 32);
  return o;
}
function write_BoundSheet8(data, opts) {
  var w = !opts || opts.biff >= 8 ? 2 : 1;
  var o = new_buf(8 + w * data.name.length);
  o.write_shift(4, data.pos);
  o.write_shift(1, data.hs || 0);
  o.write_shift(1, data.dt);
  o.write_shift(1, data.name.length);
  if (opts.biff >= 8) o.write_shift(1, 1);
  o.write_shift(w * data.name.length, data.name, opts.biff < 8 ? "sbcs" : "utf16le");
  var out = o.slice(0, o.l);
  out.l = o.l;
  return out;
}
function write_SST(sst, opts) {
  var header = new_buf(8);
  header.write_shift(4, sst.Count);
  header.write_shift(4, sst.Unique);
  var strs = [];
  for (var j = 0; j < sst.length; ++j) strs[j] = write_XLUnicodeRichExtendedString(sst[j], opts);
  var o = bconcat([header].concat(strs));
  o.parts = [header.length].concat(strs.map(function(str) {
    return str.length;
  }));
  return o;
}
function write_Window1() {
  var o = new_buf(18);
  o.write_shift(2, 0);
  o.write_shift(2, 0);
  o.write_shift(2, 29280);
  o.write_shift(2, 17600);
  o.write_shift(2, 56);
  o.write_shift(2, 0);
  o.write_shift(2, 0);
  o.write_shift(2, 1);
  o.write_shift(2, 500);
  return o;
}
function write_Window2(view) {
  var o = new_buf(18), f = 1718;
  if (view && view.RTL) f |= 64;
  o.write_shift(2, f);
  o.write_shift(4, 0);
  o.write_shift(4, 64);
  o.write_shift(4, 0);
  o.write_shift(4, 0);
  return o;
}
function write_Font(data, opts) {
  var name = data.name || "Arial";
  var b5 = opts && opts.biff == 5, w = b5 ? 15 + name.length : 16 + 2 * name.length;
  var o = new_buf(w);
  o.write_shift(2, (data.sz || 12) * 20);
  o.write_shift(4, 0);
  o.write_shift(2, 400);
  o.write_shift(4, 0);
  o.write_shift(2, 0);
  o.write_shift(1, name.length);
  if (!b5) o.write_shift(1, 1);
  o.write_shift((b5 ? 1 : 2) * name.length, name, b5 ? "sbcs" : "utf16le");
  return o;
}
function write_LabelSst(R, C, v, os) {
  var o = new_buf(10);
  write_XLSCell(R, C, os, o);
  o.write_shift(4, v);
  return o;
}
function write_Label(R, C, v, os, opts) {
  var b8 = !opts || opts.biff == 8;
  var o = new_buf(6 + 2 + +b8 + (1 + b8) * v.length);
  write_XLSCell(R, C, os, o);
  o.write_shift(2, v.length);
  if (b8) o.write_shift(1, 1);
  o.write_shift((1 + b8) * v.length, v, b8 ? "utf16le" : "sbcs");
  return o;
}
function write_Format(i, f, opts, o) {
  var b5 = opts && opts.biff == 5;
  if (!o) o = new_buf(b5 ? 3 + f.length : 5 + 2 * f.length);
  o.write_shift(2, i);
  o.write_shift(b5 ? 1 : 2, f.length);
  if (!b5) o.write_shift(1, 1);
  o.write_shift((b5 ? 1 : 2) * f.length, f, b5 ? "sbcs" : "utf16le");
  var out = o.length > o.l ? o.slice(0, o.l) : o;
  if (out.l == null) out.l = out.length;
  return out;
}
function write_Dimensions(range, opts) {
  var w = opts.biff == 8 || !opts.biff ? 4 : 2;
  var o = new_buf(2 * w + 6);
  o.write_shift(w, range.s.r);
  o.write_shift(w, range.e.r + 1);
  o.write_shift(2, range.s.c);
  o.write_shift(2, range.e.c + 1);
  o.write_shift(2, 0);
  return o;
}
function write_XF(data, ixfeP, opts, o) {
  var b5 = opts && opts.biff == 5;
  if (!o) o = new_buf(b5 ? 16 : 20);
  o.write_shift(2, 0);
  if (data.style) {
    o.write_shift(2, data.numFmtId || 0);
    o.write_shift(2, 65524);
  } else {
    o.write_shift(2, data.numFmtId || 0);
    o.write_shift(2, ixfeP << 4);
  }
  var f = 0;
  if (data.numFmtId > 0 && b5) f |= 1024;
  o.write_shift(4, f);
  o.write_shift(4, 0);
  if (!b5) o.write_shift(4, 0);
  o.write_shift(2, 0);
  return o;
}
function write_Guts(guts) {
  var o = new_buf(8);
  o.write_shift(4, 0);
  o.write_shift(2, guts[0] ? guts[0] + 1 : 0);
  o.write_shift(2, guts[1] ? guts[1] + 1 : 0);
  return o;
}
function write_BoolErr(R, C, v, os, opts, t) {
  var o = new_buf(8);
  write_XLSCell(R, C, os, o);
  write_Bes(v, t, o);
  return o;
}
function write_Number(R, C, v, os) {
  var o = new_buf(14);
  write_XLSCell(R, C, os, o);
  write_Xnum(v, o);
  return o;
}
function parse_ExternSheet(blob, length, opts) {
  if (opts.biff < 8) return parse_BIFF5ExternSheet(blob, length, opts);
  var o = [], target = blob.l + length, len = blob.read_shift(opts.biff > 8 ? 4 : 2);
  while (len-- !== 0) o.push(parse_XTI(blob, opts.biff > 8 ? 12 : 6, opts));
  if (blob.l != target) throw new Error("Bad ExternSheet: " + blob.l + " != " + target);
  return o;
}
function parse_BIFF5ExternSheet(blob, length, opts) {
  if (blob[blob.l + 1] == 3) blob[blob.l]++;
  var o = parse_ShortXLUnicodeString(blob, length, opts);
  return o.charCodeAt(0) == 3 ? o.slice(1) : o;
}
function write_MergeCells(merges) {
  var o = new_buf(2 + merges.length * 8);
  o.write_shift(2, merges.length);
  for (var i = 0; i < merges.length; ++i) write_Ref8U(merges[i], o);
  return o;
}
function write_HLink(hl) {
  var O = new_buf(24);
  var ref = decode_cell(hl[0]);
  O.write_shift(2, ref.r);
  O.write_shift(2, ref.r);
  O.write_shift(2, ref.c);
  O.write_shift(2, ref.c);
  var clsid = "d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" ");
  for (var i = 0; i < 16; ++i) O.write_shift(1, parseInt(clsid[i], 16));
  return bconcat([O, write_Hyperlink(hl[1])]);
}
function write_HLinkTooltip(hl) {
  var TT = hl[1].Tooltip;
  var O = new_buf(10 + 2 * (TT.length + 1));
  O.write_shift(2, 2048);
  var ref = decode_cell(hl[0]);
  O.write_shift(2, ref.r);
  O.write_shift(2, ref.r);
  O.write_shift(2, ref.c);
  O.write_shift(2, ref.c);
  for (var i = 0; i < TT.length; ++i) O.write_shift(2, TT.charCodeAt(i));
  O.write_shift(2, 0);
  return O;
}
function write_Country(o) {
  if (!o) o = new_buf(4);
  o.write_shift(2, 1);
  o.write_shift(2, 1);
  return o;
}
function parse_ColInfo(blob, length, opts) {
  if (!opts.cellStyles) return parsenoop(blob, length);
  var w = opts && opts.biff >= 12 ? 4 : 2;
  var colFirst = blob.read_shift(w);
  var colLast = blob.read_shift(w);
  var coldx = blob.read_shift(w);
  var ixfe = blob.read_shift(w);
  var flags = blob.read_shift(2);
  if (w == 2) blob.l += 2;
  var o = {
    s: colFirst,
    e: colLast,
    w: coldx,
    ixfe,
    flags
  };
  if (opts.biff >= 5 || !opts.biff) o.level = flags >> 8 & 7;
  return o;
}
function write_ColInfo(col, idx) {
  var o = new_buf(12);
  o.write_shift(2, idx);
  o.write_shift(2, idx);
  o.write_shift(2, col.width * 256);
  o.write_shift(2, 0);
  var f = 0;
  if (col.hidden) f |= 1;
  o.write_shift(1, f);
  f = col.level || 0;
  o.write_shift(1, f);
  o.write_shift(2, 0);
  return o;
}
function write_RRTabId(n) {
  var out = new_buf(2 * n);
  for (var i = 0; i < n; ++i) out.write_shift(2, i + 1);
  return out;
}
function write_BIFF2NUM(r, c, val) {
  var out = new_buf(15);
  write_BIFF2Cell(out, r, c);
  out.write_shift(8, val, "f");
  return out;
}
function write_BIFF2INT(r, c, val) {
  var out = new_buf(9);
  write_BIFF2Cell(out, r, c);
  out.write_shift(2, val);
  return out;
}
var DBF = /* @__PURE__ */ function() {
  var dbf_codepage_map = {
    /* Code Pages Supported by Visual FoxPro */
    /*::[*/
    1: 437,
    /*::[*/
    2: 850,
    /*::[*/
    3: 1252,
    /*::[*/
    4: 1e4,
    /*::[*/
    100: 852,
    /*::[*/
    101: 866,
    /*::[*/
    102: 865,
    /*::[*/
    103: 861,
    /*::[*/
    104: 895,
    /*::[*/
    105: 620,
    /*::[*/
    106: 737,
    /*::[*/
    107: 857,
    /*::[*/
    120: 950,
    /*::[*/
    121: 949,
    /*::[*/
    122: 936,
    /*::[*/
    123: 932,
    /*::[*/
    124: 874,
    /*::[*/
    125: 1255,
    /*::[*/
    126: 1256,
    /*::[*/
    150: 10007,
    /*::[*/
    151: 10029,
    /*::[*/
    152: 10006,
    /*::[*/
    200: 1250,
    /*::[*/
    201: 1251,
    /*::[*/
    202: 1254,
    /*::[*/
    203: 1253,
    /* shapefile DBF extension */
    /*::[*/
    0: 20127,
    /*::[*/
    8: 865,
    /*::[*/
    9: 437,
    /*::[*/
    10: 850,
    /*::[*/
    11: 437,
    /*::[*/
    13: 437,
    /*::[*/
    14: 850,
    /*::[*/
    15: 437,
    /*::[*/
    16: 850,
    /*::[*/
    17: 437,
    /*::[*/
    18: 850,
    /*::[*/
    19: 932,
    /*::[*/
    20: 850,
    /*::[*/
    21: 437,
    /*::[*/
    22: 850,
    /*::[*/
    23: 865,
    /*::[*/
    24: 437,
    /*::[*/
    25: 437,
    /*::[*/
    26: 850,
    /*::[*/
    27: 437,
    /*::[*/
    28: 863,
    /*::[*/
    29: 850,
    /*::[*/
    31: 852,
    /*::[*/
    34: 852,
    /*::[*/
    35: 852,
    /*::[*/
    36: 860,
    /*::[*/
    37: 850,
    /*::[*/
    38: 866,
    /*::[*/
    55: 850,
    /*::[*/
    64: 852,
    /*::[*/
    77: 936,
    /*::[*/
    78: 949,
    /*::[*/
    79: 950,
    /*::[*/
    80: 874,
    /*::[*/
    87: 1252,
    /*::[*/
    88: 1252,
    /*::[*/
    89: 1252,
    /*::[*/
    108: 863,
    /*::[*/
    134: 737,
    /*::[*/
    135: 852,
    /*::[*/
    136: 857,
    /*::[*/
    204: 1257,
    /*::[*/
    255: 16969
  };
  var dbf_reverse_map = evert({
    /*::[*/
    1: 437,
    /*::[*/
    2: 850,
    /*::[*/
    3: 1252,
    /*::[*/
    4: 1e4,
    /*::[*/
    100: 852,
    /*::[*/
    101: 866,
    /*::[*/
    102: 865,
    /*::[*/
    103: 861,
    /*::[*/
    104: 895,
    /*::[*/
    105: 620,
    /*::[*/
    106: 737,
    /*::[*/
    107: 857,
    /*::[*/
    120: 950,
    /*::[*/
    121: 949,
    /*::[*/
    122: 936,
    /*::[*/
    123: 932,
    /*::[*/
    124: 874,
    /*::[*/
    125: 1255,
    /*::[*/
    126: 1256,
    /*::[*/
    150: 10007,
    /*::[*/
    151: 10029,
    /*::[*/
    152: 10006,
    /*::[*/
    200: 1250,
    /*::[*/
    201: 1251,
    /*::[*/
    202: 1254,
    /*::[*/
    203: 1253,
    /*::[*/
    0: 20127
  });
  function dbf_to_aoa(buf, opts) {
    var out = [];
    var d = new_raw_buf(1);
    switch (opts.type) {
      case "base64":
        d = s2a(Base64_decode(buf));
        break;
      case "binary":
        d = s2a(buf);
        break;
      case "buffer":
      case "array":
        d = buf;
        break;
    }
    prep_blob(d, 0);
    var ft = d.read_shift(1);
    var memo = !!(ft & 136);
    var vfp = false, l7 = false;
    switch (ft) {
      case 2:
        break;
      // dBASE II
      case 3:
        break;
      // dBASE III
      case 48:
        vfp = true;
        memo = true;
        break;
      // VFP
      case 49:
        vfp = true;
        memo = true;
        break;
      // VFP with autoincrement
      // 0x43 dBASE IV SQL table files
      // 0x63 dBASE IV SQL system files
      case 131:
        break;
      // dBASE III with memo
      case 139:
        break;
      // dBASE IV with memo
      case 140:
        l7 = true;
        break;
      // dBASE Level 7 with memo
      // case 0xCB dBASE IV SQL table files with memo
      case 245:
        break;
      // FoxPro 2.x with memo
      // case 0xFB FoxBASE
      default:
        throw new Error("DBF Unsupported Version: " + ft.toString(16));
    }
    var nrow = 0, fpos = 521;
    if (ft == 2) nrow = d.read_shift(2);
    d.l += 3;
    if (ft != 2) nrow = d.read_shift(4);
    if (nrow > 1048576) nrow = 1e6;
    if (ft != 2) fpos = d.read_shift(2);
    var rlen = d.read_shift(2);
    var current_cp = opts.codepage || 1252;
    if (ft != 2) {
      d.l += 16;
      d.read_shift(1);
      if (d[d.l] !== 0) current_cp = dbf_codepage_map[d[d.l]];
      d.l += 1;
      d.l += 2;
    }
    if (l7) d.l += 36;
    var fields = [], field = {};
    var hend = Math.min(d.length, ft == 2 ? 521 : fpos - 10 - (vfp ? 264 : 0));
    var ww = l7 ? 32 : 11;
    while (d.l < hend && d[d.l] != 13) {
      field = {};
      field.name = $cptable.utils.decode(current_cp, d.slice(d.l, d.l + ww)).replace(/[\u0000\r\n].*$/g, "");
      d.l += ww;
      field.type = String.fromCharCode(d.read_shift(1));
      if (ft != 2 && !l7) field.offset = d.read_shift(4);
      field.len = d.read_shift(1);
      if (ft == 2) field.offset = d.read_shift(2);
      field.dec = d.read_shift(1);
      if (field.name.length) fields.push(field);
      if (ft != 2) d.l += l7 ? 13 : 14;
      switch (field.type) {
        case "B":
          if ((!vfp || field.len != 8) && opts.WTF) console.log("Skipping " + field.name + ":" + field.type);
          break;
        case "G":
        // General (FoxPro and dBASE L7)
        case "P":
          if (opts.WTF) console.log("Skipping " + field.name + ":" + field.type);
          break;
        case "+":
        // Autoincrement (dBASE L7 only)
        case "0":
        // _NullFlags (VFP only)
        case "@":
        // Timestamp (dBASE L7 only)
        case "C":
        // Character (dBASE II)
        case "D":
        // Date (dBASE III)
        case "F":
        // Float (dBASE IV)
        case "I":
        // Long (VFP and dBASE L7)
        case "L":
        // Logical (dBASE II)
        case "M":
        // Memo (dBASE III)
        case "N":
        // Number (dBASE II)
        case "O":
        // Double (dBASE L7 only)
        case "T":
        // Datetime (VFP only)
        case "Y":
          break;
        default:
          throw new Error("Unknown Field Type: " + field.type);
      }
    }
    if (d[d.l] !== 13) d.l = fpos - 1;
    if (d.read_shift(1) !== 13) throw new Error("DBF Terminator not found " + d.l + " " + d[d.l]);
    d.l = fpos;
    var R = 0, C = 0;
    out[0] = [];
    for (C = 0; C != fields.length; ++C) out[0][C] = fields[C].name;
    while (nrow-- > 0) {
      if (d[d.l] === 42) {
        d.l += rlen;
        continue;
      }
      ++d.l;
      out[++R] = [];
      C = 0;
      for (C = 0; C != fields.length; ++C) {
        var dd = d.slice(d.l, d.l + fields[C].len);
        d.l += fields[C].len;
        prep_blob(dd, 0);
        var s = $cptable.utils.decode(current_cp, dd);
        switch (fields[C].type) {
          case "C":
            if (s.trim().length) out[R][C] = s.replace(/\s+$/, "");
            break;
          case "D":
            if (s.length === 8) out[R][C] = new Date(+s.slice(0, 4), +s.slice(4, 6) - 1, +s.slice(6, 8));
            else out[R][C] = s;
            break;
          case "F":
            out[R][C] = parseFloat(s.trim());
            break;
          case "+":
          case "I":
            out[R][C] = l7 ? dd.read_shift(-4, "i") ^ 2147483648 : dd.read_shift(4, "i");
            break;
          case "L":
            switch (s.trim().toUpperCase()) {
              case "Y":
              case "T":
                out[R][C] = true;
                break;
              case "N":
              case "F":
                out[R][C] = false;
                break;
              case "":
              case "?":
                break;
              default:
                throw new Error("DBF Unrecognized L:|" + s + "|");
            }
            break;
          case "M":
            if (!memo) throw new Error("DBF Unexpected MEMO for type " + ft.toString(16));
            out[R][C] = "##MEMO##" + (l7 ? parseInt(s.trim(), 10) : dd.read_shift(4));
            break;
          case "N":
            s = s.replace(/\u0000/g, "").trim();
            if (s && s != ".") out[R][C] = +s || 0;
            break;
          case "@":
            out[R][C] = new Date(dd.read_shift(-8, "f") - 621356832e5);
            break;
          case "T":
            out[R][C] = new Date((dd.read_shift(4) - 2440588) * 864e5 + dd.read_shift(4));
            break;
          case "Y":
            out[R][C] = dd.read_shift(4, "i") / 1e4 + dd.read_shift(4, "i") / 1e4 * Math.pow(2, 32);
            break;
          case "O":
            out[R][C] = -dd.read_shift(-8, "f");
            break;
          case "B":
            if (vfp && fields[C].len == 8) {
              out[R][C] = dd.read_shift(8, "f");
              break;
            }
          /* falls through */
          case "G":
          case "P":
            dd.l += fields[C].len;
            break;
          case "0":
            if (fields[C].name === "_NullFlags") break;
          /* falls through */
          default:
            throw new Error("DBF Unsupported data type " + fields[C].type);
        }
      }
    }
    if (ft != 2) {
      if (d.l < d.length && d[d.l++] != 26) throw new Error("DBF EOF Marker missing " + (d.l - 1) + " of " + d.length + " " + d[d.l - 1].toString(16));
    }
    if (opts && opts.sheetRows) out = out.slice(0, opts.sheetRows);
    opts.DBF = fields;
    return out;
  }
  function dbf_to_sheet(buf, opts) {
    var o = opts || {};
    if (!o.dateNF) o.dateNF = "yyyymmdd";
    var ws = aoa_to_sheet(dbf_to_aoa(buf, o), o);
    ws["!cols"] = o.DBF.map(function(field) {
      return {
        wch: field.len,
        DBF: field
      };
    });
    delete o.DBF;
    return ws;
  }
  function dbf_to_workbook(buf, opts) {
    try {
      return sheet_to_workbook(dbf_to_sheet(buf, opts), opts);
    } catch (e) {
      if (opts && opts.WTF) throw e;
    }
    return {
      SheetNames: [],
      Sheets: {}
    };
  }
  var _RLEN = {
    "B": 8,
    "C": 250,
    "L": 1,
    "D": 8,
    "?": 0,
    "": 0
  };
  function sheet_to_dbf(ws, opts) {
    var o = opts || {};
    if (+o.codepage >= 0) set_cp(+o.codepage);
    if (o.type == "string") throw new Error("Cannot write DBF to JS string");
    var ba = buf_array();
    var aoa = sheet_to_json(ws, {
      header: 1,
      raw: true,
      cellDates: true
    });
    var headers = aoa[0], data = aoa.slice(1), cols = ws["!cols"] || [];
    var i = 0, j = 0, hcnt = 0, rlen = 1;
    for (i = 0; i < headers.length; ++i) {
      if (((cols[i] || {}).DBF || {}).name) {
        headers[i] = cols[i].DBF.name;
        ++hcnt;
        continue;
      }
      if (headers[i] == null) continue;
      ++hcnt;
      if (typeof headers[i] === "number") headers[i] = headers[i].toString(10);
      if (typeof headers[i] !== "string") throw new Error("DBF Invalid column name " + headers[i] + " |" + typeof headers[i] + "|");
      if (headers.indexOf(headers[i]) !== i) {
        for (j = 0; j < 1024; ++j) if (headers.indexOf(headers[i] + "_" + j) == -1) {
          headers[i] += "_" + j;
          break;
        }
      }
    }
    var range = safe_decode_range(ws["!ref"]);
    var coltypes = [];
    var colwidths = [];
    var coldecimals = [];
    for (i = 0; i <= range.e.c - range.s.c; ++i) {
      var guess = "", _guess = "", maxlen = 0;
      var col = [];
      for (j = 0; j < data.length; ++j) {
        if (data[j][i] != null) col.push(data[j][i]);
      }
      if (col.length == 0 || headers[i] == null) {
        coltypes[i] = "?";
        continue;
      }
      for (j = 0; j < col.length; ++j) {
        switch (typeof col[j]) {
          /* TODO: check if L2 compat is desired */
          case "number":
            _guess = "B";
            break;
          case "string":
            _guess = "C";
            break;
          case "boolean":
            _guess = "L";
            break;
          case "object":
            _guess = col[j] instanceof Date ? "D" : "C";
            break;
          default:
            _guess = "C";
        }
        maxlen = Math.max(maxlen, String(col[j]).length);
        guess = guess && guess != _guess ? "C" : _guess;
      }
      if (maxlen > 250) maxlen = 250;
      _guess = ((cols[i] || {}).DBF || {}).type;
      if (_guess == "C") {
        if (cols[i].DBF.len > maxlen) maxlen = cols[i].DBF.len;
      }
      if (guess == "B" && _guess == "N") {
        guess = "N";
        coldecimals[i] = cols[i].DBF.dec;
        maxlen = cols[i].DBF.len;
      }
      colwidths[i] = guess == "C" || _guess == "N" ? maxlen : _RLEN[guess] || 0;
      rlen += colwidths[i];
      coltypes[i] = guess;
    }
    var h = ba.next(32);
    h.write_shift(4, 318902576);
    h.write_shift(4, data.length);
    h.write_shift(2, 296 + 32 * hcnt);
    h.write_shift(2, rlen);
    for (i = 0; i < 4; ++i) h.write_shift(4, 0);
    h.write_shift(4, 0 | (+dbf_reverse_map[
      /*::String(*/
      current_ansi
      /*::)*/
    ] || 3) << 8);
    for (i = 0, j = 0; i < headers.length; ++i) {
      if (headers[i] == null) continue;
      var hf = ba.next(32);
      var _f = (headers[i].slice(-10) + "\0\0\0\0\0\0\0\0\0\0\0").slice(0, 11);
      hf.write_shift(1, _f, "sbcs");
      hf.write_shift(1, coltypes[i] == "?" ? "C" : coltypes[i], "sbcs");
      hf.write_shift(4, j);
      hf.write_shift(1, colwidths[i] || _RLEN[coltypes[i]] || 0);
      hf.write_shift(1, coldecimals[i] || 0);
      hf.write_shift(1, 2);
      hf.write_shift(4, 0);
      hf.write_shift(1, 0);
      hf.write_shift(4, 0);
      hf.write_shift(4, 0);
      j += colwidths[i] || _RLEN[coltypes[i]] || 0;
    }
    var hb = ba.next(264);
    hb.write_shift(4, 13);
    for (i = 0; i < 65; ++i) hb.write_shift(4, 0);
    for (i = 0; i < data.length; ++i) {
      var rout = ba.next(rlen);
      rout.write_shift(1, 0);
      for (j = 0; j < headers.length; ++j) {
        if (headers[j] == null) continue;
        switch (coltypes[j]) {
          case "L":
            rout.write_shift(1, data[i][j] == null ? 63 : data[i][j] ? 84 : 70);
            break;
          case "B":
            rout.write_shift(8, data[i][j] || 0, "f");
            break;
          case "N":
            var _n = "0";
            if (typeof data[i][j] == "number") _n = data[i][j].toFixed(coldecimals[j] || 0);
            for (hcnt = 0; hcnt < colwidths[j] - _n.length; ++hcnt) rout.write_shift(1, 32);
            rout.write_shift(1, _n, "sbcs");
            break;
          case "D":
            if (!data[i][j]) rout.write_shift(8, "00000000", "sbcs");
            else {
              rout.write_shift(4, ("0000" + data[i][j].getFullYear()).slice(-4), "sbcs");
              rout.write_shift(2, ("00" + (data[i][j].getMonth() + 1)).slice(-2), "sbcs");
              rout.write_shift(2, ("00" + data[i][j].getDate()).slice(-2), "sbcs");
            }
            break;
          case "C":
            var _s = String(data[i][j] != null ? data[i][j] : "").slice(0, colwidths[j]);
            rout.write_shift(1, _s, "sbcs");
            for (hcnt = 0; hcnt < colwidths[j] - _s.length; ++hcnt) rout.write_shift(1, 32);
            break;
        }
      }
    }
    ba.next(1).write_shift(1, 26);
    return ba.end();
  }
  return {
    to_workbook: dbf_to_workbook,
    to_sheet: dbf_to_sheet,
    from_sheet: sheet_to_dbf
  };
}();
var SYLK = /* @__PURE__ */ function() {
  var sylk_escapes = {
    AA: "\xC0",
    BA: "\xC1",
    CA: "\xC2",
    DA: 195,
    HA: "\xC4",
    JA: 197,
    AE: "\xC8",
    BE: "\xC9",
    CE: "\xCA",
    HE: "\xCB",
    AI: "\xCC",
    BI: "\xCD",
    CI: "\xCE",
    HI: "\xCF",
    AO: "\xD2",
    BO: "\xD3",
    CO: "\xD4",
    DO: 213,
    HO: "\xD6",
    AU: "\xD9",
    BU: "\xDA",
    CU: "\xDB",
    HU: "\xDC",
    Aa: "\xE0",
    Ba: "\xE1",
    Ca: "\xE2",
    Da: 227,
    Ha: "\xE4",
    Ja: 229,
    Ae: "\xE8",
    Be: "\xE9",
    Ce: "\xEA",
    He: "\xEB",
    Ai: "\xEC",
    Bi: "\xED",
    Ci: "\xEE",
    Hi: "\xEF",
    Ao: "\xF2",
    Bo: "\xF3",
    Co: "\xF4",
    Do: 245,
    Ho: "\xF6",
    Au: "\xF9",
    Bu: "\xFA",
    Cu: "\xFB",
    Hu: "\xFC",
    KC: "\xC7",
    Kc: "\xE7",
    q: "\xE6",
    z: "\u0153",
    a: "\xC6",
    j: "\u0152",
    DN: 209,
    Dn: 241,
    Hy: 255,
    S: 169,
    c: 170,
    R: 174,
    "B ": 180,
    /*::[*/
    0: 176,
    /*::[*/
    1: 177,
    /*::[*/
    2: 178,
    /*::[*/
    3: 179,
    /*::[*/
    5: 181,
    /*::[*/
    6: 182,
    /*::[*/
    7: 183,
    Q: 185,
    k: 186,
    b: 208,
    i: 216,
    l: 222,
    s: 240,
    y: 248,
    "!": 161,
    '"': 162,
    "#": 163,
    "(": 164,
    "%": 165,
    "'": 167,
    "H ": 168,
    "+": 171,
    ";": 187,
    "<": 188,
    "=": 189,
    ">": 190,
    "?": 191,
    "{": 223
  };
  var sylk_char_regex = new RegExp("\x1BN(" + keys(sylk_escapes).join("|").replace(/\|\|\|/, "|\\||").replace(/([?()+])/g, "\\$1") + "|\\|)", "gm");
  var sylk_char_fn = function(_, $1) {
    var o = sylk_escapes[$1];
    return typeof o == "number" ? _getansi(o) : o;
  };
  var decode_sylk_char = function($$, $1, $2) {
    var newcc = $1.charCodeAt(0) - 32 << 4 | $2.charCodeAt(0) - 48;
    return newcc == 59 ? $$ : _getansi(newcc);
  };
  sylk_escapes["|"] = 254;
  function sylk_to_aoa(d, opts) {
    switch (opts.type) {
      case "base64":
        return sylk_to_aoa_str(Base64_decode(d), opts);
      case "binary":
        return sylk_to_aoa_str(d, opts);
      case "buffer":
        return sylk_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString("binary") : a2s(d), opts);
      case "array":
        return sylk_to_aoa_str(cc2str(d), opts);
    }
    throw new Error("Unrecognized type " + opts.type);
  }
  function sylk_to_aoa_str(str, opts) {
    var records = str.split(/[\n\r]+/), R = -1, C = -1, ri = 0, rj = 0, arr = [];
    var formats = [];
    var next_cell_format = null;
    var sht = {}, rowinfo = [], colinfo = [], cw = [];
    var Mval = 0, j;
    if (+opts.codepage >= 0) set_cp(+opts.codepage);
    for (; ri !== records.length; ++ri) {
      Mval = 0;
      var rstr = records[ri].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g, decode_sylk_char).replace(sylk_char_regex, sylk_char_fn);
      var record = rstr.replace(/;;/g, "\0").split(";").map(function(x) {
        return x.replace(/\u0000/g, ";");
      });
      var RT = record[0], val;
      if (rstr.length > 0) switch (RT) {
        case "ID":
          break;
        /* header */
        case "E":
          break;
        /* EOF */
        case "B":
          break;
        /* dimensions */
        case "O":
          break;
        /* options? */
        case "W":
          break;
        /* window? */
        case "P":
          if (record[1].charAt(0) == "P") formats.push(rstr.slice(3).replace(/;;/g, ";"));
          break;
        case "C":
          var C_seen_K = false, C_seen_X = false, C_seen_S = false, C_seen_E = false, _R = -1, _C = -1;
          for (rj = 1; rj < record.length; ++rj) switch (record[rj].charAt(0)) {
            case "A":
              break;
            // TODO: comment
            case "X":
              C = parseInt(record[rj].slice(1)) - 1;
              C_seen_X = true;
              break;
            case "Y":
              R = parseInt(record[rj].slice(1)) - 1;
              if (!C_seen_X) C = 0;
              for (j = arr.length; j <= R; ++j) arr[j] = [];
              break;
            case "K":
              val = record[rj].slice(1);
              if (val.charAt(0) === '"') val = val.slice(1, val.length - 1);
              else if (val === "TRUE") val = true;
              else if (val === "FALSE") val = false;
              else if (!isNaN(fuzzynum(val))) {
                val = fuzzynum(val);
                if (next_cell_format !== null && fmt_is_date(next_cell_format)) val = numdate(val);
              } else if (!isNaN(fuzzydate(val).getDate())) {
                val = parseDate(val);
              }
              if (typeof $cptable !== "undefined" && typeof val == "string" && (opts || {}).type != "string" && (opts || {}).codepage) val = $cptable.utils.decode(opts.codepage, val);
              C_seen_K = true;
              break;
            case "E":
              C_seen_E = true;
              var formula = rc_to_a1(record[rj].slice(1), {
                r: R,
                c: C
              });
              arr[R][C] = [arr[R][C], formula];
              break;
            case "S":
              C_seen_S = true;
              arr[R][C] = [arr[R][C], "S5S"];
              break;
            case "G":
              break;
            // unknown
            case "R":
              _R = parseInt(record[rj].slice(1)) - 1;
              break;
            case "C":
              _C = parseInt(record[rj].slice(1)) - 1;
              break;
            default:
              if (opts && opts.WTF) throw new Error("SYLK bad record " + rstr);
          }
          if (C_seen_K) {
            if (arr[R][C] && arr[R][C].length == 2) arr[R][C][0] = val;
            else arr[R][C] = val;
            next_cell_format = null;
          }
          if (C_seen_S) {
            if (C_seen_E) throw new Error("SYLK shared formula cannot have own formula");
            var shrbase = _R > -1 && arr[_R][_C];
            if (!shrbase || !shrbase[1]) throw new Error("SYLK shared formula cannot find base");
            arr[R][C][1] = shift_formula_str(shrbase[1], {
              r: R - _R,
              c: C - _C
            });
          }
          break;
        case "F":
          var F_seen = 0;
          for (rj = 1; rj < record.length; ++rj) switch (record[rj].charAt(0)) {
            case "X":
              C = parseInt(record[rj].slice(1)) - 1;
              ++F_seen;
              break;
            case "Y":
              R = parseInt(record[rj].slice(1)) - 1;
              for (j = arr.length; j <= R; ++j) arr[j] = [];
              break;
            case "M":
              Mval = parseInt(record[rj].slice(1)) / 20;
              break;
            case "F":
              break;
            /* ??? */
            case "G":
              break;
            /* hide grid */
            case "P":
              next_cell_format = formats[parseInt(record[rj].slice(1))];
              break;
            case "S":
              break;
            /* cell style */
            case "D":
              break;
            /* column */
            case "N":
              break;
            /* font */
            case "W":
              cw = record[rj].slice(1).split(" ");
              for (j = parseInt(cw[0], 10); j <= parseInt(cw[1], 10); ++j) {
                Mval = parseInt(cw[2], 10);
                colinfo[j - 1] = Mval === 0 ? {
                  hidden: true
                } : {
                  wch: Mval
                };
                process_col(colinfo[j - 1]);
              }
              break;
            case "C":
              C = parseInt(record[rj].slice(1)) - 1;
              if (!colinfo[C]) colinfo[C] = {};
              break;
            case "R":
              R = parseInt(record[rj].slice(1)) - 1;
              if (!rowinfo[R]) rowinfo[R] = {};
              if (Mval > 0) {
                rowinfo[R].hpt = Mval;
                rowinfo[R].hpx = pt2px(Mval);
              } else if (Mval === 0) rowinfo[R].hidden = true;
              break;
            default:
              if (opts && opts.WTF) throw new Error("SYLK bad record " + rstr);
          }
          if (F_seen < 1) next_cell_format = null;
          break;
        default:
          if (opts && opts.WTF) throw new Error("SYLK bad record " + rstr);
      }
    }
    if (rowinfo.length > 0) sht["!rows"] = rowinfo;
    if (colinfo.length > 0) sht["!cols"] = colinfo;
    if (opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);
    return [arr, sht];
  }
  function sylk_to_sheet(d, opts) {
    var aoasht = sylk_to_aoa(d, opts);
    var aoa = aoasht[0], ws = aoasht[1];
    var o = aoa_to_sheet(aoa, opts);
    keys(ws).forEach(function(k) {
      o[k] = ws[k];
    });
    return o;
  }
  function sylk_to_workbook(d, opts) {
    return sheet_to_workbook(sylk_to_sheet(d, opts), opts);
  }
  function write_ws_cell_sylk(cell, ws, R, C) {
    var o = "C;Y" + (R + 1) + ";X" + (C + 1) + ";K";
    switch (cell.t) {
      case "n":
        o += cell.v || 0;
        if (cell.f && !cell.F) o += ";E" + a1_to_rc(cell.f, {
          r: R,
          c: C
        });
        break;
      case "b":
        o += cell.v ? "TRUE" : "FALSE";
        break;
      case "e":
        o += cell.w || cell.v;
        break;
      case "d":
        o += '"' + (cell.w || cell.v) + '"';
        break;
      case "s":
        o += '"' + cell.v.replace(/"/g, "").replace(/;/g, ";;") + '"';
        break;
    }
    return o;
  }
  function write_ws_cols_sylk(out, cols) {
    cols.forEach(function(col, i) {
      var rec = "F;W" + (i + 1) + " " + (i + 1) + " ";
      if (col.hidden) rec += "0";
      else {
        if (typeof col.width == "number" && !col.wpx) col.wpx = width2px(col.width);
        if (typeof col.wpx == "number" && !col.wch) col.wch = px2char(col.wpx);
        if (typeof col.wch == "number") rec += Math.round(col.wch);
      }
      if (rec.charAt(rec.length - 1) != " ") out.push(rec);
    });
  }
  function write_ws_rows_sylk(out, rows) {
    rows.forEach(function(row, i) {
      var rec = "F;";
      if (row.hidden) rec += "M0;";
      else if (row.hpt) rec += "M" + 20 * row.hpt + ";";
      else if (row.hpx) rec += "M" + 20 * px2pt(row.hpx) + ";";
      if (rec.length > 2) out.push(rec + "R" + (i + 1));
    });
  }
  function sheet_to_sylk(ws, opts) {
    var preamble = ["ID;PWXL;N;E"], o = [];
    var r = safe_decode_range(ws["!ref"]), cell;
    var dense = Array.isArray(ws);
    var RS = "\r\n";
    preamble.push("P;PGeneral");
    preamble.push("F;P0;DG0G8;M255");
    if (ws["!cols"]) write_ws_cols_sylk(preamble, ws["!cols"]);
    if (ws["!rows"]) write_ws_rows_sylk(preamble, ws["!rows"]);
    preamble.push("B;Y" + (r.e.r - r.s.r + 1) + ";X" + (r.e.c - r.s.c + 1) + ";D" + [r.s.c, r.s.r, r.e.c, r.e.r].join(" "));
    for (var R = r.s.r; R <= r.e.r; ++R) {
      for (var C = r.s.c; C <= r.e.c; ++C) {
        var coord = encode_cell({
          r: R,
          c: C
        });
        cell = dense ? (ws[R] || [])[C] : ws[coord];
        if (!cell || cell.v == null && (!cell.f || cell.F)) continue;
        o.push(write_ws_cell_sylk(cell, ws, R, C, opts));
      }
    }
    return preamble.join(RS) + RS + o.join(RS) + RS + "E" + RS;
  }
  return {
    to_workbook: sylk_to_workbook,
    to_sheet: sylk_to_sheet,
    from_sheet: sheet_to_sylk
  };
}();
var DIF = /* @__PURE__ */ function() {
  function dif_to_aoa(d, opts) {
    switch (opts.type) {
      case "base64":
        return dif_to_aoa_str(Base64_decode(d), opts);
      case "binary":
        return dif_to_aoa_str(d, opts);
      case "buffer":
        return dif_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString("binary") : a2s(d), opts);
      case "array":
        return dif_to_aoa_str(cc2str(d), opts);
    }
    throw new Error("Unrecognized type " + opts.type);
  }
  function dif_to_aoa_str(str, opts) {
    var records = str.split("\n"), R = -1, C = -1, ri = 0, arr = [];
    for (; ri !== records.length; ++ri) {
      if (records[ri].trim() === "BOT") {
        arr[++R] = [];
        C = 0;
        continue;
      }
      if (R < 0) continue;
      var metadata = records[ri].trim().split(",");
      var type = metadata[0], value = metadata[1];
      ++ri;
      var data = records[ri] || "";
      while ((data.match(/["]/g) || []).length & 1 && ri < records.length - 1) data += "\n" + records[++ri];
      data = data.trim();
      switch (+type) {
        case -1:
          if (data === "BOT") {
            arr[++R] = [];
            C = 0;
            continue;
          } else if (data !== "EOD") throw new Error("Unrecognized DIF special command " + data);
          break;
        case 0:
          if (data === "TRUE") arr[R][C] = true;
          else if (data === "FALSE") arr[R][C] = false;
          else if (!isNaN(fuzzynum(value))) arr[R][C] = fuzzynum(value);
          else if (!isNaN(fuzzydate(value).getDate())) arr[R][C] = parseDate(value);
          else arr[R][C] = value;
          ++C;
          break;
        case 1:
          data = data.slice(1, data.length - 1);
          data = data.replace(/""/g, '"');
          if (DIF_XL && data && data.match(/^=".*"$/)) data = data.slice(2, -1);
          arr[R][C++] = data !== "" ? data : null;
          break;
      }
      if (data === "EOD") break;
    }
    if (opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);
    return arr;
  }
  function dif_to_sheet(str, opts) {
    return aoa_to_sheet(dif_to_aoa(str, opts), opts);
  }
  function dif_to_workbook(str, opts) {
    return sheet_to_workbook(dif_to_sheet(str, opts), opts);
  }
  var sheet_to_dif = /* @__PURE__ */ function() {
    var push_field = function pf(o, topic, v, n, s) {
      o.push(topic);
      o.push(v + "," + n);
      o.push('"' + s.replace(/"/g, '""') + '"');
    };
    var push_value = function po(o, type, v, s) {
      o.push(type + "," + v);
      o.push(type == 1 ? '"' + s.replace(/"/g, '""') + '"' : s);
    };
    return function sheet_to_dif2(ws) {
      var o = [];
      var r = safe_decode_range(ws["!ref"]), cell;
      var dense = Array.isArray(ws);
      push_field(o, "TABLE", 0, 1, "sheetjs");
      push_field(o, "VECTORS", 0, r.e.r - r.s.r + 1, "");
      push_field(o, "TUPLES", 0, r.e.c - r.s.c + 1, "");
      push_field(o, "DATA", 0, 0, "");
      for (var R = r.s.r; R <= r.e.r; ++R) {
        push_value(o, -1, 0, "BOT");
        for (var C = r.s.c; C <= r.e.c; ++C) {
          var coord = encode_cell({
            r: R,
            c: C
          });
          cell = dense ? (ws[R] || [])[C] : ws[coord];
          if (!cell) {
            push_value(o, 1, 0, "");
            continue;
          }
          switch (cell.t) {
            case "n":
              var val = DIF_XL ? cell.w : cell.v;
              if (!val && cell.v != null) val = cell.v;
              if (val == null) {
                if (DIF_XL && cell.f && !cell.F) push_value(o, 1, 0, "=" + cell.f);
                else push_value(o, 1, 0, "");
              } else push_value(o, 0, val, "V");
              break;
            case "b":
              push_value(o, 0, cell.v ? 1 : 0, cell.v ? "TRUE" : "FALSE");
              break;
            case "s":
              push_value(o, 1, 0, !DIF_XL || isNaN(cell.v) ? cell.v : '="' + cell.v + '"');
              break;
            case "d":
              if (!cell.w) cell.w = SSF_format(cell.z || table_fmt[14], datenum(parseDate(cell.v)));
              if (DIF_XL) push_value(o, 0, cell.w, "V");
              else push_value(o, 1, 0, cell.w);
              break;
            default:
              push_value(o, 1, 0, "");
          }
        }
      }
      push_value(o, -1, 0, "EOD");
      var RS = "\r\n";
      var oo = o.join(RS);
      return oo;
    };
  }();
  return {
    to_workbook: dif_to_workbook,
    to_sheet: dif_to_sheet,
    from_sheet: sheet_to_dif
  };
}();
var ETH = /* @__PURE__ */ function() {
  function decode(s) {
    return s.replace(/\\b/g, "\\").replace(/\\c/g, ":").replace(/\\n/g, "\n");
  }
  function encode(s) {
    return s.replace(/\\/g, "\\b").replace(/:/g, "\\c").replace(/\n/g, "\\n");
  }
  function eth_to_aoa(str, opts) {
    var records = str.split("\n"), R = -1, C = -1, ri = 0, arr = [];
    for (; ri !== records.length; ++ri) {
      var record = records[ri].trim().split(":");
      if (record[0] !== "cell") continue;
      var addr = decode_cell(record[1]);
      if (arr.length <= addr.r) {
        for (R = arr.length; R <= addr.r; ++R) if (!arr[R]) arr[R] = [];
      }
      R = addr.r;
      C = addr.c;
      switch (record[2]) {
        case "t":
          arr[R][C] = decode(record[3]);
          break;
        case "v":
          arr[R][C] = +record[3];
          break;
        case "vtf":
          var _f = record[record.length - 1];
        /* falls through */
        case "vtc":
          switch (record[3]) {
            case "nl":
              arr[R][C] = +record[4] ? true : false;
              break;
            default:
              arr[R][C] = +record[4];
              break;
          }
          if (record[2] == "vtf") arr[R][C] = [arr[R][C], _f];
      }
    }
    if (opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);
    return arr;
  }
  function eth_to_sheet(d, opts) {
    return aoa_to_sheet(eth_to_aoa(d, opts), opts);
  }
  function eth_to_workbook(d, opts) {
    return sheet_to_workbook(eth_to_sheet(d, opts), opts);
  }
  var header = ["socialcalc:version:1.5", "MIME-Version: 1.0", "Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n");
  var sep = ["--SocialCalcSpreadsheetControlSave", "Content-type: text/plain; charset=UTF-8"].join("\n") + "\n";
  var meta = ["# SocialCalc Spreadsheet Control Save", "part:sheet"].join("\n");
  var end = "--SocialCalcSpreadsheetControlSave--";
  function sheet_to_eth_data(ws) {
    if (!ws || !ws["!ref"]) return "";
    var o = [], oo = [], cell, coord = "";
    var r = decode_range(ws["!ref"]);
    var dense = Array.isArray(ws);
    for (var R = r.s.r; R <= r.e.r; ++R) {
      for (var C = r.s.c; C <= r.e.c; ++C) {
        coord = encode_cell({
          r: R,
          c: C
        });
        cell = dense ? (ws[R] || [])[C] : ws[coord];
        if (!cell || cell.v == null || cell.t === "z") continue;
        oo = ["cell", coord, "t"];
        switch (cell.t) {
          case "s":
          case "str":
            oo.push(encode(cell.v));
            break;
          case "n":
            if (!cell.f) {
              oo[2] = "v";
              oo[3] = cell.v;
            } else {
              oo[2] = "vtf";
              oo[3] = "n";
              oo[4] = cell.v;
              oo[5] = encode(cell.f);
            }
            break;
          case "b":
            oo[2] = "vt" + (cell.f ? "f" : "c");
            oo[3] = "nl";
            oo[4] = cell.v ? "1" : "0";
            oo[5] = encode(cell.f || (cell.v ? "TRUE" : "FALSE"));
            break;
          case "d":
            var t = datenum(parseDate(cell.v));
            oo[2] = "vtc";
            oo[3] = "nd";
            oo[4] = "" + t;
            oo[5] = cell.w || SSF_format(cell.z || table_fmt[14], t);
            break;
          case "e":
            continue;
        }
        o.push(oo.join(":"));
      }
    }
    o.push("sheet:c:" + (r.e.c - r.s.c + 1) + ":r:" + (r.e.r - r.s.r + 1) + ":tvf:1");
    o.push("valueformat:1:text-wiki");
    return o.join("\n");
  }
  function sheet_to_eth(ws) {
    return [header, sep, meta, sep, sheet_to_eth_data(ws), end].join("\n");
  }
  return {
    to_workbook: eth_to_workbook,
    to_sheet: eth_to_sheet,
    from_sheet: sheet_to_eth
  };
}();
var PRN = /* @__PURE__ */ function() {
  function set_text_arr(data, arr, R, C, o) {
    if (o.raw) arr[R][C] = data;
    else if (data === "") {
    } else if (data === "TRUE") arr[R][C] = true;
    else if (data === "FALSE") arr[R][C] = false;
    else if (!isNaN(fuzzynum(data))) arr[R][C] = fuzzynum(data);
    else if (!isNaN(fuzzydate(data).getDate())) arr[R][C] = parseDate(data);
    else arr[R][C] = data;
  }
  function prn_to_aoa_str(f, opts) {
    var o = opts || {};
    var arr = [];
    if (!f || f.length === 0) return arr;
    var lines = f.split(/[\r\n]/);
    var L = lines.length - 1;
    while (L >= 0 && lines[L].length === 0) --L;
    var start = 10, idx = 0;
    var R = 0;
    for (; R <= L; ++R) {
      idx = lines[R].indexOf(" ");
      if (idx == -1) idx = lines[R].length;
      else idx++;
      start = Math.max(start, idx);
    }
    for (R = 0; R <= L; ++R) {
      arr[R] = [];
      var C = 0;
      set_text_arr(lines[R].slice(0, start).trim(), arr, R, C, o);
      for (C = 1; C <= (lines[R].length - start) / 10 + 1; ++C) set_text_arr(lines[R].slice(start + (C - 1) * 10, start + C * 10).trim(), arr, R, C, o);
    }
    if (o.sheetRows) arr = arr.slice(0, o.sheetRows);
    return arr;
  }
  var guess_seps = {
    /*::[*/
    44: ",",
    /*::[*/
    9: "	",
    /*::[*/
    59: ";",
    /*::[*/
    124: "|"
  };
  var guess_sep_weights = {
    /*::[*/
    44: 3,
    /*::[*/
    9: 2,
    /*::[*/
    59: 1,
    /*::[*/
    124: 0
  };
  function guess_sep(str) {
    var cnt = {}, instr = false, end = 0, cc = 0;
    for (; end < str.length; ++end) {
      if ((cc = str.charCodeAt(end)) == 34) instr = !instr;
      else if (!instr && cc in guess_seps) cnt[cc] = (cnt[cc] || 0) + 1;
    }
    cc = [];
    for (end in cnt) if (Object.prototype.hasOwnProperty.call(cnt, end)) {
      cc.push([cnt[end], end]);
    }
    if (!cc.length) {
      cnt = guess_sep_weights;
      for (end in cnt) if (Object.prototype.hasOwnProperty.call(cnt, end)) {
        cc.push([cnt[end], end]);
      }
    }
    cc.sort(function(a, b) {
      return a[0] - b[0] || guess_sep_weights[a[1]] - guess_sep_weights[b[1]];
    });
    return guess_seps[cc.pop()[1]] || 44;
  }
  function dsv_to_sheet_str(str, opts) {
    var o = opts || {};
    var sep = "";
    if (DENSE != null && o.dense == null) o.dense = DENSE;
    var ws = o.dense ? [] : {};
    var range = {
      s: {
        c: 0,
        r: 0
      },
      e: {
        c: 0,
        r: 0
      }
    };
    if (str.slice(0, 4) == "sep=") {
      if (str.charCodeAt(5) == 13 && str.charCodeAt(6) == 10) {
        sep = str.charAt(4);
        str = str.slice(7);
      } else if (str.charCodeAt(5) == 13 || str.charCodeAt(5) == 10) {
        sep = str.charAt(4);
        str = str.slice(6);
      } else sep = guess_sep(str.slice(0, 1024));
    } else if (o && o.FS) sep = o.FS;
    else sep = guess_sep(str.slice(0, 1024));
    var R = 0, C = 0, v = 0;
    var start = 0, end = 0, sepcc = sep.charCodeAt(0), instr = false, cc = 0, startcc = str.charCodeAt(0);
    str = str.replace(/\r\n/mg, "\n");
    var _re = o.dateNF != null ? dateNF_regex(o.dateNF) : null;
    function finish_cell() {
      var s = str.slice(start, end);
      var cell = {};
      if (s.charAt(0) == '"' && s.charAt(s.length - 1) == '"') s = s.slice(1, -1).replace(/""/g, '"');
      if (s.length === 0) cell.t = "z";
      else if (o.raw) {
        cell.t = "s";
        cell.v = s;
      } else if (s.trim().length === 0) {
        cell.t = "s";
        cell.v = s;
      } else if (s.charCodeAt(0) == 61) {
        if (s.charCodeAt(1) == 34 && s.charCodeAt(s.length - 1) == 34) {
          cell.t = "s";
          cell.v = s.slice(2, -1).replace(/""/g, '"');
        } else if (fuzzyfmla(s)) {
          cell.t = "n";
          cell.f = s.slice(1);
        } else {
          cell.t = "s";
          cell.v = s;
        }
      } else if (s == "TRUE") {
        cell.t = "b";
        cell.v = true;
      } else if (s == "FALSE") {
        cell.t = "b";
        cell.v = false;
      } else if (!isNaN(v = fuzzynum(s))) {
        cell.t = "n";
        if (o.cellText !== false) cell.w = s;
        cell.v = v;
      } else if (!isNaN(fuzzydate(s).getDate()) || _re && s.match(_re)) {
        cell.z = o.dateNF || table_fmt[14];
        var k = 0;
        if (_re && s.match(_re)) {
          s = dateNF_fix(s, o.dateNF, s.match(_re) || []);
          k = 1;
        }
        if (o.cellDates) {
          cell.t = "d";
          cell.v = parseDate(s, k);
        } else {
          cell.t = "n";
          cell.v = datenum(parseDate(s, k));
        }
        if (o.cellText !== false) cell.w = SSF_format(cell.z, cell.v instanceof Date ? datenum(cell.v) : cell.v);
        if (!o.cellNF) delete cell.z;
      } else {
        cell.t = "s";
        cell.v = s;
      }
      if (cell.t == "z") {
      } else if (o.dense) {
        if (!ws[R]) ws[R] = [];
        ws[R][C] = cell;
      } else ws[encode_cell({
        c: C,
        r: R
      })] = cell;
      start = end + 1;
      startcc = str.charCodeAt(start);
      if (range.e.c < C) range.e.c = C;
      if (range.e.r < R) range.e.r = R;
      if (cc == sepcc) ++C;
      else {
        C = 0;
        ++R;
        if (o.sheetRows && o.sheetRows <= R) return true;
      }
    }
    outer: for (; end < str.length; ++end) switch (cc = str.charCodeAt(end)) {
      case 34:
        if (startcc === 34) instr = !instr;
        break;
      case sepcc:
      case 10:
      case 13:
        if (!instr && finish_cell()) break outer;
        break;
      default:
        break;
    }
    if (end - start > 0) finish_cell();
    ws["!ref"] = encode_range(range);
    return ws;
  }
  function prn_to_sheet_str(str, opts) {
    if (!(opts && opts.PRN)) return dsv_to_sheet_str(str, opts);
    if (opts.FS) return dsv_to_sheet_str(str, opts);
    if (str.slice(0, 4) == "sep=") return dsv_to_sheet_str(str, opts);
    if (str.indexOf("	") >= 0 || str.indexOf(",") >= 0 || str.indexOf(";") >= 0) return dsv_to_sheet_str(str, opts);
    return aoa_to_sheet(prn_to_aoa_str(str, opts), opts);
  }
  function prn_to_sheet(d, opts) {
    var str = "", bytes = opts.type == "string" ? [0, 0, 0, 0] : firstbyte(d, opts);
    switch (opts.type) {
      case "base64":
        str = Base64_decode(d);
        break;
      case "binary":
        str = d;
        break;
      case "buffer":
        if (opts.codepage == 65001) str = d.toString("utf8");
        else if (opts.codepage && typeof $cptable !== "undefined") str = $cptable.utils.decode(opts.codepage, d);
        else str = has_buf && Buffer.isBuffer(d) ? d.toString("binary") : a2s(d);
        break;
      case "array":
        str = cc2str(d);
        break;
      case "string":
        str = d;
        break;
      default:
        throw new Error("Unrecognized type " + opts.type);
    }
    if (bytes[0] == 239 && bytes[1] == 187 && bytes[2] == 191) str = utf8read(str.slice(3));
    else if (opts.type != "string" && opts.type != "buffer" && opts.codepage == 65001) str = utf8read(str);
    else if (opts.type == "binary" && typeof $cptable !== "undefined" && opts.codepage) str = $cptable.utils.decode(opts.codepage, $cptable.utils.encode(28591, str));
    if (str.slice(0, 19) == "socialcalc:version:") return ETH.to_sheet(opts.type == "string" ? str : utf8read(str), opts);
    return prn_to_sheet_str(str, opts);
  }
  function prn_to_workbook(d, opts) {
    return sheet_to_workbook(prn_to_sheet(d, opts), opts);
  }
  function sheet_to_prn(ws) {
    var o = [];
    var r = safe_decode_range(ws["!ref"]), cell;
    var dense = Array.isArray(ws);
    for (var R = r.s.r; R <= r.e.r; ++R) {
      var oo = [];
      for (var C = r.s.c; C <= r.e.c; ++C) {
        var coord = encode_cell({
          r: R,
          c: C
        });
        cell = dense ? (ws[R] || [])[C] : ws[coord];
        if (!cell || cell.v == null) {
          oo.push("          ");
          continue;
        }
        var w = (cell.w || (format_cell(cell), cell.w) || "").slice(0, 10);
        while (w.length < 10) w += " ";
        oo.push(w + (C === 0 ? " " : ""));
      }
      o.push(oo.join(""));
    }
    return o.join("\n");
  }
  return {
    to_workbook: prn_to_workbook,
    to_sheet: prn_to_sheet,
    from_sheet: sheet_to_prn
  };
}();
var WK_ = /* @__PURE__ */ function() {
  function lotushopper(data, cb, opts) {
    if (!data) return;
    prep_blob(data, data.l || 0);
    var Enum = opts.Enum || WK1Enum;
    while (data.l < data.length) {
      var RT = data.read_shift(2);
      var R = Enum[RT] || Enum[65535];
      var length = data.read_shift(2);
      var tgt = data.l + length;
      var d = R.f && R.f(data, length, opts);
      data.l = tgt;
      if (cb(d, R, RT)) return;
    }
  }
  function lotus_to_workbook(d, opts) {
    switch (opts.type) {
      case "base64":
        return lotus_to_workbook_buf(s2a(Base64_decode(d)), opts);
      case "binary":
        return lotus_to_workbook_buf(s2a(d), opts);
      case "buffer":
      case "array":
        return lotus_to_workbook_buf(d, opts);
    }
    throw "Unsupported type " + opts.type;
  }
  function lotus_to_workbook_buf(d, opts) {
    if (!d) return d;
    var o = opts || {};
    if (DENSE != null && o.dense == null) o.dense = DENSE;
    var s = o.dense ? [] : {}, n = "Sheet1", next_n = "", sidx = 0;
    var sheets = {}, snames = [], realnames = [];
    var refguess = {
      s: {
        r: 0,
        c: 0
      },
      e: {
        r: 0,
        c: 0
      }
    };
    var sheetRows = o.sheetRows || 0;
    if (d[2] == 0) {
      if (d[3] == 8 || d[3] == 9) {
        if (d.length >= 16 && d[14] == 5 && d[15] === 108) throw new Error("Unsupported Works 3 for Mac file");
      }
    }
    if (d[2] == 2) {
      o.Enum = WK1Enum;
      lotushopper(d, function(val, R, RT) {
        switch (RT) {
          case 0:
            o.vers = val;
            if (val >= 4096) o.qpro = true;
            break;
          case 6:
            refguess = val;
            break;
          /* RANGE */
          case 204:
            if (val) next_n = val;
            break;
          /* SHEETNAMECS */
          case 222:
            next_n = val;
            break;
          /* SHEETNAMELP */
          case 15:
          /* LABEL */
          case 51:
            if (!o.qpro) val[1].v = val[1].v.slice(1);
          /* falls through */
          case 13:
          /* INTEGER */
          case 14:
          /* NUMBER */
          case 16:
            if (RT == 14 && (val[2] & 112) == 112 && (val[2] & 15) > 1 && (val[2] & 15) < 15) {
              val[1].z = o.dateNF || table_fmt[14];
              if (o.cellDates) {
                val[1].t = "d";
                val[1].v = numdate(val[1].v);
              }
            }
            if (o.qpro) {
              if (val[3] > sidx) {
                s["!ref"] = encode_range(refguess);
                sheets[n] = s;
                snames.push(n);
                s = o.dense ? [] : {};
                refguess = {
                  s: {
                    r: 0,
                    c: 0
                  },
                  e: {
                    r: 0,
                    c: 0
                  }
                };
                sidx = val[3];
                n = next_n || "Sheet" + (sidx + 1);
                next_n = "";
              }
            }
            var tmpcell = o.dense ? (s[val[0].r] || [])[val[0].c] : s[encode_cell(val[0])];
            if (tmpcell) {
              tmpcell.t = val[1].t;
              tmpcell.v = val[1].v;
              if (val[1].z != null) tmpcell.z = val[1].z;
              if (val[1].f != null) tmpcell.f = val[1].f;
              break;
            }
            if (o.dense) {
              if (!s[val[0].r]) s[val[0].r] = [];
              s[val[0].r][val[0].c] = val[1];
            } else s[encode_cell(val[0])] = val[1];
            break;
          default:
        }
      }, o);
    } else if (d[2] == 26 || d[2] == 14) {
      o.Enum = WK3Enum;
      if (d[2] == 14) {
        o.qpro = true;
        d.l = 0;
      }
      lotushopper(d, function(val, R, RT) {
        switch (RT) {
          case 204:
            n = val;
            break;
          /* SHEETNAMECS */
          case 22:
            val[1].v = val[1].v.slice(1);
          /* falls through */
          case 23:
          /* NUMBER17 */
          case 24:
          /* NUMBER18 */
          case 25:
          /* FORMULA19 */
          case 37:
          /* NUMBER25 */
          case 39:
          /* NUMBER27 */
          case 40:
            if (val[3] > sidx) {
              s["!ref"] = encode_range(refguess);
              sheets[n] = s;
              snames.push(n);
              s = o.dense ? [] : {};
              refguess = {
                s: {
                  r: 0,
                  c: 0
                },
                e: {
                  r: 0,
                  c: 0
                }
              };
              sidx = val[3];
              n = "Sheet" + (sidx + 1);
            }
            if (sheetRows > 0 && val[0].r >= sheetRows) break;
            if (o.dense) {
              if (!s[val[0].r]) s[val[0].r] = [];
              s[val[0].r][val[0].c] = val[1];
            } else s[encode_cell(val[0])] = val[1];
            if (refguess.e.c < val[0].c) refguess.e.c = val[0].c;
            if (refguess.e.r < val[0].r) refguess.e.r = val[0].r;
            break;
          case 27:
            if (val[14e3]) realnames[val[14e3][0]] = val[14e3][1];
            break;
          case 1537:
            realnames[val[0]] = val[1];
            if (val[0] == sidx) n = val[1];
            break;
          default:
            break;
        }
      }, o);
    } else throw new Error("Unrecognized LOTUS BOF " + d[2]);
    s["!ref"] = encode_range(refguess);
    sheets[next_n || n] = s;
    snames.push(next_n || n);
    if (!realnames.length) return {
      SheetNames: snames,
      Sheets: sheets
    };
    var osheets = {}, rnames = [];
    for (var i = 0; i < realnames.length; ++i) if (sheets[snames[i]]) {
      rnames.push(realnames[i] || snames[i]);
      osheets[realnames[i]] = sheets[realnames[i]] || sheets[snames[i]];
    } else {
      rnames.push(realnames[i]);
      osheets[realnames[i]] = {
        "!ref": "A1"
      };
    }
    return {
      SheetNames: rnames,
      Sheets: osheets
    };
  }
  function sheet_to_wk1(ws, opts) {
    var o = opts || {};
    if (+o.codepage >= 0) set_cp(+o.codepage);
    if (o.type == "string") throw new Error("Cannot write WK1 to JS string");
    var ba = buf_array();
    var range = safe_decode_range(ws["!ref"]);
    var dense = Array.isArray(ws);
    var cols = [];
    write_biff_rec(ba, 0, write_BOF_WK1(1030));
    write_biff_rec(ba, 6, write_RANGE(range));
    var max_R = Math.min(range.e.r, 8191);
    for (var R = range.s.r; R <= max_R; ++R) {
      var rr = encode_row(R);
      for (var C = range.s.c; C <= range.e.c; ++C) {
        if (R === range.s.r) cols[C] = encode_col(C);
        var ref = cols[C] + rr;
        var cell = dense ? (ws[R] || [])[C] : ws[ref];
        if (!cell || cell.t == "z") continue;
        if (cell.t == "n") {
          if ((cell.v | 0) == cell.v && cell.v >= -32768 && cell.v <= 32767) write_biff_rec(ba, 13, write_INTEGER(R, C, cell.v));
          else write_biff_rec(ba, 14, write_NUMBER(R, C, cell.v));
        } else {
          var str = format_cell(cell);
          write_biff_rec(ba, 15, write_LABEL(R, C, str.slice(0, 239)));
        }
      }
    }
    write_biff_rec(ba, 1);
    return ba.end();
  }
  function book_to_wk3(wb, opts) {
    var o = opts || {};
    if (+o.codepage >= 0) set_cp(+o.codepage);
    if (o.type == "string") throw new Error("Cannot write WK3 to JS string");
    var ba = buf_array();
    write_biff_rec(ba, 0, write_BOF_WK3(wb));
    for (var i = 0, cnt = 0; i < wb.SheetNames.length; ++i) if ((wb.Sheets[wb.SheetNames[i]] || {})["!ref"]) write_biff_rec(ba, 27, write_XFORMAT_SHEETNAME(wb.SheetNames[i], cnt++));
    var wsidx = 0;
    for (i = 0; i < wb.SheetNames.length; ++i) {
      var ws = wb.Sheets[wb.SheetNames[i]];
      if (!ws || !ws["!ref"]) continue;
      var range = safe_decode_range(ws["!ref"]);
      var dense = Array.isArray(ws);
      var cols = [];
      var max_R = Math.min(range.e.r, 8191);
      for (var R = range.s.r; R <= max_R; ++R) {
        var rr = encode_row(R);
        for (var C = range.s.c; C <= range.e.c; ++C) {
          if (R === range.s.r) cols[C] = encode_col(C);
          var ref = cols[C] + rr;
          var cell = dense ? (ws[R] || [])[C] : ws[ref];
          if (!cell || cell.t == "z") continue;
          if (cell.t == "n") {
            write_biff_rec(ba, 23, write_NUMBER_17(R, C, wsidx, cell.v));
          } else {
            var str = format_cell(cell);
            write_biff_rec(ba, 22, write_LABEL_16(R, C, wsidx, str.slice(0, 239)));
          }
        }
      }
      ++wsidx;
    }
    write_biff_rec(ba, 1);
    return ba.end();
  }
  function write_BOF_WK1(v) {
    var out = new_buf(2);
    out.write_shift(2, v);
    return out;
  }
  function write_BOF_WK3(wb) {
    var out = new_buf(26);
    out.write_shift(2, 4096);
    out.write_shift(2, 4);
    out.write_shift(4, 0);
    var rows = 0, cols = 0, wscnt = 0;
    for (var i = 0; i < wb.SheetNames.length; ++i) {
      var name = wb.SheetNames[i];
      var ws = wb.Sheets[name];
      if (!ws || !ws["!ref"]) continue;
      ++wscnt;
      var range = decode_range(ws["!ref"]);
      if (rows < range.e.r) rows = range.e.r;
      if (cols < range.e.c) cols = range.e.c;
    }
    if (rows > 8191) rows = 8191;
    out.write_shift(2, rows);
    out.write_shift(1, wscnt);
    out.write_shift(1, cols);
    out.write_shift(2, 0);
    out.write_shift(2, 0);
    out.write_shift(1, 1);
    out.write_shift(1, 2);
    out.write_shift(4, 0);
    out.write_shift(4, 0);
    return out;
  }
  function parse_RANGE(blob, length, opts) {
    var o = {
      s: {
        c: 0,
        r: 0
      },
      e: {
        c: 0,
        r: 0
      }
    };
    if (length == 8 && opts.qpro) {
      o.s.c = blob.read_shift(1);
      blob.l++;
      o.s.r = blob.read_shift(2);
      o.e.c = blob.read_shift(1);
      blob.l++;
      o.e.r = blob.read_shift(2);
      return o;
    }
    o.s.c = blob.read_shift(2);
    o.s.r = blob.read_shift(2);
    if (length == 12 && opts.qpro) blob.l += 2;
    o.e.c = blob.read_shift(2);
    o.e.r = blob.read_shift(2);
    if (length == 12 && opts.qpro) blob.l += 2;
    if (o.s.c == 65535) o.s.c = o.e.c = o.s.r = o.e.r = 0;
    return o;
  }
  function write_RANGE(range) {
    var out = new_buf(8);
    out.write_shift(2, range.s.c);
    out.write_shift(2, range.s.r);
    out.write_shift(2, range.e.c);
    out.write_shift(2, range.e.r);
    return out;
  }
  function parse_cell(blob, length, opts) {
    var o = [{
      c: 0,
      r: 0
    }, {
      t: "n",
      v: 0
    }, 0, 0];
    if (opts.qpro && opts.vers != 20768) {
      o[0].c = blob.read_shift(1);
      o[3] = blob.read_shift(1);
      o[0].r = blob.read_shift(2);
      blob.l += 2;
    } else {
      o[2] = blob.read_shift(1);
      o[0].c = blob.read_shift(2);
      o[0].r = blob.read_shift(2);
    }
    return o;
  }
  function parse_LABEL(blob, length, opts) {
    var tgt = blob.l + length;
    var o = parse_cell(blob, length, opts);
    o[1].t = "s";
    if (opts.vers == 20768) {
      blob.l++;
      var len = blob.read_shift(1);
      o[1].v = blob.read_shift(len, "utf8");
      return o;
    }
    if (opts.qpro) blob.l++;
    o[1].v = blob.read_shift(tgt - blob.l, "cstr");
    return o;
  }
  function write_LABEL(R, C, s) {
    var o = new_buf(7 + s.length);
    o.write_shift(1, 255);
    o.write_shift(2, C);
    o.write_shift(2, R);
    o.write_shift(1, 39);
    for (var i = 0; i < o.length; ++i) {
      var cc = s.charCodeAt(i);
      o.write_shift(1, cc >= 128 ? 95 : cc);
    }
    o.write_shift(1, 0);
    return o;
  }
  function parse_INTEGER(blob, length, opts) {
    var o = parse_cell(blob, length, opts);
    o[1].v = blob.read_shift(2, "i");
    return o;
  }
  function write_INTEGER(R, C, v) {
    var o = new_buf(7);
    o.write_shift(1, 255);
    o.write_shift(2, C);
    o.write_shift(2, R);
    o.write_shift(2, v, "i");
    return o;
  }
  function parse_NUMBER(blob, length, opts) {
    var o = parse_cell(blob, length, opts);
    o[1].v = blob.read_shift(8, "f");
    return o;
  }
  function write_NUMBER(R, C, v) {
    var o = new_buf(13);
    o.write_shift(1, 255);
    o.write_shift(2, C);
    o.write_shift(2, R);
    o.write_shift(8, v, "f");
    return o;
  }
  function parse_FORMULA(blob, length, opts) {
    var tgt = blob.l + length;
    var o = parse_cell(blob, length, opts);
    o[1].v = blob.read_shift(8, "f");
    if (opts.qpro) blob.l = tgt;
    else {
      var flen = blob.read_shift(2);
      wk1_fmla_to_csf(blob.slice(blob.l, blob.l + flen), o);
      blob.l += flen;
    }
    return o;
  }
  function wk1_parse_rc(B, V, col) {
    var rel = V & 32768;
    V &= ~32768;
    V = (rel ? B : 0) + (V >= 8192 ? V - 16384 : V);
    return (rel ? "" : "$") + (col ? encode_col(V) : encode_row(V));
  }
  var FuncTab = {
    51: ["FALSE", 0],
    52: ["TRUE", 0],
    70: ["LEN", 1],
    80: ["SUM", 69],
    81: ["AVERAGEA", 69],
    82: ["COUNTA", 69],
    83: ["MINA", 69],
    84: ["MAXA", 69],
    111: ["T", 1]
  };
  var BinOpTab = [
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    // eslint-disable-line no-mixed-spaces-and-tabs
    "",
    "+",
    "-",
    "*",
    "/",
    "^",
    "=",
    "<>",
    // eslint-disable-line no-mixed-spaces-and-tabs
    "<=",
    ">=",
    "<",
    ">",
    "",
    "",
    "",
    "",
    // eslint-disable-line no-mixed-spaces-and-tabs
    "&",
    "",
    "",
    "",
    "",
    "",
    "",
    ""
    // eslint-disable-line no-mixed-spaces-and-tabs
  ];
  function wk1_fmla_to_csf(blob, o) {
    prep_blob(blob, 0);
    var out = [], argc = 0, R = "", C = "", argL = "", argR = "";
    while (blob.l < blob.length) {
      var cc = blob[blob.l++];
      switch (cc) {
        case 0:
          out.push(blob.read_shift(8, "f"));
          break;
        case 1:
          {
            C = wk1_parse_rc(o[0].c, blob.read_shift(2), true);
            R = wk1_parse_rc(o[0].r, blob.read_shift(2), false);
            out.push(C + R);
          }
          break;
        case 2:
          {
            var c = wk1_parse_rc(o[0].c, blob.read_shift(2), true);
            var r = wk1_parse_rc(o[0].r, blob.read_shift(2), false);
            C = wk1_parse_rc(o[0].c, blob.read_shift(2), true);
            R = wk1_parse_rc(o[0].r, blob.read_shift(2), false);
            out.push(c + r + ":" + C + R);
          }
          break;
        case 3:
          if (blob.l < blob.length) {
            console.error("WK1 premature formula end");
            return;
          }
          break;
        case 4:
          out.push("(" + out.pop() + ")");
          break;
        case 5:
          out.push(blob.read_shift(2));
          break;
        case 6:
          {
            var Z = "";
            while (cc = blob[blob.l++]) Z += String.fromCharCode(cc);
            out.push('"' + Z.replace(/"/g, '""') + '"');
          }
          break;
        case 8:
          out.push("-" + out.pop());
          break;
        case 23:
          out.push("+" + out.pop());
          break;
        case 22:
          out.push("NOT(" + out.pop() + ")");
          break;
        case 20:
        case 21:
          {
            argR = out.pop();
            argL = out.pop();
            out.push(["AND", "OR"][cc - 20] + "(" + argL + "," + argR + ")");
          }
          break;
        default:
          if (cc < 32 && BinOpTab[cc]) {
            argR = out.pop();
            argL = out.pop();
            out.push(argL + BinOpTab[cc] + argR);
          } else if (FuncTab[cc]) {
            argc = FuncTab[cc][1];
            if (argc == 69) argc = blob[blob.l++];
            if (argc > out.length) {
              console.error("WK1 bad formula parse 0x" + cc.toString(16) + ":|" + out.join("|") + "|");
              return;
            }
            var args = out.slice(-argc);
            out.length -= argc;
            out.push(FuncTab[cc][0] + "(" + args.join(",") + ")");
          } else if (cc <= 7) return console.error("WK1 invalid opcode " + cc.toString(16));
          else if (cc <= 24) return console.error("WK1 unsupported op " + cc.toString(16));
          else if (cc <= 30) return console.error("WK1 invalid opcode " + cc.toString(16));
          else if (cc <= 115) return console.error("WK1 unsupported function opcode " + cc.toString(16));
          else return console.error("WK1 unrecognized opcode " + cc.toString(16));
      }
    }
    if (out.length == 1) o[1].f = "" + out[0];
    else console.error("WK1 bad formula parse |" + out.join("|") + "|");
  }
  function parse_cell_3(blob) {
    var o = [{
      c: 0,
      r: 0
    }, {
      t: "n",
      v: 0
    }, 0];
    o[0].r = blob.read_shift(2);
    o[3] = blob[blob.l++];
    o[0].c = blob[blob.l++];
    return o;
  }
  function parse_LABEL_16(blob, length) {
    var o = parse_cell_3(blob, length);
    o[1].t = "s";
    o[1].v = blob.read_shift(length - 4, "cstr");
    return o;
  }
  function write_LABEL_16(R, C, wsidx, s) {
    var o = new_buf(6 + s.length);
    o.write_shift(2, R);
    o.write_shift(1, wsidx);
    o.write_shift(1, C);
    o.write_shift(1, 39);
    for (var i = 0; i < s.length; ++i) {
      var cc = s.charCodeAt(i);
      o.write_shift(1, cc >= 128 ? 95 : cc);
    }
    o.write_shift(1, 0);
    return o;
  }
  function parse_NUMBER_18(blob, length) {
    var o = parse_cell_3(blob, length);
    o[1].v = blob.read_shift(2);
    var v = o[1].v >> 1;
    if (o[1].v & 1) {
      switch (v & 7) {
        case 0:
          v = (v >> 3) * 5e3;
          break;
        case 1:
          v = (v >> 3) * 500;
          break;
        case 2:
          v = (v >> 3) / 20;
          break;
        case 3:
          v = (v >> 3) / 200;
          break;
        case 4:
          v = (v >> 3) / 2e3;
          break;
        case 5:
          v = (v >> 3) / 2e4;
          break;
        case 6:
          v = (v >> 3) / 16;
          break;
        case 7:
          v = (v >> 3) / 64;
          break;
      }
    }
    o[1].v = v;
    return o;
  }
  function parse_NUMBER_17(blob, length) {
    var o = parse_cell_3(blob, length);
    var v1 = blob.read_shift(4);
    var v2 = blob.read_shift(4);
    var e = blob.read_shift(2);
    if (e == 65535) {
      if (v1 === 0 && v2 === 3221225472) {
        o[1].t = "e";
        o[1].v = 15;
      } else if (v1 === 0 && v2 === 3489660928) {
        o[1].t = "e";
        o[1].v = 42;
      } else o[1].v = 0;
      return o;
    }
    var s = e & 32768;
    e = (e & 32767) - 16446;
    o[1].v = (1 - s * 2) * (v2 * Math.pow(2, e + 32) + v1 * Math.pow(2, e));
    return o;
  }
  function write_NUMBER_17(R, C, wsidx, v) {
    var o = new_buf(14);
    o.write_shift(2, R);
    o.write_shift(1, wsidx);
    o.write_shift(1, C);
    if (v == 0) {
      o.write_shift(4, 0);
      o.write_shift(4, 0);
      o.write_shift(2, 65535);
      return o;
    }
    var s = 0, e = 0, v1 = 0, v2 = 0;
    if (v < 0) {
      s = 1;
      v = -v;
    }
    e = Math.log2(v) | 0;
    v /= Math.pow(2, e - 31);
    v2 = v >>> 0;
    if ((v2 & 2147483648) == 0) {
      v /= 2;
      ++e;
      v2 = v >>> 0;
    }
    v -= v2;
    v2 |= 2147483648;
    v2 >>>= 0;
    v *= Math.pow(2, 32);
    v1 = v >>> 0;
    o.write_shift(4, v1);
    o.write_shift(4, v2);
    e += 16383 + (s ? 32768 : 0);
    o.write_shift(2, e);
    return o;
  }
  function parse_FORMULA_19(blob, length) {
    var o = parse_NUMBER_17(blob, 14);
    blob.l += length - 14;
    return o;
  }
  function parse_NUMBER_25(blob, length) {
    var o = parse_cell_3(blob, length);
    var v1 = blob.read_shift(4);
    o[1].v = v1 >> 6;
    return o;
  }
  function parse_NUMBER_27(blob, length) {
    var o = parse_cell_3(blob, length);
    var v1 = blob.read_shift(8, "f");
    o[1].v = v1;
    return o;
  }
  function parse_FORMULA_28(blob, length) {
    var o = parse_NUMBER_27(blob, 14);
    blob.l += length - 10;
    return o;
  }
  function parse_SHEETNAMECS(blob, length) {
    return blob[blob.l + length - 1] == 0 ? blob.read_shift(length, "cstr") : "";
  }
  function parse_SHEETNAMELP(blob, length) {
    var len = blob[blob.l++];
    if (len > length - 1) len = length - 1;
    var o = "";
    while (o.length < len) o += String.fromCharCode(blob[blob.l++]);
    return o;
  }
  function parse_SHEETINFOQP(blob, length, opts) {
    if (!opts.qpro || length < 21) return;
    var id = blob.read_shift(1);
    blob.l += 17;
    blob.l += 1;
    blob.l += 2;
    var nm = blob.read_shift(length - 21, "cstr");
    return [id, nm];
  }
  function parse_XFORMAT(blob, length) {
    var o = {}, tgt = blob.l + length;
    while (blob.l < tgt) {
      var dt = blob.read_shift(2);
      if (dt == 14e3) {
        o[dt] = [0, ""];
        o[dt][0] = blob.read_shift(2);
        while (blob[blob.l]) {
          o[dt][1] += String.fromCharCode(blob[blob.l]);
          blob.l++;
        }
        blob.l++;
      }
    }
    return o;
  }
  function write_XFORMAT_SHEETNAME(name, wsidx) {
    var out = new_buf(5 + name.length);
    out.write_shift(2, 14e3);
    out.write_shift(2, wsidx);
    for (var i = 0; i < name.length; ++i) {
      var cc = name.charCodeAt(i);
      out[out.l++] = cc > 127 ? 95 : cc;
    }
    out[out.l++] = 0;
    return out;
  }
  var WK1Enum = {
    /*::[*/
    0: {
      n: "BOF",
      f: parseuint16
    },
    /*::[*/
    1: {
      n: "EOF"
    },
    /*::[*/
    2: {
      n: "CALCMODE"
    },
    /*::[*/
    3: {
      n: "CALCORDER"
    },
    /*::[*/
    4: {
      n: "SPLIT"
    },
    /*::[*/
    5: {
      n: "SYNC"
    },
    /*::[*/
    6: {
      n: "RANGE",
      f: parse_RANGE
    },
    /*::[*/
    7: {
      n: "WINDOW1"
    },
    /*::[*/
    8: {
      n: "COLW1"
    },
    /*::[*/
    9: {
      n: "WINTWO"
    },
    /*::[*/
    10: {
      n: "COLW2"
    },
    /*::[*/
    11: {
      n: "NAME"
    },
    /*::[*/
    12: {
      n: "BLANK"
    },
    /*::[*/
    13: {
      n: "INTEGER",
      f: parse_INTEGER
    },
    /*::[*/
    14: {
      n: "NUMBER",
      f: parse_NUMBER
    },
    /*::[*/
    15: {
      n: "LABEL",
      f: parse_LABEL
    },
    /*::[*/
    16: {
      n: "FORMULA",
      f: parse_FORMULA
    },
    /*::[*/
    24: {
      n: "TABLE"
    },
    /*::[*/
    25: {
      n: "ORANGE"
    },
    /*::[*/
    26: {
      n: "PRANGE"
    },
    /*::[*/
    27: {
      n: "SRANGE"
    },
    /*::[*/
    28: {
      n: "FRANGE"
    },
    /*::[*/
    29: {
      n: "KRANGE1"
    },
    /*::[*/
    32: {
      n: "HRANGE"
    },
    /*::[*/
    35: {
      n: "KRANGE2"
    },
    /*::[*/
    36: {
      n: "PROTEC"
    },
    /*::[*/
    37: {
      n: "FOOTER"
    },
    /*::[*/
    38: {
      n: "HEADER"
    },
    /*::[*/
    39: {
      n: "SETUP"
    },
    /*::[*/
    40: {
      n: "MARGINS"
    },
    /*::[*/
    41: {
      n: "LABELFMT"
    },
    /*::[*/
    42: {
      n: "TITLES"
    },
    /*::[*/
    43: {
      n: "SHEETJS"
    },
    /*::[*/
    45: {
      n: "GRAPH"
    },
    /*::[*/
    46: {
      n: "NGRAPH"
    },
    /*::[*/
    47: {
      n: "CALCCOUNT"
    },
    /*::[*/
    48: {
      n: "UNFORMATTED"
    },
    /*::[*/
    49: {
      n: "CURSORW12"
    },
    /*::[*/
    50: {
      n: "WINDOW"
    },
    /*::[*/
    51: {
      n: "STRING",
      f: parse_LABEL
    },
    /*::[*/
    55: {
      n: "PASSWORD"
    },
    /*::[*/
    56: {
      n: "LOCKED"
    },
    /*::[*/
    60: {
      n: "QUERY"
    },
    /*::[*/
    61: {
      n: "QUERYNAME"
    },
    /*::[*/
    62: {
      n: "PRINT"
    },
    /*::[*/
    63: {
      n: "PRINTNAME"
    },
    /*::[*/
    64: {
      n: "GRAPH2"
    },
    /*::[*/
    65: {
      n: "GRAPHNAME"
    },
    /*::[*/
    66: {
      n: "ZOOM"
    },
    /*::[*/
    67: {
      n: "SYMSPLIT"
    },
    /*::[*/
    68: {
      n: "NSROWS"
    },
    /*::[*/
    69: {
      n: "NSCOLS"
    },
    /*::[*/
    70: {
      n: "RULER"
    },
    /*::[*/
    71: {
      n: "NNAME"
    },
    /*::[*/
    72: {
      n: "ACOMM"
    },
    /*::[*/
    73: {
      n: "AMACRO"
    },
    /*::[*/
    74: {
      n: "PARSE"
    },
    /*::[*/
    102: {
      n: "PRANGES??"
    },
    /*::[*/
    103: {
      n: "RRANGES??"
    },
    /*::[*/
    104: {
      n: "FNAME??"
    },
    /*::[*/
    105: {
      n: "MRANGES??"
    },
    /*::[*/
    204: {
      n: "SHEETNAMECS",
      f: parse_SHEETNAMECS
    },
    /*::[*/
    222: {
      n: "SHEETNAMELP",
      f: parse_SHEETNAMELP
    },
    /*::[*/
    65535: {
      n: ""
    }
  };
  var WK3Enum = {
    /*::[*/
    0: {
      n: "BOF"
    },
    /*::[*/
    1: {
      n: "EOF"
    },
    /*::[*/
    2: {
      n: "PASSWORD"
    },
    /*::[*/
    3: {
      n: "CALCSET"
    },
    /*::[*/
    4: {
      n: "WINDOWSET"
    },
    /*::[*/
    5: {
      n: "SHEETCELLPTR"
    },
    /*::[*/
    6: {
      n: "SHEETLAYOUT"
    },
    /*::[*/
    7: {
      n: "COLUMNWIDTH"
    },
    /*::[*/
    8: {
      n: "HIDDENCOLUMN"
    },
    /*::[*/
    9: {
      n: "USERRANGE"
    },
    /*::[*/
    10: {
      n: "SYSTEMRANGE"
    },
    /*::[*/
    11: {
      n: "ZEROFORCE"
    },
    /*::[*/
    12: {
      n: "SORTKEYDIR"
    },
    /*::[*/
    13: {
      n: "FILESEAL"
    },
    /*::[*/
    14: {
      n: "DATAFILLNUMS"
    },
    /*::[*/
    15: {
      n: "PRINTMAIN"
    },
    /*::[*/
    16: {
      n: "PRINTSTRING"
    },
    /*::[*/
    17: {
      n: "GRAPHMAIN"
    },
    /*::[*/
    18: {
      n: "GRAPHSTRING"
    },
    /*::[*/
    19: {
      n: "??"
    },
    /*::[*/
    20: {
      n: "ERRCELL"
    },
    /*::[*/
    21: {
      n: "NACELL"
    },
    /*::[*/
    22: {
      n: "LABEL16",
      f: parse_LABEL_16
    },
    /*::[*/
    23: {
      n: "NUMBER17",
      f: parse_NUMBER_17
    },
    /*::[*/
    24: {
      n: "NUMBER18",
      f: parse_NUMBER_18
    },
    /*::[*/
    25: {
      n: "FORMULA19",
      f: parse_FORMULA_19
    },
    /*::[*/
    26: {
      n: "FORMULA1A"
    },
    /*::[*/
    27: {
      n: "XFORMAT",
      f: parse_XFORMAT
    },
    /*::[*/
    28: {
      n: "DTLABELMISC"
    },
    /*::[*/
    29: {
      n: "DTLABELCELL"
    },
    /*::[*/
    30: {
      n: "GRAPHWINDOW"
    },
    /*::[*/
    31: {
      n: "CPA"
    },
    /*::[*/
    32: {
      n: "LPLAUTO"
    },
    /*::[*/
    33: {
      n: "QUERY"
    },
    /*::[*/
    34: {
      n: "HIDDENSHEET"
    },
    /*::[*/
    35: {
      n: "??"
    },
    /*::[*/
    37: {
      n: "NUMBER25",
      f: parse_NUMBER_25
    },
    /*::[*/
    38: {
      n: "??"
    },
    /*::[*/
    39: {
      n: "NUMBER27",
      f: parse_NUMBER_27
    },
    /*::[*/
    40: {
      n: "FORMULA28",
      f: parse_FORMULA_28
    },
    /*::[*/
    142: {
      n: "??"
    },
    /*::[*/
    147: {
      n: "??"
    },
    /*::[*/
    150: {
      n: "??"
    },
    /*::[*/
    151: {
      n: "??"
    },
    /*::[*/
    152: {
      n: "??"
    },
    /*::[*/
    153: {
      n: "??"
    },
    /*::[*/
    154: {
      n: "??"
    },
    /*::[*/
    155: {
      n: "??"
    },
    /*::[*/
    156: {
      n: "??"
    },
    /*::[*/
    163: {
      n: "??"
    },
    /*::[*/
    174: {
      n: "??"
    },
    /*::[*/
    175: {
      n: "??"
    },
    /*::[*/
    176: {
      n: "??"
    },
    /*::[*/
    177: {
      n: "??"
    },
    /*::[*/
    184: {
      n: "??"
    },
    /*::[*/
    185: {
      n: "??"
    },
    /*::[*/
    186: {
      n: "??"
    },
    /*::[*/
    187: {
      n: "??"
    },
    /*::[*/
    188: {
      n: "??"
    },
    /*::[*/
    195: {
      n: "??"
    },
    /*::[*/
    201: {
      n: "??"
    },
    /*::[*/
    204: {
      n: "SHEETNAMECS",
      f: parse_SHEETNAMECS
    },
    /*::[*/
    205: {
      n: "??"
    },
    /*::[*/
    206: {
      n: "??"
    },
    /*::[*/
    207: {
      n: "??"
    },
    /*::[*/
    208: {
      n: "??"
    },
    /*::[*/
    256: {
      n: "??"
    },
    /*::[*/
    259: {
      n: "??"
    },
    /*::[*/
    260: {
      n: "??"
    },
    /*::[*/
    261: {
      n: "??"
    },
    /*::[*/
    262: {
      n: "??"
    },
    /*::[*/
    263: {
      n: "??"
    },
    /*::[*/
    265: {
      n: "??"
    },
    /*::[*/
    266: {
      n: "??"
    },
    /*::[*/
    267: {
      n: "??"
    },
    /*::[*/
    268: {
      n: "??"
    },
    /*::[*/
    270: {
      n: "??"
    },
    /*::[*/
    271: {
      n: "??"
    },
    /*::[*/
    384: {
      n: "??"
    },
    /*::[*/
    389: {
      n: "??"
    },
    /*::[*/
    390: {
      n: "??"
    },
    /*::[*/
    393: {
      n: "??"
    },
    /*::[*/
    396: {
      n: "??"
    },
    /*::[*/
    512: {
      n: "??"
    },
    /*::[*/
    514: {
      n: "??"
    },
    /*::[*/
    513: {
      n: "??"
    },
    /*::[*/
    516: {
      n: "??"
    },
    /*::[*/
    517: {
      n: "??"
    },
    /*::[*/
    640: {
      n: "??"
    },
    /*::[*/
    641: {
      n: "??"
    },
    /*::[*/
    642: {
      n: "??"
    },
    /*::[*/
    643: {
      n: "??"
    },
    /*::[*/
    644: {
      n: "??"
    },
    /*::[*/
    645: {
      n: "??"
    },
    /*::[*/
    646: {
      n: "??"
    },
    /*::[*/
    647: {
      n: "??"
    },
    /*::[*/
    648: {
      n: "??"
    },
    /*::[*/
    658: {
      n: "??"
    },
    /*::[*/
    659: {
      n: "??"
    },
    /*::[*/
    660: {
      n: "??"
    },
    /*::[*/
    661: {
      n: "??"
    },
    /*::[*/
    662: {
      n: "??"
    },
    /*::[*/
    665: {
      n: "??"
    },
    /*::[*/
    666: {
      n: "??"
    },
    /*::[*/
    768: {
      n: "??"
    },
    /*::[*/
    772: {
      n: "??"
    },
    /*::[*/
    1537: {
      n: "SHEETINFOQP",
      f: parse_SHEETINFOQP
    },
    /*::[*/
    1600: {
      n: "??"
    },
    /*::[*/
    1602: {
      n: "??"
    },
    /*::[*/
    1793: {
      n: "??"
    },
    /*::[*/
    1794: {
      n: "??"
    },
    /*::[*/
    1795: {
      n: "??"
    },
    /*::[*/
    1796: {
      n: "??"
    },
    /*::[*/
    1920: {
      n: "??"
    },
    /*::[*/
    2048: {
      n: "??"
    },
    /*::[*/
    2049: {
      n: "??"
    },
    /*::[*/
    2052: {
      n: "??"
    },
    /*::[*/
    2688: {
      n: "??"
    },
    /*::[*/
    10998: {
      n: "??"
    },
    /*::[*/
    12849: {
      n: "??"
    },
    /*::[*/
    28233: {
      n: "??"
    },
    /*::[*/
    28484: {
      n: "??"
    },
    /*::[*/
    65535: {
      n: ""
    }
  };
  return {
    sheet_to_wk1,
    book_to_wk3,
    to_workbook: lotus_to_workbook
  };
}();
var straywsregex = /^\s|\s$|[\t\n\r]/;
function write_sst_xml(sst, opts) {
  if (!opts.bookSST) return "";
  var o = [XML_HEADER];
  o[o.length] = writextag("sst", null, {
    xmlns: XMLNS_main[0],
    count: sst.Count,
    uniqueCount: sst.Unique
  });
  for (var i = 0; i != sst.length; ++i) {
    if (sst[i] == null) continue;
    var s = sst[i];
    var sitag = "<si>";
    if (s.r) sitag += s.r;
    else {
      sitag += "<t";
      if (!s.t) s.t = "";
      if (s.t.match(straywsregex)) sitag += ' xml:space="preserve"';
      sitag += ">" + escapexml(s.t) + "</t>";
    }
    sitag += "</si>";
    o[o.length] = sitag;
  }
  if (o.length > 2) {
    o[o.length] = "</sst>";
    o[1] = o[1].replace("/>", ">");
  }
  return o.join("");
}
function parse_BrtBeginSst(data) {
  return [data.read_shift(4), data.read_shift(4)];
}
function write_BrtBeginSst(sst, o) {
  if (!o) o = new_buf(8);
  o.write_shift(4, sst.Count);
  o.write_shift(4, sst.Unique);
  return o;
}
var write_BrtSSTItem = write_RichStr;
function write_sst_bin(sst) {
  var ba = buf_array();
  write_record(ba, 159, write_BrtBeginSst(sst));
  for (var i = 0; i < sst.length; ++i) write_record(ba, 19, write_BrtSSTItem(sst[i]));
  write_record(
    ba,
    160
    /* BrtEndSst */
  );
  return ba.end();
}
function _JS2ANSI(str) {
  if (typeof $cptable !== "undefined") return $cptable.utils.encode(current_ansi, str);
  var o = [], oo = str.split("");
  for (var i = 0; i < oo.length; ++i) o[i] = oo[i].charCodeAt(0);
  return o;
}
function crypto_CreatePasswordVerifier_Method1(Password) {
  var Verifier = 0, PasswordArray;
  var PasswordDecoded = _JS2ANSI(Password);
  var len = PasswordDecoded.length + 1, i, PasswordByte;
  var Intermediate1, Intermediate2, Intermediate3;
  PasswordArray = new_raw_buf(len);
  PasswordArray[0] = PasswordDecoded.length;
  for (i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i - 1];
  for (i = len - 1; i >= 0; --i) {
    PasswordByte = PasswordArray[i];
    Intermediate1 = (Verifier & 16384) === 0 ? 0 : 1;
    Intermediate2 = Verifier << 1 & 32767;
    Intermediate3 = Intermediate1 | Intermediate2;
    Verifier = Intermediate3 ^ PasswordByte;
  }
  return Verifier ^ 52811;
}
var RTF = /* @__PURE__ */ function() {
  function rtf_to_sheet(d, opts) {
    switch (opts.type) {
      case "base64":
        return rtf_to_sheet_str(Base64_decode(d), opts);
      case "binary":
        return rtf_to_sheet_str(d, opts);
      case "buffer":
        return rtf_to_sheet_str(has_buf && Buffer.isBuffer(d) ? d.toString("binary") : a2s(d), opts);
      case "array":
        return rtf_to_sheet_str(cc2str(d), opts);
    }
    throw new Error("Unrecognized type " + opts.type);
  }
  function rtf_to_sheet_str(str, opts) {
    var o = opts || {};
    var ws = o.dense ? [] : {};
    var rows = str.match(/\\trowd.*?\\row\b/g);
    if (!rows.length) throw new Error("RTF missing table");
    var range = {
      s: {
        c: 0,
        r: 0
      },
      e: {
        c: 0,
        r: rows.length - 1
      }
    };
    rows.forEach(function(rowtf, R) {
      if (Array.isArray(ws)) ws[R] = [];
      var rtfre = /\\\w+\b/g;
      var last_index = 0;
      var res;
      var C = -1;
      while (res = rtfre.exec(rowtf)) {
        switch (res[0]) {
          case "\\cell":
            var data = rowtf.slice(last_index, rtfre.lastIndex - res[0].length);
            if (data[0] == " ") data = data.slice(1);
            ++C;
            if (data.length) {
              var cell = {
                v: data,
                t: "s"
              };
              if (Array.isArray(ws)) ws[R][C] = cell;
              else ws[encode_cell({
                r: R,
                c: C
              })] = cell;
            }
            break;
        }
        last_index = rtfre.lastIndex;
      }
      if (C > range.e.c) range.e.c = C;
    });
    ws["!ref"] = encode_range(range);
    return ws;
  }
  function rtf_to_workbook(d, opts) {
    return sheet_to_workbook(rtf_to_sheet(d, opts), opts);
  }
  function sheet_to_rtf(ws) {
    var o = ["{\\rtf1\\ansi"];
    var r = safe_decode_range(ws["!ref"]), cell;
    var dense = Array.isArray(ws);
    for (var R = r.s.r; R <= r.e.r; ++R) {
      o.push("\\trowd\\trautofit1");
      for (var C = r.s.c; C <= r.e.c; ++C) o.push("\\cellx" + (C + 1));
      o.push("\\pard\\intbl");
      for (C = r.s.c; C <= r.e.c; ++C) {
        var coord = encode_cell({
          r: R,
          c: C
        });
        cell = dense ? (ws[R] || [])[C] : ws[coord];
        if (!cell || cell.v == null && (!cell.f || cell.F)) continue;
        o.push(" " + (cell.w || (format_cell(cell), cell.w)));
        o.push("\\cell");
      }
      o.push("\\pard\\intbl\\row");
    }
    return o.join("") + "}";
  }
  return {
    to_workbook: rtf_to_workbook,
    to_sheet: rtf_to_sheet,
    from_sheet: sheet_to_rtf
  };
}();
function rgb2Hex(rgb) {
  for (var i = 0, o = 1; i != 3; ++i) o = o * 256 + (rgb[i] > 255 ? 255 : rgb[i] < 0 ? 0 : rgb[i]);
  return o.toString(16).toUpperCase().slice(1);
}
var DEF_MDW = 6;
var MDW = DEF_MDW;
function width2px(width) {
  return Math.floor((width + Math.round(128 / MDW) / 256) * MDW);
}
function px2char(px) {
  return Math.floor((px - 5) / MDW * 100 + 0.5) / 100;
}
function char2width(chr) {
  return Math.round((chr * MDW + 5) / MDW * 256) / 256;
}
function process_col(coll) {
  if (coll.width) {
    coll.wpx = width2px(coll.width);
    coll.wch = px2char(coll.wpx);
    coll.MDW = MDW;
  } else if (coll.wpx) {
    coll.wch = px2char(coll.wpx);
    coll.width = char2width(coll.wch);
    coll.MDW = MDW;
  } else if (typeof coll.wch == "number") {
    coll.width = char2width(coll.wch);
    coll.wpx = width2px(coll.width);
    coll.MDW = MDW;
  }
  if (coll.customWidth) delete coll.customWidth;
}
var DEF_PPI = 96;
var PPI = DEF_PPI;
function px2pt(px) {
  return px * 96 / PPI;
}
function pt2px(pt) {
  return pt * PPI / 96;
}
function write_numFmts(NF) {
  var o = ["<numFmts>"];
  [[5, 8], [23, 26], [41, 44], [
    /*63*/
    50,
    /*66],[164,*/
    392
  ]].forEach(function(r) {
    for (var i = r[0]; i <= r[1]; ++i) if (NF[i] != null) o[o.length] = writextag("numFmt", null, {
      numFmtId: i,
      formatCode: escapexml(NF[i])
    });
  });
  if (o.length === 1) return "";
  o[o.length] = "</numFmts>";
  o[0] = writextag("numFmts", null, {
    count: o.length - 2
  }).replace("/>", ">");
  return o.join("");
}
function write_cellXfs(cellXfs) {
  var o = [];
  o[o.length] = writextag("cellXfs", null);
  cellXfs.forEach(function(c) {
    o[o.length] = writextag("xf", null, c);
  });
  o[o.length] = "</cellXfs>";
  if (o.length === 2) return "";
  o[0] = writextag("cellXfs", null, {
    count: o.length - 2
  }).replace("/>", ">");
  return o.join("");
}
function write_sty_xml(wb, opts) {
  var o = [XML_HEADER, writextag("styleSheet", null, {
    "xmlns": XMLNS_main[0],
    "xmlns:vt": XMLNS.vt
  })], w;
  if (wb.SSF && (w = write_numFmts(wb.SSF)) != null) o[o.length] = w;
  o[o.length] = '<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>';
  o[o.length] = '<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>';
  o[o.length] = '<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>';
  o[o.length] = '<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>';
  if (w = write_cellXfs(opts.cellXfs)) o[o.length] = w;
  o[o.length] = '<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>';
  o[o.length] = '<dxfs count="0"/>';
  o[o.length] = '<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>';
  if (o.length > 2) {
    o[o.length] = "</styleSheet>";
    o[1] = o[1].replace("/>", ">");
  }
  return o.join("");
}
function parse_BrtFmt(data, length) {
  var numFmtId = data.read_shift(2);
  var stFmtCode = parse_XLWideString(data, length - 2);
  return [numFmtId, stFmtCode];
}
function write_BrtFmt(i, f, o) {
  if (!o) o = new_buf(6 + 4 * f.length);
  o.write_shift(2, i);
  write_XLWideString(f, o);
  var out = o.length > o.l ? o.slice(0, o.l) : o;
  if (o.l == null) o.l = o.length;
  return out;
}
function parse_BrtFont(data, length, opts) {
  var out = {};
  out.sz = data.read_shift(2) / 20;
  var grbit = parse_FontFlags(data, 2, opts);
  if (grbit.fItalic) out.italic = 1;
  if (grbit.fCondense) out.condense = 1;
  if (grbit.fExtend) out.extend = 1;
  if (grbit.fShadow) out.shadow = 1;
  if (grbit.fOutline) out.outline = 1;
  if (grbit.fStrikeout) out.strike = 1;
  var bls = data.read_shift(2);
  if (bls === 700) out.bold = 1;
  switch (data.read_shift(2)) {
    /* case 0: out.vertAlign = "baseline"; break; */
    case 1:
      out.vertAlign = "superscript";
      break;
    case 2:
      out.vertAlign = "subscript";
      break;
  }
  var underline = data.read_shift(1);
  if (underline != 0) out.underline = underline;
  var family = data.read_shift(1);
  if (family > 0) out.family = family;
  var bCharSet = data.read_shift(1);
  if (bCharSet > 0) out.charset = bCharSet;
  data.l++;
  out.color = parse_BrtColor(data, 8);
  switch (data.read_shift(1)) {
    /* case 0: out.scheme = "none": break; */
    case 1:
      out.scheme = "major";
      break;
    case 2:
      out.scheme = "minor";
      break;
  }
  out.name = parse_XLWideString(data, length - 21);
  return out;
}
function write_BrtFont(font, o) {
  if (!o) o = new_buf(25 + 4 * 32);
  o.write_shift(2, font.sz * 20);
  write_FontFlags(font, o);
  o.write_shift(2, font.bold ? 700 : 400);
  var sss = 0;
  if (font.vertAlign == "superscript") sss = 1;
  else if (font.vertAlign == "subscript") sss = 2;
  o.write_shift(2, sss);
  o.write_shift(1, font.underline || 0);
  o.write_shift(1, font.family || 0);
  o.write_shift(1, font.charset || 0);
  o.write_shift(1, 0);
  write_BrtColor(font.color, o);
  var scheme = 0;
  if (font.scheme == "major") scheme = 1;
  if (font.scheme == "minor") scheme = 2;
  o.write_shift(1, scheme);
  write_XLWideString(font.name, o);
  return o.length > o.l ? o.slice(0, o.l) : o;
}
var XLSBFillPTNames = ["none", "solid", "mediumGray", "darkGray", "lightGray", "darkHorizontal", "darkVertical", "darkDown", "darkUp", "darkGrid", "darkTrellis", "lightHorizontal", "lightVertical", "lightDown", "lightUp", "lightGrid", "lightTrellis", "gray125", "gray0625"];
var rev_XLSBFillPTNames;
var parse_BrtFill = parsenoop;
function write_BrtFill(fill2, o) {
  if (!o) o = new_buf(4 * 3 + 8 * 7 + 16 * 1);
  if (!rev_XLSBFillPTNames) rev_XLSBFillPTNames = evert(XLSBFillPTNames);
  var fls = rev_XLSBFillPTNames[fill2.patternType];
  if (fls == null) fls = 40;
  o.write_shift(4, fls);
  var j = 0;
  if (fls != 40) {
    write_BrtColor({
      auto: 1
    }, o);
    write_BrtColor({
      auto: 1
    }, o);
    for (; j < 12; ++j) o.write_shift(4, 0);
  } else {
    for (; j < 4; ++j) o.write_shift(4, 0);
    for (; j < 12; ++j) o.write_shift(4, 0);
  }
  return o.length > o.l ? o.slice(0, o.l) : o;
}
function parse_BrtXF(data, length) {
  var tgt = data.l + length;
  var ixfeParent = data.read_shift(2);
  var ifmt = data.read_shift(2);
  data.l = tgt;
  return {
    ixfe: ixfeParent,
    numFmtId: ifmt
  };
}
function write_BrtXF(data, ixfeP, o) {
  if (!o) o = new_buf(16);
  o.write_shift(2, ixfeP || 0);
  o.write_shift(2, data.numFmtId || 0);
  o.write_shift(2, 0);
  o.write_shift(2, 0);
  o.write_shift(2, 0);
  o.write_shift(1, 0);
  o.write_shift(1, 0);
  var flow = 0;
  o.write_shift(1, flow);
  o.write_shift(1, 0);
  o.write_shift(1, 0);
  o.write_shift(1, 0);
  return o;
}
function write_Blxf(data, o) {
  if (!o) o = new_buf(10);
  o.write_shift(1, 0);
  o.write_shift(1, 0);
  o.write_shift(4, 0);
  o.write_shift(4, 0);
  return o;
}
var parse_BrtBorder = parsenoop;
function write_BrtBorder(border, o) {
  if (!o) o = new_buf(51);
  o.write_shift(1, 0);
  write_Blxf(null, o);
  write_Blxf(null, o);
  write_Blxf(null, o);
  write_Blxf(null, o);
  write_Blxf(null, o);
  return o.length > o.l ? o.slice(0, o.l) : o;
}
function write_BrtStyle(style2, o) {
  if (!o) o = new_buf(12 + 4 * 10);
  o.write_shift(4, style2.xfId);
  o.write_shift(2, 1);
  o.write_shift(1, +style2.builtinId);
  o.write_shift(1, 0);
  write_XLNullableWideString(style2.name || "", o);
  return o.length > o.l ? o.slice(0, o.l) : o;
}
function write_BrtBeginTableStyles(cnt, defTableStyle, defPivotStyle) {
  var o = new_buf(4 + 256 * 2 * 4);
  o.write_shift(4, cnt);
  write_XLNullableWideString(defTableStyle, o);
  write_XLNullableWideString(defPivotStyle, o);
  return o.length > o.l ? o.slice(0, o.l) : o;
}
function write_FMTS_bin(ba, NF) {
  if (!NF) return;
  var cnt = 0;
  [[5, 8], [23, 26], [41, 44], [
    /*63*/
    50,
    /*66],[164,*/
    392
  ]].forEach(function(r) {
    for (var i = r[0]; i <= r[1]; ++i) if (NF[i] != null) ++cnt;
  });
  if (cnt == 0) return;
  write_record(ba, 615, write_UInt32LE(cnt));
  [[5, 8], [23, 26], [41, 44], [
    /*63*/
    50,
    /*66],[164,*/
    392
  ]].forEach(function(r) {
    for (var i = r[0]; i <= r[1]; ++i) if (NF[i] != null) write_record(ba, 44, write_BrtFmt(i, NF[i]));
  });
  write_record(
    ba,
    616
    /* BrtEndFmts */
  );
}
function write_FONTS_bin(ba) {
  var cnt = 1;
  if (cnt == 0) return;
  write_record(ba, 611, write_UInt32LE(cnt));
  write_record(ba, 43, write_BrtFont({
    sz: 12,
    color: {
      theme: 1
    },
    name: "Calibri",
    family: 2,
    scheme: "minor"
  }));
  write_record(
    ba,
    612
    /* BrtEndFonts */
  );
}
function write_FILLS_bin(ba) {
  var cnt = 2;
  if (cnt == 0) return;
  write_record(ba, 603, write_UInt32LE(cnt));
  write_record(ba, 45, write_BrtFill({
    patternType: "none"
  }));
  write_record(ba, 45, write_BrtFill({
    patternType: "gray125"
  }));
  write_record(
    ba,
    604
    /* BrtEndFills */
  );
}
function write_BORDERS_bin(ba) {
  var cnt = 1;
  if (cnt == 0) return;
  write_record(ba, 613, write_UInt32LE(cnt));
  write_record(ba, 46, write_BrtBorder({}));
  write_record(
    ba,
    614
    /* BrtEndBorders */
  );
}
function write_CELLSTYLEXFS_bin(ba) {
  var cnt = 1;
  write_record(ba, 626, write_UInt32LE(cnt));
  write_record(ba, 47, write_BrtXF({
    numFmtId: 0,
    fontId: 0,
    fillId: 0,
    borderId: 0
  }, 65535));
  write_record(
    ba,
    627
    /* BrtEndCellStyleXFs */
  );
}
function write_CELLXFS_bin(ba, data) {
  write_record(ba, 617, write_UInt32LE(data.length));
  data.forEach(function(c) {
    write_record(ba, 47, write_BrtXF(c, 0));
  });
  write_record(
    ba,
    618
    /* BrtEndCellXFs */
  );
}
function write_STYLES_bin(ba) {
  var cnt = 1;
  write_record(ba, 619, write_UInt32LE(cnt));
  write_record(ba, 48, write_BrtStyle({
    xfId: 0,
    builtinId: 0,
    name: "Normal"
  }));
  write_record(
    ba,
    620
    /* BrtEndStyles */
  );
}
function write_DXFS_bin(ba) {
  var cnt = 0;
  write_record(ba, 505, write_UInt32LE(cnt));
  write_record(
    ba,
    506
    /* BrtEndDXFs */
  );
}
function write_TABLESTYLES_bin(ba) {
  var cnt = 0;
  write_record(ba, 508, write_BrtBeginTableStyles(cnt, "TableStyleMedium9", "PivotStyleMedium4"));
  write_record(
    ba,
    509
    /* BrtEndTableStyles */
  );
}
function write_COLORPALETTE_bin() {
  return;
}
function write_sty_bin(wb, opts) {
  var ba = buf_array();
  write_record(
    ba,
    278
    /* BrtBeginStyleSheet */
  );
  write_FMTS_bin(ba, wb.SSF);
  write_FONTS_bin(ba, wb);
  write_FILLS_bin(ba, wb);
  write_BORDERS_bin(ba, wb);
  write_CELLSTYLEXFS_bin(ba, wb);
  write_CELLXFS_bin(ba, opts.cellXfs);
  write_STYLES_bin(ba, wb);
  write_DXFS_bin(ba, wb);
  write_TABLESTYLES_bin(ba, wb);
  write_COLORPALETTE_bin(ba, wb);
  write_record(
    ba,
    279
    /* BrtEndStyleSheet */
  );
  return ba.end();
}
function write_theme(Themes, opts) {
  if (opts && opts.themeXLSX) return opts.themeXLSX;
  if (Themes && typeof Themes.raw == "string") return Themes.raw;
  var o = [XML_HEADER];
  o[o.length] = '<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">';
  o[o.length] = "<a:themeElements>";
  o[o.length] = '<a:clrScheme name="Office">';
  o[o.length] = '<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>';
  o[o.length] = '<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>';
  o[o.length] = '<a:dk2><a:srgbClr val="1F497D"/></a:dk2>';
  o[o.length] = '<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>';
  o[o.length] = '<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>';
  o[o.length] = '<a:accent2><a:srgbClr val="C0504D"/></a:accent2>';
  o[o.length] = '<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>';
  o[o.length] = '<a:accent4><a:srgbClr val="8064A2"/></a:accent4>';
  o[o.length] = '<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>';
  o[o.length] = '<a:accent6><a:srgbClr val="F79646"/></a:accent6>';
  o[o.length] = '<a:hlink><a:srgbClr val="0000FF"/></a:hlink>';
  o[o.length] = '<a:folHlink><a:srgbClr val="800080"/></a:folHlink>';
  o[o.length] = "</a:clrScheme>";
  o[o.length] = '<a:fontScheme name="Office">';
  o[o.length] = "<a:majorFont>";
  o[o.length] = '<a:latin typeface="Cambria"/>';
  o[o.length] = '<a:ea typeface=""/>';
  o[o.length] = '<a:cs typeface=""/>';
  o[o.length] = '<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>';
  o[o.length] = '<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>';
  o[o.length] = '<a:font script="Hans" typeface="\u5B8B\u4F53"/>';
  o[o.length] = '<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>';
  o[o.length] = '<a:font script="Arab" typeface="Times New Roman"/>';
  o[o.length] = '<a:font script="Hebr" typeface="Times New Roman"/>';
  o[o.length] = '<a:font script="Thai" typeface="Tahoma"/>';
  o[o.length] = '<a:font script="Ethi" typeface="Nyala"/>';
  o[o.length] = '<a:font script="Beng" typeface="Vrinda"/>';
  o[o.length] = '<a:font script="Gujr" typeface="Shruti"/>';
  o[o.length] = '<a:font script="Khmr" typeface="MoolBoran"/>';
  o[o.length] = '<a:font script="Knda" typeface="Tunga"/>';
  o[o.length] = '<a:font script="Guru" typeface="Raavi"/>';
  o[o.length] = '<a:font script="Cans" typeface="Euphemia"/>';
  o[o.length] = '<a:font script="Cher" typeface="Plantagenet Cherokee"/>';
  o[o.length] = '<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>';
  o[o.length] = '<a:font script="Tibt" typeface="Microsoft Himalaya"/>';
  o[o.length] = '<a:font script="Thaa" typeface="MV Boli"/>';
  o[o.length] = '<a:font script="Deva" typeface="Mangal"/>';
  o[o.length] = '<a:font script="Telu" typeface="Gautami"/>';
  o[o.length] = '<a:font script="Taml" typeface="Latha"/>';
  o[o.length] = '<a:font script="Syrc" typeface="Estrangelo Edessa"/>';
  o[o.length] = '<a:font script="Orya" typeface="Kalinga"/>';
  o[o.length] = '<a:font script="Mlym" typeface="Kartika"/>';
  o[o.length] = '<a:font script="Laoo" typeface="DokChampa"/>';
  o[o.length] = '<a:font script="Sinh" typeface="Iskoola Pota"/>';
  o[o.length] = '<a:font script="Mong" typeface="Mongolian Baiti"/>';
  o[o.length] = '<a:font script="Viet" typeface="Times New Roman"/>';
  o[o.length] = '<a:font script="Uigh" typeface="Microsoft Uighur"/>';
  o[o.length] = '<a:font script="Geor" typeface="Sylfaen"/>';
  o[o.length] = "</a:majorFont>";
  o[o.length] = "<a:minorFont>";
  o[o.length] = '<a:latin typeface="Calibri"/>';
  o[o.length] = '<a:ea typeface=""/>';
  o[o.length] = '<a:cs typeface=""/>';
  o[o.length] = '<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>';
  o[o.length] = '<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>';
  o[o.length] = '<a:font script="Hans" typeface="\u5B8B\u4F53"/>';
  o[o.length] = '<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>';
  o[o.length] = '<a:font script="Arab" typeface="Arial"/>';
  o[o.length] = '<a:font script="Hebr" typeface="Arial"/>';
  o[o.length] = '<a:font script="Thai" typeface="Tahoma"/>';
  o[o.length] = '<a:font script="Ethi" typeface="Nyala"/>';
  o[o.length] = '<a:font script="Beng" typeface="Vrinda"/>';
  o[o.length] = '<a:font script="Gujr" typeface="Shruti"/>';
  o[o.length] = '<a:font script="Khmr" typeface="DaunPenh"/>';
  o[o.length] = '<a:font script="Knda" typeface="Tunga"/>';
  o[o.length] = '<a:font script="Guru" typeface="Raavi"/>';
  o[o.length] = '<a:font script="Cans" typeface="Euphemia"/>';
  o[o.length] = '<a:font script="Cher" typeface="Plantagenet Cherokee"/>';
  o[o.length] = '<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>';
  o[o.length] = '<a:font script="Tibt" typeface="Microsoft Himalaya"/>';
  o[o.length] = '<a:font script="Thaa" typeface="MV Boli"/>';
  o[o.length] = '<a:font script="Deva" typeface="Mangal"/>';
  o[o.length] = '<a:font script="Telu" typeface="Gautami"/>';
  o[o.length] = '<a:font script="Taml" typeface="Latha"/>';
  o[o.length] = '<a:font script="Syrc" typeface="Estrangelo Edessa"/>';
  o[o.length] = '<a:font script="Orya" typeface="Kalinga"/>';
  o[o.length] = '<a:font script="Mlym" typeface="Kartika"/>';
  o[o.length] = '<a:font script="Laoo" typeface="DokChampa"/>';
  o[o.length] = '<a:font script="Sinh" typeface="Iskoola Pota"/>';
  o[o.length] = '<a:font script="Mong" typeface="Mongolian Baiti"/>';
  o[o.length] = '<a:font script="Viet" typeface="Arial"/>';
  o[o.length] = '<a:font script="Uigh" typeface="Microsoft Uighur"/>';
  o[o.length] = '<a:font script="Geor" typeface="Sylfaen"/>';
  o[o.length] = "</a:minorFont>";
  o[o.length] = "</a:fontScheme>";
  o[o.length] = '<a:fmtScheme name="Office">';
  o[o.length] = "<a:fillStyleLst>";
  o[o.length] = '<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>';
  o[o.length] = '<a:gradFill rotWithShape="1">';
  o[o.length] = "<a:gsLst>";
  o[o.length] = '<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>';
  o[o.length] = '<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>';
  o[o.length] = '<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>';
  o[o.length] = "</a:gsLst>";
  o[o.length] = '<a:lin ang="16200000" scaled="1"/>';
  o[o.length] = "</a:gradFill>";
  o[o.length] = '<a:gradFill rotWithShape="1">';
  o[o.length] = "<a:gsLst>";
  o[o.length] = '<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>';
  o[o.length] = '<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>';
  o[o.length] = "</a:gsLst>";
  o[o.length] = '<a:lin ang="16200000" scaled="0"/>';
  o[o.length] = "</a:gradFill>";
  o[o.length] = "</a:fillStyleLst>";
  o[o.length] = "<a:lnStyleLst>";
  o[o.length] = '<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>';
  o[o.length] = '<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>';
  o[o.length] = '<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>';
  o[o.length] = "</a:lnStyleLst>";
  o[o.length] = "<a:effectStyleLst>";
  o[o.length] = "<a:effectStyle>";
  o[o.length] = "<a:effectLst>";
  o[o.length] = '<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>';
  o[o.length] = "</a:effectLst>";
  o[o.length] = "</a:effectStyle>";
  o[o.length] = "<a:effectStyle>";
  o[o.length] = "<a:effectLst>";
  o[o.length] = '<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>';
  o[o.length] = "</a:effectLst>";
  o[o.length] = "</a:effectStyle>";
  o[o.length] = "<a:effectStyle>";
  o[o.length] = "<a:effectLst>";
  o[o.length] = '<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>';
  o[o.length] = "</a:effectLst>";
  o[o.length] = '<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>';
  o[o.length] = '<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>';
  o[o.length] = "</a:effectStyle>";
  o[o.length] = "</a:effectStyleLst>";
  o[o.length] = "<a:bgFillStyleLst>";
  o[o.length] = '<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>';
  o[o.length] = '<a:gradFill rotWithShape="1">';
  o[o.length] = "<a:gsLst>";
  o[o.length] = '<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>';
  o[o.length] = '<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>';
  o[o.length] = '<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>';
  o[o.length] = "</a:gsLst>";
  o[o.length] = '<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>';
  o[o.length] = "</a:gradFill>";
  o[o.length] = '<a:gradFill rotWithShape="1">';
  o[o.length] = "<a:gsLst>";
  o[o.length] = '<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>';
  o[o.length] = '<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>';
  o[o.length] = "</a:gsLst>";
  o[o.length] = '<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>';
  o[o.length] = "</a:gradFill>";
  o[o.length] = "</a:bgFillStyleLst>";
  o[o.length] = "</a:fmtScheme>";
  o[o.length] = "</a:themeElements>";
  o[o.length] = "<a:objectDefaults>";
  o[o.length] = "<a:spDef>";
  o[o.length] = '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>';
  o[o.length] = "</a:spDef>";
  o[o.length] = "<a:lnDef>";
  o[o.length] = '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>';
  o[o.length] = "</a:lnDef>";
  o[o.length] = "</a:objectDefaults>";
  o[o.length] = "<a:extraClrSchemeLst/>";
  o[o.length] = "</a:theme>";
  return o.join("");
}
function parse_BrtMdtinfo(data, length) {
  return {
    flags: data.read_shift(4),
    version: data.read_shift(4),
    name: parse_XLWideString(data, length - 8)
  };
}
function write_BrtMdtinfo(data) {
  var o = new_buf(12 + 2 * data.name.length);
  o.write_shift(4, data.flags);
  o.write_shift(4, data.version);
  write_XLWideString(data.name, o);
  return o.slice(0, o.l);
}
function parse_BrtMdb(data) {
  var out = [];
  var cnt = data.read_shift(4);
  while (cnt-- > 0) out.push([data.read_shift(4), data.read_shift(4)]);
  return out;
}
function write_BrtMdb(mdb) {
  var o = new_buf(4 + 8 * mdb.length);
  o.write_shift(4, mdb.length);
  for (var i = 0; i < mdb.length; ++i) {
    o.write_shift(4, mdb[i][0]);
    o.write_shift(4, mdb[i][1]);
  }
  return o;
}
function write_BrtBeginEsfmd(cnt, name) {
  var o = new_buf(8 + 2 * name.length);
  o.write_shift(4, cnt);
  write_XLWideString(name, o);
  return o.slice(0, o.l);
}
function parse_BrtBeginEsmdb(data) {
  data.l += 4;
  return data.read_shift(4) != 0;
}
function write_BrtBeginEsmdb(cnt, cm) {
  var o = new_buf(8);
  o.write_shift(4, cnt);
  o.write_shift(4, cm ? 1 : 0);
  return o;
}
function write_xlmeta_bin() {
  var ba = buf_array();
  write_record(ba, 332);
  write_record(ba, 334, write_UInt32LE(1));
  write_record(ba, 335, write_BrtMdtinfo({
    name: "XLDAPR",
    version: 12e4,
    flags: 3496657072
  }));
  write_record(ba, 336);
  write_record(ba, 339, write_BrtBeginEsfmd(1, "XLDAPR"));
  write_record(ba, 52);
  write_record(ba, 35, write_UInt32LE(514));
  write_record(ba, 4096, write_UInt32LE(0));
  write_record(ba, 4097, writeuint16(1));
  write_record(ba, 36);
  write_record(ba, 53);
  write_record(ba, 340);
  write_record(ba, 337, write_BrtBeginEsmdb(1, true));
  write_record(ba, 51, write_BrtMdb([[1, 0]]));
  write_record(ba, 338);
  write_record(ba, 333);
  return ba.end();
}
function write_xlmeta_xml() {
  var o = [XML_HEADER];
  o.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>');
  return o.join("");
}
function parse_BrtCalcChainItem$(data) {
  var out = {};
  out.i = data.read_shift(4);
  var cell = {};
  cell.r = data.read_shift(4);
  cell.c = data.read_shift(4);
  out.r = encode_cell(cell);
  var flags = data.read_shift(1);
  if (flags & 2) out.l = "1";
  if (flags & 8) out.a = "1";
  return out;
}
var _shapeid = 1024;
function write_comments_vml(rId, comments) {
  var csize = [21600, 21600];
  var bbox = ["m0,0l0", csize[1], csize[0], csize[1], csize[0], "0xe"].join(",");
  var o = [writextag("xml", null, {
    "xmlns:v": XLMLNS.v,
    "xmlns:o": XLMLNS.o,
    "xmlns:x": XLMLNS.x,
    "xmlns:mv": XLMLNS.mv
  }).replace(/\/>/, ">"), writextag("o:shapelayout", writextag("o:idmap", null, {
    "v:ext": "edit",
    "data": rId
  }), {
    "v:ext": "edit"
  }), writextag("v:shapetype", [writextag("v:stroke", null, {
    joinstyle: "miter"
  }), writextag("v:path", null, {
    gradientshapeok: "t",
    "o:connecttype": "rect"
  })].join(""), {
    id: "_x0000_t202",
    "o:spt": 202,
    coordsize: csize.join(","),
    path: bbox
  })];
  while (_shapeid < rId * 1e3) _shapeid += 1e3;
  comments.forEach(function(x) {
    var c = decode_cell(x[0]);
    var fillopts = (
      /*::(*/
      {
        "color2": "#BEFF82",
        "type": "gradient"
      }
    );
    if (fillopts.type == "gradient") fillopts.angle = "-180";
    var fillparm = fillopts.type == "gradient" ? writextag("o:fill", null, {
      type: "gradientUnscaled",
      "v:ext": "view"
    }) : null;
    var fillxml = writextag("v:fill", fillparm, fillopts);
    var shadata = {
      on: "t",
      "obscured": "t"
    };
    ++_shapeid;
    o = o.concat([
      "<v:shape" + wxt_helper({
        id: "_x0000_s" + _shapeid,
        type: "#_x0000_t202",
        style: "position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10" + (x[1].hidden ? ";visibility:hidden" : ""),
        fillcolor: "#ECFAD4",
        strokecolor: "#edeaa1"
      }) + ">",
      fillxml,
      writextag("v:shadow", null, shadata),
      writextag("v:path", null, {
        "o:connecttype": "none"
      }),
      '<v:textbox><div style="text-align:left"></div></v:textbox>',
      '<x:ClientData ObjectType="Note">',
      "<x:MoveWithCells/>",
      "<x:SizeWithCells/>",
      /* Part 4 19.4.2.3 Anchor (Anchor) */
      writetag("x:Anchor", [c.c + 1, 0, c.r + 1, 0, c.c + 3, 20, c.r + 5, 20].join(",")),
      writetag("x:AutoFill", "False"),
      writetag("x:Row", String(c.r)),
      writetag("x:Column", String(c.c)),
      x[1].hidden ? "" : "<x:Visible/>",
      "</x:ClientData>",
      "</v:shape>"
    ]);
  });
  o.push("</xml>");
  return o.join("");
}
function write_comments_xml(data) {
  var o = [XML_HEADER, writextag("comments", null, {
    "xmlns": XMLNS_main[0]
  })];
  var iauthor = [];
  o.push("<authors>");
  data.forEach(function(x) {
    x[1].forEach(function(w) {
      var a = escapexml(w.a);
      if (iauthor.indexOf(a) == -1) {
        iauthor.push(a);
        o.push("<author>" + a + "</author>");
      }
      if (w.T && w.ID && iauthor.indexOf("tc=" + w.ID) == -1) {
        iauthor.push("tc=" + w.ID);
        o.push("<author>tc=" + w.ID + "</author>");
      }
    });
  });
  if (iauthor.length == 0) {
    iauthor.push("SheetJ5");
    o.push("<author>SheetJ5</author>");
  }
  o.push("</authors>");
  o.push("<commentList>");
  data.forEach(function(d) {
    var lastauthor = 0, ts = [];
    if (d[1][0] && d[1][0].T && d[1][0].ID) lastauthor = iauthor.indexOf("tc=" + d[1][0].ID);
    else d[1].forEach(function(c) {
      if (c.a) lastauthor = iauthor.indexOf(escapexml(c.a));
      ts.push(c.t || "");
    });
    o.push('<comment ref="' + d[0] + '" authorId="' + lastauthor + '"><text>');
    if (ts.length <= 1) o.push(writetag("t", escapexml(ts[0] || "")));
    else {
      var t = "Comment:\n    " + ts[0] + "\n";
      for (var i = 1; i < ts.length; ++i) t += "Reply:\n    " + ts[i] + "\n";
      o.push(writetag("t", escapexml(t)));
    }
    o.push("</text></comment>");
  });
  o.push("</commentList>");
  if (o.length > 2) {
    o[o.length] = "</comments>";
    o[1] = o[1].replace("/>", ">");
  }
  return o.join("");
}
function write_tcmnt_xml(comments, people, opts) {
  var o = [XML_HEADER, writextag("ThreadedComments", null, {
    "xmlns": XMLNS.TCMNT
  }).replace(/[\/]>/, ">")];
  comments.forEach(function(carr) {
    var rootid = "";
    (carr[1] || []).forEach(function(c, idx) {
      if (!c.T) {
        delete c.ID;
        return;
      }
      if (c.a && people.indexOf(c.a) == -1) people.push(c.a);
      var tcopts = {
        ref: carr[0],
        id: "{54EE7951-7262-4200-6969-" + ("000000000000" + opts.tcid++).slice(-12) + "}"
      };
      if (idx == 0) rootid = tcopts.id;
      else tcopts.parentId = rootid;
      c.ID = tcopts.id;
      if (c.a) tcopts.personId = "{54EE7950-7262-4200-6969-" + ("000000000000" + people.indexOf(c.a)).slice(-12) + "}";
      o.push(writextag("threadedComment", writetag("text", c.t || ""), tcopts));
    });
  });
  o.push("</ThreadedComments>");
  return o.join("");
}
function write_people_xml(people) {
  var o = [XML_HEADER, writextag("personList", null, {
    "xmlns": XMLNS.TCMNT,
    "xmlns:x": XMLNS_main[0]
  }).replace(/[\/]>/, ">")];
  people.forEach(function(person, idx) {
    o.push(writextag("person", null, {
      displayName: person,
      id: "{54EE7950-7262-4200-6969-" + ("000000000000" + idx).slice(-12) + "}",
      userId: person,
      providerId: "None"
    }));
  });
  o.push("</personList>");
  return o.join("");
}
function parse_BrtBeginComment(data) {
  var out = {};
  out.iauthor = data.read_shift(4);
  var rfx = parse_UncheckedRfX(data, 16);
  out.rfx = rfx.s;
  out.ref = encode_cell(rfx.s);
  data.l += 16;
  return out;
}
function write_BrtBeginComment(data, o) {
  if (o == null) o = new_buf(36);
  o.write_shift(4, data[1].iauthor);
  write_UncheckedRfX(data[0], o);
  o.write_shift(4, 0);
  o.write_shift(4, 0);
  o.write_shift(4, 0);
  o.write_shift(4, 0);
  return o;
}
var parse_BrtCommentAuthor = parse_XLWideString;
function write_BrtCommentAuthor(data) {
  return write_XLWideString(data.slice(0, 54));
}
function write_comments_bin(data) {
  var ba = buf_array();
  var iauthor = [];
  write_record(
    ba,
    628
    /* BrtBeginComments */
  );
  write_record(
    ba,
    630
    /* BrtBeginCommentAuthors */
  );
  data.forEach(function(comment) {
    comment[1].forEach(function(c) {
      if (iauthor.indexOf(c.a) > -1) return;
      iauthor.push(c.a.slice(0, 54));
      write_record(ba, 632, write_BrtCommentAuthor(c.a));
    });
  });
  write_record(
    ba,
    631
    /* BrtEndCommentAuthors */
  );
  write_record(
    ba,
    633
    /* BrtBeginCommentList */
  );
  data.forEach(function(comment) {
    comment[1].forEach(function(c) {
      c.iauthor = iauthor.indexOf(c.a);
      var range = {
        s: decode_cell(comment[0]),
        e: decode_cell(comment[0])
      };
      write_record(ba, 635, write_BrtBeginComment([range, c]));
      if (c.t && c.t.length > 0) write_record(ba, 637, write_BrtCommentText(c));
      write_record(
        ba,
        636
        /* BrtEndComment */
      );
      delete c.iauthor;
    });
  });
  write_record(
    ba,
    634
    /* BrtEndCommentList */
  );
  write_record(
    ba,
    629
    /* BrtEndComments */
  );
  return ba.end();
}
function fill_vba_xls(cfb, vba) {
  vba.FullPaths.forEach(function(p, i) {
    if (i == 0) return;
    var newpath = p.replace(/[^\/]*[\/]/, "/_VBA_PROJECT_CUR/");
    if (newpath.slice(-1) !== "/") CFB.utils.cfb_add(cfb, newpath, vba.FileIndex[i].content);
  });
}
var VBAFMTS = ["xlsb", "xlsm", "xlam", "biff8", "xla"];
var rc_to_a1 = /* @__PURE__ */ function() {
  var rcregex = /(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g;
  var rcbase = {
    r: 0,
    c: 0
  };
  function rcfunc($$, $1, $2, $3) {
    var cRel = false, rRel = false;
    if ($2.length == 0) rRel = true;
    else if ($2.charAt(0) == "[") {
      rRel = true;
      $2 = $2.slice(1, -1);
    }
    if ($3.length == 0) cRel = true;
    else if ($3.charAt(0) == "[") {
      cRel = true;
      $3 = $3.slice(1, -1);
    }
    var R = $2.length > 0 ? parseInt($2, 10) | 0 : 0, C = $3.length > 0 ? parseInt($3, 10) | 0 : 0;
    if (cRel) C += rcbase.c;
    else --C;
    if (rRel) R += rcbase.r;
    else --R;
    return $1 + (cRel ? "" : "$") + encode_col(C) + (rRel ? "" : "$") + encode_row(R);
  }
  return function rc_to_a12(fstr, base) {
    rcbase = base;
    return fstr.replace(rcregex, rcfunc);
  };
}();
var crefregex = /(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g;
var a1_to_rc = /* @__PURE__ */ function() {
  return function a1_to_rc2(fstr, base) {
    return fstr.replace(crefregex, function($0, $1, $2, $3, $4, $5) {
      var c = decode_col($3) - ($2 ? 0 : base.c);
      var r = decode_row($5) - ($4 ? 0 : base.r);
      var R = r == 0 ? "" : !$4 ? "[" + r + "]" : r + 1;
      var C = c == 0 ? "" : !$2 ? "[" + c + "]" : c + 1;
      return $1 + "R" + R + "C" + C;
    });
  };
}();
function shift_formula_str(f, delta) {
  return f.replace(crefregex, function($0, $1, $2, $3, $4, $5) {
    return $1 + ($2 == "$" ? $2 + $3 : encode_col(decode_col($3) + delta.c)) + ($4 == "$" ? $4 + $5 : encode_row(decode_row($5) + delta.r));
  });
}
function fuzzyfmla(f) {
  if (f.length == 1) return false;
  return true;
}
function parseread1(blob) {
  blob.l += 1;
  return;
}
function parse_ColRelU(blob, length) {
  var c = blob.read_shift(length == 1 ? 1 : 2);
  return [c & 16383, c >> 14 & 1, c >> 15 & 1];
}
function parse_RgceArea(blob, length, opts) {
  var w = 2;
  if (opts) {
    if (opts.biff >= 2 && opts.biff <= 5) return parse_RgceArea_BIFF2(blob, length, opts);
    else if (opts.biff == 12) w = 4;
  }
  var r = blob.read_shift(w), R = blob.read_shift(w);
  var c = parse_ColRelU(blob, 2);
  var C = parse_ColRelU(blob, 2);
  return {
    s: {
      r,
      c: c[0],
      cRel: c[1],
      rRel: c[2]
    },
    e: {
      r: R,
      c: C[0],
      cRel: C[1],
      rRel: C[2]
    }
  };
}
function parse_RgceArea_BIFF2(blob) {
  var r = parse_ColRelU(blob, 2), R = parse_ColRelU(blob, 2);
  var c = blob.read_shift(1);
  var C = blob.read_shift(1);
  return {
    s: {
      r: r[0],
      c,
      cRel: r[1],
      rRel: r[2]
    },
    e: {
      r: R[0],
      c: C,
      cRel: R[1],
      rRel: R[2]
    }
  };
}
function parse_RgceAreaRel(blob, length, opts) {
  if (opts.biff < 8) return parse_RgceArea_BIFF2(blob, length, opts);
  var r = blob.read_shift(opts.biff == 12 ? 4 : 2), R = blob.read_shift(opts.biff == 12 ? 4 : 2);
  var c = parse_ColRelU(blob, 2);
  var C = parse_ColRelU(blob, 2);
  return {
    s: {
      r,
      c: c[0],
      cRel: c[1],
      rRel: c[2]
    },
    e: {
      r: R,
      c: C[0],
      cRel: C[1],
      rRel: C[2]
    }
  };
}
function parse_RgceLoc(blob, length, opts) {
  if (opts && opts.biff >= 2 && opts.biff <= 5) return parse_RgceLoc_BIFF2(blob, length, opts);
  var r = blob.read_shift(opts && opts.biff == 12 ? 4 : 2);
  var c = parse_ColRelU(blob, 2);
  return {
    r,
    c: c[0],
    cRel: c[1],
    rRel: c[2]
  };
}
function parse_RgceLoc_BIFF2(blob) {
  var r = parse_ColRelU(blob, 2);
  var c = blob.read_shift(1);
  return {
    r: r[0],
    c,
    cRel: r[1],
    rRel: r[2]
  };
}
function parse_RgceElfLoc(blob) {
  var r = blob.read_shift(2);
  var c = blob.read_shift(2);
  return {
    r,
    c: c & 255,
    fQuoted: !!(c & 16384),
    cRel: c >> 15,
    rRel: c >> 15
  };
}
function parse_RgceLocRel(blob, length, opts) {
  var biff = opts && opts.biff ? opts.biff : 8;
  if (biff >= 2 && biff <= 5) return parse_RgceLocRel_BIFF2(blob, length, opts);
  var r = blob.read_shift(biff >= 12 ? 4 : 2);
  var cl = blob.read_shift(2);
  var cRel = (cl & 16384) >> 14, rRel = (cl & 32768) >> 15;
  cl &= 16383;
  if (rRel == 1) while (r > 524287) r -= 1048576;
  if (cRel == 1) while (cl > 8191) cl = cl - 16384;
  return {
    r,
    c: cl,
    cRel,
    rRel
  };
}
function parse_RgceLocRel_BIFF2(blob) {
  var rl = blob.read_shift(2);
  var c = blob.read_shift(1);
  var rRel = (rl & 32768) >> 15, cRel = (rl & 16384) >> 14;
  rl &= 16383;
  if (rRel == 1 && rl >= 8192) rl = rl - 16384;
  if (cRel == 1 && c >= 128) c = c - 256;
  return {
    r: rl,
    c,
    cRel,
    rRel
  };
}
function parse_PtgArea(blob, length, opts) {
  var type = (blob[blob.l++] & 96) >> 5;
  var area = parse_RgceArea(blob, opts.biff >= 2 && opts.biff <= 5 ? 6 : 8, opts);
  return [type, area];
}
function parse_PtgArea3d(blob, length, opts) {
  var type = (blob[blob.l++] & 96) >> 5;
  var ixti = blob.read_shift(2, "i");
  var w = 8;
  if (opts) switch (opts.biff) {
    case 5:
      blob.l += 12;
      w = 6;
      break;
    case 12:
      w = 12;
      break;
  }
  var area = parse_RgceArea(blob, w, opts);
  return [type, ixti, area];
}
function parse_PtgAreaErr(blob, length, opts) {
  var type = (blob[blob.l++] & 96) >> 5;
  blob.l += opts && opts.biff > 8 ? 12 : opts.biff < 8 ? 6 : 8;
  return [type];
}
function parse_PtgAreaErr3d(blob, length, opts) {
  var type = (blob[blob.l++] & 96) >> 5;
  var ixti = blob.read_shift(2);
  var w = 8;
  if (opts) switch (opts.biff) {
    case 5:
      blob.l += 12;
      w = 6;
      break;
    case 12:
      w = 12;
      break;
  }
  blob.l += w;
  return [type, ixti];
}
function parse_PtgAreaN(blob, length, opts) {
  var type = (blob[blob.l++] & 96) >> 5;
  var area = parse_RgceAreaRel(blob, length - 1, opts);
  return [type, area];
}
function parse_PtgArray(blob, length, opts) {
  var type = (blob[blob.l++] & 96) >> 5;
  blob.l += opts.biff == 2 ? 6 : opts.biff == 12 ? 14 : 7;
  return [type];
}
function parse_PtgAttrBaxcel(blob) {
  var bitSemi = blob[blob.l + 1] & 1;
  var bitBaxcel = 1;
  blob.l += 4;
  return [bitSemi, bitBaxcel];
}
function parse_PtgAttrChoose(blob, length, opts) {
  blob.l += 2;
  var offset = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);
  var o = [];
  for (var i = 0; i <= offset; ++i) o.push(blob.read_shift(opts && opts.biff == 2 ? 1 : 2));
  return o;
}
function parse_PtgAttrGoto(blob, length, opts) {
  var bitGoto = blob[blob.l + 1] & 255 ? 1 : 0;
  blob.l += 2;
  return [bitGoto, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];
}
function parse_PtgAttrIf(blob, length, opts) {
  var bitIf = blob[blob.l + 1] & 255 ? 1 : 0;
  blob.l += 2;
  return [bitIf, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];
}
function parse_PtgAttrIfError(blob) {
  var bitIf = blob[blob.l + 1] & 255 ? 1 : 0;
  blob.l += 2;
  return [bitIf, blob.read_shift(2)];
}
function parse_PtgAttrSemi(blob, length, opts) {
  var bitSemi = blob[blob.l + 1] & 255 ? 1 : 0;
  blob.l += opts && opts.biff == 2 ? 3 : 4;
  return [bitSemi];
}
function parse_PtgAttrSpaceType(blob) {
  var type = blob.read_shift(1), cch = blob.read_shift(1);
  return [type, cch];
}
function parse_PtgAttrSpace(blob) {
  blob.read_shift(2);
  return parse_PtgAttrSpaceType(blob, 2);
}
function parse_PtgAttrSpaceSemi(blob) {
  blob.read_shift(2);
  return parse_PtgAttrSpaceType(blob, 2);
}
function parse_PtgRef(blob, length, opts) {
  var type = (blob[blob.l] & 96) >> 5;
  blob.l += 1;
  var loc = parse_RgceLoc(blob, 0, opts);
  return [type, loc];
}
function parse_PtgRefN(blob, length, opts) {
  var type = (blob[blob.l] & 96) >> 5;
  blob.l += 1;
  var loc = parse_RgceLocRel(blob, 0, opts);
  return [type, loc];
}
function parse_PtgRef3d(blob, length, opts) {
  var type = (blob[blob.l] & 96) >> 5;
  blob.l += 1;
  var ixti = blob.read_shift(2);
  if (opts && opts.biff == 5) blob.l += 12;
  var loc = parse_RgceLoc(blob, 0, opts);
  return [type, ixti, loc];
}
function parse_PtgFunc(blob, length, opts) {
  var type = (blob[blob.l] & 96) >> 5;
  blob.l += 1;
  var iftab = blob.read_shift(opts && opts.biff <= 3 ? 1 : 2);
  return [FtabArgc[iftab], Ftab[iftab], type];
}
function parse_PtgFuncVar(blob, length, opts) {
  var type = blob[blob.l++];
  var cparams = blob.read_shift(1), tab = opts && opts.biff <= 3 ? [type == 88 ? -1 : 0, blob.read_shift(1)] : parsetab(blob);
  return [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];
}
function parsetab(blob) {
  return [blob[blob.l + 1] >> 7, blob.read_shift(2) & 32767];
}
function parse_PtgAttrSum(blob, length, opts) {
  blob.l += opts && opts.biff == 2 ? 3 : 4;
  return;
}
function parse_PtgExp(blob, length, opts) {
  blob.l++;
  if (opts && opts.biff == 12) return [blob.read_shift(4, "i"), 0];
  var row = blob.read_shift(2);
  var col = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);
  return [row, col];
}
function parse_PtgErr(blob) {
  blob.l++;
  return BErr[blob.read_shift(1)];
}
function parse_PtgInt(blob) {
  blob.l++;
  return blob.read_shift(2);
}
function parse_PtgBool(blob) {
  blob.l++;
  return blob.read_shift(1) !== 0;
}
function parse_PtgNum(blob) {
  blob.l++;
  return parse_Xnum(blob, 8);
}
function parse_PtgStr(blob, length, opts) {
  blob.l++;
  return parse_ShortXLUnicodeString(blob, length - 1, opts);
}
function parse_SerAr(blob, biff) {
  var val = [blob.read_shift(1)];
  if (biff == 12) switch (val[0]) {
    case 2:
      val[0] = 4;
      break;
    /* SerBool */
    case 4:
      val[0] = 16;
      break;
    /* SerErr */
    case 0:
      val[0] = 1;
      break;
    /* SerNum */
    case 1:
      val[0] = 2;
      break;
  }
  switch (val[0]) {
    case 4:
      val[1] = parsebool(blob, 1) ? "TRUE" : "FALSE";
      if (biff != 12) blob.l += 7;
      break;
    case 37:
    /* appears to be an alias */
    case 16:
      val[1] = BErr[blob[blob.l]];
      blob.l += biff == 12 ? 4 : 8;
      break;
    case 0:
      blob.l += 8;
      break;
    case 1:
      val[1] = parse_Xnum(blob, 8);
      break;
    case 2:
      val[1] = parse_XLUnicodeString2(blob, 0, {
        biff: biff > 0 && biff < 8 ? 2 : biff
      });
      break;
    default:
      throw new Error("Bad SerAr: " + val[0]);
  }
  return val;
}
function parse_PtgExtraMem(blob, cce, opts) {
  var count = blob.read_shift(opts.biff == 12 ? 4 : 2);
  var out = [];
  for (var i = 0; i != count; ++i) out.push((opts.biff == 12 ? parse_UncheckedRfX : parse_Ref8U)(blob, 8));
  return out;
}
function parse_PtgExtraArray(blob, length, opts) {
  var rows = 0, cols = 0;
  if (opts.biff == 12) {
    rows = blob.read_shift(4);
    cols = blob.read_shift(4);
  } else {
    cols = 1 + blob.read_shift(1);
    rows = 1 + blob.read_shift(2);
  }
  if (opts.biff >= 2 && opts.biff < 8) {
    --rows;
    if (--cols == 0) cols = 256;
  }
  for (var i = 0, o = []; i != rows && (o[i] = []); ++i) for (var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob, opts.biff);
  return o;
}
function parse_PtgName(blob, length, opts) {
  var type = blob.read_shift(1) >>> 5 & 3;
  var w = !opts || opts.biff >= 8 ? 4 : 2;
  var nameindex = blob.read_shift(w);
  switch (opts.biff) {
    case 2:
      blob.l += 5;
      break;
    case 3:
    case 4:
      blob.l += 8;
      break;
    case 5:
      blob.l += 12;
      break;
  }
  return [type, 0, nameindex];
}
function parse_PtgNameX(blob, length, opts) {
  if (opts.biff == 5) return parse_PtgNameX_BIFF5(blob, length, opts);
  var type = blob.read_shift(1) >>> 5 & 3;
  var ixti = blob.read_shift(2);
  var nameindex = blob.read_shift(4);
  return [type, ixti, nameindex];
}
function parse_PtgNameX_BIFF5(blob) {
  var type = blob.read_shift(1) >>> 5 & 3;
  var ixti = blob.read_shift(2, "i");
  blob.l += 8;
  var nameindex = blob.read_shift(2);
  blob.l += 12;
  return [type, ixti, nameindex];
}
function parse_PtgMemArea(blob, length, opts) {
  var type = blob.read_shift(1) >>> 5 & 3;
  blob.l += opts && opts.biff == 2 ? 3 : 4;
  var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);
  return [type, cce];
}
function parse_PtgMemFunc(blob, length, opts) {
  var type = blob.read_shift(1) >>> 5 & 3;
  var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);
  return [type, cce];
}
function parse_PtgRefErr(blob, length, opts) {
  var type = blob.read_shift(1) >>> 5 & 3;
  blob.l += 4;
  if (opts.biff < 8) blob.l--;
  if (opts.biff == 12) blob.l += 2;
  return [type];
}
function parse_PtgRefErr3d(blob, length, opts) {
  var type = (blob[blob.l++] & 96) >> 5;
  var ixti = blob.read_shift(2);
  var w = 4;
  if (opts) switch (opts.biff) {
    case 5:
      w = 15;
      break;
    case 12:
      w = 6;
      break;
  }
  blob.l += w;
  return [type, ixti];
}
var parse_PtgMemErr = parsenoop;
var parse_PtgMemNoMem = parsenoop;
var parse_PtgTbl = parsenoop;
function parse_PtgElfLoc(blob, length, opts) {
  blob.l += 2;
  return [parse_RgceElfLoc(blob, 4, opts)];
}
function parse_PtgElfNoop(blob) {
  blob.l += 6;
  return [];
}
var parse_PtgElfCol = parse_PtgElfLoc;
var parse_PtgElfColS = parse_PtgElfNoop;
var parse_PtgElfColSV = parse_PtgElfNoop;
var parse_PtgElfColV = parse_PtgElfLoc;
function parse_PtgElfLel(blob) {
  blob.l += 2;
  return [parseuint16(blob), blob.read_shift(2) & 1];
}
var parse_PtgElfRadical = parse_PtgElfLoc;
var parse_PtgElfRadicalLel = parse_PtgElfLel;
var parse_PtgElfRadicalS = parse_PtgElfNoop;
var parse_PtgElfRw = parse_PtgElfLoc;
var parse_PtgElfRwV = parse_PtgElfLoc;
var PtgListRT = ["Data", "All", "Headers", "??", "?Data2", "??", "?DataHeaders", "??", "Totals", "??", "??", "??", "?DataTotals", "??", "??", "??", "?Current"];
function parse_PtgList(blob) {
  blob.l += 2;
  var ixti = blob.read_shift(2);
  var flags = blob.read_shift(2);
  var idx = blob.read_shift(4);
  var c = blob.read_shift(2);
  var C = blob.read_shift(2);
  var rt = PtgListRT[flags >> 2 & 31];
  return {
    ixti,
    coltype: flags & 3,
    rt,
    idx,
    c,
    C
  };
}
function parse_PtgSxName(blob) {
  blob.l += 2;
  return [blob.read_shift(4)];
}
function parse_PtgSheet(blob, length, opts) {
  blob.l += 5;
  blob.l += 2;
  blob.l += opts.biff == 2 ? 1 : 4;
  return ["PTGSHEET"];
}
function parse_PtgEndSheet(blob, length, opts) {
  blob.l += opts.biff == 2 ? 4 : 5;
  return ["PTGENDSHEET"];
}
function parse_PtgMemAreaN(blob) {
  var type = blob.read_shift(1) >>> 5 & 3;
  var cce = blob.read_shift(2);
  return [type, cce];
}
function parse_PtgMemNoMemN(blob) {
  var type = blob.read_shift(1) >>> 5 & 3;
  var cce = blob.read_shift(2);
  return [type, cce];
}
function parse_PtgAttrNoop(blob) {
  blob.l += 4;
  return [0, 0];
}
var PtgTypes = {
  /*::[*/
  1: {
    n: "PtgExp",
    f: parse_PtgExp
  },
  /*::[*/
  2: {
    n: "PtgTbl",
    f: parse_PtgTbl
  },
  /*::[*/
  3: {
    n: "PtgAdd",
    f: parseread1
  },
  /*::[*/
  4: {
    n: "PtgSub",
    f: parseread1
  },
  /*::[*/
  5: {
    n: "PtgMul",
    f: parseread1
  },
  /*::[*/
  6: {
    n: "PtgDiv",
    f: parseread1
  },
  /*::[*/
  7: {
    n: "PtgPower",
    f: parseread1
  },
  /*::[*/
  8: {
    n: "PtgConcat",
    f: parseread1
  },
  /*::[*/
  9: {
    n: "PtgLt",
    f: parseread1
  },
  /*::[*/
  10: {
    n: "PtgLe",
    f: parseread1
  },
  /*::[*/
  11: {
    n: "PtgEq",
    f: parseread1
  },
  /*::[*/
  12: {
    n: "PtgGe",
    f: parseread1
  },
  /*::[*/
  13: {
    n: "PtgGt",
    f: parseread1
  },
  /*::[*/
  14: {
    n: "PtgNe",
    f: parseread1
  },
  /*::[*/
  15: {
    n: "PtgIsect",
    f: parseread1
  },
  /*::[*/
  16: {
    n: "PtgUnion",
    f: parseread1
  },
  /*::[*/
  17: {
    n: "PtgRange",
    f: parseread1
  },
  /*::[*/
  18: {
    n: "PtgUplus",
    f: parseread1
  },
  /*::[*/
  19: {
    n: "PtgUminus",
    f: parseread1
  },
  /*::[*/
  20: {
    n: "PtgPercent",
    f: parseread1
  },
  /*::[*/
  21: {
    n: "PtgParen",
    f: parseread1
  },
  /*::[*/
  22: {
    n: "PtgMissArg",
    f: parseread1
  },
  /*::[*/
  23: {
    n: "PtgStr",
    f: parse_PtgStr
  },
  /*::[*/
  26: {
    n: "PtgSheet",
    f: parse_PtgSheet
  },
  /*::[*/
  27: {
    n: "PtgEndSheet",
    f: parse_PtgEndSheet
  },
  /*::[*/
  28: {
    n: "PtgErr",
    f: parse_PtgErr
  },
  /*::[*/
  29: {
    n: "PtgBool",
    f: parse_PtgBool
  },
  /*::[*/
  30: {
    n: "PtgInt",
    f: parse_PtgInt
  },
  /*::[*/
  31: {
    n: "PtgNum",
    f: parse_PtgNum
  },
  /*::[*/
  32: {
    n: "PtgArray",
    f: parse_PtgArray
  },
  /*::[*/
  33: {
    n: "PtgFunc",
    f: parse_PtgFunc
  },
  /*::[*/
  34: {
    n: "PtgFuncVar",
    f: parse_PtgFuncVar
  },
  /*::[*/
  35: {
    n: "PtgName",
    f: parse_PtgName
  },
  /*::[*/
  36: {
    n: "PtgRef",
    f: parse_PtgRef
  },
  /*::[*/
  37: {
    n: "PtgArea",
    f: parse_PtgArea
  },
  /*::[*/
  38: {
    n: "PtgMemArea",
    f: parse_PtgMemArea
  },
  /*::[*/
  39: {
    n: "PtgMemErr",
    f: parse_PtgMemErr
  },
  /*::[*/
  40: {
    n: "PtgMemNoMem",
    f: parse_PtgMemNoMem
  },
  /*::[*/
  41: {
    n: "PtgMemFunc",
    f: parse_PtgMemFunc
  },
  /*::[*/
  42: {
    n: "PtgRefErr",
    f: parse_PtgRefErr
  },
  /*::[*/
  43: {
    n: "PtgAreaErr",
    f: parse_PtgAreaErr
  },
  /*::[*/
  44: {
    n: "PtgRefN",
    f: parse_PtgRefN
  },
  /*::[*/
  45: {
    n: "PtgAreaN",
    f: parse_PtgAreaN
  },
  /*::[*/
  46: {
    n: "PtgMemAreaN",
    f: parse_PtgMemAreaN
  },
  /*::[*/
  47: {
    n: "PtgMemNoMemN",
    f: parse_PtgMemNoMemN
  },
  /*::[*/
  57: {
    n: "PtgNameX",
    f: parse_PtgNameX
  },
  /*::[*/
  58: {
    n: "PtgRef3d",
    f: parse_PtgRef3d
  },
  /*::[*/
  59: {
    n: "PtgArea3d",
    f: parse_PtgArea3d
  },
  /*::[*/
  60: {
    n: "PtgRefErr3d",
    f: parse_PtgRefErr3d
  },
  /*::[*/
  61: {
    n: "PtgAreaErr3d",
    f: parse_PtgAreaErr3d
  },
  /*::[*/
  255: {}
};
var PtgDupes = {
  /*::[*/
  64: 32,
  /*::[*/
  96: 32,
  /*::[*/
  65: 33,
  /*::[*/
  97: 33,
  /*::[*/
  66: 34,
  /*::[*/
  98: 34,
  /*::[*/
  67: 35,
  /*::[*/
  99: 35,
  /*::[*/
  68: 36,
  /*::[*/
  100: 36,
  /*::[*/
  69: 37,
  /*::[*/
  101: 37,
  /*::[*/
  70: 38,
  /*::[*/
  102: 38,
  /*::[*/
  71: 39,
  /*::[*/
  103: 39,
  /*::[*/
  72: 40,
  /*::[*/
  104: 40,
  /*::[*/
  73: 41,
  /*::[*/
  105: 41,
  /*::[*/
  74: 42,
  /*::[*/
  106: 42,
  /*::[*/
  75: 43,
  /*::[*/
  107: 43,
  /*::[*/
  76: 44,
  /*::[*/
  108: 44,
  /*::[*/
  77: 45,
  /*::[*/
  109: 45,
  /*::[*/
  78: 46,
  /*::[*/
  110: 46,
  /*::[*/
  79: 47,
  /*::[*/
  111: 47,
  /*::[*/
  88: 34,
  /*::[*/
  120: 34,
  /*::[*/
  89: 57,
  /*::[*/
  121: 57,
  /*::[*/
  90: 58,
  /*::[*/
  122: 58,
  /*::[*/
  91: 59,
  /*::[*/
  123: 59,
  /*::[*/
  92: 60,
  /*::[*/
  124: 60,
  /*::[*/
  93: 61,
  /*::[*/
  125: 61
};
var Ptg18 = {
  /*::[*/
  1: {
    n: "PtgElfLel",
    f: parse_PtgElfLel
  },
  /*::[*/
  2: {
    n: "PtgElfRw",
    f: parse_PtgElfRw
  },
  /*::[*/
  3: {
    n: "PtgElfCol",
    f: parse_PtgElfCol
  },
  /*::[*/
  6: {
    n: "PtgElfRwV",
    f: parse_PtgElfRwV
  },
  /*::[*/
  7: {
    n: "PtgElfColV",
    f: parse_PtgElfColV
  },
  /*::[*/
  10: {
    n: "PtgElfRadical",
    f: parse_PtgElfRadical
  },
  /*::[*/
  11: {
    n: "PtgElfRadicalS",
    f: parse_PtgElfRadicalS
  },
  /*::[*/
  13: {
    n: "PtgElfColS",
    f: parse_PtgElfColS
  },
  /*::[*/
  15: {
    n: "PtgElfColSV",
    f: parse_PtgElfColSV
  },
  /*::[*/
  16: {
    n: "PtgElfRadicalLel",
    f: parse_PtgElfRadicalLel
  },
  /*::[*/
  25: {
    n: "PtgList",
    f: parse_PtgList
  },
  /*::[*/
  29: {
    n: "PtgSxName",
    f: parse_PtgSxName
  },
  /*::[*/
  255: {}
};
var Ptg19 = {
  /*::[*/
  0: {
    n: "PtgAttrNoop",
    f: parse_PtgAttrNoop
  },
  /*::[*/
  1: {
    n: "PtgAttrSemi",
    f: parse_PtgAttrSemi
  },
  /*::[*/
  2: {
    n: "PtgAttrIf",
    f: parse_PtgAttrIf
  },
  /*::[*/
  4: {
    n: "PtgAttrChoose",
    f: parse_PtgAttrChoose
  },
  /*::[*/
  8: {
    n: "PtgAttrGoto",
    f: parse_PtgAttrGoto
  },
  /*::[*/
  16: {
    n: "PtgAttrSum",
    f: parse_PtgAttrSum
  },
  /*::[*/
  32: {
    n: "PtgAttrBaxcel",
    f: parse_PtgAttrBaxcel
  },
  /*::[*/
  33: {
    n: "PtgAttrBaxcel",
    f: parse_PtgAttrBaxcel
  },
  /*::[*/
  64: {
    n: "PtgAttrSpace",
    f: parse_PtgAttrSpace
  },
  /*::[*/
  65: {
    n: "PtgAttrSpaceSemi",
    f: parse_PtgAttrSpaceSemi
  },
  /*::[*/
  128: {
    n: "PtgAttrIfError",
    f: parse_PtgAttrIfError
  },
  /*::[*/
  255: {}
};
function parse_RgbExtra(blob, length, rgce, opts) {
  if (opts.biff < 8) return parsenoop(blob, length);
  var target = blob.l + length;
  var o = [];
  for (var i = 0; i !== rgce.length; ++i) {
    switch (rgce[i][0]) {
      case "PtgArray":
        rgce[i][1] = parse_PtgExtraArray(blob, 0, opts);
        o.push(rgce[i][1]);
        break;
      case "PtgMemArea":
        rgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1], opts);
        o.push(rgce[i][2]);
        break;
      case "PtgExp":
        if (opts && opts.biff == 12) {
          rgce[i][1][1] = blob.read_shift(4);
          o.push(rgce[i][1]);
        }
        break;
      case "PtgList":
      /* TODO: PtgList -> PtgExtraList */
      case "PtgElfRadicalS":
      /* TODO: PtgElfRadicalS -> PtgExtraElf */
      case "PtgElfColS":
      /* TODO: PtgElfColS -> PtgExtraElf */
      case "PtgElfColSV":
        throw "Unsupported " + rgce[i][0];
      default:
        break;
    }
  }
  length = target - blob.l;
  if (length !== 0) o.push(parsenoop(blob, length));
  return o;
}
function parse_Rgce(blob, length, opts) {
  var target = blob.l + length;
  var R, id, ptgs = [];
  while (target != blob.l) {
    length = target - blob.l;
    id = blob[blob.l];
    R = PtgTypes[id] || PtgTypes[PtgDupes[id]];
    if (id === 24 || id === 25) R = (id === 24 ? Ptg18 : Ptg19)[blob[blob.l + 1]];
    if (!R || !R.f) {
      parsenoop(blob, length);
    } else {
      ptgs.push([R.n, R.f(blob, length, opts)]);
    }
  }
  return ptgs;
}
function stringify_array(f) {
  var o = [];
  for (var i = 0; i < f.length; ++i) {
    var x = f[i], r = [];
    for (var j = 0; j < x.length; ++j) {
      var y = x[j];
      if (y) switch (y[0]) {
        // TODO: handle embedded quotes
        case 2:
          r.push('"' + y[1].replace(/"/g, '""') + '"');
          break;
        default:
          r.push(y[1]);
      }
      else r.push("");
    }
    o.push(r.join(","));
  }
  return o.join(";");
}
var PtgBinOp = {
  PtgAdd: "+",
  PtgConcat: "&",
  PtgDiv: "/",
  PtgEq: "=",
  PtgGe: ">=",
  PtgGt: ">",
  PtgLe: "<=",
  PtgLt: "<",
  PtgMul: "*",
  PtgNe: "<>",
  PtgPower: "^",
  PtgSub: "-"
};
function formula_quote_sheet_name(sname, opts) {
  if (!sname && !(opts && opts.biff <= 5 && opts.biff >= 2)) throw new Error("empty sheet name");
  if (/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(sname)) return "'" + sname + "'";
  return sname;
}
function get_ixti_raw(supbooks, ixti, opts) {
  if (!supbooks) return "SH33TJSERR0";
  if (opts.biff > 8 && (!supbooks.XTI || !supbooks.XTI[ixti])) return supbooks.SheetNames[ixti];
  if (!supbooks.XTI) return "SH33TJSERR6";
  var XTI = supbooks.XTI[ixti];
  if (opts.biff < 8) {
    if (ixti > 1e4) ixti -= 65536;
    if (ixti < 0) ixti = -ixti;
    return ixti == 0 ? "" : supbooks.XTI[ixti - 1];
  }
  if (!XTI) return "SH33TJSERR1";
  var o = "";
  if (opts.biff > 8) switch (supbooks[XTI[0]][0]) {
    case 357:
      o = XTI[1] == -1 ? "#REF" : supbooks.SheetNames[XTI[1]];
      return XTI[1] == XTI[2] ? o : o + ":" + supbooks.SheetNames[XTI[2]];
    case 358:
      if (opts.SID != null) return supbooks.SheetNames[opts.SID];
      return "SH33TJSSAME" + supbooks[XTI[0]][0];
    case 355:
    /* 'BrtSupBookSrc' */
    /* falls through */
    default:
      return "SH33TJSSRC" + supbooks[XTI[0]][0];
  }
  switch (supbooks[XTI[0]][0][0]) {
    case 1025:
      o = XTI[1] == -1 ? "#REF" : supbooks.SheetNames[XTI[1]] || "SH33TJSERR3";
      return XTI[1] == XTI[2] ? o : o + ":" + supbooks.SheetNames[XTI[2]];
    case 14849:
      return supbooks[XTI[0]].slice(1).map(function(name) {
        return name.Name;
      }).join(";;");
    //return "SH33TJSERR8";
    default:
      if (!supbooks[XTI[0]][0][3]) return "SH33TJSERR2";
      o = XTI[1] == -1 ? "#REF" : supbooks[XTI[0]][0][3][XTI[1]] || "SH33TJSERR4";
      return XTI[1] == XTI[2] ? o : o + ":" + supbooks[XTI[0]][0][3][XTI[2]];
  }
}
function get_ixti(supbooks, ixti, opts) {
  var ixtiraw = get_ixti_raw(supbooks, ixti, opts);
  return ixtiraw == "#REF" ? ixtiraw : formula_quote_sheet_name(ixtiraw, opts);
}
function stringify_formula(formula, range, cell, supbooks, opts) {
  var biff = opts && opts.biff || 8;
  var _range = (
    /*range != null ? range :*/
    {
      s: {
        c: 0,
        r: 0
      },
      e: {
        c: 0,
        r: 0
      }
    }
  );
  var stack = [], e1, e2, c, ixti = 0, nameidx = 0, r, sname = "";
  if (!formula[0] || !formula[0][0]) return "";
  var last_sp = -1, sp = "";
  for (var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {
    var f = formula[0][ff];
    switch (f[0]) {
      case "PtgUminus":
        stack.push("-" + stack.pop());
        break;
      case "PtgUplus":
        stack.push("+" + stack.pop());
        break;
      case "PtgPercent":
        stack.push(stack.pop() + "%");
        break;
      case "PtgAdd":
      /* [MS-XLS] 2.5.198.26 */
      case "PtgConcat":
      /* [MS-XLS] 2.5.198.43 */
      case "PtgDiv":
      /* [MS-XLS] 2.5.198.45 */
      case "PtgEq":
      /* [MS-XLS] 2.5.198.56 */
      case "PtgGe":
      /* [MS-XLS] 2.5.198.64 */
      case "PtgGt":
      /* [MS-XLS] 2.5.198.65 */
      case "PtgLe":
      /* [MS-XLS] 2.5.198.68 */
      case "PtgLt":
      /* [MS-XLS] 2.5.198.69 */
      case "PtgMul":
      /* [MS-XLS] 2.5.198.75 */
      case "PtgNe":
      /* [MS-XLS] 2.5.198.78 */
      case "PtgPower":
      /* [MS-XLS] 2.5.198.82 */
      case "PtgSub":
        e1 = stack.pop();
        e2 = stack.pop();
        if (last_sp >= 0) {
          switch (formula[0][last_sp][1][0]) {
            case 0:
              sp = fill(" ", formula[0][last_sp][1][1]);
              break;
            case 1:
              sp = fill("\r", formula[0][last_sp][1][1]);
              break;
            default:
              sp = "";
              if (opts.WTF) throw new Error("Unexpected PtgAttrSpaceType " + formula[0][last_sp][1][0]);
          }
          e2 = e2 + sp;
          last_sp = -1;
        }
        stack.push(e2 + PtgBinOp[f[0]] + e1);
        break;
      case "PtgIsect":
        e1 = stack.pop();
        e2 = stack.pop();
        stack.push(e2 + " " + e1);
        break;
      case "PtgUnion":
        e1 = stack.pop();
        e2 = stack.pop();
        stack.push(e2 + "," + e1);
        break;
      case "PtgRange":
        e1 = stack.pop();
        e2 = stack.pop();
        stack.push(e2 + ":" + e1);
        break;
      case "PtgAttrChoose":
        break;
      case "PtgAttrGoto":
        break;
      case "PtgAttrIf":
        break;
      case "PtgAttrIfError":
        break;
      case "PtgRef":
        c = shift_cell_xls(f[1][1], _range, opts);
        stack.push(encode_cell_xls(c, biff));
        break;
      case "PtgRefN":
        c = cell ? shift_cell_xls(f[1][1], cell, opts) : f[1][1];
        stack.push(encode_cell_xls(c, biff));
        break;
      case "PtgRef3d":
        ixti = /*::Number(*/
        f[1][1];
        c = shift_cell_xls(f[1][2], _range, opts);
        sname = get_ixti(supbooks, ixti, opts);
        var w = sname;
        stack.push(sname + "!" + encode_cell_xls(c, biff));
        break;
      case "PtgFunc":
      /* [MS-XLS] 2.5.198.62 */
      case "PtgFuncVar":
        var argc = f[1][0], func = f[1][1];
        if (!argc) argc = 0;
        argc &= 127;
        var args = argc == 0 ? [] : stack.slice(-argc);
        stack.length -= argc;
        if (func === "User") func = args.shift();
        stack.push(func + "(" + args.join(",") + ")");
        break;
      case "PtgBool":
        stack.push(f[1] ? "TRUE" : "FALSE");
        break;
      case "PtgInt":
        stack.push(
          /*::String(*/
          f[1]
          /*::)*/
        );
        break;
      case "PtgNum":
        stack.push(String(f[1]));
        break;
      case "PtgStr":
        stack.push('"' + f[1].replace(/"/g, '""') + '"');
        break;
      case "PtgErr":
        stack.push(
          /*::String(*/
          f[1]
          /*::)*/
        );
        break;
      case "PtgAreaN":
        r = shift_range_xls(f[1][1], cell ? {
          s: cell
        } : _range, opts);
        stack.push(encode_range_xls(r, opts));
        break;
      case "PtgArea":
        r = shift_range_xls(f[1][1], _range, opts);
        stack.push(encode_range_xls(r, opts));
        break;
      case "PtgArea3d":
        ixti = /*::Number(*/
        f[1][1];
        r = f[1][2];
        sname = get_ixti(supbooks, ixti, opts);
        stack.push(sname + "!" + encode_range_xls(r, opts));
        break;
      case "PtgAttrSum":
        stack.push("SUM(" + stack.pop() + ")");
        break;
      case "PtgAttrBaxcel":
      /* [MS-XLS] 2.5.198.33 */
      case "PtgAttrSemi":
        break;
      case "PtgName":
        nameidx = f[1][2];
        var lbl = (supbooks.names || [])[nameidx - 1] || (supbooks[0] || [])[nameidx];
        var name = lbl ? lbl.Name : "SH33TJSNAME" + String(nameidx);
        if (name && name.slice(0, 6) == "_xlfn." && !opts.xlfn) name = name.slice(6);
        stack.push(name);
        break;
      case "PtgNameX":
        var bookidx = f[1][1];
        nameidx = f[1][2];
        var externbook;
        if (opts.biff <= 5) {
          if (bookidx < 0) bookidx = -bookidx;
          if (supbooks[bookidx]) externbook = supbooks[bookidx][nameidx];
        } else {
          var o = "";
          if (((supbooks[bookidx] || [])[0] || [])[0] == 14849) {
          } else if (((supbooks[bookidx] || [])[0] || [])[0] == 1025) {
            if (supbooks[bookidx][nameidx] && supbooks[bookidx][nameidx].itab > 0) {
              o = supbooks.SheetNames[supbooks[bookidx][nameidx].itab - 1] + "!";
            }
          } else o = supbooks.SheetNames[nameidx - 1] + "!";
          if (supbooks[bookidx] && supbooks[bookidx][nameidx]) o += supbooks[bookidx][nameidx].Name;
          else if (supbooks[0] && supbooks[0][nameidx]) o += supbooks[0][nameidx].Name;
          else {
            var ixtidata = (get_ixti_raw(supbooks, bookidx, opts) || "").split(";;");
            if (ixtidata[nameidx - 1]) o = ixtidata[nameidx - 1];
            else o += "SH33TJSERRX";
          }
          stack.push(o);
          break;
        }
        if (!externbook) externbook = {
          Name: "SH33TJSERRY"
        };
        stack.push(externbook.Name);
        break;
      case "PtgParen":
        var lp = "(", rp = ")";
        if (last_sp >= 0) {
          sp = "";
          switch (formula[0][last_sp][1][0]) {
            // $FlowIgnore
            case 2:
              lp = fill(" ", formula[0][last_sp][1][1]) + lp;
              break;
            // $FlowIgnore
            case 3:
              lp = fill("\r", formula[0][last_sp][1][1]) + lp;
              break;
            // $FlowIgnore
            case 4:
              rp = fill(" ", formula[0][last_sp][1][1]) + rp;
              break;
            // $FlowIgnore
            case 5:
              rp = fill("\r", formula[0][last_sp][1][1]) + rp;
              break;
            default:
              if (opts.WTF) throw new Error("Unexpected PtgAttrSpaceType " + formula[0][last_sp][1][0]);
          }
          last_sp = -1;
        }
        stack.push(lp + stack.pop() + rp);
        break;
      case "PtgRefErr":
        stack.push("#REF!");
        break;
      case "PtgRefErr3d":
        stack.push("#REF!");
        break;
      case "PtgExp":
        c = {
          c: f[1][1],
          r: f[1][0]
          /*:any*/
        };
        var q = {
          c: cell.c,
          r: cell.r
        };
        if (supbooks.sharedf[encode_cell(c)]) {
          var parsedf = supbooks.sharedf[encode_cell(c)];
          stack.push(stringify_formula(parsedf, _range, q, supbooks, opts));
        } else {
          var fnd = false;
          for (e1 = 0; e1 != supbooks.arrayf.length; ++e1) {
            e2 = supbooks.arrayf[e1];
            if (c.c < e2[0].s.c || c.c > e2[0].e.c) continue;
            if (c.r < e2[0].s.r || c.r > e2[0].e.r) continue;
            stack.push(stringify_formula(e2[1], _range, q, supbooks, opts));
            fnd = true;
            break;
          }
          if (!fnd) stack.push(
            /*::String(*/
            f[1]
            /*::)*/
          );
        }
        break;
      case "PtgArray":
        stack.push("{" + stringify_array(
          /*::(*/
          f[1]
          /*:: :any)*/
        ) + "}");
        break;
      case "PtgMemArea":
        break;
      case "PtgAttrSpace":
      /* [MS-XLS] 2.5.198.38 */
      case "PtgAttrSpaceSemi":
        last_sp = ff;
        break;
      case "PtgTbl":
        break;
      case "PtgMemErr":
        break;
      case "PtgMissArg":
        stack.push("");
        break;
      case "PtgAreaErr":
        stack.push("#REF!");
        break;
      case "PtgAreaErr3d":
        stack.push("#REF!");
        break;
      case "PtgList":
        stack.push("Table" + f[1].idx + "[#" + f[1].rt + "]");
        break;
      case "PtgMemAreaN":
      case "PtgMemNoMemN":
      case "PtgAttrNoop":
      case "PtgSheet":
      case "PtgEndSheet":
        break;
      case "PtgMemFunc":
        break;
      case "PtgMemNoMem":
        break;
      case "PtgElfCol":
      /* [MS-XLS] 2.5.198.46 */
      case "PtgElfColS":
      /* [MS-XLS] 2.5.198.47 */
      case "PtgElfColSV":
      /* [MS-XLS] 2.5.198.48 */
      case "PtgElfColV":
      /* [MS-XLS] 2.5.198.49 */
      case "PtgElfLel":
      /* [MS-XLS] 2.5.198.50 */
      case "PtgElfRadical":
      /* [MS-XLS] 2.5.198.51 */
      case "PtgElfRadicalLel":
      /* [MS-XLS] 2.5.198.52 */
      case "PtgElfRadicalS":
      /* [MS-XLS] 2.5.198.53 */
      case "PtgElfRw":
      /* [MS-XLS] 2.5.198.54 */
      case "PtgElfRwV":
        throw new Error("Unsupported ELFs");
      case "PtgSxName":
        throw new Error("Unrecognized Formula Token: " + String(f));
      default:
        throw new Error("Unrecognized Formula Token: " + String(f));
    }
    var PtgNonDisp = ["PtgAttrSpace", "PtgAttrSpaceSemi", "PtgAttrGoto"];
    if (opts.biff != 3) {
      if (last_sp >= 0 && PtgNonDisp.indexOf(formula[0][ff][0]) == -1) {
        f = formula[0][last_sp];
        var _left = true;
        switch (f[1][0]) {
          /* note: some bad XLSB files omit the PtgParen */
          case 4:
            _left = false;
          /* falls through */
          case 0:
            sp = fill(" ", f[1][1]);
            break;
          case 5:
            _left = false;
          /* falls through */
          case 1:
            sp = fill("\r", f[1][1]);
            break;
          default:
            sp = "";
            if (opts.WTF) throw new Error("Unexpected PtgAttrSpaceType " + f[1][0]);
        }
        stack.push((_left ? sp : "") + stack.pop() + (_left ? "" : sp));
        last_sp = -1;
      }
    }
  }
  if (stack.length > 1 && opts.WTF) throw new Error("bad formula stack");
  return stack[0];
}
function write_FormulaValue(value) {
  if (value == null) {
    var o = new_buf(8);
    o.write_shift(1, 3);
    o.write_shift(1, 0);
    o.write_shift(2, 0);
    o.write_shift(2, 0);
    o.write_shift(2, 65535);
    return o;
  } else if (typeof value == "number") return write_Xnum(value);
  return write_Xnum(0);
}
function write_Formula(cell, R, C, opts, os) {
  var o1 = write_XLSCell(R, C, os);
  var o2 = write_FormulaValue(cell.v);
  var o3 = new_buf(6);
  var flags = 1 | 32;
  o3.write_shift(2, flags);
  o3.write_shift(4, 0);
  var bf = new_buf(cell.bf.length);
  for (var i = 0; i < cell.bf.length; ++i) bf[i] = cell.bf[i];
  var out = bconcat([o1, o2, o3, bf]);
  return out;
}
function parse_XLSBParsedFormula(data, length, opts) {
  var cce = data.read_shift(4);
  var rgce = parse_Rgce(data, cce, opts);
  var cb = data.read_shift(4);
  var rgcb = cb > 0 ? parse_RgbExtra(data, cb, rgce, opts) : null;
  return [rgce, rgcb];
}
var parse_XLSBArrayParsedFormula = parse_XLSBParsedFormula;
var parse_XLSBCellParsedFormula = parse_XLSBParsedFormula;
var parse_XLSBNameParsedFormula = parse_XLSBParsedFormula;
var parse_XLSBSharedParsedFormula = parse_XLSBParsedFormula;
var Cetab = {
  0: "BEEP",
  1: "OPEN",
  2: "OPEN.LINKS",
  3: "CLOSE.ALL",
  4: "SAVE",
  5: "SAVE.AS",
  6: "FILE.DELETE",
  7: "PAGE.SETUP",
  8: "PRINT",
  9: "PRINTER.SETUP",
  10: "QUIT",
  11: "NEW.WINDOW",
  12: "ARRANGE.ALL",
  13: "WINDOW.SIZE",
  14: "WINDOW.MOVE",
  15: "FULL",
  16: "CLOSE",
  17: "RUN",
  22: "SET.PRINT.AREA",
  23: "SET.PRINT.TITLES",
  24: "SET.PAGE.BREAK",
  25: "REMOVE.PAGE.BREAK",
  26: "FONT",
  27: "DISPLAY",
  28: "PROTECT.DOCUMENT",
  29: "PRECISION",
  30: "A1.R1C1",
  31: "CALCULATE.NOW",
  32: "CALCULATION",
  34: "DATA.FIND",
  35: "EXTRACT",
  36: "DATA.DELETE",
  37: "SET.DATABASE",
  38: "SET.CRITERIA",
  39: "SORT",
  40: "DATA.SERIES",
  41: "TABLE",
  42: "FORMAT.NUMBER",
  43: "ALIGNMENT",
  44: "STYLE",
  45: "BORDER",
  46: "CELL.PROTECTION",
  47: "COLUMN.WIDTH",
  48: "UNDO",
  49: "CUT",
  50: "COPY",
  51: "PASTE",
  52: "CLEAR",
  53: "PASTE.SPECIAL",
  54: "EDIT.DELETE",
  55: "INSERT",
  56: "FILL.RIGHT",
  57: "FILL.DOWN",
  61: "DEFINE.NAME",
  62: "CREATE.NAMES",
  63: "FORMULA.GOTO",
  64: "FORMULA.FIND",
  65: "SELECT.LAST.CELL",
  66: "SHOW.ACTIVE.CELL",
  67: "GALLERY.AREA",
  68: "GALLERY.BAR",
  69: "GALLERY.COLUMN",
  70: "GALLERY.LINE",
  71: "GALLERY.PIE",
  72: "GALLERY.SCATTER",
  73: "COMBINATION",
  74: "PREFERRED",
  75: "ADD.OVERLAY",
  76: "GRIDLINES",
  77: "SET.PREFERRED",
  78: "AXES",
  79: "LEGEND",
  80: "ATTACH.TEXT",
  81: "ADD.ARROW",
  82: "SELECT.CHART",
  83: "SELECT.PLOT.AREA",
  84: "PATTERNS",
  85: "MAIN.CHART",
  86: "OVERLAY",
  87: "SCALE",
  88: "FORMAT.LEGEND",
  89: "FORMAT.TEXT",
  90: "EDIT.REPEAT",
  91: "PARSE",
  92: "JUSTIFY",
  93: "HIDE",
  94: "UNHIDE",
  95: "WORKSPACE",
  96: "FORMULA",
  97: "FORMULA.FILL",
  98: "FORMULA.ARRAY",
  99: "DATA.FIND.NEXT",
  100: "DATA.FIND.PREV",
  101: "FORMULA.FIND.NEXT",
  102: "FORMULA.FIND.PREV",
  103: "ACTIVATE",
  104: "ACTIVATE.NEXT",
  105: "ACTIVATE.PREV",
  106: "UNLOCKED.NEXT",
  107: "UNLOCKED.PREV",
  108: "COPY.PICTURE",
  109: "SELECT",
  110: "DELETE.NAME",
  111: "DELETE.FORMAT",
  112: "VLINE",
  113: "HLINE",
  114: "VPAGE",
  115: "HPAGE",
  116: "VSCROLL",
  117: "HSCROLL",
  118: "ALERT",
  119: "NEW",
  120: "CANCEL.COPY",
  121: "SHOW.CLIPBOARD",
  122: "MESSAGE",
  124: "PASTE.LINK",
  125: "APP.ACTIVATE",
  126: "DELETE.ARROW",
  127: "ROW.HEIGHT",
  128: "FORMAT.MOVE",
  129: "FORMAT.SIZE",
  130: "FORMULA.REPLACE",
  131: "SEND.KEYS",
  132: "SELECT.SPECIAL",
  133: "APPLY.NAMES",
  134: "REPLACE.FONT",
  135: "FREEZE.PANES",
  136: "SHOW.INFO",
  137: "SPLIT",
  138: "ON.WINDOW",
  139: "ON.DATA",
  140: "DISABLE.INPUT",
  142: "OUTLINE",
  143: "LIST.NAMES",
  144: "FILE.CLOSE",
  145: "SAVE.WORKBOOK",
  146: "DATA.FORM",
  147: "COPY.CHART",
  148: "ON.TIME",
  149: "WAIT",
  150: "FORMAT.FONT",
  151: "FILL.UP",
  152: "FILL.LEFT",
  153: "DELETE.OVERLAY",
  155: "SHORT.MENUS",
  159: "SET.UPDATE.STATUS",
  161: "COLOR.PALETTE",
  162: "DELETE.STYLE",
  163: "WINDOW.RESTORE",
  164: "WINDOW.MAXIMIZE",
  166: "CHANGE.LINK",
  167: "CALCULATE.DOCUMENT",
  168: "ON.KEY",
  169: "APP.RESTORE",
  170: "APP.MOVE",
  171: "APP.SIZE",
  172: "APP.MINIMIZE",
  173: "APP.MAXIMIZE",
  174: "BRING.TO.FRONT",
  175: "SEND.TO.BACK",
  185: "MAIN.CHART.TYPE",
  186: "OVERLAY.CHART.TYPE",
  187: "SELECT.END",
  188: "OPEN.MAIL",
  189: "SEND.MAIL",
  190: "STANDARD.FONT",
  191: "CONSOLIDATE",
  192: "SORT.SPECIAL",
  193: "GALLERY.3D.AREA",
  194: "GALLERY.3D.COLUMN",
  195: "GALLERY.3D.LINE",
  196: "GALLERY.3D.PIE",
  197: "VIEW.3D",
  198: "GOAL.SEEK",
  199: "WORKGROUP",
  200: "FILL.GROUP",
  201: "UPDATE.LINK",
  202: "PROMOTE",
  203: "DEMOTE",
  204: "SHOW.DETAIL",
  206: "UNGROUP",
  207: "OBJECT.PROPERTIES",
  208: "SAVE.NEW.OBJECT",
  209: "SHARE",
  210: "SHARE.NAME",
  211: "DUPLICATE",
  212: "APPLY.STYLE",
  213: "ASSIGN.TO.OBJECT",
  214: "OBJECT.PROTECTION",
  215: "HIDE.OBJECT",
  216: "SET.EXTRACT",
  217: "CREATE.PUBLISHER",
  218: "SUBSCRIBE.TO",
  219: "ATTRIBUTES",
  220: "SHOW.TOOLBAR",
  222: "PRINT.PREVIEW",
  223: "EDIT.COLOR",
  224: "SHOW.LEVELS",
  225: "FORMAT.MAIN",
  226: "FORMAT.OVERLAY",
  227: "ON.RECALC",
  228: "EDIT.SERIES",
  229: "DEFINE.STYLE",
  240: "LINE.PRINT",
  243: "ENTER.DATA",
  249: "GALLERY.RADAR",
  250: "MERGE.STYLES",
  251: "EDITION.OPTIONS",
  252: "PASTE.PICTURE",
  253: "PASTE.PICTURE.LINK",
  254: "SPELLING",
  256: "ZOOM",
  259: "INSERT.OBJECT",
  260: "WINDOW.MINIMIZE",
  265: "SOUND.NOTE",
  266: "SOUND.PLAY",
  267: "FORMAT.SHAPE",
  268: "EXTEND.POLYGON",
  269: "FORMAT.AUTO",
  272: "GALLERY.3D.BAR",
  273: "GALLERY.3D.SURFACE",
  274: "FILL.AUTO",
  276: "CUSTOMIZE.TOOLBAR",
  277: "ADD.TOOL",
  278: "EDIT.OBJECT",
  279: "ON.DOUBLECLICK",
  280: "ON.ENTRY",
  281: "WORKBOOK.ADD",
  282: "WORKBOOK.MOVE",
  283: "WORKBOOK.COPY",
  284: "WORKBOOK.OPTIONS",
  285: "SAVE.WORKSPACE",
  288: "CHART.WIZARD",
  289: "DELETE.TOOL",
  290: "MOVE.TOOL",
  291: "WORKBOOK.SELECT",
  292: "WORKBOOK.ACTIVATE",
  293: "ASSIGN.TO.TOOL",
  295: "COPY.TOOL",
  296: "RESET.TOOL",
  297: "CONSTRAIN.NUMERIC",
  298: "PASTE.TOOL",
  302: "WORKBOOK.NEW",
  305: "SCENARIO.CELLS",
  306: "SCENARIO.DELETE",
  307: "SCENARIO.ADD",
  308: "SCENARIO.EDIT",
  309: "SCENARIO.SHOW",
  310: "SCENARIO.SHOW.NEXT",
  311: "SCENARIO.SUMMARY",
  312: "PIVOT.TABLE.WIZARD",
  313: "PIVOT.FIELD.PROPERTIES",
  314: "PIVOT.FIELD",
  315: "PIVOT.ITEM",
  316: "PIVOT.ADD.FIELDS",
  318: "OPTIONS.CALCULATION",
  319: "OPTIONS.EDIT",
  320: "OPTIONS.VIEW",
  321: "ADDIN.MANAGER",
  322: "MENU.EDITOR",
  323: "ATTACH.TOOLBARS",
  324: "VBAActivate",
  325: "OPTIONS.CHART",
  328: "VBA.INSERT.FILE",
  330: "VBA.PROCEDURE.DEFINITION",
  336: "ROUTING.SLIP",
  338: "ROUTE.DOCUMENT",
  339: "MAIL.LOGON",
  342: "INSERT.PICTURE",
  343: "EDIT.TOOL",
  344: "GALLERY.DOUGHNUT",
  350: "CHART.TREND",
  352: "PIVOT.ITEM.PROPERTIES",
  354: "WORKBOOK.INSERT",
  355: "OPTIONS.TRANSITION",
  356: "OPTIONS.GENERAL",
  370: "FILTER.ADVANCED",
  373: "MAIL.ADD.MAILER",
  374: "MAIL.DELETE.MAILER",
  375: "MAIL.REPLY",
  376: "MAIL.REPLY.ALL",
  377: "MAIL.FORWARD",
  378: "MAIL.NEXT.LETTER",
  379: "DATA.LABEL",
  380: "INSERT.TITLE",
  381: "FONT.PROPERTIES",
  382: "MACRO.OPTIONS",
  383: "WORKBOOK.HIDE",
  384: "WORKBOOK.UNHIDE",
  385: "WORKBOOK.DELETE",
  386: "WORKBOOK.NAME",
  388: "GALLERY.CUSTOM",
  390: "ADD.CHART.AUTOFORMAT",
  391: "DELETE.CHART.AUTOFORMAT",
  392: "CHART.ADD.DATA",
  393: "AUTO.OUTLINE",
  394: "TAB.ORDER",
  395: "SHOW.DIALOG",
  396: "SELECT.ALL",
  397: "UNGROUP.SHEETS",
  398: "SUBTOTAL.CREATE",
  399: "SUBTOTAL.REMOVE",
  400: "RENAME.OBJECT",
  412: "WORKBOOK.SCROLL",
  413: "WORKBOOK.NEXT",
  414: "WORKBOOK.PREV",
  415: "WORKBOOK.TAB.SPLIT",
  416: "FULL.SCREEN",
  417: "WORKBOOK.PROTECT",
  420: "SCROLLBAR.PROPERTIES",
  421: "PIVOT.SHOW.PAGES",
  422: "TEXT.TO.COLUMNS",
  423: "FORMAT.CHARTTYPE",
  424: "LINK.FORMAT",
  425: "TRACER.DISPLAY",
  430: "TRACER.NAVIGATE",
  431: "TRACER.CLEAR",
  432: "TRACER.ERROR",
  433: "PIVOT.FIELD.GROUP",
  434: "PIVOT.FIELD.UNGROUP",
  435: "CHECKBOX.PROPERTIES",
  436: "LABEL.PROPERTIES",
  437: "LISTBOX.PROPERTIES",
  438: "EDITBOX.PROPERTIES",
  439: "PIVOT.REFRESH",
  440: "LINK.COMBO",
  441: "OPEN.TEXT",
  442: "HIDE.DIALOG",
  443: "SET.DIALOG.FOCUS",
  444: "ENABLE.OBJECT",
  445: "PUSHBUTTON.PROPERTIES",
  446: "SET.DIALOG.DEFAULT",
  447: "FILTER",
  448: "FILTER.SHOW.ALL",
  449: "CLEAR.OUTLINE",
  450: "FUNCTION.WIZARD",
  451: "ADD.LIST.ITEM",
  452: "SET.LIST.ITEM",
  453: "REMOVE.LIST.ITEM",
  454: "SELECT.LIST.ITEM",
  455: "SET.CONTROL.VALUE",
  456: "SAVE.COPY.AS",
  458: "OPTIONS.LISTS.ADD",
  459: "OPTIONS.LISTS.DELETE",
  460: "SERIES.AXES",
  461: "SERIES.X",
  462: "SERIES.Y",
  463: "ERRORBAR.X",
  464: "ERRORBAR.Y",
  465: "FORMAT.CHART",
  466: "SERIES.ORDER",
  467: "MAIL.LOGOFF",
  468: "CLEAR.ROUTING.SLIP",
  469: "APP.ACTIVATE.MICROSOFT",
  470: "MAIL.EDIT.MAILER",
  471: "ON.SHEET",
  472: "STANDARD.WIDTH",
  473: "SCENARIO.MERGE",
  474: "SUMMARY.INFO",
  475: "FIND.FILE",
  476: "ACTIVE.CELL.FONT",
  477: "ENABLE.TIPWIZARD",
  478: "VBA.MAKE.ADDIN",
  480: "INSERTDATATABLE",
  481: "WORKGROUP.OPTIONS",
  482: "MAIL.SEND.MAILER",
  485: "AUTOCORRECT",
  489: "POST.DOCUMENT",
  491: "PICKLIST",
  493: "VIEW.SHOW",
  494: "VIEW.DEFINE",
  495: "VIEW.DELETE",
  509: "SHEET.BACKGROUND",
  510: "INSERT.MAP.OBJECT",
  511: "OPTIONS.MENONO",
  517: "MSOCHECKS",
  518: "NORMAL",
  519: "LAYOUT",
  520: "RM.PRINT.AREA",
  521: "CLEAR.PRINT.AREA",
  522: "ADD.PRINT.AREA",
  523: "MOVE.BRK",
  545: "HIDECURR.NOTE",
  546: "HIDEALL.NOTES",
  547: "DELETE.NOTE",
  548: "TRAVERSE.NOTES",
  549: "ACTIVATE.NOTES",
  620: "PROTECT.REVISIONS",
  621: "UNPROTECT.REVISIONS",
  647: "OPTIONS.ME",
  653: "WEB.PUBLISH",
  667: "NEWWEBQUERY",
  673: "PIVOT.TABLE.CHART",
  753: "OPTIONS.SAVE",
  755: "OPTIONS.SPELL",
  808: "HIDEALL.INKANNOTS"
};
var Ftab = {
  0: "COUNT",
  1: "IF",
  2: "ISNA",
  3: "ISERROR",
  4: "SUM",
  5: "AVERAGE",
  6: "MIN",
  7: "MAX",
  8: "ROW",
  9: "COLUMN",
  10: "NA",
  11: "NPV",
  12: "STDEV",
  13: "DOLLAR",
  14: "FIXED",
  15: "SIN",
  16: "COS",
  17: "TAN",
  18: "ATAN",
  19: "PI",
  20: "SQRT",
  21: "EXP",
  22: "LN",
  23: "LOG10",
  24: "ABS",
  25: "INT",
  26: "SIGN",
  27: "ROUND",
  28: "LOOKUP",
  29: "INDEX",
  30: "REPT",
  31: "MID",
  32: "LEN",
  33: "VALUE",
  34: "TRUE",
  35: "FALSE",
  36: "AND",
  37: "OR",
  38: "NOT",
  39: "MOD",
  40: "DCOUNT",
  41: "DSUM",
  42: "DAVERAGE",
  43: "DMIN",
  44: "DMAX",
  45: "DSTDEV",
  46: "VAR",
  47: "DVAR",
  48: "TEXT",
  49: "LINEST",
  50: "TREND",
  51: "LOGEST",
  52: "GROWTH",
  53: "GOTO",
  54: "HALT",
  55: "RETURN",
  56: "PV",
  57: "FV",
  58: "NPER",
  59: "PMT",
  60: "RATE",
  61: "MIRR",
  62: "IRR",
  63: "RAND",
  64: "MATCH",
  65: "DATE",
  66: "TIME",
  67: "DAY",
  68: "MONTH",
  69: "YEAR",
  70: "WEEKDAY",
  71: "HOUR",
  72: "MINUTE",
  73: "SECOND",
  74: "NOW",
  75: "AREAS",
  76: "ROWS",
  77: "COLUMNS",
  78: "OFFSET",
  79: "ABSREF",
  80: "RELREF",
  81: "ARGUMENT",
  82: "SEARCH",
  83: "TRANSPOSE",
  84: "ERROR",
  85: "STEP",
  86: "TYPE",
  87: "ECHO",
  88: "SET.NAME",
  89: "CALLER",
  90: "DEREF",
  91: "WINDOWS",
  92: "SERIES",
  93: "DOCUMENTS",
  94: "ACTIVE.CELL",
  95: "SELECTION",
  96: "RESULT",
  97: "ATAN2",
  98: "ASIN",
  99: "ACOS",
  100: "CHOOSE",
  101: "HLOOKUP",
  102: "VLOOKUP",
  103: "LINKS",
  104: "INPUT",
  105: "ISREF",
  106: "GET.FORMULA",
  107: "GET.NAME",
  108: "SET.VALUE",
  109: "LOG",
  110: "EXEC",
  111: "CHAR",
  112: "LOWER",
  113: "UPPER",
  114: "PROPER",
  115: "LEFT",
  116: "RIGHT",
  117: "EXACT",
  118: "TRIM",
  119: "REPLACE",
  120: "SUBSTITUTE",
  121: "CODE",
  122: "NAMES",
  123: "DIRECTORY",
  124: "FIND",
  125: "CELL",
  126: "ISERR",
  127: "ISTEXT",
  128: "ISNUMBER",
  129: "ISBLANK",
  130: "T",
  131: "N",
  132: "FOPEN",
  133: "FCLOSE",
  134: "FSIZE",
  135: "FREADLN",
  136: "FREAD",
  137: "FWRITELN",
  138: "FWRITE",
  139: "FPOS",
  140: "DATEVALUE",
  141: "TIMEVALUE",
  142: "SLN",
  143: "SYD",
  144: "DDB",
  145: "GET.DEF",
  146: "REFTEXT",
  147: "TEXTREF",
  148: "INDIRECT",
  149: "REGISTER",
  150: "CALL",
  151: "ADD.BAR",
  152: "ADD.MENU",
  153: "ADD.COMMAND",
  154: "ENABLE.COMMAND",
  155: "CHECK.COMMAND",
  156: "RENAME.COMMAND",
  157: "SHOW.BAR",
  158: "DELETE.MENU",
  159: "DELETE.COMMAND",
  160: "GET.CHART.ITEM",
  161: "DIALOG.BOX",
  162: "CLEAN",
  163: "MDETERM",
  164: "MINVERSE",
  165: "MMULT",
  166: "FILES",
  167: "IPMT",
  168: "PPMT",
  169: "COUNTA",
  170: "CANCEL.KEY",
  171: "FOR",
  172: "WHILE",
  173: "BREAK",
  174: "NEXT",
  175: "INITIATE",
  176: "REQUEST",
  177: "POKE",
  178: "EXECUTE",
  179: "TERMINATE",
  180: "RESTART",
  181: "HELP",
  182: "GET.BAR",
  183: "PRODUCT",
  184: "FACT",
  185: "GET.CELL",
  186: "GET.WORKSPACE",
  187: "GET.WINDOW",
  188: "GET.DOCUMENT",
  189: "DPRODUCT",
  190: "ISNONTEXT",
  191: "GET.NOTE",
  192: "NOTE",
  193: "STDEVP",
  194: "VARP",
  195: "DSTDEVP",
  196: "DVARP",
  197: "TRUNC",
  198: "ISLOGICAL",
  199: "DCOUNTA",
  200: "DELETE.BAR",
  201: "UNREGISTER",
  204: "USDOLLAR",
  205: "FINDB",
  206: "SEARCHB",
  207: "REPLACEB",
  208: "LEFTB",
  209: "RIGHTB",
  210: "MIDB",
  211: "LENB",
  212: "ROUNDUP",
  213: "ROUNDDOWN",
  214: "ASC",
  215: "DBCS",
  216: "RANK",
  219: "ADDRESS",
  220: "DAYS360",
  221: "TODAY",
  222: "VDB",
  223: "ELSE",
  224: "ELSE.IF",
  225: "END.IF",
  226: "FOR.CELL",
  227: "MEDIAN",
  228: "SUMPRODUCT",
  229: "SINH",
  230: "COSH",
  231: "TANH",
  232: "ASINH",
  233: "ACOSH",
  234: "ATANH",
  235: "DGET",
  236: "CREATE.OBJECT",
  237: "VOLATILE",
  238: "LAST.ERROR",
  239: "CUSTOM.UNDO",
  240: "CUSTOM.REPEAT",
  241: "FORMULA.CONVERT",
  242: "GET.LINK.INFO",
  243: "TEXT.BOX",
  244: "INFO",
  245: "GROUP",
  246: "GET.OBJECT",
  247: "DB",
  248: "PAUSE",
  251: "RESUME",
  252: "FREQUENCY",
  253: "ADD.TOOLBAR",
  254: "DELETE.TOOLBAR",
  255: "User",
  256: "RESET.TOOLBAR",
  257: "EVALUATE",
  258: "GET.TOOLBAR",
  259: "GET.TOOL",
  260: "SPELLING.CHECK",
  261: "ERROR.TYPE",
  262: "APP.TITLE",
  263: "WINDOW.TITLE",
  264: "SAVE.TOOLBAR",
  265: "ENABLE.TOOL",
  266: "PRESS.TOOL",
  267: "REGISTER.ID",
  268: "GET.WORKBOOK",
  269: "AVEDEV",
  270: "BETADIST",
  271: "GAMMALN",
  272: "BETAINV",
  273: "BINOMDIST",
  274: "CHIDIST",
  275: "CHIINV",
  276: "COMBIN",
  277: "CONFIDENCE",
  278: "CRITBINOM",
  279: "EVEN",
  280: "EXPONDIST",
  281: "FDIST",
  282: "FINV",
  283: "FISHER",
  284: "FISHERINV",
  285: "FLOOR",
  286: "GAMMADIST",
  287: "GAMMAINV",
  288: "CEILING",
  289: "HYPGEOMDIST",
  290: "LOGNORMDIST",
  291: "LOGINV",
  292: "NEGBINOMDIST",
  293: "NORMDIST",
  294: "NORMSDIST",
  295: "NORMINV",
  296: "NORMSINV",
  297: "STANDARDIZE",
  298: "ODD",
  299: "PERMUT",
  300: "POISSON",
  301: "TDIST",
  302: "WEIBULL",
  303: "SUMXMY2",
  304: "SUMX2MY2",
  305: "SUMX2PY2",
  306: "CHITEST",
  307: "CORREL",
  308: "COVAR",
  309: "FORECAST",
  310: "FTEST",
  311: "INTERCEPT",
  312: "PEARSON",
  313: "RSQ",
  314: "STEYX",
  315: "SLOPE",
  316: "TTEST",
  317: "PROB",
  318: "DEVSQ",
  319: "GEOMEAN",
  320: "HARMEAN",
  321: "SUMSQ",
  322: "KURT",
  323: "SKEW",
  324: "ZTEST",
  325: "LARGE",
  326: "SMALL",
  327: "QUARTILE",
  328: "PERCENTILE",
  329: "PERCENTRANK",
  330: "MODE",
  331: "TRIMMEAN",
  332: "TINV",
  334: "MOVIE.COMMAND",
  335: "GET.MOVIE",
  336: "CONCATENATE",
  337: "POWER",
  338: "PIVOT.ADD.DATA",
  339: "GET.PIVOT.TABLE",
  340: "GET.PIVOT.FIELD",
  341: "GET.PIVOT.ITEM",
  342: "RADIANS",
  343: "DEGREES",
  344: "SUBTOTAL",
  345: "SUMIF",
  346: "COUNTIF",
  347: "COUNTBLANK",
  348: "SCENARIO.GET",
  349: "OPTIONS.LISTS.GET",
  350: "ISPMT",
  351: "DATEDIF",
  352: "DATESTRING",
  353: "NUMBERSTRING",
  354: "ROMAN",
  355: "OPEN.DIALOG",
  356: "SAVE.DIALOG",
  357: "VIEW.GET",
  358: "GETPIVOTDATA",
  359: "HYPERLINK",
  360: "PHONETIC",
  361: "AVERAGEA",
  362: "MAXA",
  363: "MINA",
  364: "STDEVPA",
  365: "VARPA",
  366: "STDEVA",
  367: "VARA",
  368: "BAHTTEXT",
  369: "THAIDAYOFWEEK",
  370: "THAIDIGIT",
  371: "THAIMONTHOFYEAR",
  372: "THAINUMSOUND",
  373: "THAINUMSTRING",
  374: "THAISTRINGLENGTH",
  375: "ISTHAIDIGIT",
  376: "ROUNDBAHTDOWN",
  377: "ROUNDBAHTUP",
  378: "THAIYEAR",
  379: "RTD",
  380: "CUBEVALUE",
  381: "CUBEMEMBER",
  382: "CUBEMEMBERPROPERTY",
  383: "CUBERANKEDMEMBER",
  384: "HEX2BIN",
  385: "HEX2DEC",
  386: "HEX2OCT",
  387: "DEC2BIN",
  388: "DEC2HEX",
  389: "DEC2OCT",
  390: "OCT2BIN",
  391: "OCT2HEX",
  392: "OCT2DEC",
  393: "BIN2DEC",
  394: "BIN2OCT",
  395: "BIN2HEX",
  396: "IMSUB",
  397: "IMDIV",
  398: "IMPOWER",
  399: "IMABS",
  400: "IMSQRT",
  401: "IMLN",
  402: "IMLOG2",
  403: "IMLOG10",
  404: "IMSIN",
  405: "IMCOS",
  406: "IMEXP",
  407: "IMARGUMENT",
  408: "IMCONJUGATE",
  409: "IMAGINARY",
  410: "IMREAL",
  411: "COMPLEX",
  412: "IMSUM",
  413: "IMPRODUCT",
  414: "SERIESSUM",
  415: "FACTDOUBLE",
  416: "SQRTPI",
  417: "QUOTIENT",
  418: "DELTA",
  419: "GESTEP",
  420: "ISEVEN",
  421: "ISODD",
  422: "MROUND",
  423: "ERF",
  424: "ERFC",
  425: "BESSELJ",
  426: "BESSELK",
  427: "BESSELY",
  428: "BESSELI",
  429: "XIRR",
  430: "XNPV",
  431: "PRICEMAT",
  432: "YIELDMAT",
  433: "INTRATE",
  434: "RECEIVED",
  435: "DISC",
  436: "PRICEDISC",
  437: "YIELDDISC",
  438: "TBILLEQ",
  439: "TBILLPRICE",
  440: "TBILLYIELD",
  441: "PRICE",
  442: "YIELD",
  443: "DOLLARDE",
  444: "DOLLARFR",
  445: "NOMINAL",
  446: "EFFECT",
  447: "CUMPRINC",
  448: "CUMIPMT",
  449: "EDATE",
  450: "EOMONTH",
  451: "YEARFRAC",
  452: "COUPDAYBS",
  453: "COUPDAYS",
  454: "COUPDAYSNC",
  455: "COUPNCD",
  456: "COUPNUM",
  457: "COUPPCD",
  458: "DURATION",
  459: "MDURATION",
  460: "ODDLPRICE",
  461: "ODDLYIELD",
  462: "ODDFPRICE",
  463: "ODDFYIELD",
  464: "RANDBETWEEN",
  465: "WEEKNUM",
  466: "AMORDEGRC",
  467: "AMORLINC",
  468: "CONVERT",
  724: "SHEETJS",
  469: "ACCRINT",
  470: "ACCRINTM",
  471: "WORKDAY",
  472: "NETWORKDAYS",
  473: "GCD",
  474: "MULTINOMIAL",
  475: "LCM",
  476: "FVSCHEDULE",
  477: "CUBEKPIMEMBER",
  478: "CUBESET",
  479: "CUBESETCOUNT",
  480: "IFERROR",
  481: "COUNTIFS",
  482: "SUMIFS",
  483: "AVERAGEIF",
  484: "AVERAGEIFS"
};
var FtabArgc = {
  2: 1,
  3: 1,
  10: 0,
  15: 1,
  16: 1,
  17: 1,
  18: 1,
  19: 0,
  20: 1,
  21: 1,
  22: 1,
  23: 1,
  24: 1,
  25: 1,
  26: 1,
  27: 2,
  30: 2,
  31: 3,
  32: 1,
  33: 1,
  34: 0,
  35: 0,
  38: 1,
  39: 2,
  40: 3,
  41: 3,
  42: 3,
  43: 3,
  44: 3,
  45: 3,
  47: 3,
  48: 2,
  53: 1,
  61: 3,
  63: 0,
  65: 3,
  66: 3,
  67: 1,
  68: 1,
  69: 1,
  70: 1,
  71: 1,
  72: 1,
  73: 1,
  74: 0,
  75: 1,
  76: 1,
  77: 1,
  79: 2,
  80: 2,
  83: 1,
  85: 0,
  86: 1,
  89: 0,
  90: 1,
  94: 0,
  95: 0,
  97: 2,
  98: 1,
  99: 1,
  101: 3,
  102: 3,
  105: 1,
  106: 1,
  108: 2,
  111: 1,
  112: 1,
  113: 1,
  114: 1,
  117: 2,
  118: 1,
  119: 4,
  121: 1,
  126: 1,
  127: 1,
  128: 1,
  129: 1,
  130: 1,
  131: 1,
  133: 1,
  134: 1,
  135: 1,
  136: 2,
  137: 2,
  138: 2,
  140: 1,
  141: 1,
  142: 3,
  143: 4,
  144: 4,
  161: 1,
  162: 1,
  163: 1,
  164: 1,
  165: 2,
  172: 1,
  175: 2,
  176: 2,
  177: 3,
  178: 2,
  179: 1,
  184: 1,
  186: 1,
  189: 3,
  190: 1,
  195: 3,
  196: 3,
  197: 1,
  198: 1,
  199: 3,
  201: 1,
  207: 4,
  210: 3,
  211: 1,
  212: 2,
  213: 2,
  214: 1,
  215: 1,
  225: 0,
  229: 1,
  230: 1,
  231: 1,
  232: 1,
  233: 1,
  234: 1,
  235: 3,
  244: 1,
  247: 4,
  252: 2,
  257: 1,
  261: 1,
  271: 1,
  273: 4,
  274: 2,
  275: 2,
  276: 2,
  277: 3,
  278: 3,
  279: 1,
  280: 3,
  281: 3,
  282: 3,
  283: 1,
  284: 1,
  285: 2,
  286: 4,
  287: 3,
  288: 2,
  289: 4,
  290: 3,
  291: 3,
  292: 3,
  293: 4,
  294: 1,
  295: 3,
  296: 1,
  297: 3,
  298: 1,
  299: 2,
  300: 3,
  301: 3,
  302: 4,
  303: 2,
  304: 2,
  305: 2,
  306: 2,
  307: 2,
  308: 2,
  309: 3,
  310: 2,
  311: 2,
  312: 2,
  313: 2,
  314: 2,
  315: 2,
  316: 4,
  325: 2,
  326: 2,
  327: 2,
  328: 2,
  331: 2,
  332: 2,
  337: 2,
  342: 1,
  343: 1,
  346: 2,
  347: 1,
  350: 4,
  351: 3,
  352: 1,
  353: 2,
  360: 1,
  368: 1,
  369: 1,
  370: 1,
  371: 1,
  372: 1,
  373: 1,
  374: 1,
  375: 1,
  376: 1,
  377: 1,
  378: 1,
  382: 3,
  385: 1,
  392: 1,
  393: 1,
  396: 2,
  397: 2,
  398: 2,
  399: 1,
  400: 1,
  401: 1,
  402: 1,
  403: 1,
  404: 1,
  405: 1,
  406: 1,
  407: 1,
  408: 1,
  409: 1,
  410: 1,
  414: 4,
  415: 1,
  416: 1,
  417: 2,
  420: 1,
  421: 1,
  422: 2,
  424: 1,
  425: 2,
  426: 2,
  427: 2,
  428: 2,
  430: 3,
  438: 3,
  439: 3,
  440: 3,
  443: 2,
  444: 2,
  445: 2,
  446: 2,
  447: 6,
  448: 6,
  449: 2,
  450: 2,
  464: 2,
  468: 3,
  476: 2,
  479: 1,
  480: 2,
  65535: 0
};
function csf_to_ods_formula(f) {
  var o = "of:=" + f.replace(crefregex, "$1[.$2$3$4$5]").replace(/\]:\[/g, ":");
  return o.replace(/;/g, "|").replace(/,/g, ";");
}
function csf_to_ods_3D(r) {
  return r.replace(/\./, "!");
}
var browser_has_Map = typeof Map !== "undefined";
function get_sst_id(sst, str, rev) {
  var i = 0, len = sst.length;
  if (rev) {
    if (browser_has_Map ? rev.has(str) : Object.prototype.hasOwnProperty.call(rev, str)) {
      var revarr = browser_has_Map ? rev.get(str) : rev[str];
      for (; i < revarr.length; ++i) {
        if (sst[revarr[i]].t === str) {
          sst.Count++;
          return revarr[i];
        }
      }
    }
  } else for (; i < len; ++i) {
    if (sst[i].t === str) {
      sst.Count++;
      return i;
    }
  }
  sst[len] = {
    t: str
  };
  sst.Count++;
  sst.Unique++;
  if (rev) {
    if (browser_has_Map) {
      if (!rev.has(str)) rev.set(str, []);
      rev.get(str).push(len);
    } else {
      if (!Object.prototype.hasOwnProperty.call(rev, str)) rev[str] = [];
      rev[str].push(len);
    }
  }
  return len;
}
function col_obj_w(C, col) {
  var p = {
    min: C + 1,
    max: C + 1
  };
  var wch = -1;
  if (col.MDW) MDW = col.MDW;
  if (col.width != null) p.customWidth = 1;
  else if (col.wpx != null) wch = px2char(col.wpx);
  else if (col.wch != null) wch = col.wch;
  if (wch > -1) {
    p.width = char2width(wch);
    p.customWidth = 1;
  } else if (col.width != null) p.width = col.width;
  if (col.hidden) p.hidden = true;
  if (col.level != null) {
    p.outlineLevel = p.level = col.level;
  }
  return p;
}
function default_margins(margins, mode) {
  if (!margins) return;
  var defs = [0.7, 0.7, 0.75, 0.75, 0.3, 0.3];
  if (mode == "xlml") defs = [1, 1, 1, 1, 0.5, 0.5];
  if (margins.left == null) margins.left = defs[0];
  if (margins.right == null) margins.right = defs[1];
  if (margins.top == null) margins.top = defs[2];
  if (margins.bottom == null) margins.bottom = defs[3];
  if (margins.header == null) margins.header = defs[4];
  if (margins.footer == null) margins.footer = defs[5];
}
function get_cell_style(styles, cell, opts) {
  var z = opts.revssf[cell.z != null ? cell.z : "General"];
  var i = 60, len = styles.length;
  if (z == null && opts.ssf) {
    for (; i < 392; ++i) if (opts.ssf[i] == null) {
      SSF_load(cell.z, i);
      opts.ssf[i] = cell.z;
      opts.revssf[cell.z] = z = i;
      break;
    }
  }
  for (i = 0; i != len; ++i) if (styles[i].numFmtId === z) return i;
  styles[len] = {
    numFmtId: z,
    fontId: 0,
    fillId: 0,
    borderId: 0,
    xfId: 0,
    applyNumberFormat: 1
  };
  return len;
}
function check_ws(ws, sname, i) {
  if (ws && ws["!ref"]) {
    var range = safe_decode_range(ws["!ref"]);
    if (range.e.c < range.s.c || range.e.r < range.s.r) throw new Error("Bad range (" + i + "): " + ws["!ref"]);
  }
}
function write_ws_xml_merges(merges) {
  if (merges.length === 0) return "";
  var o = '<mergeCells count="' + merges.length + '">';
  for (var i = 0; i != merges.length; ++i) o += '<mergeCell ref="' + encode_range(merges[i]) + '"/>';
  return o + "</mergeCells>";
}
function write_ws_xml_sheetpr(ws, wb, idx, opts, o) {
  var needed = false;
  var props = {}, payload = null;
  if (opts.bookType !== "xlsx" && wb.vbaraw) {
    var cname = wb.SheetNames[idx];
    try {
      if (wb.Workbook) cname = wb.Workbook.Sheets[idx].CodeName || cname;
    } catch (e) {
    }
    needed = true;
    props.codeName = utf8write(escapexml(cname));
  }
  if (ws && ws["!outline"]) {
    var outlineprops = {
      summaryBelow: 1,
      summaryRight: 1
    };
    if (ws["!outline"].above) outlineprops.summaryBelow = 0;
    if (ws["!outline"].left) outlineprops.summaryRight = 0;
    payload = (payload || "") + writextag("outlinePr", null, outlineprops);
  }
  if (!needed && !payload) return;
  o[o.length] = writextag("sheetPr", payload, props);
}
var sheetprot_deffalse = ["objects", "scenarios", "selectLockedCells", "selectUnlockedCells"];
var sheetprot_deftrue = ["formatColumns", "formatRows", "formatCells", "insertColumns", "insertRows", "insertHyperlinks", "deleteColumns", "deleteRows", "sort", "autoFilter", "pivotTables"];
function write_ws_xml_protection(sp) {
  var o = {
    sheet: 1
  };
  sheetprot_deffalse.forEach(function(n) {
    if (sp[n] != null && sp[n]) o[n] = "1";
  });
  sheetprot_deftrue.forEach(function(n) {
    if (sp[n] != null && !sp[n]) o[n] = "0";
  });
  if (sp.password) o.password = crypto_CreatePasswordVerifier_Method1(sp.password).toString(16).toUpperCase();
  return writextag("sheetProtection", null, o);
}
function write_ws_xml_margins(margin) {
  default_margins(margin);
  return writextag("pageMargins", null, margin);
}
function write_ws_xml_cols(ws, cols) {
  var o = ["<cols>"], col;
  for (var i = 0; i != cols.length; ++i) {
    if (!(col = cols[i])) continue;
    o[o.length] = writextag("col", null, col_obj_w(i, col));
  }
  o[o.length] = "</cols>";
  return o.join("");
}
function write_ws_xml_autofilter(data, ws, wb, idx) {
  var ref = typeof data.ref == "string" ? data.ref : encode_range(data.ref);
  if (!wb.Workbook) wb.Workbook = {
    Sheets: []
  };
  if (!wb.Workbook.Names) wb.Workbook.Names = [];
  var names = wb.Workbook.Names;
  var range = decode_range(ref);
  if (range.s.r == range.e.r) {
    range.e.r = decode_range(ws["!ref"]).e.r;
    ref = encode_range(range);
  }
  for (var i = 0; i < names.length; ++i) {
    var name = names[i];
    if (name.Name != "_xlnm._FilterDatabase") continue;
    if (name.Sheet != idx) continue;
    name.Ref = "'" + wb.SheetNames[idx] + "'!" + ref;
    break;
  }
  if (i == names.length) names.push({
    Name: "_xlnm._FilterDatabase",
    Sheet: idx,
    Ref: "'" + wb.SheetNames[idx] + "'!" + ref
  });
  return writextag("autoFilter", null, {
    ref
  });
}
function write_ws_xml_sheetviews(ws, opts, idx, wb) {
  var sview = {
    workbookViewId: "0"
  };
  if ((((wb || {}).Workbook || {}).Views || [])[0]) sview.rightToLeft = wb.Workbook.Views[0].RTL ? "1" : "0";
  return writextag("sheetViews", writextag("sheetView", null, sview), {});
}
function write_ws_xml_cell(cell, ref, ws, opts) {
  if (cell.c) ws["!comments"].push([ref, cell.c]);
  if (cell.v === void 0 && typeof cell.f !== "string" || cell.t === "z" && !cell.f) return "";
  var vv = "";
  var oldt = cell.t, oldv = cell.v;
  if (cell.t !== "z") switch (cell.t) {
    case "b":
      vv = cell.v ? "1" : "0";
      break;
    case "n":
      vv = "" + cell.v;
      break;
    case "e":
      vv = BErr[cell.v];
      break;
    case "d":
      if (opts && opts.cellDates) vv = parseDate(cell.v, -1).toISOString();
      else {
        cell = dup(cell);
        cell.t = "n";
        vv = "" + (cell.v = datenum(parseDate(cell.v)));
      }
      if (typeof cell.z === "undefined") cell.z = table_fmt[14];
      break;
    default:
      vv = cell.v;
      break;
  }
  var v = writetag("v", escapexml(vv)), o = {
    r: ref
  };
  var os = get_cell_style(opts.cellXfs, cell, opts);
  if (os !== 0) o.s = os;
  switch (cell.t) {
    case "n":
      break;
    case "d":
      o.t = "d";
      break;
    case "b":
      o.t = "b";
      break;
    case "e":
      o.t = "e";
      break;
    case "z":
      break;
    default:
      if (cell.v == null) {
        delete cell.t;
        break;
      }
      if (cell.v.length > 32767) throw new Error("Text length must not exceed 32767 characters");
      if (opts && opts.bookSST) {
        v = writetag("v", "" + get_sst_id(opts.Strings, cell.v, opts.revStrings));
        o.t = "s";
        break;
      }
      o.t = "str";
      break;
  }
  if (cell.t != oldt) {
    cell.t = oldt;
    cell.v = oldv;
  }
  if (typeof cell.f == "string" && cell.f) {
    var ff = cell.F && cell.F.slice(0, ref.length) == ref ? {
      t: "array",
      ref: cell.F
    } : null;
    v = writextag("f", escapexml(cell.f), ff) + (cell.v != null ? v : "");
  }
  if (cell.l) ws["!links"].push([ref, cell.l]);
  if (cell.D) o.cm = 1;
  return writextag("c", v, o);
}
function write_ws_xml_data(ws, opts, idx, wb) {
  var o = [], r = [], range = safe_decode_range(ws["!ref"]), cell = "", ref, rr = "", cols = [], R = 0, C = 0, rows = ws["!rows"];
  var dense = Array.isArray(ws);
  var params = {
    r: rr
  }, row, height = -1;
  for (C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);
  for (R = range.s.r; R <= range.e.r; ++R) {
    r = [];
    rr = encode_row(R);
    for (C = range.s.c; C <= range.e.c; ++C) {
      ref = cols[C] + rr;
      var _cell = dense ? (ws[R] || [])[C] : ws[ref];
      if (_cell === void 0) continue;
      if ((cell = write_ws_xml_cell(_cell, ref, ws, opts, idx, wb)) != null) r.push(cell);
    }
    if (r.length > 0 || rows && rows[R]) {
      params = {
        r: rr
      };
      if (rows && rows[R]) {
        row = rows[R];
        if (row.hidden) params.hidden = 1;
        height = -1;
        if (row.hpx) height = px2pt(row.hpx);
        else if (row.hpt) height = row.hpt;
        if (height > -1) {
          params.ht = height;
          params.customHeight = 1;
        }
        if (row.level) {
          params.outlineLevel = row.level;
        }
      }
      o[o.length] = writextag("row", r.join(""), params);
    }
  }
  if (rows) for (; R < rows.length; ++R) {
    if (rows && rows[R]) {
      params = {
        r: R + 1
      };
      row = rows[R];
      if (row.hidden) params.hidden = 1;
      height = -1;
      if (row.hpx) height = px2pt(row.hpx);
      else if (row.hpt) height = row.hpt;
      if (height > -1) {
        params.ht = height;
        params.customHeight = 1;
      }
      if (row.level) {
        params.outlineLevel = row.level;
      }
      o[o.length] = writextag("row", "", params);
    }
  }
  return o.join("");
}
function write_ws_xml(idx, opts, wb, rels) {
  var o = [XML_HEADER, writextag("worksheet", null, {
    "xmlns": XMLNS_main[0],
    "xmlns:r": XMLNS.r
  })];
  var s = wb.SheetNames[idx], sidx = 0, rdata = "";
  var ws = wb.Sheets[s];
  if (ws == null) ws = {};
  var ref = ws["!ref"] || "A1";
  var range = safe_decode_range(ref);
  if (range.e.c > 16383 || range.e.r > 1048575) {
    if (opts.WTF) throw new Error("Range " + ref + " exceeds format limit A1:XFD1048576");
    range.e.c = Math.min(range.e.c, 16383);
    range.e.r = Math.min(range.e.c, 1048575);
    ref = encode_range(range);
  }
  if (!rels) rels = {};
  ws["!comments"] = [];
  var _drawing = [];
  write_ws_xml_sheetpr(ws, wb, idx, opts, o);
  o[o.length] = writextag("dimension", null, {
    "ref": ref
  });
  o[o.length] = write_ws_xml_sheetviews(ws, opts, idx, wb);
  if (opts.sheetFormat) o[o.length] = writextag("sheetFormatPr", null, {
    defaultRowHeight: opts.sheetFormat.defaultRowHeight || "16",
    baseColWidth: opts.sheetFormat.baseColWidth || "10",
    outlineLevelRow: opts.sheetFormat.outlineLevelRow || "7"
  });
  if (ws["!cols"] != null && ws["!cols"].length > 0) o[o.length] = write_ws_xml_cols(ws, ws["!cols"]);
  o[sidx = o.length] = "<sheetData/>";
  ws["!links"] = [];
  if (ws["!ref"] != null) {
    rdata = write_ws_xml_data(ws, opts, idx, wb, rels);
    if (rdata.length > 0) o[o.length] = rdata;
  }
  if (o.length > sidx + 1) {
    o[o.length] = "</sheetData>";
    o[sidx] = o[sidx].replace("/>", ">");
  }
  if (ws["!protect"]) o[o.length] = write_ws_xml_protection(ws["!protect"]);
  if (ws["!autofilter"] != null) o[o.length] = write_ws_xml_autofilter(ws["!autofilter"], ws, wb, idx);
  if (ws["!merges"] != null && ws["!merges"].length > 0) o[o.length] = write_ws_xml_merges(ws["!merges"]);
  var relc = -1, rel, rId = -1;
  if (
    /*::(*/
    ws["!links"].length > 0
  ) {
    o[o.length] = "<hyperlinks>";
    ws["!links"].forEach(function(l) {
      if (!l[1].Target) return;
      rel = {
        "ref": l[0]
      };
      if (l[1].Target.charAt(0) != "#") {
        rId = add_rels(rels, -1, escapexml(l[1].Target).replace(/#.*$/, ""), RELS.HLINK);
        rel["r:id"] = "rId" + rId;
      }
      if ((relc = l[1].Target.indexOf("#")) > -1) rel.location = escapexml(l[1].Target.slice(relc + 1));
      if (l[1].Tooltip) rel.tooltip = escapexml(l[1].Tooltip);
      o[o.length] = writextag("hyperlink", null, rel);
    });
    o[o.length] = "</hyperlinks>";
  }
  delete ws["!links"];
  if (ws["!margins"] != null) o[o.length] = write_ws_xml_margins(ws["!margins"]);
  if (!opts || opts.ignoreEC || opts.ignoreEC == void 0) o[o.length] = writetag("ignoredErrors", writextag("ignoredError", null, {
    numberStoredAsText: 1,
    sqref: ref
  }));
  if (_drawing.length > 0) {
    rId = add_rels(rels, -1, "../drawings/drawing" + (idx + 1) + ".xml", RELS.DRAW);
    o[o.length] = writextag("drawing", null, {
      "r:id": "rId" + rId
    });
    ws["!drawing"] = _drawing;
  }
  if (ws["!comments"].length > 0) {
    rId = add_rels(rels, -1, "../drawings/vmlDrawing" + (idx + 1) + ".vml", RELS.VML);
    o[o.length] = writextag("legacyDrawing", null, {
      "r:id": "rId" + rId
    });
    ws["!legacy"] = rId;
  }
  if (o.length > 1) {
    o[o.length] = "</worksheet>";
    o[1] = o[1].replace("/>", ">");
  }
  return o.join("");
}
function parse_BrtRowHdr(data, length) {
  var z = {};
  var tgt = data.l + length;
  z.r = data.read_shift(4);
  data.l += 4;
  var miyRw = data.read_shift(2);
  data.l += 1;
  var flags = data.read_shift(1);
  data.l = tgt;
  if (flags & 7) z.level = flags & 7;
  if (flags & 16) z.hidden = true;
  if (flags & 32) z.hpt = miyRw / 20;
  return z;
}
function write_BrtRowHdr(R, range, ws) {
  var o = new_buf(17 + 8 * 16);
  var row = (ws["!rows"] || [])[R] || {};
  o.write_shift(4, R);
  o.write_shift(4, 0);
  var miyRw = 320;
  if (row.hpx) miyRw = px2pt(row.hpx) * 20;
  else if (row.hpt) miyRw = row.hpt * 20;
  o.write_shift(2, miyRw);
  o.write_shift(1, 0);
  var flags = 0;
  if (row.level) flags |= row.level;
  if (row.hidden) flags |= 16;
  if (row.hpx || row.hpt) flags |= 32;
  o.write_shift(1, flags);
  o.write_shift(1, 0);
  var ncolspan = 0, lcs = o.l;
  o.l += 4;
  var caddr = {
    r: R,
    c: 0
  };
  for (var i = 0; i < 16; ++i) {
    if (range.s.c > i + 1 << 10 || range.e.c < i << 10) continue;
    var first = -1, last = -1;
    for (var j = i << 10; j < i + 1 << 10; ++j) {
      caddr.c = j;
      var cell = Array.isArray(ws) ? (ws[caddr.r] || [])[caddr.c] : ws[encode_cell(caddr)];
      if (cell) {
        if (first < 0) first = j;
        last = j;
      }
    }
    if (first < 0) continue;
    ++ncolspan;
    o.write_shift(4, first);
    o.write_shift(4, last);
  }
  var l = o.l;
  o.l = lcs;
  o.write_shift(4, ncolspan);
  o.l = l;
  return o.length > o.l ? o.slice(0, o.l) : o;
}
function write_row_header(ba, ws, range, R) {
  var o = write_BrtRowHdr(R, range, ws);
  if (o.length > 17 || (ws["!rows"] || [])[R]) write_record(ba, 0, o);
}
var parse_BrtWsDim = parse_UncheckedRfX;
var write_BrtWsDim = write_UncheckedRfX;
function parse_BrtWsFmtInfo() {
}
function parse_BrtWsProp(data, length) {
  var z = {};
  var f = data[data.l];
  ++data.l;
  z.above = !(f & 64);
  z.left = !(f & 128);
  data.l += 18;
  z.name = parse_XLSBCodeName(data, length - 19);
  return z;
}
function write_BrtWsProp(str, outl, o) {
  if (o == null) o = new_buf(84 + 4 * str.length);
  var f = 192;
  if (outl) {
    if (outl.above) f &= ~64;
    if (outl.left) f &= ~128;
  }
  o.write_shift(1, f);
  for (var i = 1; i < 3; ++i) o.write_shift(1, 0);
  write_BrtColor({
    auto: 1
  }, o);
  o.write_shift(-4, -1);
  o.write_shift(-4, -1);
  write_XLSBCodeName(str, o);
  return o.slice(0, o.l);
}
function parse_BrtCellBlank(data) {
  var cell = parse_XLSBCell(data);
  return [cell];
}
function write_BrtCellBlank(cell, ncell, o) {
  if (o == null) o = new_buf(8);
  return write_XLSBCell(ncell, o);
}
function parse_BrtShortBlank(data) {
  var cell = parse_XLSBShortCell(data);
  return [cell];
}
function write_BrtShortBlank(cell, ncell, o) {
  if (o == null) o = new_buf(4);
  return write_XLSBShortCell(ncell, o);
}
function parse_BrtCellBool(data) {
  var cell = parse_XLSBCell(data);
  var fBool = data.read_shift(1);
  return [cell, fBool, "b"];
}
function write_BrtCellBool(cell, ncell, o) {
  if (o == null) o = new_buf(9);
  write_XLSBCell(ncell, o);
  o.write_shift(1, cell.v ? 1 : 0);
  return o;
}
function parse_BrtShortBool(data) {
  var cell = parse_XLSBShortCell(data);
  var fBool = data.read_shift(1);
  return [cell, fBool, "b"];
}
function write_BrtShortBool(cell, ncell, o) {
  if (o == null) o = new_buf(5);
  write_XLSBShortCell(ncell, o);
  o.write_shift(1, cell.v ? 1 : 0);
  return o;
}
function parse_BrtCellError(data) {
  var cell = parse_XLSBCell(data);
  var bError = data.read_shift(1);
  return [cell, bError, "e"];
}
function write_BrtCellError(cell, ncell, o) {
  if (o == null) o = new_buf(9);
  write_XLSBCell(ncell, o);
  o.write_shift(1, cell.v);
  return o;
}
function parse_BrtShortError(data) {
  var cell = parse_XLSBShortCell(data);
  var bError = data.read_shift(1);
  return [cell, bError, "e"];
}
function write_BrtShortError(cell, ncell, o) {
  if (o == null) o = new_buf(8);
  write_XLSBShortCell(ncell, o);
  o.write_shift(1, cell.v);
  o.write_shift(2, 0);
  o.write_shift(1, 0);
  return o;
}
function parse_BrtCellIsst(data) {
  var cell = parse_XLSBCell(data);
  var isst = data.read_shift(4);
  return [cell, isst, "s"];
}
function write_BrtCellIsst(cell, ncell, o) {
  if (o == null) o = new_buf(12);
  write_XLSBCell(ncell, o);
  o.write_shift(4, ncell.v);
  return o;
}
function parse_BrtShortIsst(data) {
  var cell = parse_XLSBShortCell(data);
  var isst = data.read_shift(4);
  return [cell, isst, "s"];
}
function write_BrtShortIsst(cell, ncell, o) {
  if (o == null) o = new_buf(8);
  write_XLSBShortCell(ncell, o);
  o.write_shift(4, ncell.v);
  return o;
}
function parse_BrtCellReal(data) {
  var cell = parse_XLSBCell(data);
  var value = parse_Xnum(data);
  return [cell, value, "n"];
}
function write_BrtCellReal(cell, ncell, o) {
  if (o == null) o = new_buf(16);
  write_XLSBCell(ncell, o);
  write_Xnum(cell.v, o);
  return o;
}
function parse_BrtShortReal(data) {
  var cell = parse_XLSBShortCell(data);
  var value = parse_Xnum(data);
  return [cell, value, "n"];
}
function write_BrtShortReal(cell, ncell, o) {
  if (o == null) o = new_buf(12);
  write_XLSBShortCell(ncell, o);
  write_Xnum(cell.v, o);
  return o;
}
function parse_BrtCellRk(data) {
  var cell = parse_XLSBCell(data);
  var value = parse_RkNumber(data);
  return [cell, value, "n"];
}
function write_BrtCellRk(cell, ncell, o) {
  if (o == null) o = new_buf(12);
  write_XLSBCell(ncell, o);
  write_RkNumber(cell.v, o);
  return o;
}
function parse_BrtShortRk(data) {
  var cell = parse_XLSBShortCell(data);
  var value = parse_RkNumber(data);
  return [cell, value, "n"];
}
function write_BrtShortRk(cell, ncell, o) {
  if (o == null) o = new_buf(8);
  write_XLSBShortCell(ncell, o);
  write_RkNumber(cell.v, o);
  return o;
}
function parse_BrtCellRString(data) {
  var cell = parse_XLSBCell(data);
  var value = parse_RichStr(data);
  return [cell, value, "is"];
}
function parse_BrtCellSt(data) {
  var cell = parse_XLSBCell(data);
  var value = parse_XLWideString(data);
  return [cell, value, "str"];
}
function write_BrtCellSt(cell, ncell, o) {
  if (o == null) o = new_buf(12 + 4 * cell.v.length);
  write_XLSBCell(ncell, o);
  write_XLWideString(cell.v, o);
  return o.length > o.l ? o.slice(0, o.l) : o;
}
function parse_BrtShortSt(data) {
  var cell = parse_XLSBShortCell(data);
  var value = parse_XLWideString(data);
  return [cell, value, "str"];
}
function write_BrtShortSt(cell, ncell, o) {
  if (o == null) o = new_buf(8 + 4 * cell.v.length);
  write_XLSBShortCell(ncell, o);
  write_XLWideString(cell.v, o);
  return o.length > o.l ? o.slice(0, o.l) : o;
}
function parse_BrtFmlaBool(data, length, opts) {
  var end = data.l + length;
  var cell = parse_XLSBCell(data);
  cell.r = opts["!row"];
  var value = data.read_shift(1);
  var o = [cell, value, "b"];
  if (opts.cellFormula) {
    data.l += 2;
    var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);
    o[3] = stringify_formula(formula, null, cell, opts.supbooks, opts);
  } else data.l = end;
  return o;
}
function parse_BrtFmlaError(data, length, opts) {
  var end = data.l + length;
  var cell = parse_XLSBCell(data);
  cell.r = opts["!row"];
  var value = data.read_shift(1);
  var o = [cell, value, "e"];
  if (opts.cellFormula) {
    data.l += 2;
    var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);
    o[3] = stringify_formula(formula, null, cell, opts.supbooks, opts);
  } else data.l = end;
  return o;
}
function parse_BrtFmlaNum(data, length, opts) {
  var end = data.l + length;
  var cell = parse_XLSBCell(data);
  cell.r = opts["!row"];
  var value = parse_Xnum(data);
  var o = [cell, value, "n"];
  if (opts.cellFormula) {
    data.l += 2;
    var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);
    o[3] = stringify_formula(formula, null, cell, opts.supbooks, opts);
  } else data.l = end;
  return o;
}
function parse_BrtFmlaString(data, length, opts) {
  var end = data.l + length;
  var cell = parse_XLSBCell(data);
  cell.r = opts["!row"];
  var value = parse_XLWideString(data);
  var o = [cell, value, "str"];
  if (opts.cellFormula) {
    data.l += 2;
    var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);
    o[3] = stringify_formula(formula, null, cell, opts.supbooks, opts);
  } else data.l = end;
  return o;
}
var parse_BrtMergeCell = parse_UncheckedRfX;
var write_BrtMergeCell = write_UncheckedRfX;
function write_BrtBeginMergeCells(cnt, o) {
  if (o == null) o = new_buf(4);
  o.write_shift(4, cnt);
  return o;
}
function parse_BrtHLink(data, length) {
  var end = data.l + length;
  var rfx = parse_UncheckedRfX(data, 16);
  var relId = parse_XLNullableWideString(data);
  var loc = parse_XLWideString(data);
  var tooltip = parse_XLWideString(data);
  var display = parse_XLWideString(data);
  data.l = end;
  var o = {
    rfx,
    relId,
    loc,
    display
  };
  if (tooltip) o.Tooltip = tooltip;
  return o;
}
function write_BrtHLink(l, rId) {
  var o = new_buf(50 + 4 * (l[1].Target.length + (l[1].Tooltip || "").length));
  write_UncheckedRfX({
    s: decode_cell(l[0]),
    e: decode_cell(l[0])
  }, o);
  write_RelID("rId" + rId, o);
  var locidx = l[1].Target.indexOf("#");
  var loc = locidx == -1 ? "" : l[1].Target.slice(locidx + 1);
  write_XLWideString(loc || "", o);
  write_XLWideString(l[1].Tooltip || "", o);
  write_XLWideString("", o);
  return o.slice(0, o.l);
}
function parse_BrtPane() {
}
function parse_BrtArrFmla(data, length, opts) {
  var end = data.l + length;
  var rfx = parse_RfX(data, 16);
  var fAlwaysCalc = data.read_shift(1);
  var o = [rfx];
  o[2] = fAlwaysCalc;
  if (opts.cellFormula) {
    var formula = parse_XLSBArrayParsedFormula(data, end - data.l, opts);
    o[1] = formula;
  } else data.l = end;
  return o;
}
function parse_BrtShrFmla(data, length, opts) {
  var end = data.l + length;
  var rfx = parse_UncheckedRfX(data, 16);
  var o = [rfx];
  if (opts.cellFormula) {
    var formula = parse_XLSBSharedParsedFormula(data, end - data.l, opts);
    o[1] = formula;
    data.l = end;
  } else data.l = end;
  return o;
}
function write_BrtColInfo(C, col, o) {
  if (o == null) o = new_buf(18);
  var p = col_obj_w(C, col);
  o.write_shift(-4, C);
  o.write_shift(-4, C);
  o.write_shift(4, (p.width || 10) * 256);
  o.write_shift(
    4,
    0
    /*ixfe*/
  );
  var flags = 0;
  if (col.hidden) flags |= 1;
  if (typeof p.width == "number") flags |= 2;
  if (col.level) flags |= col.level << 8;
  o.write_shift(2, flags);
  return o;
}
var BrtMarginKeys = ["left", "right", "top", "bottom", "header", "footer"];
function parse_BrtMargins(data) {
  var margins = {};
  BrtMarginKeys.forEach(function(k) {
    margins[k] = parse_Xnum(data, 8);
  });
  return margins;
}
function write_BrtMargins(margins, o) {
  if (o == null) o = new_buf(6 * 8);
  default_margins(margins);
  BrtMarginKeys.forEach(function(k) {
    write_Xnum(margins[k], o);
  });
  return o;
}
function parse_BrtBeginWsView(data) {
  var f = data.read_shift(2);
  data.l += 28;
  return {
    RTL: f & 32
  };
}
function write_BrtBeginWsView(ws, Workbook, o) {
  if (o == null) o = new_buf(30);
  var f = 924;
  if ((((Workbook || {}).Views || [])[0] || {}).RTL) f |= 32;
  o.write_shift(2, f);
  o.write_shift(4, 0);
  o.write_shift(4, 0);
  o.write_shift(4, 0);
  o.write_shift(1, 0);
  o.write_shift(1, 0);
  o.write_shift(2, 0);
  o.write_shift(2, 100);
  o.write_shift(2, 0);
  o.write_shift(2, 0);
  o.write_shift(2, 0);
  o.write_shift(4, 0);
  return o;
}
function write_BrtCellIgnoreEC(ref) {
  var o = new_buf(24);
  o.write_shift(4, 4);
  o.write_shift(4, 1);
  write_UncheckedRfX(ref, o);
  return o;
}
function write_BrtSheetProtection(sp, o) {
  if (o == null) o = new_buf(16 * 4 + 2);
  o.write_shift(2, sp.password ? crypto_CreatePasswordVerifier_Method1(sp.password) : 0);
  o.write_shift(4, 1);
  [
    ["objects", false],
    // fObjects
    ["scenarios", false],
    // fScenarios
    ["formatCells", true],
    // fFormatCells
    ["formatColumns", true],
    // fFormatColumns
    ["formatRows", true],
    // fFormatRows
    ["insertColumns", true],
    // fInsertColumns
    ["insertRows", true],
    // fInsertRows
    ["insertHyperlinks", true],
    // fInsertHyperlinks
    ["deleteColumns", true],
    // fDeleteColumns
    ["deleteRows", true],
    // fDeleteRows
    ["selectLockedCells", false],
    // fSelLockedCells
    ["sort", true],
    // fSort
    ["autoFilter", true],
    // fAutoFilter
    ["pivotTables", true],
    // fPivotTables
    ["selectUnlockedCells", false]
    // fSelUnlockedCells
  ].forEach(function(n) {
    if (n[1]) o.write_shift(4, sp[n[0]] != null && !sp[n[0]] ? 1 : 0);
    else o.write_shift(4, sp[n[0]] != null && sp[n[0]] ? 0 : 1);
  });
  return o;
}
function parse_BrtDVal() {
}
function parse_BrtDVal14() {
}
function write_ws_bin_cell(ba, cell, R, C, opts, ws, last_seen) {
  if (cell.v === void 0) return false;
  var vv = "";
  switch (cell.t) {
    case "b":
      vv = cell.v ? "1" : "0";
      break;
    case "d":
      cell = dup(cell);
      cell.z = cell.z || table_fmt[14];
      cell.v = datenum(parseDate(cell.v));
      cell.t = "n";
      break;
    /* falls through */
    case "n":
    case "e":
      vv = "" + cell.v;
      break;
    default:
      vv = cell.v;
      break;
  }
  var o = {
    r: R,
    c: C
  };
  o.s = get_cell_style(opts.cellXfs, cell, opts);
  if (cell.l) ws["!links"].push([encode_cell(o), cell.l]);
  if (cell.c) ws["!comments"].push([encode_cell(o), cell.c]);
  switch (cell.t) {
    case "s":
    case "str":
      if (opts.bookSST) {
        vv = get_sst_id(opts.Strings, cell.v, opts.revStrings);
        o.t = "s";
        o.v = vv;
        if (last_seen) write_record(ba, 18, write_BrtShortIsst(cell, o));
        else write_record(ba, 7, write_BrtCellIsst(cell, o));
      } else {
        o.t = "str";
        if (last_seen) write_record(ba, 17, write_BrtShortSt(cell, o));
        else write_record(ba, 6, write_BrtCellSt(cell, o));
      }
      return true;
    case "n":
      if (cell.v == (cell.v | 0) && cell.v > -1e3 && cell.v < 1e3) {
        if (last_seen) write_record(ba, 13, write_BrtShortRk(cell, o));
        else write_record(ba, 2, write_BrtCellRk(cell, o));
      } else {
        if (last_seen) write_record(ba, 16, write_BrtShortReal(cell, o));
        else write_record(ba, 5, write_BrtCellReal(cell, o));
      }
      return true;
    case "b":
      o.t = "b";
      if (last_seen) write_record(ba, 15, write_BrtShortBool(cell, o));
      else write_record(ba, 4, write_BrtCellBool(cell, o));
      return true;
    case "e":
      o.t = "e";
      if (last_seen) write_record(ba, 14, write_BrtShortError(cell, o));
      else write_record(ba, 3, write_BrtCellError(cell, o));
      return true;
  }
  if (last_seen) write_record(ba, 12, write_BrtShortBlank(cell, o));
  else write_record(ba, 1, write_BrtCellBlank(cell, o));
  return true;
}
function write_CELLTABLE(ba, ws, idx, opts) {
  var range = safe_decode_range(ws["!ref"] || "A1"), ref, rr = "", cols = [];
  write_record(
    ba,
    145
    /* BrtBeginSheetData */
  );
  var dense = Array.isArray(ws);
  var cap = range.e.r;
  if (ws["!rows"]) cap = Math.max(range.e.r, ws["!rows"].length - 1);
  for (var R = range.s.r; R <= cap; ++R) {
    rr = encode_row(R);
    write_row_header(ba, ws, range, R);
    var last_seen = false;
    if (R <= range.e.r) for (var C = range.s.c; C <= range.e.c; ++C) {
      if (R === range.s.r) cols[C] = encode_col(C);
      ref = cols[C] + rr;
      var cell = dense ? (ws[R] || [])[C] : ws[ref];
      if (!cell) {
        last_seen = false;
        continue;
      }
      last_seen = write_ws_bin_cell(ba, cell, R, C, opts, ws, last_seen);
    }
  }
  write_record(
    ba,
    146
    /* BrtEndSheetData */
  );
}
function write_MERGECELLS(ba, ws) {
  if (!ws || !ws["!merges"]) return;
  write_record(ba, 177, write_BrtBeginMergeCells(ws["!merges"].length));
  ws["!merges"].forEach(function(m) {
    write_record(ba, 176, write_BrtMergeCell(m));
  });
  write_record(
    ba,
    178
    /* BrtEndMergeCells */
  );
}
function write_COLINFOS(ba, ws) {
  if (!ws || !ws["!cols"]) return;
  write_record(
    ba,
    390
    /* BrtBeginColInfos */
  );
  ws["!cols"].forEach(function(m, i) {
    if (m) write_record(ba, 60, write_BrtColInfo(i, m));
  });
  write_record(
    ba,
    391
    /* BrtEndColInfos */
  );
}
function write_IGNOREECS(ba, ws) {
  if (!ws || !ws["!ref"]) return;
  write_record(
    ba,
    648
    /* BrtBeginCellIgnoreECs */
  );
  write_record(ba, 649, write_BrtCellIgnoreEC(safe_decode_range(ws["!ref"])));
  write_record(
    ba,
    650
    /* BrtEndCellIgnoreECs */
  );
}
function write_HLINKS(ba, ws, rels) {
  ws["!links"].forEach(function(l) {
    if (!l[1].Target) return;
    var rId = add_rels(rels, -1, l[1].Target.replace(/#.*$/, ""), RELS.HLINK);
    write_record(ba, 494, write_BrtHLink(l, rId));
  });
  delete ws["!links"];
}
function write_LEGACYDRAWING(ba, ws, idx, rels) {
  if (ws["!comments"].length > 0) {
    var rId = add_rels(rels, -1, "../drawings/vmlDrawing" + (idx + 1) + ".vml", RELS.VML);
    write_record(ba, 551, write_RelID("rId" + rId));
    ws["!legacy"] = rId;
  }
}
function write_AUTOFILTER(ba, ws, wb, idx) {
  if (!ws["!autofilter"]) return;
  var data = ws["!autofilter"];
  var ref = typeof data.ref === "string" ? data.ref : encode_range(data.ref);
  if (!wb.Workbook) wb.Workbook = {
    Sheets: []
  };
  if (!wb.Workbook.Names) wb.Workbook.Names = [];
  var names = wb.Workbook.Names;
  var range = decode_range(ref);
  if (range.s.r == range.e.r) {
    range.e.r = decode_range(ws["!ref"]).e.r;
    ref = encode_range(range);
  }
  for (var i = 0; i < names.length; ++i) {
    var name = names[i];
    if (name.Name != "_xlnm._FilterDatabase") continue;
    if (name.Sheet != idx) continue;
    name.Ref = "'" + wb.SheetNames[idx] + "'!" + ref;
    break;
  }
  if (i == names.length) names.push({
    Name: "_xlnm._FilterDatabase",
    Sheet: idx,
    Ref: "'" + wb.SheetNames[idx] + "'!" + ref
  });
  write_record(ba, 161, write_UncheckedRfX(safe_decode_range(ref)));
  write_record(
    ba,
    162
    /* BrtEndAFilter */
  );
}
function write_WSVIEWS2(ba, ws, Workbook) {
  write_record(
    ba,
    133
    /* BrtBeginWsViews */
  );
  {
    write_record(ba, 137, write_BrtBeginWsView(ws, Workbook));
    write_record(
      ba,
      138
      /* BrtEndWsView */
    );
  }
  write_record(
    ba,
    134
    /* BrtEndWsViews */
  );
}
function write_WSFMTINFO() {
}
function write_SHEETPROTECT(ba, ws) {
  if (!ws["!protect"]) return;
  write_record(ba, 535, write_BrtSheetProtection(ws["!protect"]));
}
function write_ws_bin(idx, opts, wb, rels) {
  var ba = buf_array();
  var s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};
  var c = s;
  try {
    if (wb && wb.Workbook) c = wb.Workbook.Sheets[idx].CodeName || c;
  } catch (e) {
  }
  var r = safe_decode_range(ws["!ref"] || "A1");
  if (r.e.c > 16383 || r.e.r > 1048575) {
    if (opts.WTF) throw new Error("Range " + (ws["!ref"] || "A1") + " exceeds format limit A1:XFD1048576");
    r.e.c = Math.min(r.e.c, 16383);
    r.e.r = Math.min(r.e.c, 1048575);
  }
  ws["!links"] = [];
  ws["!comments"] = [];
  write_record(
    ba,
    129
    /* BrtBeginSheet */
  );
  if (wb.vbaraw || ws["!outline"]) write_record(ba, 147, write_BrtWsProp(c, ws["!outline"]));
  write_record(ba, 148, write_BrtWsDim(r));
  write_WSVIEWS2(ba, ws, wb.Workbook);
  write_WSFMTINFO(ba, ws);
  write_COLINFOS(ba, ws, idx, opts, wb);
  write_CELLTABLE(ba, ws, idx, opts, wb);
  write_SHEETPROTECT(ba, ws);
  write_AUTOFILTER(ba, ws, wb, idx);
  write_MERGECELLS(ba, ws);
  write_HLINKS(ba, ws, rels);
  if (ws["!margins"]) write_record(ba, 476, write_BrtMargins(ws["!margins"]));
  if (!opts || opts.ignoreEC || opts.ignoreEC == void 0) write_IGNOREECS(ba, ws);
  write_LEGACYDRAWING(ba, ws, idx, rels);
  write_record(
    ba,
    130
    /* BrtEndSheet */
  );
  return ba.end();
}
function parse_BrtCsProp(data, length) {
  data.l += 10;
  var name = parse_XLWideString(data, length - 10);
  return {
    name
  };
}
var WBPropsDef = [["allowRefreshQuery", false, "bool"], ["autoCompressPictures", true, "bool"], ["backupFile", false, "bool"], ["checkCompatibility", false, "bool"], ["CodeName", ""], ["date1904", false, "bool"], ["defaultThemeVersion", 0, "int"], ["filterPrivacy", false, "bool"], ["hidePivotFieldList", false, "bool"], ["promptedSolutions", false, "bool"], ["publishItems", false, "bool"], ["refreshAllConnections", false, "bool"], ["saveExternalLinkValues", true, "bool"], ["showBorderUnselectedTables", true, "bool"], ["showInkAnnotation", true, "bool"], ["showObjects", "all"], ["showPivotChartFilter", false, "bool"], ["updateLinks", "userSet"]];
function safe1904(wb) {
  if (!wb.Workbook) return "false";
  if (!wb.Workbook.WBProps) return "false";
  return parsexmlbool(wb.Workbook.WBProps.date1904) ? "true" : "false";
}
var badchars = /* @__PURE__ */ "][*?/\\".split("");
function check_ws_name(n, safe) {
  if (n.length > 31) {
    if (safe) return false;
    throw new Error("Sheet names cannot exceed 31 chars");
  }
  var _good = true;
  badchars.forEach(function(c) {
    if (n.indexOf(c) == -1) return;
    if (!safe) throw new Error("Sheet name cannot contain : \\ / ? * [ ]");
    _good = false;
  });
  return _good;
}
function check_wb_names(N, S, codes) {
  N.forEach(function(n, i) {
    check_ws_name(n);
    for (var j = 0; j < i; ++j) if (n == N[j]) throw new Error("Duplicate Sheet Name: " + n);
    if (codes) {
      var cn = S && S[i] && S[i].CodeName || n;
      if (cn.charCodeAt(0) == 95 && cn.length > 22) throw new Error("Bad Code Name: Worksheet" + cn);
    }
  });
}
function check_wb(wb) {
  if (!wb || !wb.SheetNames || !wb.Sheets) throw new Error("Invalid Workbook");
  if (!wb.SheetNames.length) throw new Error("Workbook is empty");
  var Sheets = wb.Workbook && wb.Workbook.Sheets || [];
  check_wb_names(wb.SheetNames, Sheets, !!wb.vbaraw);
  for (var i = 0; i < wb.SheetNames.length; ++i) check_ws(wb.Sheets[wb.SheetNames[i]], wb.SheetNames[i], i);
}
function write_wb_xml(wb) {
  var o = [XML_HEADER];
  o[o.length] = writextag("workbook", null, {
    "xmlns": XMLNS_main[0],
    //'xmlns:mx': XMLNS.mx,
    //'xmlns:s': XMLNS_main[0],
    "xmlns:r": XMLNS.r
  });
  var write_names = wb.Workbook && (wb.Workbook.Names || []).length > 0;
  var workbookPr = {
    codeName: "ThisWorkbook"
  };
  if (wb.Workbook && wb.Workbook.WBProps) {
    WBPropsDef.forEach(function(x) {
      if (wb.Workbook.WBProps[x[0]] == null) return;
      if (wb.Workbook.WBProps[x[0]] == x[1]) return;
      workbookPr[x[0]] = wb.Workbook.WBProps[x[0]];
    });
    if (wb.Workbook.WBProps.CodeName) {
      workbookPr.codeName = wb.Workbook.WBProps.CodeName;
      delete workbookPr.CodeName;
    }
  }
  o[o.length] = writextag("workbookPr", null, workbookPr);
  var sheets = wb.Workbook && wb.Workbook.Sheets || [];
  var i = 0;
  if (sheets && sheets[0] && !!sheets[0].Hidden) {
    o[o.length] = "<bookViews>";
    for (i = 0; i != wb.SheetNames.length; ++i) {
      if (!sheets[i]) break;
      if (!sheets[i].Hidden) break;
    }
    if (i == wb.SheetNames.length) i = 0;
    o[o.length] = '<workbookView firstSheet="' + i + '" activeTab="' + i + '"/>';
    o[o.length] = "</bookViews>";
  }
  o[o.length] = "<sheets>";
  for (i = 0; i != wb.SheetNames.length; ++i) {
    var sht = {
      name: escapexml(wb.SheetNames[i].slice(0, 31))
    };
    sht.sheetId = "" + (i + 1);
    sht["r:id"] = "rId" + (i + 1);
    if (sheets[i]) switch (sheets[i].Hidden) {
      case 1:
        sht.state = "hidden";
        break;
      case 2:
        sht.state = "veryHidden";
        break;
    }
    o[o.length] = writextag("sheet", null, sht);
  }
  o[o.length] = "</sheets>";
  if (write_names) {
    o[o.length] = "<definedNames>";
    if (wb.Workbook && wb.Workbook.Names) wb.Workbook.Names.forEach(function(n) {
      var d = {
        name: n.Name
      };
      if (n.Comment) d.comment = n.Comment;
      if (n.Sheet != null) d.localSheetId = "" + n.Sheet;
      if (n.Hidden) d.hidden = "1";
      if (!n.Ref) return;
      o[o.length] = writextag("definedName", escapexml(n.Ref), d);
    });
    o[o.length] = "</definedNames>";
  }
  if (o.length > 2) {
    o[o.length] = "</workbook>";
    o[1] = o[1].replace("/>", ">");
  }
  return o.join("");
}
function parse_BrtBundleSh(data, length) {
  var z = {};
  z.Hidden = data.read_shift(4);
  z.iTabID = data.read_shift(4);
  z.strRelID = parse_RelID(data, length - 8);
  z.name = parse_XLWideString(data);
  return z;
}
function write_BrtBundleSh(data, o) {
  if (!o) o = new_buf(127);
  o.write_shift(4, data.Hidden);
  o.write_shift(4, data.iTabID);
  write_RelID(data.strRelID, o);
  write_XLWideString(data.name.slice(0, 31), o);
  return o.length > o.l ? o.slice(0, o.l) : o;
}
function parse_BrtWbProp(data, length) {
  var o = {};
  var flags = data.read_shift(4);
  o.defaultThemeVersion = data.read_shift(4);
  var strName = length > 8 ? parse_XLWideString(data) : "";
  if (strName.length > 0) o.CodeName = strName;
  o.autoCompressPictures = !!(flags & 65536);
  o.backupFile = !!(flags & 64);
  o.checkCompatibility = !!(flags & 4096);
  o.date1904 = !!(flags & 1);
  o.filterPrivacy = !!(flags & 8);
  o.hidePivotFieldList = !!(flags & 1024);
  o.promptedSolutions = !!(flags & 16);
  o.publishItems = !!(flags & 2048);
  o.refreshAllConnections = !!(flags & 262144);
  o.saveExternalLinkValues = !!(flags & 128);
  o.showBorderUnselectedTables = !!(flags & 4);
  o.showInkAnnotation = !!(flags & 32);
  o.showObjects = ["all", "placeholders", "none"][flags >> 13 & 3];
  o.showPivotChartFilter = !!(flags & 32768);
  o.updateLinks = ["userSet", "never", "always"][flags >> 8 & 3];
  return o;
}
function write_BrtWbProp(data, o) {
  if (!o) o = new_buf(72);
  var flags = 0;
  if (data) {
    if (data.filterPrivacy) flags |= 8;
  }
  o.write_shift(4, flags);
  o.write_shift(4, 0);
  write_XLSBCodeName(data && data.CodeName || "ThisWorkbook", o);
  return o.slice(0, o.l);
}
function parse_BrtName(data, length, opts) {
  var end = data.l + length;
  data.l += 4;
  data.l += 1;
  var itab = data.read_shift(4);
  var name = parse_XLNameWideString(data);
  var formula = parse_XLSBNameParsedFormula(data, 0, opts);
  var comment = parse_XLNullableWideString(data);
  data.l = end;
  var out = {
    Name: name,
    Ptg: formula
  };
  if (itab < 268435455) out.Sheet = itab;
  if (comment) out.Comment = comment;
  return out;
}
function write_BUNDLESHS(ba, wb) {
  write_record(
    ba,
    143
    /* BrtBeginBundleShs */
  );
  for (var idx = 0; idx != wb.SheetNames.length; ++idx) {
    var viz = wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx] && wb.Workbook.Sheets[idx].Hidden || 0;
    var d = {
      Hidden: viz,
      iTabID: idx + 1,
      strRelID: "rId" + (idx + 1),
      name: wb.SheetNames[idx]
    };
    write_record(ba, 156, write_BrtBundleSh(d));
  }
  write_record(
    ba,
    144
    /* BrtEndBundleShs */
  );
}
function write_BrtFileVersion(data, o) {
  if (!o) o = new_buf(127);
  for (var i = 0; i != 4; ++i) o.write_shift(4, 0);
  write_XLWideString("SheetJS", o);
  write_XLWideString(XLSX.version, o);
  write_XLWideString(XLSX.version, o);
  write_XLWideString("7262", o);
  return o.length > o.l ? o.slice(0, o.l) : o;
}
function write_BrtBookView(idx, o) {
  if (!o) o = new_buf(29);
  o.write_shift(-4, 0);
  o.write_shift(-4, 460);
  o.write_shift(4, 28800);
  o.write_shift(4, 17600);
  o.write_shift(4, 500);
  o.write_shift(4, idx);
  o.write_shift(4, idx);
  var flags = 120;
  o.write_shift(1, flags);
  return o.length > o.l ? o.slice(0, o.l) : o;
}
function write_BOOKVIEWS(ba, wb) {
  if (!wb.Workbook || !wb.Workbook.Sheets) return;
  var sheets = wb.Workbook.Sheets;
  var i = 0, vistab = -1, hidden = -1;
  for (; i < sheets.length; ++i) {
    if (!sheets[i] || !sheets[i].Hidden && vistab == -1) vistab = i;
    else if (sheets[i].Hidden == 1 && hidden == -1) hidden = i;
  }
  if (hidden > vistab) return;
  write_record(
    ba,
    135
    /* BrtBeginBookViews */
  );
  write_record(ba, 158, write_BrtBookView(vistab));
  write_record(
    ba,
    136
    /* BrtEndBookViews */
  );
}
function write_wb_bin(wb, opts) {
  var ba = buf_array();
  write_record(
    ba,
    131
    /* BrtBeginBook */
  );
  write_record(ba, 128, write_BrtFileVersion());
  write_record(ba, 153, write_BrtWbProp(wb.Workbook && wb.Workbook.WBProps || null));
  write_BOOKVIEWS(ba, wb, opts);
  write_BUNDLESHS(ba, wb, opts);
  write_record(
    ba,
    132
    /* BrtEndBook */
  );
  return ba.end();
}
function write_wb(wb, name, opts) {
  return (name.slice(-4) === ".bin" ? write_wb_bin : write_wb_xml)(wb, opts);
}
function write_ws(data, name, opts, wb, rels) {
  return (name.slice(-4) === ".bin" ? write_ws_bin : write_ws_xml)(data, opts, wb, rels);
}
function write_sty(data, name, opts) {
  return (name.slice(-4) === ".bin" ? write_sty_bin : write_sty_xml)(data, opts);
}
function write_sst(data, name, opts) {
  return (name.slice(-4) === ".bin" ? write_sst_bin : write_sst_xml)(data, opts);
}
function write_cmnt(data, name, opts) {
  return (name.slice(-4) === ".bin" ? write_comments_bin : write_comments_xml)(data, opts);
}
function write_xlmeta(name) {
  return (name.slice(-4) === ".bin" ? write_xlmeta_bin : write_xlmeta_xml)();
}
function write_props_xlml(wb, opts) {
  var o = [];
  if (wb.Props) o.push(xlml_write_docprops(wb.Props, opts));
  if (wb.Custprops) o.push(xlml_write_custprops(wb.Props, wb.Custprops, opts));
  return o.join("");
}
function write_wb_xlml() {
  return "";
}
function write_sty_xlml(wb, opts) {
  var styles = ['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];
  opts.cellXfs.forEach(function(xf, id) {
    var payload = [];
    payload.push(writextag("NumberFormat", null, {
      "ss:Format": escapexml(table_fmt[xf.numFmtId])
    }));
    var o = (
      /*::(*/
      {
        "ss:ID": "s" + (21 + id)
      }
    );
    styles.push(writextag("Style", payload.join(""), o));
  });
  return writextag("Styles", styles.join(""));
}
function write_name_xlml(n) {
  return writextag("NamedRange", null, {
    "ss:Name": n.Name,
    "ss:RefersTo": "=" + a1_to_rc(n.Ref, {
      r: 0,
      c: 0
    })
  });
}
function write_names_xlml(wb) {
  if (!((wb || {}).Workbook || {}).Names) return "";
  var names = wb.Workbook.Names;
  var out = [];
  for (var i = 0; i < names.length; ++i) {
    var n = names[i];
    if (n.Sheet != null) continue;
    if (n.Name.match(/^_xlfn\./)) continue;
    out.push(write_name_xlml(n));
  }
  return writextag("Names", out.join(""));
}
function write_ws_xlml_names(ws, opts, idx, wb) {
  if (!ws) return "";
  if (!((wb || {}).Workbook || {}).Names) return "";
  var names = wb.Workbook.Names;
  var out = [];
  for (var i = 0; i < names.length; ++i) {
    var n = names[i];
    if (n.Sheet != idx) continue;
    if (n.Name.match(/^_xlfn\./)) continue;
    out.push(write_name_xlml(n));
  }
  return out.join("");
}
function write_ws_xlml_wsopts(ws, opts, idx, wb) {
  if (!ws) return "";
  var o = [];
  if (ws["!margins"]) {
    o.push("<PageSetup>");
    if (ws["!margins"].header) o.push(writextag("Header", null, {
      "x:Margin": ws["!margins"].header
    }));
    if (ws["!margins"].footer) o.push(writextag("Footer", null, {
      "x:Margin": ws["!margins"].footer
    }));
    o.push(writextag("PageMargins", null, {
      "x:Bottom": ws["!margins"].bottom || "0.75",
      "x:Left": ws["!margins"].left || "0.7",
      "x:Right": ws["!margins"].right || "0.7",
      "x:Top": ws["!margins"].top || "0.75"
    }));
    o.push("</PageSetup>");
  }
  if (wb && wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx]) {
    if (wb.Workbook.Sheets[idx].Hidden) o.push(writextag("Visible", wb.Workbook.Sheets[idx].Hidden == 1 ? "SheetHidden" : "SheetVeryHidden", {}));
    else {
      for (var i = 0; i < idx; ++i) if (wb.Workbook.Sheets[i] && !wb.Workbook.Sheets[i].Hidden) break;
      if (i == idx) o.push("<Selected/>");
    }
  }
  if (((((wb || {}).Workbook || {}).Views || [])[0] || {}).RTL) o.push("<DisplayRightToLeft/>");
  if (ws["!protect"]) {
    o.push(writetag("ProtectContents", "True"));
    if (ws["!protect"].objects) o.push(writetag("ProtectObjects", "True"));
    if (ws["!protect"].scenarios) o.push(writetag("ProtectScenarios", "True"));
    if (ws["!protect"].selectLockedCells != null && !ws["!protect"].selectLockedCells) o.push(writetag("EnableSelection", "NoSelection"));
    else if (ws["!protect"].selectUnlockedCells != null && !ws["!protect"].selectUnlockedCells) o.push(writetag("EnableSelection", "UnlockedCells"));
    [["formatCells", "AllowFormatCells"], ["formatColumns", "AllowSizeCols"], ["formatRows", "AllowSizeRows"], ["insertColumns", "AllowInsertCols"], ["insertRows", "AllowInsertRows"], ["insertHyperlinks", "AllowInsertHyperlinks"], ["deleteColumns", "AllowDeleteCols"], ["deleteRows", "AllowDeleteRows"], ["sort", "AllowSort"], ["autoFilter", "AllowFilter"], ["pivotTables", "AllowUsePivotTables"]].forEach(function(x) {
      if (ws["!protect"][x[0]]) o.push("<" + x[1] + "/>");
    });
  }
  if (o.length == 0) return "";
  return writextag("WorksheetOptions", o.join(""), {
    xmlns: XLMLNS.x
  });
}
function write_ws_xlml_comment(comments) {
  return comments.map(function(c) {
    var t = xlml_unfixstr(c.t || "");
    var d = writextag("ss:Data", t, {
      "xmlns": "http://www.w3.org/TR/REC-html40"
    });
    return writextag("Comment", d, {
      "ss:Author": c.a
    });
  }).join("");
}
function write_ws_xlml_cell(cell, ref, ws, opts, idx, wb, addr) {
  if (!cell || cell.v == void 0 && cell.f == void 0) return "";
  var attr = {};
  if (cell.f) attr["ss:Formula"] = "=" + escapexml(a1_to_rc(cell.f, addr));
  if (cell.F && cell.F.slice(0, ref.length) == ref) {
    var end = decode_cell(cell.F.slice(ref.length + 1));
    attr["ss:ArrayRange"] = "RC:R" + (end.r == addr.r ? "" : "[" + (end.r - addr.r) + "]") + "C" + (end.c == addr.c ? "" : "[" + (end.c - addr.c) + "]");
  }
  if (cell.l && cell.l.Target) {
    attr["ss:HRef"] = escapexml(cell.l.Target);
    if (cell.l.Tooltip) attr["x:HRefScreenTip"] = escapexml(cell.l.Tooltip);
  }
  if (ws["!merges"]) {
    var marr = ws["!merges"];
    for (var mi = 0; mi != marr.length; ++mi) {
      if (marr[mi].s.c != addr.c || marr[mi].s.r != addr.r) continue;
      if (marr[mi].e.c > marr[mi].s.c) attr["ss:MergeAcross"] = marr[mi].e.c - marr[mi].s.c;
      if (marr[mi].e.r > marr[mi].s.r) attr["ss:MergeDown"] = marr[mi].e.r - marr[mi].s.r;
    }
  }
  var t = "", p = "";
  switch (cell.t) {
    case "z":
      if (!opts.sheetStubs) return "";
      break;
    case "n":
      t = "Number";
      p = String(cell.v);
      break;
    case "b":
      t = "Boolean";
      p = cell.v ? "1" : "0";
      break;
    case "e":
      t = "Error";
      p = BErr[cell.v];
      break;
    case "d":
      t = "DateTime";
      p = new Date(cell.v).toISOString();
      if (cell.z == null) cell.z = cell.z || table_fmt[14];
      break;
    case "s":
      t = "String";
      p = escapexlml(cell.v || "");
      break;
  }
  var os = get_cell_style(opts.cellXfs, cell, opts);
  attr["ss:StyleID"] = "s" + (21 + os);
  attr["ss:Index"] = addr.c + 1;
  var _v = cell.v != null ? p : "";
  var m = cell.t == "z" ? "" : '<Data ss:Type="' + t + '">' + _v + "</Data>";
  if ((cell.c || []).length > 0) m += write_ws_xlml_comment(cell.c);
  return writextag("Cell", m, attr);
}
function write_ws_xlml_row(R, row) {
  var o = '<Row ss:Index="' + (R + 1) + '"';
  if (row) {
    if (row.hpt && !row.hpx) row.hpx = pt2px(row.hpt);
    if (row.hpx) o += ' ss:AutoFitHeight="0" ss:Height="' + row.hpx + '"';
    if (row.hidden) o += ' ss:Hidden="1"';
  }
  return o + ">";
}
function write_ws_xlml_table(ws, opts, idx, wb) {
  if (!ws["!ref"]) return "";
  var range = safe_decode_range(ws["!ref"]);
  var marr = ws["!merges"] || [], mi = 0;
  var o = [];
  if (ws["!cols"]) ws["!cols"].forEach(function(n, i) {
    process_col(n);
    var w = !!n.width;
    var p = col_obj_w(i, n);
    var k = {
      "ss:Index": i + 1
    };
    if (w) k["ss:Width"] = width2px(p.width);
    if (n.hidden) k["ss:Hidden"] = "1";
    o.push(writextag("Column", null, k));
  });
  var dense = Array.isArray(ws);
  for (var R = range.s.r; R <= range.e.r; ++R) {
    var row = [write_ws_xlml_row(R, (ws["!rows"] || [])[R])];
    for (var C = range.s.c; C <= range.e.c; ++C) {
      var skip = false;
      for (mi = 0; mi != marr.length; ++mi) {
        if (marr[mi].s.c > C) continue;
        if (marr[mi].s.r > R) continue;
        if (marr[mi].e.c < C) continue;
        if (marr[mi].e.r < R) continue;
        if (marr[mi].s.c != C || marr[mi].s.r != R) skip = true;
        break;
      }
      if (skip) continue;
      var addr = {
        r: R,
        c: C
      };
      var ref = encode_cell(addr), cell = dense ? (ws[R] || [])[C] : ws[ref];
      row.push(write_ws_xlml_cell(cell, ref, ws, opts, idx, wb, addr));
    }
    row.push("</Row>");
    if (row.length > 2) o.push(row.join(""));
  }
  return o.join("");
}
function write_ws_xlml(idx, opts, wb) {
  var o = [];
  var s = wb.SheetNames[idx];
  var ws = wb.Sheets[s];
  var t = ws ? write_ws_xlml_names(ws, opts, idx, wb) : "";
  if (t.length > 0) o.push("<Names>" + t + "</Names>");
  t = ws ? write_ws_xlml_table(ws, opts, idx, wb) : "";
  if (t.length > 0) o.push("<Table>" + t + "</Table>");
  o.push(write_ws_xlml_wsopts(ws, opts, idx, wb));
  return o.join("");
}
function write_xlml(wb, opts) {
  if (!opts) opts = {};
  if (!wb.SSF) wb.SSF = dup(table_fmt);
  if (wb.SSF) {
    make_ssf();
    SSF_load_table(wb.SSF);
    opts.revssf = evert_num(wb.SSF);
    opts.revssf[wb.SSF[65535]] = 0;
    opts.ssf = wb.SSF;
    opts.cellXfs = [];
    get_cell_style(opts.cellXfs, {}, {
      revssf: {
        "General": 0
      }
    });
  }
  var d = [];
  d.push(write_props_xlml(wb, opts));
  d.push(write_wb_xlml(wb, opts));
  d.push("");
  d.push("");
  for (var i = 0; i < wb.SheetNames.length; ++i) d.push(writextag("Worksheet", write_ws_xlml(i, opts, wb), {
    "ss:Name": escapexml(wb.SheetNames[i])
  }));
  d[2] = write_sty_xlml(wb, opts);
  d[3] = write_names_xlml(wb, opts);
  return XML_HEADER + writextag("Workbook", d.join(""), {
    "xmlns": XLMLNS.ss,
    "xmlns:o": XLMLNS.o,
    "xmlns:x": XLMLNS.x,
    "xmlns:ss": XLMLNS.ss,
    "xmlns:dt": XLMLNS.dt,
    "xmlns:html": XLMLNS.html
  });
}
var PSCLSID = {
  SI: "e0859ff2f94f6810ab9108002b27b3d9",
  DSI: "02d5cdd59c2e1b10939708002b2cf9ae",
  UDI: "05d5cdd59c2e1b10939708002b2cf9ae"
};
function write_xls_props(wb, cfb) {
  var DSEntries = [], SEntries = [], CEntries = [];
  var i = 0, Keys;
  var DocSummaryRE = evert_key(DocSummaryPIDDSI, "n");
  var SummaryRE = evert_key(SummaryPIDSI, "n");
  if (wb.Props) {
    Keys = keys(wb.Props);
    for (i = 0; i < Keys.length; ++i) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Props[Keys[i]]]);
  }
  if (wb.Custprops) {
    Keys = keys(wb.Custprops);
    for (i = 0; i < Keys.length; ++i) if (!Object.prototype.hasOwnProperty.call(wb.Props || {}, Keys[i])) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Custprops[Keys[i]]]);
  }
  var CEntries2 = [];
  for (i = 0; i < CEntries.length; ++i) {
    if (XLSPSSkip.indexOf(CEntries[i][0]) > -1 || PseudoPropsPairs.indexOf(CEntries[i][0]) > -1) continue;
    if (CEntries[i][1] == null) continue;
    CEntries2.push(CEntries[i]);
  }
  if (SEntries.length) CFB.utils.cfb_add(cfb, "/SummaryInformation", write_PropertySetStream(SEntries, PSCLSID.SI, SummaryRE, SummaryPIDSI));
  if (DSEntries.length || CEntries2.length) CFB.utils.cfb_add(cfb, "/DocumentSummaryInformation", write_PropertySetStream(DSEntries, PSCLSID.DSI, DocSummaryRE, DocSummaryPIDDSI, CEntries2.length ? CEntries2 : null, PSCLSID.UDI));
}
function write_xlscfb(wb, opts) {
  var o = opts || {};
  var cfb = CFB.utils.cfb_new({
    root: "R"
  });
  var wbpath = "/Workbook";
  switch (o.bookType || "xls") {
    case "xls":
      o.bookType = "biff8";
    /* falls through */
    case "xla":
      if (!o.bookType) o.bookType = "xla";
    /* falls through */
    case "biff8":
      wbpath = "/Workbook";
      o.biff = 8;
      break;
    case "biff5":
      wbpath = "/Book";
      o.biff = 5;
      break;
    default:
      throw new Error("invalid type " + o.bookType + " for XLS CFB");
  }
  CFB.utils.cfb_add(cfb, wbpath, write_biff_buf(wb, o));
  if (o.biff == 8 && (wb.Props || wb.Custprops)) write_xls_props(wb, cfb);
  if (o.biff == 8 && wb.vbaraw) fill_vba_xls(cfb, CFB.read(wb.vbaraw, {
    type: typeof wb.vbaraw == "string" ? "binary" : "buffer"
  }));
  return cfb;
}
var XLSBRecordEnum = {
  /*::[*/
  0: {
    /* n:"BrtRowHdr", */
    f: parse_BrtRowHdr
  },
  /*::[*/
  1: {
    /* n:"BrtCellBlank", */
    f: parse_BrtCellBlank
  },
  /*::[*/
  2: {
    /* n:"BrtCellRk", */
    f: parse_BrtCellRk
  },
  /*::[*/
  3: {
    /* n:"BrtCellError", */
    f: parse_BrtCellError
  },
  /*::[*/
  4: {
    /* n:"BrtCellBool", */
    f: parse_BrtCellBool
  },
  /*::[*/
  5: {
    /* n:"BrtCellReal", */
    f: parse_BrtCellReal
  },
  /*::[*/
  6: {
    /* n:"BrtCellSt", */
    f: parse_BrtCellSt
  },
  /*::[*/
  7: {
    /* n:"BrtCellIsst", */
    f: parse_BrtCellIsst
  },
  /*::[*/
  8: {
    /* n:"BrtFmlaString", */
    f: parse_BrtFmlaString
  },
  /*::[*/
  9: {
    /* n:"BrtFmlaNum", */
    f: parse_BrtFmlaNum
  },
  /*::[*/
  10: {
    /* n:"BrtFmlaBool", */
    f: parse_BrtFmlaBool
  },
  /*::[*/
  11: {
    /* n:"BrtFmlaError", */
    f: parse_BrtFmlaError
  },
  /*::[*/
  12: {
    /* n:"BrtShortBlank", */
    f: parse_BrtShortBlank
  },
  /*::[*/
  13: {
    /* n:"BrtShortRk", */
    f: parse_BrtShortRk
  },
  /*::[*/
  14: {
    /* n:"BrtShortError", */
    f: parse_BrtShortError
  },
  /*::[*/
  15: {
    /* n:"BrtShortBool", */
    f: parse_BrtShortBool
  },
  /*::[*/
  16: {
    /* n:"BrtShortReal", */
    f: parse_BrtShortReal
  },
  /*::[*/
  17: {
    /* n:"BrtShortSt", */
    f: parse_BrtShortSt
  },
  /*::[*/
  18: {
    /* n:"BrtShortIsst", */
    f: parse_BrtShortIsst
  },
  /*::[*/
  19: {
    /* n:"BrtSSTItem", */
    f: parse_RichStr
  },
  /*::[*/
  20: {
    /* n:"BrtPCDIMissing" */
  },
  /*::[*/
  21: {
    /* n:"BrtPCDINumber" */
  },
  /*::[*/
  22: {
    /* n:"BrtPCDIBoolean" */
  },
  /*::[*/
  23: {
    /* n:"BrtPCDIError" */
  },
  /*::[*/
  24: {
    /* n:"BrtPCDIString" */
  },
  /*::[*/
  25: {
    /* n:"BrtPCDIDatetime" */
  },
  /*::[*/
  26: {
    /* n:"BrtPCDIIndex" */
  },
  /*::[*/
  27: {
    /* n:"BrtPCDIAMissing" */
  },
  /*::[*/
  28: {
    /* n:"BrtPCDIANumber" */
  },
  /*::[*/
  29: {
    /* n:"BrtPCDIABoolean" */
  },
  /*::[*/
  30: {
    /* n:"BrtPCDIAError" */
  },
  /*::[*/
  31: {
    /* n:"BrtPCDIAString" */
  },
  /*::[*/
  32: {
    /* n:"BrtPCDIADatetime" */
  },
  /*::[*/
  33: {
    /* n:"BrtPCRRecord" */
  },
  /*::[*/
  34: {
    /* n:"BrtPCRRecordDt" */
  },
  /*::[*/
  35: {
    /* n:"BrtFRTBegin", */
    T: 1
  },
  /*::[*/
  36: {
    /* n:"BrtFRTEnd", */
    T: -1
  },
  /*::[*/
  37: {
    /* n:"BrtACBegin", */
    T: 1
  },
  /*::[*/
  38: {
    /* n:"BrtACEnd", */
    T: -1
  },
  /*::[*/
  39: {
    /* n:"BrtName", */
    f: parse_BrtName
  },
  /*::[*/
  40: {
    /* n:"BrtIndexRowBlock" */
  },
  /*::[*/
  42: {
    /* n:"BrtIndexBlock" */
  },
  /*::[*/
  43: {
    /* n:"BrtFont", */
    f: parse_BrtFont
  },
  /*::[*/
  44: {
    /* n:"BrtFmt", */
    f: parse_BrtFmt
  },
  /*::[*/
  45: {
    /* n:"BrtFill", */
    f: parse_BrtFill
  },
  /*::[*/
  46: {
    /* n:"BrtBorder", */
    f: parse_BrtBorder
  },
  /*::[*/
  47: {
    /* n:"BrtXF", */
    f: parse_BrtXF
  },
  /*::[*/
  48: {
    /* n:"BrtStyle" */
  },
  /*::[*/
  49: {
    /* n:"BrtCellMeta", */
    f: parse_Int32LE
  },
  /*::[*/
  50: {
    /* n:"BrtValueMeta" */
  },
  /*::[*/
  51: {
    /* n:"BrtMdb" */
    f: parse_BrtMdb
  },
  /*::[*/
  52: {
    /* n:"BrtBeginFmd", */
    T: 1
  },
  /*::[*/
  53: {
    /* n:"BrtEndFmd", */
    T: -1
  },
  /*::[*/
  54: {
    /* n:"BrtBeginMdx", */
    T: 1
  },
  /*::[*/
  55: {
    /* n:"BrtEndMdx", */
    T: -1
  },
  /*::[*/
  56: {
    /* n:"BrtBeginMdxTuple", */
    T: 1
  },
  /*::[*/
  57: {
    /* n:"BrtEndMdxTuple", */
    T: -1
  },
  /*::[*/
  58: {
    /* n:"BrtMdxMbrIstr" */
  },
  /*::[*/
  59: {
    /* n:"BrtStr" */
  },
  /*::[*/
  60: {
    /* n:"BrtColInfo", */
    f: parse_ColInfo
  },
  /*::[*/
  62: {
    /* n:"BrtCellRString", */
    f: parse_BrtCellRString
  },
  /*::[*/
  63: {
    /* n:"BrtCalcChainItem$", */
    f: parse_BrtCalcChainItem$
  },
  /*::[*/
  64: {
    /* n:"BrtDVal", */
    f: parse_BrtDVal
  },
  /*::[*/
  65: {
    /* n:"BrtSxvcellNum" */
  },
  /*::[*/
  66: {
    /* n:"BrtSxvcellStr" */
  },
  /*::[*/
  67: {
    /* n:"BrtSxvcellBool" */
  },
  /*::[*/
  68: {
    /* n:"BrtSxvcellErr" */
  },
  /*::[*/
  69: {
    /* n:"BrtSxvcellDate" */
  },
  /*::[*/
  70: {
    /* n:"BrtSxvcellNil" */
  },
  /*::[*/
  128: {
    /* n:"BrtFileVersion" */
  },
  /*::[*/
  129: {
    /* n:"BrtBeginSheet", */
    T: 1
  },
  /*::[*/
  130: {
    /* n:"BrtEndSheet", */
    T: -1
  },
  /*::[*/
  131: {
    /* n:"BrtBeginBook", */
    T: 1,
    f: parsenoop,
    p: 0
  },
  /*::[*/
  132: {
    /* n:"BrtEndBook", */
    T: -1
  },
  /*::[*/
  133: {
    /* n:"BrtBeginWsViews", */
    T: 1
  },
  /*::[*/
  134: {
    /* n:"BrtEndWsViews", */
    T: -1
  },
  /*::[*/
  135: {
    /* n:"BrtBeginBookViews", */
    T: 1
  },
  /*::[*/
  136: {
    /* n:"BrtEndBookViews", */
    T: -1
  },
  /*::[*/
  137: {
    /* n:"BrtBeginWsView", */
    T: 1,
    f: parse_BrtBeginWsView
  },
  /*::[*/
  138: {
    /* n:"BrtEndWsView", */
    T: -1
  },
  /*::[*/
  139: {
    /* n:"BrtBeginCsViews", */
    T: 1
  },
  /*::[*/
  140: {
    /* n:"BrtEndCsViews", */
    T: -1
  },
  /*::[*/
  141: {
    /* n:"BrtBeginCsView", */
    T: 1
  },
  /*::[*/
  142: {
    /* n:"BrtEndCsView", */
    T: -1
  },
  /*::[*/
  143: {
    /* n:"BrtBeginBundleShs", */
    T: 1
  },
  /*::[*/
  144: {
    /* n:"BrtEndBundleShs", */
    T: -1
  },
  /*::[*/
  145: {
    /* n:"BrtBeginSheetData", */
    T: 1
  },
  /*::[*/
  146: {
    /* n:"BrtEndSheetData", */
    T: -1
  },
  /*::[*/
  147: {
    /* n:"BrtWsProp", */
    f: parse_BrtWsProp
  },
  /*::[*/
  148: {
    /* n:"BrtWsDim", */
    f: parse_BrtWsDim,
    p: 16
  },
  /*::[*/
  151: {
    /* n:"BrtPane", */
    f: parse_BrtPane
  },
  /*::[*/
  152: {
    /* n:"BrtSel" */
  },
  /*::[*/
  153: {
    /* n:"BrtWbProp", */
    f: parse_BrtWbProp
  },
  /*::[*/
  154: {
    /* n:"BrtWbFactoid" */
  },
  /*::[*/
  155: {
    /* n:"BrtFileRecover" */
  },
  /*::[*/
  156: {
    /* n:"BrtBundleSh", */
    f: parse_BrtBundleSh
  },
  /*::[*/
  157: {
    /* n:"BrtCalcProp" */
  },
  /*::[*/
  158: {
    /* n:"BrtBookView" */
  },
  /*::[*/
  159: {
    /* n:"BrtBeginSst", */
    T: 1,
    f: parse_BrtBeginSst
  },
  /*::[*/
  160: {
    /* n:"BrtEndSst", */
    T: -1
  },
  /*::[*/
  161: {
    /* n:"BrtBeginAFilter", */
    T: 1,
    f: parse_UncheckedRfX
  },
  /*::[*/
  162: {
    /* n:"BrtEndAFilter", */
    T: -1
  },
  /*::[*/
  163: {
    /* n:"BrtBeginFilterColumn", */
    T: 1
  },
  /*::[*/
  164: {
    /* n:"BrtEndFilterColumn", */
    T: -1
  },
  /*::[*/
  165: {
    /* n:"BrtBeginFilters", */
    T: 1
  },
  /*::[*/
  166: {
    /* n:"BrtEndFilters", */
    T: -1
  },
  /*::[*/
  167: {
    /* n:"BrtFilter" */
  },
  /*::[*/
  168: {
    /* n:"BrtColorFilter" */
  },
  /*::[*/
  169: {
    /* n:"BrtIconFilter" */
  },
  /*::[*/
  170: {
    /* n:"BrtTop10Filter" */
  },
  /*::[*/
  171: {
    /* n:"BrtDynamicFilter" */
  },
  /*::[*/
  172: {
    /* n:"BrtBeginCustomFilters", */
    T: 1
  },
  /*::[*/
  173: {
    /* n:"BrtEndCustomFilters", */
    T: -1
  },
  /*::[*/
  174: {
    /* n:"BrtCustomFilter" */
  },
  /*::[*/
  175: {
    /* n:"BrtAFilterDateGroupItem" */
  },
  /*::[*/
  176: {
    /* n:"BrtMergeCell", */
    f: parse_BrtMergeCell
  },
  /*::[*/
  177: {
    /* n:"BrtBeginMergeCells", */
    T: 1
  },
  /*::[*/
  178: {
    /* n:"BrtEndMergeCells", */
    T: -1
  },
  /*::[*/
  179: {
    /* n:"BrtBeginPivotCacheDef", */
    T: 1
  },
  /*::[*/
  180: {
    /* n:"BrtEndPivotCacheDef", */
    T: -1
  },
  /*::[*/
  181: {
    /* n:"BrtBeginPCDFields", */
    T: 1
  },
  /*::[*/
  182: {
    /* n:"BrtEndPCDFields", */
    T: -1
  },
  /*::[*/
  183: {
    /* n:"BrtBeginPCDField", */
    T: 1
  },
  /*::[*/
  184: {
    /* n:"BrtEndPCDField", */
    T: -1
  },
  /*::[*/
  185: {
    /* n:"BrtBeginPCDSource", */
    T: 1
  },
  /*::[*/
  186: {
    /* n:"BrtEndPCDSource", */
    T: -1
  },
  /*::[*/
  187: {
    /* n:"BrtBeginPCDSRange", */
    T: 1
  },
  /*::[*/
  188: {
    /* n:"BrtEndPCDSRange", */
    T: -1
  },
  /*::[*/
  189: {
    /* n:"BrtBeginPCDFAtbl", */
    T: 1
  },
  /*::[*/
  190: {
    /* n:"BrtEndPCDFAtbl", */
    T: -1
  },
  /*::[*/
  191: {
    /* n:"BrtBeginPCDIRun", */
    T: 1
  },
  /*::[*/
  192: {
    /* n:"BrtEndPCDIRun", */
    T: -1
  },
  /*::[*/
  193: {
    /* n:"BrtBeginPivotCacheRecords", */
    T: 1
  },
  /*::[*/
  194: {
    /* n:"BrtEndPivotCacheRecords", */
    T: -1
  },
  /*::[*/
  195: {
    /* n:"BrtBeginPCDHierarchies", */
    T: 1
  },
  /*::[*/
  196: {
    /* n:"BrtEndPCDHierarchies", */
    T: -1
  },
  /*::[*/
  197: {
    /* n:"BrtBeginPCDHierarchy", */
    T: 1
  },
  /*::[*/
  198: {
    /* n:"BrtEndPCDHierarchy", */
    T: -1
  },
  /*::[*/
  199: {
    /* n:"BrtBeginPCDHFieldsUsage", */
    T: 1
  },
  /*::[*/
  200: {
    /* n:"BrtEndPCDHFieldsUsage", */
    T: -1
  },
  /*::[*/
  201: {
    /* n:"BrtBeginExtConnection", */
    T: 1
  },
  /*::[*/
  202: {
    /* n:"BrtEndExtConnection", */
    T: -1
  },
  /*::[*/
  203: {
    /* n:"BrtBeginECDbProps", */
    T: 1
  },
  /*::[*/
  204: {
    /* n:"BrtEndECDbProps", */
    T: -1
  },
  /*::[*/
  205: {
    /* n:"BrtBeginECOlapProps", */
    T: 1
  },
  /*::[*/
  206: {
    /* n:"BrtEndECOlapProps", */
    T: -1
  },
  /*::[*/
  207: {
    /* n:"BrtBeginPCDSConsol", */
    T: 1
  },
  /*::[*/
  208: {
    /* n:"BrtEndPCDSConsol", */
    T: -1
  },
  /*::[*/
  209: {
    /* n:"BrtBeginPCDSCPages", */
    T: 1
  },
  /*::[*/
  210: {
    /* n:"BrtEndPCDSCPages", */
    T: -1
  },
  /*::[*/
  211: {
    /* n:"BrtBeginPCDSCPage", */
    T: 1
  },
  /*::[*/
  212: {
    /* n:"BrtEndPCDSCPage", */
    T: -1
  },
  /*::[*/
  213: {
    /* n:"BrtBeginPCDSCPItem", */
    T: 1
  },
  /*::[*/
  214: {
    /* n:"BrtEndPCDSCPItem", */
    T: -1
  },
  /*::[*/
  215: {
    /* n:"BrtBeginPCDSCSets", */
    T: 1
  },
  /*::[*/
  216: {
    /* n:"BrtEndPCDSCSets", */
    T: -1
  },
  /*::[*/
  217: {
    /* n:"BrtBeginPCDSCSet", */
    T: 1
  },
  /*::[*/
  218: {
    /* n:"BrtEndPCDSCSet", */
    T: -1
  },
  /*::[*/
  219: {
    /* n:"BrtBeginPCDFGroup", */
    T: 1
  },
  /*::[*/
  220: {
    /* n:"BrtEndPCDFGroup", */
    T: -1
  },
  /*::[*/
  221: {
    /* n:"BrtBeginPCDFGItems", */
    T: 1
  },
  /*::[*/
  222: {
    /* n:"BrtEndPCDFGItems", */
    T: -1
  },
  /*::[*/
  223: {
    /* n:"BrtBeginPCDFGRange", */
    T: 1
  },
  /*::[*/
  224: {
    /* n:"BrtEndPCDFGRange", */
    T: -1
  },
  /*::[*/
  225: {
    /* n:"BrtBeginPCDFGDiscrete", */
    T: 1
  },
  /*::[*/
  226: {
    /* n:"BrtEndPCDFGDiscrete", */
    T: -1
  },
  /*::[*/
  227: {
    /* n:"BrtBeginPCDSDTupleCache", */
    T: 1
  },
  /*::[*/
  228: {
    /* n:"BrtEndPCDSDTupleCache", */
    T: -1
  },
  /*::[*/
  229: {
    /* n:"BrtBeginPCDSDTCEntries", */
    T: 1
  },
  /*::[*/
  230: {
    /* n:"BrtEndPCDSDTCEntries", */
    T: -1
  },
  /*::[*/
  231: {
    /* n:"BrtBeginPCDSDTCEMembers", */
    T: 1
  },
  /*::[*/
  232: {
    /* n:"BrtEndPCDSDTCEMembers", */
    T: -1
  },
  /*::[*/
  233: {
    /* n:"BrtBeginPCDSDTCEMember", */
    T: 1
  },
  /*::[*/
  234: {
    /* n:"BrtEndPCDSDTCEMember", */
    T: -1
  },
  /*::[*/
  235: {
    /* n:"BrtBeginPCDSDTCQueries", */
    T: 1
  },
  /*::[*/
  236: {
    /* n:"BrtEndPCDSDTCQueries", */
    T: -1
  },
  /*::[*/
  237: {
    /* n:"BrtBeginPCDSDTCQuery", */
    T: 1
  },
  /*::[*/
  238: {
    /* n:"BrtEndPCDSDTCQuery", */
    T: -1
  },
  /*::[*/
  239: {
    /* n:"BrtBeginPCDSDTCSets", */
    T: 1
  },
  /*::[*/
  240: {
    /* n:"BrtEndPCDSDTCSets", */
    T: -1
  },
  /*::[*/
  241: {
    /* n:"BrtBeginPCDSDTCSet", */
    T: 1
  },
  /*::[*/
  242: {
    /* n:"BrtEndPCDSDTCSet", */
    T: -1
  },
  /*::[*/
  243: {
    /* n:"BrtBeginPCDCalcItems", */
    T: 1
  },
  /*::[*/
  244: {
    /* n:"BrtEndPCDCalcItems", */
    T: -1
  },
  /*::[*/
  245: {
    /* n:"BrtBeginPCDCalcItem", */
    T: 1
  },
  /*::[*/
  246: {
    /* n:"BrtEndPCDCalcItem", */
    T: -1
  },
  /*::[*/
  247: {
    /* n:"BrtBeginPRule", */
    T: 1
  },
  /*::[*/
  248: {
    /* n:"BrtEndPRule", */
    T: -1
  },
  /*::[*/
  249: {
    /* n:"BrtBeginPRFilters", */
    T: 1
  },
  /*::[*/
  250: {
    /* n:"BrtEndPRFilters", */
    T: -1
  },
  /*::[*/
  251: {
    /* n:"BrtBeginPRFilter", */
    T: 1
  },
  /*::[*/
  252: {
    /* n:"BrtEndPRFilter", */
    T: -1
  },
  /*::[*/
  253: {
    /* n:"BrtBeginPNames", */
    T: 1
  },
  /*::[*/
  254: {
    /* n:"BrtEndPNames", */
    T: -1
  },
  /*::[*/
  255: {
    /* n:"BrtBeginPName", */
    T: 1
  },
  /*::[*/
  256: {
    /* n:"BrtEndPName", */
    T: -1
  },
  /*::[*/
  257: {
    /* n:"BrtBeginPNPairs", */
    T: 1
  },
  /*::[*/
  258: {
    /* n:"BrtEndPNPairs", */
    T: -1
  },
  /*::[*/
  259: {
    /* n:"BrtBeginPNPair", */
    T: 1
  },
  /*::[*/
  260: {
    /* n:"BrtEndPNPair", */
    T: -1
  },
  /*::[*/
  261: {
    /* n:"BrtBeginECWebProps", */
    T: 1
  },
  /*::[*/
  262: {
    /* n:"BrtEndECWebProps", */
    T: -1
  },
  /*::[*/
  263: {
    /* n:"BrtBeginEcWpTables", */
    T: 1
  },
  /*::[*/
  264: {
    /* n:"BrtEndECWPTables", */
    T: -1
  },
  /*::[*/
  265: {
    /* n:"BrtBeginECParams", */
    T: 1
  },
  /*::[*/
  266: {
    /* n:"BrtEndECParams", */
    T: -1
  },
  /*::[*/
  267: {
    /* n:"BrtBeginECParam", */
    T: 1
  },
  /*::[*/
  268: {
    /* n:"BrtEndECParam", */
    T: -1
  },
  /*::[*/
  269: {
    /* n:"BrtBeginPCDKPIs", */
    T: 1
  },
  /*::[*/
  270: {
    /* n:"BrtEndPCDKPIs", */
    T: -1
  },
  /*::[*/
  271: {
    /* n:"BrtBeginPCDKPI", */
    T: 1
  },
  /*::[*/
  272: {
    /* n:"BrtEndPCDKPI", */
    T: -1
  },
  /*::[*/
  273: {
    /* n:"BrtBeginDims", */
    T: 1
  },
  /*::[*/
  274: {
    /* n:"BrtEndDims", */
    T: -1
  },
  /*::[*/
  275: {
    /* n:"BrtBeginDim", */
    T: 1
  },
  /*::[*/
  276: {
    /* n:"BrtEndDim", */
    T: -1
  },
  /*::[*/
  277: {
    /* n:"BrtIndexPartEnd" */
  },
  /*::[*/
  278: {
    /* n:"BrtBeginStyleSheet", */
    T: 1
  },
  /*::[*/
  279: {
    /* n:"BrtEndStyleSheet", */
    T: -1
  },
  /*::[*/
  280: {
    /* n:"BrtBeginSXView", */
    T: 1
  },
  /*::[*/
  281: {
    /* n:"BrtEndSXVI", */
    T: -1
  },
  /*::[*/
  282: {
    /* n:"BrtBeginSXVI", */
    T: 1
  },
  /*::[*/
  283: {
    /* n:"BrtBeginSXVIs", */
    T: 1
  },
  /*::[*/
  284: {
    /* n:"BrtEndSXVIs", */
    T: -1
  },
  /*::[*/
  285: {
    /* n:"BrtBeginSXVD", */
    T: 1
  },
  /*::[*/
  286: {
    /* n:"BrtEndSXVD", */
    T: -1
  },
  /*::[*/
  287: {
    /* n:"BrtBeginSXVDs", */
    T: 1
  },
  /*::[*/
  288: {
    /* n:"BrtEndSXVDs", */
    T: -1
  },
  /*::[*/
  289: {
    /* n:"BrtBeginSXPI", */
    T: 1
  },
  /*::[*/
  290: {
    /* n:"BrtEndSXPI", */
    T: -1
  },
  /*::[*/
  291: {
    /* n:"BrtBeginSXPIs", */
    T: 1
  },
  /*::[*/
  292: {
    /* n:"BrtEndSXPIs", */
    T: -1
  },
  /*::[*/
  293: {
    /* n:"BrtBeginSXDI", */
    T: 1
  },
  /*::[*/
  294: {
    /* n:"BrtEndSXDI", */
    T: -1
  },
  /*::[*/
  295: {
    /* n:"BrtBeginSXDIs", */
    T: 1
  },
  /*::[*/
  296: {
    /* n:"BrtEndSXDIs", */
    T: -1
  },
  /*::[*/
  297: {
    /* n:"BrtBeginSXLI", */
    T: 1
  },
  /*::[*/
  298: {
    /* n:"BrtEndSXLI", */
    T: -1
  },
  /*::[*/
  299: {
    /* n:"BrtBeginSXLIRws", */
    T: 1
  },
  /*::[*/
  300: {
    /* n:"BrtEndSXLIRws", */
    T: -1
  },
  /*::[*/
  301: {
    /* n:"BrtBeginSXLICols", */
    T: 1
  },
  /*::[*/
  302: {
    /* n:"BrtEndSXLICols", */
    T: -1
  },
  /*::[*/
  303: {
    /* n:"BrtBeginSXFormat", */
    T: 1
  },
  /*::[*/
  304: {
    /* n:"BrtEndSXFormat", */
    T: -1
  },
  /*::[*/
  305: {
    /* n:"BrtBeginSXFormats", */
    T: 1
  },
  /*::[*/
  306: {
    /* n:"BrtEndSxFormats", */
    T: -1
  },
  /*::[*/
  307: {
    /* n:"BrtBeginSxSelect", */
    T: 1
  },
  /*::[*/
  308: {
    /* n:"BrtEndSxSelect", */
    T: -1
  },
  /*::[*/
  309: {
    /* n:"BrtBeginISXVDRws", */
    T: 1
  },
  /*::[*/
  310: {
    /* n:"BrtEndISXVDRws", */
    T: -1
  },
  /*::[*/
  311: {
    /* n:"BrtBeginISXVDCols", */
    T: 1
  },
  /*::[*/
  312: {
    /* n:"BrtEndISXVDCols", */
    T: -1
  },
  /*::[*/
  313: {
    /* n:"BrtEndSXLocation", */
    T: -1
  },
  /*::[*/
  314: {
    /* n:"BrtBeginSXLocation", */
    T: 1
  },
  /*::[*/
  315: {
    /* n:"BrtEndSXView", */
    T: -1
  },
  /*::[*/
  316: {
    /* n:"BrtBeginSXTHs", */
    T: 1
  },
  /*::[*/
  317: {
    /* n:"BrtEndSXTHs", */
    T: -1
  },
  /*::[*/
  318: {
    /* n:"BrtBeginSXTH", */
    T: 1
  },
  /*::[*/
  319: {
    /* n:"BrtEndSXTH", */
    T: -1
  },
  /*::[*/
  320: {
    /* n:"BrtBeginISXTHRws", */
    T: 1
  },
  /*::[*/
  321: {
    /* n:"BrtEndISXTHRws", */
    T: -1
  },
  /*::[*/
  322: {
    /* n:"BrtBeginISXTHCols", */
    T: 1
  },
  /*::[*/
  323: {
    /* n:"BrtEndISXTHCols", */
    T: -1
  },
  /*::[*/
  324: {
    /* n:"BrtBeginSXTDMPS", */
    T: 1
  },
  /*::[*/
  325: {
    /* n:"BrtEndSXTDMPs", */
    T: -1
  },
  /*::[*/
  326: {
    /* n:"BrtBeginSXTDMP", */
    T: 1
  },
  /*::[*/
  327: {
    /* n:"BrtEndSXTDMP", */
    T: -1
  },
  /*::[*/
  328: {
    /* n:"BrtBeginSXTHItems", */
    T: 1
  },
  /*::[*/
  329: {
    /* n:"BrtEndSXTHItems", */
    T: -1
  },
  /*::[*/
  330: {
    /* n:"BrtBeginSXTHItem", */
    T: 1
  },
  /*::[*/
  331: {
    /* n:"BrtEndSXTHItem", */
    T: -1
  },
  /*::[*/
  332: {
    /* n:"BrtBeginMetadata", */
    T: 1
  },
  /*::[*/
  333: {
    /* n:"BrtEndMetadata", */
    T: -1
  },
  /*::[*/
  334: {
    /* n:"BrtBeginEsmdtinfo", */
    T: 1
  },
  /*::[*/
  335: {
    /* n:"BrtMdtinfo", */
    f: parse_BrtMdtinfo
  },
  /*::[*/
  336: {
    /* n:"BrtEndEsmdtinfo", */
    T: -1
  },
  /*::[*/
  337: {
    /* n:"BrtBeginEsmdb", */
    f: parse_BrtBeginEsmdb,
    T: 1
  },
  /*::[*/
  338: {
    /* n:"BrtEndEsmdb", */
    T: -1
  },
  /*::[*/
  339: {
    /* n:"BrtBeginEsfmd", */
    T: 1
  },
  /*::[*/
  340: {
    /* n:"BrtEndEsfmd", */
    T: -1
  },
  /*::[*/
  341: {
    /* n:"BrtBeginSingleCells", */
    T: 1
  },
  /*::[*/
  342: {
    /* n:"BrtEndSingleCells", */
    T: -1
  },
  /*::[*/
  343: {
    /* n:"BrtBeginList", */
    T: 1
  },
  /*::[*/
  344: {
    /* n:"BrtEndList", */
    T: -1
  },
  /*::[*/
  345: {
    /* n:"BrtBeginListCols", */
    T: 1
  },
  /*::[*/
  346: {
    /* n:"BrtEndListCols", */
    T: -1
  },
  /*::[*/
  347: {
    /* n:"BrtBeginListCol", */
    T: 1
  },
  /*::[*/
  348: {
    /* n:"BrtEndListCol", */
    T: -1
  },
  /*::[*/
  349: {
    /* n:"BrtBeginListXmlCPr", */
    T: 1
  },
  /*::[*/
  350: {
    /* n:"BrtEndListXmlCPr", */
    T: -1
  },
  /*::[*/
  351: {
    /* n:"BrtListCCFmla" */
  },
  /*::[*/
  352: {
    /* n:"BrtListTrFmla" */
  },
  /*::[*/
  353: {
    /* n:"BrtBeginExternals", */
    T: 1
  },
  /*::[*/
  354: {
    /* n:"BrtEndExternals", */
    T: -1
  },
  /*::[*/
  355: {
    /* n:"BrtSupBookSrc", */
    f: parse_RelID
  },
  /*::[*/
  357: {
    /* n:"BrtSupSelf" */
  },
  /*::[*/
  358: {
    /* n:"BrtSupSame" */
  },
  /*::[*/
  359: {
    /* n:"BrtSupTabs" */
  },
  /*::[*/
  360: {
    /* n:"BrtBeginSupBook", */
    T: 1
  },
  /*::[*/
  361: {
    /* n:"BrtPlaceholderName" */
  },
  /*::[*/
  362: {
    /* n:"BrtExternSheet", */
    f: parse_ExternSheet
  },
  /*::[*/
  363: {
    /* n:"BrtExternTableStart" */
  },
  /*::[*/
  364: {
    /* n:"BrtExternTableEnd" */
  },
  /*::[*/
  366: {
    /* n:"BrtExternRowHdr" */
  },
  /*::[*/
  367: {
    /* n:"BrtExternCellBlank" */
  },
  /*::[*/
  368: {
    /* n:"BrtExternCellReal" */
  },
  /*::[*/
  369: {
    /* n:"BrtExternCellBool" */
  },
  /*::[*/
  370: {
    /* n:"BrtExternCellError" */
  },
  /*::[*/
  371: {
    /* n:"BrtExternCellString" */
  },
  /*::[*/
  372: {
    /* n:"BrtBeginEsmdx", */
    T: 1
  },
  /*::[*/
  373: {
    /* n:"BrtEndEsmdx", */
    T: -1
  },
  /*::[*/
  374: {
    /* n:"BrtBeginMdxSet", */
    T: 1
  },
  /*::[*/
  375: {
    /* n:"BrtEndMdxSet", */
    T: -1
  },
  /*::[*/
  376: {
    /* n:"BrtBeginMdxMbrProp", */
    T: 1
  },
  /*::[*/
  377: {
    /* n:"BrtEndMdxMbrProp", */
    T: -1
  },
  /*::[*/
  378: {
    /* n:"BrtBeginMdxKPI", */
    T: 1
  },
  /*::[*/
  379: {
    /* n:"BrtEndMdxKPI", */
    T: -1
  },
  /*::[*/
  380: {
    /* n:"BrtBeginEsstr", */
    T: 1
  },
  /*::[*/
  381: {
    /* n:"BrtEndEsstr", */
    T: -1
  },
  /*::[*/
  382: {
    /* n:"BrtBeginPRFItem", */
    T: 1
  },
  /*::[*/
  383: {
    /* n:"BrtEndPRFItem", */
    T: -1
  },
  /*::[*/
  384: {
    /* n:"BrtBeginPivotCacheIDs", */
    T: 1
  },
  /*::[*/
  385: {
    /* n:"BrtEndPivotCacheIDs", */
    T: -1
  },
  /*::[*/
  386: {
    /* n:"BrtBeginPivotCacheID", */
    T: 1
  },
  /*::[*/
  387: {
    /* n:"BrtEndPivotCacheID", */
    T: -1
  },
  /*::[*/
  388: {
    /* n:"BrtBeginISXVIs", */
    T: 1
  },
  /*::[*/
  389: {
    /* n:"BrtEndISXVIs", */
    T: -1
  },
  /*::[*/
  390: {
    /* n:"BrtBeginColInfos", */
    T: 1
  },
  /*::[*/
  391: {
    /* n:"BrtEndColInfos", */
    T: -1
  },
  /*::[*/
  392: {
    /* n:"BrtBeginRwBrk", */
    T: 1
  },
  /*::[*/
  393: {
    /* n:"BrtEndRwBrk", */
    T: -1
  },
  /*::[*/
  394: {
    /* n:"BrtBeginColBrk", */
    T: 1
  },
  /*::[*/
  395: {
    /* n:"BrtEndColBrk", */
    T: -1
  },
  /*::[*/
  396: {
    /* n:"BrtBrk" */
  },
  /*::[*/
  397: {
    /* n:"BrtUserBookView" */
  },
  /*::[*/
  398: {
    /* n:"BrtInfo" */
  },
  /*::[*/
  399: {
    /* n:"BrtCUsr" */
  },
  /*::[*/
  400: {
    /* n:"BrtUsr" */
  },
  /*::[*/
  401: {
    /* n:"BrtBeginUsers", */
    T: 1
  },
  /*::[*/
  403: {
    /* n:"BrtEOF" */
  },
  /*::[*/
  404: {
    /* n:"BrtUCR" */
  },
  /*::[*/
  405: {
    /* n:"BrtRRInsDel" */
  },
  /*::[*/
  406: {
    /* n:"BrtRREndInsDel" */
  },
  /*::[*/
  407: {
    /* n:"BrtRRMove" */
  },
  /*::[*/
  408: {
    /* n:"BrtRREndMove" */
  },
  /*::[*/
  409: {
    /* n:"BrtRRChgCell" */
  },
  /*::[*/
  410: {
    /* n:"BrtRREndChgCell" */
  },
  /*::[*/
  411: {
    /* n:"BrtRRHeader" */
  },
  /*::[*/
  412: {
    /* n:"BrtRRUserView" */
  },
  /*::[*/
  413: {
    /* n:"BrtRRRenSheet" */
  },
  /*::[*/
  414: {
    /* n:"BrtRRInsertSh" */
  },
  /*::[*/
  415: {
    /* n:"BrtRRDefName" */
  },
  /*::[*/
  416: {
    /* n:"BrtRRNote" */
  },
  /*::[*/
  417: {
    /* n:"BrtRRConflict" */
  },
  /*::[*/
  418: {
    /* n:"BrtRRTQSIF" */
  },
  /*::[*/
  419: {
    /* n:"BrtRRFormat" */
  },
  /*::[*/
  420: {
    /* n:"BrtRREndFormat" */
  },
  /*::[*/
  421: {
    /* n:"BrtRRAutoFmt" */
  },
  /*::[*/
  422: {
    /* n:"BrtBeginUserShViews", */
    T: 1
  },
  /*::[*/
  423: {
    /* n:"BrtBeginUserShView", */
    T: 1
  },
  /*::[*/
  424: {
    /* n:"BrtEndUserShView", */
    T: -1
  },
  /*::[*/
  425: {
    /* n:"BrtEndUserShViews", */
    T: -1
  },
  /*::[*/
  426: {
    /* n:"BrtArrFmla", */
    f: parse_BrtArrFmla
  },
  /*::[*/
  427: {
    /* n:"BrtShrFmla", */
    f: parse_BrtShrFmla
  },
  /*::[*/
  428: {
    /* n:"BrtTable" */
  },
  /*::[*/
  429: {
    /* n:"BrtBeginExtConnections", */
    T: 1
  },
  /*::[*/
  430: {
    /* n:"BrtEndExtConnections", */
    T: -1
  },
  /*::[*/
  431: {
    /* n:"BrtBeginPCDCalcMems", */
    T: 1
  },
  /*::[*/
  432: {
    /* n:"BrtEndPCDCalcMems", */
    T: -1
  },
  /*::[*/
  433: {
    /* n:"BrtBeginPCDCalcMem", */
    T: 1
  },
  /*::[*/
  434: {
    /* n:"BrtEndPCDCalcMem", */
    T: -1
  },
  /*::[*/
  435: {
    /* n:"BrtBeginPCDHGLevels", */
    T: 1
  },
  /*::[*/
  436: {
    /* n:"BrtEndPCDHGLevels", */
    T: -1
  },
  /*::[*/
  437: {
    /* n:"BrtBeginPCDHGLevel", */
    T: 1
  },
  /*::[*/
  438: {
    /* n:"BrtEndPCDHGLevel", */
    T: -1
  },
  /*::[*/
  439: {
    /* n:"BrtBeginPCDHGLGroups", */
    T: 1
  },
  /*::[*/
  440: {
    /* n:"BrtEndPCDHGLGroups", */
    T: -1
  },
  /*::[*/
  441: {
    /* n:"BrtBeginPCDHGLGroup", */
    T: 1
  },
  /*::[*/
  442: {
    /* n:"BrtEndPCDHGLGroup", */
    T: -1
  },
  /*::[*/
  443: {
    /* n:"BrtBeginPCDHGLGMembers", */
    T: 1
  },
  /*::[*/
  444: {
    /* n:"BrtEndPCDHGLGMembers", */
    T: -1
  },
  /*::[*/
  445: {
    /* n:"BrtBeginPCDHGLGMember", */
    T: 1
  },
  /*::[*/
  446: {
    /* n:"BrtEndPCDHGLGMember", */
    T: -1
  },
  /*::[*/
  447: {
    /* n:"BrtBeginQSI", */
    T: 1
  },
  /*::[*/
  448: {
    /* n:"BrtEndQSI", */
    T: -1
  },
  /*::[*/
  449: {
    /* n:"BrtBeginQSIR", */
    T: 1
  },
  /*::[*/
  450: {
    /* n:"BrtEndQSIR", */
    T: -1
  },
  /*::[*/
  451: {
    /* n:"BrtBeginDeletedNames", */
    T: 1
  },
  /*::[*/
  452: {
    /* n:"BrtEndDeletedNames", */
    T: -1
  },
  /*::[*/
  453: {
    /* n:"BrtBeginDeletedName", */
    T: 1
  },
  /*::[*/
  454: {
    /* n:"BrtEndDeletedName", */
    T: -1
  },
  /*::[*/
  455: {
    /* n:"BrtBeginQSIFs", */
    T: 1
  },
  /*::[*/
  456: {
    /* n:"BrtEndQSIFs", */
    T: -1
  },
  /*::[*/
  457: {
    /* n:"BrtBeginQSIF", */
    T: 1
  },
  /*::[*/
  458: {
    /* n:"BrtEndQSIF", */
    T: -1
  },
  /*::[*/
  459: {
    /* n:"BrtBeginAutoSortScope", */
    T: 1
  },
  /*::[*/
  460: {
    /* n:"BrtEndAutoSortScope", */
    T: -1
  },
  /*::[*/
  461: {
    /* n:"BrtBeginConditionalFormatting", */
    T: 1
  },
  /*::[*/
  462: {
    /* n:"BrtEndConditionalFormatting", */
    T: -1
  },
  /*::[*/
  463: {
    /* n:"BrtBeginCFRule", */
    T: 1
  },
  /*::[*/
  464: {
    /* n:"BrtEndCFRule", */
    T: -1
  },
  /*::[*/
  465: {
    /* n:"BrtBeginIconSet", */
    T: 1
  },
  /*::[*/
  466: {
    /* n:"BrtEndIconSet", */
    T: -1
  },
  /*::[*/
  467: {
    /* n:"BrtBeginDatabar", */
    T: 1
  },
  /*::[*/
  468: {
    /* n:"BrtEndDatabar", */
    T: -1
  },
  /*::[*/
  469: {
    /* n:"BrtBeginColorScale", */
    T: 1
  },
  /*::[*/
  470: {
    /* n:"BrtEndColorScale", */
    T: -1
  },
  /*::[*/
  471: {
    /* n:"BrtCFVO" */
  },
  /*::[*/
  472: {
    /* n:"BrtExternValueMeta" */
  },
  /*::[*/
  473: {
    /* n:"BrtBeginColorPalette", */
    T: 1
  },
  /*::[*/
  474: {
    /* n:"BrtEndColorPalette", */
    T: -1
  },
  /*::[*/
  475: {
    /* n:"BrtIndexedColor" */
  },
  /*::[*/
  476: {
    /* n:"BrtMargins", */
    f: parse_BrtMargins
  },
  /*::[*/
  477: {
    /* n:"BrtPrintOptions" */
  },
  /*::[*/
  478: {
    /* n:"BrtPageSetup" */
  },
  /*::[*/
  479: {
    /* n:"BrtBeginHeaderFooter", */
    T: 1
  },
  /*::[*/
  480: {
    /* n:"BrtEndHeaderFooter", */
    T: -1
  },
  /*::[*/
  481: {
    /* n:"BrtBeginSXCrtFormat", */
    T: 1
  },
  /*::[*/
  482: {
    /* n:"BrtEndSXCrtFormat", */
    T: -1
  },
  /*::[*/
  483: {
    /* n:"BrtBeginSXCrtFormats", */
    T: 1
  },
  /*::[*/
  484: {
    /* n:"BrtEndSXCrtFormats", */
    T: -1
  },
  /*::[*/
  485: {
    /* n:"BrtWsFmtInfo", */
    f: parse_BrtWsFmtInfo
  },
  /*::[*/
  486: {
    /* n:"BrtBeginMgs", */
    T: 1
  },
  /*::[*/
  487: {
    /* n:"BrtEndMGs", */
    T: -1
  },
  /*::[*/
  488: {
    /* n:"BrtBeginMGMaps", */
    T: 1
  },
  /*::[*/
  489: {
    /* n:"BrtEndMGMaps", */
    T: -1
  },
  /*::[*/
  490: {
    /* n:"BrtBeginMG", */
    T: 1
  },
  /*::[*/
  491: {
    /* n:"BrtEndMG", */
    T: -1
  },
  /*::[*/
  492: {
    /* n:"BrtBeginMap", */
    T: 1
  },
  /*::[*/
  493: {
    /* n:"BrtEndMap", */
    T: -1
  },
  /*::[*/
  494: {
    /* n:"BrtHLink", */
    f: parse_BrtHLink
  },
  /*::[*/
  495: {
    /* n:"BrtBeginDCon", */
    T: 1
  },
  /*::[*/
  496: {
    /* n:"BrtEndDCon", */
    T: -1
  },
  /*::[*/
  497: {
    /* n:"BrtBeginDRefs", */
    T: 1
  },
  /*::[*/
  498: {
    /* n:"BrtEndDRefs", */
    T: -1
  },
  /*::[*/
  499: {
    /* n:"BrtDRef" */
  },
  /*::[*/
  500: {
    /* n:"BrtBeginScenMan", */
    T: 1
  },
  /*::[*/
  501: {
    /* n:"BrtEndScenMan", */
    T: -1
  },
  /*::[*/
  502: {
    /* n:"BrtBeginSct", */
    T: 1
  },
  /*::[*/
  503: {
    /* n:"BrtEndSct", */
    T: -1
  },
  /*::[*/
  504: {
    /* n:"BrtSlc" */
  },
  /*::[*/
  505: {
    /* n:"BrtBeginDXFs", */
    T: 1
  },
  /*::[*/
  506: {
    /* n:"BrtEndDXFs", */
    T: -1
  },
  /*::[*/
  507: {
    /* n:"BrtDXF" */
  },
  /*::[*/
  508: {
    /* n:"BrtBeginTableStyles", */
    T: 1
  },
  /*::[*/
  509: {
    /* n:"BrtEndTableStyles", */
    T: -1
  },
  /*::[*/
  510: {
    /* n:"BrtBeginTableStyle", */
    T: 1
  },
  /*::[*/
  511: {
    /* n:"BrtEndTableStyle", */
    T: -1
  },
  /*::[*/
  512: {
    /* n:"BrtTableStyleElement" */
  },
  /*::[*/
  513: {
    /* n:"BrtTableStyleClient" */
  },
  /*::[*/
  514: {
    /* n:"BrtBeginVolDeps", */
    T: 1
  },
  /*::[*/
  515: {
    /* n:"BrtEndVolDeps", */
    T: -1
  },
  /*::[*/
  516: {
    /* n:"BrtBeginVolType", */
    T: 1
  },
  /*::[*/
  517: {
    /* n:"BrtEndVolType", */
    T: -1
  },
  /*::[*/
  518: {
    /* n:"BrtBeginVolMain", */
    T: 1
  },
  /*::[*/
  519: {
    /* n:"BrtEndVolMain", */
    T: -1
  },
  /*::[*/
  520: {
    /* n:"BrtBeginVolTopic", */
    T: 1
  },
  /*::[*/
  521: {
    /* n:"BrtEndVolTopic", */
    T: -1
  },
  /*::[*/
  522: {
    /* n:"BrtVolSubtopic" */
  },
  /*::[*/
  523: {
    /* n:"BrtVolRef" */
  },
  /*::[*/
  524: {
    /* n:"BrtVolNum" */
  },
  /*::[*/
  525: {
    /* n:"BrtVolErr" */
  },
  /*::[*/
  526: {
    /* n:"BrtVolStr" */
  },
  /*::[*/
  527: {
    /* n:"BrtVolBool" */
  },
  /*::[*/
  528: {
    /* n:"BrtBeginCalcChain$", */
    T: 1
  },
  /*::[*/
  529: {
    /* n:"BrtEndCalcChain$", */
    T: -1
  },
  /*::[*/
  530: {
    /* n:"BrtBeginSortState", */
    T: 1
  },
  /*::[*/
  531: {
    /* n:"BrtEndSortState", */
    T: -1
  },
  /*::[*/
  532: {
    /* n:"BrtBeginSortCond", */
    T: 1
  },
  /*::[*/
  533: {
    /* n:"BrtEndSortCond", */
    T: -1
  },
  /*::[*/
  534: {
    /* n:"BrtBookProtection" */
  },
  /*::[*/
  535: {
    /* n:"BrtSheetProtection" */
  },
  /*::[*/
  536: {
    /* n:"BrtRangeProtection" */
  },
  /*::[*/
  537: {
    /* n:"BrtPhoneticInfo" */
  },
  /*::[*/
  538: {
    /* n:"BrtBeginECTxtWiz", */
    T: 1
  },
  /*::[*/
  539: {
    /* n:"BrtEndECTxtWiz", */
    T: -1
  },
  /*::[*/
  540: {
    /* n:"BrtBeginECTWFldInfoLst", */
    T: 1
  },
  /*::[*/
  541: {
    /* n:"BrtEndECTWFldInfoLst", */
    T: -1
  },
  /*::[*/
  542: {
    /* n:"BrtBeginECTwFldInfo", */
    T: 1
  },
  /*::[*/
  548: {
    /* n:"BrtFileSharing" */
  },
  /*::[*/
  549: {
    /* n:"BrtOleSize" */
  },
  /*::[*/
  550: {
    /* n:"BrtDrawing", */
    f: parse_RelID
  },
  /*::[*/
  551: {
    /* n:"BrtLegacyDrawing" */
  },
  /*::[*/
  552: {
    /* n:"BrtLegacyDrawingHF" */
  },
  /*::[*/
  553: {
    /* n:"BrtWebOpt" */
  },
  /*::[*/
  554: {
    /* n:"BrtBeginWebPubItems", */
    T: 1
  },
  /*::[*/
  555: {
    /* n:"BrtEndWebPubItems", */
    T: -1
  },
  /*::[*/
  556: {
    /* n:"BrtBeginWebPubItem", */
    T: 1
  },
  /*::[*/
  557: {
    /* n:"BrtEndWebPubItem", */
    T: -1
  },
  /*::[*/
  558: {
    /* n:"BrtBeginSXCondFmt", */
    T: 1
  },
  /*::[*/
  559: {
    /* n:"BrtEndSXCondFmt", */
    T: -1
  },
  /*::[*/
  560: {
    /* n:"BrtBeginSXCondFmts", */
    T: 1
  },
  /*::[*/
  561: {
    /* n:"BrtEndSXCondFmts", */
    T: -1
  },
  /*::[*/
  562: {
    /* n:"BrtBkHim" */
  },
  /*::[*/
  564: {
    /* n:"BrtColor" */
  },
  /*::[*/
  565: {
    /* n:"BrtBeginIndexedColors", */
    T: 1
  },
  /*::[*/
  566: {
    /* n:"BrtEndIndexedColors", */
    T: -1
  },
  /*::[*/
  569: {
    /* n:"BrtBeginMRUColors", */
    T: 1
  },
  /*::[*/
  570: {
    /* n:"BrtEndMRUColors", */
    T: -1
  },
  /*::[*/
  572: {
    /* n:"BrtMRUColor" */
  },
  /*::[*/
  573: {
    /* n:"BrtBeginDVals", */
    T: 1
  },
  /*::[*/
  574: {
    /* n:"BrtEndDVals", */
    T: -1
  },
  /*::[*/
  577: {
    /* n:"BrtSupNameStart" */
  },
  /*::[*/
  578: {
    /* n:"BrtSupNameValueStart" */
  },
  /*::[*/
  579: {
    /* n:"BrtSupNameValueEnd" */
  },
  /*::[*/
  580: {
    /* n:"BrtSupNameNum" */
  },
  /*::[*/
  581: {
    /* n:"BrtSupNameErr" */
  },
  /*::[*/
  582: {
    /* n:"BrtSupNameSt" */
  },
  /*::[*/
  583: {
    /* n:"BrtSupNameNil" */
  },
  /*::[*/
  584: {
    /* n:"BrtSupNameBool" */
  },
  /*::[*/
  585: {
    /* n:"BrtSupNameFmla" */
  },
  /*::[*/
  586: {
    /* n:"BrtSupNameBits" */
  },
  /*::[*/
  587: {
    /* n:"BrtSupNameEnd" */
  },
  /*::[*/
  588: {
    /* n:"BrtEndSupBook", */
    T: -1
  },
  /*::[*/
  589: {
    /* n:"BrtCellSmartTagProperty" */
  },
  /*::[*/
  590: {
    /* n:"BrtBeginCellSmartTag", */
    T: 1
  },
  /*::[*/
  591: {
    /* n:"BrtEndCellSmartTag", */
    T: -1
  },
  /*::[*/
  592: {
    /* n:"BrtBeginCellSmartTags", */
    T: 1
  },
  /*::[*/
  593: {
    /* n:"BrtEndCellSmartTags", */
    T: -1
  },
  /*::[*/
  594: {
    /* n:"BrtBeginSmartTags", */
    T: 1
  },
  /*::[*/
  595: {
    /* n:"BrtEndSmartTags", */
    T: -1
  },
  /*::[*/
  596: {
    /* n:"BrtSmartTagType" */
  },
  /*::[*/
  597: {
    /* n:"BrtBeginSmartTagTypes", */
    T: 1
  },
  /*::[*/
  598: {
    /* n:"BrtEndSmartTagTypes", */
    T: -1
  },
  /*::[*/
  599: {
    /* n:"BrtBeginSXFilters", */
    T: 1
  },
  /*::[*/
  600: {
    /* n:"BrtEndSXFilters", */
    T: -1
  },
  /*::[*/
  601: {
    /* n:"BrtBeginSXFILTER", */
    T: 1
  },
  /*::[*/
  602: {
    /* n:"BrtEndSXFilter", */
    T: -1
  },
  /*::[*/
  603: {
    /* n:"BrtBeginFills", */
    T: 1
  },
  /*::[*/
  604: {
    /* n:"BrtEndFills", */
    T: -1
  },
  /*::[*/
  605: {
    /* n:"BrtBeginCellWatches", */
    T: 1
  },
  /*::[*/
  606: {
    /* n:"BrtEndCellWatches", */
    T: -1
  },
  /*::[*/
  607: {
    /* n:"BrtCellWatch" */
  },
  /*::[*/
  608: {
    /* n:"BrtBeginCRErrs", */
    T: 1
  },
  /*::[*/
  609: {
    /* n:"BrtEndCRErrs", */
    T: -1
  },
  /*::[*/
  610: {
    /* n:"BrtCrashRecErr" */
  },
  /*::[*/
  611: {
    /* n:"BrtBeginFonts", */
    T: 1
  },
  /*::[*/
  612: {
    /* n:"BrtEndFonts", */
    T: -1
  },
  /*::[*/
  613: {
    /* n:"BrtBeginBorders", */
    T: 1
  },
  /*::[*/
  614: {
    /* n:"BrtEndBorders", */
    T: -1
  },
  /*::[*/
  615: {
    /* n:"BrtBeginFmts", */
    T: 1
  },
  /*::[*/
  616: {
    /* n:"BrtEndFmts", */
    T: -1
  },
  /*::[*/
  617: {
    /* n:"BrtBeginCellXFs", */
    T: 1
  },
  /*::[*/
  618: {
    /* n:"BrtEndCellXFs", */
    T: -1
  },
  /*::[*/
  619: {
    /* n:"BrtBeginStyles", */
    T: 1
  },
  /*::[*/
  620: {
    /* n:"BrtEndStyles", */
    T: -1
  },
  /*::[*/
  625: {
    /* n:"BrtBigName" */
  },
  /*::[*/
  626: {
    /* n:"BrtBeginCellStyleXFs", */
    T: 1
  },
  /*::[*/
  627: {
    /* n:"BrtEndCellStyleXFs", */
    T: -1
  },
  /*::[*/
  628: {
    /* n:"BrtBeginComments", */
    T: 1
  },
  /*::[*/
  629: {
    /* n:"BrtEndComments", */
    T: -1
  },
  /*::[*/
  630: {
    /* n:"BrtBeginCommentAuthors", */
    T: 1
  },
  /*::[*/
  631: {
    /* n:"BrtEndCommentAuthors", */
    T: -1
  },
  /*::[*/
  632: {
    /* n:"BrtCommentAuthor", */
    f: parse_BrtCommentAuthor
  },
  /*::[*/
  633: {
    /* n:"BrtBeginCommentList", */
    T: 1
  },
  /*::[*/
  634: {
    /* n:"BrtEndCommentList", */
    T: -1
  },
  /*::[*/
  635: {
    /* n:"BrtBeginComment", */
    T: 1,
    f: parse_BrtBeginComment
  },
  /*::[*/
  636: {
    /* n:"BrtEndComment", */
    T: -1
  },
  /*::[*/
  637: {
    /* n:"BrtCommentText", */
    f: parse_BrtCommentText
  },
  /*::[*/
  638: {
    /* n:"BrtBeginOleObjects", */
    T: 1
  },
  /*::[*/
  639: {
    /* n:"BrtOleObject" */
  },
  /*::[*/
  640: {
    /* n:"BrtEndOleObjects", */
    T: -1
  },
  /*::[*/
  641: {
    /* n:"BrtBeginSxrules", */
    T: 1
  },
  /*::[*/
  642: {
    /* n:"BrtEndSxRules", */
    T: -1
  },
  /*::[*/
  643: {
    /* n:"BrtBeginActiveXControls", */
    T: 1
  },
  /*::[*/
  644: {
    /* n:"BrtActiveX" */
  },
  /*::[*/
  645: {
    /* n:"BrtEndActiveXControls", */
    T: -1
  },
  /*::[*/
  646: {
    /* n:"BrtBeginPCDSDTCEMembersSortBy", */
    T: 1
  },
  /*::[*/
  648: {
    /* n:"BrtBeginCellIgnoreECs", */
    T: 1
  },
  /*::[*/
  649: {
    /* n:"BrtCellIgnoreEC" */
  },
  /*::[*/
  650: {
    /* n:"BrtEndCellIgnoreECs", */
    T: -1
  },
  /*::[*/
  651: {
    /* n:"BrtCsProp", */
    f: parse_BrtCsProp
  },
  /*::[*/
  652: {
    /* n:"BrtCsPageSetup" */
  },
  /*::[*/
  653: {
    /* n:"BrtBeginUserCsViews", */
    T: 1
  },
  /*::[*/
  654: {
    /* n:"BrtEndUserCsViews", */
    T: -1
  },
  /*::[*/
  655: {
    /* n:"BrtBeginUserCsView", */
    T: 1
  },
  /*::[*/
  656: {
    /* n:"BrtEndUserCsView", */
    T: -1
  },
  /*::[*/
  657: {
    /* n:"BrtBeginPcdSFCIEntries", */
    T: 1
  },
  /*::[*/
  658: {
    /* n:"BrtEndPCDSFCIEntries", */
    T: -1
  },
  /*::[*/
  659: {
    /* n:"BrtPCDSFCIEntry" */
  },
  /*::[*/
  660: {
    /* n:"BrtBeginListParts", */
    T: 1
  },
  /*::[*/
  661: {
    /* n:"BrtListPart" */
  },
  /*::[*/
  662: {
    /* n:"BrtEndListParts", */
    T: -1
  },
  /*::[*/
  663: {
    /* n:"BrtSheetCalcProp" */
  },
  /*::[*/
  664: {
    /* n:"BrtBeginFnGroup", */
    T: 1
  },
  /*::[*/
  665: {
    /* n:"BrtFnGroup" */
  },
  /*::[*/
  666: {
    /* n:"BrtEndFnGroup", */
    T: -1
  },
  /*::[*/
  667: {
    /* n:"BrtSupAddin" */
  },
  /*::[*/
  668: {
    /* n:"BrtSXTDMPOrder" */
  },
  /*::[*/
  669: {
    /* n:"BrtCsProtection" */
  },
  /*::[*/
  671: {
    /* n:"BrtBeginWsSortMap", */
    T: 1
  },
  /*::[*/
  672: {
    /* n:"BrtEndWsSortMap", */
    T: -1
  },
  /*::[*/
  673: {
    /* n:"BrtBeginRRSort", */
    T: 1
  },
  /*::[*/
  674: {
    /* n:"BrtEndRRSort", */
    T: -1
  },
  /*::[*/
  675: {
    /* n:"BrtRRSortItem" */
  },
  /*::[*/
  676: {
    /* n:"BrtFileSharingIso" */
  },
  /*::[*/
  677: {
    /* n:"BrtBookProtectionIso" */
  },
  /*::[*/
  678: {
    /* n:"BrtSheetProtectionIso" */
  },
  /*::[*/
  679: {
    /* n:"BrtCsProtectionIso" */
  },
  /*::[*/
  680: {
    /* n:"BrtRangeProtectionIso" */
  },
  /*::[*/
  681: {
    /* n:"BrtDValList" */
  },
  /*::[*/
  1024: {
    /* n:"BrtRwDescent" */
  },
  /*::[*/
  1025: {
    /* n:"BrtKnownFonts" */
  },
  /*::[*/
  1026: {
    /* n:"BrtBeginSXTupleSet", */
    T: 1
  },
  /*::[*/
  1027: {
    /* n:"BrtEndSXTupleSet", */
    T: -1
  },
  /*::[*/
  1028: {
    /* n:"BrtBeginSXTupleSetHeader", */
    T: 1
  },
  /*::[*/
  1029: {
    /* n:"BrtEndSXTupleSetHeader", */
    T: -1
  },
  /*::[*/
  1030: {
    /* n:"BrtSXTupleSetHeaderItem" */
  },
  /*::[*/
  1031: {
    /* n:"BrtBeginSXTupleSetData", */
    T: 1
  },
  /*::[*/
  1032: {
    /* n:"BrtEndSXTupleSetData", */
    T: -1
  },
  /*::[*/
  1033: {
    /* n:"BrtBeginSXTupleSetRow", */
    T: 1
  },
  /*::[*/
  1034: {
    /* n:"BrtEndSXTupleSetRow", */
    T: -1
  },
  /*::[*/
  1035: {
    /* n:"BrtSXTupleSetRowItem" */
  },
  /*::[*/
  1036: {
    /* n:"BrtNameExt" */
  },
  /*::[*/
  1037: {
    /* n:"BrtPCDH14" */
  },
  /*::[*/
  1038: {
    /* n:"BrtBeginPCDCalcMem14", */
    T: 1
  },
  /*::[*/
  1039: {
    /* n:"BrtEndPCDCalcMem14", */
    T: -1
  },
  /*::[*/
  1040: {
    /* n:"BrtSXTH14" */
  },
  /*::[*/
  1041: {
    /* n:"BrtBeginSparklineGroup", */
    T: 1
  },
  /*::[*/
  1042: {
    /* n:"BrtEndSparklineGroup", */
    T: -1
  },
  /*::[*/
  1043: {
    /* n:"BrtSparkline" */
  },
  /*::[*/
  1044: {
    /* n:"BrtSXDI14" */
  },
  /*::[*/
  1045: {
    /* n:"BrtWsFmtInfoEx14" */
  },
  /*::[*/
  1046: {
    /* n:"BrtBeginConditionalFormatting14", */
    T: 1
  },
  /*::[*/
  1047: {
    /* n:"BrtEndConditionalFormatting14", */
    T: -1
  },
  /*::[*/
  1048: {
    /* n:"BrtBeginCFRule14", */
    T: 1
  },
  /*::[*/
  1049: {
    /* n:"BrtEndCFRule14", */
    T: -1
  },
  /*::[*/
  1050: {
    /* n:"BrtCFVO14" */
  },
  /*::[*/
  1051: {
    /* n:"BrtBeginDatabar14", */
    T: 1
  },
  /*::[*/
  1052: {
    /* n:"BrtBeginIconSet14", */
    T: 1
  },
  /*::[*/
  1053: {
    /* n:"BrtDVal14", */
    f: parse_BrtDVal14
  },
  /*::[*/
  1054: {
    /* n:"BrtBeginDVals14", */
    T: 1
  },
  /*::[*/
  1055: {
    /* n:"BrtColor14" */
  },
  /*::[*/
  1056: {
    /* n:"BrtBeginSparklines", */
    T: 1
  },
  /*::[*/
  1057: {
    /* n:"BrtEndSparklines", */
    T: -1
  },
  /*::[*/
  1058: {
    /* n:"BrtBeginSparklineGroups", */
    T: 1
  },
  /*::[*/
  1059: {
    /* n:"BrtEndSparklineGroups", */
    T: -1
  },
  /*::[*/
  1061: {
    /* n:"BrtSXVD14" */
  },
  /*::[*/
  1062: {
    /* n:"BrtBeginSXView14", */
    T: 1
  },
  /*::[*/
  1063: {
    /* n:"BrtEndSXView14", */
    T: -1
  },
  /*::[*/
  1064: {
    /* n:"BrtBeginSXView16", */
    T: 1
  },
  /*::[*/
  1065: {
    /* n:"BrtEndSXView16", */
    T: -1
  },
  /*::[*/
  1066: {
    /* n:"BrtBeginPCD14", */
    T: 1
  },
  /*::[*/
  1067: {
    /* n:"BrtEndPCD14", */
    T: -1
  },
  /*::[*/
  1068: {
    /* n:"BrtBeginExtConn14", */
    T: 1
  },
  /*::[*/
  1069: {
    /* n:"BrtEndExtConn14", */
    T: -1
  },
  /*::[*/
  1070: {
    /* n:"BrtBeginSlicerCacheIDs", */
    T: 1
  },
  /*::[*/
  1071: {
    /* n:"BrtEndSlicerCacheIDs", */
    T: -1
  },
  /*::[*/
  1072: {
    /* n:"BrtBeginSlicerCacheID", */
    T: 1
  },
  /*::[*/
  1073: {
    /* n:"BrtEndSlicerCacheID", */
    T: -1
  },
  /*::[*/
  1075: {
    /* n:"BrtBeginSlicerCache", */
    T: 1
  },
  /*::[*/
  1076: {
    /* n:"BrtEndSlicerCache", */
    T: -1
  },
  /*::[*/
  1077: {
    /* n:"BrtBeginSlicerCacheDef", */
    T: 1
  },
  /*::[*/
  1078: {
    /* n:"BrtEndSlicerCacheDef", */
    T: -1
  },
  /*::[*/
  1079: {
    /* n:"BrtBeginSlicersEx", */
    T: 1
  },
  /*::[*/
  1080: {
    /* n:"BrtEndSlicersEx", */
    T: -1
  },
  /*::[*/
  1081: {
    /* n:"BrtBeginSlicerEx", */
    T: 1
  },
  /*::[*/
  1082: {
    /* n:"BrtEndSlicerEx", */
    T: -1
  },
  /*::[*/
  1083: {
    /* n:"BrtBeginSlicer", */
    T: 1
  },
  /*::[*/
  1084: {
    /* n:"BrtEndSlicer", */
    T: -1
  },
  /*::[*/
  1085: {
    /* n:"BrtSlicerCachePivotTables" */
  },
  /*::[*/
  1086: {
    /* n:"BrtBeginSlicerCacheOlapImpl", */
    T: 1
  },
  /*::[*/
  1087: {
    /* n:"BrtEndSlicerCacheOlapImpl", */
    T: -1
  },
  /*::[*/
  1088: {
    /* n:"BrtBeginSlicerCacheLevelsData", */
    T: 1
  },
  /*::[*/
  1089: {
    /* n:"BrtEndSlicerCacheLevelsData", */
    T: -1
  },
  /*::[*/
  1090: {
    /* n:"BrtBeginSlicerCacheLevelData", */
    T: 1
  },
  /*::[*/
  1091: {
    /* n:"BrtEndSlicerCacheLevelData", */
    T: -1
  },
  /*::[*/
  1092: {
    /* n:"BrtBeginSlicerCacheSiRanges", */
    T: 1
  },
  /*::[*/
  1093: {
    /* n:"BrtEndSlicerCacheSiRanges", */
    T: -1
  },
  /*::[*/
  1094: {
    /* n:"BrtBeginSlicerCacheSiRange", */
    T: 1
  },
  /*::[*/
  1095: {
    /* n:"BrtEndSlicerCacheSiRange", */
    T: -1
  },
  /*::[*/
  1096: {
    /* n:"BrtSlicerCacheOlapItem" */
  },
  /*::[*/
  1097: {
    /* n:"BrtBeginSlicerCacheSelections", */
    T: 1
  },
  /*::[*/
  1098: {
    /* n:"BrtSlicerCacheSelection" */
  },
  /*::[*/
  1099: {
    /* n:"BrtEndSlicerCacheSelections", */
    T: -1
  },
  /*::[*/
  1100: {
    /* n:"BrtBeginSlicerCacheNative", */
    T: 1
  },
  /*::[*/
  1101: {
    /* n:"BrtEndSlicerCacheNative", */
    T: -1
  },
  /*::[*/
  1102: {
    /* n:"BrtSlicerCacheNativeItem" */
  },
  /*::[*/
  1103: {
    /* n:"BrtRangeProtection14" */
  },
  /*::[*/
  1104: {
    /* n:"BrtRangeProtectionIso14" */
  },
  /*::[*/
  1105: {
    /* n:"BrtCellIgnoreEC14" */
  },
  /*::[*/
  1111: {
    /* n:"BrtList14" */
  },
  /*::[*/
  1112: {
    /* n:"BrtCFIcon" */
  },
  /*::[*/
  1113: {
    /* n:"BrtBeginSlicerCachesPivotCacheIDs", */
    T: 1
  },
  /*::[*/
  1114: {
    /* n:"BrtEndSlicerCachesPivotCacheIDs", */
    T: -1
  },
  /*::[*/
  1115: {
    /* n:"BrtBeginSlicers", */
    T: 1
  },
  /*::[*/
  1116: {
    /* n:"BrtEndSlicers", */
    T: -1
  },
  /*::[*/
  1117: {
    /* n:"BrtWbProp14" */
  },
  /*::[*/
  1118: {
    /* n:"BrtBeginSXEdit", */
    T: 1
  },
  /*::[*/
  1119: {
    /* n:"BrtEndSXEdit", */
    T: -1
  },
  /*::[*/
  1120: {
    /* n:"BrtBeginSXEdits", */
    T: 1
  },
  /*::[*/
  1121: {
    /* n:"BrtEndSXEdits", */
    T: -1
  },
  /*::[*/
  1122: {
    /* n:"BrtBeginSXChange", */
    T: 1
  },
  /*::[*/
  1123: {
    /* n:"BrtEndSXChange", */
    T: -1
  },
  /*::[*/
  1124: {
    /* n:"BrtBeginSXChanges", */
    T: 1
  },
  /*::[*/
  1125: {
    /* n:"BrtEndSXChanges", */
    T: -1
  },
  /*::[*/
  1126: {
    /* n:"BrtSXTupleItems" */
  },
  /*::[*/
  1128: {
    /* n:"BrtBeginSlicerStyle", */
    T: 1
  },
  /*::[*/
  1129: {
    /* n:"BrtEndSlicerStyle", */
    T: -1
  },
  /*::[*/
  1130: {
    /* n:"BrtSlicerStyleElement" */
  },
  /*::[*/
  1131: {
    /* n:"BrtBeginStyleSheetExt14", */
    T: 1
  },
  /*::[*/
  1132: {
    /* n:"BrtEndStyleSheetExt14", */
    T: -1
  },
  /*::[*/
  1133: {
    /* n:"BrtBeginSlicerCachesPivotCacheID", */
    T: 1
  },
  /*::[*/
  1134: {
    /* n:"BrtEndSlicerCachesPivotCacheID", */
    T: -1
  },
  /*::[*/
  1135: {
    /* n:"BrtBeginConditionalFormattings", */
    T: 1
  },
  /*::[*/
  1136: {
    /* n:"BrtEndConditionalFormattings", */
    T: -1
  },
  /*::[*/
  1137: {
    /* n:"BrtBeginPCDCalcMemExt", */
    T: 1
  },
  /*::[*/
  1138: {
    /* n:"BrtEndPCDCalcMemExt", */
    T: -1
  },
  /*::[*/
  1139: {
    /* n:"BrtBeginPCDCalcMemsExt", */
    T: 1
  },
  /*::[*/
  1140: {
    /* n:"BrtEndPCDCalcMemsExt", */
    T: -1
  },
  /*::[*/
  1141: {
    /* n:"BrtPCDField14" */
  },
  /*::[*/
  1142: {
    /* n:"BrtBeginSlicerStyles", */
    T: 1
  },
  /*::[*/
  1143: {
    /* n:"BrtEndSlicerStyles", */
    T: -1
  },
  /*::[*/
  1144: {
    /* n:"BrtBeginSlicerStyleElements", */
    T: 1
  },
  /*::[*/
  1145: {
    /* n:"BrtEndSlicerStyleElements", */
    T: -1
  },
  /*::[*/
  1146: {
    /* n:"BrtCFRuleExt" */
  },
  /*::[*/
  1147: {
    /* n:"BrtBeginSXCondFmt14", */
    T: 1
  },
  /*::[*/
  1148: {
    /* n:"BrtEndSXCondFmt14", */
    T: -1
  },
  /*::[*/
  1149: {
    /* n:"BrtBeginSXCondFmts14", */
    T: 1
  },
  /*::[*/
  1150: {
    /* n:"BrtEndSXCondFmts14", */
    T: -1
  },
  /*::[*/
  1152: {
    /* n:"BrtBeginSortCond14", */
    T: 1
  },
  /*::[*/
  1153: {
    /* n:"BrtEndSortCond14", */
    T: -1
  },
  /*::[*/
  1154: {
    /* n:"BrtEndDVals14", */
    T: -1
  },
  /*::[*/
  1155: {
    /* n:"BrtEndIconSet14", */
    T: -1
  },
  /*::[*/
  1156: {
    /* n:"BrtEndDatabar14", */
    T: -1
  },
  /*::[*/
  1157: {
    /* n:"BrtBeginColorScale14", */
    T: 1
  },
  /*::[*/
  1158: {
    /* n:"BrtEndColorScale14", */
    T: -1
  },
  /*::[*/
  1159: {
    /* n:"BrtBeginSxrules14", */
    T: 1
  },
  /*::[*/
  1160: {
    /* n:"BrtEndSxrules14", */
    T: -1
  },
  /*::[*/
  1161: {
    /* n:"BrtBeginPRule14", */
    T: 1
  },
  /*::[*/
  1162: {
    /* n:"BrtEndPRule14", */
    T: -1
  },
  /*::[*/
  1163: {
    /* n:"BrtBeginPRFilters14", */
    T: 1
  },
  /*::[*/
  1164: {
    /* n:"BrtEndPRFilters14", */
    T: -1
  },
  /*::[*/
  1165: {
    /* n:"BrtBeginPRFilter14", */
    T: 1
  },
  /*::[*/
  1166: {
    /* n:"BrtEndPRFilter14", */
    T: -1
  },
  /*::[*/
  1167: {
    /* n:"BrtBeginPRFItem14", */
    T: 1
  },
  /*::[*/
  1168: {
    /* n:"BrtEndPRFItem14", */
    T: -1
  },
  /*::[*/
  1169: {
    /* n:"BrtBeginCellIgnoreECs14", */
    T: 1
  },
  /*::[*/
  1170: {
    /* n:"BrtEndCellIgnoreECs14", */
    T: -1
  },
  /*::[*/
  1171: {
    /* n:"BrtDxf14" */
  },
  /*::[*/
  1172: {
    /* n:"BrtBeginDxF14s", */
    T: 1
  },
  /*::[*/
  1173: {
    /* n:"BrtEndDxf14s", */
    T: -1
  },
  /*::[*/
  1177: {
    /* n:"BrtFilter14" */
  },
  /*::[*/
  1178: {
    /* n:"BrtBeginCustomFilters14", */
    T: 1
  },
  /*::[*/
  1180: {
    /* n:"BrtCustomFilter14" */
  },
  /*::[*/
  1181: {
    /* n:"BrtIconFilter14" */
  },
  /*::[*/
  1182: {
    /* n:"BrtPivotCacheConnectionName" */
  },
  /*::[*/
  2048: {
    /* n:"BrtBeginDecoupledPivotCacheIDs", */
    T: 1
  },
  /*::[*/
  2049: {
    /* n:"BrtEndDecoupledPivotCacheIDs", */
    T: -1
  },
  /*::[*/
  2050: {
    /* n:"BrtDecoupledPivotCacheID" */
  },
  /*::[*/
  2051: {
    /* n:"BrtBeginPivotTableRefs", */
    T: 1
  },
  /*::[*/
  2052: {
    /* n:"BrtEndPivotTableRefs", */
    T: -1
  },
  /*::[*/
  2053: {
    /* n:"BrtPivotTableRef" */
  },
  /*::[*/
  2054: {
    /* n:"BrtSlicerCacheBookPivotTables" */
  },
  /*::[*/
  2055: {
    /* n:"BrtBeginSxvcells", */
    T: 1
  },
  /*::[*/
  2056: {
    /* n:"BrtEndSxvcells", */
    T: -1
  },
  /*::[*/
  2057: {
    /* n:"BrtBeginSxRow", */
    T: 1
  },
  /*::[*/
  2058: {
    /* n:"BrtEndSxRow", */
    T: -1
  },
  /*::[*/
  2060: {
    /* n:"BrtPcdCalcMem15" */
  },
  /*::[*/
  2067: {
    /* n:"BrtQsi15" */
  },
  /*::[*/
  2068: {
    /* n:"BrtBeginWebExtensions", */
    T: 1
  },
  /*::[*/
  2069: {
    /* n:"BrtEndWebExtensions", */
    T: -1
  },
  /*::[*/
  2070: {
    /* n:"BrtWebExtension" */
  },
  /*::[*/
  2071: {
    /* n:"BrtAbsPath15" */
  },
  /*::[*/
  2072: {
    /* n:"BrtBeginPivotTableUISettings", */
    T: 1
  },
  /*::[*/
  2073: {
    /* n:"BrtEndPivotTableUISettings", */
    T: -1
  },
  /*::[*/
  2075: {
    /* n:"BrtTableSlicerCacheIDs" */
  },
  /*::[*/
  2076: {
    /* n:"BrtTableSlicerCacheID" */
  },
  /*::[*/
  2077: {
    /* n:"BrtBeginTableSlicerCache", */
    T: 1
  },
  /*::[*/
  2078: {
    /* n:"BrtEndTableSlicerCache", */
    T: -1
  },
  /*::[*/
  2079: {
    /* n:"BrtSxFilter15" */
  },
  /*::[*/
  2080: {
    /* n:"BrtBeginTimelineCachePivotCacheIDs", */
    T: 1
  },
  /*::[*/
  2081: {
    /* n:"BrtEndTimelineCachePivotCacheIDs", */
    T: -1
  },
  /*::[*/
  2082: {
    /* n:"BrtTimelineCachePivotCacheID" */
  },
  /*::[*/
  2083: {
    /* n:"BrtBeginTimelineCacheIDs", */
    T: 1
  },
  /*::[*/
  2084: {
    /* n:"BrtEndTimelineCacheIDs", */
    T: -1
  },
  /*::[*/
  2085: {
    /* n:"BrtBeginTimelineCacheID", */
    T: 1
  },
  /*::[*/
  2086: {
    /* n:"BrtEndTimelineCacheID", */
    T: -1
  },
  /*::[*/
  2087: {
    /* n:"BrtBeginTimelinesEx", */
    T: 1
  },
  /*::[*/
  2088: {
    /* n:"BrtEndTimelinesEx", */
    T: -1
  },
  /*::[*/
  2089: {
    /* n:"BrtBeginTimelineEx", */
    T: 1
  },
  /*::[*/
  2090: {
    /* n:"BrtEndTimelineEx", */
    T: -1
  },
  /*::[*/
  2091: {
    /* n:"BrtWorkBookPr15" */
  },
  /*::[*/
  2092: {
    /* n:"BrtPCDH15" */
  },
  /*::[*/
  2093: {
    /* n:"BrtBeginTimelineStyle", */
    T: 1
  },
  /*::[*/
  2094: {
    /* n:"BrtEndTimelineStyle", */
    T: -1
  },
  /*::[*/
  2095: {
    /* n:"BrtTimelineStyleElement" */
  },
  /*::[*/
  2096: {
    /* n:"BrtBeginTimelineStylesheetExt15", */
    T: 1
  },
  /*::[*/
  2097: {
    /* n:"BrtEndTimelineStylesheetExt15", */
    T: -1
  },
  /*::[*/
  2098: {
    /* n:"BrtBeginTimelineStyles", */
    T: 1
  },
  /*::[*/
  2099: {
    /* n:"BrtEndTimelineStyles", */
    T: -1
  },
  /*::[*/
  2100: {
    /* n:"BrtBeginTimelineStyleElements", */
    T: 1
  },
  /*::[*/
  2101: {
    /* n:"BrtEndTimelineStyleElements", */
    T: -1
  },
  /*::[*/
  2102: {
    /* n:"BrtDxf15" */
  },
  /*::[*/
  2103: {
    /* n:"BrtBeginDxfs15", */
    T: 1
  },
  /*::[*/
  2104: {
    /* n:"BrtEndDxfs15", */
    T: -1
  },
  /*::[*/
  2105: {
    /* n:"BrtSlicerCacheHideItemsWithNoData" */
  },
  /*::[*/
  2106: {
    /* n:"BrtBeginItemUniqueNames", */
    T: 1
  },
  /*::[*/
  2107: {
    /* n:"BrtEndItemUniqueNames", */
    T: -1
  },
  /*::[*/
  2108: {
    /* n:"BrtItemUniqueName" */
  },
  /*::[*/
  2109: {
    /* n:"BrtBeginExtConn15", */
    T: 1
  },
  /*::[*/
  2110: {
    /* n:"BrtEndExtConn15", */
    T: -1
  },
  /*::[*/
  2111: {
    /* n:"BrtBeginOledbPr15", */
    T: 1
  },
  /*::[*/
  2112: {
    /* n:"BrtEndOledbPr15", */
    T: -1
  },
  /*::[*/
  2113: {
    /* n:"BrtBeginDataFeedPr15", */
    T: 1
  },
  /*::[*/
  2114: {
    /* n:"BrtEndDataFeedPr15", */
    T: -1
  },
  /*::[*/
  2115: {
    /* n:"BrtTextPr15" */
  },
  /*::[*/
  2116: {
    /* n:"BrtRangePr15" */
  },
  /*::[*/
  2117: {
    /* n:"BrtDbCommand15" */
  },
  /*::[*/
  2118: {
    /* n:"BrtBeginDbTables15", */
    T: 1
  },
  /*::[*/
  2119: {
    /* n:"BrtEndDbTables15", */
    T: -1
  },
  /*::[*/
  2120: {
    /* n:"BrtDbTable15" */
  },
  /*::[*/
  2121: {
    /* n:"BrtBeginDataModel", */
    T: 1
  },
  /*::[*/
  2122: {
    /* n:"BrtEndDataModel", */
    T: -1
  },
  /*::[*/
  2123: {
    /* n:"BrtBeginModelTables", */
    T: 1
  },
  /*::[*/
  2124: {
    /* n:"BrtEndModelTables", */
    T: -1
  },
  /*::[*/
  2125: {
    /* n:"BrtModelTable" */
  },
  /*::[*/
  2126: {
    /* n:"BrtBeginModelRelationships", */
    T: 1
  },
  /*::[*/
  2127: {
    /* n:"BrtEndModelRelationships", */
    T: -1
  },
  /*::[*/
  2128: {
    /* n:"BrtModelRelationship" */
  },
  /*::[*/
  2129: {
    /* n:"BrtBeginECTxtWiz15", */
    T: 1
  },
  /*::[*/
  2130: {
    /* n:"BrtEndECTxtWiz15", */
    T: -1
  },
  /*::[*/
  2131: {
    /* n:"BrtBeginECTWFldInfoLst15", */
    T: 1
  },
  /*::[*/
  2132: {
    /* n:"BrtEndECTWFldInfoLst15", */
    T: -1
  },
  /*::[*/
  2133: {
    /* n:"BrtBeginECTWFldInfo15", */
    T: 1
  },
  /*::[*/
  2134: {
    /* n:"BrtFieldListActiveItem" */
  },
  /*::[*/
  2135: {
    /* n:"BrtPivotCacheIdVersion" */
  },
  /*::[*/
  2136: {
    /* n:"BrtSXDI15" */
  },
  /*::[*/
  2137: {
    /* n:"BrtBeginModelTimeGroupings", */
    T: 1
  },
  /*::[*/
  2138: {
    /* n:"BrtEndModelTimeGroupings", */
    T: -1
  },
  /*::[*/
  2139: {
    /* n:"BrtBeginModelTimeGrouping", */
    T: 1
  },
  /*::[*/
  2140: {
    /* n:"BrtEndModelTimeGrouping", */
    T: -1
  },
  /*::[*/
  2141: {
    /* n:"BrtModelTimeGroupingCalcCol" */
  },
  /*::[*/
  3072: {
    /* n:"BrtUid" */
  },
  /*::[*/
  3073: {
    /* n:"BrtRevisionPtr" */
  },
  /*::[*/
  4096: {
    /* n:"BrtBeginDynamicArrayPr", */
    T: 1
  },
  /*::[*/
  4097: {
    /* n:"BrtEndDynamicArrayPr", */
    T: -1
  },
  /*::[*/
  5002: {
    /* n:"BrtBeginRichValueBlock", */
    T: 1
  },
  /*::[*/
  5003: {
    /* n:"BrtEndRichValueBlock", */
    T: -1
  },
  /*::[*/
  5081: {
    /* n:"BrtBeginRichFilters", */
    T: 1
  },
  /*::[*/
  5082: {
    /* n:"BrtEndRichFilters", */
    T: -1
  },
  /*::[*/
  5083: {
    /* n:"BrtRichFilter" */
  },
  /*::[*/
  5084: {
    /* n:"BrtBeginRichFilterColumn", */
    T: 1
  },
  /*::[*/
  5085: {
    /* n:"BrtEndRichFilterColumn", */
    T: -1
  },
  /*::[*/
  5086: {
    /* n:"BrtBeginCustomRichFilters", */
    T: 1
  },
  /*::[*/
  5087: {
    /* n:"BrtEndCustomRichFilters", */
    T: -1
  },
  /*::[*/
  5088: {
    /* n:"BrtCustomRichFilter" */
  },
  /*::[*/
  5089: {
    /* n:"BrtTop10RichFilter" */
  },
  /*::[*/
  5090: {
    /* n:"BrtDynamicRichFilter" */
  },
  /*::[*/
  5092: {
    /* n:"BrtBeginRichSortCondition", */
    T: 1
  },
  /*::[*/
  5093: {
    /* n:"BrtEndRichSortCondition", */
    T: -1
  },
  /*::[*/
  5094: {
    /* n:"BrtRichFilterDateGroupItem" */
  },
  /*::[*/
  5095: {
    /* n:"BrtBeginCalcFeatures", */
    T: 1
  },
  /*::[*/
  5096: {
    /* n:"BrtEndCalcFeatures", */
    T: -1
  },
  /*::[*/
  5097: {
    /* n:"BrtCalcFeature" */
  },
  /*::[*/
  5099: {
    /* n:"BrtExternalLinksPr" */
  },
  /*::[*/
  65535: {
    n: ""
  }
};
function write_biff_rec(ba, type, payload, length) {
  var t = type;
  if (isNaN(t)) return;
  var len = length || (payload || []).length || 0;
  var o = ba.next(4);
  o.write_shift(2, t);
  o.write_shift(2, len);
  if (
    /*:: len != null &&*/
    len > 0 && is_buf(payload)
  ) ba.push(payload);
}
function write_biff_continue(ba, type, payload, length) {
  var len = length || (payload || []).length || 0;
  if (len <= 8224) return write_biff_rec(ba, type, payload, len);
  var t = type;
  if (isNaN(t)) return;
  var parts = payload.parts || [], sidx = 0;
  var i = 0, w = 0;
  while (w + (parts[sidx] || 8224) <= 8224) {
    w += parts[sidx] || 8224;
    sidx++;
  }
  var o = ba.next(4);
  o.write_shift(2, t);
  o.write_shift(2, w);
  ba.push(payload.slice(i, i + w));
  i += w;
  while (i < len) {
    o = ba.next(4);
    o.write_shift(2, 60);
    w = 0;
    while (w + (parts[sidx] || 8224) <= 8224) {
      w += parts[sidx] || 8224;
      sidx++;
    }
    o.write_shift(2, w);
    ba.push(payload.slice(i, i + w));
    i += w;
  }
}
function write_BIFF2Cell(out, r, c) {
  if (!out) out = new_buf(7);
  out.write_shift(2, r);
  out.write_shift(2, c);
  out.write_shift(2, 0);
  out.write_shift(1, 0);
  return out;
}
function write_BIFF2BERR(r, c, val, t) {
  var out = new_buf(9);
  write_BIFF2Cell(out, r, c);
  write_Bes(val, t || "b", out);
  return out;
}
function write_BIFF2LABEL(r, c, val) {
  var out = new_buf(8 + 2 * val.length);
  write_BIFF2Cell(out, r, c);
  out.write_shift(1, val.length);
  out.write_shift(val.length, val, "sbcs");
  return out.l < out.length ? out.slice(0, out.l) : out;
}
function write_ws_biff2_cell(ba, cell, R, C) {
  if (cell.v != null) switch (cell.t) {
    case "d":
    case "n":
      var v = cell.t == "d" ? datenum(parseDate(cell.v)) : cell.v;
      if (v == (v | 0) && v >= 0 && v < 65536) write_biff_rec(ba, 2, write_BIFF2INT(R, C, v));
      else write_biff_rec(ba, 3, write_BIFF2NUM(R, C, v));
      return;
    case "b":
    case "e":
      write_biff_rec(ba, 5, write_BIFF2BERR(R, C, cell.v, cell.t));
      return;
    /* TODO: codepage, sst */
    case "s":
    case "str":
      write_biff_rec(ba, 4, write_BIFF2LABEL(R, C, (cell.v || "").slice(0, 255)));
      return;
  }
  write_biff_rec(ba, 1, write_BIFF2Cell(null, R, C));
}
function write_ws_biff2(ba, ws, idx, opts) {
  var dense = Array.isArray(ws);
  var range = safe_decode_range(ws["!ref"] || "A1"), ref, rr = "", cols = [];
  if (range.e.c > 255 || range.e.r > 16383) {
    if (opts.WTF) throw new Error("Range " + (ws["!ref"] || "A1") + " exceeds format limit A1:IV16384");
    range.e.c = Math.min(range.e.c, 255);
    range.e.r = Math.min(range.e.c, 16383);
    ref = encode_range(range);
  }
  for (var R = range.s.r; R <= range.e.r; ++R) {
    rr = encode_row(R);
    for (var C = range.s.c; C <= range.e.c; ++C) {
      if (R === range.s.r) cols[C] = encode_col(C);
      ref = cols[C] + rr;
      var cell = dense ? (ws[R] || [])[C] : ws[ref];
      if (!cell) continue;
      write_ws_biff2_cell(ba, cell, R, C, opts);
    }
  }
}
function write_biff2_buf(wb, opts) {
  var o = opts || {};
  if (DENSE != null && o.dense == null) o.dense = DENSE;
  var ba = buf_array();
  var idx = 0;
  for (var i = 0; i < wb.SheetNames.length; ++i) if (wb.SheetNames[i] == o.sheet) idx = i;
  if (idx == 0 && !!o.sheet && wb.SheetNames[0] != o.sheet) throw new Error("Sheet not found: " + o.sheet);
  write_biff_rec(ba, o.biff == 4 ? 1033 : o.biff == 3 ? 521 : 9, write_BOF(wb, 16, o));
  write_ws_biff2(ba, wb.Sheets[wb.SheetNames[idx]], idx, o, wb);
  write_biff_rec(ba, 10);
  return ba.end();
}
function write_FONTS_biff8(ba, data, opts) {
  write_biff_rec(ba, 49, write_Font({
    sz: 12,
    color: {
      theme: 1
    },
    name: "Arial",
    family: 2,
    scheme: "minor"
  }, opts));
}
function write_FMTS_biff8(ba, NF, opts) {
  if (!NF) return;
  [[5, 8], [23, 26], [41, 44], [
    /*63*/
    50,
    /*66],[164,*/
    392
  ]].forEach(function(r) {
    for (var i = r[0]; i <= r[1]; ++i) if (NF[i] != null) write_biff_rec(ba, 1054, write_Format(i, NF[i], opts));
  });
}
function write_FEAT(ba, ws) {
  var o = new_buf(19);
  o.write_shift(4, 2151);
  o.write_shift(4, 0);
  o.write_shift(4, 0);
  o.write_shift(2, 3);
  o.write_shift(1, 1);
  o.write_shift(4, 0);
  write_biff_rec(ba, 2151, o);
  o = new_buf(39);
  o.write_shift(4, 2152);
  o.write_shift(4, 0);
  o.write_shift(4, 0);
  o.write_shift(2, 3);
  o.write_shift(1, 0);
  o.write_shift(4, 0);
  o.write_shift(2, 1);
  o.write_shift(4, 4);
  o.write_shift(2, 0);
  write_Ref8U(safe_decode_range(ws["!ref"] || "A1"), o);
  o.write_shift(4, 4);
  write_biff_rec(ba, 2152, o);
}
function write_CELLXFS_biff8(ba, opts) {
  for (var i = 0; i < 16; ++i) write_biff_rec(ba, 224, write_XF({
    numFmtId: 0,
    style: true
  }, 0, opts));
  opts.cellXfs.forEach(function(c) {
    write_biff_rec(ba, 224, write_XF(c, 0, opts));
  });
}
function write_ws_biff8_hlinks(ba, ws) {
  for (var R = 0; R < ws["!links"].length; ++R) {
    var HL = ws["!links"][R];
    write_biff_rec(ba, 440, write_HLink(HL));
    if (HL[1].Tooltip) write_biff_rec(ba, 2048, write_HLinkTooltip(HL));
  }
  delete ws["!links"];
}
function write_ws_cols_biff8(ba, cols) {
  if (!cols) return;
  var cnt = 0;
  cols.forEach(function(col, idx) {
    if (++cnt <= 256 && col) {
      write_biff_rec(ba, 125, write_ColInfo(col_obj_w(idx, col), idx));
    }
  });
}
function write_ws_biff8_cell(ba, cell, R, C, opts) {
  var os = 16 + get_cell_style(opts.cellXfs, cell, opts);
  if (cell.v == null && !cell.bf) {
    write_biff_rec(ba, 513, write_XLSCell(R, C, os));
    return;
  }
  if (cell.bf) write_biff_rec(ba, 6, write_Formula(cell, R, C, opts, os));
  else switch (cell.t) {
    case "d":
    case "n":
      var v = cell.t == "d" ? datenum(parseDate(cell.v)) : cell.v;
      write_biff_rec(ba, 515, write_Number(R, C, v, os, opts));
      break;
    case "b":
    case "e":
      write_biff_rec(ba, 517, write_BoolErr(R, C, cell.v, os, opts, cell.t));
      break;
    /* TODO: codepage, sst */
    case "s":
    case "str":
      if (opts.bookSST) {
        var isst = get_sst_id(opts.Strings, cell.v, opts.revStrings);
        write_biff_rec(ba, 253, write_LabelSst(R, C, isst, os, opts));
      } else write_biff_rec(ba, 516, write_Label(R, C, (cell.v || "").slice(0, 255), os, opts));
      break;
    default:
      write_biff_rec(ba, 513, write_XLSCell(R, C, os));
  }
}
function write_ws_biff8(idx, opts, wb) {
  var ba = buf_array();
  var s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};
  var _WB = (wb || {}).Workbook || {};
  var _sheet = (_WB.Sheets || [])[idx] || {};
  var dense = Array.isArray(ws);
  var b8 = opts.biff == 8;
  var ref, rr = "", cols = [];
  var range = safe_decode_range(ws["!ref"] || "A1");
  var MAX_ROWS = b8 ? 65536 : 16384;
  if (range.e.c > 255 || range.e.r >= MAX_ROWS) {
    if (opts.WTF) throw new Error("Range " + (ws["!ref"] || "A1") + " exceeds format limit A1:IV16384");
    range.e.c = Math.min(range.e.c, 255);
    range.e.r = Math.min(range.e.c, MAX_ROWS - 1);
  }
  write_biff_rec(ba, 2057, write_BOF(wb, 16, opts));
  write_biff_rec(ba, 13, writeuint16(1));
  write_biff_rec(ba, 12, writeuint16(100));
  write_biff_rec(ba, 15, writebool(true));
  write_biff_rec(ba, 17, writebool(false));
  write_biff_rec(ba, 16, write_Xnum(1e-3));
  write_biff_rec(ba, 95, writebool(true));
  write_biff_rec(ba, 42, writebool(false));
  write_biff_rec(ba, 43, writebool(false));
  write_biff_rec(ba, 130, writeuint16(1));
  write_biff_rec(ba, 128, write_Guts([0, 0]));
  write_biff_rec(ba, 131, writebool(false));
  write_biff_rec(ba, 132, writebool(false));
  if (b8) write_ws_cols_biff8(ba, ws["!cols"]);
  write_biff_rec(ba, 512, write_Dimensions(range, opts));
  if (b8) ws["!links"] = [];
  for (var R = range.s.r; R <= range.e.r; ++R) {
    rr = encode_row(R);
    for (var C = range.s.c; C <= range.e.c; ++C) {
      if (R === range.s.r) cols[C] = encode_col(C);
      ref = cols[C] + rr;
      var cell = dense ? (ws[R] || [])[C] : ws[ref];
      if (!cell) continue;
      write_ws_biff8_cell(ba, cell, R, C, opts);
      if (b8 && cell.l) ws["!links"].push([ref, cell.l]);
    }
  }
  var cname = _sheet.CodeName || _sheet.name || s;
  if (b8) write_biff_rec(ba, 574, write_Window2((_WB.Views || [])[0]));
  if (b8 && (ws["!merges"] || []).length) write_biff_rec(ba, 229, write_MergeCells(ws["!merges"]));
  if (b8) write_ws_biff8_hlinks(ba, ws);
  write_biff_rec(ba, 442, write_XLUnicodeString(cname, opts));
  if (b8) write_FEAT(ba, ws);
  write_biff_rec(
    ba,
    10
    /* EOF */
  );
  return ba.end();
}
function write_biff8_global(wb, bufs, opts) {
  var A = buf_array();
  var _WB = (wb || {}).Workbook || {};
  var _sheets = _WB.Sheets || [];
  var _wb = (
    /*::((*/
    _WB.WBProps || {
      /*::CodeName:"ThisWorkbook"*/
    }
  );
  var b8 = opts.biff == 8, b5 = opts.biff == 5;
  write_biff_rec(A, 2057, write_BOF(wb, 5, opts));
  if (opts.bookType == "xla") write_biff_rec(
    A,
    135
    /* Addin */
  );
  write_biff_rec(A, 225, b8 ? writeuint16(1200) : null);
  write_biff_rec(A, 193, writezeroes(2));
  if (b5) write_biff_rec(
    A,
    191
    /* ToolbarHdr */
  );
  if (b5) write_biff_rec(
    A,
    192
    /* ToolbarEnd */
  );
  write_biff_rec(
    A,
    226
    /* InterfaceEnd */
  );
  write_biff_rec(A, 92, write_WriteAccess("SheetJS", opts));
  write_biff_rec(A, 66, writeuint16(b8 ? 1200 : 1252));
  if (b8) write_biff_rec(A, 353, writeuint16(0));
  if (b8) write_biff_rec(
    A,
    448
    /* Excel9File */
  );
  write_biff_rec(A, 317, write_RRTabId(wb.SheetNames.length));
  if (b8 && wb.vbaraw) write_biff_rec(
    A,
    211
    /* ObProj */
  );
  if (b8 && wb.vbaraw) {
    var cname = _wb.CodeName || "ThisWorkbook";
    write_biff_rec(A, 442, write_XLUnicodeString(cname, opts));
  }
  write_biff_rec(A, 156, writeuint16(17));
  write_biff_rec(A, 25, writebool(false));
  write_biff_rec(A, 18, writebool(false));
  write_biff_rec(A, 19, writeuint16(0));
  if (b8) write_biff_rec(A, 431, writebool(false));
  if (b8) write_biff_rec(A, 444, writeuint16(0));
  write_biff_rec(A, 61, write_Window1(opts));
  write_biff_rec(A, 64, writebool(false));
  write_biff_rec(A, 141, writeuint16(0));
  write_biff_rec(A, 34, writebool(safe1904(wb) == "true"));
  write_biff_rec(A, 14, writebool(true));
  if (b8) write_biff_rec(A, 439, writebool(false));
  write_biff_rec(A, 218, writeuint16(0));
  write_FONTS_biff8(A, wb, opts);
  write_FMTS_biff8(A, wb.SSF, opts);
  write_CELLXFS_biff8(A, opts);
  if (b8) write_biff_rec(A, 352, writebool(false));
  var a = A.end();
  var C = buf_array();
  if (b8) write_biff_rec(C, 140, write_Country());
  if (b8 && opts.Strings) write_biff_continue(C, 252, write_SST(opts.Strings, opts));
  write_biff_rec(
    C,
    10
    /* EOF */
  );
  var c = C.end();
  var B = buf_array();
  var blen = 0, j = 0;
  for (j = 0; j < wb.SheetNames.length; ++j) blen += (b8 ? 12 : 11) + (b8 ? 2 : 1) * wb.SheetNames[j].length;
  var start = a.length + blen + c.length;
  for (j = 0; j < wb.SheetNames.length; ++j) {
    var _sheet = _sheets[j] || {};
    write_biff_rec(B, 133, write_BoundSheet8({
      pos: start,
      hs: _sheet.Hidden || 0,
      dt: 0,
      name: wb.SheetNames[j]
    }, opts));
    start += bufs[j].length;
  }
  var b = B.end();
  if (blen != b.length) throw new Error("BS8 " + blen + " != " + b.length);
  var out = [];
  if (a.length) out.push(a);
  if (b.length) out.push(b);
  if (c.length) out.push(c);
  return bconcat(out);
}
function write_biff8_buf(wb, opts) {
  var o = opts || {};
  var bufs = [];
  if (wb && !wb.SSF) {
    wb.SSF = dup(table_fmt);
  }
  if (wb && wb.SSF) {
    make_ssf();
    SSF_load_table(wb.SSF);
    o.revssf = evert_num(wb.SSF);
    o.revssf[wb.SSF[65535]] = 0;
    o.ssf = wb.SSF;
  }
  o.Strings = /*::((*/
  [];
  o.Strings.Count = 0;
  o.Strings.Unique = 0;
  fix_write_opts(o);
  o.cellXfs = [];
  get_cell_style(o.cellXfs, {}, {
    revssf: {
      "General": 0
    }
  });
  if (!wb.Props) wb.Props = {};
  for (var i = 0; i < wb.SheetNames.length; ++i) bufs[bufs.length] = write_ws_biff8(i, o, wb);
  bufs.unshift(write_biff8_global(wb, bufs, o));
  return bconcat(bufs);
}
function write_biff_buf(wb, opts) {
  for (var i = 0; i <= wb.SheetNames.length; ++i) {
    var ws = wb.Sheets[wb.SheetNames[i]];
    if (!ws || !ws["!ref"]) continue;
    var range = decode_range(ws["!ref"]);
    if (range.e.c > 255) {
      if (typeof console != "undefined" && console.error) console.error("Worksheet '" + wb.SheetNames[i] + "' extends beyond column IV (255).  Data may be lost.");
    }
  }
  var o = opts || {};
  switch (o.biff || 2) {
    case 8:
    case 5:
      return write_biff8_buf(wb, opts);
    case 4:
    case 3:
    case 2:
      return write_biff2_buf(wb, opts);
  }
  throw new Error("invalid type " + o.bookType + " for BIFF");
}
function make_html_row(ws, r, R, o) {
  var M = ws["!merges"] || [];
  var oo = [];
  for (var C = r.s.c; C <= r.e.c; ++C) {
    var RS = 0, CS = 0;
    for (var j = 0; j < M.length; ++j) {
      if (M[j].s.r > R || M[j].s.c > C) continue;
      if (M[j].e.r < R || M[j].e.c < C) continue;
      if (M[j].s.r < R || M[j].s.c < C) {
        RS = -1;
        break;
      }
      RS = M[j].e.r - M[j].s.r + 1;
      CS = M[j].e.c - M[j].s.c + 1;
      break;
    }
    if (RS < 0) continue;
    var coord = encode_cell({
      r: R,
      c: C
    });
    var cell = o.dense ? (ws[R] || [])[C] : ws[coord];
    var w = cell && cell.v != null && (cell.h || escapehtml(cell.w || (format_cell(cell), cell.w) || "")) || "";
    var sp = {};
    if (RS > 1) sp.rowspan = RS;
    if (CS > 1) sp.colspan = CS;
    if (o.editable) w = '<span contenteditable="true">' + w + "</span>";
    else if (cell) {
      sp["data-t"] = cell && cell.t || "z";
      if (cell.v != null) sp["data-v"] = cell.v;
      if (cell.z != null) sp["data-z"] = cell.z;
      if (cell.l && (cell.l.Target || "#").charAt(0) != "#") w = '<a href="' + cell.l.Target + '">' + w + "</a>";
    }
    sp.id = (o.id || "sjs") + "-" + coord;
    oo.push(writextag("td", w, sp));
  }
  var preamble = "<tr>";
  return preamble + oo.join("") + "</tr>";
}
var HTML_BEGIN = '<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>';
var HTML_END = "</body></html>";
function make_html_preamble(ws, R, o) {
  var out = [];
  return out.join("") + "<table" + (o && o.id ? ' id="' + o.id + '"' : "") + ">";
}
function sheet_to_html(ws, opts) {
  var o = opts || {};
  var header = o.header != null ? o.header : HTML_BEGIN;
  var footer = o.footer != null ? o.footer : HTML_END;
  var out = [header];
  var r = decode_range(ws["!ref"]);
  o.dense = Array.isArray(ws);
  out.push(make_html_preamble(ws, r, o));
  for (var R = r.s.r; R <= r.e.r; ++R) out.push(make_html_row(ws, r, R, o));
  out.push("</table>" + footer);
  return out.join("");
}
function sheet_add_dom(ws, table, _opts) {
  var opts = _opts || {};
  if (DENSE != null) opts.dense = DENSE;
  var or_R = 0, or_C = 0;
  if (opts.origin != null) {
    if (typeof opts.origin == "number") or_R = opts.origin;
    else {
      var _origin = typeof opts.origin == "string" ? decode_cell(opts.origin) : opts.origin;
      or_R = _origin.r;
      or_C = _origin.c;
    }
  }
  var rows = table.getElementsByTagName("tr");
  var sheetRows = Math.min(opts.sheetRows || 1e7, rows.length);
  var range = {
    s: {
      r: 0,
      c: 0
    },
    e: {
      r: or_R,
      c: or_C
    }
  };
  if (ws["!ref"]) {
    var _range = decode_range(ws["!ref"]);
    range.s.r = Math.min(range.s.r, _range.s.r);
    range.s.c = Math.min(range.s.c, _range.s.c);
    range.e.r = Math.max(range.e.r, _range.e.r);
    range.e.c = Math.max(range.e.c, _range.e.c);
    if (or_R == -1) range.e.r = or_R = _range.e.r + 1;
  }
  var merges = [], midx = 0;
  var rowinfo = ws["!rows"] || (ws["!rows"] = []);
  var _R = 0, R = 0, _C = 0, C = 0, RS = 0, CS = 0;
  if (!ws["!cols"]) ws["!cols"] = [];
  for (; _R < rows.length && R < sheetRows; ++_R) {
    var row = rows[_R];
    if (is_dom_element_hidden(row)) {
      if (opts.display) continue;
      rowinfo[R] = {
        hidden: true
      };
    }
    var elts = row.children;
    for (_C = C = 0; _C < elts.length; ++_C) {
      var elt = elts[_C];
      if (opts.display && is_dom_element_hidden(elt)) continue;
      var v = elt.hasAttribute("data-v") ? elt.getAttribute("data-v") : elt.hasAttribute("v") ? elt.getAttribute("v") : htmldecode(elt.innerHTML);
      var z = elt.getAttribute("data-z") || elt.getAttribute("z");
      for (midx = 0; midx < merges.length; ++midx) {
        var m = merges[midx];
        if (m.s.c == C + or_C && m.s.r < R + or_R && R + or_R <= m.e.r) {
          C = m.e.c + 1 - or_C;
          midx = -1;
        }
      }
      CS = +elt.getAttribute("colspan") || 1;
      if ((RS = +elt.getAttribute("rowspan") || 1) > 1 || CS > 1) merges.push({
        s: {
          r: R + or_R,
          c: C + or_C
        },
        e: {
          r: R + or_R + (RS || 1) - 1,
          c: C + or_C + (CS || 1) - 1
        }
      });
      var o = {
        t: "s",
        v
      };
      var _t = elt.getAttribute("data-t") || elt.getAttribute("t") || "";
      if (v != null) {
        if (v.length == 0) o.t = _t || "z";
        else if (opts.raw || v.trim().length == 0 || _t == "s") {
        } else if (v === "TRUE") o = {
          t: "b",
          v: true
        };
        else if (v === "FALSE") o = {
          t: "b",
          v: false
        };
        else if (!isNaN(fuzzynum(v))) o = {
          t: "n",
          v: fuzzynum(v)
        };
        else if (!isNaN(fuzzydate(v).getDate())) {
          o = {
            t: "d",
            v: parseDate(v)
          };
          if (!opts.cellDates) o = {
            t: "n",
            v: datenum(o.v)
          };
          o.z = opts.dateNF || table_fmt[14];
        }
      }
      if (o.z === void 0 && z != null) o.z = z;
      var l = "", Aelts = elt.getElementsByTagName("A");
      if (Aelts && Aelts.length) {
        for (var Aelti = 0; Aelti < Aelts.length; ++Aelti) if (Aelts[Aelti].hasAttribute("href")) {
          l = Aelts[Aelti].getAttribute("href");
          if (l.charAt(0) != "#") break;
        }
      }
      if (l && l.charAt(0) != "#") o.l = {
        Target: l
      };
      if (opts.dense) {
        if (!ws[R + or_R]) ws[R + or_R] = [];
        ws[R + or_R][C + or_C] = o;
      } else ws[encode_cell({
        c: C + or_C,
        r: R + or_R
      })] = o;
      if (range.e.c < C + or_C) range.e.c = C + or_C;
      C += CS;
    }
    ++R;
  }
  if (merges.length) ws["!merges"] = (ws["!merges"] || []).concat(merges);
  range.e.r = Math.max(range.e.r, R - 1 + or_R);
  ws["!ref"] = encode_range(range);
  if (R >= sheetRows) ws["!fullref"] = encode_range((range.e.r = rows.length - _R + R - 1 + or_R, range));
  return ws;
}
function parse_dom_table(table, _opts) {
  var opts = _opts || {};
  var ws = opts.dense ? [] : {};
  return sheet_add_dom(ws, table, _opts);
}
function table_to_book(table, opts) {
  return sheet_to_workbook(parse_dom_table(table, opts), opts);
}
function is_dom_element_hidden(element) {
  var display = "";
  var get_computed_style = get_get_computed_style_function(element);
  if (get_computed_style) display = get_computed_style(element).getPropertyValue("display");
  if (!display) display = element.style && element.style.display;
  return display === "none";
}
function get_get_computed_style_function(element) {
  if (element.ownerDocument.defaultView && typeof element.ownerDocument.defaultView.getComputedStyle === "function") return element.ownerDocument.defaultView.getComputedStyle;
  if (typeof getComputedStyle === "function") return getComputedStyle;
  return null;
}
var write_styles_ods = /* @__PURE__ */ function() {
  var master_styles = ["<office:master-styles>", '<style:master-page style:name="mp1" style:page-layout-name="mp1">', "<style:header/>", '<style:header-left style:display="false"/>', "<style:footer/>", '<style:footer-left style:display="false"/>', "</style:master-page>", "</office:master-styles>"].join("");
  var payload = "<office:document-styles " + wxt_helper({
    "xmlns:office": "urn:oasis:names:tc:opendocument:xmlns:office:1.0",
    "xmlns:table": "urn:oasis:names:tc:opendocument:xmlns:table:1.0",
    "xmlns:style": "urn:oasis:names:tc:opendocument:xmlns:style:1.0",
    "xmlns:text": "urn:oasis:names:tc:opendocument:xmlns:text:1.0",
    "xmlns:draw": "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",
    "xmlns:fo": "urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",
    "xmlns:xlink": "http://www.w3.org/1999/xlink",
    "xmlns:dc": "http://purl.org/dc/elements/1.1/",
    "xmlns:number": "urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",
    "xmlns:svg": "urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",
    "xmlns:of": "urn:oasis:names:tc:opendocument:xmlns:of:1.2",
    "office:version": "1.2"
  }) + ">" + master_styles + "</office:document-styles>";
  return function wso() {
    return XML_HEADER + payload;
  };
}();
var write_content_ods = /* @__PURE__ */ function() {
  var write_text_p = function(text) {
    return escapexml(text).replace(/  +/g, function($$) {
      return '<text:s text:c="' + $$.length + '"/>';
    }).replace(/\t/g, "<text:tab/>").replace(/\n/g, "</text:p><text:p>").replace(/^ /, "<text:s/>").replace(/ $/, "<text:s/>");
  };
  var null_cell_xml = "          <table:table-cell />\n";
  var covered_cell_xml = "          <table:covered-table-cell/>\n";
  var write_ws2 = function(ws, wb, i) {
    var o = [];
    o.push('      <table:table table:name="' + escapexml(wb.SheetNames[i]) + '" table:style-name="ta1">\n');
    var R = 0, C = 0, range = decode_range(ws["!ref"] || "A1");
    var marr = ws["!merges"] || [], mi = 0;
    var dense = Array.isArray(ws);
    if (ws["!cols"]) {
      for (C = 0; C <= range.e.c; ++C) o.push("        <table:table-column" + (ws["!cols"][C] ? ' table:style-name="co' + ws["!cols"][C].ods + '"' : "") + "></table:table-column>\n");
    }
    var H = "", ROWS = ws["!rows"] || [];
    for (R = 0; R < range.s.r; ++R) {
      H = ROWS[R] ? ' table:style-name="ro' + ROWS[R].ods + '"' : "";
      o.push("        <table:table-row" + H + "></table:table-row>\n");
    }
    for (; R <= range.e.r; ++R) {
      H = ROWS[R] ? ' table:style-name="ro' + ROWS[R].ods + '"' : "";
      o.push("        <table:table-row" + H + ">\n");
      for (C = 0; C < range.s.c; ++C) o.push(null_cell_xml);
      for (; C <= range.e.c; ++C) {
        var skip = false, ct = {}, textp = "";
        for (mi = 0; mi != marr.length; ++mi) {
          if (marr[mi].s.c > C) continue;
          if (marr[mi].s.r > R) continue;
          if (marr[mi].e.c < C) continue;
          if (marr[mi].e.r < R) continue;
          if (marr[mi].s.c != C || marr[mi].s.r != R) skip = true;
          ct["table:number-columns-spanned"] = marr[mi].e.c - marr[mi].s.c + 1;
          ct["table:number-rows-spanned"] = marr[mi].e.r - marr[mi].s.r + 1;
          break;
        }
        if (skip) {
          o.push(covered_cell_xml);
          continue;
        }
        var ref = encode_cell({
          r: R,
          c: C
        }), cell = dense ? (ws[R] || [])[C] : ws[ref];
        if (cell && cell.f) {
          ct["table:formula"] = escapexml(csf_to_ods_formula(cell.f));
          if (cell.F) {
            if (cell.F.slice(0, ref.length) == ref) {
              var _Fref = decode_range(cell.F);
              ct["table:number-matrix-columns-spanned"] = _Fref.e.c - _Fref.s.c + 1;
              ct["table:number-matrix-rows-spanned"] = _Fref.e.r - _Fref.s.r + 1;
            }
          }
        }
        if (!cell) {
          o.push(null_cell_xml);
          continue;
        }
        switch (cell.t) {
          case "b":
            textp = cell.v ? "TRUE" : "FALSE";
            ct["office:value-type"] = "boolean";
            ct["office:boolean-value"] = cell.v ? "true" : "false";
            break;
          case "n":
            textp = cell.w || String(cell.v || 0);
            ct["office:value-type"] = "float";
            ct["office:value"] = cell.v || 0;
            break;
          case "s":
          case "str":
            textp = cell.v == null ? "" : cell.v;
            ct["office:value-type"] = "string";
            break;
          case "d":
            textp = cell.w || parseDate(cell.v).toISOString();
            ct["office:value-type"] = "date";
            ct["office:date-value"] = parseDate(cell.v).toISOString();
            ct["table:style-name"] = "ce1";
            break;
          //case 'e':
          default:
            o.push(null_cell_xml);
            continue;
        }
        var text_p = write_text_p(textp);
        if (cell.l && cell.l.Target) {
          var _tgt = cell.l.Target;
          _tgt = _tgt.charAt(0) == "#" ? "#" + csf_to_ods_3D(_tgt.slice(1)) : _tgt;
          if (_tgt.charAt(0) != "#" && !_tgt.match(/^\w+:/)) _tgt = "../" + _tgt;
          text_p = writextag("text:a", text_p, {
            "xlink:href": _tgt.replace(/&/g, "&amp;")
          });
        }
        o.push("          " + writextag("table:table-cell", writextag("text:p", text_p, {}), ct) + "\n");
      }
      o.push("        </table:table-row>\n");
    }
    o.push("      </table:table>\n");
    return o.join("");
  };
  var write_automatic_styles_ods = function(o, wb) {
    o.push(" <office:automatic-styles>\n");
    o.push('  <number:date-style style:name="N37" number:automatic-order="true">\n');
    o.push('   <number:month number:style="long"/>\n');
    o.push("   <number:text>/</number:text>\n");
    o.push('   <number:day number:style="long"/>\n');
    o.push("   <number:text>/</number:text>\n");
    o.push("   <number:year/>\n");
    o.push("  </number:date-style>\n");
    var cidx = 0;
    wb.SheetNames.map(function(n) {
      return wb.Sheets[n];
    }).forEach(function(ws) {
      if (!ws) return;
      if (ws["!cols"]) {
        for (var C = 0; C < ws["!cols"].length; ++C) if (ws["!cols"][C]) {
          var colobj = ws["!cols"][C];
          if (colobj.width == null && colobj.wpx == null && colobj.wch == null) continue;
          process_col(colobj);
          colobj.ods = cidx;
          var w = ws["!cols"][C].wpx + "px";
          o.push('  <style:style style:name="co' + cidx + '" style:family="table-column">\n');
          o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="' + w + '"/>\n');
          o.push("  </style:style>\n");
          ++cidx;
        }
      }
    });
    var ridx = 0;
    wb.SheetNames.map(function(n) {
      return wb.Sheets[n];
    }).forEach(function(ws) {
      if (!ws) return;
      if (ws["!rows"]) {
        for (var R = 0; R < ws["!rows"].length; ++R) if (ws["!rows"][R]) {
          ws["!rows"][R].ods = ridx;
          var h = ws["!rows"][R].hpx + "px";
          o.push('  <style:style style:name="ro' + ridx + '" style:family="table-row">\n');
          o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="' + h + '"/>\n');
          o.push("  </style:style>\n");
          ++ridx;
        }
      }
    });
    o.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n');
    o.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n');
    o.push("  </style:style>\n");
    o.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n');
    o.push(" </office:automatic-styles>\n");
  };
  return function wcx(wb, opts) {
    var o = [XML_HEADER];
    var attr = wxt_helper({
      "xmlns:office": "urn:oasis:names:tc:opendocument:xmlns:office:1.0",
      "xmlns:table": "urn:oasis:names:tc:opendocument:xmlns:table:1.0",
      "xmlns:style": "urn:oasis:names:tc:opendocument:xmlns:style:1.0",
      "xmlns:text": "urn:oasis:names:tc:opendocument:xmlns:text:1.0",
      "xmlns:draw": "urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",
      "xmlns:fo": "urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",
      "xmlns:xlink": "http://www.w3.org/1999/xlink",
      "xmlns:dc": "http://purl.org/dc/elements/1.1/",
      "xmlns:meta": "urn:oasis:names:tc:opendocument:xmlns:meta:1.0",
      "xmlns:number": "urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",
      "xmlns:presentation": "urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",
      "xmlns:svg": "urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",
      "xmlns:chart": "urn:oasis:names:tc:opendocument:xmlns:chart:1.0",
      "xmlns:dr3d": "urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",
      "xmlns:math": "http://www.w3.org/1998/Math/MathML",
      "xmlns:form": "urn:oasis:names:tc:opendocument:xmlns:form:1.0",
      "xmlns:script": "urn:oasis:names:tc:opendocument:xmlns:script:1.0",
      "xmlns:ooo": "http://openoffice.org/2004/office",
      "xmlns:ooow": "http://openoffice.org/2004/writer",
      "xmlns:oooc": "http://openoffice.org/2004/calc",
      "xmlns:dom": "http://www.w3.org/2001/xml-events",
      "xmlns:xforms": "http://www.w3.org/2002/xforms",
      "xmlns:xsd": "http://www.w3.org/2001/XMLSchema",
      "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
      "xmlns:sheet": "urn:oasis:names:tc:opendocument:sh33tjs:1.0",
      "xmlns:rpt": "http://openoffice.org/2005/report",
      "xmlns:of": "urn:oasis:names:tc:opendocument:xmlns:of:1.2",
      "xmlns:xhtml": "http://www.w3.org/1999/xhtml",
      "xmlns:grddl": "http://www.w3.org/2003/g/data-view#",
      "xmlns:tableooo": "http://openoffice.org/2009/table",
      "xmlns:drawooo": "http://openoffice.org/2010/draw",
      "xmlns:calcext": "urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0",
      "xmlns:loext": "urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0",
      "xmlns:field": "urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0",
      "xmlns:formx": "urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0",
      "xmlns:css3t": "http://www.w3.org/TR/css3-text/",
      "office:version": "1.2"
    });
    var fods = wxt_helper({
      "xmlns:config": "urn:oasis:names:tc:opendocument:xmlns:config:1.0",
      "office:mimetype": "application/vnd.oasis.opendocument.spreadsheet"
    });
    if (opts.bookType == "fods") {
      o.push("<office:document" + attr + fods + ">\n");
      o.push(write_meta_ods().replace(/office:document-meta/g, "office:meta"));
    } else o.push("<office:document-content" + attr + ">\n");
    write_automatic_styles_ods(o, wb);
    o.push("  <office:body>\n");
    o.push("    <office:spreadsheet>\n");
    for (var i = 0; i != wb.SheetNames.length; ++i) o.push(write_ws2(wb.Sheets[wb.SheetNames[i]], wb, i, opts));
    o.push("    </office:spreadsheet>\n");
    o.push("  </office:body>\n");
    if (opts.bookType == "fods") o.push("</office:document>");
    else o.push("</office:document-content>");
    return o.join("");
  };
}();
function write_ods(wb, opts) {
  if (opts.bookType == "fods") return write_content_ods(wb, opts);
  var zip = zip_new();
  var f = "";
  var manifest = [];
  var rdf = [];
  f = "mimetype";
  zip_add_file(zip, f, "application/vnd.oasis.opendocument.spreadsheet");
  f = "content.xml";
  zip_add_file(zip, f, write_content_ods(wb, opts));
  manifest.push([f, "text/xml"]);
  rdf.push([f, "ContentFile"]);
  f = "styles.xml";
  zip_add_file(zip, f, write_styles_ods(wb, opts));
  manifest.push([f, "text/xml"]);
  rdf.push([f, "StylesFile"]);
  f = "meta.xml";
  zip_add_file(zip, f, XML_HEADER + write_meta_ods(
    /*::wb, opts*/
  ));
  manifest.push([f, "text/xml"]);
  rdf.push([f, "MetadataFile"]);
  f = "manifest.rdf";
  zip_add_file(zip, f, write_rdf(
    rdf
    /*, opts*/
  ));
  manifest.push([f, "application/rdf+xml"]);
  f = "META-INF/manifest.xml";
  zip_add_file(zip, f, write_manifest(
    manifest
    /*, opts*/
  ));
  return zip;
}
function u8_to_dataview(array) {
  return new DataView(array.buffer, array.byteOffset, array.byteLength);
}
function stru8(str) {
  return typeof TextEncoder != "undefined" ? new TextEncoder().encode(str) : s2a(utf8write(str));
}
function u8contains(body, search) {
  outer: for (var L = 0; L <= body.length - search.length; ++L) {
    for (var j = 0; j < search.length; ++j) if (body[L + j] != search[j]) continue outer;
    return true;
  }
  return false;
}
function u8concat(u8a) {
  var len = u8a.reduce(function(acc, x) {
    return acc + x.length;
  }, 0);
  var out = new Uint8Array(len);
  var off = 0;
  u8a.forEach(function(u8) {
    out.set(u8, off);
    off += u8.length;
  });
  return out;
}
function writeDecimal128LE(buf, offset, value) {
  var exp = Math.floor(value == 0 ? 0 : Math.LOG10E * Math.log(Math.abs(value))) + 6176 - 20;
  var mantissa = value / Math.pow(10, exp - 6176);
  buf[offset + 15] |= exp >> 7;
  buf[offset + 14] |= (exp & 127) << 1;
  for (var i = 0; mantissa >= 1; ++i, mantissa /= 256) buf[offset + i] = mantissa & 255;
  buf[offset + 15] |= value >= 0 ? 0 : 128;
}
function parse_varint49(buf, ptr) {
  var l = ptr ? ptr[0] : 0;
  var usz = buf[l] & 127;
  varint: if (buf[l++] >= 128) {
    usz |= (buf[l] & 127) << 7;
    if (buf[l++] < 128) break varint;
    usz |= (buf[l] & 127) << 14;
    if (buf[l++] < 128) break varint;
    usz |= (buf[l] & 127) << 21;
    if (buf[l++] < 128) break varint;
    usz += (buf[l] & 127) * Math.pow(2, 28);
    ++l;
    if (buf[l++] < 128) break varint;
    usz += (buf[l] & 127) * Math.pow(2, 35);
    ++l;
    if (buf[l++] < 128) break varint;
    usz += (buf[l] & 127) * Math.pow(2, 42);
    ++l;
    if (buf[l++] < 128) break varint;
  }
  if (ptr) ptr[0] = l;
  return usz;
}
function write_varint49(v) {
  var usz = new Uint8Array(7);
  usz[0] = v & 127;
  var L = 1;
  sz: if (v > 127) {
    usz[L - 1] |= 128;
    usz[L] = v >> 7 & 127;
    ++L;
    if (v <= 16383) break sz;
    usz[L - 1] |= 128;
    usz[L] = v >> 14 & 127;
    ++L;
    if (v <= 2097151) break sz;
    usz[L - 1] |= 128;
    usz[L] = v >> 21 & 127;
    ++L;
    if (v <= 268435455) break sz;
    usz[L - 1] |= 128;
    usz[L] = v / 256 >>> 21 & 127;
    ++L;
    if (v <= 34359738367) break sz;
    usz[L - 1] |= 128;
    usz[L] = v / 65536 >>> 21 & 127;
    ++L;
    if (v <= 4398046511103) break sz;
    usz[L - 1] |= 128;
    usz[L] = v / 16777216 >>> 21 & 127;
    ++L;
  }
  return usz.slice(0, L);
}
function varint_to_i32(buf) {
  var l = 0, i32 = buf[l] & 127;
  varint: if (buf[l++] >= 128) {
    i32 |= (buf[l] & 127) << 7;
    if (buf[l++] < 128) break varint;
    i32 |= (buf[l] & 127) << 14;
    if (buf[l++] < 128) break varint;
    i32 |= (buf[l] & 127) << 21;
    if (buf[l++] < 128) break varint;
    i32 |= (buf[l] & 127) << 28;
  }
  return i32;
}
function parse_shallow(buf) {
  var out = [], ptr = [0];
  while (ptr[0] < buf.length) {
    var off = ptr[0];
    var num = parse_varint49(buf, ptr);
    var type = num & 7;
    num = Math.floor(num / 8);
    var len = 0;
    var res;
    if (num == 0) break;
    switch (type) {
      case 0:
        {
          var l = ptr[0];
          while (buf[ptr[0]++] >= 128) ;
          res = buf.slice(l, ptr[0]);
        }
        break;
      case 5:
        len = 4;
        res = buf.slice(ptr[0], ptr[0] + len);
        ptr[0] += len;
        break;
      case 1:
        len = 8;
        res = buf.slice(ptr[0], ptr[0] + len);
        ptr[0] += len;
        break;
      case 2:
        len = parse_varint49(buf, ptr);
        res = buf.slice(ptr[0], ptr[0] + len);
        ptr[0] += len;
        break;
      case 3:
      case 4:
      default:
        throw new Error("PB Type ".concat(type, " for Field ").concat(num, " at offset ").concat(off));
    }
    var v = {
      data: res,
      type
    };
    if (out[num] == null) out[num] = [v];
    else out[num].push(v);
  }
  return out;
}
function write_shallow(proto) {
  var out = [];
  proto.forEach(function(field, idx) {
    field.forEach(function(item) {
      if (!item.data) return;
      out.push(write_varint49(idx * 8 + item.type));
      if (item.type == 2) out.push(write_varint49(item.data.length));
      out.push(item.data);
    });
  });
  return u8concat(out);
}
function parse_iwa_file(buf) {
  var _a;
  var out = [], ptr = [0];
  while (ptr[0] < buf.length) {
    var len = parse_varint49(buf, ptr);
    var ai = parse_shallow(buf.slice(ptr[0], ptr[0] + len));
    ptr[0] += len;
    var res = {
      id: varint_to_i32(ai[1][0].data),
      messages: []
    };
    ai[2].forEach(function(b) {
      var mi = parse_shallow(b.data);
      var fl = varint_to_i32(mi[3][0].data);
      res.messages.push({
        meta: mi,
        data: buf.slice(ptr[0], ptr[0] + fl)
      });
      ptr[0] += fl;
    });
    if ((_a = ai[3]) == null ? void 0 : _a[0]) res.merge = varint_to_i32(ai[3][0].data) >>> 0 > 0;
    out.push(res);
  }
  return out;
}
function write_iwa_file(ias) {
  var bufs = [];
  ias.forEach(function(ia) {
    var ai = [];
    ai[1] = [{
      data: write_varint49(ia.id),
      type: 0
    }];
    ai[2] = [];
    if (ia.merge != null) ai[3] = [{
      data: write_varint49(+!!ia.merge),
      type: 0
    }];
    var midata = [];
    ia.messages.forEach(function(mi) {
      midata.push(mi.data);
      mi.meta[3] = [{
        type: 0,
        data: write_varint49(mi.data.length)
      }];
      ai[2].push({
        data: write_shallow(mi.meta),
        type: 2
      });
    });
    var aipayload = write_shallow(ai);
    bufs.push(write_varint49(aipayload.length));
    bufs.push(aipayload);
    midata.forEach(function(mid) {
      return bufs.push(mid);
    });
  });
  return u8concat(bufs);
}
function parse_snappy_chunk(type, buf) {
  if (type != 0) throw new Error("Unexpected Snappy chunk type ".concat(type));
  var ptr = [0];
  var usz = parse_varint49(buf, ptr);
  var chunks = [];
  while (ptr[0] < buf.length) {
    var tag = buf[ptr[0]] & 3;
    if (tag == 0) {
      var len = buf[ptr[0]++] >> 2;
      if (len < 60) ++len;
      else {
        var c = len - 59;
        len = buf[ptr[0]];
        if (c > 1) len |= buf[ptr[0] + 1] << 8;
        if (c > 2) len |= buf[ptr[0] + 2] << 16;
        if (c > 3) len |= buf[ptr[0] + 3] << 24;
        len >>>= 0;
        len++;
        ptr[0] += c;
      }
      chunks.push(buf.slice(ptr[0], ptr[0] + len));
      ptr[0] += len;
      continue;
    } else {
      var offset = 0, length = 0;
      if (tag == 1) {
        length = (buf[ptr[0]] >> 2 & 7) + 4;
        offset = (buf[ptr[0]++] & 224) << 3;
        offset |= buf[ptr[0]++];
      } else {
        length = (buf[ptr[0]++] >> 2) + 1;
        if (tag == 2) {
          offset = buf[ptr[0]] | buf[ptr[0] + 1] << 8;
          ptr[0] += 2;
        } else {
          offset = (buf[ptr[0]] | buf[ptr[0] + 1] << 8 | buf[ptr[0] + 2] << 16 | buf[ptr[0] + 3] << 24) >>> 0;
          ptr[0] += 4;
        }
      }
      chunks = [u8concat(chunks)];
      if (offset == 0) throw new Error("Invalid offset 0");
      if (offset > chunks[0].length) throw new Error("Invalid offset beyond length");
      if (length >= offset) {
        chunks.push(chunks[0].slice(-offset));
        length -= offset;
        while (length >= chunks[chunks.length - 1].length) {
          chunks.push(chunks[chunks.length - 1]);
          length -= chunks[chunks.length - 1].length;
        }
      }
      chunks.push(chunks[0].slice(-offset, -offset + length));
    }
  }
  var o = u8concat(chunks);
  if (o.length != usz) throw new Error("Unexpected length: ".concat(o.length, " != ").concat(usz));
  return o;
}
function decompress_iwa_file(buf) {
  var out = [];
  var l = 0;
  while (l < buf.length) {
    var t = buf[l++];
    var len = buf[l] | buf[l + 1] << 8 | buf[l + 2] << 16;
    l += 3;
    out.push(parse_snappy_chunk(t, buf.slice(l, l + len)));
    l += len;
  }
  if (l !== buf.length) throw new Error("data is not a valid framed stream!");
  return u8concat(out);
}
function compress_iwa_file(buf) {
  var out = [];
  var l = 0;
  while (l < buf.length) {
    var c = Math.min(buf.length - l, 268435455);
    var frame = new Uint8Array(4);
    out.push(frame);
    var usz = write_varint49(c);
    var L = usz.length;
    out.push(usz);
    if (c <= 60) {
      L++;
      out.push(new Uint8Array([c - 1 << 2]));
    } else if (c <= 256) {
      L += 2;
      out.push(new Uint8Array([240, c - 1 & 255]));
    } else if (c <= 65536) {
      L += 3;
      out.push(new Uint8Array([244, c - 1 & 255, c - 1 >> 8 & 255]));
    } else if (c <= 16777216) {
      L += 4;
      out.push(new Uint8Array([248, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255]));
    } else if (c <= 4294967296) {
      L += 5;
      out.push(new Uint8Array([252, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255, c - 1 >>> 24 & 255]));
    }
    out.push(buf.slice(l, l + c));
    L += c;
    frame[0] = 0;
    frame[1] = L & 255;
    frame[2] = L >> 8 & 255;
    frame[3] = L >> 16 & 255;
    l += c;
  }
  return u8concat(out);
}
function write_new_storage(cell, sst) {
  var out = new Uint8Array(32), dv = u8_to_dataview(out), l = 12, flags = 0;
  out[0] = 5;
  switch (cell.t) {
    case "n":
      out[1] = 2;
      writeDecimal128LE(out, l, cell.v);
      flags |= 1;
      l += 16;
      break;
    case "b":
      out[1] = 6;
      dv.setFloat64(l, cell.v ? 1 : 0, true);
      flags |= 2;
      l += 8;
      break;
    case "s":
      if (sst.indexOf(cell.v) == -1) throw new Error("Value ".concat(cell.v, " missing from SST!"));
      out[1] = 3;
      dv.setUint32(l, sst.indexOf(cell.v), true);
      flags |= 8;
      l += 4;
      break;
    default:
      throw "unsupported cell type " + cell.t;
  }
  dv.setUint32(8, flags, true);
  return out.slice(0, l);
}
function write_old_storage(cell, sst) {
  var out = new Uint8Array(32), dv = u8_to_dataview(out), l = 12, flags = 0;
  out[0] = 3;
  switch (cell.t) {
    case "n":
      out[2] = 2;
      dv.setFloat64(l, cell.v, true);
      flags |= 32;
      l += 8;
      break;
    case "b":
      out[2] = 6;
      dv.setFloat64(l, cell.v ? 1 : 0, true);
      flags |= 32;
      l += 8;
      break;
    case "s":
      if (sst.indexOf(cell.v) == -1) throw new Error("Value ".concat(cell.v, " missing from SST!"));
      out[2] = 3;
      dv.setUint32(l, sst.indexOf(cell.v), true);
      flags |= 16;
      l += 4;
      break;
    default:
      throw "unsupported cell type " + cell.t;
  }
  dv.setUint32(4, flags, true);
  return out.slice(0, l);
}
function parse_TSP_Reference(buf) {
  var pb = parse_shallow(buf);
  return parse_varint49(pb[1][0].data);
}
function write_tile_row(tri, data, SST) {
  var _a, _b, _c, _d;
  if (!((_a = tri[6]) == null ? void 0 : _a[0]) || !((_b = tri[7]) == null ? void 0 : _b[0])) throw "Mutation only works on post-BNC storages!";
  var wide_offsets = ((_d = (_c = tri[8]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) && varint_to_i32(tri[8][0].data) > 0 || false;
  if (wide_offsets) throw "Math only works with normal offsets";
  var cnt = 0;
  var dv = u8_to_dataview(tri[7][0].data), last_offset = 0, cell_storage = [];
  var _dv = u8_to_dataview(tri[4][0].data), _last_offset = 0, _cell_storage = [];
  for (var C = 0; C < data.length; ++C) {
    if (data[C] == null) {
      dv.setUint16(C * 2, 65535, true);
      _dv.setUint16(C * 2, 65535);
      continue;
    }
    dv.setUint16(C * 2, last_offset, true);
    _dv.setUint16(C * 2, _last_offset, true);
    var celload, _celload;
    switch (typeof data[C]) {
      case "string":
        celload = write_new_storage({
          t: "s",
          v: data[C]
        }, SST);
        _celload = write_old_storage({
          t: "s",
          v: data[C]
        }, SST);
        break;
      case "number":
        celload = write_new_storage({
          t: "n",
          v: data[C]
        }, SST);
        _celload = write_old_storage({
          t: "n",
          v: data[C]
        }, SST);
        break;
      case "boolean":
        celload = write_new_storage({
          t: "b",
          v: data[C]
        }, SST);
        _celload = write_old_storage({
          t: "b",
          v: data[C]
        }, SST);
        break;
      default:
        throw new Error("Unsupported value " + data[C]);
    }
    cell_storage.push(celload);
    last_offset += celload.length;
    _cell_storage.push(_celload);
    _last_offset += _celload.length;
    ++cnt;
  }
  tri[2][0].data = write_varint49(cnt);
  for (; C < tri[7][0].data.length / 2; ++C) {
    dv.setUint16(C * 2, 65535, true);
    _dv.setUint16(C * 2, 65535, true);
  }
  tri[6][0].data = u8concat(cell_storage);
  tri[3][0].data = u8concat(_cell_storage);
  return cnt;
}
function write_numbers_iwa(wb, opts) {
  if (!opts || !opts.numbers) throw new Error("Must pass a `numbers` option -- check the README");
  var ws = wb.Sheets[wb.SheetNames[0]];
  if (wb.SheetNames.length > 1) console.error("The Numbers writer currently writes only the first table");
  var range = decode_range(ws["!ref"]);
  range.s.r = range.s.c = 0;
  var trunc = false;
  if (range.e.c > 9) {
    trunc = true;
    range.e.c = 9;
  }
  if (range.e.r > 49) {
    trunc = true;
    range.e.r = 49;
  }
  if (trunc) console.error("The Numbers writer is currently limited to ".concat(encode_range(range)));
  var data = sheet_to_json(ws, {
    range,
    header: 1
  });
  var SST = ["~Sh33tJ5~"];
  data.forEach(function(row) {
    return row.forEach(function(cell) {
      if (typeof cell == "string") SST.push(cell);
    });
  });
  var dependents = {};
  var indices = [];
  var cfb = CFB.read(opts.numbers, {
    type: "base64"
  });
  cfb.FileIndex.map(function(fi, idx) {
    return [fi, cfb.FullPaths[idx]];
  }).forEach(function(row) {
    var fi = row[0], fp = row[1];
    if (fi.type != 2) return;
    if (!fi.name.match(/\.iwa/)) return;
    var old_content = fi.content;
    var raw1 = decompress_iwa_file(old_content);
    var x2 = parse_iwa_file(raw1);
    x2.forEach(function(packet2) {
      indices.push(packet2.id);
      dependents[packet2.id] = {
        deps: [],
        location: fp,
        type: varint_to_i32(packet2.messages[0].meta[1][0].data)
      };
    });
  });
  indices.sort(function(x2, y2) {
    return x2 - y2;
  });
  var indices_varint = indices.filter(function(x2) {
    return x2 > 1;
  }).map(function(x2) {
    return [x2, write_varint49(x2)];
  });
  cfb.FileIndex.map(function(fi, idx) {
    return [fi, cfb.FullPaths[idx]];
  }).forEach(function(row) {
    var fi = row[0], fp = row[1];
    if (!fi.name.match(/\.iwa/)) return;
    var x2 = parse_iwa_file(decompress_iwa_file(fi.content));
    x2.forEach(function(ia) {
      ia.messages.forEach(function(m) {
        indices_varint.forEach(function(ivi) {
          if (ia.messages.some(function(mess) {
            return varint_to_i32(mess.meta[1][0].data) != 11006 && u8contains(mess.data, ivi[1]);
          })) {
            dependents[ivi[0]].deps.push(ia.id);
          }
        });
      });
    });
  });
  function get_unique_msgid() {
    for (var i = 927262; i < 2e6; ++i) if (!dependents[i]) return i;
    throw new Error("Too many messages");
  }
  var entry = CFB.find(cfb, dependents[1].location);
  var x = parse_iwa_file(decompress_iwa_file(entry.content));
  var docroot;
  for (var xi = 0; xi < x.length; ++xi) {
    var packet = x[xi];
    if (packet.id == 1) docroot = packet;
  }
  var sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[1][0].data);
  entry = CFB.find(cfb, dependents[sheetrootref].location);
  x = parse_iwa_file(decompress_iwa_file(entry.content));
  for (xi = 0; xi < x.length; ++xi) {
    packet = x[xi];
    if (packet.id == sheetrootref) docroot = packet;
  }
  sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[2][0].data);
  entry = CFB.find(cfb, dependents[sheetrootref].location);
  x = parse_iwa_file(decompress_iwa_file(entry.content));
  for (xi = 0; xi < x.length; ++xi) {
    packet = x[xi];
    if (packet.id == sheetrootref) docroot = packet;
  }
  sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[2][0].data);
  entry = CFB.find(cfb, dependents[sheetrootref].location);
  x = parse_iwa_file(decompress_iwa_file(entry.content));
  for (xi = 0; xi < x.length; ++xi) {
    packet = x[xi];
    if (packet.id == sheetrootref) docroot = packet;
  }
  var pb = parse_shallow(docroot.messages[0].data);
  {
    pb[6][0].data = write_varint49(range.e.r + 1);
    pb[7][0].data = write_varint49(range.e.c + 1);
    var cruidsref = parse_TSP_Reference(pb[46][0].data);
    var oldbucket = CFB.find(cfb, dependents[cruidsref].location);
    var _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));
    {
      for (var j = 0; j < _x.length; ++j) {
        if (_x[j].id == cruidsref) break;
      }
      if (_x[j].id != cruidsref) throw "Bad ColumnRowUIDMapArchive";
      var cruids = parse_shallow(_x[j].messages[0].data);
      cruids[1] = [];
      cruids[2] = [], cruids[3] = [];
      for (var C = 0; C <= range.e.c; ++C) {
        var uuid = [];
        uuid[1] = uuid[2] = [{
          type: 0,
          data: write_varint49(C + 420690)
        }];
        cruids[1].push({
          type: 2,
          data: write_shallow(uuid)
        });
        cruids[2].push({
          type: 0,
          data: write_varint49(C)
        });
        cruids[3].push({
          type: 0,
          data: write_varint49(C)
        });
      }
      cruids[4] = [];
      cruids[5] = [], cruids[6] = [];
      for (var R = 0; R <= range.e.r; ++R) {
        uuid = [];
        uuid[1] = uuid[2] = [{
          type: 0,
          data: write_varint49(R + 726270)
        }];
        cruids[4].push({
          type: 2,
          data: write_shallow(uuid)
        });
        cruids[5].push({
          type: 0,
          data: write_varint49(R)
        });
        cruids[6].push({
          type: 0,
          data: write_varint49(R)
        });
      }
      _x[j].messages[0].data = write_shallow(cruids);
    }
    oldbucket.content = compress_iwa_file(write_iwa_file(_x));
    oldbucket.size = oldbucket.content.length;
    delete pb[46];
    var store = parse_shallow(pb[4][0].data);
    {
      store[7][0].data = write_varint49(range.e.r + 1);
      var row_headers = parse_shallow(store[1][0].data);
      var row_header_ref = parse_TSP_Reference(row_headers[2][0].data);
      oldbucket = CFB.find(cfb, dependents[row_header_ref].location);
      _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));
      {
        if (_x[0].id != row_header_ref) throw "Bad HeaderStorageBucket";
        var base_bucket = parse_shallow(_x[0].messages[0].data);
        for (R = 0; R < data.length; ++R) {
          var _bucket = parse_shallow(base_bucket[2][0].data);
          _bucket[1][0].data = write_varint49(R);
          _bucket[4][0].data = write_varint49(data[R].length);
          base_bucket[2][R] = {
            type: base_bucket[2][0].type,
            data: write_shallow(_bucket)
          };
        }
        _x[0].messages[0].data = write_shallow(base_bucket);
      }
      oldbucket.content = compress_iwa_file(write_iwa_file(_x));
      oldbucket.size = oldbucket.content.length;
      var col_header_ref = parse_TSP_Reference(store[2][0].data);
      oldbucket = CFB.find(cfb, dependents[col_header_ref].location);
      _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));
      {
        if (_x[0].id != col_header_ref) throw "Bad HeaderStorageBucket";
        base_bucket = parse_shallow(_x[0].messages[0].data);
        for (C = 0; C <= range.e.c; ++C) {
          _bucket = parse_shallow(base_bucket[2][0].data);
          _bucket[1][0].data = write_varint49(C);
          _bucket[4][0].data = write_varint49(range.e.r + 1);
          base_bucket[2][C] = {
            type: base_bucket[2][0].type,
            data: write_shallow(_bucket)
          };
        }
        _x[0].messages[0].data = write_shallow(base_bucket);
      }
      oldbucket.content = compress_iwa_file(write_iwa_file(_x));
      oldbucket.size = oldbucket.content.length;
      var sstref = parse_TSP_Reference(store[4][0].data);
      (function() {
        var sentry = CFB.find(cfb, dependents[sstref].location);
        var sx = parse_iwa_file(decompress_iwa_file(sentry.content));
        var sstroot;
        for (var sxi = 0; sxi < sx.length; ++sxi) {
          var packet2 = sx[sxi];
          if (packet2.id == sstref) sstroot = packet2;
        }
        var sstdata = parse_shallow(sstroot.messages[0].data);
        {
          sstdata[3] = [];
          var newsst = [];
          SST.forEach(function(str, i) {
            newsst[1] = [{
              type: 0,
              data: write_varint49(i)
            }];
            newsst[2] = [{
              type: 0,
              data: write_varint49(1)
            }];
            newsst[3] = [{
              type: 2,
              data: stru8(str)
            }];
            sstdata[3].push({
              type: 2,
              data: write_shallow(newsst)
            });
          });
        }
        sstroot.messages[0].data = write_shallow(sstdata);
        var sy = write_iwa_file(sx);
        var raw32 = compress_iwa_file(sy);
        sentry.content = raw32;
        sentry.size = sentry.content.length;
      })();
      var tile = parse_shallow(store[3][0].data);
      {
        var t = tile[1][0];
        delete tile[2];
        var tl = parse_shallow(t.data);
        {
          var tileref = parse_TSP_Reference(tl[2][0].data);
          (function() {
            var tentry = CFB.find(cfb, dependents[tileref].location);
            var tx = parse_iwa_file(decompress_iwa_file(tentry.content));
            var tileroot;
            for (var sxi = 0; sxi < tx.length; ++sxi) {
              var packet2 = tx[sxi];
              if (packet2.id == tileref) tileroot = packet2;
            }
            var tiledata = parse_shallow(tileroot.messages[0].data);
            {
              delete tiledata[6];
              delete tile[7];
              var rowload = new Uint8Array(tiledata[5][0].data);
              tiledata[5] = [];
              var cnt = 0;
              for (var R2 = 0; R2 <= range.e.r; ++R2) {
                var tilerow = parse_shallow(rowload);
                cnt += write_tile_row(tilerow, data[R2], SST);
                tilerow[1][0].data = write_varint49(R2);
                tiledata[5].push({
                  data: write_shallow(tilerow),
                  type: 2
                });
              }
              tiledata[1] = [{
                type: 0,
                data: write_varint49(range.e.c + 1)
              }];
              tiledata[2] = [{
                type: 0,
                data: write_varint49(range.e.r + 1)
              }];
              tiledata[3] = [{
                type: 0,
                data: write_varint49(cnt)
              }];
              tiledata[4] = [{
                type: 0,
                data: write_varint49(range.e.r + 1)
              }];
            }
            tileroot.messages[0].data = write_shallow(tiledata);
            var ty = write_iwa_file(tx);
            var raw32 = compress_iwa_file(ty);
            tentry.content = raw32;
            tentry.size = tentry.content.length;
          })();
        }
        t.data = write_shallow(tl);
      }
      store[3][0].data = write_shallow(tile);
    }
    pb[4][0].data = write_shallow(store);
  }
  docroot.messages[0].data = write_shallow(pb);
  var y = write_iwa_file(x);
  var raw3 = compress_iwa_file(y);
  entry.content = raw3;
  entry.size = entry.content.length;
  return cfb;
}
function fix_opts_func(defaults) {
  return function fix_opts(opts) {
    for (var i = 0; i != defaults.length; ++i) {
      var d = defaults[i];
      if (opts[d[0]] === void 0) opts[d[0]] = d[1];
      if (d[2] === "n") opts[d[0]] = Number(opts[d[0]]);
    }
  };
}
function fix_write_opts(opts) {
  fix_opts_func([
    ["cellDates", false],
    /* write date cells with type `d` */
    ["bookSST", false],
    /* Generate Shared String Table */
    ["bookType", "xlsx"],
    /* Type of workbook (xlsx/m/b) */
    ["compression", false],
    /* Use file compression */
    ["WTF", false]
    /* WTF mode (throws errors) */
  ])(opts);
}
function write_zip(wb, opts) {
  if (opts.bookType == "ods") return write_ods(wb, opts);
  if (opts.bookType == "numbers") return write_numbers_iwa(wb, opts);
  if (opts.bookType == "xlsb") return write_zip_xlsxb(wb, opts);
  return write_zip_xlsx(wb, opts);
}
function write_zip_xlsxb(wb, opts) {
  _shapeid = 1024;
  if (wb && !wb.SSF) {
    wb.SSF = dup(table_fmt);
  }
  if (wb && wb.SSF) {
    make_ssf();
    SSF_load_table(wb.SSF);
    opts.revssf = evert_num(wb.SSF);
    opts.revssf[wb.SSF[65535]] = 0;
    opts.ssf = wb.SSF;
  }
  opts.rels = {};
  opts.wbrels = {};
  opts.Strings = /*::((*/
  [];
  opts.Strings.Count = 0;
  opts.Strings.Unique = 0;
  if (browser_has_Map) opts.revStrings = /* @__PURE__ */ new Map();
  else {
    opts.revStrings = {};
    opts.revStrings.foo = [];
    delete opts.revStrings.foo;
  }
  var wbext = opts.bookType == "xlsb" ? "bin" : "xml";
  var vbafmt = VBAFMTS.indexOf(opts.bookType) > -1;
  var ct = new_ct();
  fix_write_opts(opts = opts || {});
  var zip = zip_new();
  var f = "", rId = 0;
  opts.cellXfs = [];
  get_cell_style(opts.cellXfs, {}, {
    revssf: {
      "General": 0
    }
  });
  if (!wb.Props) wb.Props = {};
  f = "docProps/core.xml";
  zip_add_file(zip, f, write_core_props(wb.Props, opts));
  ct.coreprops.push(f);
  add_rels(opts.rels, 2, f, RELS.CORE_PROPS);
  f = "docProps/app.xml";
  if (wb.Props && wb.Props.SheetNames) {
  } else if (!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;
  else {
    var _sn = [];
    for (var _i = 0; _i < wb.SheetNames.length; ++_i) if ((wb.Workbook.Sheets[_i] || {}).Hidden != 2) _sn.push(wb.SheetNames[_i]);
    wb.Props.SheetNames = _sn;
  }
  wb.Props.Worksheets = wb.Props.SheetNames.length;
  zip_add_file(zip, f, write_ext_props(wb.Props, opts));
  ct.extprops.push(f);
  add_rels(opts.rels, 3, f, RELS.EXT_PROPS);
  if (wb.Custprops !== wb.Props && keys(wb.Custprops || {}).length > 0) {
    f = "docProps/custom.xml";
    zip_add_file(zip, f, write_cust_props(wb.Custprops, opts));
    ct.custprops.push(f);
    add_rels(opts.rels, 4, f, RELS.CUST_PROPS);
  }
  for (rId = 1; rId <= wb.SheetNames.length; ++rId) {
    var wsrels = {
      "!id": {}
    };
    var ws = wb.Sheets[wb.SheetNames[rId - 1]];
    var _type = (ws || {})["!type"] || "sheet";
    switch (_type) {
      case "chart":
      /* falls through */
      default:
        f = "xl/worksheets/sheet" + rId + "." + wbext;
        zip_add_file(zip, f, write_ws(rId - 1, f, opts, wb, wsrels));
        ct.sheets.push(f);
        add_rels(opts.wbrels, -1, "worksheets/sheet" + rId + "." + wbext, RELS.WS[0]);
    }
    if (ws) {
      var comments = ws["!comments"];
      var need_vml = false;
      var cf = "";
      if (comments && comments.length > 0) {
        cf = "xl/comments" + rId + "." + wbext;
        zip_add_file(zip, cf, write_cmnt(comments, cf, opts));
        ct.comments.push(cf);
        add_rels(wsrels, -1, "../comments" + rId + "." + wbext, RELS.CMNT);
        need_vml = true;
      }
      if (ws["!legacy"]) {
        if (need_vml) zip_add_file(zip, "xl/drawings/vmlDrawing" + rId + ".vml", write_comments_vml(rId, ws["!comments"]));
      }
      delete ws["!comments"];
      delete ws["!legacy"];
    }
    if (wsrels["!id"].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));
  }
  if (opts.Strings != null && opts.Strings.length > 0) {
    f = "xl/sharedStrings." + wbext;
    zip_add_file(zip, f, write_sst(opts.Strings, f, opts));
    ct.strs.push(f);
    add_rels(opts.wbrels, -1, "sharedStrings." + wbext, RELS.SST);
  }
  f = "xl/workbook." + wbext;
  zip_add_file(zip, f, write_wb(wb, f, opts));
  ct.workbooks.push(f);
  add_rels(opts.rels, 1, f, RELS.WB);
  f = "xl/theme/theme1.xml";
  zip_add_file(zip, f, write_theme(wb.Themes, opts));
  ct.themes.push(f);
  add_rels(opts.wbrels, -1, "theme/theme1.xml", RELS.THEME);
  f = "xl/styles." + wbext;
  zip_add_file(zip, f, write_sty(wb, f, opts));
  ct.styles.push(f);
  add_rels(opts.wbrels, -1, "styles." + wbext, RELS.STY);
  if (wb.vbaraw && vbafmt) {
    f = "xl/vbaProject.bin";
    zip_add_file(zip, f, wb.vbaraw);
    ct.vba.push(f);
    add_rels(opts.wbrels, -1, "vbaProject.bin", RELS.VBA);
  }
  f = "xl/metadata." + wbext;
  zip_add_file(zip, f, write_xlmeta(f));
  ct.metadata.push(f);
  add_rels(opts.wbrels, -1, "metadata." + wbext, RELS.XLMETA);
  zip_add_file(zip, "[Content_Types].xml", write_ct(ct, opts));
  zip_add_file(zip, "_rels/.rels", write_rels(opts.rels));
  zip_add_file(zip, "xl/_rels/workbook." + wbext + ".rels", write_rels(opts.wbrels));
  delete opts.revssf;
  delete opts.ssf;
  return zip;
}
function write_zip_xlsx(wb, opts) {
  _shapeid = 1024;
  if (wb && !wb.SSF) {
    wb.SSF = dup(table_fmt);
  }
  if (wb && wb.SSF) {
    make_ssf();
    SSF_load_table(wb.SSF);
    opts.revssf = evert_num(wb.SSF);
    opts.revssf[wb.SSF[65535]] = 0;
    opts.ssf = wb.SSF;
  }
  opts.rels = {};
  opts.wbrels = {};
  opts.Strings = /*::((*/
  [];
  opts.Strings.Count = 0;
  opts.Strings.Unique = 0;
  if (browser_has_Map) opts.revStrings = /* @__PURE__ */ new Map();
  else {
    opts.revStrings = {};
    opts.revStrings.foo = [];
    delete opts.revStrings.foo;
  }
  var wbext = "xml";
  var vbafmt = VBAFMTS.indexOf(opts.bookType) > -1;
  var ct = new_ct();
  fix_write_opts(opts = opts || {});
  var zip = zip_new();
  var f = "", rId = 0;
  opts.cellXfs = [];
  get_cell_style(opts.cellXfs, {}, {
    revssf: {
      "General": 0
    }
  });
  if (!wb.Props) wb.Props = {};
  f = "docProps/core.xml";
  zip_add_file(zip, f, write_core_props(wb.Props, opts));
  ct.coreprops.push(f);
  add_rels(opts.rels, 2, f, RELS.CORE_PROPS);
  f = "docProps/app.xml";
  if (wb.Props && wb.Props.SheetNames) {
  } else if (!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;
  else {
    var _sn = [];
    for (var _i = 0; _i < wb.SheetNames.length; ++_i) if ((wb.Workbook.Sheets[_i] || {}).Hidden != 2) _sn.push(wb.SheetNames[_i]);
    wb.Props.SheetNames = _sn;
  }
  wb.Props.Worksheets = wb.Props.SheetNames.length;
  zip_add_file(zip, f, write_ext_props(wb.Props, opts));
  ct.extprops.push(f);
  add_rels(opts.rels, 3, f, RELS.EXT_PROPS);
  if (wb.Custprops !== wb.Props && keys(wb.Custprops || {}).length > 0) {
    f = "docProps/custom.xml";
    zip_add_file(zip, f, write_cust_props(wb.Custprops, opts));
    ct.custprops.push(f);
    add_rels(opts.rels, 4, f, RELS.CUST_PROPS);
  }
  var people = ["SheetJ5"];
  opts.tcid = 0;
  for (rId = 1; rId <= wb.SheetNames.length; ++rId) {
    var wsrels = {
      "!id": {}
    };
    var ws = wb.Sheets[wb.SheetNames[rId - 1]];
    var _type = (ws || {})["!type"] || "sheet";
    switch (_type) {
      case "chart":
      /* falls through */
      default:
        f = "xl/worksheets/sheet" + rId + "." + wbext;
        zip_add_file(zip, f, write_ws_xml(rId - 1, opts, wb, wsrels));
        ct.sheets.push(f);
        add_rels(opts.wbrels, -1, "worksheets/sheet" + rId + "." + wbext, RELS.WS[0]);
    }
    if (ws) {
      var comments = ws["!comments"];
      var need_vml = false;
      var cf = "";
      if (comments && comments.length > 0) {
        var needtc = false;
        comments.forEach(function(carr) {
          carr[1].forEach(function(c) {
            if (c.T == true) needtc = true;
          });
        });
        if (needtc) {
          cf = "xl/threadedComments/threadedComment" + rId + "." + wbext;
          zip_add_file(zip, cf, write_tcmnt_xml(comments, people, opts));
          ct.threadedcomments.push(cf);
          add_rels(wsrels, -1, "../threadedComments/threadedComment" + rId + "." + wbext, RELS.TCMNT);
        }
        cf = "xl/comments" + rId + "." + wbext;
        zip_add_file(zip, cf, write_comments_xml(comments, opts));
        ct.comments.push(cf);
        add_rels(wsrels, -1, "../comments" + rId + "." + wbext, RELS.CMNT);
        need_vml = true;
      }
      if (ws["!legacy"]) {
        if (need_vml) zip_add_file(zip, "xl/drawings/vmlDrawing" + rId + ".vml", write_comments_vml(rId, ws["!comments"]));
      }
      delete ws["!comments"];
      delete ws["!legacy"];
    }
    if (wsrels["!id"].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));
  }
  if (opts.Strings != null && opts.Strings.length > 0) {
    f = "xl/sharedStrings." + wbext;
    zip_add_file(zip, f, write_sst_xml(opts.Strings, opts));
    ct.strs.push(f);
    add_rels(opts.wbrels, -1, "sharedStrings." + wbext, RELS.SST);
  }
  f = "xl/workbook." + wbext;
  zip_add_file(zip, f, write_wb_xml(wb, opts));
  ct.workbooks.push(f);
  add_rels(opts.rels, 1, f, RELS.WB);
  f = "xl/theme/theme1.xml";
  zip_add_file(zip, f, write_theme(wb.Themes, opts));
  ct.themes.push(f);
  add_rels(opts.wbrels, -1, "theme/theme1.xml", RELS.THEME);
  f = "xl/styles." + wbext;
  zip_add_file(zip, f, write_sty_xml(wb, opts));
  ct.styles.push(f);
  add_rels(opts.wbrels, -1, "styles." + wbext, RELS.STY);
  if (wb.vbaraw && vbafmt) {
    f = "xl/vbaProject.bin";
    zip_add_file(zip, f, wb.vbaraw);
    ct.vba.push(f);
    add_rels(opts.wbrels, -1, "vbaProject.bin", RELS.VBA);
  }
  f = "xl/metadata." + wbext;
  zip_add_file(zip, f, write_xlmeta_xml());
  ct.metadata.push(f);
  add_rels(opts.wbrels, -1, "metadata." + wbext, RELS.XLMETA);
  if (people.length > 1) {
    f = "xl/persons/person.xml";
    zip_add_file(zip, f, write_people_xml(people, opts));
    ct.people.push(f);
    add_rels(opts.wbrels, -1, "persons/person.xml", RELS.PEOPLE);
  }
  zip_add_file(zip, "[Content_Types].xml", write_ct(ct, opts));
  zip_add_file(zip, "_rels/.rels", write_rels(opts.rels));
  zip_add_file(zip, "xl/_rels/workbook." + wbext + ".rels", write_rels(opts.wbrels));
  delete opts.revssf;
  delete opts.ssf;
  return zip;
}
function firstbyte(f, o) {
  var x = "";
  switch ((o || {}).type || "base64") {
    case "buffer":
      return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];
    case "base64":
      x = Base64_decode(f.slice(0, 12));
      break;
    case "binary":
      x = f;
      break;
    case "array":
      return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];
    default:
      throw new Error("Unrecognized type " + (o && o.type || "undefined"));
  }
  return [x.charCodeAt(0), x.charCodeAt(1), x.charCodeAt(2), x.charCodeAt(3), x.charCodeAt(4), x.charCodeAt(5), x.charCodeAt(6), x.charCodeAt(7)];
}
function write_cfb_ctr(cfb, o) {
  switch (o.type) {
    case "base64":
    case "binary":
      break;
    case "buffer":
    case "array":
      o.type = "";
      break;
    case "file":
      return write_dl(o.file, CFB.write(cfb, {
        type: has_buf ? "buffer" : ""
      }));
    case "string":
      throw new Error("'string' output type invalid for '" + o.bookType + "' files");
    default:
      throw new Error("Unrecognized type " + o.type);
  }
  return CFB.write(cfb, o);
}
function write_zip_type(wb, opts) {
  var o = dup(opts || {});
  var z = write_zip(wb, o);
  return write_zip_denouement(z, o);
}
function write_zip_denouement(z, o) {
  var oopts = {};
  var ftype = has_buf ? "nodebuffer" : typeof Uint8Array !== "undefined" ? "array" : "string";
  if (o.compression) oopts.compression = "DEFLATE";
  if (o.password) oopts.type = ftype;
  else switch (o.type) {
    case "base64":
      oopts.type = "base64";
      break;
    case "binary":
      oopts.type = "string";
      break;
    case "string":
      throw new Error("'string' output type invalid for '" + o.bookType + "' files");
    case "buffer":
    case "file":
      oopts.type = ftype;
      break;
    default:
      throw new Error("Unrecognized type " + o.type);
  }
  var out = z.FullPaths ? CFB.write(z, {
    fileType: "zip",
    type: (
      /*::(*/
      {
        "nodebuffer": "buffer",
        "string": "binary"
      }[oopts.type] || oopts.type
    ),
    compression: !!o.compression
  }) : z.generate(oopts);
  if (typeof Deno !== "undefined") {
    if (typeof out == "string") {
      if (o.type == "binary" || o.type == "base64") return out;
      out = new Uint8Array(s2ab(out));
    }
  }
  if (o.password && typeof encrypt_agile !== "undefined") return write_cfb_ctr(encrypt_agile(out, o.password), o);
  if (o.type === "file") return write_dl(o.file, out);
  return o.type == "string" ? utf8read(
    /*::(*/
    out
    /*:: :any)*/
  ) : out;
}
function write_cfb_type(wb, opts) {
  var o = opts || {};
  var cfb = write_xlscfb(wb, o);
  return write_cfb_ctr(cfb, o);
}
function write_string_type(out, opts, bom) {
  if (!bom) bom = "";
  var o = bom + out;
  switch (opts.type) {
    case "base64":
      return Base64_encode(utf8write(o));
    case "binary":
      return utf8write(o);
    case "string":
      return out;
    case "file":
      return write_dl(opts.file, o, "utf8");
    case "buffer": {
      if (has_buf) return Buffer_from(o, "utf8");
      else if (typeof TextEncoder !== "undefined") return new TextEncoder().encode(o);
      else return write_string_type(o, {
        type: "binary"
      }).split("").map(function(c) {
        return c.charCodeAt(0);
      });
    }
  }
  throw new Error("Unrecognized type " + opts.type);
}
function write_stxt_type(out, opts) {
  switch (opts.type) {
    case "base64":
      return Base64_encode(out);
    case "binary":
      return out;
    case "string":
      return out;
    /* override in sheet_to_txt */
    case "file":
      return write_dl(opts.file, out, "binary");
    case "buffer": {
      if (has_buf) return Buffer_from(out, "binary");
      else return out.split("").map(function(c) {
        return c.charCodeAt(0);
      });
    }
  }
  throw new Error("Unrecognized type " + opts.type);
}
function write_binary_type(out, opts) {
  switch (opts.type) {
    case "string":
    case "base64":
    case "binary":
      var bstr = "";
      for (var i = 0; i < out.length; ++i) bstr += String.fromCharCode(out[i]);
      return opts.type == "base64" ? Base64_encode(bstr) : opts.type == "string" ? utf8read(bstr) : bstr;
    case "file":
      return write_dl(opts.file, out);
    case "buffer":
      return out;
    default:
      throw new Error("Unrecognized type " + opts.type);
  }
}
function writeSync(wb, opts) {
  reset_cp();
  check_wb(wb);
  var o = dup(opts || {});
  if (o.cellStyles) {
    o.cellNF = true;
    o.sheetStubs = true;
  }
  if (o.type == "array") {
    o.type = "binary";
    var out = writeSync(wb, o);
    o.type = "array";
    return s2ab(out);
  }
  var idx = 0;
  if (o.sheet) {
    if (typeof o.sheet == "number") idx = o.sheet;
    else idx = wb.SheetNames.indexOf(o.sheet);
    if (!wb.SheetNames[idx]) throw new Error("Sheet not found: " + o.sheet + " : " + typeof o.sheet);
  }
  switch (o.bookType || "xlsb") {
    case "xml":
    case "xlml":
      return write_string_type(write_xlml(wb, o), o);
    case "slk":
    case "sylk":
      return write_string_type(SYLK.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);
    case "htm":
    case "html":
      return write_string_type(sheet_to_html(wb.Sheets[wb.SheetNames[idx]], o), o);
    case "txt":
      return write_stxt_type(sheet_to_txt(wb.Sheets[wb.SheetNames[idx]], o), o);
    case "csv":
      return write_string_type(sheet_to_csv(wb.Sheets[wb.SheetNames[idx]], o), o, "\uFEFF");
    case "dif":
      return write_string_type(DIF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);
    case "dbf":
      return write_binary_type(DBF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);
    case "prn":
      return write_string_type(PRN.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);
    case "rtf":
      return write_string_type(RTF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);
    case "eth":
      return write_string_type(ETH.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);
    case "fods":
      return write_string_type(write_ods(wb, o), o);
    case "wk1":
      return write_binary_type(WK_.sheet_to_wk1(wb.Sheets[wb.SheetNames[idx]], o), o);
    case "wk3":
      return write_binary_type(WK_.book_to_wk3(wb, o), o);
    case "biff2":
      if (!o.biff) o.biff = 2;
    /* falls through */
    case "biff3":
      if (!o.biff) o.biff = 3;
    /* falls through */
    case "biff4":
      if (!o.biff) o.biff = 4;
      return write_binary_type(write_biff_buf(wb, o), o);
    case "biff5":
      if (!o.biff) o.biff = 5;
    /* falls through */
    case "biff8":
    case "xla":
    case "xls":
      if (!o.biff) o.biff = 8;
      return write_cfb_type(wb, o);
    case "xlsx":
    case "xlsm":
    case "xlam":
    case "xlsb":
    case "numbers":
    case "ods":
      return write_zip_type(wb, o);
    default:
      throw new Error("Unrecognized bookType |" + o.bookType + "|");
  }
}
function make_json_row(sheet, r, R, cols, header, hdr, dense, o) {
  var rr = encode_row(R);
  var defval = o.defval, raw = o.raw || !Object.prototype.hasOwnProperty.call(o, "raw");
  var isempty = true;
  var row = header === 1 ? [] : {};
  if (header !== 1) {
    if (Object.defineProperty) try {
      Object.defineProperty(row, "__rowNum__", {
        value: R,
        enumerable: false
      });
    } catch (e) {
      row.__rowNum__ = R;
    }
    else row.__rowNum__ = R;
  }
  if (!dense || sheet[R]) for (var C = r.s.c; C <= r.e.c; ++C) {
    var val = dense ? sheet[R][C] : sheet[cols[C] + rr];
    if (val === void 0 || val.t === void 0) {
      if (defval === void 0) continue;
      if (hdr[C] != null) {
        row[hdr[C]] = defval;
      }
      continue;
    }
    var v = val.v;
    switch (val.t) {
      case "z":
        if (v == null) break;
        continue;
      case "e":
        v = v == 0 ? null : void 0;
        break;
      case "s":
      case "d":
      case "b":
      case "n":
        break;
      default:
        throw new Error("unrecognized type " + val.t);
    }
    if (hdr[C] != null) {
      if (v == null) {
        if (val.t == "e" && v === null) row[hdr[C]] = null;
        else if (defval !== void 0) row[hdr[C]] = defval;
        else if (raw && v === null) row[hdr[C]] = null;
        else continue;
      } else {
        row[hdr[C]] = raw && (val.t !== "n" || val.t === "n" && o.rawNumbers !== false) ? v : format_cell(val, v, o);
      }
      if (v != null) isempty = false;
    }
  }
  return {
    row,
    isempty
  };
}
function sheet_to_json(sheet, opts) {
  if (sheet == null || sheet["!ref"] == null) return [];
  var val = {
    t: "n",
    v: 0
  }, header = 0, offset = 1, hdr = [], v = 0, vv = "";
  var r = {
    s: {
      r: 0,
      c: 0
    },
    e: {
      r: 0,
      c: 0
    }
  };
  var o = opts || {};
  var range = o.range != null ? o.range : sheet["!ref"];
  if (o.header === 1) header = 1;
  else if (o.header === "A") header = 2;
  else if (Array.isArray(o.header)) header = 3;
  else if (o.header == null) header = 0;
  switch (typeof range) {
    case "string":
      r = safe_decode_range(range);
      break;
    case "number":
      r = safe_decode_range(sheet["!ref"]);
      r.s.r = range;
      break;
    default:
      r = range;
  }
  if (header > 0) offset = 0;
  var rr = encode_row(r.s.r);
  var cols = [];
  var out = [];
  var outi = 0, counter = 0;
  var dense = Array.isArray(sheet);
  var R = r.s.r, C = 0;
  var header_cnt = {};
  if (dense && !sheet[R]) sheet[R] = [];
  var colinfo = o.skipHidden && sheet["!cols"] || [];
  var rowinfo = o.skipHidden && sheet["!rows"] || [];
  for (C = r.s.c; C <= r.e.c; ++C) {
    if ((colinfo[C] || {}).hidden) continue;
    cols[C] = encode_col(C);
    val = dense ? sheet[R][C] : sheet[cols[C] + rr];
    switch (header) {
      case 1:
        hdr[C] = C - r.s.c;
        break;
      case 2:
        hdr[C] = cols[C];
        break;
      case 3:
        hdr[C] = o.header[C - r.s.c];
        break;
      default:
        if (val == null) val = {
          w: "__EMPTY",
          t: "s"
        };
        vv = v = format_cell(val, null, o);
        counter = header_cnt[v] || 0;
        if (!counter) header_cnt[v] = 1;
        else {
          do {
            vv = v + "_" + counter++;
          } while (header_cnt[vv]);
          header_cnt[v] = counter;
          header_cnt[vv] = 1;
        }
        hdr[C] = vv;
    }
  }
  for (R = r.s.r + offset; R <= r.e.r; ++R) {
    if ((rowinfo[R] || {}).hidden) continue;
    var row = make_json_row(sheet, r, R, cols, header, hdr, dense, o);
    if (row.isempty === false || (header === 1 ? o.blankrows !== false : !!o.blankrows)) out[outi++] = row.row;
  }
  out.length = outi;
  return out;
}
var qreg = /"/g;
function make_csv_row(sheet, r, R, cols, fs, rs, FS, o) {
  var isempty = true;
  var row = [], txt = "", rr = encode_row(R);
  for (var C = r.s.c; C <= r.e.c; ++C) {
    if (!cols[C]) continue;
    var val = o.dense ? (sheet[R] || [])[C] : sheet[cols[C] + rr];
    if (val == null) txt = "";
    else if (val.v != null) {
      isempty = false;
      txt = "" + (o.rawNumbers && val.t == "n" ? val.v : format_cell(val, null, o));
      for (var i = 0, cc = 0; i !== txt.length; ++i) if ((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34 || o.forceQuotes) {
        txt = '"' + txt.replace(qreg, '""') + '"';
        break;
      }
      if (txt == "ID") txt = '"ID"';
    } else if (val.f != null && !val.F) {
      isempty = false;
      txt = "=" + val.f;
      if (txt.indexOf(",") >= 0) txt = '"' + txt.replace(qreg, '""') + '"';
    } else txt = "";
    row.push(txt);
  }
  if (o.blankrows === false && isempty) return null;
  return row.join(FS);
}
function sheet_to_csv(sheet, opts) {
  var out = [];
  var o = opts == null ? {} : opts;
  if (sheet == null || sheet["!ref"] == null) return "";
  var r = safe_decode_range(sheet["!ref"]);
  var FS = o.FS !== void 0 ? o.FS : ",", fs = FS.charCodeAt(0);
  var RS = o.RS !== void 0 ? o.RS : "\n", rs = RS.charCodeAt(0);
  var endregex = new RegExp((FS == "|" ? "\\|" : FS) + "+$");
  var row = "", cols = [];
  o.dense = Array.isArray(sheet);
  var colinfo = o.skipHidden && sheet["!cols"] || [];
  var rowinfo = o.skipHidden && sheet["!rows"] || [];
  for (var C = r.s.c; C <= r.e.c; ++C) if (!(colinfo[C] || {}).hidden) cols[C] = encode_col(C);
  var w = 0;
  for (var R = r.s.r; R <= r.e.r; ++R) {
    if ((rowinfo[R] || {}).hidden) continue;
    row = make_csv_row(sheet, r, R, cols, fs, rs, FS, o);
    if (row == null) {
      continue;
    }
    if (o.strip) row = row.replace(endregex, "");
    if (row || o.blankrows !== false) out.push((w++ ? RS : "") + row);
  }
  delete o.dense;
  return out.join("");
}
function sheet_to_txt(sheet, opts) {
  if (!opts) opts = {};
  opts.FS = "	";
  opts.RS = "\n";
  var s = sheet_to_csv(sheet, opts);
  if (typeof $cptable == "undefined" || opts.type == "string") return s;
  var o = $cptable.utils.encode(1200, s, "str");
  return String.fromCharCode(255) + String.fromCharCode(254) + o;
}
function sheet_to_formulae(sheet) {
  var y = "", x, val = "";
  if (sheet == null || sheet["!ref"] == null) return [];
  var r = safe_decode_range(sheet["!ref"]), rr = "", cols = [], C;
  var cmds = [];
  var dense = Array.isArray(sheet);
  for (C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);
  for (var R = r.s.r; R <= r.e.r; ++R) {
    rr = encode_row(R);
    for (C = r.s.c; C <= r.e.c; ++C) {
      y = cols[C] + rr;
      x = dense ? (sheet[R] || [])[C] : sheet[y];
      val = "";
      if (x === void 0) continue;
      else if (x.F != null) {
        y = x.F;
        if (!x.f) continue;
        val = x.f;
        if (y.indexOf(":") == -1) y = y + ":" + y;
      }
      if (x.f != null) val = x.f;
      else if (x.t == "z") continue;
      else if (x.t == "n" && x.v != null) val = "" + x.v;
      else if (x.t == "b") val = x.v ? "TRUE" : "FALSE";
      else if (x.w !== void 0) val = "'" + x.w;
      else if (x.v === void 0) continue;
      else if (x.t == "s") val = "'" + x.v;
      else val = "" + x.v;
      cmds[cmds.length] = y + "=" + val;
    }
  }
  return cmds;
}
function sheet_add_json(_ws, js, opts) {
  var o = opts || {};
  var offset = +!o.skipHeader;
  var ws = _ws || {};
  var _R = 0, _C = 0;
  if (ws && o.origin != null) {
    if (typeof o.origin == "number") _R = o.origin;
    else {
      var _origin = typeof o.origin == "string" ? decode_cell(o.origin) : o.origin;
      _R = _origin.r;
      _C = _origin.c;
    }
  }
  var cell;
  var range = {
    s: {
      c: 0,
      r: 0
    },
    e: {
      c: _C,
      r: _R + js.length - 1 + offset
    }
  };
  if (ws["!ref"]) {
    var _range = safe_decode_range(ws["!ref"]);
    range.e.c = Math.max(range.e.c, _range.e.c);
    range.e.r = Math.max(range.e.r, _range.e.r);
    if (_R == -1) {
      _R = _range.e.r + 1;
      range.e.r = _R + js.length - 1 + offset;
    }
  } else {
    if (_R == -1) {
      _R = 0;
      range.e.r = js.length - 1 + offset;
    }
  }
  var hdr = o.header || [], C = 0;
  js.forEach(function(JS, R) {
    keys(JS).forEach(function(k) {
      if ((C = hdr.indexOf(k)) == -1) hdr[C = hdr.length] = k;
      var v = JS[k];
      var t = "z";
      var z = "";
      var ref = encode_cell({
        c: _C + C,
        r: _R + R + offset
      });
      cell = ws_get_cell_stub(ws, ref);
      if (v && typeof v === "object" && !(v instanceof Date)) {
        ws[ref] = v;
      } else {
        if (typeof v == "number") t = "n";
        else if (typeof v == "boolean") t = "b";
        else if (typeof v == "string") t = "s";
        else if (v instanceof Date) {
          t = "d";
          if (!o.cellDates) {
            t = "n";
            v = datenum(v);
          }
          z = o.dateNF || table_fmt[14];
        } else if (v === null && o.nullError) {
          t = "e";
          v = 0;
        }
        if (!cell) ws[ref] = cell = {
          t,
          v
        };
        else {
          cell.t = t;
          cell.v = v;
          delete cell.w;
          delete cell.R;
          if (z) cell.z = z;
        }
        if (z) cell.z = z;
      }
    });
  });
  range.e.c = Math.max(range.e.c, _C + hdr.length - 1);
  var __R = encode_row(_R);
  if (offset) for (C = 0; C < hdr.length; ++C) ws[encode_col(C + _C) + __R] = {
    t: "s",
    v: hdr[C]
  };
  ws["!ref"] = encode_range(range);
  return ws;
}
function json_to_sheet(js, opts) {
  return sheet_add_json(null, js, opts);
}
function ws_get_cell_stub(ws, R, C) {
  if (typeof R == "string") {
    if (Array.isArray(ws)) {
      var RC = decode_cell(R);
      if (!ws[RC.r]) ws[RC.r] = [];
      return ws[RC.r][RC.c] || (ws[RC.r][RC.c] = {
        t: "z"
      });
    }
    return ws[R] || (ws[R] = {
      t: "z"
    });
  }
  if (typeof R != "number") return ws_get_cell_stub(ws, encode_cell(R));
  return ws_get_cell_stub(ws, encode_cell({
    r: R,
    c: C || 0
  }));
}
function wb_sheet_idx(wb, sh) {
  if (typeof sh == "number") {
    if (sh >= 0 && wb.SheetNames.length > sh) return sh;
    throw new Error("Cannot find sheet # " + sh);
  } else if (typeof sh == "string") {
    var idx = wb.SheetNames.indexOf(sh);
    if (idx > -1) return idx;
    throw new Error("Cannot find sheet name |" + sh + "|");
  } else throw new Error("Cannot find sheet |" + sh + "|");
}
function book_new() {
  return {
    SheetNames: [],
    Sheets: {}
  };
}
function book_append_sheet(wb, ws, name, roll) {
  var i = 1;
  if (!name) {
    for (; i <= 65535; ++i, name = void 0) if (wb.SheetNames.indexOf(name = "Sheet" + i) == -1) break;
  }
  if (!name || wb.SheetNames.length >= 65535) throw new Error("Too many worksheets");
  if (roll && wb.SheetNames.indexOf(name) >= 0) {
    var m = name.match(/(^.*?)(\d+)$/);
    i = m && +m[2] || 0;
    var root = m && m[1] || name;
    for (++i; i <= 65535; ++i) if (wb.SheetNames.indexOf(name = root + i) == -1) break;
  }
  check_ws_name(name);
  if (wb.SheetNames.indexOf(name) >= 0) throw new Error("Worksheet with name |" + name + "| already exists!");
  wb.SheetNames.push(name);
  wb.Sheets[name] = ws;
  return name;
}
function book_set_sheet_visibility(wb, sh, vis) {
  if (!wb.Workbook) wb.Workbook = {};
  if (!wb.Workbook.Sheets) wb.Workbook.Sheets = [];
  var idx = wb_sheet_idx(wb, sh);
  if (!wb.Workbook.Sheets[idx]) wb.Workbook.Sheets[idx] = {};
  switch (vis) {
    case 0:
    case 1:
    case 2:
      break;
    default:
      throw new Error("Bad sheet visibility setting " + vis);
  }
  wb.Workbook.Sheets[idx].Hidden = vis;
}
function cell_set_number_format(cell, fmt) {
  cell.z = fmt;
  return cell;
}
function cell_set_hyperlink(cell, target, tooltip) {
  if (!target) {
    delete cell.l;
  } else {
    cell.l = {
      Target: target
    };
    if (tooltip) cell.l.Tooltip = tooltip;
  }
  return cell;
}
function cell_set_internal_link(cell, range, tooltip) {
  return cell_set_hyperlink(cell, "#" + range, tooltip);
}
function cell_add_comment(cell, text, author) {
  if (!cell.c) cell.c = [];
  cell.c.push({
    t: text,
    a: author || "SheetJS"
  });
}
function sheet_set_array_formula(ws, range, formula, dynamic) {
  var rng = typeof range != "string" ? range : safe_decode_range(range);
  var rngstr = typeof range == "string" ? range : encode_range(range);
  for (var R = rng.s.r; R <= rng.e.r; ++R) for (var C = rng.s.c; C <= rng.e.c; ++C) {
    var cell = ws_get_cell_stub(ws, R, C);
    cell.t = "n";
    cell.F = rngstr;
    delete cell.v;
    if (R == rng.s.r && C == rng.s.c) {
      cell.f = formula;
      if (dynamic) cell.D = true;
    }
  }
  return ws;
}
var utils = {
  encode_col,
  encode_row,
  encode_cell,
  encode_range,
  decode_col,
  decode_row,
  split_cell,
  decode_cell,
  decode_range,
  format_cell,
  sheet_add_aoa,
  sheet_add_json,
  sheet_add_dom,
  aoa_to_sheet,
  json_to_sheet,
  table_to_sheet: parse_dom_table,
  table_to_book,
  sheet_to_csv,
  sheet_to_txt,
  sheet_to_json,
  sheet_to_html,
  sheet_to_formulae,
  sheet_to_row_object_array: sheet_to_json,
  sheet_get_cell: ws_get_cell_stub,
  book_new,
  book_append_sheet,
  book_set_sheet_visibility,
  cell_set_number_format,
  cell_set_hyperlink,
  cell_set_internal_link,
  cell_add_comment,
  sheet_set_array_formula,
  consts: {
    SHEET_VISIBLE: 0,
    SHEET_HIDDEN: 1,
    SHEET_VERY_HIDDEN: 2
  }
};
var version = XLSX.version;

// src/app/service/excel-service.ts
var EXCEL_TYPE = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8";
var EXCEL_EXTENSION = ".xlsx";
var ExcelService = class _ExcelService {
  constructor() {
  }
  exportAsExcelFile(json, excelFileName) {
    const myworksheet = utils.json_to_sheet(json);
    const myworkbook = { Sheets: { "data": myworksheet }, SheetNames: ["data"] };
    const excelBuffer = writeSync(myworkbook, { bookType: "xlsx", type: "array" });
    this.saveAsExcelFile(excelBuffer, excelFileName);
  }
  saveAsExcelFile(buffer, fileName) {
    const data = new Blob([buffer], {
      type: EXCEL_TYPE
    });
    FileSaver.saveAs(data, fileName + "_exported" + EXCEL_EXTENSION);
  }
  exportTableAsExcelFile(table, excelFileName) {
    const myworksheet = utils.table_to_sheet(table);
    const myworkbook = { Sheets: { "data": myworksheet }, SheetNames: ["data"] };
    const excelBuffer = writeSync(myworkbook, { bookType: "xlsx", type: "array" });
    this.saveAsExcelFile(excelBuffer, excelFileName);
  }
  exportTable2AsExcelFile(tables, excelFileName) {
    const sheetsNames = [];
    const stringObject = `{ ${tables.map((e) => {
      return `"${e.sheetName}": ""`;
    })} }`;
    const mySheets = JSON.parse(stringObject);
    tables.map((e) => {
      const myworksheet = utils.table_to_sheet(e.body);
      mySheets[e.sheetName] = myworksheet;
      sheetsNames.push(e.sheetName);
    });
    const myworkbook = { Sheets: mySheets, SheetNames: sheetsNames };
    const excelBuffer = writeSync(myworkbook, { bookType: "xlsx", type: "array" });
    this.saveAsExcelFile(excelBuffer, excelFileName);
  }
  static {
    this.\u0275fac = function ExcelService_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _ExcelService)();
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({ token: _ExcelService, factory: _ExcelService.\u0275fac });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(ExcelService, [{
    type: Injectable
  }], () => [], null);
})();

// src/app/service/arquivo-service.ts
var ArquivoService = class _ArquivoService {
  constructor(http, utilService) {
    this.http = http;
    this.utilService = utilService;
    this.url = `${environment.urlGestaoArquivo}/api/arquivo`;
  }
  postAtualizaChaveArquivo(dadosAtualizar) {
    const httpOptions2 = this.utilService.filtrosHttpOptions();
    return this.http.post(`${this.url}/atualiza/chave`, dadosAtualizar, httpOptions2);
  }
  getListaArquivo(cCodigoEmpresa, cCodigoFilial, alias, chave, tipo) {
    const httpOptions2 = this.utilService.filtrosHttpOptions({ chave, tipo }, false);
    return this.http.get(`${this.url}/lista/generico/${cCodigoEmpresa}/${cCodigoFilial}/${alias}`, httpOptions2);
  }
  getQuantidadeArquivo(cCodigoEmpresa, cCodigoFilial, alias, chave, tipo) {
    const httpOptions2 = this.utilService.filtrosHttpOptions({ chave, tipo }, false);
    return this.http.get(`${this.url}/contador/generico/${cCodigoEmpresa}/${cCodigoFilial}/${alias}`, httpOptions2);
  }
  deleteArquivo(id) {
    const httpOptions2 = this.utilService.filtrosHttpOptions({}, false);
    return this.http.delete(`${this.url}/generico/${id}`, httpOptions2);
  }
  getArquivo(id) {
    const httpOptions2 = this.utilService.filtrosHttpOptions({}, false);
    return this.http.get(`${this.url}/binario/${id}`, httpOptions2);
  }
  static {
    this.\u0275fac = function ArquivoService_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _ArquivoService)(\u0275\u0275inject(HttpClient), \u0275\u0275inject(UtilService));
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({ token: _ArquivoService, factory: _ArquivoService.\u0275fac, providedIn: "root" });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(ArquivoService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [{ type: HttpClient }, { type: UtilService }], null);
})();

// src/app/util/arquivo/util-arquivo.component.ts
function UtilArquivoComponent_Conditional_0_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 1)(1, "po-widget", 4);
    \u0275\u0275element(2, "po-info", 5)(3, "po-info", 6);
    \u0275\u0275elementEnd()();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275advance(2);
    \u0275\u0275property("p-value", ctx_r0.alias);
    \u0275\u0275advance();
    \u0275\u0275property("p-value", ctx_r0.chave);
  }
}
function UtilArquivoComponent_Conditional_3_Template(rf, ctx) {
  if (rf & 1) {
    const _r2 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-upload", 7, 0);
    \u0275\u0275listener("p-success", function UtilArquivoComponent_Conditional_3_Template_po_upload_p_success_0_listener() {
      \u0275\u0275restoreView(_r2);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.fileEnviadoSucesso());
    })("p-upload", function UtilArquivoComponent_Conditional_3_Template_po_upload_p_upload_0_listener($event) {
      \u0275\u0275restoreView(_r2);
      const ctx_r0 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r0.dadosArquivo($event));
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r0 = \u0275\u0275nextContext();
    \u0275\u0275classMapInterpolate1("po-sm-12 po-md-4 po-lg-4 ", ctx_r0.poUploadClass, "");
    \u0275\u0275property("p-label", ctx_r0.poUploadLabel)("p-drag-drop", true)("p-multiple", true)("p-auto-upload", true)("p-drag-drop-height", 5)("p-url", ctx_r0.poUploadArquivoUrl)("p-restrictions", ctx_r0.poUploadFileRestrictions);
  }
}
var UtilArquivoComponent = class _UtilArquivoComponent {
  constructor(poStorageService, poDialogService, poNotificationService, arquivoService) {
    this.poStorageService = poStorageService;
    this.poDialogService = poDialogService;
    this.poNotificationService = poNotificationService;
    this.arquivoService = arquivoService;
    this.tabelaArquivosItens = [];
    this.poUploadArquivoUrl = `${environment.urlGestaoArquivo}/api/arquivo/upload/generico/`;
    this.poUploadLabel = "Upload Arquivos";
    this.poUploadClass = "";
    this.poUploadFileRestrictions = { maxFileSize: 10485760, maxFiles: 5 };
    this.empresa = "";
    this.filial = "";
    this.alias = "";
    this.chave = "";
    this.tipo = "";
    this.podeExcluir = true;
    this.habilitaUpload = true;
    this.showIdentificador = true;
    this.tabelaArquivoColunas = [
      { property: "pk", width: "10%", label: "ID", visible: true },
      { property: "nome", width: "25%", label: "Nome", visible: true },
      { property: "created_at", width: "65%", label: "Data", type: "dateTime", visible: true }
    ];
    this.tabelaArquivoAction = [
      { label: "Download", icon: "an an-download-simple", action: this.fileDownloads.bind(this) },
      { label: "Excluir", icon: "an an-trash", action: this.fileExcluirOpenDialogConfirmar.bind(this), disabled: this.disableBotaoExcluir.bind(this) }
    ];
    this.poStorageService.get("empresaSelecionada").then((empresaSelecionada) => {
      if (empresaSelecionada) {
        this.empresa = empresaSelecionada.CM0CODIGO;
        this.filial = empresaSelecionada.CM0CODFIL;
      }
    });
  }
  setFileRestrictions(poUploadFileRestrictions) {
    this.poUploadFileRestrictions = poUploadFileRestrictions;
  }
  arquivosLoadDados(alias = this.alias, chave = this.chave, tipo = this.tipo) {
    this.alias = alias;
    this.chave = chave;
    this.tipo = tipo;
    this.tabelaArquivosItens = [];
    this.arquivoService.getListaArquivo(this.empresa, this.filial, alias, chave, tipo).subscribe({
      next: (arquivos) => {
        if (arquivos && arquivos.length) {
          this.tabelaArquivosItens = arquivos.map((arquivo) => {
            return __spreadProps(__spreadValues({}, arquivo), { link: `${environment.urlGestaoArquivo}/arquivo/generico/${arquivo.pk}` });
          });
        }
      }
    });
  }
  fileExcluirOpenDialogConfirmar(row) {
    this.poDialogService.confirm({
      title: "Excluir Arquivo",
      message: "Deseja realmente excluir o arquivo?",
      confirm: () => this.fileExcluir(row)
    });
  }
  fileExcluir(row) {
    this.arquivoService.deleteArquivo(row.pk).subscribe(() => {
      this.arquivosLoadDados(this.alias, this.chave, this.tipo);
    });
  }
  dadosArquivo(dados) {
    dados.data = {
      alias: this.alias,
      tipo: this.tipo,
      chave: this.chave,
      codigo_empresa: this.empresa,
      codigo_filial: this.filial
    };
  }
  fileEnviadoSucesso() {
    this.poNotificationService.success(`Arquivo enviado com sucesso.`);
    this.upload.clear();
    this.arquivosLoadDados(this.alias, this.chave, this.tipo);
    this.classeOrigem?.utilArquivoOnFileAdd();
  }
  fileDownloads(row) {
    window.open(row.link, "_blank");
  }
  disableBotaoExcluir() {
    return !this.podeExcluir;
  }
  ajustarChave(nova_chave) {
    let atuChave = {
      codigo_empresa: this.empresa,
      codigo_filial: this.filial,
      chave: this.chave,
      alias: this.alias,
      nova_chave
    };
    this.arquivoService.postAtualizaChaveArquivo(atuChave).subscribe({
      next: (ret) => {
        this.chave = nova_chave;
        this.arquivosLoadDados(this.alias, this.chave, this.tipo);
      }
    });
  }
  static {
    this.\u0275fac = function UtilArquivoComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _UtilArquivoComponent)(\u0275\u0275directiveInject(PoStorageService), \u0275\u0275directiveInject(PoDialogService), \u0275\u0275directiveInject(PoNotificationService), \u0275\u0275directiveInject(ArquivoService));
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _UtilArquivoComponent, selectors: [["app-util-arquivo"]], viewQuery: function UtilArquivoComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(PoUploadComponent, 5);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.upload = _t.first);
      }
    }, standalone: false, decls: 4, vars: 7, consts: [["upload", ""], [1, "po-row"], ["p-container", "", "p-spacing", "extraSmall", "p-hide-columns-manager", "true", "p-hide-table-search", "false", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-striped", "p-items", "p-columns", "p-height", "p-actions"], ["name", "upload", 3, "class", "p-label", "p-drag-drop", "p-multiple", "p-auto-upload", "p-drag-drop-height", "p-url", "p-restrictions"], ["p-title", "Identificador", 1, "po-row"], ["p-label", "Agrupador", 1, "po-sm-6", "po-md-3", "po-lg-2", 3, "p-value"], ["p-label", "Chave", 1, "po-sm-6", "po-md-3", "po-lg-2", 3, "p-value"], ["name", "upload", 3, "p-success", "p-upload", "p-label", "p-drag-drop", "p-multiple", "p-auto-upload", "p-drag-drop-height", "p-url", "p-restrictions"]], template: function UtilArquivoComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275template(0, UtilArquivoComponent_Conditional_0_Template, 4, 2, "div", 1);
        \u0275\u0275elementStart(1, "div", 1);
        \u0275\u0275element(2, "po-table", 2);
        \u0275\u0275elementEnd();
        \u0275\u0275template(3, UtilArquivoComponent_Conditional_3_Template, 2, 10, "po-upload", 3);
      }
      if (rf & 2) {
        \u0275\u0275conditional(ctx.showIdentificador ? 0 : -1);
        \u0275\u0275advance(2);
        \u0275\u0275property("p-striped", true)("p-items", ctx.tabelaArquivosItens)("p-columns", ctx.tabelaArquivoColunas)("p-height", 300)("p-actions", ctx.tabelaArquivoAction);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.habilitaUpload ? 3 : -1);
      }
    }, dependencies: [PoUploadComponent, PoInfoComponent, PoTableComponent, PoWidgetComponent], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(UtilArquivoComponent, [{
    type: Component,
    args: [{ selector: "app-util-arquivo", standalone: false, template: '@if(showIdentificador){\r\n  <div class="po-row">\r\n    <po-widget class="po-row"\r\n      p-title="Identificador"\r\n    >\r\n      <po-info class="po-sm-6 po-md-3 po-lg-2" p-label="Agrupador" [p-value]="alias"></po-info>\r\n      <po-info class="po-sm-6 po-md-3 po-lg-2" p-label="Chave" [p-value]="chave"></po-info>\r\n    </po-widget>\r\n  </div>\r\n}\r\n\r\n<div class="po-row">\r\n  <po-table class="po-sm-12 po-md-12 po-lg-12"\r\n    p-container\r\n    p-spacing="extraSmall"\r\n    [p-striped]="true"\r\n    [p-items]="tabelaArquivosItens"\r\n    [p-columns]="tabelaArquivoColunas"\r\n    [p-height]="300"\r\n    p-hide-columns-manager="true"\r\n    [p-actions]="tabelaArquivoAction"\r\n    p-hide-table-search="false"\r\n  ></po-table>\r\n</div>\r\n@if(habilitaUpload){\r\n  <po-upload #upload class="po-sm-12 po-md-4 po-lg-4 {{poUploadClass}}"\r\n    name="upload"\r\n    [p-label]="poUploadLabel"\r\n    [p-drag-drop]="true"\r\n    [p-multiple]="true"\r\n    [p-auto-upload]="true"\r\n    [p-drag-drop-height]="5"\r\n    [p-url]="poUploadArquivoUrl"\r\n    [p-restrictions]="poUploadFileRestrictions"\r\n    (p-success)="fileEnviadoSucesso()"\r\n    (p-upload)="dadosArquivo($event)"\r\n  ></po-upload>\r\n}\r\n' }]
  }], () => [{ type: PoStorageService }, { type: PoDialogService }, { type: PoNotificationService }, { type: ArquivoService }], { upload: [{
    type: ViewChild,
    args: [PoUploadComponent, { static: false }]
  }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(UtilArquivoComponent, { className: "UtilArquivoComponent", filePath: "src/app/util/arquivo/util-arquivo.component.ts", lineNumber: 13 });
})();

// src/app/login-rh/login-rh.component.ts
var import_buffer = __toESM(require_buffer());

// src/app/service/funcionario-service.ts
var FuncionarioService = class _FuncionarioService {
  constructor(httpClient, utilService) {
    this.httpClient = httpClient;
    this.utilService = utilService;
    this.url = `${environment.urlApiProtheus}/wsrgpefuncionario`;
  }
  getFuncionario(CRAMAT, filtro = {}) {
    const httpOptions2 = this.utilService.filtrosHttpOptions(filtro);
    return this.httpClient.get(`${this.url}/${CRAMAT}`, httpOptions2);
  }
  getFuncionarioLista(filtro) {
    const httpOptions2 = this.utilService.filtrosHttpOptions(filtro);
    return this.httpClient.get(`${this.url}`, httpOptions2);
  }
  static {
    this.\u0275fac = function FuncionarioService_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _FuncionarioService)(\u0275\u0275inject(HttpClient), \u0275\u0275inject(UtilService));
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({ token: _FuncionarioService, factory: _FuncionarioService.\u0275fac, providedIn: "root" });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(FuncionarioService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [{ type: HttpClient }, { type: UtilService }], null);
})();

// src/app/login-rh/login-rh.component.ts
var _c02 = ["formLogin"];
var LoginRhComponent = class _LoginRhComponent {
  constructor(authService, funcionarioService, activatedRoute, router, poStorageService) {
    this.authService = authService;
    this.funcionarioService = funcionarioService;
    this.activatedRoute = activatedRoute;
    this.router = router;
    this.poStorageService = poStorageService;
    this.attempts = 3;
    this.loginErrors = [];
    this.passwordErrors = [];
    this.loading = false;
    this.showPageBlocked = false;
    if (environment.production) {
      this.pProductName = "Portal RH INPLAC";
    } else {
      this.pProductName = "Portal RH TESTE INPLAC";
    }
    this.loginCustomField = {
      property: "empresaCodigo",
      value: "01",
      options: [
        { value: "01", label: "INPLAC" }
      ]
    };
    this.customLiterals = {
      loginPlaceholder: "CPF: Apenas N\xFAmeros",
      loginHint: "Seu usuario \xE9 seu CPF. Digite apenas os numeros Ex: 52738387039",
      loginErrorPattern: "Seu usuario \xE9 seu CPF. Digite apenas os numeros Ex: 52738387039"
    };
  }
  ngOnInit() {
    this.loading = false;
    localStorage.clear();
    this.poStorageService.clear();
    sessionStorage.clear();
    this.activatedRoute.params.subscribe((params) => {
      if ("CEMPRESA" in params) {
        this.loginCustomField.value = params.CEMPRESA;
      }
    });
  }
  checkLogin(formData) {
    this.loading = true;
    this.authService.loginFuncionario(formData.login, formData.password, formData.empresaCodigo).subscribe({
      next: (response) => {
        const tokenAssist = response.substr(response.indexOf("token=") + 6, response.indexOf("&restPort") - response.indexOf("token=") - 6);
        let aToken = tokenAssist.split("&");
        let token = "";
        if (aToken.length > 0) {
          token = aToken[0];
        }
        const aResponse = token.split(".");
        if (aResponse && aResponse.length === 3) {
          const oResponse = JSON.parse(import_buffer.Buffer.from(aResponse[1], "base64").toString());
          const { key, refresh_token } = oResponse;
          const [matricula, cpf, CCODRD0, data, filial] = key.split("|");
          localStorage.setItem("token", JSON.stringify({
            access_token: token,
            refresh_token,
            token_type: "Bearer",
            expires_in: 3600,
            last_token_refresh: (/* @__PURE__ */ new Date()).getTime() / 1e3
          }));
          localStorage.setItem("tenantid", `${formData.empresaCodigo},01`);
          this.authService.getUser().subscribe({
            next: (usuario) => {
              this.poStorageService.set("usuario", usuario);
              if (usuario.AEMPRESA) {
                this.poStorageService.set("empresaSelecionada", usuario.AEMPRESA[0]);
                localStorage.setItem("CUSRID", usuario.CUSRID);
                const { CM0CODIGO, CM0CODFIL } = usuario.AEMPRESA[0];
                localStorage.setItem("tenantid", `${CM0CODIGO},${CM0CODFIL}`);
              }
              localStorage.setItem("tipoUsuario", "funcionario");
              this.funcionarioService.getFuncionario(matricula, { CSHOW: "ALL" }).subscribe({
                next: (funcionario) => {
                  this.poStorageService.set("funcionario", funcionario);
                  localStorage.setItem("CMATRICULA", funcionario.CRAMAT);
                  localStorage.setItem("CUSUARIOPORTALCODIGO", funcionario.CRAMAT);
                  localStorage.setItem("CUSUARIOPORTALNOME", funcionario.CRANOME);
                  this.selecionaEmpresa(usuario);
                  this.poStorageService.get("redirectUrl").then((url) => this.router.navigateByUrl(url));
                },
                error: () => {
                  this.loading = false;
                  this.passwordErrors = ["Senha e/ou usu\xE1rio inv\xE1lido, verifique e tente novamente."];
                }
              });
            },
            error: () => {
              this.loading = false;
              this.passwordErrors = ["Senha e/ou usu\xE1rio inv\xE1lido, verifique e tente novamente."];
            }
          });
        } else {
          this.loading = false;
          this.passwordErrors = ["Senha e/ou usu\xE1rio inv\xE1lido, verifique e tente novamente."];
        }
      },
      error: () => {
        this.loading = false;
        this.passwordErrors = ["Senha e/ou usu\xE1rio inv\xE1lido, verifique e tente novamente."];
      }
    });
  }
  loginChange() {
    if (this.passwordErrors.length) {
      this.passwordErrors = [];
      this.loginErrors = [];
    }
  }
  selecionaEmpresa(usuario) {
    if (usuario.AEMPRESA) {
      localStorage.setItem("empresaSelecionada", JSON.stringify(usuario.AEMPRESA[0]));
      const { CM0CODIGO, CM0CODFIL } = usuario.AEMPRESA[0];
      localStorage.setItem("tenantid", `${CM0CODIGO},${CM0CODFIL}`);
      this.router.navigateByUrl("/");
    }
  }
  static {
    this.\u0275fac = function LoginRhComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _LoginRhComponent)(\u0275\u0275directiveInject(AuthService), \u0275\u0275directiveInject(FuncionarioService), \u0275\u0275directiveInject(ActivatedRoute), \u0275\u0275directiveInject(Router), \u0275\u0275directiveInject(PoStorageService));
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _LoginRhComponent, selectors: [["app-login"]], viewQuery: function LoginRhComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c02, 7);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.formLogin = _t.first);
      }
    }, standalone: false, decls: 5, vars: 7, consts: [["formLogin", ""], [1, "logoDiv"], ["alt", "main-logo", "src", "./assets/image/logo.png", 1, "logo"], ["p-login-pattern", "[0-9]{11}", 3, "p-login-change", "p-password-change", "p-login-submit", "p-hide-remember-user", "p-product-name", "p-loading", "p-password-errors", "p-login-errors", "p-custom-field", "p-literals"]], template: function LoginRhComponent_Template(rf, ctx) {
      if (rf & 1) {
        const _r1 = \u0275\u0275getCurrentView();
        \u0275\u0275elementStart(0, "div", 1);
        \u0275\u0275element(1, "img", 2);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(2, "div")(3, "po-page-login", 3, 0);
        \u0275\u0275listener("p-login-change", function LoginRhComponent_Template_po_page_login_p_login_change_3_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.loginChange());
        })("p-password-change", function LoginRhComponent_Template_po_page_login_p_password_change_3_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.loginChange());
        })("p-login-submit", function LoginRhComponent_Template_po_page_login_p_login_submit_3_listener($event) {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.checkLogin($event));
        });
        \u0275\u0275elementEnd()();
      }
      if (rf & 2) {
        \u0275\u0275advance(3);
        \u0275\u0275property("p-hide-remember-user", true)("p-product-name", ctx.pProductName)("p-loading", ctx.loading)("p-password-errors", ctx.passwordErrors)("p-login-errors", ctx.loginErrors)("p-custom-field", ctx.loginCustomField)("p-literals", ctx.customLiterals);
      }
    }, dependencies: [PoPageLoginComponent], styles: ["\n\n.logoDiv[_ngcontent-%COMP%] {\n  background-color: #29b6c5;\n  top: 50px;\n  height: 80px;\n  width: 100%;\n  margin-top: 10px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n.logo[_ngcontent-%COMP%] {\n  background-color: #29b6c5;\n  margin-top: 10px;\n  align-content: center;\n}"] });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(LoginRhComponent, [{
    type: Component,
    args: [{ selector: "app-login", standalone: false, template: '<div class="logoDiv">\r\n  <img alt="main-logo" class="logo" src="./assets/image/logo.png">\r\n</div>\r\n<div>\r\n  <po-page-login #formLogin\r\n\r\n    [p-hide-remember-user]="true"\r\n    [p-product-name]="pProductName"\r\n    [p-loading]="loading"\r\n    [p-password-errors]="passwordErrors"\r\n    [p-login-errors]="loginErrors"\r\n    (p-login-change)="loginChange()"\r\n    (p-password-change)="loginChange()"\r\n    (p-login-submit)="checkLogin($event)"\r\n    [p-custom-field]="loginCustomField"\r\n    [p-literals]="customLiterals"\r\n    p-login-pattern="[0-9]{11}"\r\n  >\r\n  </po-page-login>\r\n</div>\r\n', styles: ["/* src/app/login-rh/login-rh.component.css */\n.logoDiv {\n  background-color: #29b6c5;\n  top: 50px;\n  height: 80px;\n  width: 100%;\n  margin-top: 10px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n.logo {\n  background-color: #29b6c5;\n  margin-top: 10px;\n  align-content: center;\n}\n"] }]
  }], () => [{ type: AuthService }, { type: FuncionarioService }, { type: ActivatedRoute }, { type: Router }, { type: PoStorageService }], { formLogin: [{
    type: ViewChild,
    args: ["formLogin", { static: true }]
  }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(LoginRhComponent, { className: "LoginRhComponent", filePath: "src/app/login-rh/login-rh.component.ts", lineNumber: 19 });
})();

// src/app/interface/saude-guia.ts
var defaultSaudeGuiaListDto = () => {
  return __spreadProps(__spreadValues({}, defaultSaudeGuia()), {
    CTOGNOME: "",
    CRANOME: "",
    CDEPAGR_NOME: "",
    CCLINICA_NOME: ""
  });
};
var defaultSaudeGuia = () => {
  return {
    CZGACODIGO: "",
    CZGACHAVE: "",
    CZGACODCON: "",
    CZGACODDEP: "",
    CZGATIPO: "",
    CZGACOMPET: "",
    CZGASTATUS: "2",
    CZGAUSUINC: "",
    CZGAUSUCON: "",
    CZGAESPECI: "",
    CZGATPGUIA: "C",
    CZGADESFUN: "",
    CZGAHRCONS: "",
    CZGACLINIC: "",
    DZGADTINC: void 0,
    DZGADTCONS: void 0,
    DZGADTCONF: void 0
  };
};
var defaultSaudeGuiaHistorico = () => {
  return {
    COBSERVACAO: "",
    CUSUARIO: localStorage.getItem("CUSUARIOPORTALCODIGO") || "",
    CENTIDADE: localStorage.getItem("tipoUsuario") || ""
  };
};

// src/app/filter/filtro-lista.ts
var import_buffer2 = __toESM(require_buffer());
var FiltroLista = class {
  constructor(authUserPreferencesService, par_chave, par_timeout = "") {
    this.authUserPreferencesService = authUserPreferencesService;
    this.par_chave = par_chave;
    this.par_timeout = par_timeout;
    this.dadoOriginal = {};
    this.id = 0;
    this.auth_user_id = "";
    this.chave = "";
    this.timeout = "";
    this.getData = (dias) => {
      const data = /* @__PURE__ */ new Date();
      data.setDate(data.getDate() + dias);
      return data;
    };
    this.getDataString = (dias) => {
      const data = /* @__PURE__ */ new Date();
      data.setDate(data.getDate() + dias);
      return data.toISOString().substring(0, 10);
    };
    this.chave = par_chave;
    this.timeout = par_timeout;
  }
  init() {
    return __async(this, null, function* () {
      this.auth_user_id = (yield this.authUserPreferencesService.getUsuarioSessao()).CUSRID;
      let tipoUsuario = localStorage.getItem("tipoUsuario");
      if (tipoUsuario === "funcionario") {
        this.auth_user_id += `-${localStorage.getItem("CMATRICULA")}`;
      } else if (tipoUsuario === "fornecedor") {
        this.auth_user_id += `-${localStorage.getItem("CFORNECEDOR")}`;
      }
      return new Promise((resolve, reject) => {
        this.authUserPreferencesService.getUserChave(this.auth_user_id, this.chave).subscribe({
          next: (ret) => {
            if (ret.timeout >= this.timeout) {
              let dadosRetorno = ret.dados.split("'").join('"');
              this.dados = JSON.parse(dadosRetorno);
              this.dadoOriginal = JSON.parse(dadosRetorno);
            } else {
              this.dados = this.setDefault();
            }
            this.id = ret.id;
            resolve(true);
          },
          error: () => {
            this.dados = this.setDefault();
            resolve(true);
          }
        });
      });
    });
  }
  postSalvarFiltro() {
    if (JSON.stringify(this.dados) != JSON.stringify(this.dadoOriginal)) {
      let dadosEnviar = {
        id: this.id,
        auth_user_id: this.auth_user_id,
        chave: this.chave,
        timeout: this.timeout,
        dados: import_buffer2.Buffer.from(JSON.stringify(this.dados)).toString("base64")
      };
      this.authUserPreferencesService.post(dadosEnviar).subscribe({
        next: (ret) => {
          this.id = ret.id;
        }
      });
    }
  }
};

// src/app/filter/filtro-saude-guia.ts
var FiltroSaudeGuiaLista = class extends FiltroLista {
  constructor() {
    super(...arguments);
    this.dados = this.setDefault();
    this.timeout = this.getDataString(0);
    this.CZGASTATUS_IN = [
      { value: "1", label: "Confirmado" },
      { value: "2", label: "Pendente" },
      { value: "3", label: "Cancelado" }
    ];
  }
  setDefault() {
    return {
      page: 1,
      pageSize: 10,
      filter: void 0,
      order: void 0,
      CZGACODIGO: "",
      CZGACLINIC: "",
      CZGACODCON: "",
      CZGACODDEP: "",
      CZGATIPO: "",
      CZGATPGUIA: "",
      CZGACOMPET: "",
      CZGASTATUS_IN: [],
      CZGASTATUS_NOTIN: [],
      deate_DZGADTINC: { start: "", end: "" },
      deate_DZGADTCONS: { start: this.getDataString(-10), end: this.getDataString(30) },
      deate_DZGADTCONF: { start: "", end: "" }
    };
  }
};

// src/app/service/saude.service.ts
var GpeSaudeService = class _GpeSaudeService {
  constructor(httpClient, utilService) {
    this.httpClient = httpClient;
    this.utilService = utilService;
    this.url = `${environment.urlApiProtheus}/wsrgpesaude`;
  }
  getGpeSaudeGuia(CZGACODIGO, CZGACHAVE, filteredParams = {}) {
    const httpOptions2 = this.utilService.filtrosHttpOptions(filteredParams);
    return this.httpClient.get(`${this.url}/guia/${CZGACODIGO}/${CZGACHAVE}`, httpOptions2);
  }
  getGpeSaudeGuiaLista(filtro) {
    const httpOptions2 = this.utilService.filtrosHttpOptions(filtro);
    return this.httpClient.get(`${this.url}/guia`, httpOptions2);
  }
  postGpeSaudeGuia(dados) {
    const httpOptions2 = this.utilService.filtrosHttpOptions({});
    return this.httpClient.post(`${this.url}/guia`, dados, httpOptions2);
  }
  postGpeSaudeGuiaStatus(CZGACODIGO, CZGACHAVE, CZGASTATUS, dados) {
    const httpOptions2 = this.utilService.filtrosHttpOptions({});
    return this.httpClient.post(`${this.url}/guia/status/${CZGACODIGO}/${CZGACHAVE}/${CZGASTATUS}`, dados, httpOptions2);
  }
  getGpeSaudeEspecialidade(value, filteredParams = {}) {
    const httpOptions2 = this.utilService.filtrosHttpOptions(filteredParams);
    return this.httpClient.get(`${this.url}/especialidade/${value}`, httpOptions2);
  }
  getGpeSaudeEspecialidadeLista(filtro) {
    const httpOptions2 = this.utilService.filtrosHttpOptions(filtro);
    return this.httpClient.get(`${this.url}/especialidade`, httpOptions2);
  }
  getGpeSaudeConveniado(CZGACODCON, filteredParams = {}) {
    const httpOptions2 = this.utilService.filtrosHttpOptions(filteredParams);
    return this.httpClient.get(`${this.url}/conveniado/${CZGACODCON}`, httpOptions2);
  }
  getGpeSaudeConveniadoLista(filtro) {
    const httpOptions2 = this.utilService.filtrosHttpOptions(filtro);
    return this.httpClient.get(`${this.url}/conveniado`, httpOptions2);
  }
  getGpeSaudeGuiaValidarCancelamento(CZGACODIGO, CZGACHAVE) {
    const httpOptions2 = this.utilService.filtrosHttpOptions({});
    return this.httpClient.get(`${this.url}/guia/validar-cancelamento/${CZGACODIGO}/${CZGACHAVE}`, httpOptions2);
  }
  getGpeSaudeRelatorioFechamentoPdfXlsSmartView(filtro, fileExtension) {
    const httpOptions2 = this.utilService.filtrosHttpOptions(filtro);
    httpOptions2.responseType = "blob";
    return this.httpClient.get(`${this.url}/relatorio/fechamento/${fileExtension}`, httpOptions2);
  }
  getGpeSaudePlanoArefi(filtro) {
    const httpOptions2 = this.utilService.filtrosHttpOptions(filtro);
    return this.httpClient.get(`${this.url}/resumo-arefi`, httpOptions2);
  }
  getGpeSaudeArefiFile(CRAMAT, CDATA, CEXTENSION) {
    const httpOptions2 = {
      responseType: "blob",
      headers: new HttpHeaders({
        "X-PO-Screen-Lock": "true"
      }),
      params: new HttpParams()
    };
    return this.httpClient.get(`${this.url}/relatorio/resumo-arefi/${CRAMAT}/${CDATA}/${CEXTENSION}`, httpOptions2);
  }
  statusGuiaDescricao(CZGASTATUS) {
    if (CZGASTATUS === "1") {
      return "Confirmada";
    } else if (CZGASTATUS === "2") {
      return "Pendente";
    } else if (CZGASTATUS === "3") {
      return "Cancelada";
    } else {
      return "";
    }
  }
  statusGuiaColor(CZGASTATUS) {
    if (CZGASTATUS === "1") {
      return "color-10";
    } else if (CZGASTATUS === "2") {
      return "color-01";
    } else if (CZGASTATUS === "3") {
      return "color-07";
    } else {
      return "";
    }
  }
  tipoGuiaDescricao(CZGATIPO) {
    if (CZGATIPO === "1") {
      return "Titular";
    } else if (CZGATIPO === "2") {
      return "Dependente";
    } else if (CZGATIPO === "3") {
      return "Agregado";
    } else {
      return "";
    }
  }
  tipoGuiaColor(CZGATIPO) {
    if (CZGATIPO === "1") {
      return "color-10";
    } else if (CZGATIPO === "2") {
      return "color-01";
    } else if (CZGATIPO === "3") {
      return "color-07";
    } else {
      return "";
    }
  }
  static {
    this.\u0275fac = function GpeSaudeService_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _GpeSaudeService)(\u0275\u0275inject(HttpClient), \u0275\u0275inject(UtilService));
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({ token: _GpeSaudeService, factory: _GpeSaudeService.\u0275fac, providedIn: "root" });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(GpeSaudeService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [{ type: HttpClient }, { type: UtilService }], null);
})();

// src/app/interface/usuario.ts
var defaultUsuario = () => {
  return {
    CUSRID: "",
    CUSRNOME: "",
    CUSREMAIL: "",
    CUSRCODIGO: "",
    AEMPRESA: [],
    AGRUPO: [],
    APRIVILEGIO: []
  };
};
var defaultUserFornecedorChangePassword = () => {
  return {
    CRD0CODIGO: "",
    CRD0PORTAL: "",
    CCURRENTPASSWORD: "",
    CNEWPASSWORD: ""
  };
};

// src/app/service/auth-user-preferences.service.ts
var httpOptions = {
  headers: new HttpHeaders({
    "X-PO-Screen-Lock": "true",
    "X-PO-No-Message": "true"
  }),
  params: new HttpParams()
};
var AuthUserPreferencesService = class _AuthUserPreferencesService {
  constructor(http, poStorageService) {
    this.http = http;
    this.poStorageService = poStorageService;
    this.url = `${environment.urlGestaoArquivo}/api/auth/user/preference`;
  }
  getUserChave(userId, chave) {
    return this.http.get(`${this.url}/${userId}/${chave}`, httpOptions);
  }
  post(dados) {
    return this.http.post(`${this.url}`, dados, httpOptions);
  }
  getUsuarioSessao() {
    return __async(this, null, function* () {
      return new Promise((resolve, reject) => {
        this.poStorageService.get("usuario").then((usuario) => {
          if (usuario) {
            resolve(usuario);
          } else {
            resolve(defaultUsuario());
          }
        });
      });
    });
  }
  static {
    this.\u0275fac = function AuthUserPreferencesService_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _AuthUserPreferencesService)(\u0275\u0275inject(HttpClient), \u0275\u0275inject(PoStorageService));
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({ token: _AuthUserPreferencesService, factory: _AuthUserPreferencesService.\u0275fac, providedIn: "root" });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(AuthUserPreferencesService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [{ type: HttpClient }, { type: PoStorageService }], null);
})();

// src/app/rh/saude/guia/lista/saude-guia-lista.component.ts
var _c03 = ["advancedFilterModal"];
var _c110 = ["modalConfirmarCancelar"];
function SaudeGuiaListaComponent_Conditional_1_Template(rf, ctx) {
  if (rf & 1) {
    const _r2 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-table", 24);
    \u0275\u0275listener("p-show-more", function SaudeGuiaListaComponent_Conditional_1_Template_po_table_p_show_more_0_listener() {
      \u0275\u0275restoreView(_r2);
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.loadDados(false));
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275property("p-items", ctx_r2.tabelaPrincipalItems)("p-columns", ctx_r2.tabelaPrincipalColumns)("p-actions", ctx_r2.tabelaPrincipalActions)("p-sort", true)("p-striped", true)("p-filter-type", ctx_r2.PoSearchFilterMode)("p-show-more-disabled", ctx_r2.tabelaPrincipalShowMore);
  }
}
function SaudeGuiaListaComponent_Conditional_2_ng_template_1_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 12);
    \u0275\u0275element(1, "po-info", 13);
    \u0275\u0275pipe(2, "date");
    \u0275\u0275element(3, "po-tag", 14)(4, "po-info", 15)(5, "po-info", 16);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const item_r5 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext(2);
    \u0275\u0275advance();
    \u0275\u0275propertyInterpolate("p-value", \u0275\u0275pipeBind2(2, 5, item_r5.DZGADTCONS, "dd/MM/Y"));
    \u0275\u0275advance(2);
    \u0275\u0275property("p-value", ctx_r2.gpeSaudeService.statusGuiaDescricao(item_r5.CZGASTATUS))("p-color", ctx_r2.gpeSaudeService.statusGuiaColor(item_r5.CZGASTATUS));
    \u0275\u0275advance();
    \u0275\u0275propertyInterpolate("p-value", item_r5.CCLINICA_NOME);
    \u0275\u0275advance();
    \u0275\u0275propertyInterpolate("p-value", item_r5.CTOGNOME);
  }
}
function SaudeGuiaListaComponent_Conditional_2_ng_template_2_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-info", 18);
  }
  if (rf & 2) {
    const item_r6 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275propertyInterpolate("p-value", item_r6.CDEPAGR_NOME);
  }
}
function SaudeGuiaListaComponent_Conditional_2_ng_template_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 12);
    \u0275\u0275element(1, "po-info", 17);
    \u0275\u0275template(2, SaudeGuiaListaComponent_Conditional_2_ng_template_2_Conditional_2_Template, 1, 1, "po-info", 18);
    \u0275\u0275element(3, "po-info", 19);
    \u0275\u0275pipe(4, "date");
    \u0275\u0275element(5, "po-info", 20);
    \u0275\u0275pipe(6, "date");
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const item_r6 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275propertyInterpolate("p-value", item_r6.CRANOME);
    \u0275\u0275advance();
    \u0275\u0275conditional(item_r6.CZGATIPO !== "1" ? 2 : -1);
    \u0275\u0275advance();
    \u0275\u0275propertyInterpolate("p-value", \u0275\u0275pipeBind2(4, 4, item_r6.DZGADTINC, "dd/MM/Y"));
    \u0275\u0275advance(2);
    \u0275\u0275propertyInterpolate("p-value", \u0275\u0275pipeBind2(6, 7, item_r6.DZGADTCONF, "dd/MM/Y"));
  }
}
function SaudeGuiaListaComponent_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    const _r4 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-list-view", 25);
    \u0275\u0275listener("p-show-more", function SaudeGuiaListaComponent_Conditional_2_Template_po_list_view_p_show_more_0_listener() {
      \u0275\u0275restoreView(_r4);
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.loadDados(false));
    });
    \u0275\u0275template(1, SaudeGuiaListaComponent_Conditional_2_ng_template_1_Template, 6, 8, "ng-template", 26)(2, SaudeGuiaListaComponent_Conditional_2_ng_template_2_Template, 7, 10, "ng-template", 27);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275property("p-items", ctx_r2.tabelaPrincipalItems)("p-show-more-disabled", ctx_r2.tabelaPrincipalShowMore)("p-actions", ctx_r2.tabelaPrincipalActions);
  }
}
function SaudeGuiaListaComponent_Conditional_22_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-info", 18);
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275propertyInterpolate("p-value", ctx_r2.guia.CDEPAGR_NOME);
  }
}
var SaudeGuiaListaComponent = class _SaudeGuiaListaComponent {
  constructor(router, poNotificationService, gpeSaudeService, authUserPreferencesService, angularDeviceInformationService) {
    this.router = router;
    this.poNotificationService = poNotificationService;
    this.gpeSaudeService = gpeSaudeService;
    this.authUserPreferencesService = authUserPreferencesService;
    this.angularDeviceInformationService = angularDeviceInformationService;
    this.tabelaPrincipalItems = [];
    this.tabelaPrincipalShowMore = false;
    this.PoSearchFilterMode = PoSearchFilterMode.contains;
    this.showTable = true;
    this.matriculaFuncionario = "";
    this.clinica = "";
    this.modalConfirmarCancelarTitle = "";
    this.modalConfirmarCancelarStatus = "";
    this.guia = defaultSaudeGuiaListDto();
    this.tipoUsuario = "";
    this.dadosHistorico = defaultSaudeGuiaHistorico();
    this.breadcrumb = {
      items: [
        { label: "Home", action: this.goHome.bind(this) },
        { label: "Guia M\xE9dica" }
      ]
    };
    this.pageActions = [
      { label: "Nova Guia", icon: "an an-calendar-dots", action: this.novaGuia.bind(this) }
    ];
    this.tabelaPrincipalColumns = [
      {
        property: "CZGASTATUS",
        label: "Status",
        width: "8%",
        type: "label",
        visible: true,
        labels: [
          { value: "1", color: "color-10", label: "Confirmado" },
          { value: "2", color: "color-01", label: "Pendente" },
          { value: "3", color: "color-07", label: "Cancelado" }
        ]
      },
      { property: "CZGACODIGO", label: "C\xF3digo", width: "8%", visible: true },
      {
        property: "CZGATIPO",
        label: "Tipo",
        width: "5%",
        type: "subtitle",
        visible: true,
        subtitles: [
          { value: "1", content: "T", color: "color-10", label: "Titular" },
          { value: "2", content: "D", color: "color-01", label: "Dependente" },
          { value: "3", content: "A", color: "color-05", label: "Agregado" }
        ]
      },
      { property: "CRANOME", label: "T\xEDtular", width: "15%", visible: true },
      { property: "CDEPAGR_NOME", label: "Dependente/Agregado", width: "15%", visible: true },
      { property: "DZGADTINC", label: "Emiss\xE3o", width: "8%", visible: true, type: "date" },
      { property: "CTOGNOME", label: "Especialidade", width: "15%", visible: true },
      { property: "DZGADTCONS", label: "Consulta", width: "8%", visible: true, type: "date" },
      { property: "CCLINICA_NOME", label: "Cl\xEDnica", width: "15%", visible: true }
    ];
    this.tabelaPrincipalActions = [
      { label: "Visualizar", icon: "an an-eye", action: this.visualizarGuia.bind(this) },
      { label: "Cancelar", icon: "an an-trash", action: this.cancelarGuiaValidar.bind(this) },
      { label: "Confirmar", icon: "an an-calendar-check", action: this.confirmarGuiaOpenModal.bind(this), visible: this.confirmarGuiaVisible.bind(this) }
    ];
    this.filterSettings = {
      advancedAction: this.advancedFilterActionModal.bind(this)
    };
    this.advancedFilterPrimaryAction = {
      action: () => {
        this.advancedFilterModal.close();
        this.loadDados();
      },
      label: "Aplicar Filtros"
    };
    this.advancedFilterSecondaryAction = {
      action: () => {
        this.tabelaPrincipalFiltro.dados = this.tabelaPrincipalFiltro.setDefault();
        if (this.matriculaFuncionario) {
          this.tabelaPrincipalFiltro.dados.CZGACODCON = this.matriculaFuncionario;
        }
        if (this.clinica) {
          this.tabelaPrincipalFiltro.dados.CZGACLINIC = this.clinica;
        }
      },
      label: "Limpar Filtros"
    };
    this.tabelaPrincipalFiltro = new FiltroSaudeGuiaLista(authUserPreferencesService, "filtro-saude-guia-lista");
  }
  ngOnInit() {
    return __async(this, null, function* () {
      this.matriculaFuncionario = localStorage.getItem("CMATRICULA") || "";
      this.clinica = localStorage.getItem("CCLINICA") || "";
      this.tipoUsuario = localStorage.getItem("tipoUsuario") || "";
      this.showTable = this.angularDeviceInformationService.isDesktop();
      this.tabelaPrincipalFiltro.init().then(() => {
        this.loadDados();
      });
    });
  }
  loadDados(zerarPaginacao = true) {
    if (this.matriculaFuncionario) {
      this.tabelaPrincipalFiltro.dados.CZGACODCON = this.matriculaFuncionario;
    }
    if (this.clinica) {
      this.tabelaPrincipalFiltro.dados.CZGACLINIC = this.clinica;
    }
    if (zerarPaginacao) {
      this.tabelaPrincipalFiltro.dados.page = 1;
      this.tabelaPrincipalItems = [];
    } else {
      this.tabelaPrincipalFiltro.dados.page++;
    }
    this.tabelaPrincipalFiltro.postSalvarFiltro();
    this.gpeSaudeService.getGpeSaudeGuiaLista(this.tabelaPrincipalFiltro.dados).subscribe({
      next: (retorno) => {
        this.tabelaPrincipalItems = [...this.tabelaPrincipalItems, ...retorno.items];
        this.tabelaPrincipalShowMore = !retorno.hasNext;
      }
    });
  }
  novaGuia() {
    this.router.navigate(["/rh/saude/guia/crud"]);
  }
  visualizarGuia(row) {
    this.router.navigate([`/rh/saude/guia/crud/${row.CZGACODIGO}/${row.CZGACHAVE}`]);
  }
  cancelarGuiaValidar(row) {
    if (this.tipoUsuario === "fornecedor" && ["2", "1"].includes(row.CZGASTATUS)) {
      this.cancelarGuiaOpenModal(row);
    } else if (this.tipoUsuario !== "fornecedor" && row.CZGASTATUS === "2") {
      this.gpeSaudeService.getGpeSaudeGuiaValidarCancelamento(row.CZGACODIGO, row.CZGACHAVE).subscribe({
        next: (ret) => {
          this.cancelarGuiaOpenModal(row);
        },
        error: (erro) => {
          this.poNotificationService.warning({
            message: "Esta guia n\xE3o poder\xE1 mais ser cancelada.",
            duration: 5e3
          });
        }
      });
    } else {
      this.poNotificationService.warning({
        message: "Esta guia n\xE3o poder\xE1 mais ser cancelada.",
        duration: 5e3
      });
    }
  }
  confirmarGuiaVisible(row) {
    return this.tipoUsuario === "fornecedor" && row.CZGASTATUS === "2";
  }
  cancelarGuiaOpenModal(row) {
    this.dadosHistorico = defaultSaudeGuiaHistorico();
    this.guia = row;
    this.modalConfirmarCancelarTitle = "Cancelar";
    this.modalConfirmarCancelarStatus = "3";
    this.modalConfirmarCancelar.open();
  }
  confirmarGuiaOpenModal(row) {
    this.dadosHistorico = defaultSaudeGuiaHistorico();
    this.guia = row;
    this.modalConfirmarCancelarTitle = "Confirmar";
    this.modalConfirmarCancelarStatus = "1";
    this.modalConfirmarCancelar.open();
  }
  confirmarCancelarGuiaGravar() {
    this.gpeSaudeService.postGpeSaudeGuiaStatus(this.guia.CZGACODIGO, this.guia.CZGACHAVE, this.modalConfirmarCancelarStatus, this.dadosHistorico).subscribe({
      next: () => {
        this.loadDados();
        this.modalConfirmarCancelar.close();
      }
    });
  }
  goHome() {
    this.router.navigate(["/"]);
  }
  advancedFilterActionModal() {
    this.advancedFilterModal.open();
  }
  static {
    this.\u0275fac = function SaudeGuiaListaComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _SaudeGuiaListaComponent)(\u0275\u0275directiveInject(Router), \u0275\u0275directiveInject(PoNotificationService), \u0275\u0275directiveInject(GpeSaudeService), \u0275\u0275directiveInject(AuthUserPreferencesService), \u0275\u0275directiveInject(AngularDeviceInformationService));
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _SaudeGuiaListaComponent, selectors: [["app-saude-guia-lista"]], viewQuery: function SaudeGuiaListaComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c03, 7);
        \u0275\u0275viewQuery(_c110, 7);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.advancedFilterModal = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.modalConfirmarCancelar = _t.first);
      }
    }, standalone: false, decls: 32, vars: 41, consts: [["advancedFilterModal", ""], ["modalConfirmarCancelar", ""], ["modalConfirmarCancelarForm", "ngForm"], ["p-title", "Guia M\xE9dica", 3, "p-breadcrumb", "p-filter", "p-actions"], ["p-spacing", "extraSmall", "p-height", "500", "p-hide-table-search", "false", "p-hide-columns-manager", "true", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-items", "p-columns", "p-actions", "p-sort", "p-striped", "p-filter-type", "p-show-more-disabled"], ["p-property-title", "CZGACODIGO", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-items", "p-show-more-disabled", "p-actions"], ["p-title", "Filtro", 3, "p-primary-action", "p-secondary-action"], ["p-label", "Conveniado", "name", "CZGACODCON", 1, "po-sm-6", "po-md-3", "po-lg-2", 3, "ngModelChange", "ngModel", "p-maxlength", "p-disabled"], ["p-label", "Situa\xE7\xE3o", "name", "CZGASTATUS_IN", 1, "po-sm-12", "po-md-4", "po-lg-3", 3, "ngModelChange", "ngModel", "p-options"], ["name", "deate_DZGADTINC", "p-label", "Inclus\xE3o de at\xE9:", "p-format", "dd/mm/yyyy", 1, "po-sm-12", "po-md-6", "po-lg-6", 3, "ngModelChange", "ngModel"], ["name", "deate_DZGADTCONS", "p-label", "Consulta de at\xE9:", "p-format", "dd/mm/yyyy", 1, "po-sm-12", "po-md-6", "po-lg-6", 3, "ngModelChange", "ngModel"], [3, "p-title"], [1, "po-row"], ["p-label", "Data da Consulta", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-value"], ["p-label", "Status", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-value", "p-color"], ["p-label", "Cl\xEDnica", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-value"], ["p-label", "Especialidade", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-value"], ["p-label", "Titular", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-value"], ["p-label", "Dependente", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-value"], ["p-label", "Inclus\xE3o", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-value"], ["p-label", "Confirma\xE7\xE3o", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-value"], ["p-label", "Observa\xE7\xE3o", "name", "COBSERVACAO", "p-show-required", "true", "p-placeholder", "Caso seja um cancelamento, informe uma observa\xE7\xE3o com no m\xEDnimo 10 caracteres!", 3, "ngModelChange", "ngModel", "p-required", "p-minlength"], [1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-click", "p-label", "p-disabled", "p-danger"], ["p-label", "Sair", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-click"], ["p-spacing", "extraSmall", "p-height", "500", "p-hide-table-search", "false", "p-hide-columns-manager", "true", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-show-more", "p-items", "p-columns", "p-actions", "p-sort", "p-striped", "p-filter-type", "p-show-more-disabled"], ["p-property-title", "CZGACODIGO", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-show-more", "p-items", "p-show-more-disabled", "p-actions"], ["p-list-view-content-template", ""], ["p-list-view-detail-template", ""]], template: function SaudeGuiaListaComponent_Template(rf, ctx) {
      if (rf & 1) {
        const _r1 = \u0275\u0275getCurrentView();
        \u0275\u0275elementStart(0, "po-page-list", 3);
        \u0275\u0275template(1, SaudeGuiaListaComponent_Conditional_1_Template, 1, 7, "po-table", 4)(2, SaudeGuiaListaComponent_Conditional_2_Template, 3, 3, "po-list-view", 5);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(3, "po-modal", 6, 0)(5, "po-input", 7);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeGuiaListaComponent_Template_po_input_ngModelChange_5_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.tabelaPrincipalFiltro.dados.CZGACODCON, $event) || (ctx.tabelaPrincipalFiltro.dados.CZGACODCON = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(6, "po-multiselect", 8);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeGuiaListaComponent_Template_po_multiselect_ngModelChange_6_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.tabelaPrincipalFiltro.dados.CZGASTATUS_IN, $event) || (ctx.tabelaPrincipalFiltro.dados.CZGASTATUS_IN = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(7, "po-datepicker-range", 9);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeGuiaListaComponent_Template_po_datepicker_range_ngModelChange_7_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.tabelaPrincipalFiltro.dados.deate_DZGADTINC, $event) || (ctx.tabelaPrincipalFiltro.dados.deate_DZGADTINC = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(8, "po-datepicker-range", 10);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeGuiaListaComponent_Template_po_datepicker_range_ngModelChange_8_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.tabelaPrincipalFiltro.dados.deate_DZGADTCONS, $event) || (ctx.tabelaPrincipalFiltro.dados.deate_DZGADTCONS = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(9, "po-modal", 11, 1)(11, "form", null, 2)(13, "po-widget")(14, "div", 12);
        \u0275\u0275element(15, "po-info", 13);
        \u0275\u0275pipe(16, "date");
        \u0275\u0275element(17, "po-tag", 14)(18, "po-info", 15)(19, "po-info", 16);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(20, "div", 12);
        \u0275\u0275element(21, "po-info", 17);
        \u0275\u0275template(22, SaudeGuiaListaComponent_Conditional_22_Template, 1, 1, "po-info", 18);
        \u0275\u0275element(23, "po-info", 19);
        \u0275\u0275pipe(24, "date");
        \u0275\u0275element(25, "po-info", 20);
        \u0275\u0275pipe(26, "date");
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(27, "po-textarea", 21);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeGuiaListaComponent_Template_po_textarea_ngModelChange_27_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.dadosHistorico.COBSERVACAO, $event) || (ctx.dadosHistorico.COBSERVACAO = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(28, "po-modal-footer")(29, "po-button", 22);
        \u0275\u0275listener("p-click", function SaudeGuiaListaComponent_Template_po_button_p_click_29_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.confirmarCancelarGuiaGravar());
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(30, "po-button", 23);
        \u0275\u0275listener("p-click", function SaudeGuiaListaComponent_Template_po_button_p_click_30_listener() {
          \u0275\u0275restoreView(_r1);
          const modalConfirmarCancelar_r7 = \u0275\u0275reference(10);
          return \u0275\u0275resetView(modalConfirmarCancelar_r7.close());
        });
        \u0275\u0275elementEnd();
        \u0275\u0275text(31, " >");
        \u0275\u0275elementEnd()();
      }
      if (rf & 2) {
        const modalConfirmarCancelarForm_r8 = \u0275\u0275reference(12);
        \u0275\u0275property("p-breadcrumb", ctx.breadcrumb)("p-filter", ctx.filterSettings)("p-actions", ctx.pageActions);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.showTable ? 1 : 2);
        \u0275\u0275advance(2);
        \u0275\u0275property("p-primary-action", ctx.advancedFilterPrimaryAction)("p-secondary-action", ctx.advancedFilterSecondaryAction);
        \u0275\u0275advance(2);
        \u0275\u0275twoWayProperty("ngModel", ctx.tabelaPrincipalFiltro.dados.CZGACODCON);
        \u0275\u0275property("p-maxlength", 6)("p-disabled", ctx.matriculaFuncionario !== "");
        \u0275\u0275advance();
        \u0275\u0275twoWayProperty("ngModel", ctx.tabelaPrincipalFiltro.dados.CZGASTATUS_IN);
        \u0275\u0275property("p-options", ctx.tabelaPrincipalFiltro.CZGASTATUS_IN);
        \u0275\u0275advance();
        \u0275\u0275twoWayProperty("ngModel", ctx.tabelaPrincipalFiltro.dados.deate_DZGADTINC);
        \u0275\u0275advance();
        \u0275\u0275twoWayProperty("ngModel", ctx.tabelaPrincipalFiltro.dados.deate_DZGADTCONS);
        \u0275\u0275advance();
        \u0275\u0275propertyInterpolate2("p-title", "", ctx.modalConfirmarCancelarTitle, " Guia #", ctx.guia.CZGACODIGO, "");
        \u0275\u0275advance(6);
        \u0275\u0275propertyInterpolate("p-value", \u0275\u0275pipeBind2(16, 32, ctx.guia.DZGADTCONS, "dd/MM/Y"));
        \u0275\u0275advance(2);
        \u0275\u0275property("p-value", ctx.gpeSaudeService.statusGuiaDescricao(ctx.guia.CZGASTATUS))("p-color", ctx.gpeSaudeService.statusGuiaColor(ctx.guia.CZGASTATUS));
        \u0275\u0275advance();
        \u0275\u0275propertyInterpolate("p-value", ctx.guia.CCLINICA_NOME);
        \u0275\u0275advance();
        \u0275\u0275propertyInterpolate("p-value", ctx.guia.CTOGNOME);
        \u0275\u0275advance(2);
        \u0275\u0275propertyInterpolate("p-value", ctx.guia.CRANOME);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.guia.CZGATIPO !== "1" ? 22 : -1);
        \u0275\u0275advance();
        \u0275\u0275propertyInterpolate("p-value", \u0275\u0275pipeBind2(24, 35, ctx.guia.DZGADTINC, "dd/MM/Y"));
        \u0275\u0275advance(2);
        \u0275\u0275propertyInterpolate("p-value", \u0275\u0275pipeBind2(26, 38, ctx.guia.DZGADTCONF, "dd/MM/Y"));
        \u0275\u0275advance(2);
        \u0275\u0275twoWayProperty("ngModel", ctx.dadosHistorico.COBSERVACAO);
        \u0275\u0275property("p-required", ctx.modalConfirmarCancelarStatus === "3")("p-minlength", ctx.modalConfirmarCancelarStatus === "3" ? 10 : 0);
        \u0275\u0275advance(2);
        \u0275\u0275propertyInterpolate1("p-label", "", ctx.modalConfirmarCancelarTitle, " Guia");
        \u0275\u0275property("p-disabled", modalConfirmarCancelarForm_r8.invalid)("p-danger", ctx.modalConfirmarCancelarStatus === "3");
      }
    }, dependencies: [PoButtonComponent, PoDatepickerRangeComponent, PoInputComponent, PoMultiselectComponent, PoTextareaComponent, PoTagComponent, PoInfoComponent, PoListViewComponent, PoListViewContentTemplateDirective, PoListViewDetailTemplateDirective, PoModalComponent, PoModalFooterComponent, PoPageListComponent, PoTableComponent, PoWidgetComponent, \u0275NgNoValidate, NgControlStatus, NgControlStatusGroup, NgModel, NgForm, DatePipe], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(SaudeGuiaListaComponent, [{
    type: Component,
    args: [{ selector: "app-saude-guia-lista", standalone: false, template: `<po-page-list\r
  p-title="Guia M\xE9dica"\r
  [p-breadcrumb]="breadcrumb"\r
  [p-filter]="filterSettings"\r
  [p-actions]="pageActions"\r
>\r
  @if(showTable){\r
    <po-table class="po-sm-12 po-md-12 po-lg-12"\r
      [p-items]="tabelaPrincipalItems"\r
      [p-columns]="tabelaPrincipalColumns"\r
      [p-actions]="tabelaPrincipalActions"\r
      [p-sort]="true"\r
      p-spacing="extraSmall"\r
      [p-striped]="true"\r
      [p-filter-type]="PoSearchFilterMode"\r
      p-height="500"\r
      p-hide-table-search="false"\r
      p-hide-columns-manager="true"\r
      (p-show-more)="loadDados(false)"\r
      [p-show-more-disabled]="tabelaPrincipalShowMore"\r
    ></po-table>\r
  } @else {\r
    <po-list-view class="po-sm-12 po-md-12 po-lg-12"\r
        p-property-title="CZGACODIGO"\r
        [p-items]="tabelaPrincipalItems"\r
        (p-show-more)="loadDados(false)"\r
        [p-show-more-disabled]="tabelaPrincipalShowMore"\r
        [p-actions]="tabelaPrincipalActions"\r
      >\r
        <ng-template p-list-view-content-template let-item>\r
          <div class="po-row">\r
            <po-info class="po-sm-6 po-md-6 po-lg-6" p-label="Data da Consulta"    p-value="{{item.DZGADTCONS | date: 'dd/MM/Y'}}"></po-info>\r
            <po-tag class="po-sm-6 po-md-6 po-lg-6" p-label="Status" [p-value]="gpeSaudeService.statusGuiaDescricao(item.CZGASTATUS)" [p-color]="gpeSaudeService.statusGuiaColor(item.CZGASTATUS)"></po-tag>\r
            <po-info class="po-sm-12 po-md-12 po-lg-12" p-label="Cl\xEDnica" p-value="{{item.CCLINICA_NOME}}"></po-info>\r
            <po-info class="po-sm-12 po-md-12 po-lg-12" p-label="Especialidade" p-value="{{item.CTOGNOME}}"></po-info>\r
          </div>\r
        </ng-template>\r
        <ng-template p-list-view-detail-template let-item let-code="index">\r
          <div class="po-row">\r
            <po-info class="po-sm-12 po-md-12 po-lg-12" p-label="Titular" p-value="{{item.CRANOME}}"></po-info>\r
            @if(item.CZGATIPO!=='1'){\r
              <po-info class="po-sm-12 po-md-12 po-lg-12" p-label="Dependente" p-value="{{item.CDEPAGR_NOME}}"></po-info>\r
            }\r
            <po-info class="po-sm-6 po-md-6 po-lg-6" p-label="Inclus\xE3o"    p-value="{{item.DZGADTINC | date: 'dd/MM/Y'}}"></po-info>\r
            <po-info class="po-sm-6 po-md-6 po-lg-6" p-label="Confirma\xE7\xE3o"    p-value="{{item.DZGADTCONF | date: 'dd/MM/Y'}}"></po-info>\r
          </div>\r
        </ng-template>\r
      </po-list-view>\r
  }\r
</po-page-list>\r
\r
\r
\r
<po-modal #advancedFilterModal p-title="Filtro" [p-primary-action]="advancedFilterPrimaryAction" [p-secondary-action]="advancedFilterSecondaryAction">\r
  <po-input class="po-sm-6 po-md-3 po-lg-2"\r
    p-label="Conveniado"\r
    name="CZGACODCON"\r
    [(ngModel)]="tabelaPrincipalFiltro.dados.CZGACODCON"\r
    [p-maxlength]="6"\r
    [p-disabled]="this.matriculaFuncionario!==''"\r
  ></po-input>\r
  <po-multiselect class="po-sm-12 po-md-4 po-lg-3"\r
    p-label="Situa\xE7\xE3o"\r
    name="CZGASTATUS_IN"\r
    [(ngModel)]="tabelaPrincipalFiltro.dados.CZGASTATUS_IN"\r
    [p-options]="tabelaPrincipalFiltro.CZGASTATUS_IN"\r
  ></po-multiselect>\r
  <po-datepicker-range class="po-sm-12 po-md-6 po-lg-6"\r
    name="deate_DZGADTINC"\r
    p-label="Inclus\xE3o de at\xE9:"\r
    [(ngModel)]="tabelaPrincipalFiltro.dados.deate_DZGADTINC"\r
    p-format="dd/mm/yyyy"\r
  ></po-datepicker-range>\r
  <po-datepicker-range class="po-sm-12 po-md-6 po-lg-6"\r
    name="deate_DZGADTCONS"\r
    p-label="Consulta de at\xE9:"\r
    [(ngModel)]="tabelaPrincipalFiltro.dados.deate_DZGADTCONS"\r
    p-format="dd/mm/yyyy"\r
  ></po-datepicker-range>\r
</po-modal>\r
\r
\r
<po-modal #modalConfirmarCancelar p-title="{{modalConfirmarCancelarTitle}} Guia #{{guia.CZGACODIGO}}" >\r
  <form #modalConfirmarCancelarForm="ngForm">\r
    <po-widget>\r
      <div class="po-row">\r
        <po-info class="po-sm-6 po-md-6 po-lg-6" p-label="Data da Consulta"    p-value="{{guia.DZGADTCONS | date: 'dd/MM/Y'}}"></po-info>\r
        <po-tag class="po-sm-6 po-md-6 po-lg-6" p-label="Status" [p-value]="gpeSaudeService.statusGuiaDescricao(guia.CZGASTATUS)" [p-color]="gpeSaudeService.statusGuiaColor(guia.CZGASTATUS)"></po-tag>\r
        <po-info class="po-sm-12 po-md-12 po-lg-12" p-label="Cl\xEDnica" p-value="{{guia.CCLINICA_NOME}}"></po-info>\r
        <po-info class="po-sm-12 po-md-12 po-lg-12" p-label="Especialidade" p-value="{{guia.CTOGNOME}}"></po-info>\r
      </div>\r
      <div class="po-row">\r
        <po-info class="po-sm-12 po-md-12 po-lg-12" p-label="Titular" p-value="{{guia.CRANOME}}"></po-info>\r
        @if(guia.CZGATIPO!=='1'){\r
          <po-info class="po-sm-12 po-md-12 po-lg-12" p-label="Dependente" p-value="{{guia.CDEPAGR_NOME}}"></po-info>\r
        }\r
        <po-info class="po-sm-6 po-md-6 po-lg-6" p-label="Inclus\xE3o"    p-value="{{guia.DZGADTINC | date: 'dd/MM/Y'}}"></po-info>\r
        <po-info class="po-sm-6 po-md-6 po-lg-6" p-label="Confirma\xE7\xE3o"    p-value="{{guia.DZGADTCONF | date: 'dd/MM/Y'}}"></po-info>\r
      </div>\r
    </po-widget>\r
    <po-textarea\r
      p-label="Observa\xE7\xE3o"\r
      name="COBSERVACAO"\r
      [(ngModel)]="dadosHistorico.COBSERVACAO"\r
      [p-required]="this.modalConfirmarCancelarStatus === '3'"\r
      p-show-required="true"\r
      [p-minlength]="(this.modalConfirmarCancelarStatus === '3' ? 10 : 0)"\r
      p-placeholder="Caso seja um cancelamento, informe uma observa\xE7\xE3o com no m\xEDnimo 10 caracteres!"\r
    ></po-textarea>\r
  </form>\r
  <po-modal-footer>\r
    <po-button class="po-sm-6 po-md-6 po-lg-6"\r
      p-label="{{modalConfirmarCancelarTitle}} Guia"\r
      [p-disabled]="modalConfirmarCancelarForm.invalid"\r
      (p-click)="confirmarCancelarGuiaGravar()"\r
      [p-danger]="this.modalConfirmarCancelarStatus === '3'"\r
    ></po-button>\r
    <po-button class="po-sm-6 po-md-6 po-lg-6"\r
      p-label="Sair"\r
      (p-click)="modalConfirmarCancelar.close()"\r
    ></po-button>\r
  ></po-modal-footer>\r
</po-modal>\r
` }]
  }], () => [{ type: Router }, { type: PoNotificationService }, { type: GpeSaudeService }, { type: AuthUserPreferencesService }, { type: AngularDeviceInformationService }], { advancedFilterModal: [{
    type: ViewChild,
    args: ["advancedFilterModal", { static: true }]
  }], modalConfirmarCancelar: [{
    type: ViewChild,
    args: ["modalConfirmarCancelar", { static: true }]
  }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(SaudeGuiaListaComponent, { className: "SaudeGuiaListaComponent", filePath: "src/app/rh/saude/guia/lista/saude-guia-lista.component.ts", lineNumber: 16 });
})();

// src/app/rh/saude/guia/crud/saude-guia-crud.component.ts
var import_moment2 = __toESM(require_moment());

// src/app/interface/saude-conveniado.ts
var defaultSaudeConveniado = () => {
  return {
    CTIPO: "",
    CRAMAT: "",
    CRANOME: "",
    CRACIC: "",
    CDEPAGR_CODIGO: "",
    CDEPAGR_NOME: "",
    CDEPAGR_CPF: ""
  };
};

// src/app/service/saude-conveniado-lookup.service.ts
var SaudeConveniadoLookupService = class _SaudeConveniadoLookupService {
  constructor(httpClient, utilService) {
    this.httpClient = httpClient;
    this.utilService = utilService;
    this.url = `${environment.urlApiProtheus}/wsrgpesaude/conveniado`;
  }
  getFilteredItems(filteredParams) {
    const _a = filteredParams, { filterParams, advancedFilters } = _a, restFilteredItemsParams = __objRest(_a, ["filterParams", "advancedFilters"]);
    const params = __spreadValues(__spreadValues(__spreadValues({}, restFilteredItemsParams), filterParams), advancedFilters);
    return this.httpClient.get(this.url, { params });
  }
  getObjectByValue(value, filteredParams) {
    const httpOptions2 = this.utilService.filtrosHttpOptions(filteredParams);
    return this.httpClient.get(`${this.url}/${value}`, httpOptions2);
  }
  getAdvancedFilter() {
    return [
      { property: "CRAMAT", optional: true, gridColumns: 6, label: "Matr\xEDcula" },
      { property: "CRANOME", optional: true, gridColumns: 6, label: "Nome" },
      { property: "CRACIC", optional: true, gridColumns: 6, label: "CPF" }
    ];
  }
  getColumnsFilter() {
    return [
      { property: "CRAMAT", label: "Matr\xEDcula" },
      { property: "CRANOME", label: "Nome" }
    ];
  }
  getFieldFormater(value) {
    return `${value.CRAMAT} - ${value.CRANOME}`;
  }
  static {
    this.\u0275fac = function SaudeConveniadoLookupService_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _SaudeConveniadoLookupService)(\u0275\u0275inject(HttpClient), \u0275\u0275inject(UtilService));
    };
  }
  static {
    this.\u0275prov = /* @__PURE__ */ \u0275\u0275defineInjectable({ token: _SaudeConveniadoLookupService, factory: _SaudeConveniadoLookupService.\u0275fac, providedIn: "root" });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(SaudeConveniadoLookupService, [{
    type: Injectable,
    args: [{
      providedIn: "root"
    }]
  }], () => [{ type: HttpClient }, { type: UtilService }], null);
})();

// src/app/rh/saude/guia/crud/saude-guia-crud.component.ts
var _c04 = ["modalDependente"];
var _c111 = ["modalConsultas"];
var _c22 = ["formGuia"];
var _c32 = () => ({ combobox: "S", CTIPO: "1" });
var _c42 = () => ({ value: "C", label: "Consulta" });
var _c52 = () => ({ value: "E", label: "Exame" });
var _c62 = (a0, a1) => [a0, a1];
var _c72 = () => ({ CZPRCOMPLE: "A" });
var _c82 = () => ({ combobox: "S" });
function SaudeGuiaCrudComponent_Conditional_8_Template(rf, ctx) {
  if (rf & 1) {
    const _r2 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-button", 29);
    \u0275\u0275listener("p-click", function SaudeGuiaCrudComponent_Conditional_8_Template_po_button_p_click_0_listener() {
      \u0275\u0275restoreView(_r2);
      const ctx_r2 = \u0275\u0275nextContext();
      return \u0275\u0275resetView(ctx_r2.alterarGuiaParaTItular());
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275property("p-disabled", ctx_r2.bloqueiaEdicao);
  }
}
function SaudeGuiaCrudComponent_Conditional_10_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-tag", 11);
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275property("p-value", ctx_r2.gpeSaudeService.statusGuiaDescricao(ctx_r2.guia.CZGASTATUS))("p-color", ctx_r2.gpeSaudeService.statusGuiaColor(ctx_r2.guia.CZGASTATUS));
  }
}
function SaudeGuiaCrudComponent_Conditional_16_Template(rf, ctx) {
  if (rf & 1) {
    const _r4 = \u0275\u0275getCurrentView();
    \u0275\u0275elementStart(0, "po-datepicker", 30);
    \u0275\u0275twoWayListener("ngModelChange", function SaudeGuiaCrudComponent_Conditional_16_Template_po_datepicker_ngModelChange_0_listener($event) {
      \u0275\u0275restoreView(_r4);
      const ctx_r2 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r2.guia.DZGADTINC, $event) || (ctx_r2.guia.DZGADTINC = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
    \u0275\u0275elementStart(1, "po-datepicker", 31);
    \u0275\u0275twoWayListener("ngModelChange", function SaudeGuiaCrudComponent_Conditional_16_Template_po_datepicker_ngModelChange_1_listener($event) {
      \u0275\u0275restoreView(_r4);
      const ctx_r2 = \u0275\u0275nextContext();
      \u0275\u0275twoWayBindingSet(ctx_r2.guia.DZGADTCONF, $event) || (ctx_r2.guia.DZGADTCONF = $event);
      return \u0275\u0275resetView($event);
    });
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.guia.DZGADTINC);
    \u0275\u0275property("p-iso-format", ctx_r2.formatExtended)("p-disabled", true);
    \u0275\u0275advance();
    \u0275\u0275twoWayProperty("ngModel", ctx_r2.guia.DZGADTCONF);
    \u0275\u0275property("p-iso-format", ctx_r2.formatExtended)("p-disabled", true);
  }
}
function SaudeGuiaCrudComponent_ng_template_27_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 32);
    \u0275\u0275element(1, "po-info", 33);
    \u0275\u0275pipe(2, "date");
    \u0275\u0275element(3, "po-tag", 34)(4, "po-info", 35)(5, "po-info", 36);
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const item_r5 = ctx.$implicit;
    const ctx_r2 = \u0275\u0275nextContext();
    \u0275\u0275advance();
    \u0275\u0275propertyInterpolate("p-value", \u0275\u0275pipeBind2(2, 5, item_r5.DZGADTCONS, "dd/MM/Y"));
    \u0275\u0275advance(2);
    \u0275\u0275property("p-value", ctx_r2.gpeSaudeService.statusGuiaDescricao(item_r5.CZGASTATUS))("p-color", ctx_r2.gpeSaudeService.statusGuiaColor(item_r5.CZGASTATUS));
    \u0275\u0275advance();
    \u0275\u0275propertyInterpolate("p-value", item_r5.CCLINICA_NOME);
    \u0275\u0275advance();
    \u0275\u0275propertyInterpolate("p-value", item_r5.CTOGNOME);
  }
}
function SaudeGuiaCrudComponent_ng_template_28_Conditional_2_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275element(0, "po-info", 38);
  }
  if (rf & 2) {
    const item_r6 = \u0275\u0275nextContext().$implicit;
    \u0275\u0275propertyInterpolate("p-value", item_r6.CDEPAGR_NOME);
  }
}
function SaudeGuiaCrudComponent_ng_template_28_Template(rf, ctx) {
  if (rf & 1) {
    \u0275\u0275elementStart(0, "div", 32);
    \u0275\u0275element(1, "po-info", 37);
    \u0275\u0275template(2, SaudeGuiaCrudComponent_ng_template_28_Conditional_2_Template, 1, 1, "po-info", 38);
    \u0275\u0275element(3, "po-info", 39);
    \u0275\u0275pipe(4, "date");
    \u0275\u0275element(5, "po-info", 40);
    \u0275\u0275pipe(6, "date");
    \u0275\u0275elementEnd();
  }
  if (rf & 2) {
    const item_r6 = ctx.$implicit;
    \u0275\u0275advance();
    \u0275\u0275propertyInterpolate("p-value", item_r6.CRANOME);
    \u0275\u0275advance();
    \u0275\u0275conditional(item_r6.CZGATIPO !== "1" ? 2 : -1);
    \u0275\u0275advance();
    \u0275\u0275propertyInterpolate("p-value", \u0275\u0275pipeBind2(4, 4, item_r6.DZGADTINC, "dd/MM/Y"));
    \u0275\u0275advance(2);
    \u0275\u0275propertyInterpolate("p-value", \u0275\u0275pipeBind2(6, 7, item_r6.DZGADTCONF, "dd/MM/Y"));
  }
}
var SaudeGuiaCrudComponent = class _SaudeGuiaCrudComponent {
  constructor(router, activatedRoute, poDialogService, utilService, gpeSaudeService, authUserPreferencesService, angularDeviceInformationService, saudeConveniadoLookupService) {
    this.router = router;
    this.activatedRoute = activatedRoute;
    this.poDialogService = poDialogService;
    this.utilService = utilService;
    this.gpeSaudeService = gpeSaudeService;
    this.authUserPreferencesService = authUserPreferencesService;
    this.angularDeviceInformationService = angularDeviceInformationService;
    this.saudeConveniadoLookupService = saudeConveniadoLookupService;
    this.showTable = true;
    this.matriculaFuncionario = "";
    this.clinica = "";
    this.guia = defaultSaudeGuia();
    this.poSearchFilterMode = PoSearchFilterMode.contains;
    this.conveniado = defaultSaudeConveniado();
    this.urlApiProtheus = environment.urlApiProtheus;
    this.formatExtended = PoDatepickerIsoFormat.Extended;
    this.patternTime = "^(2[0-3]|[01][0-9]):?([0-5][0-9])$";
    this.bloqueiaEdicao = false;
    this.inclusao = true;
    this.acessoDeConvenido = false;
    this.acessoDeClinica = false;
    this.maxDateConsulta = /* @__PURE__ */ new Date();
    this.minDateConsulta = /* @__PURE__ */ new Date();
    this.tabelaDependeteItems = [];
    this.tabelaGuiaMesItems = [];
    this.breadcrumb = {
      items: [
        { label: "Home", action: this.goHome.bind(this) },
        { label: "Lista", action: this.goLista.bind(this) },
        { label: "Guia M\xE9dica" }
      ]
    };
    this.tabelaDependenteColumns = [
      { property: "CDEPAGR_NOME", label: "Dependente/Agregado", width: "100%", visible: true, type: "link", action: (value, row) => {
        this.conveniadoSelecionado(row);
      } }
    ];
    this.conveniadoColumnsFilters = this.saudeConveniadoLookupService.getColumnsFilter();
    this.maxDateConsulta = new Date(this.maxDateConsulta.setDate(this.maxDateConsulta.getDate() + 365));
  }
  ngOnInit() {
    return __async(this, null, function* () {
      this.matriculaFuncionario = (yield localStorage.getItem("CMATRICULA")) || "";
      this.clinica = (yield localStorage.getItem("CCLINICA")) || "";
      this.showTable = this.angularDeviceInformationService.isDesktop();
      this.activatedRoute.params.subscribe((params) => {
        if ("CZGACODIGO" in params) {
          this.loadDados(params["CZGACODIGO"], params["CZGACHAVE"]);
        } else {
          this.guia.DZGADTINC = /* @__PURE__ */ new Date();
          this.guia.CZGACODCON = this.matriculaFuncionario;
          this.guia.CZGACLINIC = this.clinica;
          if (this.matriculaFuncionario !== "") {
            this.acessoDeConvenido = true;
          }
          if (this.clinica !== "") {
            this.acessoDeClinica = true;
          }
          this.loadConveniado("1", this.guia.CZGACODCON);
        }
      });
    });
  }
  loadDados(CZGACODIGO, CZGACHAVE) {
    this.gpeSaudeService.getGpeSaudeGuia(CZGACODIGO, CZGACHAVE).subscribe({
      next: (retorno) => {
        this.guia = retorno;
        if (this.acessoDeConvenido && this.matriculaFuncionario != this.guia.CZGACODCON) {
          this.semAcesso();
        }
        if (this.acessoDeClinica && this.clinica != this.guia.CZGACLINIC) {
          this.semAcesso();
        }
        this.bloqueiaEdicao = true;
        this.inclusao = false;
        this.minDateConsulta = this.guia.DZGADTCONS || /* @__PURE__ */ new Date();
        let codigo = this.guia.CZGATIPO === "1" ? this.guia.CZGACODCON : this.guia.CZGACODDEP;
        this.loadConveniado(this.guia.CZGATIPO, codigo, this.guia.CZGACODCON);
      },
      error: () => {
        this.goLista();
      }
    });
  }
  loadConveniado(CTIPO, CCODIGO, CMATRICULA = "") {
    this.gpeSaudeService.getGpeSaudeConveniado(CCODIGO, { CTIPO, CMATRICULA }).subscribe({
      next: (conveniado) => {
        this.conveniadoSelecionado(conveniado);
      }
    });
  }
  alterarGuiaParaTItular() {
    this.loadConveniado("1", this.guia.CZGACODCON);
  }
  semAcesso() {
    this.poDialogService.alert({
      title: "Sem Acesso",
      message: "Guia n\xE3o pertence ao usu\xE1rio logado"
    });
    this.goLista();
  }
  validarConfirmarGuia() {
    return __async(this, null, function* () {
      if (this.formGuia.invalid) {
        this.utilService.showErrosFomulario(this.formGuia, document);
      } else {
        if (this.acessoDeConvenido && this.inclusao && this.guia.CZGATPGUIA === "C") {
          const dataConsulta = (0, import_moment2.default)(this.guia.DZGADTCONS);
          dataConsulta.locale("pt-br");
          var start = dataConsulta.startOf("month").format("YYYY-MM-DD");
          var end = dataConsulta.endOf("month").format("YYYY-MM-DD");
          let filtroGuia = {
            CZGACODCON: this.guia.CZGACODCON,
            CZGACODDEP: this.guia.CZGACODDEP,
            CZGATIPO: this.guia.CZGATIPO,
            CZGATPGUIA: "C",
            deate_DZGADTCONS: { start, end }
          };
          this.tabelaGuiaMesItems = (yield firstValueFrom(this.gpeSaudeService.getGpeSaudeGuiaLista(filtroGuia))).items;
          this.modalConsultas.open();
        } else {
          this.poDialogService.confirm({
            title: "Gravar Guia",
            message: "Deseja continuar com a grava\xE7\xE3o da guia?",
            confirm: () => {
              this.gravarGuia();
            }
          });
        }
      }
    });
  }
  gravarGuia() {
    this.gpeSaudeService.postGpeSaudeGuia(this.guia).subscribe({
      next: (guia) => {
        if (!this.modalConsultas.isHidden) {
          this.modalConsultas.close();
        }
        this.loadDados(guia.CZGACODIGO, guia.CZGACHAVE);
      }
    });
  }
  conveniadoSelecionado(conveniado) {
    this.guia.CZGATIPO = conveniado.CTIPO;
    this.guia.CZGACODCON = conveniado.CRAMAT;
    this.guia.CZGACODDEP = conveniado.CDEPAGR_CODIGO;
    this.conveniado = conveniado;
    if (!this.modalDependente.isHidden) {
      this.modalDependente.close();
    }
  }
  modalDependenteOpen() {
    this.tabelaDependeteItems = [];
    this.gpeSaudeService.getGpeSaudeConveniadoLista({ CTIPO: "2,3", CMATRICULA: this.guia.CZGACODCON }).subscribe({
      next: (lista) => {
        this.tabelaDependeteItems = lista.items;
      }
    });
    this.modalDependente.open();
  }
  goHome() {
    this.router.navigate(["/"]);
  }
  goLista() {
    this.router.navigate(["/rh/saude/guia/lista"]);
  }
  static {
    this.\u0275fac = function SaudeGuiaCrudComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _SaudeGuiaCrudComponent)(\u0275\u0275directiveInject(Router), \u0275\u0275directiveInject(ActivatedRoute), \u0275\u0275directiveInject(PoDialogService), \u0275\u0275directiveInject(UtilService), \u0275\u0275directiveInject(GpeSaudeService), \u0275\u0275directiveInject(AuthUserPreferencesService), \u0275\u0275directiveInject(AngularDeviceInformationService), \u0275\u0275directiveInject(SaudeConveniadoLookupService));
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _SaudeGuiaCrudComponent, selectors: [["app-saude-guia-crud"]], viewQuery: function SaudeGuiaCrudComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c04, 7);
        \u0275\u0275viewQuery(_c111, 7);
        \u0275\u0275viewQuery(_c22, 7);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.modalDependente = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.modalConsultas = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.formGuia = _t.first);
      }
    }, standalone: false, decls: 32, vars: 53, consts: [["formGuia", "ngForm"], ["modalDependente", ""], ["modalConsultas", ""], [3, "p-title", "p-breadcrumb"], ["p-title", "Dados Conveniados"], ["p-label", "Titular", "name", "CZGACODCON", "p-field-label", "label", "p-field-value", "value", "p-clean", "true", "p-required", "true", "p-show-required", "true", "p-change-on-enter", "true", 1, "po-sm-12", "po-md-6", "po-lg-4", 3, "ngModelChange", "ngModel", "p-filter-service", "p-filter-params", "p-disabled"], ["p-label", "Atendimento Para", 1, "po-sm-12", "po-md-12", "po-lg-12"], ["p-label", "Dependente", 1, "po-sm-12", "po-md-3", "po-lg-2", 3, "p-click", "p-disabled"], [1, "po-sm-4", "po-md-6", "po-lg-6", 3, "p-label", "p-value", "p-color"], ["p-label", "Retornar Titular", 1, "po-sm-12", "po-md-3", "po-lg-2", 3, "p-disabled"], ["p-title", "Dados do Agendamento"], ["p-label", "Status", 1, "po-sm-6", "po-md-3", "po-lg-2", 3, "p-value", "p-color"], ["p-label", "Tipo Guia", "name", "CZGATPGUIA", "p-columns", "1", 1, "po-sm-3", "po-md-6", "po-lg-2", 3, "ngModelChange", "ngModel", "p-options", "p-disabled"], ["p-label", "Cl\xEDnica", "name", "CZGACLINIC", "p-required", "true", "p-show-required", "true", "p-field-label", "CZPRGENERI", "p-field-value", "CZPRCHAVE", "p-clean", "true", 1, "po-sm-12", "po-md-6", "po-lg-4", 3, "ngModelChange", "ngModel", "p-filter-service", "p-filter-params", "p-disabled"], ["p-label", "Especialidade", "name", "CZGAESPECI", "p-required", "true", "p-show-required", "true", "p-field-label", "label", "p-field-value", "value", "p-infinite-scroll", "true", "p-clean", "true", 1, "po-sm-12", "po-md-6", "po-lg-4", 3, "ngModelChange", "ngModel", "p-filter-service", "p-filter-params", "p-disabled"], ["p-label", "Data Consulta", "name", "DZGADTCONS", "p-required", "true", "p-show-required", "true", 1, "po-sm-8", "po-md-4", "po-lg-2", 3, "ngModelChange", "ngModel", "p-iso-format", "p-disabled", "p-min-date", "p-max-date"], ["p-label", "Hora", "name", "CZGAHRCONS", "p-placeholder", "HH:MM", "p-mask", "99:99", "p-mask-format-model", "true", 1, "po-sm-4", "po-md-4", "po-lg-1", 3, "ngModelChange", "ngModel", "pattern", "p-disabled"], ["p-label", "Confirmar", "p-icon", "an an-check", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-click", "p-disabled"], ["p-label", "Sair", "p-danger", "true", "p-icon", "an an-x", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-click"], ["p-title", "Dependente", "p-size", "xl", 1, "po-sm-12", "po-md-12", "po-lg-12"], ["p-spacing", "extraSmall", "p-hide-columns-manager", "true", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-items", "p-columns", "p-actions-right", "p-sort", "p-striped", "p-filter-type"], ["p-title", "Consultas M\xEAs", "p-size", "xl", 1, "po-sm-12", "po-md-12", "po-lg-12"], ["p-value", "Abaixo listamos as consultas agendadas para o usu\xE1rio no m\xEAs corrente da data da consulta. Lembre-se da taxa de utiliza\xE7\xE3o quando o n\xFAmero de consultas ultrapassar a 2", 1, "po-sm-12", "po-md-12", "po-lg-12"], ["p-label", "N\xFAmero de Consultas no M\xEAs", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-value"], ["p-property-title", "CZGACODIGO", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-items"], ["p-list-view-content-template", ""], ["p-list-view-detail-template", ""], ["p-label", "Confirmar", "p-icon", "an an-check", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-click"], ["p-label", "Cancelar", "p-danger", "true", "p-icon", "an an-x", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-click"], ["p-label", "Retornar Titular", 1, "po-sm-12", "po-md-3", "po-lg-2", 3, "p-click", "p-disabled"], ["p-label", "Data Inclus\xE3o", "name", "DZGADTINC", 1, "po-sm-8", "po-md-4", "po-lg-2", 3, "ngModelChange", "ngModel", "p-iso-format", "p-disabled"], ["p-label", "Data Confirma\xE7\xE3o", "name", "DZGADTCONF", 1, "po-sm-8", "po-md-4", "po-lg-2", 3, "ngModelChange", "ngModel", "p-iso-format", "p-disabled"], [1, "po-row"], ["p-label", "Data da Consulta", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-value"], ["p-label", "Status", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-value", "p-color"], ["p-label", "Cl\xEDnica", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-value"], ["p-label", "Especialidade", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-value"], ["p-label", "Titular", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-value"], ["p-label", "Dependente", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-value"], ["p-label", "Inclus\xE3o", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-value"], ["p-label", "Confirma\xE7\xE3o", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-value"]], template: function SaudeGuiaCrudComponent_Template(rf, ctx) {
      if (rf & 1) {
        const _r1 = \u0275\u0275getCurrentView();
        \u0275\u0275elementStart(0, "po-page-edit", 3)(1, "form", null, 0)(3, "po-widget", 4)(4, "po-combo", 5);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeGuiaCrudComponent_Template_po_combo_ngModelChange_4_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.guia.CZGACODCON, $event) || (ctx.guia.CZGACODCON = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275listener("ngModelChange", function SaudeGuiaCrudComponent_Template_po_combo_ngModelChange_4_listener($event) {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.loadConveniado("1", $event));
        });
        \u0275\u0275elementEnd();
        \u0275\u0275element(5, "po-divider", 6);
        \u0275\u0275elementStart(6, "po-button", 7);
        \u0275\u0275listener("p-click", function SaudeGuiaCrudComponent_Template_po_button_p_click_6_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.modalDependenteOpen());
        });
        \u0275\u0275elementEnd();
        \u0275\u0275element(7, "po-tag", 8);
        \u0275\u0275template(8, SaudeGuiaCrudComponent_Conditional_8_Template, 1, 1, "po-button", 9);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(9, "po-widget", 10);
        \u0275\u0275template(10, SaudeGuiaCrudComponent_Conditional_10_Template, 1, 2, "po-tag", 11);
        \u0275\u0275elementStart(11, "po-radio-group", 12);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeGuiaCrudComponent_Template_po_radio_group_ngModelChange_11_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.guia.CZGATPGUIA, $event) || (ctx.guia.CZGATPGUIA = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(12, "po-combo", 13);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeGuiaCrudComponent_Template_po_combo_ngModelChange_12_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.guia.CZGACLINIC, $event) || (ctx.guia.CZGACLINIC = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(13, "po-combo", 14);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeGuiaCrudComponent_Template_po_combo_ngModelChange_13_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.guia.CZGAESPECI, $event) || (ctx.guia.CZGAESPECI = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(14, "po-datepicker", 15);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeGuiaCrudComponent_Template_po_datepicker_ngModelChange_14_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.guia.DZGADTCONS, $event) || (ctx.guia.DZGADTCONS = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(15, "po-input", 16);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeGuiaCrudComponent_Template_po_input_ngModelChange_15_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.guia.CZGAHRCONS, $event) || (ctx.guia.CZGAHRCONS = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275template(16, SaudeGuiaCrudComponent_Conditional_16_Template, 2, 6);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(17, "po-button", 17);
        \u0275\u0275listener("p-click", function SaudeGuiaCrudComponent_Template_po_button_p_click_17_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.validarConfirmarGuia());
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(18, "po-button", 18);
        \u0275\u0275listener("p-click", function SaudeGuiaCrudComponent_Template_po_button_p_click_18_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.goLista());
        });
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(19, "po-modal", 19, 1);
        \u0275\u0275element(21, "po-table", 20);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(22, "po-modal", 21, 2);
        \u0275\u0275element(24, "po-info", 22)(25, "po-info", 23);
        \u0275\u0275elementStart(26, "po-list-view", 24);
        \u0275\u0275template(27, SaudeGuiaCrudComponent_ng_template_27_Template, 6, 8, "ng-template", 25)(28, SaudeGuiaCrudComponent_ng_template_28_Template, 7, 10, "ng-template", 26);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(29, "po-modal-footer")(30, "po-button", 27);
        \u0275\u0275listener("p-click", function SaudeGuiaCrudComponent_Template_po_button_p_click_30_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.gravarGuia());
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(31, "po-button", 28);
        \u0275\u0275listener("p-click", function SaudeGuiaCrudComponent_Template_po_button_p_click_31_listener() {
          \u0275\u0275restoreView(_r1);
          const modalConsultas_r7 = \u0275\u0275reference(23);
          return \u0275\u0275resetView(modalConsultas_r7.close());
        });
        \u0275\u0275elementEnd()()();
      }
      if (rf & 2) {
        \u0275\u0275propertyInterpolate1("p-title", "Guia M\xE9dica #", ctx.guia.CZGACODIGO, "");
        \u0275\u0275property("p-breadcrumb", ctx.breadcrumb);
        \u0275\u0275advance(4);
        \u0275\u0275propertyInterpolate1("p-filter-service", "", ctx.urlApiProtheus, "/wsrgpesaude/conveniado");
        \u0275\u0275twoWayProperty("ngModel", ctx.guia.CZGACODCON);
        \u0275\u0275property("p-filter-params", \u0275\u0275pureFunction0(45, _c32))("p-disabled", ctx.acessoDeConvenido || ctx.bloqueiaEdicao);
        \u0275\u0275advance(2);
        \u0275\u0275property("p-disabled", ctx.bloqueiaEdicao);
        \u0275\u0275advance();
        \u0275\u0275property("p-label", ctx.guia.CZGATIPO === "1" ? ctx.conveniado.CRANOME : ctx.conveniado.CDEPAGR_NOME)("p-value", ctx.gpeSaudeService.tipoGuiaDescricao(ctx.guia.CZGATIPO))("p-color", ctx.gpeSaudeService.tipoGuiaColor(ctx.guia.CZGATIPO));
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.conveniado.CTIPO !== "1" ? 8 : -1);
        \u0275\u0275advance(2);
        \u0275\u0275conditional(ctx.guia.CZGACODIGO ? 10 : -1);
        \u0275\u0275advance();
        \u0275\u0275twoWayProperty("ngModel", ctx.guia.CZGATPGUIA);
        \u0275\u0275property("p-options", \u0275\u0275pureFunction2(48, _c62, \u0275\u0275pureFunction0(46, _c42), \u0275\u0275pureFunction0(47, _c52)))("p-disabled", ctx.bloqueiaEdicao);
        \u0275\u0275advance();
        \u0275\u0275propertyInterpolate1("p-filter-service", "", ctx.urlApiProtheus, "/wsrbase/zprcombo/AREFICLINI");
        \u0275\u0275twoWayProperty("ngModel", ctx.guia.CZGACLINIC);
        \u0275\u0275property("p-filter-params", \u0275\u0275pureFunction0(51, _c72))("p-disabled", ctx.acessoDeClinica || ctx.bloqueiaEdicao);
        \u0275\u0275advance();
        \u0275\u0275propertyInterpolate1("p-filter-service", "", ctx.urlApiProtheus, "/wsrgpesaude/especialidade");
        \u0275\u0275twoWayProperty("ngModel", ctx.guia.CZGAESPECI);
        \u0275\u0275property("p-filter-params", \u0275\u0275pureFunction0(52, _c82))("p-disabled", ctx.bloqueiaEdicao);
        \u0275\u0275advance();
        \u0275\u0275twoWayProperty("ngModel", ctx.guia.DZGADTCONS);
        \u0275\u0275property("p-iso-format", ctx.formatExtended)("p-disabled", ctx.bloqueiaEdicao)("p-min-date", ctx.minDateConsulta)("p-max-date", ctx.maxDateConsulta);
        \u0275\u0275advance();
        \u0275\u0275twoWayProperty("ngModel", ctx.guia.CZGAHRCONS);
        \u0275\u0275property("pattern", ctx.patternTime)("p-disabled", ctx.bloqueiaEdicao);
        \u0275\u0275advance();
        \u0275\u0275conditional(ctx.guia.CZGACODIGO ? 16 : -1);
        \u0275\u0275advance();
        \u0275\u0275property("p-disabled", ctx.bloqueiaEdicao);
        \u0275\u0275advance(4);
        \u0275\u0275property("p-items", ctx.tabelaDependeteItems)("p-columns", ctx.tabelaDependenteColumns)("p-actions-right", true)("p-sort", true)("p-striped", true)("p-filter-type", ctx.poSearchFilterMode);
        \u0275\u0275advance(4);
        \u0275\u0275property("p-value", ctx.tabelaGuiaMesItems.length);
        \u0275\u0275advance();
        \u0275\u0275property("p-items", ctx.tabelaGuiaMesItems);
      }
    }, dependencies: [PoButtonComponent, PoDividerComponent, PoRadioGroupComponent, PoDatepickerComponent, PoComboComponent, PoInputComponent, PoTagComponent, PoInfoComponent, PoListViewComponent, PoListViewContentTemplateDirective, PoListViewDetailTemplateDirective, PoModalComponent, PoModalFooterComponent, PoPageEditComponent, PoTableComponent, PoWidgetComponent, \u0275NgNoValidate, NgControlStatus, NgControlStatusGroup, PatternValidator, NgModel, NgForm, DatePipe], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(SaudeGuiaCrudComponent, [{
    type: Component,
    args: [{ selector: "app-saude-guia-crud", standalone: false, template: `<po-page-edit\r
  p-title="Guia M\xE9dica #{{guia.CZGACODIGO}}"\r
  [p-breadcrumb]="breadcrumb"\r
>\r
  <form #formGuia="ngForm">\r
    <po-widget\r
      p-title="Dados Conveniados"\r
    >\r
      <po-combo class="po-sm-12 po-md-6 po-lg-4"\r
        p-label="Titular"\r
        name="CZGACODCON"\r
        [(ngModel)]="guia.CZGACODCON"\r
        p-filter-service="{{urlApiProtheus}}/wsrgpesaude/conveniado"\r
        [p-filter-params]="{ combobox: 'S', CTIPO: '1'}"\r
        p-field-label="label"\r
        p-field-value="value"\r
        p-clean="true"\r
        p-required="true"\r
        p-show-required="true"\r
        p-change-on-enter="true"\r
        (ngModelChange)="loadConveniado('1',$event)"\r
        [p-disabled]="acessoDeConvenido || bloqueiaEdicao"\r
      ></po-combo>\r
      <po-divider class="po-sm-12 po-md-12 po-lg-12" p-label="Atendimento Para"></po-divider>\r
      <po-button class="po-sm-12 po-md-3 po-lg-2"\r
        p-label="Dependente"\r
        (p-click)="modalDependenteOpen()"\r
        [p-disabled]="bloqueiaEdicao"\r
      ></po-button>\r
      <po-tag class="po-sm-4 po-md-6 po-lg-6" [p-label]="guia.CZGATIPO==='1'?conveniado.CRANOME:conveniado.CDEPAGR_NOME" [p-value]="gpeSaudeService.tipoGuiaDescricao(guia.CZGATIPO)" [p-color]="gpeSaudeService.tipoGuiaColor(guia.CZGATIPO)"></po-tag>\r
      @if(conveniado.CTIPO!=='1'){\r
        <po-button class="po-sm-12 po-md-3 po-lg-2"\r
          p-label="Retornar Titular"\r
          (p-click)="alterarGuiaParaTItular()"\r
          [p-disabled]="bloqueiaEdicao"\r
        ></po-button>\r
      }\r
    </po-widget>\r
    <po-widget\r
      p-title="Dados do Agendamento"\r
    >\r
      @if(guia.CZGACODIGO){\r
        <po-tag class="po-sm-6 po-md-3 po-lg-2" p-label="Status" [p-value]="gpeSaudeService.statusGuiaDescricao(guia.CZGASTATUS)" [p-color]="gpeSaudeService.statusGuiaColor(guia.CZGASTATUS)"></po-tag>\r
      }\r
      <po-radio-group class="po-sm-3 po-md-6 po-lg-2"\r
        p-label="Tipo Guia"\r
        name="CZGATPGUIA"\r
        [(ngModel)]="guia.CZGATPGUIA"\r
        [p-options]="[\r
          { value: 'C', label: 'Consulta'},\r
          { value: 'E', label: 'Exame'},\r
        ]"\r
        p-columns="1"\r
        [p-disabled]="bloqueiaEdicao"\r
      ></po-radio-group>\r
      <po-combo class="po-sm-12 po-md-6 po-lg-4"\r
        p-label="Cl\xEDnica"\r
        name="CZGACLINIC"\r
        [(ngModel)]="guia.CZGACLINIC"\r
        p-required="true"\r
        p-show-required="true"\r
        p-filter-service="{{urlApiProtheus}}/wsrbase/zprcombo/AREFICLINI"\r
        p-field-label="CZPRGENERI"\r
        p-field-value="CZPRCHAVE"\r
        [p-filter-params]="{CZPRCOMPLE: 'A'}"\r
        p-clean="true"\r
        [p-disabled]="acessoDeClinica || bloqueiaEdicao"\r
      ></po-combo>\r
      <po-combo class="po-sm-12 po-md-6 po-lg-4"\r
        p-label="Especialidade"\r
        name="CZGAESPECI"\r
        [(ngModel)]="guia.CZGAESPECI"\r
        p-required="true"\r
        p-show-required="true"\r
        p-filter-service="{{urlApiProtheus}}/wsrgpesaude/especialidade"\r
        p-field-label="label"\r
        p-field-value="value"\r
        [p-filter-params]="{combobox: 'S'}"\r
        p-infinite-scroll="true"\r
        p-clean="true"\r
        [p-disabled]="bloqueiaEdicao"\r
      ></po-combo>\r
      <po-datepicker class="po-sm-8 po-md-4 po-lg-2"\r
        p-label="Data Consulta"\r
        name="DZGADTCONS"\r
        [(ngModel)]="guia.DZGADTCONS"\r
        [p-iso-format]="formatExtended"\r
        [p-disabled]="bloqueiaEdicao"\r
        p-required="true"\r
        p-show-required="true"\r
        [p-min-date]="minDateConsulta"\r
        [p-max-date]="maxDateConsulta"\r
      ></po-datepicker>\r
      <po-input class="po-sm-4 po-md-4 po-lg-1"\r
        p-label="Hora"\r
        name="CZGAHRCONS"\r
        [(ngModel)]="guia.CZGAHRCONS"\r
        p-placeholder="HH:MM"\r
        [pattern]="patternTime"\r
        p-mask="99:99"\r
        p-mask-format-model="true"\r
        [p-disabled]="bloqueiaEdicao"\r
      ></po-input>\r
      @if(guia.CZGACODIGO){\r
        <po-datepicker class="po-sm-8 po-md-4 po-lg-2"\r
          p-label="Data Inclus\xE3o"\r
          name="DZGADTINC"\r
          [(ngModel)]="guia.DZGADTINC"\r
          [p-iso-format]="formatExtended"\r
          [p-disabled]="true"\r
        ></po-datepicker>\r
        <po-datepicker class="po-sm-8 po-md-4 po-lg-2"\r
          p-label="Data Confirma\xE7\xE3o"\r
          name="DZGADTCONF"\r
          [(ngModel)]="guia.DZGADTCONF"\r
          [p-iso-format]="formatExtended"\r
          [p-disabled]="true"\r
        ></po-datepicker>\r
      }\r
    </po-widget>\r
  </form>\r
\r
  <po-button  class="po-sm-6 po-md-6 po-lg-6"\r
    p-label="Confirmar"\r
    p-icon="an an-check"\r
    [p-disabled]="bloqueiaEdicao"\r
    (p-click)="validarConfirmarGuia()"\r
  ></po-button>\r
  <po-button  class="po-sm-6 po-md-6 po-lg-6"\r
    p-label="Sair"\r
    p-danger="true"\r
    p-icon="an an-x"\r
    (p-click)="goLista()"\r
  ></po-button>\r
\r
</po-page-edit>\r
\r
\r
<po-modal #modalDependente class="po-sm-12 po-md-12 po-lg-12"\r
  p-title="Dependente"\r
  p-size="xl"\r
>\r
  <po-table class="po-sm-12 po-md-12 po-lg-12"\r
    [p-items]="tabelaDependeteItems"\r
    [p-columns]="tabelaDependenteColumns"\r
    [p-actions-right]="true"\r
    [p-sort]="true"\r
    p-spacing="extraSmall"\r
    [p-striped]="true"\r
    [p-filter-type]="poSearchFilterMode"\r
    p-hide-columns-manager="true"\r
  ></po-table>\r
\r
</po-modal>\r
\r
<po-modal #modalConsultas class="po-sm-12 po-md-12 po-lg-12"\r
  p-title="Consultas M\xEAs"\r
  p-size="xl"\r
>\r
  <po-info class="po-sm-12 po-md-12 po-lg-12"\r
    p-value="Abaixo listamos as consultas agendadas para o usu\xE1rio no m\xEAs corrente da data da consulta. Lembre-se da taxa de utiliza\xE7\xE3o quando o n\xFAmero de consultas ultrapassar a 2"\r
  ></po-info>\r
  <po-info class="po-sm-12 po-md-12 po-lg-12"\r
    p-label="N\xFAmero de Consultas no M\xEAs"\r
    [p-value]="tabelaGuiaMesItems.length"\r
  ></po-info>\r
\r
  <po-list-view  class="po-sm-12 po-md-12 po-lg-12"\r
    p-property-title="CZGACODIGO"\r
    [p-items]="tabelaGuiaMesItems"\r
  >\r
    <ng-template p-list-view-content-template let-item>\r
      <div class="po-row">\r
        <po-info class="po-sm-6 po-md-6 po-lg-6" p-label="Data da Consulta"    p-value="{{item.DZGADTCONS | date: 'dd/MM/Y'}}"></po-info>\r
        <po-tag class="po-sm-6 po-md-6 po-lg-6" p-label="Status" [p-value]="gpeSaudeService.statusGuiaDescricao(item.CZGASTATUS)" [p-color]="gpeSaudeService.statusGuiaColor(item.CZGASTATUS)"></po-tag>\r
        <po-info class="po-sm-12 po-md-12 po-lg-12" p-label="Cl\xEDnica" p-value="{{item.CCLINICA_NOME}}"></po-info>\r
        <po-info class="po-sm-12 po-md-12 po-lg-12" p-label="Especialidade" p-value="{{item.CTOGNOME}}"></po-info>\r
      </div>\r
    </ng-template>\r
    <ng-template p-list-view-detail-template let-item let-code="index">\r
      <div class="po-row">\r
        <po-info class="po-sm-12 po-md-12 po-lg-12" p-label="Titular" p-value="{{item.CRANOME}}"></po-info>\r
        @if(item.CZGATIPO!=='1'){\r
          <po-info class="po-sm-12 po-md-12 po-lg-12" p-label="Dependente" p-value="{{item.CDEPAGR_NOME}}"></po-info>\r
        }\r
        <po-info class="po-sm-6 po-md-6 po-lg-6" p-label="Inclus\xE3o"    p-value="{{item.DZGADTINC | date: 'dd/MM/Y'}}"></po-info>\r
        <po-info class="po-sm-6 po-md-6 po-lg-6" p-label="Confirma\xE7\xE3o"    p-value="{{item.DZGADTCONF | date: 'dd/MM/Y'}}"></po-info>\r
      </div>\r
    </ng-template>\r
  </po-list-view>\r
  <po-modal-footer>\r
    <po-button  class="po-sm-6 po-md-6 po-lg-6"\r
      p-label="Confirmar"\r
      p-icon="an an-check"\r
      (p-click)="gravarGuia()"\r
    ></po-button>\r
    <po-button  class="po-sm-6 po-md-6 po-lg-6"\r
      p-label="Cancelar"\r
      p-danger="true"\r
      p-icon="an an-x"\r
      (p-click)="modalConsultas.close()"\r
    ></po-button>\r
  </po-modal-footer>\r
\r
</po-modal>\r
` }]
  }], () => [{ type: Router }, { type: ActivatedRoute }, { type: PoDialogService }, { type: UtilService }, { type: GpeSaudeService }, { type: AuthUserPreferencesService }, { type: AngularDeviceInformationService }, { type: SaudeConveniadoLookupService }], { modalDependente: [{
    type: ViewChild,
    args: ["modalDependente", { static: true }]
  }], modalConsultas: [{
    type: ViewChild,
    args: ["modalConsultas", { static: true }]
  }], formGuia: [{
    type: ViewChild,
    args: ["formGuia", { static: true }]
  }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(SaudeGuiaCrudComponent, { className: "SaudeGuiaCrudComponent", filePath: "src/app/rh/saude/guia/crud/saude-guia-crud.component.ts", lineNumber: 22 });
})();

// src/app/login-fornecedor/login-fornecedor.component.ts
var _c05 = ["formLogin"];
var LoginFornecedorComponent = class _LoginFornecedorComponent {
  constructor(authService, router, poStorageService) {
    this.authService = authService;
    this.router = router;
    this.poStorageService = poStorageService;
    this.attempts = 3;
    this.loginErrors = [];
    this.passwordErrors = [];
    this.loading = false;
    this.showPageBlocked = false;
    if (environment.production) {
      this.pProductName = "Portal RH INPLAC";
    } else {
      this.pProductName = "Portal RH TESTE INPLAC";
    }
    this.customLiterals = {
      loginPlaceholder: "CNPJ: Apenas N\xFAmeros",
      loginHint: "Seu usuario \xE9 seu CNPJ. Digite apenas os numeros Ex: 52738387039001",
      loginErrorPattern: "Seu usuario \xE9 seu CNPJ. Digite apenas os numeros Ex: 52738387039001"
    };
  }
  ngOnInit() {
    this.loading = false;
    localStorage.clear();
    this.poStorageService.clear();
    sessionStorage.clear();
  }
  checkLogin(formData) {
    this.loading = true;
    this.authService.loginFornecedor(formData.login, formData.password).subscribe({
      next: (response) => {
        this.passwordErrors = [];
        this.loginErrors = [];
        localStorage.setItem("token", JSON.stringify(__spreadProps(__spreadValues({}, response.oToken), { last_token_refresh: (/* @__PURE__ */ new Date()).getTime() / 1e3 })));
        localStorage.setItem("dadosFornecedor", JSON.stringify({ CRD0LOGINR: response.CRD0LOGINR, CRD0FORNEC: response.CRD0FORNEC, CRD0LOJA: response.CRD0LOJA }));
        localStorage.setItem("CUSUARIOPORTALCODIGO", response.CRD0CODIGO);
        localStorage.setItem("CUSUARIOPORTALNOME", response.CRD0NOME);
        localStorage.setItem("CCLINICA", response.CRD0LOGINR);
        localStorage.setItem("tipoUsuario", "fornecedor");
        localStorage.setItem("portal", environment.portalFornecedorCodigo);
        this.authService.getUser().subscribe({
          next: (usuario) => {
            this.poStorageService.set("usuario", usuario);
            if (usuario.AEMPRESA) {
              this.poStorageService.set("empresaSelecionada", usuario.AEMPRESA[0]);
              localStorage.setItem("tenantid", `${usuario.AEMPRESA[0].CM0CODIGO},${usuario.AEMPRESA[0].CM0CODFIL}`);
              localStorage.setItem("CUSRID", usuario.CUSRID);
            }
            this.poStorageService.get("redirectUrl").then((url) => this.router.navigateByUrl(url));
          },
          error: () => {
            this.loading = false;
            this.passwordErrors = ["Senha e/ou usu\xE1rio inv\xE1lido, verifique e tente novamente."];
          }
        });
      },
      error: () => {
        this.loading = false;
        this.passwordErrors = ["Senha e/ou usu\xE1rio inv\xE1lido, verifique e tente novamente."];
      }
    });
  }
  loginChange() {
    if (this.passwordErrors.length) {
      this.passwordErrors = [];
      this.loginErrors = [];
    }
  }
  static {
    this.\u0275fac = function LoginFornecedorComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _LoginFornecedorComponent)(\u0275\u0275directiveInject(AuthService), \u0275\u0275directiveInject(Router), \u0275\u0275directiveInject(PoStorageService));
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _LoginFornecedorComponent, selectors: [["app-login"]], viewQuery: function LoginFornecedorComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c05, 7);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.formLogin = _t.first);
      }
    }, standalone: false, decls: 5, vars: 6, consts: [["formLogin", ""], [1, "logoDiv"], ["alt", "main-logo", "src", "./assets/image/logo.png", 1, "logo"], ["p-login-pattern", "[0-9]{14}", 3, "p-login-change", "p-password-change", "p-login-submit", "p-hide-remember-user", "p-product-name", "p-loading", "p-password-errors", "p-login-errors", "p-literals"]], template: function LoginFornecedorComponent_Template(rf, ctx) {
      if (rf & 1) {
        const _r1 = \u0275\u0275getCurrentView();
        \u0275\u0275elementStart(0, "div", 1);
        \u0275\u0275element(1, "img", 2);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(2, "div")(3, "po-page-login", 3, 0);
        \u0275\u0275listener("p-login-change", function LoginFornecedorComponent_Template_po_page_login_p_login_change_3_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.loginChange());
        })("p-password-change", function LoginFornecedorComponent_Template_po_page_login_p_password_change_3_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.loginChange());
        })("p-login-submit", function LoginFornecedorComponent_Template_po_page_login_p_login_submit_3_listener($event) {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.checkLogin($event));
        });
        \u0275\u0275elementEnd()();
      }
      if (rf & 2) {
        \u0275\u0275advance(3);
        \u0275\u0275property("p-hide-remember-user", true)("p-product-name", ctx.pProductName)("p-loading", ctx.loading)("p-password-errors", ctx.passwordErrors)("p-login-errors", ctx.loginErrors)("p-literals", ctx.customLiterals);
      }
    }, dependencies: [PoPageLoginComponent], styles: ["\n\n.logoDiv[_ngcontent-%COMP%] {\n  background-color: #29b6c5;\n  top: 50px;\n  height: 80px;\n  width: 100%;\n  margin-top: 10px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n.logo[_ngcontent-%COMP%] {\n  background-color: #29b6c5;\n  margin-top: 10px;\n  align-content: center;\n}"] });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(LoginFornecedorComponent, [{
    type: Component,
    args: [{ selector: "app-login", standalone: false, template: '<div class="logoDiv">\r\n  <img alt="main-logo" class="logo" src="./assets/image/logo.png">\r\n</div>\r\n<div>\r\n  <po-page-login #formLogin\r\n\r\n    [p-hide-remember-user]="true"\r\n    [p-product-name]="pProductName"\r\n    [p-loading]="loading"\r\n    [p-password-errors]="passwordErrors"\r\n    [p-login-errors]="loginErrors"\r\n    (p-login-change)="loginChange()"\r\n    (p-password-change)="loginChange()"\r\n    (p-login-submit)="checkLogin($event)"\r\n    [p-literals]="customLiterals"\r\n    p-login-pattern="[0-9]{14}"\r\n  >\r\n  </po-page-login>\r\n</div>\r\n', styles: ["/* src/app/login-fornecedor/login-fornecedor.component.css */\n.logoDiv {\n  background-color: #29b6c5;\n  top: 50px;\n  height: 80px;\n  width: 100%;\n  margin-top: 10px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n.logo {\n  background-color: #29b6c5;\n  margin-top: 10px;\n  align-content: center;\n}\n"] }]
  }], () => [{ type: AuthService }, { type: Router }, { type: PoStorageService }], { formLogin: [{
    type: ViewChild,
    args: ["formLogin", { static: true }]
  }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(LoginFornecedorComponent, { className: "LoginFornecedorComponent", filePath: "src/app/login-fornecedor/login-fornecedor.component.ts", lineNumber: 15 });
})();

// src/app/filter/filtro-saude-relatorio-fechamento.ts
var FiltroSaudeRelatorioFechamento = class extends FiltroLista {
  constructor() {
    super(...arguments);
    this.dados = this.setDefault();
    this.timeout = this.getDataString(0);
  }
  setDefault() {
    return {
      page: 1,
      pageSize: 10,
      filter: void 0,
      order: void 0,
      CZGACLINIC: "",
      CZGACODCON: "",
      CZGATPGUIA: "",
      CZGASTATUS: "",
      CZGAESPECI: "",
      DZGADTCONS_DE: this.getData(-30),
      DZGADTCONS_ATE: this.getData(0)
    };
  }
};

// src/app/rh/saude/relatorio/fechamento-mensal/saude-relatorio-fechamento-mensal.component.ts
var _c06 = ["formRelatorio"];
var _c112 = () => ({ CZPRCOMPLE: "A" });
var _c23 = () => ({ combobox: "S" });
var _c33 = () => ({ combobox: "S", CTIPO: "1" });
var _c43 = () => ({ value: " ", label: "Todas" });
var _c53 = () => ({ value: "C", label: "Consulta" });
var _c63 = () => ({ value: "E", label: "Exame" });
var _c73 = (a0, a1, a2) => [a0, a1, a2];
var _c83 = () => ({ value: " ", label: "Ambos" });
var _c92 = () => ({ value: "1", label: "Autorizado" });
var _c102 = () => ({ value: "3", label: "Cancelado" });
var SaudeRelatorioFechamentoMensalComponent = class _SaudeRelatorioFechamentoMensalComponent {
  constructor(router, gpeSaudeService, authUserPreferencesService, utilService) {
    this.router = router;
    this.gpeSaudeService = gpeSaudeService;
    this.authUserPreferencesService = authUserPreferencesService;
    this.utilService = utilService;
    this.acessoDeConvenido = false;
    this.acessoDeClinica = false;
    this.matriculaFuncionario = "";
    this.clinica = "";
    this.formatExtended = PoDatepickerIsoFormat.Extended;
    this.urlApiProtheus = environment.urlApiProtheus;
    this.breadcrumb = {
      items: [
        { label: "Home", action: this.goHome.bind(this) },
        { label: "Relat\xF3rio Fechamento" }
      ]
    };
    this.relatorioFiltro = new FiltroSaudeRelatorioFechamento(authUserPreferencesService, "filtro-saude-relatorio-fechamento");
  }
  ngOnInit() {
    return __async(this, null, function* () {
      this.matriculaFuncionario = (yield localStorage.getItem("CMATRICULA")) || "";
      this.clinica = (yield localStorage.getItem("CCLINICA")) || "";
      if (this.matriculaFuncionario !== "") {
        this.acessoDeConvenido = true;
        this.relatorioFiltro.dados.CZGACODCON = this.matriculaFuncionario;
      }
      if (this.clinica !== "") {
        this.acessoDeClinica = true;
        this.relatorioFiltro.dados.CZGACLINIC = this.clinica;
      }
    });
  }
  gerarRelatorio(cextension = "'pdf'|'xls'") {
    const fileType = cextension === "pdf" ? "application/pdf" : "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
    const fileExtension = cextension === "pdf" ? "pdf" : "xlsx";
    const fileName = "fechamento_mensal." + fileExtension;
    if (this.formRelatorio.valid) {
      this.gpeSaudeService.getGpeSaudeRelatorioFechamentoPdfXlsSmartView(this.relatorioFiltro.dados, fileExtension).subscribe({
        next: (retorno) => {
          const blob = new Blob([retorno], { type: fileType });
          const url = window.URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = fileName;
          document.body.appendChild(a);
          a.click();
          window.URL.revokeObjectURL(url);
          a.remove();
        },
        error: (erro) => {
          this.utilService.showErrorResponse("Nao foi possivel gerar o arquivo", erro);
        }
      });
    } else {
      this.utilService.showErrosFomulario(this.formRelatorio, document);
    }
  }
  goHome() {
    this.router.navigate(["/"]);
  }
  static {
    this.\u0275fac = function SaudeRelatorioFechamentoMensalComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _SaudeRelatorioFechamentoMensalComponent)(\u0275\u0275directiveInject(Router), \u0275\u0275directiveInject(GpeSaudeService), \u0275\u0275directiveInject(AuthUserPreferencesService), \u0275\u0275directiveInject(UtilService));
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _SaudeRelatorioFechamentoMensalComponent, selectors: [["app-saude-relatorio-fechamento-mensal"]], viewQuery: function SaudeRelatorioFechamentoMensalComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c06, 7);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.formRelatorio = _t.first);
      }
    }, standalone: false, decls: 13, vars: 40, consts: [["formRelatorio", "ngForm"], ["p-title", "Fechamento Mensal", 3, "p-breadcrumb"], ["p-title", "Filtro"], ["p-label", "Data Consulta De", "name", "DZGADTCONS_DE", "p-required", "true", "p-show-required", "true", 1, "po-sm-12", "po-md-4", "po-lg-2", 3, "ngModelChange", "ngModel", "p-iso-format"], ["p-label", "Data Consulta Ate", "name", "DZGADTCONS_ATE", "p-required", "true", "p-show-required", "true", 1, "po-sm-12", "po-md-4", "po-lg-2", 3, "ngModelChange", "ngModel", "p-iso-format"], ["p-label", "Cl\xEDnica", "name", "CZGACLINIC", "p-required", "false", "p-show-required", "true", "p-field-label", "CZPRGENERI", "p-field-value", "CZPRCHAVE", "p-clean", "true", 1, "po-sm-12", "po-md-6", "po-lg-4", 3, "ngModelChange", "ngModel", "p-filter-service", "p-filter-params", "p-disabled"], ["p-label", "Especialidade", "name", "CZGAESPECI", "p-required", "false", "p-show-required", "true", "p-field-label", "label", "p-field-value", "value", "p-infinite-scroll", "true", "p-clean", "true", 1, "po-sm-12", "po-md-6", "po-lg-4", 3, "ngModelChange", "ngModel", "p-filter-service", "p-filter-params"], ["p-label", "Titular", "name", "CZGACODCON", "p-field-label", "label", "p-field-value", "value", "p-clean", "true", "p-required", "false", "p-show-required", "true", "p-change-on-enter", "true", 1, "po-sm-12", "po-md-6", "po-lg-4", 3, "ngModelChange", "ngModel", "p-filter-service", "p-filter-params", "p-disabled"], ["p-label", "Tipo Guia", "name", "CZGATPGUIA", 1, "po-sm-3", "po-md-6", "po-lg-4", 3, "ngModelChange", "ngModel", "p-options"], ["p-label", "Status Guias", "name", "CZGASTATUS", 1, "po-sm-3", "po-md-6", "po-lg-4", 3, "ngModelChange", "ngModel", "p-options"], ["p-label", "Gerar Relat\xF3rio - PDF", "p-icon", "po-icon-excel", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-click"], ["p-label", "Gerar Relat\xF3rio - Excel", 1, "po-sm-6", "po-md-6", "po-lg-6", 3, "p-click"]], template: function SaudeRelatorioFechamentoMensalComponent_Template(rf, ctx) {
      if (rf & 1) {
        const _r1 = \u0275\u0275getCurrentView();
        \u0275\u0275elementStart(0, "po-page-edit", 1)(1, "form", null, 0)(3, "po-widget", 2)(4, "po-datepicker", 3);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeRelatorioFechamentoMensalComponent_Template_po_datepicker_ngModelChange_4_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.relatorioFiltro.dados.DZGADTCONS_DE, $event) || (ctx.relatorioFiltro.dados.DZGADTCONS_DE = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(5, "po-datepicker", 4);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeRelatorioFechamentoMensalComponent_Template_po_datepicker_ngModelChange_5_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.relatorioFiltro.dados.DZGADTCONS_ATE, $event) || (ctx.relatorioFiltro.dados.DZGADTCONS_ATE = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(6, "po-combo", 5);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeRelatorioFechamentoMensalComponent_Template_po_combo_ngModelChange_6_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.relatorioFiltro.dados.CZGACLINIC, $event) || (ctx.relatorioFiltro.dados.CZGACLINIC = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(7, "po-combo", 6);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeRelatorioFechamentoMensalComponent_Template_po_combo_ngModelChange_7_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.relatorioFiltro.dados.CZGAESPECI, $event) || (ctx.relatorioFiltro.dados.CZGAESPECI = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(8, "po-combo", 7);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeRelatorioFechamentoMensalComponent_Template_po_combo_ngModelChange_8_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.relatorioFiltro.dados.CZGACODCON, $event) || (ctx.relatorioFiltro.dados.CZGACODCON = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(9, "po-combo", 8);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeRelatorioFechamentoMensalComponent_Template_po_combo_ngModelChange_9_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.relatorioFiltro.dados.CZGATPGUIA, $event) || (ctx.relatorioFiltro.dados.CZGATPGUIA = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(10, "po-combo", 9);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeRelatorioFechamentoMensalComponent_Template_po_combo_ngModelChange_10_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.relatorioFiltro.dados.CZGASTATUS, $event) || (ctx.relatorioFiltro.dados.CZGASTATUS = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd()()();
        \u0275\u0275elementStart(11, "po-button", 10);
        \u0275\u0275listener("p-click", function SaudeRelatorioFechamentoMensalComponent_Template_po_button_p_click_11_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.gerarRelatorio("pdf"));
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(12, "po-button", 11);
        \u0275\u0275listener("p-click", function SaudeRelatorioFechamentoMensalComponent_Template_po_button_p_click_12_listener() {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.gerarRelatorio("xls"));
        });
        \u0275\u0275elementEnd()();
      }
      if (rf & 2) {
        \u0275\u0275property("p-breadcrumb", ctx.breadcrumb);
        \u0275\u0275advance(4);
        \u0275\u0275twoWayProperty("ngModel", ctx.relatorioFiltro.dados.DZGADTCONS_DE);
        \u0275\u0275property("p-iso-format", ctx.formatExtended);
        \u0275\u0275advance();
        \u0275\u0275twoWayProperty("ngModel", ctx.relatorioFiltro.dados.DZGADTCONS_ATE);
        \u0275\u0275property("p-iso-format", ctx.formatExtended);
        \u0275\u0275advance();
        \u0275\u0275propertyInterpolate1("p-filter-service", "", ctx.urlApiProtheus, "/wsrbase/zprcombo/AREFICLINI");
        \u0275\u0275twoWayProperty("ngModel", ctx.relatorioFiltro.dados.CZGACLINIC);
        \u0275\u0275property("p-filter-params", \u0275\u0275pureFunction0(23, _c112))("p-disabled", ctx.acessoDeClinica);
        \u0275\u0275advance();
        \u0275\u0275propertyInterpolate1("p-filter-service", "", ctx.urlApiProtheus, "/wsrgpesaude/especialidade");
        \u0275\u0275twoWayProperty("ngModel", ctx.relatorioFiltro.dados.CZGAESPECI);
        \u0275\u0275property("p-filter-params", \u0275\u0275pureFunction0(24, _c23));
        \u0275\u0275advance();
        \u0275\u0275propertyInterpolate1("p-filter-service", "", ctx.urlApiProtheus, "/wsrgpesaude/conveniado");
        \u0275\u0275twoWayProperty("ngModel", ctx.relatorioFiltro.dados.CZGACODCON);
        \u0275\u0275property("p-filter-params", \u0275\u0275pureFunction0(25, _c33))("p-disabled", ctx.acessoDeConvenido);
        \u0275\u0275advance();
        \u0275\u0275twoWayProperty("ngModel", ctx.relatorioFiltro.dados.CZGATPGUIA);
        \u0275\u0275property("p-options", \u0275\u0275pureFunction3(29, _c73, \u0275\u0275pureFunction0(26, _c43), \u0275\u0275pureFunction0(27, _c53), \u0275\u0275pureFunction0(28, _c63)));
        \u0275\u0275advance();
        \u0275\u0275twoWayProperty("ngModel", ctx.relatorioFiltro.dados.CZGASTATUS);
        \u0275\u0275property("p-options", \u0275\u0275pureFunction3(36, _c73, \u0275\u0275pureFunction0(33, _c83), \u0275\u0275pureFunction0(34, _c92), \u0275\u0275pureFunction0(35, _c102)));
      }
    }, dependencies: [PoButtonComponent, PoDatepickerComponent, PoComboComponent, PoPageEditComponent, PoWidgetComponent, \u0275NgNoValidate, NgControlStatus, NgControlStatusGroup, NgModel, NgForm], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(SaudeRelatorioFechamentoMensalComponent, [{
    type: Component,
    args: [{ selector: "app-saude-relatorio-fechamento-mensal", standalone: false, template: `<po-page-edit\r
  p-title="Fechamento Mensal"\r
  [p-breadcrumb]="breadcrumb"\r
>\r
<form #formRelatorio="ngForm">\r
  <po-widget\r
    p-title="Filtro"\r
  >\r
    <po-datepicker class="po-sm-12 po-md-4 po-lg-2"\r
      p-label="Data Consulta De"\r
      name="DZGADTCONS_DE"\r
      [(ngModel)]="relatorioFiltro.dados.DZGADTCONS_DE"\r
      [p-iso-format]="formatExtended"\r
      p-required="true"\r
      p-show-required="true"\r
    ></po-datepicker>\r
    <po-datepicker class="po-sm-12 po-md-4 po-lg-2"\r
      p-label="Data Consulta Ate"\r
      name="DZGADTCONS_ATE"\r
      [(ngModel)]="relatorioFiltro.dados.DZGADTCONS_ATE"\r
      [p-iso-format]="formatExtended"\r
      p-required="true"\r
      p-show-required="true"\r
    ></po-datepicker>\r
    <po-combo class="po-sm-12 po-md-6 po-lg-4"\r
      p-label="Cl\xEDnica"\r
      name="CZGACLINIC"\r
      [(ngModel)]="relatorioFiltro.dados.CZGACLINIC"\r
      p-required="false"\r
      p-show-required="true"\r
      p-filter-service="{{urlApiProtheus}}/wsrbase/zprcombo/AREFICLINI"\r
      p-field-label="CZPRGENERI"\r
      p-field-value="CZPRCHAVE"\r
      [p-filter-params]="{CZPRCOMPLE: 'A'}"\r
      p-clean="true"\r
      [p-disabled]="acessoDeClinica"\r
    ></po-combo>\r
    <po-combo class="po-sm-12 po-md-6 po-lg-4"\r
      p-label="Especialidade"\r
      name="CZGAESPECI"\r
      [(ngModel)]="relatorioFiltro.dados.CZGAESPECI"\r
      p-required="false"\r
      p-show-required="true"\r
      p-filter-service="{{urlApiProtheus}}/wsrgpesaude/especialidade"\r
      p-field-label="label"\r
      p-field-value="value"\r
      [p-filter-params]="{combobox: 'S'}"\r
      p-infinite-scroll="true"\r
      p-clean="true"\r
    ></po-combo>\r
    <po-combo class="po-sm-12 po-md-6 po-lg-4"\r
      p-label="Titular"\r
      name="CZGACODCON"\r
      [(ngModel)]="relatorioFiltro.dados.CZGACODCON"\r
      p-filter-service="{{urlApiProtheus}}/wsrgpesaude/conveniado"\r
      [p-filter-params]="{ combobox: 'S', CTIPO: '1'}"\r
      p-field-label="label"\r
      p-field-value="value"\r
      p-clean="true"\r
      p-required="false"\r
      p-show-required="true"\r
      p-change-on-enter="true"\r
      [p-disabled]="acessoDeConvenido"\r
    ></po-combo>\r
    <po-combo class="po-sm-3 po-md-6 po-lg-4"\r
      p-label="Tipo Guia"\r
      name="CZGATPGUIA"\r
      [(ngModel)]="relatorioFiltro.dados.CZGATPGUIA"\r
      [p-options]="[\r
        { value: ' ', label: 'Todas'},\r
        { value: 'C', label: 'Consulta'},\r
        { value: 'E', label: 'Exame'},\r
      ]"\r
    ></po-combo>\r
    <po-combo class="po-sm-3 po-md-6 po-lg-4"\r
      p-label="Status Guias"\r
      name="CZGASTATUS"\r
      [(ngModel)]="relatorioFiltro.dados.CZGASTATUS"\r
      [p-options]="[\r
        { value: ' ', label: 'Ambos'},\r
        { value: '1', label: 'Autorizado'},\r
        { value: '3', label: 'Cancelado'}\r
      ]"\r
    ></po-combo>\r
  </po-widget>\r
</form>\r
\r
<po-button  class="po-sm-6 po-md-6 po-lg-6"\r
  p-label="Gerar Relat\xF3rio - PDF"\r
  p-icon="po-icon-excel"\r
  (p-click)="gerarRelatorio('pdf')"\r
></po-button>\r
<po-button class="po-sm-6 po-md-6 po-lg-6"\r
  p-label="Gerar Relat\xF3rio - Excel"\r
  (p-click)="gerarRelatorio('xls')"\r
\r
></po-button>\r
\r
</po-page-edit>\r
` }]
  }], () => [{ type: Router }, { type: GpeSaudeService }, { type: AuthUserPreferencesService }, { type: UtilService }], { formRelatorio: [{
    type: ViewChild,
    args: ["formRelatorio", { static: true }]
  }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(SaudeRelatorioFechamentoMensalComponent, { className: "SaudeRelatorioFechamentoMensalComponent", filePath: "src/app/rh/saude/relatorio/fechamento-mensal/saude-relatorio-fechamento-mensal.component.ts", lineNumber: 18 });
})();

// src/app/interface/saude-resumo-arefi.ts
var defaultSaudePlanoArefi = () => {
  return {
    CCOMPETENCIA: "",
    CRAMAT: "",
    CRANOME: "",
    CRASITF: "",
    CRAPIS: "",
    CRDPD: "",
    CRVDESC: "",
    NTOTAL: 0,
    LANPLANO: [],
    LANCONSULTA: []
  };
};
var defaultItensLancamento = () => {
  return {
    CNOME: "",
    CRHSTPLAN: "",
    CRHSTPFORN: "",
    CRCCCONTEU: "",
    CRDPD: "",
    CRVDESC: "",
    NVALOR: 0,
    DRDDATPGT: void 0
  };
};
var defaultItensConsulta = () => {
  return {
    CNOME: "",
    CZGATPGUIA: "",
    CZGACODIGO: "",
    CZGAESPECI: "",
    CTOGNOME: "",
    CZPRGENERI: "",
    DZGADTCONS: void 0
  };
};

// src/app/filter/filtro-saude-resumo-arefi.ts
var FiltroSaudePlanoArefi = class extends FiltroLista {
  constructor() {
    super(...arguments);
    this.dados = this.setDefault();
    this.timeout = this.getDataString(0);
  }
  setDefault() {
    return {
      page: 1,
      pageSize: 10,
      filter: void 0,
      order: void 0,
      CRAMAT: "",
      CPERIODO: ""
    };
  }
};

// src/app/rh/saude/resumo/saude-resumo-arefi.component.ts
var _c07 = ["modal"];
var _c113 = ["consulta"];
var _c24 = ["advancedFilterModal"];
var _c34 = () => ({ combobox: "S", CTIPO: "1" });
var SaudeResumoArefiComponent = class _SaudeResumoArefiComponent {
  constructor(authUserPreferencesService, router, gpeSaudeService, excelService) {
    this.authUserPreferencesService = authUserPreferencesService;
    this.router = router;
    this.gpeSaudeService = gpeSaudeService;
    this.excelService = excelService;
    this.urlApiProtheus = environment.urlApiProtheus;
    this.PoSearchFilterMode = PoSearchFilterMode.contains;
    this.tabelaPrincipalItems = [];
    this.tabelaResumoLancamento = [defaultItensLancamento()];
    this.tabelaResumoConsulta = [defaultItensConsulta()];
    this.situacaoPeriodo = "";
    this.zgaTotal = 0;
    this.zgaExame = 0;
    this.zgaConsulta = 0;
    this.breadcrumb = {
      items: [
        { label: "Home", action: this.goHome.bind(this) },
        { label: "Apura\xE7\xE3o AREFI" }
      ]
    };
    this.actions = [
      { label: "Exportar Excel", action: this.exportaExcel.bind(this) }
    ];
    this.tabelaPrincipalColumns = [
      { property: "CRAMAT", label: "Matricula", width: "10%", visible: true },
      { property: "CRANOME", label: "Nome", width: "30%", visible: true },
      { property: "CRAPIS", label: "PIS", width: "15%", visible: true },
      { property: "CRASITF", label: "Situa\xE7\xE3o Folha", width: "15%", visible: true },
      { property: "NTOTAL", label: "Total", width: "15%", visible: true, type: "currency", format: "BRL" },
      {
        property: "actions",
        label: " ",
        width: "10%",
        visible: true,
        type: "icon",
        icons: [
          {
            icon: "an an-file-pdf",
            tooltip: "pdf",
            value: "pdf",
            action: (row) => this.exportaArquivo(row, "pdf")
          },
          {
            icon: "an an-file-xls",
            tooltip: "Excel",
            value: "xls",
            action: (row) => this.exportaArquivo(row, "xls")
          }
        ]
      }
    ];
    this.tabelaResumoLancamentoColumns = [
      { property: "CNOME", label: "Nome", width: "20%", visible: true },
      { property: "CRHSTPLAN", label: "Lancamento", width: "12%", visible: true },
      { property: "CRHSTPFORN", label: "Tipo", width: "13%", visible: true },
      { property: "CRDPD", label: "Verba", width: "08%", visible: true },
      { property: "CRVDESC", label: "Descricao", width: "12%", visible: true },
      { property: "NVALOR", label: "Valor", width: "12%", visible: true, type: "currency", format: "BRL" },
      { property: "DRDDATPGT", label: "Pagamento", width: "12%", visible: true, type: "date" }
    ];
    this.tabelaConsultaColumns = [
      { property: "CNOME", label: "Nome", width: "25%", visible: true },
      { property: "CZGATPGUIA", label: "Tipo", width: "15%", visible: true },
      { property: "CZGACODIGO", label: "Guia", width: "10%", visible: true },
      { property: "CZAGDESC", label: "Especialidade", width: "20%", visible: true },
      { property: "CZPRGENERI", label: "Clinica", width: "15%", visible: true },
      { property: "DZGADTCONS", label: "Dt.Consulta", width: "15%", visible: true, type: "date" }
    ];
    this.tabelaPrincipalActions = [
      { label: "visualizar", icon: "an an-eye", action: this.visualizar.bind(this) }
    ];
    this.filterSettings = {
      advancedAction: this.advancedFilterActionModal.bind(this)
    };
    this.advancedFilterPrimaryAction = {
      action: () => {
        this.advancedFilterModal.close();
        this.loadDados();
      },
      label: "Aplicar Filtros"
    };
    this.tabelaPrincipalFiltro = new FiltroSaudePlanoArefi(authUserPreferencesService, "filtro-saude-plano");
    this.saudePlano = defaultSaudePlanoArefi();
  }
  ngOnInit() {
    this.advancedFilterModal.open();
  }
  loadDados() {
    this.tabelaPrincipalFiltro.postSalvarFiltro();
    this.gpeSaudeService.getGpeSaudePlanoArefi(this.tabelaPrincipalFiltro.dados).subscribe({
      next: (ret) => {
        this.periodoDe = ret.DPERIODO_DE;
        this.periodoAte = ret.DPERIODO_ATE;
        this.situacaoPeriodo = ret.CSITPERIODO;
        this.zgaTotal = ret.NZGATOTAL;
        this.zgaExame = ret.NZGAEXAME;
        this.zgaConsulta = ret.NZGACONSULTA;
        this.tabelaPrincipalItems = ret.items;
        this.tabelaPrincipalItems = this.tabelaPrincipalItems.map((item) => {
          return __spreadProps(__spreadValues({}, item), { actions: ["pdf", "xls"] });
        });
      },
      error: () => {
        this.tabelaPrincipalItems = [];
        this.periodoDe = void 0;
        this.periodoAte = void 0;
        this.situacaoPeriodo = "";
        this.zgaTotal = 0;
        this.zgaConsulta = 0;
        this.zgaExame = 0;
      }
    });
  }
  goHome() {
    this.router.navigate(["/"]);
  }
  visualizar(row) {
    this.saudePlano = row;
    this.tabelaResumoLancamento = row.LANPLANO;
    this.tabelaResumoConsulta = row.LANCONSULTA;
    this.modal.open();
  }
  loadConveniado(CTIPO, CCODIGO, CMATRICULA = "") {
    this.gpeSaudeService.getGpeSaudeConveniado(CCODIGO, { CTIPO, CMATRICULA }).subscribe({
      next: (conveniado) => {
        this.conveniadoSelecionado(conveniado);
      }
    });
  }
  conveniadoSelecionado(conveniado) {
    this.tabelaPrincipalFiltro.dados.CRAMAT = conveniado.CRAMAT;
  }
  exportaExcel() {
    const listaExcel = this.tabelaPrincipalItems.map((item) => {
      return {
        "Competencia": item.CCOMPETENCIA,
        "Matricula": item.CRAMAT,
        "Nome": item.CRANOME,
        "PIS": item.CRAPIS,
        "Sit.Folha": item.CRASITF,
        "Total": item.NTOTAL
      };
    });
    this.excelService.exportAsExcelFile(listaExcel, "RESUMO_AREFI");
  }
  exportaArquivo(row, cextension = "'pdf'|'xls'") {
    const fileType = cextension === "pdf" ? "application/pdf" : "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
    const fileExtension = cextension === "pdf" ? "pdf" : "xls";
    const fileName = `ResumoArefi_${row.CRAMAT}_${row.CCOMPETENCIA}.${fileExtension}`;
    this.gpeSaudeService.getGpeSaudeArefiFile(row.CRAMAT, row.CCOMPETENCIA, fileExtension).subscribe((ret) => {
      const file = new Blob([ret], { type: fileType });
      const a = document.createElement("a");
      document.body.appendChild(a);
      const fileUrl = window.URL.createObjectURL(file);
      a.href = fileUrl;
      a.download = fileName;
      a.click();
      document.body.removeChild(a);
    });
  }
  advancedFilterActionModal() {
    this.advancedFilterModal.open();
  }
  static {
    this.\u0275fac = function SaudeResumoArefiComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _SaudeResumoArefiComponent)(\u0275\u0275directiveInject(AuthUserPreferencesService), \u0275\u0275directiveInject(Router), \u0275\u0275directiveInject(GpeSaudeService), \u0275\u0275directiveInject(ExcelService));
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _SaudeResumoArefiComponent, selectors: [["app-saude-resumo-arefi"]], viewQuery: function SaudeResumoArefiComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(_c07, 7);
        \u0275\u0275viewQuery(_c113, 7);
        \u0275\u0275viewQuery(_c24, 7);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.modal = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.consulta = _t.first);
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.advancedFilterModal = _t.first);
      }
    }, standalone: false, decls: 49, vars: 49, consts: [["modal", ""], ["consulta", ""], ["advancedFilterModal", ""], ["p-title", "Resumo Apura\xE7\xE3o - AREFI", 3, "p-breadcrumb", "p-actions", "p-filter"], [1, "po-font-text-large-bold", "po-md-4", "po-mt-md-0", "po-pt-md-0"], ["p-spacing", "extraSmall", "p-height", "400", "p-hide-table-search", "false", "p-hide-columns-manager", "true", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-items", "p-columns", "p-actions", "p-sort", "p-striped", "p-filter-type"], [1, "po-md"], [1, "po-mp-0", "po-md-4"], [1, "po-font-subtitle", "po-m-5"], ["p-size", "xl", "p-title", "Resumo Executivo Plano de Saude - AREFI"], ["p-label", "Compet\xEAncia", 1, "po-mp-0", "po-md-1", 3, "p-value"], ["p-label", "Matricula", 1, "po-mp-0", "po-md-1", 3, "p-value"], ["p-label", "Titular", 1, "po-mp-0", "po-md-6", 3, "p-value"], ["p-label", "Total Titular", 1, "po-mp-0", "po-md-2", 3, "p-value"], ["p-label", "Sit.Folha", 1, "po-mp-0", "po-md-2", 3, "p-value"], ["p-hide-columns-manager", "true", "p-height", "350", 1, "po-sm-12", "po-md-12", "po-lg-12", 3, "p-items", "p-columns"], ["p-label", "Consultas", 3, "p-click"], ["p-label", "Fechar", "p-kind", "primary", 3, "p-click"], ["p-size", "xl", "p-title", "Resumo Consultas - AREFI"], ["p-label", "Titular", 1, "po-mp-0", "po-md-4", 3, "p-value"], ["p-title", "Filtro", 3, "p-primary-action"], ["name", "deate_DRDDATARQ", "p-label", "Periodo de Fechamento", "p-required", "true", "p-show-required", "true", "p-maxlength", "6", "p-placeholder", "MMYYYY", 1, "po-md-6", 3, "ngModelChange", "ngModel"], ["p-label", "Titular", "name", "CRAMAT", "p-field-label", "label", "p-field-value", "value", "p-clean", "true", "p-change-on-enter", "true", 1, "po-md-6", 3, "ngModelChange", "ngModel", "p-filter-service", "p-filter-params"]], template: function SaudeResumoArefiComponent_Template(rf, ctx) {
      if (rf & 1) {
        const _r1 = \u0275\u0275getCurrentView();
        \u0275\u0275elementStart(0, "po-page-list", 3)(1, "po-container")(2, "font", 4);
        \u0275\u0275text(3);
        \u0275\u0275pipe(4, "date");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(5, "font", 4);
        \u0275\u0275text(6);
        \u0275\u0275pipe(7, "date");
        \u0275\u0275pipe(8, "date");
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(9, "font", 4);
        \u0275\u0275text(10);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(11, "po-container");
        \u0275\u0275element(12, "po-table", 5);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(13, "po-container", 6)(14, "po-widget", 7)(15, "font", 8);
        \u0275\u0275text(16);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(17, "po-widget", 7)(18, "font", 8);
        \u0275\u0275text(19);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(20, "po-widget", 7)(21, "font", 8);
        \u0275\u0275text(22);
        \u0275\u0275elementEnd()()()();
        \u0275\u0275elementStart(23, "po-modal", 9, 0)(25, "po-container");
        \u0275\u0275element(26, "po-info", 10);
        \u0275\u0275pipe(27, "date");
        \u0275\u0275element(28, "po-info", 11)(29, "po-info", 12)(30, "po-info", 13);
        \u0275\u0275pipe(31, "currency");
        \u0275\u0275element(32, "po-info", 14);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(33, "po-container");
        \u0275\u0275element(34, "po-table", 15);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(35, "po-modal-footer")(36, "po-button", 16);
        \u0275\u0275listener("p-click", function SaudeResumoArefiComponent_Template_po_button_p_click_36_listener() {
          \u0275\u0275restoreView(_r1);
          const consulta_r2 = \u0275\u0275reference(39);
          return \u0275\u0275resetView(consulta_r2.open());
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(37, "po-button", 17);
        \u0275\u0275listener("p-click", function SaudeResumoArefiComponent_Template_po_button_p_click_37_listener() {
          \u0275\u0275restoreView(_r1);
          const modal_r3 = \u0275\u0275reference(24);
          return \u0275\u0275resetView(modal_r3.close());
        });
        \u0275\u0275elementEnd()()();
        \u0275\u0275elementStart(38, "po-modal", 18, 1)(40, "po-container");
        \u0275\u0275element(41, "po-info", 11)(42, "po-info", 19);
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(43, "po-container");
        \u0275\u0275element(44, "po-table", 15);
        \u0275\u0275elementEnd()();
        \u0275\u0275elementStart(45, "po-modal", 20, 2)(47, "po-input", 21);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeResumoArefiComponent_Template_po_input_ngModelChange_47_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.tabelaPrincipalFiltro.dados.CPERIODO, $event) || (ctx.tabelaPrincipalFiltro.dados.CPERIODO = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275elementEnd();
        \u0275\u0275elementStart(48, "po-combo", 22);
        \u0275\u0275twoWayListener("ngModelChange", function SaudeResumoArefiComponent_Template_po_combo_ngModelChange_48_listener($event) {
          \u0275\u0275restoreView(_r1);
          \u0275\u0275twoWayBindingSet(ctx.tabelaPrincipalFiltro.dados.CRAMAT, $event) || (ctx.tabelaPrincipalFiltro.dados.CRAMAT = $event);
          return \u0275\u0275resetView($event);
        });
        \u0275\u0275listener("ngModelChange", function SaudeResumoArefiComponent_Template_po_combo_ngModelChange_48_listener($event) {
          \u0275\u0275restoreView(_r1);
          return \u0275\u0275resetView(ctx.loadConveniado("1", $event));
        });
        \u0275\u0275elementEnd()();
      }
      if (rf & 2) {
        \u0275\u0275property("p-breadcrumb", ctx.breadcrumb)("p-actions", ctx.actions)("p-filter", ctx.filterSettings);
        \u0275\u0275advance(3);
        \u0275\u0275textInterpolate1(" Compet\xEAncia: ", \u0275\u0275pipeBind2(4, 33, ctx.periodoDe, "MM/YYYY"), "");
        \u0275\u0275advance(3);
        \u0275\u0275textInterpolate2(" Periodo De: ", \u0275\u0275pipeBind2(7, 36, ctx.periodoDe, "dd/MM/yyyy"), " - ", \u0275\u0275pipeBind2(8, 39, ctx.periodoAte, "dd/MM/YYYY"), "");
        \u0275\u0275advance(4);
        \u0275\u0275textInterpolate1(" Situa\xE7\xE3o Periodo: ", ctx.situacaoPeriodo, "");
        \u0275\u0275advance(2);
        \u0275\u0275property("p-items", ctx.tabelaPrincipalItems)("p-columns", ctx.tabelaPrincipalColumns)("p-actions", ctx.tabelaPrincipalActions)("p-sort", false)("p-striped", true)("p-filter-type", ctx.PoSearchFilterMode);
        \u0275\u0275advance(4);
        \u0275\u0275textInterpolate1("CONSULTAS ", ctx.zgaConsulta, "");
        \u0275\u0275advance(3);
        \u0275\u0275textInterpolate1("EXAMES ", ctx.zgaExame, "");
        \u0275\u0275advance(3);
        \u0275\u0275textInterpolate1("TOTAL ", ctx.zgaTotal, "");
        \u0275\u0275advance(4);
        \u0275\u0275propertyInterpolate("p-value", \u0275\u0275pipeBind2(27, 42, ctx.periodoDe, "MM/YYYY"));
        \u0275\u0275advance(2);
        \u0275\u0275propertyInterpolate("p-value", ctx.saudePlano.CRAMAT);
        \u0275\u0275advance();
        \u0275\u0275propertyInterpolate("p-value", ctx.saudePlano.CRANOME);
        \u0275\u0275advance();
        \u0275\u0275propertyInterpolate("p-value", \u0275\u0275pipeBind2(31, 45, ctx.saudePlano.NTOTAL, "BRL"));
        \u0275\u0275advance(2);
        \u0275\u0275propertyInterpolate("p-value", ctx.saudePlano.CRASITF);
        \u0275\u0275advance(2);
        \u0275\u0275property("p-items", ctx.tabelaResumoLancamento)("p-columns", ctx.tabelaResumoLancamentoColumns);
        \u0275\u0275advance(7);
        \u0275\u0275propertyInterpolate("p-value", ctx.saudePlano.CRAMAT);
        \u0275\u0275advance();
        \u0275\u0275propertyInterpolate("p-value", ctx.saudePlano.CRANOME);
        \u0275\u0275advance(2);
        \u0275\u0275property("p-items", ctx.tabelaResumoConsulta)("p-columns", ctx.tabelaConsultaColumns);
        \u0275\u0275advance();
        \u0275\u0275property("p-primary-action", ctx.advancedFilterPrimaryAction);
        \u0275\u0275advance(2);
        \u0275\u0275twoWayProperty("ngModel", ctx.tabelaPrincipalFiltro.dados.CPERIODO);
        \u0275\u0275advance();
        \u0275\u0275propertyInterpolate1("p-filter-service", "", ctx.urlApiProtheus, "/wsrgpesaude/conveniado");
        \u0275\u0275twoWayProperty("ngModel", ctx.tabelaPrincipalFiltro.dados.CRAMAT);
        \u0275\u0275property("p-filter-params", \u0275\u0275pureFunction0(48, _c34));
      }
    }, dependencies: [PoButtonComponent, PoContainerComponent, PoComboComponent, PoInputComponent, PoInfoComponent, PoModalComponent, PoModalFooterComponent, PoPageListComponent, PoTableComponent, PoWidgetComponent, NgControlStatus, NgModel, CurrencyPipe, DatePipe], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(SaudeResumoArefiComponent, [{
    type: Component,
    args: [{ selector: "app-saude-resumo-arefi", standalone: false, template: `<po-page-list p-title="Resumo Apura\xE7\xE3o - AREFI" [p-breadcrumb]="breadcrumb" [p-actions]="actions"\r
  [p-filter]="filterSettings">\r
  <po-container>\r
    <font class="po-font-text-large-bold po-md-4 po-mt-md-0 po-pt-md-0"> Compet\xEAncia: {{this.periodoDe | date: 'MM/YYYY'}}</font>\r
    <font class="po-font-text-large-bold po-md-4 po-mt-md-0 po-pt-md-0"> Periodo De:  {{this.periodoDe | date: 'dd/MM/yyyy'}} - {{this.periodoAte | date:'dd/MM/YYYY'}}</font>\r
    <font class="po-font-text-large-bold po-md-4 po-mt-md-0 po-pt-md-0"> Situa\xE7\xE3o Periodo: {{this.situacaoPeriodo}}</font>\r
  </po-container>\r
  <po-container>\r
    <po-table class="po-sm-12 po-md-12 po-lg-12"\r
      [p-items]="tabelaPrincipalItems"\r
      [p-columns]="tabelaPrincipalColumns"\r
      [p-actions]="tabelaPrincipalActions"\r
      [p-sort]="false"\r
      p-spacing="extraSmall"\r
      [p-striped]="true"\r
      [p-filter-type]="PoSearchFilterMode"\r
      p-height="400"\r
      p-hide-table-search="false"\r
      p-hide-columns-manager="true"\r
    ></po-table>\r
  </po-container>\r
  <po-container class="po-md">\r
    <po-widget class="po-mp-0 po-md-4">\r
      <font class="po-font-subtitle po-m-5">CONSULTAS {{this.zgaConsulta}}</font>\r
    </po-widget>\r
    <po-widget class="po-mp-0 po-md-4">\r
      <font class="po-font-subtitle po-m-5">EXAMES {{this.zgaExame}}</font>\r
    </po-widget>\r
    <po-widget class="po-mp-0 po-md-4">\r
      <font class="po-font-subtitle po-m-5">TOTAL {{this.zgaTotal}}</font>\r
    </po-widget>\r
  </po-container>\r
</po-page-list>\r
\r
<po-modal p-size="xl" #modal p-title="Resumo Executivo Plano de Saude - AREFI">\r
  <po-container>\r
    <po-info class="po-mp-0 po-md-1" p-label="Compet\xEAncia"   p-value="{{this.periodoDe | date: 'MM/YYYY'}}"></po-info>\r
    <po-info class="po-mp-0 po-md-1" p-label="Matricula"     p-value="{{saudePlano.CRAMAT}}"></po-info>\r
    <po-info class="po-mp-0 po-md-6" p-label="Titular"       p-value="{{saudePlano.CRANOME}}"></po-info>\r
    <po-info class="po-mp-0 po-md-2" p-label="Total Titular" p-value="{{saudePlano.NTOTAL | currency: 'BRL'}}"></po-info>\r
    <po-info class="po-mp-0 po-md-2" p-label="Sit.Folha"     p-value="{{saudePlano.CRASITF}}"></po-info>\r
  </po-container>\r
  <po-container>\r
    <po-table class="po-sm-12 po-md-12 po-lg-12"\r
      [p-items]="tabelaResumoLancamento"\r
      [p-columns]="tabelaResumoLancamentoColumns"\r
      p-hide-columns-manager="true"\r
      p-height="350"\r
    ></po-table>\r
  </po-container>\r
  <po-modal-footer>\r
    <po-button p-label="Consultas" (p-click)="consulta.open()"></po-button>\r
    <po-button p-label="Fechar" p-kind="primary" (p-click)="modal.close()"></po-button>\r
  </po-modal-footer>\r
</po-modal>\r
\r
<po-modal p-size="xl" #consulta p-title="Resumo Consultas - AREFI">\r
  <po-container>\r
    <po-info class="po-mp-0 po-md-1" p-label="Matricula" p-value="{{saudePlano.CRAMAT}}"></po-info>\r
    <po-info class="po-mp-0 po-md-4" p-label="Titular"   p-value="{{saudePlano.CRANOME}}"></po-info>\r
  </po-container>\r
  <po-container>\r
    <po-table class="po-sm-12 po-md-12 po-lg-12"\r
      [p-items]="tabelaResumoConsulta"\r
      [p-columns]="tabelaConsultaColumns"\r
      p-hide-columns-manager="true"\r
      p-height="350"\r
    ></po-table>\r
  </po-container>\r
</po-modal>\r
\r
<po-modal #advancedFilterModal p-title="Filtro" [p-primary-action]="advancedFilterPrimaryAction">\r
  <po-input class="po-md-6"\r
    name="deate_DRDDATARQ"\r
    p-label="Periodo de Fechamento"\r
    [(ngModel)]="tabelaPrincipalFiltro.dados.CPERIODO"\r
    p-required="true"\r
    p-show-required="true"\r
    p-maxlength="6"\r
    p-placeholder="MMYYYY"\r
  ></po-input>\r
  <po-combo class="po-md-6"\r
    p-label="Titular"\r
    name="CRAMAT"\r
    [(ngModel)]="tabelaPrincipalFiltro.dados.CRAMAT"\r
    p-filter-service="{{urlApiProtheus}}/wsrgpesaude/conveniado"\r
    [p-filter-params]="{ combobox: 'S', CTIPO: '1'}"\r
    p-field-label="label"\r
    p-field-value="value"\r
    p-clean="true"\r
    p-change-on-enter="true"\r
    (ngModelChange)="loadConveniado('1',$event)"\r
  ></po-combo>\r
</po-modal>\r
` }]
  }], () => [{ type: AuthUserPreferencesService }, { type: Router }, { type: GpeSaudeService }, { type: ExcelService }], { modal: [{
    type: ViewChild,
    args: ["modal", { static: true }]
  }], consulta: [{
    type: ViewChild,
    args: ["consulta", { static: true }]
  }], advancedFilterModal: [{
    type: ViewChild,
    args: ["advancedFilterModal", { static: true }]
  }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(SaudeResumoArefiComponent, { className: "SaudeResumoArefiComponent", filePath: "src/app/rh/saude/resumo/saude-resumo-arefi.component.ts", lineNumber: 18 });
})();

// src/app/change-password-fornecedor/change-password-fornecedor.component.ts
var ChangePasswordFornecedorComponent = class _ChangePasswordFornecedorComponent {
  constructor(authService, poDialogSevice, router) {
    this.authService = authService;
    this.poDialogSevice = poDialogSevice;
    this.router = router;
    this.hideCurrentPassword = false;
    this.logo = "./assets/image/logo_escura.png";
    this.recovery = "";
    this.dados = defaultUserFornecedorChangePassword();
    this.requirements = [
      { requirement: "Minimo 6 caracteres", status: (e) => {
        return e && e.length >= 6;
      } },
      { requirement: "Conter caracter especial (@$!%*#?&)", status: (e) => {
        return e && /^(?=.*[@$!%*#?&])/.test(e);
      } },
      { requirement: "Conter letra e numero", status: (e) => {
        return e && /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]/.test(e);
      } },
      { requirement: "N\xC3O Conter aspas", status: (e) => {
        return e && /^[^\ "]*$/.test(e);
      } }
    ];
    this.secondaryLogo = "";
    this.urlBack = "/";
    this.urlHome = "/";
    this.urlNewPassword = `${environment.urlApiProtheus}/wsrauth/alterar-senha`;
    this.dados.CRD0CODIGO = localStorage.getItem("CUSUARIOPORTALCODIGO") || "";
    this.dados.CRD0PORTAL = localStorage.getItem("portal") || "";
  }
  submit(formData) {
    this.poDialogSevice.alert({
      title: "Altera\xE7\xE3o de Senha",
      message: "Deseja alterar sua senha?",
      ok: () => {
        this.dados.CCURRENTPASSWORD = formData.currentPassword || "";
        this.dados.CNEWPASSWORD = formData.newPassword || "";
        this.authService.postUserAlterarSenha(this.dados).subscribe({
          next: () => {
            this.poDialogSevice.alert({
              title: "Altera\xE7\xE3o de Senha",
              message: "Senha alterada com sucesso!",
              ok: () => {
                this.router.navigateByUrl(this.urlHome);
              }
            });
          }
        });
      }
    });
  }
  static {
    this.\u0275fac = function ChangePasswordFornecedorComponent_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _ChangePasswordFornecedorComponent)(\u0275\u0275directiveInject(AuthService), \u0275\u0275directiveInject(PoDialogService), \u0275\u0275directiveInject(Router));
    };
  }
  static {
    this.\u0275cmp = /* @__PURE__ */ \u0275\u0275defineComponent({ type: _ChangePasswordFornecedorComponent, selectors: [["app-change-password-fornecedor"]], viewQuery: function ChangePasswordFornecedorComponent_Query(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275viewQuery(PoPageChangePasswordComponent, 7);
      }
      if (rf & 2) {
        let _t;
        \u0275\u0275queryRefresh(_t = \u0275\u0275loadQuery()) && (ctx.changePassword = _t.first);
      }
    }, standalone: false, decls: 1, vars: 7, consts: [[3, "p-submit", "p-hide-current-password", "p-logo", "p-recovery", "p-requirements", "p-secondary-logo", "p-url-back", "p-url-home"]], template: function ChangePasswordFornecedorComponent_Template(rf, ctx) {
      if (rf & 1) {
        \u0275\u0275elementStart(0, "po-page-change-password", 0);
        \u0275\u0275listener("p-submit", function ChangePasswordFornecedorComponent_Template_po_page_change_password_p_submit_0_listener($event) {
          return ctx.submit($event);
        });
        \u0275\u0275elementEnd();
      }
      if (rf & 2) {
        \u0275\u0275property("p-hide-current-password", ctx.hideCurrentPassword)("p-logo", ctx.logo)("p-recovery", ctx.recovery)("p-requirements", ctx.requirements)("p-secondary-logo", ctx.secondaryLogo)("p-url-back", ctx.urlBack)("p-url-home", ctx.urlHome);
      }
    }, dependencies: [PoPageChangePasswordComponent], encapsulation: 2 });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(ChangePasswordFornecedorComponent, [{
    type: Component,
    args: [{ selector: "app-change-password-fornecedor", standalone: false, template: '<po-page-change-password\r\n  [p-hide-current-password]="hideCurrentPassword"\r\n  [p-logo]="logo"\r\n  [p-recovery]="recovery"\r\n  [p-requirements]="requirements"\r\n  [p-secondary-logo]="secondaryLogo"\r\n  [p-url-back]="urlBack"\r\n  [p-url-home]="urlHome"\r\n  (p-submit)="submit($event)"\r\n>\r\n</po-page-change-password>\r\n' }]
  }], () => [{ type: AuthService }, { type: PoDialogService }, { type: Router }], { changePassword: [{
    type: ViewChild,
    args: [PoPageChangePasswordComponent, { static: true }]
  }] });
})();
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && \u0275setClassDebugInfo(ChangePasswordFornecedorComponent, { className: "ChangePasswordFornecedorComponent", filePath: "src/app/change-password-fornecedor/change-password-fornecedor.component.ts", lineNumber: 19 });
})();

// src/app/app.module.ts
registerLocaleData(pt_default);
var APP_ROUTES = [
  { path: "login", component: LoginComponent, data: { permissao: "" } },
  { path: "login-rh", component: LoginRhComponent, data: { permissao: "" } },
  { path: "login-fornecedor", component: LoginFornecedorComponent, data: { permissao: "" } },
  {
    path: "",
    component: MainComponent,
    canActivate: [MaistiGuard],
    data: { permissao: [] },
    children: [
      { path: "change-password-fornecedor", component: ChangePasswordFornecedorComponent, data: { permissao: PO_RH_LISTA_MENU } },
      { path: "rh/saude/guia/lista", component: SaudeGuiaListaComponent, data: { permissao: PO_RH_LISTA_MENU } },
      { path: "rh/saude/guia/crud", component: SaudeGuiaCrudComponent, data: { permissao: PO_RH_SOLICITACAO_MENU } },
      { path: "rh/saude/guia/crud/:CZGACODIGO/:CZGACHAVE", component: SaudeGuiaCrudComponent, data: { permissao: PO_RH_SOLICITACAO_MENU } },
      { path: "rh/saude/relatorio/fechamento-mensal", component: SaudeRelatorioFechamentoMensalComponent, data: { permissao: PO_RH_RELFATMENSAL_MENU } },
      { path: "rh/saude/resumo-arefi", component: SaudeResumoArefiComponent, data: { permissao: PO_RH_RESUMOAREFI_MENU } }
    ]
  }
];
var AppModule = class _AppModule {
  static {
    this.\u0275fac = function AppModule_Factory(__ngFactoryType__) {
      return new (__ngFactoryType__ || _AppModule)();
    };
  }
  static {
    this.\u0275mod = /* @__PURE__ */ \u0275\u0275defineNgModule({ type: _AppModule, bootstrap: [AppComponent] });
  }
  static {
    this.\u0275inj = /* @__PURE__ */ \u0275\u0275defineInjector({ providers: [
      AngularDeviceInformationService,
      { provide: ExcelService },
      {
        provide: HTTP_INTERCEPTORS,
        useClass: TokenInterceptor,
        multi: true
      },
      { provide: LOCALE_ID, useValue: "pt-BR" },
      provideHttpClient(withInterceptorsFromDi())
    ], imports: [
      PoModule,
      // [*Portinari UI]
      BrowserModule,
      BrowserAnimationsModule,
      FormsModule,
      AppRoutingModule,
      RouterModule.forRoot(APP_ROUTES, {}),
      PoTemplatesModule,
      PoStorageModule.forRoot({
        name: "inplac-rh_poui",
        storeName: "_inplac-rh_poui",
        driverOrder: ["lokijs", "websql", "indexeddb", "localstorage"]
      })
    ] });
  }
};
(() => {
  (typeof ngDevMode === "undefined" || ngDevMode) && setClassMetadata(AppModule, [{
    type: NgModule,
    args: [{
      declarations: [
        AppComponent,
        LoginComponent,
        LoginRhComponent,
        LoginFornecedorComponent,
        MainComponent,
        UtilArquivoComponent,
        SaudeGuiaListaComponent,
        SaudeGuiaCrudComponent,
        SaudeRelatorioFechamentoMensalComponent,
        SaudeResumoArefiComponent,
        ChangePasswordFornecedorComponent
      ],
      bootstrap: [AppComponent],
      imports: [
        PoModule,
        // [*Portinari UI]
        BrowserModule,
        BrowserAnimationsModule,
        FormsModule,
        AppRoutingModule,
        RouterModule.forRoot(APP_ROUTES, {}),
        PoTemplatesModule,
        PoStorageModule.forRoot({
          name: "inplac-rh_poui",
          storeName: "_inplac-rh_poui",
          driverOrder: ["lokijs", "websql", "indexeddb", "localstorage"]
        })
      ],
      providers: [
        AngularDeviceInformationService,
        { provide: ExcelService },
        {
          provide: HTTP_INTERCEPTORS,
          useClass: TokenInterceptor,
          multi: true
        },
        { provide: LOCALE_ID, useValue: "pt-BR" },
        provideHttpClient(withInterceptorsFromDi())
      ]
    }]
  }], null, null);
})();

// src/main.ts
if (environment.production) {
  enableProdMode();
}
platformBrowser().bootstrapModule(AppModule).catch((err) => console.error(err));
